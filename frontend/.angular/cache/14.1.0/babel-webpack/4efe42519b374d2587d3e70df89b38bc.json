{"ast":null,"code":"import { Animation, Browser, ChildProperty, Collection, Complex, Component, Draggable, Event, EventHandler, HijriParser, Internationalization, KeyboardEvents, L10n, NotifyPropertyChanges, Property, SanitizeHtmlHelper, Touch, addClass, append, classList, cldrData, closest, compile, createElement, extend, formatUnit, getDefaultDateObject, getElement, getValue, isNullOrUndefined, prepend, print, remove, removeClass, setStyleAttribute } from '@syncfusion/ej2-base';\nimport { Dialog, Popup, Tooltip, createSpinner, hideSpinner, isCollide, showSpinner } from '@syncfusion/ej2-popups';\nimport { Toolbar, TreeView } from '@syncfusion/ej2-navigations';\nimport { Calendar, DatePicker, DateTimePicker } from '@syncfusion/ej2-calendars';\nimport { DataManager, Deferred, Predicate, Query } from '@syncfusion/ej2-data';\nimport { Button, CheckBox, RadioButton } from '@syncfusion/ej2-buttons';\nimport { FormValidator, Input, NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { DropDownList, MultiSelect } from '@syncfusion/ej2-dropdowns';\nimport { ListBase } from '@syncfusion/ej2-lists';\nimport { Workbook } from '@syncfusion/ej2-excel-export';\n/**\n * Constants\n */\n\n/** @private */\n\nconst cellClick = 'cellClick';\n/** @private */\n\nconst cellDoubleClick = 'cellDoubleClick';\n/** @private */\n\nconst moreEventsClick = 'moreEventsClick';\n/** @private */\n\nconst select = 'select';\n/** @private */\n\nconst hover = 'hover';\n/** @private */\n\nconst actionBegin = 'actionBegin';\n/** @private */\n\nconst actionComplete = 'actionComplete';\n/** @private */\n\nconst actionFailure = 'actionFailure';\n/** @private */\n\nconst navigating = 'navigating';\n/** @private */\n\nconst renderCell = 'renderCell';\n/** @private */\n\nconst eventClick = 'eventClick';\n/** @private */\n\nconst eventRendered = 'eventRendered';\n/** @private */\n\nconst dataBinding = 'dataBinding';\n/** @private */\n\nconst dataBound = 'dataBound';\n/** @private */\n\nconst popupOpen = 'popupOpen';\n/** @private */\n\nconst popupClose = 'popupClose';\n/** @private */\n\nconst dragStart = 'dragStart';\n/** @private */\n\nconst drag = 'drag';\n/** @private */\n\nconst dragStop = 'dragStop';\n/** @private */\n\nconst resizeStart = 'resizeStart';\n/** @private */\n\nconst resizing = 'resizing';\n/** @private */\n\nconst resizeStop = 'resizeStop';\n/** @private */\n\nconst inlineClick = 'inlineClick';\n/**\n * Specifies schedule internal events\n */\n\n/** @private */\n\nconst initialLoad = 'initial-load';\n/** @private */\n\nconst initialEnd = 'initial-end';\n/** @private */\n\nconst print$1 = 'print';\n/** @private */\n\nconst dataReady = 'data-ready';\n/** @private */\n\nconst eventsLoaded = 'events-loaded';\n/** @private */\n\nconst contentReady = 'content-ready';\n/** @private */\n\nconst scroll = 'scroll';\n/** @private */\n\nconst virtualScroll = 'virtual-scroll';\n/** @private */\n\nconst scrollUiUpdate = 'scroll-ui-update';\n/** @private */\n\nconst uiUpdate = 'ui-update';\n/** @private */\n\nconst documentClick = 'document-click';\n/** @private */\n\nconst cellMouseDown = 'cell-mouse-down';\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\n/**\n * Schedule common utilities\n */\n\nconst WEEK_LENGTH = 7;\nconst DEFAULT_WEEKS = 6;\nconst MS_PER_DAY = 86400000;\nconst MS_PER_MINUTE = 60000;\n/**\n * Method to get height from element\n *\n * @param {Element} container Accepts the DOM element\n * @param {string} elementClass Accepts the element class\n * @returns {number} Returns the height of the element\n */\n\nfunction getElementHeightFromClass(container, elementClass) {\n  let height = 0;\n  const el = createElement('div', {\n    className: elementClass\n  }).cloneNode();\n  el.style.visibility = 'hidden';\n  el.style.position = 'absolute';\n  container.appendChild(el);\n  height = el.getBoundingClientRect().height;\n  remove(el);\n  return height;\n}\n/**\n * Method to get translateY value\n *\n * @param {HTMLElement | Element} element Accepts the DOM element\n * @returns {number} Returns the translateY value of given element\n */\n\n\nfunction getTranslateY(element) {\n  const style = getComputedStyle(element);\n  return window.WebKitCSSMatrix ? new WebKitCSSMatrix(style.webkitTransform).m42 : 0;\n}\n/**\n * Method to get week first date\n *\n * @param {Date} date Accepts the date object\n * @param {number} firstDayOfWeek Accepts the first day of week number\n * @returns {Date} Returns the date object\n */\n\n\nfunction getWeekFirstDate(date, firstDayOfWeek) {\n  const date1 = new Date(date.getTime());\n  firstDayOfWeek = (firstDayOfWeek - date1.getDay() + 7 * -1) % 7;\n  return new Date(date1.setDate(date1.getDate() + firstDayOfWeek));\n}\n/**\n * Method to get week last date\n *\n * @param {Date} date Accepts the date object\n * @param {number} firstDayOfWeek Accepts the first day of week number\n * @returns {Date} Returns the date object\n */\n\n\nfunction getWeekLastDate(date, firstDayOfWeek) {\n  const weekFirst = getWeekFirstDate(date, firstDayOfWeek);\n  const weekLast = new Date(weekFirst.getFullYear(), weekFirst.getMonth(), weekFirst.getDate() + 6);\n  return new Date(weekLast.getTime());\n}\n/**\n * Method to get first date of month\n *\n * @param {Date} date Accepts the date object\n * @returns {Date} Returns the date object\n */\n\n\nfunction firstDateOfMonth(date) {\n  return new Date(date.getFullYear(), date.getMonth(), 1);\n}\n/**\n * Method to get last date of month\n *\n * @param {Date} date Accepts the date object\n * @returns {Date} Returns the date object\n */\n\n\nfunction lastDateOfMonth(date) {\n  return new Date(date.getFullYear(), date.getMonth() + 1, 0);\n}\n/**\n * Method to get week number\n *\n * @param {Date} date Accepts the date object\n * @returns {number} Returns the week number\n */\n\n\nfunction getWeekNumber(date) {\n  const date1 = new Date(date.getFullYear(), 0, 1).valueOf();\n  const currentDate = new Date(date.getFullYear(), date.getMonth(), date.getDate()).valueOf();\n  const dayOfYear = (currentDate - date1 + MS_PER_DAY) / MS_PER_DAY;\n  return Math.ceil(dayOfYear / 7);\n}\n/**\n * Method to get week middle date\n *\n * @param {Date} weekFirst Accepts the week first date object\n * @param {Date} weekLast Accepts the week last date object\n * @returns {Date} Returns the date object\n */\n\n\nfunction getWeekMiddleDate(weekFirst, weekLast) {\n  return new Date(weekLast.valueOf() - (weekLast.valueOf() - weekFirst.valueOf()) / 2);\n}\n/**\n * Method to set time to date object\n *\n * @param {Date} date Accepts the date object\n * @param {number} time Accepts the milliseconds\n * @returns {Date} Returns the date object\n */\n\n\nfunction setTime(date, time) {\n  const tzOffsetBefore = date.getTimezoneOffset();\n  const d = new Date(date.getTime() + time);\n  const tzOffsetDiff = d.getTimezoneOffset() - tzOffsetBefore;\n  date.setTime(d.getTime() + tzOffsetDiff * MS_PER_MINUTE);\n  return date;\n}\n/**\n * Method the reset hours in date object\n *\n * @param {Date} date Accepts the date object\n * @returns {Date} Returns the date object\n */\n\n\nfunction resetTime(date) {\n  return new Date(date.getFullYear(), date.getMonth(), date.getDate());\n}\n/**\n * Method to get milliseconds from date object\n *\n * @param {Date} date Accepts the date object\n * @returns {number} Returns the milliseconds from date object\n */\n\n\nfunction getDateInMs(date) {\n  const localOffset = new Date(date.getFullYear(), date.getMonth(), date.getDate(), 0, 0, 0).getTimezoneOffset();\n  const dateOffset = date.getTimezoneOffset();\n  const timezoneOffset = dateOffset - localOffset;\n  return date.getTime() - new Date(date.getFullYear(), date.getMonth(), date.getDate(), 0, 0, 0).getTime() - timezoneOffset * 60 * 1000;\n}\n/**\n * Method to get date count between two dates\n *\n * @param {Date} startDate Accepts the date object\n * @param {Date} endDate Accepts the date object\n * @returns {number} Returns the date count\n */\n\n\nfunction getDateCount(startDate, endDate) {\n  return Math.ceil((endDate.getTime() - startDate.getTime()) / MS_PER_DAY);\n}\n/**\n * Method to add no of days in date object\n *\n * @param {Date} date Accepts the date object\n * @param {number} noOfDays Accepts the number of days count\n * @returns {Date} Returns the date object\n */\n\n\nfunction addDays(date, noOfDays) {\n  date = new Date('' + date);\n  return new Date(date.setDate(date.getDate() + noOfDays));\n}\n/**\n * Method to add no of months in date object\n *\n * @param {Date} date Accepts the date object\n * @param {number} noOfMonths Accepts the number of month count\n * @returns {Date} Returns the date object\n */\n\n\nfunction addMonths(date, noOfMonths) {\n  date = new Date('' + date);\n  const day = date.getDate();\n  date.setDate(1);\n  date.setMonth(date.getMonth() + noOfMonths);\n  date.setDate(Math.min(day, getMaxDays(date)));\n  return date;\n}\n/**\n * Method to add no of years in date object\n *\n * @param {Date} date Accepts the date object\n * @param {number} noOfYears Accepts the number of month count\n * @returns {Date} Returns the date object\n */\n\n\nfunction addYears(date, noOfYears) {\n  date = new Date('' + date);\n  const day = date.getDate();\n  date.setDate(1);\n  date.setFullYear(date.getFullYear() + noOfYears);\n  date.setDate(Math.min(day, getMaxDays(date)));\n  return date;\n}\n/**\n * Method to get start and end hours\n *\n * @param {Date} date Accepts the date object\n * @param {Date} startHour Accepts the start hour date object\n * @param {Date} endHour Accepts the end hour date object\n * @returns {Object} Returns the start and end hour date objects\n */\n\n\nfunction getStartEndHours(date, startHour, endHour) {\n  const date1 = new Date(date.getTime());\n  date1.setHours(startHour.getHours());\n  date1.setMinutes(startHour.getMinutes());\n  date1.setSeconds(startHour.getSeconds());\n  let date2 = new Date(date.getTime());\n\n  if (endHour.getHours() === 0) {\n    date2 = addDays(date2, 1);\n  } else {\n    date2.setHours(endHour.getHours());\n    date2.setMinutes(endHour.getMinutes());\n    date2.setSeconds(endHour.getSeconds());\n  }\n\n  return {\n    startHour: date1,\n    endHour: date2\n  };\n}\n/**\n * Method to get month last date\n *\n * @param {Date} date Accepts the date object\n * @returns {number} Returns the month last date\n */\n\n\nfunction getMaxDays(date) {\n  return lastDateOfMonth(date).getDate();\n}\n/**\n * Method to get days count between two dates\n *\n * @param {Date} startDate Accepts the date object\n * @param {Date} endDate Accepts the date object\n * @returns {number} Returns the days count\n */\n\n\nfunction getDaysCount(startDate, endDate) {\n  const strTime = resetTime(new Date(startDate));\n  const endTime = resetTime(new Date(endDate));\n  return Math.round((endTime.getTime() - strTime.getTime()) / MS_PER_DAY);\n}\n/**\n * Method to get date object from date string\n *\n * @param {string} date Accepts the date string\n * @returns {Date} Returns the date object\n */\n\n\nfunction getDateFromString(date) {\n  return date.indexOf('Date') !== -1 ? new Date(parseInt(date.match(/\\d+/g).toString(), 10)) : date.indexOf('T') !== -1 ? new Date(date) : new Date(date.replace(/-/g, '/'));\n}\n/** @private */\n\n\nlet scrollWidth = null;\n/**\n * Method to get scrollbar width\n *\n * @returns {number} Returns the scrollbar width\n * @private\n */\n\nfunction getScrollBarWidth() {\n  if (scrollWidth !== null) {\n    return scrollWidth;\n  }\n\n  const divNode = createElement('div');\n  let value = 0;\n  divNode.style.cssText = 'width:100px;height: 100px;overflow: scroll;position: absolute;top: -9999px;';\n  document.body.appendChild(divNode);\n  const ratio = devicePixelRatio ? devicePixelRatio.toFixed(2) === '1.10' || devicePixelRatio <= 1 ? Math.ceil(devicePixelRatio % 1) : Math.floor(devicePixelRatio % 1) : 0;\n  value = divNode.offsetWidth - divNode.clientWidth - ratio | 0;\n  document.body.removeChild(divNode);\n  return scrollWidth = value;\n}\n/**\n * Method to find the index from data collection\n *\n * @param {Object} data Accepts the data as object\n * @param {string} field Accepts the field name\n * @param {string} value Accepts the value name\n * @param {Object} event Accepts the data as object\n * @param {Object[]} resourceCollection Accepts the data collections\n * @returns {number} Returns the index number\n */\n// eslint-disable-next-line max-len\n\n\nfunction findIndexInData(data, field, value, event, resourceCollection) {\n  for (let i = 0, length = data.length; i < length; i++) {\n    if (data[i][field] === value) {\n      if (event) {\n        const field = resourceCollection.slice(-2)[0].field;\n        const res = event[field] instanceof Array ? event[field] : [event[field]];\n        const resData = res.join(',');\n\n        if (resData.includes(data[i][resourceCollection.slice(-1)[0].groupIDField])) {\n          return i;\n        }\n      } else {\n        return i;\n      }\n    }\n  }\n\n  return -1;\n}\n/**\n * Method to get element outer height\n *\n * @param {HTMLElement} element Accepts the DOM element\n * @returns {number} Returns the outer height of the given element\n */\n\n\nfunction getOuterHeight(element) {\n  const style = getComputedStyle(element);\n  return element.offsetHeight + (parseInt(style.marginTop, 10) || 0) + (parseInt(style.marginBottom, 10) || 0);\n}\n/**\n * Method to remove child elements\n *\n * @param {HTMLElement | Element} element Accepts the DOM element\n * @returns {void}\n */\n\n\nfunction removeChildren(element) {\n  const elementChildren = [].slice.call(element.children);\n\n  for (const elementChild of elementChildren) {\n    if (!elementChild.classList.contains('blazor-template')) {\n      element.removeChild(elementChild);\n    }\n  }\n}\n/**\n * Method to check DST is present or not in date object\n *\n * @param {Date} date Accepts the date object\n * @returns {boolean} Returns the boolean value for either DST is present or not\n */\n\n\nfunction isDaylightSavingTime(date) {\n  const jan = new Date(date.getFullYear(), 0, 1);\n  const jul = new Date(date.getFullYear(), 6, 1);\n  return date.getTimezoneOffset() < Math.max(jan.getTimezoneOffset(), jul.getTimezoneOffset());\n}\n/**\n * Method to get UTC time value from date\n *\n * @param {Date} date Accepts the date\n * @returns {number} Returns the UTC time value\n */\n\n\nfunction getUniversalTime(date) {\n  const year = date.getFullYear();\n  const month = date.getMonth();\n  const day = date.getDate();\n  const hours = date.getHours();\n  const minutes = date.getMinutes();\n  const seconds = date.getSeconds();\n  const milliseconds = date.getMilliseconds();\n  return Date.UTC(year, month, day, hours, minutes, seconds, milliseconds);\n}\n/**\n * Method to check the device\n *\n * @returns {boolean} Returns the boolean value for either device is present or not.\n */\n\n\nfunction isMobile() {\n  return window.navigator.userAgent.toLowerCase().indexOf('mobi') > -1;\n}\n/**\n * Method to check the IPad device\n *\n * @returns {boolean} Returns the boolean value for either IPad device is present or not.\n */\n\n\nfunction isIPadDevice() {\n  return window.navigator.userAgent.toLowerCase().indexOf('ipad') > -1;\n}\n/**\n * Method to capitalize the first word in string\n *\n * @param {string} inputString Accepts the string value\n * @param {string} type Accepts the string type\n * @returns {string} Returns the output string\n */\n\n\nfunction capitalizeFirstWord(inputString, type) {\n  if (type === 'multiple') {\n    inputString = inputString.split(' ').map(e => e.charAt(0).toLocaleUpperCase() + e.substring(1)).join(' ');\n  } else if (type === 'single') {\n    if (inputString[0] >= '0' && inputString[0] <= '9') {\n      const array = inputString.match(/[a-zA-Z]/);\n      inputString = isNullOrUndefined(array) ? inputString : inputString.slice(0, array.index) + inputString[array.index].toLocaleUpperCase() + inputString.slice(array.index + 1);\n    }\n\n    inputString = inputString[0].toLocaleUpperCase() + inputString.slice(1);\n  }\n\n  return inputString;\n}\n/**\n * CSS Constants\n */\n\n/** @private */\n\n\nconst ROOT = 'e-schedule';\n/** @private */\n\nconst RTL = 'e-rtl';\n/** @private */\n\nconst DEVICE_CLASS = 'e-device';\n/** @private */\n\nconst MULTI_DRAG = 'e-multi-drag';\n/** @private */\n\nconst ICON = 'e-icons';\n/** @private */\n\nconst ENABLE_CLASS = 'e-enable';\n/** @private */\n\nconst DISABLE_CLASS = 'e-disable';\n/** @private */\n\nconst TABLE_CONTAINER_CLASS = 'e-table-container';\n/** @private */\n\nconst SCHEDULE_TABLE_CLASS = 'e-schedule-table';\n/** @private */\n\nconst ALLDAY_CELLS_CLASS = 'e-all-day-cells';\n/** @private */\n\nconst HEADER_POPUP_CLASS = 'e-header-popup';\n/** @private */\n\nconst HEADER_CALENDAR_CLASS = 'e-header-calendar';\n/** @private */\n\nconst ALLDAY_ROW_CLASS = 'e-all-day-row';\n/** @private */\n\nconst CONTENT_TABLE_CLASS = 'e-content-table';\n/** @private */\n\nconst WORK_CELLS_CLASS = 'e-work-cells';\n/** @private */\n\nconst WORK_HOURS_CLASS = 'e-work-hours';\n/** @private */\n\nconst POPUP_OPEN = 'e-popup-open';\n/** @private */\n\n/** @private */\n\nconst DATE_HEADER_WRAP_CLASS = 'e-date-header-wrap';\n/** @private */\n\nconst DATE_HEADER_CONTAINER_CLASS = 'e-date-header-container';\n/** @private */\n\nconst HEADER_CELLS_CLASS = 'e-header-cells';\n/** @private */\n\nconst HEADER_WEEK_CELLS_CLASS = 'e-header-week-cell';\n/** @private */\n\nconst HEADER_MONTH_CELLS_CLASS = 'e-header-month-cell';\n/** @private */\n\nconst HEADER_YEAR_CELLS_CLASS = 'e-header-year-cell';\n/** @private */\n\nconst WORKDAY_CLASS = 'e-work-days';\n/** @private */\n\nconst OTHERMONTH_CLASS = 'e-other-month';\n/** @private */\n\nconst CURRENT_DAY_CLASS = 'e-current-day';\n/** @private */\n\nconst CURRENTDATE_CLASS = 'e-current-date';\n/** @private */\n\nconst CURRENT_PANEL_CLASS = 'e-current-panel';\n/** @private */\n\nconst PREVIOUS_PANEL_CLASS = 'e-previous-panel';\n/** @private */\n\nconst NEXT_PANEL_CLASS = 'e-next-panel';\n/** @private */\n\nconst PREVIOUS_DATE_CLASS = 'e-prev';\n/** @private */\n\nconst NEXT_DATE_CLASS = 'e-next';\n/** @private */\n\nconst TRANSLATE_CLASS = 'e-translate';\n/** @private */\n\nconst LEFT_INDENT_CLASS = 'e-left-indent';\n/** @private */\n\nconst LEFT_INDENT_WRAP_CLASS = 'e-left-indent-wrap';\n/** @private */\n\nconst EVENT_TABLE_CLASS = 'e-event-table';\n/** @private */\n\nconst RESOURCE_LEFT_TD_CLASS = 'e-resource-left-td';\n/** @private */\n\nconst RESOURCE_GROUP_CELLS_CLASS = 'e-resource-group-cells';\n/** @private */\n\nconst RESOURCE_TEXT_CLASS = 'e-resource-text';\n/** @private */\n\nconst RESOURCE_COLUMN_WRAP_CLASS = 'e-resource-column-wrap';\n/** @private */\n\nconst RESOURCE_COLUMN_TABLE_CLASS = 'e-resource-column-table';\n/** @private */\n\nconst RESOURCE_CHILD_CLASS = 'e-child-node';\n/** @private */\n\nconst RESOURCE_PARENT_CLASS = 'e-parent-node';\n/** @private */\n\nconst RESOURCE_EXPAND_CLASS = 'e-resource-expand';\n/** @private */\n\nconst RESOURCE_COLLAPSE_CLASS = 'e-resource-collapse';\n/** @private */\n\nconst RESOURCE_TREE_ICON_CLASS = 'e-resource-tree-icon';\n/** @private */\n\nconst RESOURCE_CELLS_CLASS = 'e-resource-cells';\n/** @private */\n\nconst TIME_CELLS_WRAP_CLASS = 'e-time-cells-wrap';\n/** @private */\n\nconst TIME_CELLS_CLASS = 'e-time-cells';\n/** @private */\n\nconst TIME_SLOT_CLASS = 'e-time-slots';\n/** @private */\n\nconst ALTERNATE_CELLS_CLASS = 'e-alternate-cells';\n/** @private */\n\nconst CURRENT_TIME_CLASS = 'e-current-time';\n/** @private */\n\nconst CURRENT_TIMELINE_CLASS = 'e-current-timeline';\n/** @private */\n\nconst PREVIOUS_TIMELINE_CLASS = 'e-previous-timeline';\n/** @private */\n\nconst HIDE_CHILDS_CLASS = 'e-hide-childs';\n/** @private */\n\nconst SCROLL_CONTAINER_CLASS = 'e-scroll-container';\n/** @private */\n\n/** @private */\n\nconst TIMELINE_WRAPPER_CLASS = 'e-timeline-wrapper';\n/** @private */\n\nconst APPOINTMENT_WRAPPER_CLASS = 'e-appointment-wrapper';\n/** @private */\n\nconst DAY_WRAPPER_CLASS = 'e-day-wrapper';\n/** @private */\n\nconst TOOLBAR_CONTAINER = 'e-schedule-toolbar-container';\n/** @private */\n\nconst RESOURCE_TOOLBAR_CONTAINER = 'e-schedule-resource-toolbar-container';\n/** @private */\n\nconst HEADER_TOOLBAR = 'e-schedule-toolbar';\n/** @private */\n\nconst RESOURCE_HEADER_TOOLBAR = 'e-schedule-resource-toolbar';\n/** @private */\n\nconst SELECTED_CELL_CLASS = 'e-selected-cell';\n/** @private */\n\nconst WEEK_NUMBER_WRAPPER_CLASS = 'e-week-number-wrapper';\n/** @private */\n\nconst WEEK_NUMBER_CLASS = 'e-week-number';\n/** @private */\n\nconst APPOINTMENT_WRAP_CLASS = 'e-appointment-wrap';\n/** @private */\n\nconst WRAPPER_CONTAINER_CLASS = 'e-wrapper-container';\n/** @private */\n\nconst APPOINTMENT_CONTAINER_CLASS = 'e-appointment-container';\n/** @private */\n\nconst APPOINTMENT_CLASS = 'e-appointment';\n/** @private */\n\nconst BLOCK_APPOINTMENT_CLASS = 'e-block-appointment';\n/** @private */\n\nconst BLOCK_INDICATOR_CLASS = 'e-block-indicator';\n/** @private */\n\nconst APPOINTMENT_BORDER = 'e-appointment-border';\n/** @private */\n\nconst APPOINTMENT_DETAILS = 'e-appointment-details';\n/** @private */\n\nconst SUBJECT_WRAP = 'e-subject-wrap';\n/** @private */\n\nconst RESOURCE_NAME = 'e-resource-name';\n/** @private */\n\nconst APPOINTMENT_TIME = 'e-time';\n/** @private */\n\nconst TABLE_WRAP_CLASS = 'e-table-wrap';\n/** @private */\n\nconst OUTER_TABLE_CLASS = 'e-outer-table';\n/** @private */\n\nconst CONTENT_WRAP_CLASS = 'e-content-wrap';\n/** @private */\n\nconst VIRTUAL_TRACK_CLASS = 'e-virtual-track';\n/** @private */\n\nconst AGENDA_CELLS_CLASS = 'e-agenda-cells';\n/** @private */\n\nconst AGENDA_CURRENT_DAY_CLASS = 'e-current-day';\n/** @private */\n\nconst AGENDA_SELECTED_CELL = 'e-active-appointment-agenda';\n/** @private */\n\nconst MONTH_HEADER_CLASS = 'e-month-header';\n/** @private */\n\nconst AGENDA_HEADER_CLASS = 'e-day-date-header';\n/** @private */\n\nconst AGENDA_RESOURCE_CLASS = 'e-resource-column';\n/** @private */\n\nconst AGENDA_DATE_CLASS = 'e-date-column';\n/** @private */\n\nconst NAVIGATE_CLASS = 'e-navigate';\n/** @private */\n\nconst DATE_HEADER_CLASS = 'e-date-header';\n/** @private */\n\nconst AGENDA_DAY_BORDER_CLASS = 'e-day-border';\n/** @private */\n\nconst DATE_BORDER_CLASS = 'e-date-border';\n/** @private */\n\nconst AGENDA_DAY_PADDING_CLASS = 'e-day-padding';\n/** @private */\n\nconst DATE_TIME_CLASS = 'e-date-time';\n/** @private */\n\nconst DATE_TIME_WRAPPER_CLASS = 'e-date-time-wrapper';\n/** @private */\n\nconst AGENDA_EMPTY_EVENT_CLASS = 'e-empty-event';\n/** @private */\n\nconst AGENDA_NO_EVENT_CLASS = 'e-no-event';\n/** @private */\n\nconst APPOINTMENT_INDICATOR_CLASS = 'e-appointment-indicator';\n/** @private */\n\nconst EVENT_INDICATOR_CLASS = 'e-indicator';\n/** @private */\n\nconst EVENT_ICON_UP_CLASS = 'e-up-icon';\n/** @private */\n\nconst EVENT_ICON_DOWN_CLASS = 'e-down-icon';\n/** @private */\n\nconst EVENT_ICON_LEFT_CLASS = 'e-left-icon';\n/** @private */\n\nconst EVENT_ICON_RIGHT_CLASS = 'e-right-icon';\n/** @private */\n\nconst EVENT_ACTION_CLASS = 'e-event-action';\n/** @private */\n\nconst NEW_EVENT_CLASS = 'e-new-event';\n/** @private */\n\nconst CLONE_ELEMENT_CLASS = 'e-schedule-event-clone';\n/** @private */\n\nconst MONTH_CLONE_ELEMENT_CLASS = 'e-month-event';\n/** @private */\n\nconst CLONE_TIME_INDICATOR_CLASS = 'e-clone-time-indicator';\n/** @private */\n\nconst DRAG_CLONE_CLASS = 'e-drag-clone';\n/** @private */\n\nconst EVENT_RESIZE_CLASS = 'e-event-resize';\n/** @private */\n\nconst RESIZE_CLONE_CLASS = 'e-resize-clone';\n/** @private */\n\nconst LEFT_RESIZE_HANDLER = 'e-left-handler';\n/** @private */\n\nconst RIGHT_RESIZE_HANDLER = 'e-right-handler';\n/** @private */\n\nconst TOP_RESIZE_HANDLER = 'e-top-handler';\n/** @private */\n\nconst BOTTOM_RESIZE_HANDLER = 'e-bottom-handler';\n/** @private */\n\nconst EVENT_RECURRENCE_ICON_CLASS = 'e-recurrence-icon';\n/** @private */\n\nconst EVENT_RECURRENCE_EDIT_ICON_CLASS = 'e-recurrence-edit-icon';\n/** @private */\n\nconst HEADER_ROW_CLASS = 'e-header-row';\n/** @private */\n\nconst ALLDAY_APPOINTMENT_WRAPPER_CLASS = 'e-all-day-appointment-wrapper';\n/** @private */\n\nconst ALLDAY_APPOINTMENT_CLASS = 'e-all-day-appointment';\n/** @private */\n\nconst EVENT_COUNT_CLASS = 'e-appointment-hide';\n/** @private */\n\nconst ROW_COUNT_WRAPPER_CLASS = 'e-row-count-wrapper';\n/** @private */\n\nconst ALLDAY_APPOINTMENT_SECTION_CLASS = 'e-all-day-appointment-section';\n/** @private */\n\nconst APPOINTMENT_ROW_EXPAND_CLASS = 'e-appointment-expand';\n/** @private */\n\nconst APPOINTMENT_ROW_COLLAPSE_CLASS = 'e-appointment-collapse';\n/** @private */\n\nconst MORE_INDICATOR_CLASS = 'e-more-indicator';\n/** @private */\n\nconst CELL_POPUP_CLASS = 'e-cell-popup';\n/** @private */\n\nconst EVENT_POPUP_CLASS = 'e-event-popup';\n/** @private */\n\nconst MULTIPLE_EVENT_POPUP_CLASS = 'e-multiple-event-popup';\n/** @private */\n\nconst POPUP_HEADER_CLASS = 'e-popup-header';\n/** @private */\n\nconst POPUP_HEADER_ICON_WRAPPER = 'e-header-icon-wrapper';\n/** @private */\n\nconst POPUP_CONTENT_CLASS = 'e-popup-content';\n/** @private */\n\nconst POPUP_FOOTER_CLASS = 'e-popup-footer';\n/** @private */\n\nconst DATE_TIME_DETAILS_CLASS = 'e-date-time-details';\n/** @private */\n\nconst RECURRENCE_SUMMARY_CLASS = 'e-recurrence-summary';\n/** @private */\n\nconst QUICK_POPUP_EVENT_DETAILS_CLASS = 'e-event-details';\n/** @private */\n\nconst EVENT_CREATE_CLASS = 'e-event-create';\n/** @private */\n\nconst EDIT_EVENT_CLASS = 'e-event-edit';\n/** @private */\n\nconst DELETE_EVENT_CLASS = 'e-event-delete';\n/** @private */\n\nconst TEXT_ELLIPSIS = 'e-text-ellipsis';\n/** @private */\n\nconst MORE_POPUP_WRAPPER_CLASS = 'e-more-popup-wrapper';\n/** @private */\n\nconst MORE_EVENT_POPUP_CLASS = 'e-more-event-popup';\n/** @private */\n\nconst MORE_EVENT_HEADER_CLASS = 'e-more-event-header';\n/** @private */\n\nconst MORE_EVENT_DATE_HEADER_CLASS = 'e-more-event-date-header';\n/** @private */\n\nconst MORE_EVENT_HEADER_DAY_CLASS = 'e-header-day';\n/** @private */\n\nconst MORE_EVENT_HEADER_DATE_CLASS = 'e-header-date';\n/** @private */\n\nconst MORE_EVENT_CLOSE_CLASS = 'e-more-event-close';\n/** @private */\n\nconst MORE_EVENT_CONTENT_CLASS = 'e-more-event-content';\n/** @private */\n\nconst MORE_EVENT_WRAPPER_CLASS = 'e-more-appointment-wrapper';\n/** @private */\n\nconst QUICK_DIALOG_CLASS = 'e-quick-dialog';\n/** @private */\n\nconst QUICK_DIALOG_OCCURRENCE_CLASS = 'e-quick-dialog-occurrence-event';\n/** @private */\n\nconst QUICK_DIALOG_SERIES_CLASS = 'e-quick-dialog-series-event';\n/** @private */\n\nconst QUICK_DIALOG_FOLLOWING_EVENTS_CLASS = 'e-quick-dialog-following-events';\n/** @private */\n\nconst FOLLOWING_EVENTS_DIALOG = 'e-following-events-dialog';\n/** @private */\n\nconst QUICK_DIALOG_DELETE_CLASS = 'e-quick-dialog-delete';\n/** @private */\n\nconst QUICK_DIALOG_CANCEL_CLASS = 'e-quick-dialog-cancel';\n/** @private */\n\nconst QUICK_DIALOG_ALERT_OK = 'e-quick-alertok';\n/** @private */\n\nconst QUICK_DIALOG_ALERT_CANCEL = 'e-quick-alertcancel';\n/** @private */\n\nconst QUICK_DIALOG_ALERT_FOLLOWING = 'e-quick-alertfollowing';\n/** @private */\n\nconst QUICK_DIALOG_ALERT_BTN_CLASS = 'e-quick-dialog-alert-btn';\n/** @private */\n\nconst EVENT_WINDOW_DIALOG_CLASS = 'e-schedule-dialog';\n/** @private */\n\nconst FORM_CONTAINER_CLASS = 'e-form-container';\n/** @private */\n\nconst FORM_CLASS = 'e-schedule-form';\n/** @private */\n\nconst EVENT_WINDOW_ALLDAY_TZ_DIV_CLASS = 'e-all-day-time-zone-row';\n/** @private */\n\nconst EVENT_WINDOW_ALL_DAY_CLASS = 'e-all-day';\n/** @private */\n\nconst TIME_ZONE_CLASS = 'e-time-zone';\n/** @private */\n\nconst TIME_ZONE_ICON_CLASS = 'e-time-zone-icon';\n/** @private */\n\nconst TIME_ZONE_DETAILS_CLASS = 'e-time-zone-details';\n/** @private */\n\nconst EVENT_WINDOW_REPEAT_DIV_CLASS = 'e-repeat-parent-row';\n/** @private */\n\nconst EVENT_WINDOW_REPEAT_CLASS = 'e-repeat';\n/** @private */\n\nconst EVENT_WINDOW_TITLE_LOCATION_DIV_CLASS = 'e-title-location-row';\n/** @private */\n\nconst SUBJECT_CLASS = 'e-subject';\n/** @private */\n\nconst LOCATION_CLASS = 'e-location';\n/** @private */\n\nconst LOCATION_ICON_CLASS = 'e-location-icon';\n/** @private */\n\nconst LOCATION_DETAILS_CLASS = 'e-location-details';\n/** @private */\n\nconst EVENT_WINDOW_START_END_DIV_CLASS = 'e-start-end-row';\n/** @private */\n\nconst EVENT_WINDOW_START_CLASS = 'e-start';\n/** @private */\n\nconst EVENT_WINDOW_END_CLASS = 'e-end';\n/** @private */\n\nconst EVENT_WINDOW_RESOURCES_DIV_CLASS = 'e-resources-row';\n/** @private */\n\nconst DESCRIPTION_CLASS = 'e-description';\n/** @private */\n\nconst DESCRIPTION_ICON_CLASS = 'e-description-icon';\n/** @private */\n\nconst DESCRIPTION_DETAILS_CLASS = 'e-description-details';\n/** @private */\n\nconst EVENT_WINDOW_TIME_ZONE_DIV_CLASS = 'e-time-zone-row';\n/** @private */\n\nconst EVENT_WINDOW_START_TZ_CLASS = 'e-start-time-zone';\n/** @private */\n\nconst EVENT_WINDOW_END_TZ_CLASS = 'e-end-time-zone';\n/** @private */\n\nconst EVENT_WINDOW_BACK_ICON_CLASS = 'e-back-icon';\n/** @private */\n\nconst EVENT_WINDOW_SAVE_ICON_CLASS = 'e-save-icon';\n/** @private */\n\nconst EVENT_WINDOW_CANCEL_BUTTON_CLASS = 'e-event-cancel';\n/** @private */\n\nconst EVENT_WINDOW_SAVE_BUTTON_CLASS = 'e-event-save';\n/** @private */\n\nconst EVENT_WINDOW_DIALOG_PARENT_CLASS = 'e-dialog-parent';\n/** @private */\n\nconst EVENT_WINDOW_TITLE_TEXT_CLASS = 'e-title-text';\n/** @private */\n\nconst EVENT_WINDOW_ICON_DISABLE_CLASS = 'e-icon-disable';\n/** @private */\n\nconst EDIT_CLASS = 'e-edit';\n/** @private */\n\nconst EDIT_ICON_CLASS = 'e-edit-icon';\n/** @private */\n\nconst DELETE_CLASS = 'e-delete';\n/** @private */\n\nconst DELETE_ICON_CLASS = 'e-delete-icon';\n/** @private */\n\nconst CLOSE_CLASS = 'e-close';\n/** @private */\n\nconst CLOSE_ICON_CLASS = 'e-close-icon';\n/** @private */\n\nconst ERROR_VALIDATION_CLASS = 'e-schedule-error';\n/** @private */\n\nconst EVENT_TOOLTIP_ROOT_CLASS = 'e-schedule-event-tooltip';\n/** @private */\n\nconst ALLDAY_ROW_ANIMATE_CLASS = 'e-animate';\n/** @private */\n\nconst TIMESCALE_DISABLE = 'e-timescale-disable';\n/** @private */\n\nconst DISABLE_DATE = 'e-disable-date';\n/** @private */\n\nconst HIDDEN_CLASS = 'e-hidden';\n/** @private */\n\nconst DISABLE_DATES = 'e-disable-dates';\n/** @private */\n\nconst POPUP_WRAPPER_CLASS = 'e-quick-popup-wrapper';\n/** @private */\n\nconst POPUP_TABLE_CLASS = 'e-popup-table';\n/** @private */\n\nconst RESOURCE_MENU = 'e-resource-menu';\n/** @private */\n\nconst RESOURCE_MENU_ICON = 'e-icon-menu';\n/** @private */\n\nconst RESOURCE_LEVEL_TITLE = 'e-resource-level-title';\n/** @private */\n\nconst RESOURCE_TREE = 'e-resource-tree';\n/** @private */\n\nconst RESOURCE_TREE_POPUP_OVERLAY = 'e-resource-tree-popup-overlay';\n/** @private */\n\nconst RESOURCE_TREE_POPUP = 'e-resource-tree-popup';\n/** @private */\n\nconst RESOURCE_CLASS = 'e-resource';\n/** @private */\n\nconst RESOURCE_ICON_CLASS = 'e-resource-icon';\n/** @private */\n\nconst RESOURCE_DETAILS_CLASS = 'e-resource-details';\n/** @private */\n\nconst DATE_TIME_ICON_CLASS = 'e-date-time-icon';\n/** @private */\n\nconst VIRTUAL_SCROLL_CLASS = 'e-virtual-scroll';\n/** @private */\n\nconst ICON_DISABLE_CLASS = 'e-icon-disable';\n/** @private */\n\nconst AUTO_HEIGHT = 'e-auto-height';\n/** @private */\n\nconst IGNORE_WHITESPACE = 'e-ignore-whitespace';\n/** @private */\n\nconst EVENT_TEMPLATE = 'e-template';\n/** @private */\n\nconst READ_ONLY = 'e-read-only';\n/** @private */\n\nconst MONTH_HEADER_WRAPPER = 'e-month-header-wrapper';\n/** @private */\n\nconst INLINE_SUBJECT_CLASS = 'e-inline-subject';\n/** @private */\n\nconst INLINE_APPOINTMENT_CLASS = 'e-inline-appointment';\n/** @hidden */\n\nconst SCROLL_HIDDEN = 'e-scroll-hidden';\n/** @private */\n\nconst ALLDAY_APPOINTMENT_SCROLL = 'e-all-day-scroll';\n/** @private */\n\nconst ALLDAY_APPOINTMENT_AUTO = 'e-all-day-auto';\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\n/**\n * Header module\n */\n\nclass HeaderRenderer {\n  constructor(parent) {\n    this.parent = parent;\n    this.l10n = this.parent.localeObj;\n    this.renderHeader();\n    this.addEventListener();\n  }\n\n  addEventListener() {\n    this.parent.on(documentClick, this.closeHeaderPopup, this);\n  }\n\n  removeEventListener() {\n    this.parent.off(documentClick, this.closeHeaderPopup);\n  }\n\n  closeHeaderPopup(e) {\n    const closestEle = closest(e.event.target, '.e-date-range,.e-header-popup,.e-day,.e-selected');\n    const closestPop = closest(e.event.target, '.e-hor-nav,.e-toolbar-pop');\n    const contentWrap = this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS);\n\n    if (this.parent.isAdaptive) {\n      if (!isNullOrUndefined(closestPop) && (closestPop.classList.contains('e-toolbar-pop') || closestPop.classList.contains('e-hor-nav')) && !(closestPop.classList.contains('e-hor-nav') && this.element.querySelector('.e-toolbar-pop').classList.contains(POPUP_OPEN))) {\n        addClass([contentWrap], SCROLL_HIDDEN);\n      } else {\n        removeClass([contentWrap], SCROLL_HIDDEN);\n        const popupEle = this.element.querySelector('.e-toolbar-pop');\n\n        if (!isNullOrUndefined(popupEle)) {\n          const popupObj = popupEle.ej2_instances[0];\n\n          if (popupObj && !(!isNullOrUndefined(closestPop) && closestPop.classList.contains('e-hor-nav') && popupEle.classList.contains(POPUP_OPEN))) {\n            popupObj.hide();\n          }\n        }\n      }\n    }\n\n    if (!isNullOrUndefined(closestEle)) {\n      return;\n    }\n\n    this.hideHeaderPopup();\n  }\n\n  hideHeaderPopup() {\n    if (this.headerPopup) {\n      this.headerPopup.hide();\n    }\n  }\n\n  renderHeader() {\n    this.element = createElement('div', {\n      className: TOOLBAR_CONTAINER\n    });\n    const toolbarEle = createElement('div', {\n      className: HEADER_TOOLBAR\n    });\n    this.element.appendChild(toolbarEle);\n    this.parent.element.insertBefore(this.element, this.parent.element.firstElementChild);\n    this.renderToolbar();\n  }\n\n  renderToolbar() {\n    const items = this.getItems();\n    this.parent.trigger(actionBegin, {\n      requestType: 'toolbarItemRendering',\n      items: items\n    }, args => {\n      this.toolbarObj = new Toolbar({\n        items: args.items,\n        overflowMode: 'Popup',\n        clicked: this.toolbarClickHandler.bind(this),\n        enableRtl: this.parent.enableRtl,\n        locale: this.parent.locale\n      });\n      this.toolbarObj.appendTo(this.parent.element.querySelector('.' + HEADER_TOOLBAR));\n      const prevNavEle = this.toolbarObj.element.querySelector('.e-prev');\n\n      if (prevNavEle) {\n        prevNavEle.firstElementChild.setAttribute('title', this.l10n.getConstant('previous'));\n      }\n\n      const nextNavEle = this.toolbarObj.element.querySelector('.e-next');\n\n      if (nextNavEle) {\n        nextNavEle.firstElementChild.setAttribute('title', this.l10n.getConstant('next'));\n      }\n\n      this.updateAddIcon();\n      this.updateActiveView();\n      this.parent.trigger(actionComplete, {\n        requestType: 'toolBarItemRendered',\n        items: this.toolbarObj.items\n      });\n    });\n  }\n\n  updateItems() {\n    if (this.toolbarObj) {\n      const items = this.getItems();\n      this.parent.trigger(actionBegin, {\n        requestType: 'toolbarItemRendering',\n        items: items\n      }, args => {\n        this.toolbarObj.items = args.items;\n        this.toolbarObj.dataBind();\n        this.parent.trigger(actionComplete, {\n          requestType: 'toolBarItemRendered',\n          items: this.toolbarObj.items\n        });\n      });\n    }\n  }\n\n  getPopUpRelativeElement() {\n    if (this.parent.isAdaptive) {\n      return this.toolbarObj.element;\n    }\n\n    return this.element.querySelector('.e-date-range');\n  }\n\n  setDayOfWeek(index) {\n    if (this.headerCalendar) {\n      this.headerCalendar.firstDayOfWeek = index;\n      this.headerCalendar.dataBind();\n    }\n  }\n\n  setCalendarDate(date) {\n    if (this.headerCalendar) {\n      this.headerCalendar.value = date;\n      this.headerCalendar.dataBind();\n    }\n  }\n\n  setCalendarMinMaxDate() {\n    if (this.headerCalendar) {\n      this.headerCalendar.min = this.parent.minDate;\n      this.headerCalendar.max = this.parent.maxDate;\n      this.headerCalendar.dataBind();\n    }\n  }\n\n  getCalendarView() {\n    if (['Month', 'MonthAgenda', 'TimelineMonth'].indexOf(this.parent.currentView) > -1) {\n      return 'Year';\n    } else if (['Year', 'TimelineYear'].indexOf(this.parent.currentView) > -1) {\n      return 'Decade';\n    } else {\n      return 'Month';\n    }\n  }\n\n  setCalendarView() {\n    if (this.headerCalendar) {\n      const calendarView = this.getCalendarView();\n      this.headerCalendar.depth = calendarView;\n      this.headerCalendar.start = calendarView;\n      this.headerCalendar.refresh();\n    }\n  }\n\n  updateActiveView() {\n    const selEle = [].slice.call(this.toolbarObj.element.querySelectorAll('.e-views'));\n    removeClass(selEle, ['e-active-view']);\n\n    if (selEle.length > 0 && selEle[this.parent.viewIndex]) {\n      addClass([selEle[this.parent.viewIndex]], ['e-active-view']);\n    }\n  }\n\n  updateDateRange(text) {\n    const selEle = this.toolbarObj.element.querySelector('.e-date-range');\n\n    if (selEle) {\n      selEle.setAttribute('aria-label', text);\n      selEle.querySelector('.e-tbar-btn-text').innerHTML = text;\n      this.refresh();\n    }\n  }\n\n  refresh() {\n    if (this.toolbarObj) {\n      this.toolbarObj.refreshOverflow();\n    }\n  }\n\n  updateAddIcon() {\n    const addEle = this.toolbarObj.element.querySelector('.e-add');\n\n    if (addEle) {\n      if (!this.parent.eventSettings.allowAdding) {\n        addClass([addEle], HIDDEN_CLASS);\n      } else {\n        removeClass([addEle], HIDDEN_CLASS);\n      }\n    }\n  }\n\n  getDateRangeText() {\n    const dateString = this.parent.globalize.formatDate(this.parent.selectedDate, {\n      format: 'MMMM y',\n      calendar: this.parent.getCalendarMode()\n    });\n    return capitalizeFirstWord(dateString, 'single');\n  }\n\n  getItems() {\n    const items = [];\n    items.push({\n      align: 'Left',\n      prefixIcon: 'e-icon-prev',\n      tooltipText: 'Previous',\n      overflow: 'Show',\n      cssClass: 'e-prev',\n      htmlAttributes: {\n        'aria-label': 'previous period',\n        'role': 'navigation'\n      }\n    });\n    items.push({\n      align: 'Left',\n      prefixIcon: 'e-icon-next',\n      tooltipText: 'Next',\n      overflow: 'Show',\n      cssClass: 'e-next',\n      htmlAttributes: {\n        'aria-label': 'next period',\n        'role': 'navigation'\n      }\n    });\n    items.push({\n      align: 'Left',\n      text: this.getDateRangeText(),\n      suffixIcon: 'e-icon-down-arrow',\n      cssClass: 'e-date-range',\n      overflow: 'Show',\n      htmlAttributes: {\n        'aria-atomic': 'true',\n        'aria-live': 'assertive',\n        'aria-label': 'title',\n        'role': 'navigation'\n      }\n    });\n\n    if (this.parent.isAdaptive || this.parent.enableAdaptiveUI) {\n      items.push({\n        align: 'Right',\n        showAlwaysInPopup: this.parent.isAdaptive || this.parent.enableAdaptiveUI,\n        prefixIcon: 'e-icon-add',\n        text: this.l10n.getConstant('newEvent'),\n        cssClass: 'e-add',\n        overflow: 'Show'\n      });\n      items.push({\n        align: 'Right',\n        showAlwaysInPopup: this.parent.isAdaptive || this.parent.enableAdaptiveUI,\n        prefixIcon: 'e-icon-today',\n        text: this.l10n.getConstant('today'),\n        cssClass: 'e-today',\n        overflow: 'Show'\n      });\n    } else {\n      items.push({\n        align: 'Right',\n        showAlwaysInPopup: this.parent.isAdaptive || this.parent.enableAdaptiveUI,\n        prefixIcon: 'e-icon-day',\n        text: this.l10n.getConstant('today'),\n        cssClass: 'e-today',\n        overflow: 'Show'\n      });\n\n      if (this.parent.views.length > 1) {\n        items.push({\n          align: 'Right',\n          type: 'Separator',\n          cssClass: 'e-schedule-seperator'\n        });\n      }\n    }\n\n    if (this.parent.views.length > 1) {\n      for (const item of this.parent.views) {\n        items.push(this.getItemObject(item));\n      }\n    }\n\n    return items;\n  }\n\n  getItemObject(item) {\n    let viewName;\n    let displayName;\n\n    if (typeof item === 'string') {\n      viewName = item.toLowerCase();\n      displayName = null;\n    } else {\n      viewName = item.option.toLowerCase();\n      displayName = item.displayName;\n    }\n\n    let view;\n    let orientationClass;\n    const isItemInsidePopup = this.parent.isAdaptive || this.parent.enableAdaptiveUI;\n\n    switch (viewName) {\n      case 'day':\n        view = {\n          align: 'Right',\n          showAlwaysInPopup: isItemInsidePopup,\n          prefixIcon: 'e-icon-day',\n          text: displayName || this.l10n.getConstant('day'),\n          cssClass: 'e-views e-day'\n        };\n        break;\n\n      case 'week':\n        view = {\n          align: 'Right',\n          showAlwaysInPopup: isItemInsidePopup,\n          prefixIcon: 'e-icon-week',\n          text: displayName || this.l10n.getConstant('week'),\n          cssClass: 'e-views e-week'\n        };\n        break;\n\n      case 'workweek':\n        view = {\n          align: 'Right',\n          showAlwaysInPopup: isItemInsidePopup,\n          prefixIcon: 'e-icon-workweek',\n          text: displayName || this.l10n.getConstant('workWeek'),\n          cssClass: 'e-views e-work-week'\n        };\n        break;\n\n      case 'month':\n        view = {\n          align: 'Right',\n          showAlwaysInPopup: isItemInsidePopup,\n          prefixIcon: 'e-icon-month',\n          text: displayName || this.l10n.getConstant('month'),\n          cssClass: 'e-views e-month'\n        };\n        break;\n\n      case 'year':\n        view = {\n          align: 'Right',\n          showAlwaysInPopup: isItemInsidePopup,\n          prefixIcon: 'e-icon-year',\n          text: displayName || this.l10n.getConstant('year'),\n          cssClass: 'e-views e-year'\n        };\n        break;\n\n      case 'agenda':\n        view = {\n          align: 'Right',\n          showAlwaysInPopup: isItemInsidePopup,\n          prefixIcon: 'e-icon-agenda',\n          text: displayName || this.l10n.getConstant('agenda'),\n          cssClass: 'e-views e-agenda'\n        };\n        break;\n\n      case 'monthagenda':\n        view = {\n          align: 'Right',\n          showAlwaysInPopup: isItemInsidePopup,\n          prefixIcon: 'e-icon-month-agenda',\n          text: displayName || this.l10n.getConstant('monthAgenda'),\n          cssClass: 'e-views e-month-agenda'\n        };\n        break;\n\n      case 'timelineday':\n        view = {\n          align: 'Right',\n          showAlwaysInPopup: isItemInsidePopup,\n          prefixIcon: 'e-icon-timeline-day',\n          text: displayName || this.l10n.getConstant('timelineDay'),\n          cssClass: 'e-views e-timeline-day'\n        };\n        break;\n\n      case 'timelineweek':\n        view = {\n          align: 'Right',\n          showAlwaysInPopup: isItemInsidePopup,\n          prefixIcon: 'e-icon-timeline-week',\n          text: displayName || this.l10n.getConstant('timelineWeek'),\n          cssClass: 'e-views e-timeline-week'\n        };\n        break;\n\n      case 'timelineworkweek':\n        view = {\n          align: 'Right',\n          showAlwaysInPopup: isItemInsidePopup,\n          prefixIcon: 'e-icon-timeline-workweek',\n          text: displayName || this.l10n.getConstant('timelineWorkWeek'),\n          cssClass: 'e-views e-timeline-work-week'\n        };\n        break;\n\n      case 'timelinemonth':\n        view = {\n          align: 'Right',\n          showAlwaysInPopup: isItemInsidePopup,\n          prefixIcon: 'e-icon-timeline-month',\n          text: displayName || this.l10n.getConstant('timelineMonth'),\n          cssClass: 'e-views e-timeline-month'\n        };\n        break;\n\n      case 'timelineyear':\n        orientationClass = item.orientation === 'Vertical' ? 'vertical' : 'horizontal';\n        view = {\n          align: 'Right',\n          showAlwaysInPopup: isItemInsidePopup,\n          prefixIcon: 'e-icon-timeline-year-' + orientationClass,\n          text: displayName || this.l10n.getConstant('timelineYear'),\n          cssClass: 'e-views e-timeline-year'\n        };\n        break;\n    }\n\n    return view;\n  }\n\n  renderHeaderPopup() {\n    const headerPopupEle = createElement('div', {\n      className: HEADER_POPUP_CLASS\n    });\n    const headerCalendarEle = createElement('div', {\n      className: HEADER_CALENDAR_CLASS\n    });\n    headerPopupEle.appendChild(headerCalendarEle);\n    this.element.appendChild(headerPopupEle);\n    this.headerPopup = new Popup(headerPopupEle, {\n      actionOnScroll: 'hide',\n      targetType: 'relative',\n      relateTo: this.getPopUpRelativeElement(),\n      position: {\n        X: 'left',\n        Y: 'bottom'\n      },\n      enableRtl: this.parent.enableRtl\n    });\n    const calendarView = this.getCalendarView();\n    const isDisplayDate = this.parent.currentView === 'Month' && !isNullOrUndefined(this.parent.activeViewOptions.displayDate) && !this.hasSelectedDate();\n    this.headerCalendar = new Calendar({\n      value: isDisplayDate ? this.parent.activeViewOptions.displayDate : this.parent.selectedDate,\n      min: this.parent.minDate,\n      max: this.parent.maxDate,\n      firstDayOfWeek: this.parent.activeViewOptions.firstDayOfWeek,\n      enableRtl: this.parent.enableRtl,\n      locale: this.parent.locale,\n      depth: calendarView,\n      start: calendarView,\n      calendarMode: this.parent.calendarMode,\n      change: this.calendarChange.bind(this)\n    });\n    this.setCalendarTimezone();\n    this.headerCalendar.appendTo(headerCalendarEle);\n    this.headerPopup.hide();\n  }\n\n  calendarChange(args) {\n    if (args.value.getTime() !== this.parent.selectedDate.getTime()) {\n      const calendarDate = resetTime(new Date(args.value));\n      this.parent.changeDate(calendarDate);\n    }\n\n    this.headerPopup.hide();\n  }\n\n  setCalendarTimezone() {\n    if (this.headerCalendar) {\n      this.headerCalendar.timezone = this.parent.timezone || this.parent.tzModule.getLocalTimezoneName();\n    }\n  }\n\n  calculateViewIndex(args) {\n    const target = closest(args.originalEvent.target, '.e-views');\n    const views = [].slice.call(this.element.querySelectorAll('.e-views'));\n    return views.indexOf(target);\n  }\n\n  toolbarClickHandler(args) {\n    if (!args.item) {\n      return;\n    }\n\n    const strClass = args.item.cssClass.replace('e-views ', '');\n    let data;\n    let isSameTime;\n    let currentTime;\n\n    switch (strClass) {\n      case 'e-date-range':\n        if (!this.headerPopup) {\n          this.renderHeaderPopup();\n        }\n\n        if (this.headerPopup.element.classList.contains(POPUP_OPEN)) {\n          this.headerPopup.hide();\n        } else {\n          this.headerPopup.show();\n        }\n\n        break;\n\n      case 'e-day':\n        this.parent.changeView('Day', args.originalEvent, undefined, this.calculateViewIndex(args));\n        break;\n\n      case 'e-week':\n        this.parent.changeView('Week', args.originalEvent, undefined, this.calculateViewIndex(args));\n        break;\n\n      case 'e-work-week':\n        this.parent.changeView('WorkWeek', args.originalEvent, undefined, this.calculateViewIndex(args));\n        break;\n\n      case 'e-month':\n        this.parent.changeView('Month', args.originalEvent, undefined, this.calculateViewIndex(args));\n        break;\n\n      case 'e-year':\n        this.parent.changeView('Year', args.originalEvent, undefined, this.calculateViewIndex(args));\n        break;\n\n      case 'e-agenda':\n        this.parent.changeView('Agenda', args.originalEvent, undefined, this.calculateViewIndex(args));\n        break;\n\n      case 'e-month-agenda':\n        this.parent.changeView('MonthAgenda', args.originalEvent, undefined, this.calculateViewIndex(args));\n        break;\n\n      case 'e-timeline-day':\n        this.parent.changeView('TimelineDay', args.originalEvent, undefined, this.calculateViewIndex(args));\n        break;\n\n      case 'e-timeline-week':\n        this.parent.changeView('TimelineWeek', args.originalEvent, undefined, this.calculateViewIndex(args));\n        break;\n\n      case 'e-timeline-work-week':\n        this.parent.changeView('TimelineWorkWeek', args.originalEvent, undefined, this.calculateViewIndex(args));\n        break;\n\n      case 'e-timeline-month':\n        this.parent.changeView('TimelineMonth', args.originalEvent, undefined, this.calculateViewIndex(args));\n        break;\n\n      case 'e-timeline-year':\n        this.parent.changeView('TimelineYear', args.originalEvent, undefined, this.calculateViewIndex(args));\n        break;\n\n      case 'e-today':\n        currentTime = resetTime(this.parent.getCurrentTime());\n\n        if (this.parent.currentView === 'Agenda' || this.parent.currentView === 'MonthAgenda' || !this.parent.isSelectedDate(currentTime) || this.parent.currentView === 'Month' && this.parent.activeViewOptions.displayDate && !this.hasSelectedDate() && resetTime(this.parent.activeViewOptions.displayDate) !== currentTime || this.parent.currentView === 'Month' && this.parent.activeViewOptions.numberOfWeeks > 0 && !this.hasSelectedDate() && resetTime(firstDateOfMonth(this.parent.selectedDate)) !== currentTime) {\n          this.parent.changeDate(currentTime, args.originalEvent);\n        }\n\n        break;\n\n      case 'e-prev':\n        this.parent.changeDate(this.parent.activeView.getNextPreviousDate('previous'), args.originalEvent);\n        break;\n\n      case 'e-next':\n        this.parent.changeDate(this.parent.activeView.getNextPreviousDate('next'), args.originalEvent);\n        break;\n\n      case 'e-add':\n        isSameTime = this.parent.activeCellsData.startTime.getTime() === this.parent.activeCellsData.endTime.getTime();\n\n        if (this.parent.activeCellsData && !isSameTime) {\n          data = this.parent.activeCellsData;\n        } else {\n          const interval = this.parent.activeViewOptions.timeScale.interval;\n          const slotCount = this.parent.activeViewOptions.timeScale.slotCount;\n          const msInterval = interval * MS_PER_MINUTE / slotCount;\n          const startTime = new Date(this.parent.selectedDate.getTime());\n          const currentTime = this.parent.getCurrentTime();\n          startTime.setHours(currentTime.getHours(), Math.round(startTime.getMinutes() / msInterval) * msInterval, 0);\n          const endTime = new Date(new Date(startTime.getTime()).setMilliseconds(startTime.getMilliseconds() + msInterval));\n          data = {\n            startTime: startTime,\n            endTime: endTime,\n            isAllDay: false\n          };\n        }\n\n        this.parent.eventWindow.openEditor(extend(data, {\n          cancel: false,\n          event: args.originalEvent\n        }), 'Add');\n        break;\n    }\n\n    if (isNullOrUndefined(this.toolbarObj)) {\n      return;\n    }\n\n    const toolbarPopUp = this.toolbarObj.element.querySelector('.e-toolbar-pop');\n\n    if (toolbarPopUp && args.item.type !== 'Input') {\n      toolbarPopUp.ej2_instances[0].hide({\n        name: 'SlideUp',\n        duration: 100\n      });\n    }\n  }\n\n  hasSelectedDate() {\n    const selectedTime = resetTime(this.parent.selectedDate).getTime();\n    return selectedTime >= this.parent.activeView.getStartDate().getTime() && selectedTime <= this.parent.activeView.getEndDate().getTime();\n  }\n\n  getHeaderElement() {\n    return this.toolbarObj.element;\n  }\n\n  updateHeaderItems(classType) {\n    const prevNavEle = this.toolbarObj.element.querySelector('.e-prev');\n    const nextNavEle = this.toolbarObj.element.querySelector('.e-next');\n    const dateRangeEle = this.toolbarObj.element.querySelector('.e-date-range');\n\n    if (prevNavEle) {\n      if (classType === 'add') {\n        addClass([prevNavEle], HIDDEN_CLASS);\n      } else {\n        removeClass([prevNavEle], HIDDEN_CLASS);\n      }\n    }\n\n    if (nextNavEle) {\n      if (classType === 'add') {\n        addClass([nextNavEle], HIDDEN_CLASS);\n      } else {\n        removeClass([nextNavEle], HIDDEN_CLASS);\n      }\n    }\n\n    if (dateRangeEle) {\n      if (classType === 'add') {\n        addClass([dateRangeEle], TEXT_ELLIPSIS);\n      } else {\n        removeClass([dateRangeEle], TEXT_ELLIPSIS);\n      }\n    }\n  }\n\n  previousNextIconHandler() {\n    const dates = this.parent.currentView === 'Agenda' ? [this.parent.getCurrentViewDates()[0]] : this.parent.getCurrentViewDates();\n    const prevNavEle = this.toolbarObj.element.querySelector('.' + PREVIOUS_DATE_CLASS);\n    const nextNavEle = this.toolbarObj.element.querySelector('.' + NEXT_DATE_CLASS);\n    let firstDate = new Date(dates[0].getTime());\n    let lastDate = new Date(dates[dates.length - 1].getTime());\n\n    if (this.parent.currentView === 'WorkWeek' || this.parent.currentView === 'TimelineWorkWeek') {\n      firstDate = getWeekFirstDate(resetTime(this.parent.selectedDate), this.parent.firstDayOfWeek);\n      lastDate = addDays(firstDate, 7 * this.parent.activeViewOptions.interval);\n    }\n\n    if (this.parent.currentView === 'Month') {\n      const isCustomMonth = !isNullOrUndefined(this.parent.activeViewOptions.displayDate) || this.parent.activeViewOptions.numberOfWeeks > 0;\n      firstDate = isCustomMonth ? this.parent.activeView.getStartDate() : firstDateOfMonth(this.parent.selectedDate);\n      lastDate = isCustomMonth ? this.parent.activeView.getEndDate() : lastDateOfMonth(addMonths(firstDate, this.parent.activeViewOptions.interval - 1));\n    }\n\n    if (!isNullOrUndefined(prevNavEle)) {\n      this.toolbarObj.enableItems(prevNavEle, firstDate > this.parent.minDate);\n    }\n\n    if (!isNullOrUndefined(nextNavEle)) {\n      this.toolbarObj.enableItems(nextNavEle, lastDate < this.parent.maxDate);\n    }\n\n    this.setCalendarMinMaxDate();\n  }\n\n  getModuleName() {\n    return 'headerbar';\n  }\n\n  destroy() {\n    if (this.headerPopup && !this.headerPopup.isDestroyed) {\n      this.headerPopup.destroy();\n      this.headerPopup = null;\n    }\n\n    if (this.headerCalendar && !this.headerCalendar.isDestroyed) {\n      this.headerCalendar.destroy();\n      this.headerCalendar = null;\n    }\n\n    if (this.toolbarObj && !this.toolbarObj.isDestroyed) {\n      this.toolbarObj.destroy();\n      this.removeEventListener();\n      remove(this.element);\n      this.toolbarObj = null;\n    }\n\n    this.element = null;\n    this.parent = null;\n    this.l10n = null;\n  }\n\n}\n/**\n * `Scroll` module\n */\n\n\nclass Scroll {\n  /**\n   * Constructor for the scrolling.\n   *\n   * @param {Schedule} parent Accepts the Schedule instance\n   */\n  constructor(parent) {\n    this.parent = parent;\n    this.addEventListener();\n  }\n  /**\n   * For internal use only - Get the module name.\n   *\n   * @returns {string} Returns the module name.\n   * @private\n   */\n\n\n  getModuleName() {\n    return 'scroll';\n  }\n  /**\n   * Internal method to set the element width\n   *\n   * @returns {void}\n   * @private\n   */\n\n\n  setWidth() {\n    this.parent.element.style.width = formatUnit(this.parent.width);\n  }\n  /**\n   * Internal method to set the element height\n   *\n   * @returns {void}\n   * @private\n   */\n\n\n  setHeight() {\n    this.parent.element.style.height = formatUnit(this.parent.height);\n  }\n  /**\n   * Internal method to bind events\n   *\n   * @returns {void}\n   * @private\n   */\n\n\n  addEventListener() {\n    this.parent.on(contentReady, this.setDimensions, this);\n    this.parent.on(uiUpdate, this.onPropertyChanged, this);\n  }\n  /**\n   * Internal method to unbind events\n   *\n   * @returns {void}\n   * @private\n   */\n\n\n  removeEventListener() {\n    this.parent.off(contentReady, this.setDimensions);\n    this.parent.off(uiUpdate, this.onPropertyChanged);\n  }\n  /**\n   * Internal method to set the dimensions\n   *\n   * @returns {void}\n   * @private\n   */\n\n\n  setDimensions() {\n    this.setWidth();\n    this.setHeight();\n    const data = {\n      cssProperties: this.parent.getCssProperties(),\n      module: this.getModuleName()\n    };\n    this.parent.notify(scrollUiUpdate, data);\n  }\n  /**\n   * Internal method to set the dimensions dynamically\n   *\n   * @returns {void}\n   * @private\n   */\n\n\n  onPropertyChanged() {\n    this.setDimensions();\n  }\n  /**\n   * Destroy the scroll module\n   *\n   * @returns {void}\n   * @private\n   */\n\n\n  destroy() {\n    this.removeEventListener();\n  }\n\n}\n/**\n * `touch` module is used to handle touch interactions.\n */\n\n\nclass ScheduleTouch {\n  constructor(parent) {\n    this.parent = parent;\n    this.element = this.parent.element.querySelector('.' + TABLE_CONTAINER_CLASS);\n    this.touchObj = new Touch(this.element, {\n      scroll: this.scrollHandler.bind(this),\n      swipe: this.swipeHandler.bind(this),\n      tapHold: this.tapHoldHandler.bind(this),\n      swipeSettings: {\n        swipeThresholdDistance: 1\n      }\n    });\n    EventHandler.add(this.element, 'transitionend', this.onTransitionEnd, this);\n    this.touchLeftDirection = this.parent.enableRtl ? 'Right' : 'Left';\n    this.touchRightDirection = this.parent.enableRtl ? 'Left' : 'Right';\n  }\n\n  scrollHandler(e) {\n    if (this.parent.currentView === 'Agenda' || this.parent.uiStateValues.action || e.originalEvent && (e.originalEvent.target.classList.contains(APPOINTMENT_CLASS) || closest(e.originalEvent.target, '.' + APPOINTMENT_CLASS))) {\n      return;\n    }\n\n    if (!this.timeStampStart) {\n      this.timeStampStart = Date.now();\n    }\n\n    if (this.element.classList.contains(TRANSLATE_CLASS)) {\n      this.onTransitionEnd();\n    }\n\n    if (e.scrollDirection === 'Left' || e.scrollDirection === 'Right') {\n      const args = {\n        requestType: 'dateNavigate',\n        cancel: false,\n        event: e.originalEvent\n      };\n      this.parent.trigger(actionBegin, args);\n\n      if (args.cancel) {\n        return;\n      }\n\n      const scrollDiv = this.element.querySelector('.' + CONTENT_WRAP_CLASS);\n\n      if (scrollDiv && scrollDiv.scrollWidth > scrollDiv.clientWidth) {\n        return;\n      } else {\n        this.isScrollTriggered = true;\n        e.originalEvent.preventDefault();\n        e.originalEvent.stopPropagation();\n      }\n    }\n\n    if (e.scrollDirection === this.touchLeftDirection) {\n      if (!this.nextPanel) {\n        this.renderPanel(NEXT_PANEL_CLASS, 'next');\n        this.nextPanel = {\n          element: this.parent.activeView.getPanel(),\n          selectedDate: new Date(this.parent.selectedDate.getTime())\n        };\n        this.setDimensions(this.nextPanel.element);\n      }\n\n      const x = this.parent.enableRtl ? e.distanceX : -e.distanceX;\n      this.element.style.transform = 'translatex(' + (this.getTranslateX(this.element) + x) + 'px)';\n    } else if (e.scrollDirection === this.touchRightDirection) {\n      let prevWidth = 0;\n\n      if (!this.previousPanel) {\n        this.renderPanel(PREVIOUS_PANEL_CLASS, 'previous');\n        this.previousPanel = {\n          element: this.parent.activeView.getPanel(),\n          selectedDate: new Date(this.parent.selectedDate.getTime())\n        };\n        this.setDimensions(this.previousPanel.element);\n        prevWidth = this.previousPanel.element.offsetWidth;\n      }\n\n      const x = this.parent.enableRtl ? prevWidth - e.distanceX : -prevWidth + e.distanceX;\n      this.element.style.transform = 'translatex(' + (this.getTranslateX(this.element) + x) + 'px)';\n    }\n  }\n\n  swipeHandler(e) {\n    if (!this.isScrollTriggered || this.parent.uiStateValues.action) {\n      return;\n    }\n\n    this.isScrollTriggered = false;\n    const swipeDate = e.swipeDirection === 'Left' ? this.parent.activeView.renderDates[0] : this.parent.activeView.renderDates.slice(-1)[0];\n\n    if (e.swipeDirection === 'Left' && swipeDate < this.parent.maxDate || e.swipeDirection === 'Right' && swipeDate >= this.parent.minDate) {\n      const time = Date.now() - this.timeStampStart;\n      const offsetDist = e.distanceX * (Browser.isDevice ? 6 : 1.66);\n\n      if (offsetDist > time || e.distanceX > this.parent.element.offsetWidth / 2) {\n        this.swapPanels(e.swipeDirection);\n\n        if (offsetDist > time && e.distanceX > this.parent.element.offsetWidth / 2) {\n          this.element.style.transitionDuration = offsetDist / time / 10 + 's';\n        }\n\n        this.confirmSwipe(e.swipeDirection);\n      } else {\n        this.cancelSwipe();\n      }\n\n      const args = {\n        requestType: 'dateNavigate',\n        cancel: false,\n        event: e.originalEvent\n      };\n      this.parent.trigger(actionComplete, args);\n    } else {\n      this.cancelSwipe();\n    }\n\n    this.timeStampStart = null;\n  }\n\n  tapHoldHandler(e) {\n    const target = closest(e.originalEvent.target, '.' + APPOINTMENT_CLASS);\n\n    if (!isNullOrUndefined(target) && this.parent.isAdaptive) {\n      this.parent.quickPopup.tapHoldEventPopup(e.originalEvent);\n      return;\n    }\n  }\n\n  renderPanel(clsName, nextPrevType) {\n    if (!this.currentPanel) {\n      this.currentPanel = {\n        element: this.parent.activeView.getPanel(),\n        selectedDate: new Date(this.parent.selectedDate.getTime())\n      };\n      this.setDimensions(this.currentPanel.element);\n    } else {\n      this.parent.setProperties({\n        selectedDate: this.currentPanel.selectedDate\n      }, true);\n    }\n\n    this.parent.setProperties({\n      selectedDate: this.parent.activeView.getNextPreviousDate(nextPrevType)\n    }, true);\n\n    if (this.parent.headerModule) {\n      this.parent.headerModule.setCalendarDate(this.parent.selectedDate);\n    }\n\n    this.parent.activeView.getRenderDates();\n    this.parent.activeView.renderLayout(clsName);\n  }\n\n  swapPanels(direction) {\n    if (direction === this.touchLeftDirection) {\n      const temp = this.nextPanel;\n      this.nextPanel = this.currentPanel;\n      this.currentPanel = temp;\n    } else {\n      const temp = this.previousPanel;\n      this.previousPanel = this.currentPanel;\n      this.currentPanel = temp;\n    }\n  }\n\n  confirmSwipe(swipeDirection) {\n    const previousDate = swipeDirection === this.touchLeftDirection ? this.nextPanel.selectedDate : this.previousPanel.selectedDate;\n    const args = {\n      action: 'date',\n      cancel: false,\n      previousDate: previousDate,\n      currentDate: this.currentPanel.selectedDate\n    };\n    this.parent.trigger(navigating, args, navArgs => {\n      if (navArgs.cancel) {\n        this.swapPanels(swipeDirection);\n        this.cancelSwipe();\n      } else {\n        this.parent.activeView.setPanel(this.currentPanel.element);\n        this.parent.setProperties({\n          selectedDate: this.currentPanel.selectedDate\n        }, true);\n        let translateX;\n\n        if (this.parent.enableRtl) {\n          translateX = swipeDirection === this.touchLeftDirection ? this.previousPanel ? this.previousPanel.element.offsetLeft : this.currentPanel.element.offsetWidth : 0;\n        } else {\n          translateX = swipeDirection === this.touchLeftDirection ? -this.currentPanel.element.offsetLeft : 0;\n        }\n\n        addClass([this.element], TRANSLATE_CLASS);\n        this.element.style.transform = 'translatex(' + translateX + 'px)';\n\n        if (this.parent.headerModule) {\n          this.parent.headerModule.updateDateRange(this.parent.activeView.getDateRangeText());\n        }\n\n        this.parent.renderTemplates();\n        this.parent.crudModule.refreshDataManager();\n      }\n    });\n  }\n\n  cancelSwipe() {\n    this.parent.activeView.setPanel(this.currentPanel.element);\n    this.parent.setProperties({\n      selectedDate: this.currentPanel.selectedDate\n    }, true);\n    this.parent.activeView.getRenderDates();\n    this.parent.activeView.generateColumnLevels();\n    addClass([this.element], TRANSLATE_CLASS);\n    const prevWidth = this.previousPanel ? this.previousPanel.element.offsetWidth : 0;\n    this.element.style.transform = 'translatex(' + (this.parent.enableRtl ? prevWidth : -this.currentPanel.element.offsetLeft) + 'px)';\n  }\n\n  onTransitionEnd() {\n    removeClass([this.element], TRANSLATE_CLASS);\n    this.element.style.transitionDuration = '';\n    this.element.style.transform = '';\n\n    if (this.previousPanel) {\n      remove(this.previousPanel.element);\n      this.previousPanel = null;\n      removeClass([this.currentPanel.element], PREVIOUS_PANEL_CLASS);\n      addClass([this.currentPanel.element], CURRENT_PANEL_CLASS);\n    }\n\n    if (this.nextPanel) {\n      remove(this.nextPanel.element);\n      this.nextPanel = null;\n      removeClass([this.currentPanel.element], NEXT_PANEL_CLASS);\n      addClass([this.currentPanel.element], CURRENT_PANEL_CLASS);\n    }\n\n    this.currentPanel = null;\n    this.parent.activeView.getPanel().style.width = '';\n  }\n\n  getTranslateX(element) {\n    const style = window.getComputedStyle(element);\n    return new WebKitCSSMatrix(style.webkitTransform).m41;\n  }\n\n  setDimensions(element) {\n    element.style.width = this.parent.element.clientWidth + 'px';\n  }\n\n  resetValues() {\n    this.currentPanel = null;\n    this.previousPanel = null;\n    this.nextPanel = null;\n    this.timeStampStart = null;\n    this.element.style.transform = '';\n    removeChildren(this.element);\n    removeClass([this.element], TRANSLATE_CLASS);\n  }\n\n  destroy() {\n    if (this.touchObj) {\n      this.touchObj.destroy();\n      this.touchObj = null;\n    }\n\n    EventHandler.remove(this.element, 'transitionend', this.onTransitionEnd);\n    this.resetValues();\n  }\n\n}\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\n/**\n * Keyboard interaction\n */\n\n\nclass KeyboardInteraction {\n  constructor(parent) {\n    this.selectedCells = [];\n    this.keyConfigs = {\n      downArrow: 'downarrow',\n      upArrow: 'uparrow',\n      rightArrow: 'rightarrow',\n      leftArrow: 'leftarrow',\n      shiftDownArrow: 'shift+downarrow',\n      shiftUpArrow: 'shift+uparrow',\n      shiftRightArrow: 'shift+rightarrow',\n      shiftLeftArrow: 'shift+leftarrow',\n      ctrlLeftArrow: 'ctrl+leftarrow',\n      ctrlRightArrow: 'ctrl+rightarrow',\n      altOne: 'alt+1',\n      altTwo: 'alt+2',\n      altThree: 'alt+3',\n      altFour: 'alt+4',\n      altFive: 'alt+5',\n      altSix: 'alt+6',\n      altSeven: 'alt+7',\n      altEight: 'alt+8',\n      altNine: 'alt+9',\n      enter: 'enter',\n      escape: 'escape',\n      delete: 'delete',\n      home: 'home',\n      pageUp: 'pageup',\n      pageDown: 'pagedown',\n      tab: 'tab',\n      shiftTab: 'shift+tab',\n      ctrlShiftUpArrow: 'ctrl+shift+uparrow',\n      ctrlShiftDownArrow: 'ctrl+shift+downarrow',\n      ctrlShiftLeftArrow: 'ctrl+shift+leftarrow',\n      ctrlShiftRightArrow: 'ctrl+shift+rightarrow'\n    };\n    this.parent = parent;\n    this.parent.element.tabIndex = this.parent.element.tabIndex === -1 ? 0 : this.parent.element.tabIndex;\n    this.keyboardModule = new KeyboardEvents(this.parent.element, {\n      keyAction: this.keyActionHandler.bind(this),\n      keyConfigs: this.keyConfigs,\n      eventName: 'keydown'\n    });\n    this.addEventListener();\n  }\n\n  keyActionHandler(e) {\n    switch (e.action) {\n      case 'downArrow':\n      case 'shiftDownArrow':\n        this.processDown(e, e.shiftKey);\n        break;\n\n      case 'upArrow':\n      case 'shiftUpArrow':\n        this.processUp(e, e.shiftKey);\n        break;\n\n      case 'leftArrow':\n      case 'shiftLeftArrow':\n        this.processLeft(e, e.shiftKey);\n        break;\n\n      case 'rightArrow':\n      case 'shiftRightArrow':\n        this.processRight(e, e.shiftKey);\n        break;\n\n      case 'ctrlLeftArrow':\n        this.parent.changeDate(this.parent.activeView.getNextPreviousDate('previous'), e);\n\n        if (this.parent.headerModule) {\n          this.parent.headerModule.element.querySelector('.e-prev button').focus();\n        }\n\n        break;\n\n      case 'ctrlRightArrow':\n        this.parent.changeDate(this.parent.activeView.getNextPreviousDate('next'), e);\n\n        if (this.parent.headerModule) {\n          this.parent.headerModule.element.querySelector('.e-next button').focus();\n        }\n\n        break;\n\n      case 'altOne':\n      case 'altTwo':\n      case 'altThree':\n      case 'altFour':\n      case 'altFive':\n      case 'altSix':\n      case 'altSeven':\n      case 'altEight':\n      case 'altNine':\n        this.processViewNavigation(e);\n        break;\n\n      case 'enter':\n        this.processEnter(e);\n        break;\n\n      case 'home':\n        this.focusFirstCell();\n        break;\n\n      case 'tab':\n      case 'shiftTab':\n        this.processTab(e, e.shiftKey);\n        break;\n\n      case 'delete':\n        this.processDelete(e);\n        break;\n\n      case 'ctrlShiftUpArrow':\n      case 'ctrlShiftDownArrow':\n      case 'ctrlShiftLeftArrow':\n      case 'ctrlShiftRightArrow':\n        this.processCtrlShiftNavigationArrows(e);\n        break;\n\n      case 'escape':\n        this.processEscape(e);\n        break;\n\n      case 'fTwelve':\n        if (this.parent.allowInline && this.parent.inlineModule) {\n          e.preventDefault();\n          this.processFTwelve(e);\n        }\n\n        break;\n    }\n  }\n\n  processFTwelve(e) {\n    const target = e.target;\n\n    if (target.classList.contains(WORK_CELLS_CLASS) || target.classList.contains(ALLDAY_CELLS_CLASS)) {\n      this.parent.activeCellsData = this.getSelectedElements(target);\n      const args = extend(this.parent.activeCellsData, {\n        cancel: false,\n        event: e\n      });\n      const inlineArgs = {\n        element: args.element,\n        groupIndex: args.groupIndex,\n        type: 'Cell'\n      };\n      this.parent.notify(inlineClick, inlineArgs);\n    }\n\n    if (target.classList.contains(APPOINTMENT_CLASS)) {\n      target.click();\n      return;\n    }\n  }\n\n  addEventListener() {\n    this.parent.on(cellMouseDown, this.onCellMouseDown, this);\n  }\n\n  removeEventListener() {\n    this.parent.off(cellMouseDown, this.onCellMouseDown);\n  }\n\n  onCellMouseDown(e) {\n    if (e.event.shiftKey) {\n      return;\n    }\n\n    this.initialTarget = this.getClosestCell(e.event);\n\n    if (this.parent.activeViewOptions.readonly || this.parent.currentView === 'MonthAgenda' || !this.initialTarget) {\n      return;\n    }\n\n    if (e.event.target.classList.contains(WORK_CELLS_CLASS) && e.event.which !== 3) {\n      this.parent.removeSelectedClass();\n      EventHandler.add(this.parent.getContentTable(), 'mousemove', this.onMouseSelection, this);\n      EventHandler.add(this.parent.getContentTable(), 'mouseup', this.onMoveUp, this);\n    }\n\n    if (e.event.target.classList.contains(ALLDAY_CELLS_CLASS) && e.event.which !== 3) {\n      this.parent.removeSelectedClass();\n      const allDayRow = this.parent.getAllDayRow();\n      EventHandler.add(allDayRow, 'mousemove', this.onMouseSelection, this);\n      EventHandler.add(allDayRow, 'mouseup', this.onMoveUp, this);\n    }\n  }\n\n  onMouseSelection(e) {\n    const appointments = [].slice.call(this.parent.element.querySelectorAll('.' + APPOINTMENT_CLASS));\n    addClass(appointments, 'e-allow-select');\n    const selectionEdges = this.parent.boundaryValidation(e.pageY, e.pageX);\n\n    if (selectionEdges.bottom || selectionEdges.top || selectionEdges.left || selectionEdges.right) {\n      const parent = this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS);\n      const yInBounds = parent.offsetHeight <= parent.scrollHeight && parent.scrollTop >= 0 && parent.scrollTop + parent.offsetHeight <= parent.scrollHeight;\n      const xInBounds = parent.offsetWidth <= parent.scrollWidth && parent.scrollLeft >= 0 && parent.scrollLeft + parent.offsetWidth <= parent.scrollWidth;\n\n      if (yInBounds && (selectionEdges.top || selectionEdges.bottom)) {\n        parent.scrollTop += selectionEdges.top ? -e.target.offsetHeight : e.target.offsetHeight;\n      }\n\n      if (xInBounds && (selectionEdges.left || selectionEdges.right)) {\n        parent.scrollLeft += selectionEdges.left ? -e.target.offsetWidth : e.target.offsetWidth;\n      }\n    }\n\n    const target = this.getClosestCell(e);\n\n    if (target) {\n      this.selectCells(true, target);\n    }\n  }\n\n  getClosestCell(e) {\n    return closest(e.target, '.' + WORK_CELLS_CLASS + ',.' + ALLDAY_CELLS_CLASS);\n  }\n\n  onMoveUp(e) {\n    const appointments = [].slice.call(this.parent.element.querySelectorAll('.' + APPOINTMENT_CLASS));\n    removeClass(appointments, 'e-allow-select');\n\n    if (e.target.classList.contains(WORK_CELLS_CLASS)) {\n      EventHandler.remove(this.parent.getContentTable(), 'mousemove', this.onMouseSelection);\n      EventHandler.remove(this.parent.getContentTable(), 'mouseup', this.onMoveUp);\n    }\n\n    if (e.target.classList.contains(ALLDAY_CELLS_CLASS)) {\n      const allDayRow = this.parent.getAllDayRow();\n      EventHandler.remove(allDayRow, 'mousemove', this.onMouseSelection);\n      EventHandler.remove(allDayRow, 'mouseup', this.onMoveUp);\n    }\n\n    if (this.isPreventAction(e)) {\n      return;\n    }\n\n    const queryStr = '.' + WORK_CELLS_CLASS + ',.' + ALLDAY_CELLS_CLASS + ',.' + HEADER_CELLS_CLASS;\n    const target = closest(e.target, queryStr);\n\n    if (this.parent.currentView === 'TimelineYear' && target.classList.contains(OTHERMONTH_CLASS)) {\n      return;\n    }\n\n    this.parent.activeCellsData = this.getSelectedElements(target);\n    const cellData = {};\n\n    if (this.parent.eventWindow) {\n      this.parent.eventWindow.convertToEventData(this.parent.activeCellsData, cellData);\n    }\n\n    const selectedCells = this.parent.getSelectedElements();\n    const args = {\n      data: cellData,\n      element: this.parent.activeCellsData.element,\n      event: e,\n      requestType: 'cellSelect',\n      showQuickPopup: false\n    };\n    this.parent.trigger(select, args, selectArgs => {\n      const isPopupShow = selectArgs.showQuickPopup || this.parent.quickInfoOnSelectionEnd;\n\n      if (isPopupShow && selectedCells.length > 1) {\n        const cellArgs = extend(this.parent.activeCellsData, {\n          cancel: false,\n          event: e,\n          name: 'cellClick'\n        });\n        this.parent.notify(cellClick, cellArgs);\n      }\n    });\n  }\n\n  processEnter(e) {\n    if (this.parent.activeViewOptions.readonly && !e.target.classList.contains(APPOINTMENT_CLASS) || this.isPreventAction(e)) {\n      return;\n    }\n\n    if (this.parent.currentView === 'TimelineYear' && e.target.classList.contains(OTHERMONTH_CLASS)) {\n      return;\n    }\n\n    const target = e.target;\n\n    if (closest(target, '.' + POPUP_WRAPPER_CLASS)) {\n      if (target.classList.contains(QUICK_POPUP_EVENT_DETAILS_CLASS) || target.classList.contains(EVENT_CREATE_CLASS) || target.classList.contains(EDIT_EVENT_CLASS) || target.classList.contains(DELETE_EVENT_CLASS) || target.classList.contains(CLOSE_CLASS)) {\n        target.click();\n        e.preventDefault();\n      } else if (target.classList.contains(SUBJECT_CLASS)) {\n        this.parent.element.querySelector('.' + EVENT_CREATE_CLASS).click();\n        e.preventDefault();\n      }\n\n      return;\n    }\n\n    if (target.classList.contains(RESOURCE_CELLS_CLASS) && target.classList.contains(RESOURCE_PARENT_CLASS)) {\n      const resourceIcon = target.querySelector('.' + RESOURCE_TREE_ICON_CLASS);\n\n      if (resourceIcon) {\n        resourceIcon.click();\n      }\n\n      return;\n    }\n\n    if (target.classList.contains(WORK_CELLS_CLASS) || target.classList.contains(ALLDAY_CELLS_CLASS)) {\n      this.parent.activeCellsData = this.getSelectedElements(target);\n      const args = extend(this.parent.activeCellsData, {\n        cancel: false,\n        event: e\n      });\n\n      if (this.parent.allowInline) {\n        const inlineArgs = {\n          element: args.element,\n          groupIndex: args.groupIndex,\n          type: 'Cell'\n        };\n        this.parent.notify(inlineClick, inlineArgs);\n      } else {\n        if (this.parent.currentView === 'Year') {\n          target.click();\n        } else {\n          this.parent.notify(cellClick, args);\n        }\n      }\n\n      return;\n    }\n\n    if (target.classList.contains(INLINE_SUBJECT_CLASS) && this.parent.inlineModule) {\n      this.parent.inlineModule.inlineCrudActions(target);\n      return;\n    }\n\n    if (target.classList.contains(APPOINTMENT_CLASS) || target.classList.contains(MORE_EVENT_CLOSE_CLASS) || target.classList.contains(ALLDAY_APPOINTMENT_SECTION_CLASS) || target.classList.contains(MORE_INDICATOR_CLASS)) {\n      target.click();\n      return;\n    }\n\n    if (target.classList.contains(MORE_EVENT_HEADER_DATE_CLASS)) {\n      this.parent.setProperties({\n        selectedDate: this.parent.getDateFromElement(target)\n      }, true);\n      this.parent.changeView(this.parent.getNavigateView(), e);\n      this.processEscape(e);\n      return;\n    }\n  }\n\n  getSelectedElements(target) {\n    let cellDetails;\n\n    if (this.selectedCells.length > 1 && target.classList.contains(SELECTED_CELL_CLASS)) {\n      const start = this.parent.getCellDetails(this.selectedCells[0]);\n      const end = this.parent.getCellDetails(this.selectedCells.slice(-1)[0]);\n      start.endTime = end.endTime;\n      start.element = target;\n      cellDetails = start;\n    } else {\n      cellDetails = this.parent.getCellDetails(target);\n    }\n\n    return cellDetails;\n  }\n\n  getCells(isInverseTable, start, end) {\n    const tableEle = this.parent.getContentTable();\n    const isTimelineYear = this.parent.currentView === 'TimelineYear';\n    const query = isTimelineYear && !isInverseTable ? '.' + WORK_CELLS_CLASS + ':not(.' + OTHERMONTH_CLASS + ')' : 'td';\n    let cells = [].slice.call(tableEle.querySelectorAll(query));\n    let maxRow = tableEle.rows.length;\n    let maxColumn = tableEle.rows[0].cells.length;\n\n    if (start && start.classList.contains(ALLDAY_CELLS_CLASS)) {\n      const allDayRow = this.parent.getAllDayRow();\n      cells = [].slice.call(allDayRow.cells);\n      maxRow = 1;\n      maxColumn = allDayRow.cells.length;\n    }\n\n    let startIndex = cells.indexOf(start);\n    let endIndex = cells.indexOf(end);\n    const inverseCells = [];\n\n    if (isInverseTable) {\n      for (let i = 0; i < maxColumn; i++) {\n        for (let j = 0; j < maxRow; j++) {\n          const cell = cells[maxColumn * j + i];\n\n          if (isTimelineYear && cell.classList.contains(OTHERMONTH_CLASS)) {\n            continue;\n          }\n\n          inverseCells.push(cell);\n        }\n      }\n\n      startIndex = inverseCells.indexOf(start);\n      endIndex = inverseCells.indexOf(end);\n    }\n\n    if (startIndex > endIndex) {\n      const temp = startIndex;\n      startIndex = endIndex;\n      endIndex = temp;\n    }\n\n    const sCells = isInverseTable ? inverseCells : cells;\n    return sCells.slice(startIndex, endIndex + 1);\n  }\n\n  focusFirstCell() {\n    if (this.parent.currentView === 'Agenda') {\n      const focusCell = this.parent.getContentTable().querySelector('.' + AGENDA_CELLS_CLASS);\n      focusCell.setAttribute('tabindex', '0');\n      focusCell.focus();\n      return;\n    }\n\n    this.parent.eventBase.removeSelectedAppointmentClass();\n\n    if (this.parent.activeView.isTimelineView() && this.parent.currentView !== 'TimelineYear') {\n      const cell = this.parent.element.querySelector('.' + CONTENT_TABLE_CLASS + ' tr:not(.' + HIDDEN_CLASS + ') .' + WORK_CELLS_CLASS + ':not(.' + RESOURCE_GROUP_CELLS_CLASS + ')');\n      this.selectCells(false, cell);\n    } else if (this.parent.currentView.indexOf('Year') > -1) {\n      let query = '.' + WORK_CELLS_CLASS + ':not(.' + OTHERMONTH_CLASS + ')' + ':not(.' + RESOURCE_GROUP_CELLS_CLASS + ')';\n      const isVerticalYear = this.parent.currentView === 'TimelineYear' && this.parent.activeViewOptions.orientation === 'Vertical';\n      query += isVerticalYear ? '[data-date=\"' + this.parent.activeView.startDate().getTime() + '\"]' : '';\n      this.selectCells(false, this.parent.element.querySelector(query));\n    } else {\n      this.selectCells(false, this.parent.getWorkCellElements()[0]);\n    }\n  }\n\n  isInverseTableSelect() {\n    return this.parent.activeView.isInverseTableSelect;\n  }\n  /**\n   * Internal method to select cells\n   *\n   * @param {boolean} isMultiple Accepts to select multiple cells or not\n   * @param {HTMLTableCellElement} targetCell Accepts the target cells\n   * @returns {void}\n   * @private\n   */\n\n\n  selectCells(isMultiple, targetCell) {\n    this.parent.removeSelectedClass();\n    let target = targetCell instanceof Array ? targetCell.slice(-1)[0] : targetCell;\n\n    if (isMultiple) {\n      let initialId;\n      const views = ['Day', 'Week', 'WorkWeek', 'TimelineDay', 'TimelineWeek', 'TimelineWorkWeek', 'TimelineMonth', 'TimelineYear'];\n      const args = {\n        element: targetCell,\n        requestType: 'mousemove',\n        allowMultipleRow: true\n      };\n      this.parent.inlineModule.removeInlineAppointmentElement();\n      this.parent.trigger(select, args, selectArgs => {\n        const allowMultipleRow = !selectArgs.allowMultipleRow || !this.parent.allowMultiRowSelection;\n\n        if (allowMultipleRow) {\n          const isTimelineYear = this.parent.currentView === 'TimelineYear';\n\n          if (isTimelineYear && this.parent.activeViewOptions.orientation === 'Horizontal' || this.parent.currentView === 'Month') {\n            const isGroupYear = isTimelineYear && this.parent.activeViewOptions.group.resources.length > 0;\n            target = isGroupYear ? this.initialTarget : this.initialTarget.parentElement.children[target.cellIndex];\n          } else if (views.indexOf(this.parent.currentView) > -1) {\n            target = target.parentElement.children[this.initialTarget.cellIndex];\n          }\n        }\n\n        let selectedCells = this.getCells(this.isInverseTableSelect(), this.initialTarget, target);\n\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n          initialId = this.initialTarget.getAttribute('data-group-index');\n          const resourceSelectedCells = [];\n\n          for (const cell of selectedCells) {\n            if (cell.getAttribute('data-group-index') === initialId) {\n              resourceSelectedCells.push(cell);\n            }\n          }\n\n          selectedCells = resourceSelectedCells;\n        }\n\n        if (!this.parent.allowMultiCellSelection) {\n          selectedCells = [this.initialTarget];\n        }\n\n        this.selectedCells = selectedCells;\n\n        if (selectedCells.length > 2 && !target.classList.contains(ALLDAY_CELLS_CLASS)) {\n          let allDayCells = this.getAllDayCells(selectedCells);\n\n          if (this.parent.activeViewOptions.group.resources.length > 0) {\n            const resourceAllDayCells = [];\n\n            for (const cell of allDayCells) {\n              if (cell.getAttribute('data-group-index') === initialId) {\n                resourceAllDayCells.push(cell);\n              }\n            }\n\n            allDayCells = resourceAllDayCells;\n          }\n\n          selectedCells = selectedCells.concat(allDayCells);\n        }\n\n        if (target.getAttribute('data-group-index') !== initialId && this.parent.activeViewOptions.group.resources.length > 0) {\n          target = this.selectedCells[this.selectedCells.length - 1];\n        }\n\n        this.parent.addSelectedClass(selectedCells, target);\n      });\n    } else {\n      this.initialTarget = target;\n      this.selectedCells = [target];\n      this.parent.addSelectedClass([target], target);\n    }\n  }\n\n  selectAppointment(isReverse, target) {\n    const appointments = this.getAppointmentElements();\n\n    if (appointments.length < 0) {\n      return;\n    }\n\n    this.parent.eventBase.removeSelectedAppointmentClass();\n    let nextAppEle;\n\n    if (target.classList.contains(APPOINTMENT_CLASS)) {\n      const targetIndex = appointments.indexOf(target);\n      nextAppEle = appointments[isReverse ? targetIndex - 1 : targetIndex + 1];\n    } else {\n      nextAppEle = isReverse ? appointments[appointments.length - 1] : appointments[0];\n    }\n\n    if (nextAppEle) {\n      this.parent.eventBase.addSelectedAppointments([nextAppEle]);\n      nextAppEle.focus();\n      addClass([nextAppEle], AGENDA_SELECTED_CELL);\n    }\n  }\n\n  selectAppointmentElementFromWorkCell(isReverse, target) {\n    this.parent.eventBase.removeSelectedAppointmentClass();\n    this.parent.removeSelectedClass();\n\n    if (target.classList.contains(WORK_CELLS_CLASS) || target.classList.contains(ALLDAY_CELLS_CLASS)) {\n      const appointmentElements = this.getUniqueAppointmentElements();\n      const filteredElements = [];\n      const selectedDate = this.parent.getDateFromElement(target).getTime();\n      const selectedSeriesEvents = this.parent.eventsProcessed.filter(eventObject => {\n        return !isReverse ? eventObject[this.parent.eventFields.startTime].getTime() >= selectedDate : eventObject[this.parent.eventFields.startTime].getTime() <= selectedDate;\n      });\n      selectedSeriesEvents.filter(event => {\n        appointmentElements.filter(element => {\n          if (JSON.stringify(event.Guid) === JSON.stringify(element.getAttribute('data-guid'))) {\n            filteredElements.push(element);\n          }\n        });\n      });\n\n      if (filteredElements.length > 0) {\n        const selectedElement = isReverse ? filteredElements[filteredElements.length - 1] : filteredElements[0];\n        const focusElements = this.getAppointmentElementsByGuid(selectedElement.getAttribute('data-guid'));\n        this.parent.eventBase.addSelectedAppointments(focusElements);\n        focusElements[focusElements.length - 1].focus();\n      }\n    }\n  }\n\n  getAllDayCells(cells) {\n    const allDayRow = this.parent.getAllDayRow();\n\n    if (!allDayRow) {\n      return [];\n    }\n\n    const startCell = cells[0];\n    const endCell = cells[cells.length - 1];\n    const start = this.parent.getCellDetails(startCell);\n    const end = this.parent.getCellDetails(endCell);\n\n    if (end.endTime.getTime() - start.startTime.getTime() >= MS_PER_DAY) {\n      const allDayCells = [].slice.call(allDayRow.cells);\n      return allDayCells.slice(startCell.cellIndex, endCell.cellIndex + 1);\n    }\n\n    return [];\n  }\n\n  getAppointmentElements() {\n    return [].slice.call(this.parent.element.querySelectorAll('.' + APPOINTMENT_CLASS));\n  }\n\n  getAppointmentElementsByGuid(guid) {\n    return [].slice.call(this.parent.element.querySelectorAll('div[data-guid=\"' + guid + '\"]'));\n  }\n\n  getUniqueAppointmentElements() {\n    const appointments = this.getAppointmentElements();\n    const appointmentElements = [];\n    appointments.map(value => value.getAttribute('data-guid')).filter((value, index, self) => {\n      if (self.indexOf(value) === index) {\n        appointmentElements.push(appointments[index]);\n      }\n    });\n    return appointmentElements;\n  }\n\n  getWorkCellFromAppointmentElement(target) {\n    const selectedObject = this.parent.eventBase.getEventByGuid(target.getAttribute('data-guid'));\n    return this.parent.eventBase.selectWorkCellByTime([selectedObject]);\n  }\n\n  processViewNavigation(e) {\n    const index = parseInt(e.key, 10) - 1;\n\n    if (index < this.parent.views.length) {\n      const view = this.parent.viewCollections[index].option;\n      this.parent.changeView(view, e, undefined, index);\n\n      if (this.parent.headerModule) {\n        this.parent.headerModule.element.querySelector('.e-active-view button').focus();\n      }\n    }\n  }\n\n  cancelUpDownAction(isTimelineYear) {\n    const isVerticalYear = isTimelineYear && this.parent.activeViewOptions.orientation === 'Vertical';\n    const isGroup = this.parent.activeViewOptions.group.resources.length > 0;\n\n    if (isVerticalYear && isGroup || isTimelineYear && this.initialTarget.classList.contains(OTHERMONTH_CLASS)) {\n      return true;\n    }\n\n    if (this.parent.activeView.isTimelineView() && !isTimelineYear || this.parent.currentView === 'MonthAgenda') {\n      return true;\n    }\n\n    return false;\n  }\n\n  processUp(e, isMultiple) {\n    const isTimelineYear = this.parent.currentView === 'TimelineYear';\n\n    if (isMultiple && this.cancelUpDownAction(isTimelineYear)) {\n      return;\n    }\n\n    let target = e.target;\n    const selectedElements = this.parent.getSelectedElements();\n    const selectedEventElements = this.parent.eventBase.getSelectedAppointments();\n    const moreEventWrapper = this.parent.element.querySelector('.' + MORE_POPUP_WRAPPER_CLASS);\n    const quickPopupWrapper = this.getQuickPopupElement();\n\n    if (selectedElements.length > 0 && !e.target.classList.contains(WORK_CELLS_CLASS)) {\n      target = selectedElements[selectedElements.length - 1];\n    }\n\n    if (selectedEventElements.length > 0 && !moreEventWrapper.classList.contains(POPUP_OPEN) && !quickPopupWrapper.classList.contains(POPUP_OPEN) && ['Day', 'Week', 'WorkWeek', 'Month'].indexOf(this.parent.currentView) !== -1) {\n      target = this.getWorkCellFromAppointmentElement(selectedEventElements[selectedEventElements.length - 1]);\n      this.parent.eventBase.removeSelectedAppointmentClass();\n    }\n\n    if (!target) {\n      return;\n    }\n\n    if (target.classList.contains(WORK_CELLS_CLASS) && !this.parent.element.querySelector('.' + POPUP_OPEN)) {\n      const tableRows = this.parent.getTableRows();\n      const curRowIndex = tableRows.indexOf(target.parentElement);\n      let targetCell;\n\n      if (isTimelineYear && isMultiple && this.parent.activeViewOptions.group.resources.length === 0) {\n        targetCell = this.isInverseTableSelect() ? this.getVerticalUpDownCell(tableRows, target, curRowIndex, true) : this.getHorizontalUpDownCell(tableRows, target, curRowIndex, true);\n      }\n\n      if ((curRowIndex > 0 || targetCell) && curRowIndex < tableRows.length) {\n        targetCell = targetCell ? targetCell : tableRows[curRowIndex - 1].cells[target.cellIndex];\n\n        if (this.parent.currentView === 'Year' && targetCell.classList.contains(OTHERMONTH_CLASS)) {\n          if (this.parent.activeView.getStartDate().getTime() < +targetCell.getAttribute('data-date')) {\n            targetCell = this.getYearUpDownCell(tableRows, curRowIndex - 1, target.cellIndex, true);\n          } else {\n            return;\n          }\n        }\n\n        this.selectCells(isMultiple, targetCell);\n      }\n    } else if (this.parent.currentView === 'Agenda' || this.parent.currentView === 'MonthAgenda') {\n      this.selectAppointment(true, target);\n    }\n  }\n\n  processDown(e, isMultiple) {\n    const isTimelineYear = this.parent.currentView === 'TimelineYear';\n\n    if (isMultiple && this.cancelUpDownAction(isTimelineYear)) {\n      return;\n    }\n\n    let target = e.target;\n    const selectedCells = this.parent.getSelectedElements();\n    const selectedElements = this.parent.eventBase.getSelectedAppointments();\n    const moreEventWrapper = this.parent.element.querySelector('.' + MORE_POPUP_WRAPPER_CLASS);\n    const quickPopupWrapper = this.getQuickPopupElement();\n\n    if (selectedCells.length > 0 && !e.target.classList.contains(WORK_CELLS_CLASS)) {\n      target = selectedCells[selectedCells.length - 1];\n    }\n\n    if (selectedElements.length > 0 && !moreEventWrapper.classList.contains(POPUP_OPEN) && !quickPopupWrapper.classList.contains(POPUP_OPEN) && ['Day', 'Week', 'WorkWeek', 'Month'].indexOf(this.parent.currentView) !== -1) {\n      target = this.getWorkCellFromAppointmentElement(selectedElements[selectedElements.length - 1]);\n      this.parent.eventBase.removeSelectedAppointmentClass();\n    }\n\n    const tableRows = this.parent.getTableRows();\n\n    if (!target) {\n      return;\n    }\n\n    if (target.classList.contains(WORK_CELLS_CLASS) && !this.parent.element.querySelector('.' + POPUP_OPEN)) {\n      const curRowIndex = tableRows.indexOf(target.parentElement);\n      let targetCell;\n\n      if (isTimelineYear && isMultiple && this.parent.activeViewOptions.group.resources.length === 0) {\n        targetCell = this.isInverseTableSelect() ? this.getVerticalUpDownCell(tableRows, target, curRowIndex, false) : this.getHorizontalUpDownCell(tableRows, target, curRowIndex, false);\n      }\n\n      if (curRowIndex >= 0 && (curRowIndex < tableRows.length - 1 || targetCell)) {\n        targetCell = targetCell ? targetCell : tableRows[curRowIndex + 1].cells[target.cellIndex];\n\n        if (this.parent.currentView === 'Year' && targetCell.classList.contains(OTHERMONTH_CLASS)) {\n          if (this.parent.activeView.getEndDate().getTime() > +targetCell.getAttribute('data-date')) {\n            targetCell = this.getYearUpDownCell(tableRows, curRowIndex + 1, target.cellIndex, false);\n          } else {\n            return;\n          }\n        }\n\n        this.selectCells(isMultiple, targetCell);\n      }\n    } else if (this.parent.currentView === 'Agenda' || this.parent.currentView === 'MonthAgenda') {\n      this.selectAppointment(false, target);\n    }\n  }\n\n  getYearUpDownCell(tableRows, rowIndex, cellIndex, isUp) {\n    while (tableRows[rowIndex] && tableRows[rowIndex].cells[cellIndex].classList.contains(OTHERMONTH_CLASS)) {\n      rowIndex = rowIndex + (isUp ? -1 : 1);\n    }\n\n    return tableRows[rowIndex].cells[cellIndex];\n  } // eslint-disable-next-line max-len\n\n\n  getHorizontalUpDownCell(tableRows, target, curRowIndex, isUp) {\n    const row = tableRows[curRowIndex + (isUp ? -1 : 1)];\n    let cell = row ? row.cells[target.cellIndex] : target;\n\n    if (cell.classList.contains(OTHERMONTH_CLASS)) {\n      const workCell = row.querySelector('.' + WORK_CELLS_CLASS + ':not(.' + OTHERMONTH_CLASS + ')');\n      const date = new Date(+workCell.getAttribute('data-date'));\n      const query = '[data-date=\"' + new Date(date.getFullYear(), date.getMonth() + 1, 0).getTime() + '\"]';\n      cell = cell.cellIndex < workCell.cellIndex ? workCell : row.querySelector(query);\n    }\n\n    return cell;\n  } // eslint-disable-next-line max-len\n\n\n  getVerticalUpDownCell(tableRows, target, curRowIndex, isUp) {\n    const hasRow = isUp && curRowIndex > 0 || !isUp && curRowIndex < tableRows.length - 1;\n    let targetCell = hasRow ? tableRows[curRowIndex + (isUp ? -1 : 1)].cells[target.cellIndex] : undefined;\n\n    if (!targetCell || targetCell.classList.contains(OTHERMONTH_CLASS)) {\n      const column = tableRows[curRowIndex].cells[target.cellIndex - (isUp ? 1 : -1)];\n\n      if (column) {\n        const dateAttr = +target.getAttribute('data-date') - (isUp ? MS_PER_DAY : -MS_PER_DAY);\n        return this.parent.getContentTable().querySelector('.' + WORK_CELLS_CLASS + '[data-date=\"' + dateAttr + '\"]');\n      }\n\n      targetCell = target;\n    }\n\n    return targetCell;\n  }\n\n  processLeftRight(target) {\n    const tableEle = this.parent.currentView === 'Year' ? target.closest('tbody') : this.parent.getContentTable();\n    const curRowIndex = target.parentNode.sectionRowIndex;\n    const key = {\n      element: tableEle,\n      rowIndex: curRowIndex,\n      columnIndex: target.cellIndex,\n      maxIndex: tableEle.rows[curRowIndex].cells.length\n    };\n    return key;\n  }\n\n  getQuickPopupElement() {\n    return (this.parent.isAdaptive ? document.body : this.parent.element).querySelector('.' + POPUP_WRAPPER_CLASS);\n  }\n\n  isCancelLeftRightAction(e, isMultiple, isTimelineYear) {\n    const prevent = this.parent.currentView === 'MonthAgenda' || isTimelineYear && this.initialTarget.classList.contains(OTHERMONTH_CLASS);\n\n    if (this.parent.currentView === 'Agenda' || isMultiple && prevent) {\n      return true;\n    }\n\n    if (this.isPreventAction(e) && isMultiple) {\n      return true;\n    }\n\n    const moreEventWrapper = this.parent.element.querySelector('.' + MORE_POPUP_WRAPPER_CLASS);\n    const quickPopupWrapper = this.getQuickPopupElement();\n\n    if (moreEventWrapper.classList.contains(POPUP_OPEN) || quickPopupWrapper.classList.contains(POPUP_OPEN)) {\n      return true;\n    }\n\n    return false;\n  }\n\n  processRight(e, isMultiple) {\n    const isTimelineYear = this.parent.currentView === 'TimelineYear';\n\n    if (this.isCancelLeftRightAction(e, isMultiple, isTimelineYear)) {\n      return;\n    }\n\n    const selectedCells = this.parent.getSelectedElements();\n    let targetCell;\n    const selectedAppointments = this.parent.eventBase.getSelectedAppointments();\n    let target = e.target;\n\n    if (selectedCells.length > 0 && !target.classList.contains(WORK_CELLS_CLASS) && !target.classList.contains(ALLDAY_CELLS_CLASS)) {\n      target = selectedCells[selectedCells.length - 1];\n    }\n\n    if (selectedAppointments.length > 0) {\n      target = this.getWorkCellFromAppointmentElement(selectedAppointments[selectedAppointments.length - 1]);\n      this.parent.eventBase.removeSelectedAppointmentClass();\n\n      if (!target) {\n        return;\n      }\n    }\n\n    if (target.classList.contains(WORK_CELLS_CLASS) && e.target.classList.contains(WORK_CELLS_CLASS)) {\n      const key = this.processLeftRight(target);\n      const targetDate = new Date(+target.getAttribute('data-date'));\n      const isMonthEnd = this.parent.currentView === 'Year' && targetDate.getTime() === lastDateOfMonth(targetDate).getTime();\n\n      if (key.columnIndex >= 0 && key.columnIndex < key.maxIndex - 1 && !isMonthEnd) {\n        targetCell = this.calculateNextPrevDate(target, key.element.rows[key.rowIndex].cells[target.cellIndex + 1], 'right');\n\n        if (isTimelineYear && isMultiple && targetCell.classList.contains(OTHERMONTH_CLASS)) {\n          targetCell = this.getTimelineYearTargetCell(key, target, true);\n        }\n\n        if (!isNullOrUndefined(targetCell)) {\n          this.selectCells(isMultiple, targetCell);\n        }\n      } else if (key.columnIndex === key.maxIndex - 1 || isMonthEnd) {\n        if (!this.isInverseTableSelect() && key.rowIndex < key.element.rows.length - 1 && !isMonthEnd) {\n          targetCell = this.calculateNextPrevDate(target, key.element.rows[key.rowIndex + 1].cells[0], 'right');\n          const changeTargetCell = isTimelineYear && isMultiple && targetCell.classList.contains(OTHERMONTH_CLASS);\n          targetCell = changeTargetCell ? this.getHorizontalLeftRightCell(key, target, true) : targetCell;\n\n          if (!isNullOrUndefined(targetCell)) {\n            this.selectCells(isMultiple, targetCell);\n          }\n        } else if (!isMultiple) {\n          if (isMonthEnd && targetDate.getTime() !== this.parent.activeView.getEndDate().getTime()) {\n            this.selectCells(isMultiple, this.parent.element.querySelector(':not(.' + OTHERMONTH_CLASS + ')[data-date=\"' + (targetDate.getTime() + MS_PER_DAY) + '\"]'));\n            return;\n          }\n\n          const rowIndex = this.isInverseTableSelect() ? key.rowIndex : 0;\n          this.parent.changeDate(this.parent.activeView.getNextPreviousDate('next'), e);\n          const tableEle = this.parent.getContentTable();\n          const cell = isMonthEnd ? tableEle.rows[rowIndex].querySelector('.' + WORK_CELLS_CLASS + ':not(.' + OTHERMONTH_CLASS + ')') : tableEle.rows[rowIndex].cells[0];\n          this.selectCells(false, cell);\n        }\n      }\n    } else if (target.classList.contains(ALLDAY_CELLS_CLASS)) {\n      const curColIndex = target.cellIndex;\n      const allDayRow = this.parent.getAllDayRow();\n      const maxColIndex = allDayRow.cells.length;\n\n      if (curColIndex >= 0 && curColIndex < maxColIndex - 1) {\n        this.selectCells(isMultiple, allDayRow.cells[curColIndex + 1]);\n      } else if (curColIndex === maxColIndex - 1 && !isMultiple) {\n        this.parent.changeDate(this.parent.activeView.getNextPreviousDate('next'), e);\n        const allDayRow = this.parent.getAllDayRow();\n        this.selectCells(false, allDayRow.cells[0]);\n      }\n    }\n  }\n\n  processLeft(e, isMultiple) {\n    const isTimelineYear = this.parent.currentView === 'TimelineYear';\n\n    if (this.isCancelLeftRightAction(e, isMultiple, isTimelineYear)) {\n      return;\n    }\n\n    let target = e.target;\n    const selectedCells = this.parent.getSelectedElements();\n    let targetCell;\n\n    if (selectedCells.length > 0 && !target.classList.contains(WORK_CELLS_CLASS) && !target.classList.contains(ALLDAY_CELLS_CLASS)) {\n      target = selectedCells[selectedCells.length - 1];\n    }\n\n    const selectedElements = this.parent.eventBase.getSelectedAppointments();\n\n    if (selectedElements.length > 0) {\n      target = this.getWorkCellFromAppointmentElement(selectedElements[selectedElements.length - 1]);\n      this.parent.eventBase.removeSelectedAppointmentClass();\n\n      if (!target) {\n        return;\n      }\n    }\n\n    if (e.target.classList.contains(WORK_CELLS_CLASS) && target.classList.contains(WORK_CELLS_CLASS)) {\n      const key = this.processLeftRight(target);\n      const targetDate = new Date(+target.getAttribute('data-date'));\n      const isMonthStart = this.parent.currentView === 'Year' && targetDate.getTime() === firstDateOfMonth(targetDate).getTime();\n\n      if (key.columnIndex > 0 && key.columnIndex < key.maxIndex && !isMonthStart) {\n        targetCell = this.calculateNextPrevDate(target, key.element.rows[key.rowIndex].cells[target.cellIndex - 1], 'left');\n\n        if (isTimelineYear && isMultiple && targetCell.classList.contains(OTHERMONTH_CLASS)) {\n          targetCell = this.getTimelineYearTargetCell(key, target, false);\n        }\n\n        if (!isNullOrUndefined(targetCell)) {\n          this.selectCells(isMultiple, targetCell);\n        }\n      } else if (key.columnIndex === 0 || isMonthStart) {\n        if (!this.isInverseTableSelect() && key.rowIndex > 0) {\n          targetCell = this.calculateNextPrevDate(target, key.element.rows[key.rowIndex - 1].cells[key.maxIndex - 1], 'left');\n          const otherMonthCell = isTimelineYear && isMultiple && targetCell.classList.contains(OTHERMONTH_CLASS);\n          targetCell = otherMonthCell ? this.getHorizontalLeftRightCell(key, target, false) : targetCell;\n\n          if (!isNullOrUndefined(targetCell)) {\n            this.selectCells(isMultiple, targetCell);\n          }\n        } else if (!isMultiple) {\n          if (isMonthStart && targetDate.getTime() !== this.parent.activeView.getStartDate().getTime()) {\n            this.selectCells(isMultiple, this.parent.element.querySelector('[data-date=\"' + (targetDate.getTime() - MS_PER_DAY) + '\"]'));\n            return;\n          }\n\n          this.parent.changeDate(this.parent.activeView.getNextPreviousDate('previous'), e);\n          const tableEle = this.parent.getContentTable();\n          const rowIndex = this.isInverseTableSelect() ? key.rowIndex : tableEle.rows.length - 1;\n          let cell = tableEle.rows[rowIndex].cells[key.maxIndex - 1];\n\n          if (isMonthStart) {\n            const tbody = this.parent.element.querySelectorAll('.' + CONTENT_TABLE_CLASS + ' tbody');\n            cell = tbody.item(tbody.length - 1).querySelector(':not(.' + OTHERMONTH_CLASS + ')[data-date=\"' + this.parent.activeView.getEndDate().getTime() + '\"]');\n          }\n\n          this.selectCells(false, cell);\n        }\n      }\n    } else if (target.classList.contains(ALLDAY_CELLS_CLASS)) {\n      const curColIndex = target.cellIndex;\n      const allDayRow = this.parent.getAllDayRow();\n      const maxColIndex = allDayRow.cells.length;\n\n      if (curColIndex > 0 && curColIndex < maxColIndex) {\n        this.selectCells(isMultiple, allDayRow.cells[curColIndex - 1]);\n      } else if (curColIndex === 0 && !isMultiple) {\n        this.parent.changeDate(this.parent.activeView.getNextPreviousDate('previous'), e);\n        const allDayRow = this.parent.getAllDayRow();\n        this.selectCells(false, allDayRow.cells[maxColIndex - 1]);\n      }\n    }\n  }\n\n  getTimelineYearTargetCell(key, target, isRight) {\n    return this.isInverseTableSelect() ? this.getVerticalLeftRightCell(target, isRight) : this.getHorizontalLeftRightCell(key, target, isRight);\n  }\n\n  getHorizontalLeftRightCell(key, target, isRight) {\n    const row = key.element.rows[target.parentNode.sectionRowIndex + (isRight ? 1 : -1)];\n\n    if (row) {\n      const query = isRight ? '.' + WORK_CELLS_CLASS + ':not(.' + OTHERMONTH_CLASS + ')' : '[data-date=\"' + (+target.getAttribute('data-date') - MS_PER_DAY) + '\"]';\n      return row.querySelector(query);\n    }\n\n    return target;\n  }\n\n  getVerticalLeftRightCell(target, isRight) {\n    const date = new Date(+target.getAttribute('data-date'));\n    const start = new Date(date.getFullYear(), date.getMonth() + (isRight ? 1 : -1), 1);\n    const tableEle = this.parent.getContentTable();\n    const targetCell = tableEle.querySelector('[data-date=\"' + start.getTime() + '\"]');\n\n    if (targetCell.parentNode.sectionRowIndex > target.parentNode.sectionRowIndex) {\n      return targetCell;\n    }\n\n    return tableEle.querySelector('[data-date=\"' + new Date(start.getFullYear(), start.getMonth() + 1, 0).getTime() + '\"]');\n  }\n\n  calculateNextPrevDate(currentCell, target, type) {\n    const initialId = this.initialTarget.getAttribute('data-group-index');\n\n    if (this.parent.activeViewOptions.group.resources.length > 0 && this.parent.currentView === 'Month') {\n      if (currentCell && target && target.getAttribute('data-group-index') !== initialId) {\n        const currentDate = this.parent.getDateFromElement(currentCell);\n        const nextPrevDate = type === 'right' ? new Date(currentDate.setDate(currentDate.getDate() + 1)) : new Date(currentDate.setDate(currentDate.getDate() - 1));\n        target = [].slice.call(this.parent.element.querySelectorAll('td[data-date=\"' + nextPrevDate.getTime().toString() + '\"]' + '[data-group-index=\"' + initialId + '\"]'))[0];\n      }\n    }\n\n    return target;\n  }\n\n  getFocusableElements(container) {\n    const queryString = 'a[href]:not([tabindex=\"-1\"]),input:not([disabled]):not([tabindex=\"-1\"]),' + 'textarea:not([disabled]):not([tabindex=\"-1\"]),button:not([disabled]):not([tabindex=\"-1\"]),' + 'select:not([disabled]):not([tabindex=\"-1\"]),[tabindex]:not([tabindex=\"-1\"]),[contentEditable=true]:not([tabindex=\"-1\"])';\n    return [].slice.call(container.querySelectorAll(queryString));\n  }\n\n  processTabOnPopup(e, popupElement) {\n    let focusableElements = this.getFocusableElements(popupElement);\n    focusableElements = focusableElements.filter(element => {\n      const footerEle = this.parent.element.querySelector('.' + POPUP_FOOTER_CLASS);\n\n      if (footerEle && footerEle.offsetParent) {\n        return !(element.classList.contains(EDIT_CLASS) || element.classList.contains(DELETE_CLASS));\n      } else {\n        return !(element.classList.contains(EDIT_EVENT_CLASS) || element.classList.contains(DELETE_EVENT_CLASS));\n      }\n    });\n    const firstEle = focusableElements[0];\n    const lastEle = focusableElements[focusableElements.length - 1];\n\n    if (!isNullOrUndefined(lastEle) && document.activeElement === lastEle && !e.shiftKey) {\n      e.preventDefault();\n      firstEle.focus();\n    }\n\n    if (!isNullOrUndefined(firstEle) && document.activeElement === firstEle && e.shiftKey) {\n      e.preventDefault();\n      lastEle.focus();\n    }\n  }\n\n  processTab(e, isReverse) {\n    let target = e.target;\n\n    if (target.classList.contains(INLINE_SUBJECT_CLASS) && this.parent.inlineModule) {\n      target = target.closest('.e-appointment');\n      this.parent.inlineModule.inlineCrudActions(e.target);\n    }\n\n    if (this.parent.currentView === 'TimelineYear' && target.classList.contains(OTHERMONTH_CLASS)) {\n      if (target.classList.contains(SELECTED_CELL_CLASS)) {\n        this.parent.removeSelectedClass();\n      }\n\n      return;\n    }\n\n    const popupWrapper = closest(target, '.' + POPUP_WRAPPER_CLASS + ',.' + MORE_POPUP_WRAPPER_CLASS);\n\n    if (popupWrapper && popupWrapper.classList.contains(POPUP_OPEN)) {\n      if (popupWrapper.classList.contains(MORE_POPUP_WRAPPER_CLASS)) {\n        this.parent.eventBase.removeSelectedAppointmentClass();\n      }\n\n      this.processTabOnPopup(e, popupWrapper);\n      return;\n    }\n\n    if (target.classList.contains(ROOT)) {\n      this.parent.eventBase.removeSelectedAppointmentClass();\n      return;\n    }\n\n    if (target.classList.contains(RESOURCE_CELLS_CLASS) && this.parent.activeView.isTimelineView() && this.parent.activeViewOptions.group.resources.length > 0) {\n      const index = parseInt(target.getAttribute('data-group-index'), 10);\n      const appSelector = `.${APPOINTMENT_CLASS}[data-group-index=\"${isReverse ? index - 1 : index}\"]`;\n      const appElements = [].slice.call(this.parent.element.querySelectorAll(appSelector));\n\n      if (appElements.length > 0) {\n        this.parent.eventBase.removeSelectedAppointmentClass();\n        const focusAppointment = isReverse ? appElements.slice(-1)[0] : appElements[0];\n        this.parent.eventBase.addSelectedAppointments([focusAppointment]);\n        focusAppointment.focus();\n        e.preventDefault();\n      } else if (index + 1 === this.parent.resourceBase.lastResourceLevel.length) {\n        this.parent.element.focus();\n        e.preventDefault();\n      } else if (this.parent.virtualScrollModule) {\n        const virtual = this.parent.element.querySelector('.' + VIRTUAL_TRACK_CLASS);\n        const averageRowHeight = Math.round(virtual.offsetHeight / this.parent.resourceBase.expandedResources.length);\n        this.parent.element.querySelector('.e-content-wrap').scrollTop = (isReverse ? index - 1 : index + 1) * averageRowHeight;\n        this.parent.virtualScrollModule.virtualScrolling();\n      } else {\n        this.setScrollPosition(index);\n      }\n\n      return;\n    }\n\n    if (target.classList.contains(APPOINTMENT_CLASS)) {\n      let appElements = [].slice.call(this.parent.element.querySelectorAll('.' + APPOINTMENT_CLASS));\n      const isTimelineYear = this.parent.currentView === 'TimelineYear';\n      const isTimeline = this.parent.activeView.isTimelineView() && !isTimelineYear;\n\n      if ((isTimeline || isTimelineYear && this.parent.activeViewOptions.orientation === 'Vertical') && this.parent.activeViewOptions.group.resources.length > 0) {\n        const index = parseInt(target.getAttribute('data-group-index'), 10);\n        appElements = [].slice.call(this.parent.element.querySelectorAll(`.${APPOINTMENT_CLASS}[data-group-index=\"${index}\"]`));\n        const resCellSelector = `.${RESOURCE_CELLS_CLASS}[data-group-index=\"${isReverse ? index : index + 1}\"]`;\n        const resourceCell = this.parent.element.querySelector(resCellSelector);\n\n        if (resourceCell && (isReverse && target.getAttribute('data-guid') === appElements[0].getAttribute('data-guid') || !isReverse && target.getAttribute('data-guid') === appElements.slice(-1)[0].getAttribute('data-guid'))) {\n          this.parent.eventBase.removeSelectedAppointmentClass();\n\n          if (this.parent.virtualScrollModule) {\n            resourceCell.focus({\n              preventScroll: true\n            });\n          } else {\n            resourceCell.focus();\n          }\n\n          if (this.parent.activeView.isTimelineView() && this.parent.activeViewOptions.group.resources.length > 0 && isNullOrUndefined(this.parent.virtualScrollModule)) {\n            this.setScrollPosition(index);\n          }\n\n          e.preventDefault();\n          return;\n        }\n      }\n\n      const selectedAppointments = this.parent.eventBase.getSelectedAppointments();\n\n      if (selectedAppointments.length > 0) {\n        target = selectedAppointments[selectedAppointments.length - 1];\n      }\n\n      this.parent.eventBase.removeSelectedAppointmentClass();\n\n      if (!isReverse && target.getAttribute('data-guid') === appElements[appElements.length - 1].getAttribute('data-guid') || isReverse && target.getAttribute('data-guid') === appElements[0].getAttribute('data-guid')) {\n        return;\n      }\n\n      if (this.parent.currentView === 'Agenda' || this.parent.currentView === 'MonthAgenda') {\n        this.selectAppointment(isReverse, target);\n        e.preventDefault();\n      }\n\n      return;\n    }\n\n    const selectedCells = this.parent.getSelectedElements();\n\n    if (selectedCells.length > 0 && !target.classList.contains(APPOINTMENT_CLASS)) {\n      target = selectedCells[selectedCells.length - 1];\n      this.selectAppointmentElementFromWorkCell(isReverse, target);\n      e.preventDefault();\n      return;\n    }\n\n    if (target && !target.classList.contains(RESOURCE_CELLS_CLASS) && this.parent.activeView.isTimelineView() && this.parent.activeViewOptions.group.resources.length > 0) {\n      this.processTabOnResourceCells(target, isReverse);\n    }\n  }\n\n  processDelete(e) {\n    let activeEle = document.activeElement;\n\n    if (this.parent.currentView === 'MonthAgenda') {\n      const selectedEle = this.parent.eventBase.getSelectedEvents().element;\n      activeEle = selectedEle && isNullOrUndefined(selectedEle.length) ? selectedEle : selectedEle[0];\n    }\n\n    if (activeEle && activeEle.classList.contains(APPOINTMENT_CLASS)) {\n      addClass([activeEle], APPOINTMENT_BORDER);\n      this.parent.activeEventData = this.parent.eventBase.getSelectedEvents();\n\n      if (this.parent.activeViewOptions.readonly || activeEle.classList.contains(READ_ONLY) || !this.parent.eventSettings.allowDeleting) {\n        return;\n      }\n\n      this.parent.quickPopup.deleteClick(e);\n    }\n  }\n\n  processCtrlShiftNavigationArrows(e) {\n    if (this.parent.activeViewOptions.group.resources.length > 0 && document.activeElement.classList.contains(APPOINTMENT_CLASS)) {\n      const groupIndex = parseInt(document.activeElement.getAttribute('data-group-index'), 10);\n      let index = e.action === 'ctrlShiftLeftArrow' || e.action === 'ctrlShiftUpArrow' ? groupIndex - 1 : groupIndex + 1;\n      index = index < 0 ? 0 : index > this.parent.resourceBase.lastResourceLevel.length ? this.parent.resourceBase.lastResourceLevel.length : index;\n      let eventEle = [];\n\n      while (eventEle.length === 0 && index >= 0 && index <= this.parent.resourceBase.lastResourceLevel.length) {\n        eventEle = [].slice.call(this.parent.element.querySelectorAll(`.${APPOINTMENT_CLASS}[data-group-index=\"${index}\"]`));\n        index = e.action === 'ctrlShiftLeftArrow' || e.action === 'ctrlShiftUpArrow' ? index - 1 : index + 1;\n      }\n\n      const nextAppEle = eventEle[0];\n\n      if (nextAppEle) {\n        this.parent.eventBase.removeSelectedAppointmentClass();\n        this.parent.eventBase.addSelectedAppointments([nextAppEle]);\n        nextAppEle.focus();\n      }\n    } else if (this.parent.activeViewOptions.group.resources.length > 0 && !document.activeElement.classList.contains(APPOINTMENT_CLASS)) {\n      const index = this.parent.resourceBase.renderedResources[0].groupIndex;\n      const appSelector = `.${APPOINTMENT_CLASS}[data-group-index=\"${index}\"]`;\n      const appElements = [].slice.call(this.parent.element.querySelectorAll(appSelector));\n\n      if (appElements.length > 0) {\n        this.parent.eventBase.removeSelectedAppointmentClass();\n        const focusAppointment = appElements[0];\n        this.parent.eventBase.addSelectedAppointments([focusAppointment]);\n        focusAppointment.focus();\n        e.preventDefault();\n      }\n    }\n  }\n\n  processEscape(event) {\n    this.parent.quickPopup.onClosePopup(event);\n    this.parent.quickPopup.morePopup.hide();\n\n    if (this.parent.headerModule) {\n      this.parent.headerModule.hideHeaderPopup();\n    }\n\n    if (this.parent.inlineModule) {\n      this.parent.inlineModule.removeInlineAppointmentElement();\n    }\n  }\n\n  isPreventAction(e) {\n    const target = closest(e.target, '.' + RESOURCE_GROUP_CELLS_CLASS);\n\n    if (this.parent.activeView.isTimelineView() && !isNullOrUndefined(target)) {\n      return true;\n    }\n\n    return false;\n  }\n\n  processTabOnResourceCells(target, isReverse) {\n    const tabElements = [].slice.call(this.parent.element.querySelectorAll('[tabIndex=\"0\"]'));\n    const currentTabIndex = tabElements.indexOf(target);\n    const nextTabElement = !isReverse ? tabElements[currentTabIndex + 1] : tabElements[currentTabIndex - 1];\n\n    if (nextTabElement && nextTabElement.classList.contains(RESOURCE_CELLS_CLASS)) {\n      const groupIndex = parseInt(nextTabElement.getAttribute('data-group-index'), 10);\n\n      if (this.parent.virtualScrollModule) {\n        const resColWrap = this.parent.element.querySelector('.' + RESOURCE_COLUMN_WRAP_CLASS);\n        const resCells = [].slice.call(this.parent.element.querySelectorAll('.' + RESOURCE_CELLS_CLASS));\n        resCells.forEach(element => {\n          if (element.getBoundingClientRect().top < resColWrap.getBoundingClientRect().top) {\n            element.setAttribute('tabindex', '-1');\n          }\n        });\n      } else {\n        this.setScrollPosition(groupIndex);\n      }\n    }\n  }\n\n  setScrollPosition(index) {\n    const workCell = this.parent.element.querySelector(`.${WORK_CELLS_CLASS}[data-group-index=\"${index}\"]`);\n\n    if (workCell) {\n      this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS).scrollTop = workCell.offsetTop;\n    }\n  }\n  /**\n   * Get module name.\n   *\n   * @returns {string} Returns the module name.\n   */\n\n\n  getModuleName() {\n    return 'keyboard';\n  }\n  /**\n   * To destroy the keyboard module.\n   *\n   * @returns {void}\n   * @private\n   */\n\n\n  destroy() {\n    this.removeEventListener();\n    this.keyboardModule.destroy();\n  }\n\n}\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\n/**\n * data module is used to generate query and data source.\n *\n * @private\n */\n\n\nclass Data {\n  /**\n   * Constructor for data module\n   *\n   * @param {Object | DataManager} dataSource Accepts the datasource as JSON objects or DataManager\n   * @param {Query} query Accepts the query to process the data\n   * @private\n   */\n  constructor(dataSource, query) {\n    this.initDataManager(dataSource, query);\n  }\n  /**\n   * The function used to initialize dataManager and query\n   *\n   * @param {Object | DataManager} dataSource Accepts the datasource as JSON objects or DataManager\n   * @param {Query} query Accepts the query to process the data\n   * @returns {void}\n   * @private\n   */\n\n\n  initDataManager(dataSource, query) {\n    this.dataManager = dataSource instanceof DataManager ? dataSource : new DataManager(dataSource);\n    this.query = query instanceof Query ? query : new Query();\n  }\n  /**\n   * The function used to generate updated Query from schedule model\n   *\n   * @param {Date} startDate Accepts the start date\n   * @param {Date} endDate Accepts the end date\n   * @returns {void}\n   * @private\n   */\n\n\n  generateQuery(startDate, endDate) {\n    const query = this.query.clone();\n\n    if (startDate) {\n      query.addParams('StartDate', startDate.toISOString());\n    }\n\n    if (endDate) {\n      query.addParams('EndDate', endDate.toISOString());\n    }\n\n    return query;\n  }\n  /**\n   * The function used to get dataSource by executing given Query\n   *\n   * @param  {Query} query - A Query that specifies to generate dataSource\n   * @returns {void}\n   * @private\n   */\n\n\n  getData(query) {\n    return this.dataManager.executeQuery(query);\n  }\n  /**\n   * To destroy the crud module.\n   *\n   * @returns {void}\n   * @private\n   */\n\n\n  destroy() {\n    this.dataManager = null;\n    this.query = null;\n  }\n\n}\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\n/** @private */\n\n\nclass Gregorian {\n  firstDateOfMonth(date) {\n    return new Date(date.getFullYear(), date.getMonth());\n  }\n\n  lastDateOfMonth(dt) {\n    return new Date(dt.getFullYear(), dt.getMonth() + 1, 0);\n  }\n\n  isMonthStart(date) {\n    return date.getDate() === 1;\n  }\n\n  getLeapYearDaysCount() {\n    return 366;\n  }\n\n  getYearDaysCount(date, interval) {\n    return (date.getFullYear() + interval) % 4 === 0 ? 366 : 365;\n  }\n\n  getDate(date) {\n    return date.getDate();\n  }\n\n  getMonth(date) {\n    return date.getMonth() + 1;\n  }\n\n  getFullYear(date) {\n    return date.getFullYear();\n  }\n\n  getYearLastDate(date, interval) {\n    return new Date(date.getFullYear() + interval, 0, 0);\n  }\n\n  getMonthDaysCount(date) {\n    return this.lastDateOfMonth(date).getDate();\n  }\n\n  getMonthStartDate(date) {\n    return new Date(date.getFullYear(), date.getMonth(), 1, date.getHours(), date.getMinutes());\n  }\n\n  getMonthEndDate(date) {\n    date.setDate(1);\n    return new Date(date.setMonth(date.getMonth() + 1));\n  }\n\n  getExpectedDays(date, days) {\n    return days;\n  }\n\n  setDate(dateObj, date) {\n    dateObj.setDate(date);\n  }\n\n  setValidDate(date, interval, startDate, monthValue, beginDate) {\n    if (!isNullOrUndefined(beginDate)) {\n      date.setMonth((beginDate ? monthValue : date.getMonth()) + interval);\n    } else {\n      date.setMonth(date.getMonth() + interval, startDate);\n    }\n  }\n\n  setMonth(date, interval, startDate) {\n    date.setFullYear(date.getFullYear());\n    date.setMonth(interval - 1);\n    date.setDate(startDate);\n  }\n\n  addYears(date, interval) {\n    date.setFullYear(date.getFullYear() + interval);\n  }\n\n  isSameMonth(date1, date2) {\n    return date1.getMonth() === date2.getMonth();\n  }\n\n  checkMonth(date, months) {\n    return months.indexOf(date.getMonth() + 1) === -1;\n  }\n\n  compareMonth(date1, date2) {\n    return date1.getMonth() > date2.getMonth();\n  }\n\n  isSameYear(date1, date2) {\n    return date1.getFullYear() === date2.getFullYear();\n  }\n\n  isLastMonth(date) {\n    return date.getMonth() === 11;\n  }\n\n  isLeapYear(year, interval) {\n    return (year + interval) % 4 === 0;\n  }\n\n}\n/** @private */\n\n\nclass Islamic {\n  firstDateOfMonth(date) {\n    const hDate = this.getHijriDate(date);\n    const gDate = HijriParser.toGregorian(hDate.year, hDate.month, 1);\n    return gDate;\n  }\n\n  lastDateOfMonth(date) {\n    const hDate = this.getHijriDate(date);\n    const daysInMonth = this.getDaysInMonth(hDate.month, hDate.year);\n    const gDate = HijriParser.toGregorian(hDate.year, hDate.month, daysInMonth);\n    let finalGDate = new Date(gDate.getTime());\n    finalGDate = new Date(finalGDate.setDate(finalGDate.getDate() + 1));\n    let finalHDate = this.getHijriDate(finalGDate);\n\n    if (hDate.month === finalHDate.month) {\n      return finalGDate;\n    }\n\n    finalHDate = this.getHijriDate(gDate);\n\n    if (hDate.month === finalHDate.month) {\n      return gDate;\n    }\n\n    return new Date(gDate.setDate(gDate.getDate() - 1));\n  }\n\n  isMonthStart(date) {\n    const hijriDate = this.getHijriDate(date);\n    return hijriDate.date === 1;\n  }\n\n  getLeapYearDaysCount() {\n    return 355;\n  }\n\n  getYearDaysCount(date, interval) {\n    const hDate = this.getHijriDate(date);\n    return this.isLeapYear(hDate.year, interval) ? 355 : 354;\n  }\n\n  getDate(date) {\n    const hijriDate = this.getHijriDate(date);\n    return hijriDate.date;\n  }\n\n  getMonth(date) {\n    const hDate = this.getHijriDate(date);\n    return hDate.month;\n  }\n\n  getFullYear(date) {\n    const hDate = this.getHijriDate(date);\n    return hDate.year;\n  }\n\n  getYearLastDate(date, interval) {\n    const hDate = this.getHijriDate(date);\n    const gDate = HijriParser.toGregorian(hDate.year + interval, 1, 0);\n    return gDate;\n  }\n\n  getMonthDaysCount(date) {\n    const maxDate = this.lastDateOfMonth(date);\n    const hijriDate = this.getHijriDate(maxDate);\n    return hijriDate.date;\n  }\n\n  getMonthStartDate(date) {\n    const firstDate = this.firstDateOfMonth(date);\n    return new Date(firstDate.getFullYear(), firstDate.getMonth(), firstDate.getDate(), date.getHours(), date.getMinutes());\n  }\n\n  getMonthEndDate(date) {\n    const lastDate = this.lastDateOfMonth(date);\n    lastDate.setDate(lastDate.getDate() + 1);\n    return new Date(lastDate.setMonth(lastDate.getMonth()));\n  }\n\n  getExpectedDays(date, days) {\n    const hDate = this.getHijriDate(date);\n    const day = [];\n\n    for (let i = 0; i < days.length; i++) {\n      const gDate = HijriParser.toGregorian(hDate.year, hDate.month, days[i]);\n      day.push(gDate.getDate());\n    }\n\n    return day;\n  }\n\n  setDate(dateObj, date) {\n    const hDate = this.getHijriDate(dateObj);\n    const gDate = HijriParser.toGregorian(hDate.year, hDate.month, date);\n    this.updateDateObj(dateObj, gDate);\n  }\n\n  setValidDate(date, interval, startDate, monthValue, beginDate) {\n    const firstDate = !isNullOrUndefined(beginDate) ? this.firstDateOfMonth(beginDate) : date;\n    const hDate = this.getHijriDate(firstDate);\n    const gDate = HijriParser.toGregorian(hDate.year, hDate.month + interval, startDate);\n    this.updateDateObj(date, gDate);\n  }\n\n  setMonth(date, interval, startDate) {\n    const hDate = this.getHijriDate(date);\n    const gDate = HijriParser.toGregorian(hDate.year, interval, startDate);\n    this.updateDateObj(date, gDate);\n  }\n\n  addYears(date, interval, monthValue) {\n    const hDate = this.getHijriDate(date);\n    const gDate = HijriParser.toGregorian(hDate.year + interval, monthValue, 1);\n    this.updateDateObj(date, gDate);\n  }\n\n  isSameMonth(date1, date2) {\n    const currentHijri = this.getHijriDate(date1);\n    const tempHijri = this.getHijriDate(date2);\n    return currentHijri.month === tempHijri.month;\n  }\n\n  checkMonth(date, months) {\n    const hDate = this.getHijriDate(date);\n    return months.indexOf(hDate.month) === -1;\n  }\n\n  compareMonth(date1, date2) {\n    const hDate = this.getHijriDate(date1);\n    const hDate1 = this.getHijriDate(date2);\n    return hDate.month > hDate1.month;\n  }\n\n  isSameYear(date1, date2) {\n    const hDate = this.getHijriDate(date1);\n    const hDate1 = this.getHijriDate(date2);\n    return hDate.year === hDate1.year;\n  }\n\n  isLastMonth(date) {\n    const hDate = this.getHijriDate(date);\n    return hDate.month === 12;\n  }\n\n  updateDateObj(date, gDate) {\n    date.setFullYear(gDate.getFullYear(), gDate.getMonth(), gDate.getDate());\n  }\n\n  isLeapYear(year, interval) {\n    return (14 + 11 * (year + interval)) % 30 < 11;\n  }\n\n  getDaysInMonth(month, year) {\n    let length = 0;\n    length = 29 + (month + 1) % 2;\n\n    if (month === 11 && this.isLeapYear(year, 0)) {\n      length++;\n    }\n\n    return length;\n  }\n\n  getHijriDate(date) {\n    return HijriParser.getHijriDate(date);\n  }\n\n}\n/**\n * Time zone\n */\n\n\nclass Timezone {\n  constructor() {\n    this.timezoneData = [];\n    this.timezoneData = this.getTimezoneData();\n  }\n\n  offset(date, timezone) {\n    const localOffset = date.getTimezoneOffset();\n\n    try {\n      const convertedDate = new Date(date.toLocaleString('en-US', {\n        timeZone: timezone\n      }));\n\n      if (!isNaN(convertedDate.getTime())) {\n        return (date.getTime() - convertedDate.getTime()) / 60000 + localOffset;\n      }\n\n      return 0;\n    } catch (error) {\n      return 0;\n    }\n  }\n\n  convert(date, fromOffset, toOffset) {\n    if (typeof fromOffset === 'string') {\n      fromOffset = this.offset(date, fromOffset);\n    }\n\n    if (typeof toOffset === 'string') {\n      toOffset = this.offset(date, toOffset);\n    }\n\n    const fromLocalOffset = date.getTimezoneOffset();\n    date = new Date(date.getTime() + (fromOffset - toOffset) * 60000);\n    const toLocalOffset = date.getTimezoneOffset();\n    return new Date(date.getTime() + (toLocalOffset - fromLocalOffset) * 60000);\n  }\n\n  add(date, timezone) {\n    return this.convert(date, date.getTimezoneOffset(), timezone);\n  }\n\n  remove(date, timezone) {\n    return this.convert(date, timezone, date.getTimezoneOffset());\n  }\n\n  removeLocalOffset(date) {\n    return new Date(date.getTime() - date.getTimezoneOffset() * 60000);\n  }\n\n  getLocalTimezoneName() {\n    return window.Intl ? Intl.DateTimeFormat().resolvedOptions().timeZone || 'UTC' : 'UTC';\n  }\n\n  getTimezoneData() {\n    return timezoneData;\n  }\n\n}\n\nconst timezoneData = [{\n  Value: 'Pacific/Niue',\n  Text: '(UTC-11:00) Niue'\n}, {\n  Value: 'Pacific/Pago_Pago',\n  Text: '(UTC-11:00) Pago Pago'\n}, {\n  Value: 'Pacific/Honolulu',\n  Text: '(UTC-10:00) Hawaii Time'\n}, {\n  Value: 'Pacific/Rarotonga',\n  Text: '(UTC-10:00) Rarotonga'\n}, {\n  Value: 'Pacific/Tahiti',\n  Text: '(UTC-10:00) Tahiti'\n}, {\n  Value: 'Pacific/Marquesas',\n  Text: '(UTC-09:30) Marquesas'\n}, {\n  Value: 'America/Anchorage',\n  Text: '(UTC-09:00) Alaska Time'\n}, {\n  Value: 'Pacific/Gambier',\n  Text: '(UTC-09:00) Gambier'\n}, {\n  Value: 'America/Los_Angeles',\n  Text: '(UTC-08:00) Pacific Time'\n}, {\n  Value: 'America/Tijuana',\n  Text: '(UTC-08:00) Pacific Time - Tijuana'\n}, {\n  Value: 'America/Vancouver',\n  Text: '(UTC-08:00) Pacific Time - Vancouver'\n}, {\n  Value: 'America/Whitehorse',\n  Text: '(UTC-08:00) Pacific Time - Whitehorse'\n}, {\n  Value: 'Pacific/Pitcairn',\n  Text: '(UTC-08:00) Pitcairn'\n}, {\n  Value: 'America/Denver',\n  Text: '(UTC-07:00) Mountain Time'\n}, {\n  Value: 'America/Phoenix',\n  Text: '(UTC-07:00) Mountain Time - Arizona'\n}, {\n  Value: 'America/Mazatlan',\n  Text: '(UTC-07:00) Mountain Time - Chihuahua, Mazatlan'\n}, {\n  Value: 'America/Dawson_Creek',\n  Text: '(UTC-07:00) Mountain Time - Dawson Creek'\n}, {\n  Value: 'America/Edmonton',\n  Text: '(UTC-07:00) Mountain Time - Edmonton'\n}, {\n  Value: 'America/Hermosillo',\n  Text: '(UTC-07:00) Mountain Time - Hermosillo'\n}, {\n  Value: 'America/Yellowknife',\n  Text: '(UTC-07:00) Mountain Time - Yellowknife'\n}, {\n  Value: 'America/Belize',\n  Text: '(UTC-06:00) Belize'\n}, {\n  Value: 'America/Chicago',\n  Text: '(UTC-06:00) Central Time'\n}, {\n  Value: 'America/Mexico_City',\n  Text: '(UTC-06:00) Central Time - Mexico City'\n}, {\n  Value: 'America/Regina',\n  Text: '(UTC-06:00) Central Time - Regina'\n}, {\n  Value: 'America/Tegucigalpa',\n  Text: '(UTC-06:00) Central Time - Tegucigalpa'\n}, {\n  Value: 'America/Winnipeg',\n  Text: '(UTC-06:00) Central Time - Winnipeg'\n}, {\n  Value: 'America/Costa_Rica',\n  Text: '(UTC-06:00) Costa Rica'\n}, {\n  Value: 'America/El_Salvador',\n  Text: '(UTC-06:00) El Salvador'\n}, {\n  Value: 'Pacific/Galapagos',\n  Text: '(UTC-06:00) Galapagos'\n}, {\n  Value: 'America/Guatemala',\n  Text: '(UTC-06:00) Guatemala'\n}, {\n  Value: 'America/Managua',\n  Text: '(UTC-06:00) Managua'\n}, {\n  Value: 'America/Cancun',\n  Text: '(UTC-05:00) America Cancun'\n}, {\n  Value: 'America/Bogota',\n  Text: '(UTC-05:00) Bogota'\n}, {\n  Value: 'Pacific/Easter',\n  Text: '(UTC-05:00) Easter Island'\n}, {\n  Value: 'America/New_York',\n  Text: '(UTC-05:00) Eastern Time'\n}, {\n  Value: 'America/Iqaluit',\n  Text: '(UTC-05:00) Eastern Time - Iqaluit'\n}, {\n  Value: 'America/Toronto',\n  Text: '(UTC-05:00) Eastern Time - Toronto'\n}, {\n  Value: 'America/Guayaquil',\n  Text: '(UTC-05:00) Guayaquil'\n}, {\n  Value: 'America/Havana',\n  Text: '(UTC-05:00) Havana'\n}, {\n  Value: 'America/Jamaica',\n  Text: '(UTC-05:00) Jamaica'\n}, {\n  Value: 'America/Lima',\n  Text: '(UTC-05:00) Lima'\n}, {\n  Value: 'America/Nassau',\n  Text: '(UTC-05:00) Nassau'\n}, {\n  Value: 'America/Panama',\n  Text: '(UTC-05:00) Panama'\n}, {\n  Value: 'America/Port-au-Prince',\n  Text: '(UTC-05:00) Port-au-Prince'\n}, {\n  Value: 'America/Rio_Branco',\n  Text: '(UTC-05:00) Rio Branco'\n}, {\n  Value: 'America/Halifax',\n  Text: '(UTC-04:00) Atlantic Time - Halifax'\n}, {\n  Value: 'America/Barbados',\n  Text: '(UTC-04:00) Barbados'\n}, {\n  Value: 'Atlantic/Bermuda',\n  Text: '(UTC-04:00) Bermuda'\n}, {\n  Value: 'America/Boa_Vista',\n  Text: '(UTC-04:00) Boa Vista'\n}, {\n  Value: 'America/Caracas',\n  Text: '(UTC-04:00) Caracas'\n}, {\n  Value: 'America/Curacao',\n  Text: '(UTC-04:00) Curacao'\n}, {\n  Value: 'America/Grand_Turk',\n  Text: '(UTC-04:00) Grand Turk'\n}, {\n  Value: 'America/Guyana',\n  Text: '(UTC-04:00) Guyana'\n}, {\n  Value: 'America/La_Paz',\n  Text: '(UTC-04:00) La Paz'\n}, {\n  Value: 'America/Manaus',\n  Text: '(UTC-04:00) Manaus'\n}, {\n  Value: 'America/Martinique',\n  Text: '(UTC-04:00) Martinique'\n}, {\n  Value: 'America/Port_of_Spain',\n  Text: '(UTC-04:00) Port of Spain'\n}, {\n  Value: 'America/Porto_Velho',\n  Text: '(UTC-04:00) Porto Velho'\n}, {\n  Value: 'America/Puerto_Rico',\n  Text: '(UTC-04:00) Puerto Rico'\n}, {\n  Value: 'America/Santo_Domingo',\n  Text: '(UTC-04:00) Santo Domingo'\n}, {\n  Value: 'America/Thule',\n  Text: '(UTC-04:00) Thule'\n}, {\n  Value: 'America/St_Johns',\n  Text: '(UTC-03:30) Newfoundland Time - St. Johns'\n}, {\n  Value: 'America/Araguaina',\n  Text: '(UTC-03:00) Araguaina'\n}, {\n  Value: 'America/Asuncion',\n  Text: '(UTC-03:00) Asuncion'\n}, {\n  Value: 'America/Belem',\n  Text: '(UTC-03:00) Belem'\n}, {\n  Value: 'America/Argentina/Buenos_Aires',\n  Text: '(UTC-03:00) Buenos Aires'\n}, {\n  Value: 'America/Campo_Grande',\n  Text: '(UTC-03:00) Campo Grande'\n}, {\n  Value: 'America/Cayenne',\n  Text: '(UTC-03:00) Cayenne'\n}, {\n  Value: 'America/Cuiaba',\n  Text: '(UTC-03:00) Cuiaba'\n}, {\n  Value: 'America/Fortaleza',\n  Text: '(UTC-03:00) Fortaleza'\n}, {\n  Value: 'America/Godthab',\n  Text: '(UTC-03:00) Godthab'\n}, {\n  Value: 'America/Maceio',\n  Text: '(UTC-03:00) Maceio'\n}, {\n  Value: 'America/Miquelon',\n  Text: '(UTC-03:00) Miquelon'\n}, {\n  Value: 'America/Montevideo',\n  Text: '(UTC-03:00) Montevideo'\n}, {\n  Value: 'Antarctica/Palmer',\n  Text: '(UTC-03:00) Palmer'\n}, {\n  Value: 'America/Paramaribo',\n  Text: '(UTC-03:00) Paramaribo'\n}, {\n  Value: 'America/Punta_Arenas',\n  Text: '(UTC-03:00) Punta Arenas'\n}, {\n  Value: 'America/Recife',\n  Text: '(UTC-03:00) Recife'\n}, {\n  Value: 'Antarctica/Rothera',\n  Text: '(UTC-03:00) Rothera'\n}, {\n  Value: 'America/Bahia',\n  Text: '(UTC-03:00) Salvador'\n}, {\n  Value: 'America/Santiago',\n  Text: '(UTC-03:00) Santiago'\n}, {\n  Value: 'Atlantic/Stanley',\n  Text: '(UTC-03:00) Stanley'\n}, {\n  Value: 'America/Noronha',\n  Text: '(UTC-02:00) Noronha'\n}, {\n  Value: 'America/Sao_Paulo',\n  Text: '(UTC-02:00) Sao Paulo'\n}, {\n  Value: 'Atlantic/South_Georgia',\n  Text: '(UTC-02:00) South Georgia'\n}, {\n  Value: 'Atlantic/Azores',\n  Text: '(UTC-01:00) Azores'\n}, {\n  Value: 'Atlantic/Cape_Verde',\n  Text: '(UTC-01:00) Cape Verde'\n}, {\n  Value: 'America/Scoresbysund',\n  Text: '(UTC-01:00) Scoresbysund'\n}, {\n  Value: 'Africa/Abidjan',\n  Text: '(UTC+00:00) Abidjan'\n}, {\n  Value: 'Africa/Accra',\n  Text: '(UTC+00:00) Accra'\n}, {\n  Value: 'Africa/Bissau',\n  Text: '(UTC+00:00) Bissau'\n}, {\n  Value: 'Atlantic/Canary',\n  Text: '(UTC+00:00) Canary Islands'\n}, {\n  Value: 'Africa/Casablanca',\n  Text: '(UTC+00:00) Casablanca'\n}, {\n  Value: 'America/Danmarkshavn',\n  Text: '(UTC+00:00) Danmarkshavn'\n}, {\n  Value: 'Europe/Dublin',\n  Text: '(UTC+00:00) Dublin'\n}, {\n  Value: 'Africa/El_Aaiun',\n  Text: '(UTC+00:00) El Aaiun'\n}, {\n  Value: 'Atlantic/Faroe',\n  Text: '(UTC+00:00) Faeroe'\n}, {\n  Value: 'Etc/UTC',\n  Text: '(UTC+00:00) UTC (no daylight saving)'\n}, {\n  Value: 'Europe/Lisbon',\n  Text: '(UTC+00:00) Lisbon'\n}, {\n  Value: 'Europe/London',\n  Text: '(UTC+00:00) London'\n}, {\n  Value: 'Africa/Monrovia',\n  Text: '(UTC+00:00) Monrovia'\n}, {\n  Value: 'Atlantic/Reykjavik',\n  Text: '(UTC+00:00) Reykjavik'\n}, {\n  Value: 'UTC',\n  Text: 'UTC'\n}, {\n  Value: 'Africa/Algiers',\n  Text: '(UTC+01:00) Algiers'\n}, {\n  Value: 'Europe/Amsterdam',\n  Text: '(UTC+01:00) Amsterdam'\n}, {\n  Value: 'Europe/Andorra',\n  Text: '(UTC+01:00) Andorra'\n}, {\n  Value: 'Europe/Berlin',\n  Text: '(UTC+01:00) Berlin'\n}, {\n  Value: 'Europe/Brussels',\n  Text: '(UTC+01:00) Brussels'\n}, {\n  Value: 'Europe/Budapest',\n  Text: '(UTC+01:00) Budapest'\n}, {\n  Value: 'Europe/Belgrade',\n  Text: '(UTC+01:00) Central European Time - Belgrade'\n}, {\n  Value: 'Europe/Prague',\n  Text: '(UTC+01:00) Central European Time - Prague'\n}, {\n  Value: 'Africa/Ceuta',\n  Text: '(UTC+01:00) Ceuta'\n}, {\n  Value: 'Europe/Copenhagen',\n  Text: '(UTC+01:00) Copenhagen'\n}, {\n  Value: 'Europe/Gibraltar',\n  Text: '(UTC+01:00) Gibraltar'\n}, {\n  Value: 'Africa/Lagos',\n  Text: '(UTC+01:00) Lagos'\n}, {\n  Value: 'Europe/Luxembourg',\n  Text: '(UTC+01:00) Luxembourg'\n}, {\n  Value: 'Europe/Madrid',\n  Text: '(UTC+01:00) Madrid'\n}, {\n  Value: 'Europe/Malta',\n  Text: '(UTC+01:00) Malta'\n}, {\n  Value: 'Europe/Monaco',\n  Text: '(UTC+01:00) Monaco'\n}, {\n  Value: 'Africa/Ndjamena',\n  Text: '(UTC+01:00) Ndjamena'\n}, {\n  Value: 'Europe/Oslo',\n  Text: '(UTC+01:00) Oslo'\n}, {\n  Value: 'Europe/Paris',\n  Text: '(UTC+01:00) Paris'\n}, {\n  Value: 'Europe/Rome',\n  Text: '(UTC+01:00) Rome'\n}, {\n  Value: 'Europe/Stockholm',\n  Text: '(UTC+01:00) Stockholm'\n}, {\n  Value: 'Europe/Tirane',\n  Text: '(UTC+01:00) Tirane'\n}, {\n  Value: 'Africa/Tunis',\n  Text: '(UTC+01:00) Tunis'\n}, {\n  Value: 'Europe/Vienna',\n  Text: '(UTC+01:00) Vienna'\n}, {\n  Value: 'Europe/Warsaw',\n  Text: '(UTC+01:00) Warsaw'\n}, {\n  Value: 'Europe/Zurich',\n  Text: '(UTC+01:00) Zurich'\n}, {\n  Value: 'Asia/Amman',\n  Text: '(UTC+02:00) Amman'\n}, {\n  Value: 'Europe/Athens',\n  Text: '(UTC+02:00) Athens'\n}, {\n  Value: 'Asia/Beirut',\n  Text: '(UTC+02:00) Beirut'\n}, {\n  Value: 'Europe/Bucharest',\n  Text: '(UTC+02:00) Bucharest'\n}, {\n  Value: 'Africa/Cairo',\n  Text: '(UTC+02:00) Cairo'\n}, {\n  Value: 'Europe/Chisinau',\n  Text: '(UTC+02:00) Chisinau'\n}, {\n  Value: 'Asia/Damascus',\n  Text: '(UTC+02:00) Damascus'\n}, {\n  Value: 'Asia/Gaza',\n  Text: '(UTC+02:00) Gaza'\n}, {\n  Value: 'Europe/Helsinki',\n  Text: '(UTC+02:00) Helsinki'\n}, {\n  Value: 'Asia/Jerusalem',\n  Text: '(UTC+02:00) Jerusalem'\n}, {\n  Value: 'Africa/Johannesburg',\n  Text: '(UTC+02:00) Johannesburg'\n}, {\n  Value: 'Africa/Khartoum',\n  Text: '(UTC+02:00) Khartoum'\n}, {\n  Value: 'Europe/Kiev',\n  Text: '(UTC+02:00) Kiev'\n}, {\n  Value: 'Africa/Maputo',\n  Text: '(UTC+02:00) Maputo'\n}, {\n  Value: 'Europe/Kaliningrad',\n  Text: '(UTC+02:00) Moscow-01 - Kaliningrad'\n}, {\n  Value: 'Asia/Nicosia',\n  Text: '(UTC+02:00) Nicosia'\n}, {\n  Value: 'Europe/Riga',\n  Text: '(UTC+02:00) Riga'\n}, {\n  Value: 'Europe/Sofia',\n  Text: '(UTC+02:00) Sofia'\n}, {\n  Value: 'Europe/Tallinn',\n  Text: '(UTC+02:00) Tallinn'\n}, {\n  Value: 'Africa/Tripoli',\n  Text: '(UTC+02:00) Tripoli'\n}, {\n  Value: 'Europe/Vilnius',\n  Text: '(UTC+02:00) Vilnius'\n}, {\n  Value: 'Africa/Windhoek',\n  Text: '(UTC+02:00) Windhoek'\n}, {\n  Value: 'Asia/Baghdad',\n  Text: '(UTC+03:00) Baghdad'\n}, {\n  Value: 'Europe/Istanbul',\n  Text: '(UTC+03:00) Istanbul'\n}, {\n  Value: 'Europe/Minsk',\n  Text: '(UTC+03:00) Minsk'\n}, {\n  Value: 'Europe/Moscow',\n  Text: '(UTC+03:00) Moscow+00 - Moscow'\n}, {\n  Value: 'Africa/Nairobi',\n  Text: '(UTC+03:00) Nairobi'\n}, {\n  Value: 'Asia/Qatar',\n  Text: '(UTC+03:00) Qatar'\n}, {\n  Value: 'Asia/Riyadh',\n  Text: '(UTC+03:00) Riyadh'\n}, {\n  Value: 'Antarctica/Syowa',\n  Text: '(UTC+03:00) Syowa'\n}, {\n  Value: 'Asia/Tehran',\n  Text: '(UTC+03:30) Tehran'\n}, {\n  Value: 'Asia/Baku',\n  Text: '(UTC+04:00) Baku'\n}, {\n  Value: 'Asia/Dubai',\n  Text: '(UTC+04:00) Dubai'\n}, {\n  Value: 'Indian/Mahe',\n  Text: '(UTC+04:00) Mahe'\n}, {\n  Value: 'Indian/Mauritius',\n  Text: '(UTC+04:00) Mauritius'\n}, {\n  Value: 'Europe/Samara',\n  Text: '(UTC+04:00) Moscow+01 - Samara'\n}, {\n  Value: 'Indian/Reunion',\n  Text: '(UTC+04:00) Reunion'\n}, {\n  Value: 'Asia/Tbilisi',\n  Text: '(UTC+04:00) Tbilisi'\n}, {\n  Value: 'Asia/Yerevan',\n  Text: '(UTC+04:00) Yerevan'\n}, {\n  Value: 'Asia/Kabul',\n  Text: '(UTC+04:30) Kabul'\n}, {\n  Value: 'Asia/Aqtau',\n  Text: '(UTC+05:00) Aqtau'\n}, {\n  Value: 'Asia/Aqtobe',\n  Text: '(UTC+05:00) Aqtobe'\n}, {\n  Value: 'Asia/Ashgabat',\n  Text: '(UTC+05:00) Ashgabat'\n}, {\n  Value: 'Asia/Dushanbe',\n  Text: '(UTC+05:00) Dushanbe'\n}, {\n  Value: 'Asia/Karachi',\n  Text: '(UTC+05:00) Karachi'\n}, {\n  Value: 'Indian/Kerguelen',\n  Text: '(UTC+05:00) Kerguelen'\n}, {\n  Value: 'Indian/Maldives',\n  Text: '(UTC+05:00) Maldives'\n}, {\n  Value: 'Antarctica/Mawson',\n  Text: '(UTC+05:00) Mawson'\n}, {\n  Value: 'Asia/Yekaterinburg',\n  Text: '(UTC+05:00) Moscow+02 - Yekaterinburg'\n}, {\n  Value: 'Asia/Tashkent',\n  Text: '(UTC+05:00) Tashkent'\n}, {\n  Value: 'Asia/Colombo',\n  Text: '(UTC+05:30) Colombo'\n}, {\n  Value: 'Asia/Kolkata',\n  Text: '(UTC+05:30) India Standard Time'\n}, {\n  Value: 'Asia/Katmandu',\n  Text: '(UTC+05:45) Katmandu'\n}, {\n  Value: 'Asia/Almaty',\n  Text: '(UTC+06:00) Almaty'\n}, {\n  Value: 'Asia/Bishkek',\n  Text: '(UTC+06:00) Bishkek'\n}, {\n  Value: 'Indian/Chagos',\n  Text: '(UTC+06:00) Chagos'\n}, {\n  Value: 'Asia/Dhaka',\n  Text: '(UTC+06:00) Dhaka'\n}, {\n  Value: 'Asia/Omsk',\n  Text: '(UTC+06:00) Moscow+03 - Omsk'\n}, {\n  Value: 'Asia/Thimphu',\n  Text: '(UTC+06:00) Thimphu'\n}, {\n  Value: 'Antarctica/Vostok',\n  Text: '(UTC+06:00) Vostok'\n}, {\n  Value: 'Indian/Cocos',\n  Text: '(UTC+06:30) Cocos'\n}, {\n  Value: 'Asia/Yangon',\n  Text: '(UTC+06:30) Rangoon'\n}, {\n  Value: 'Asia/Bangkok',\n  Text: '(UTC+07:00) Bangkok'\n}, {\n  Value: 'Indian/Christmas',\n  Text: '(UTC+07:00) Christmas'\n}, {\n  Value: 'Antarctica/Davis',\n  Text: '(UTC+07:00) Davis'\n}, {\n  Value: 'Asia/Saigon',\n  Text: '(UTC+07:00) Hanoi'\n}, {\n  Value: 'Asia/Hovd',\n  Text: '(UTC+07:00) Hovd'\n}, {\n  Value: 'Asia/Jakarta',\n  Text: '(UTC+07:00) Jakarta'\n}, {\n  Value: 'Asia/Krasnoyarsk',\n  Text: '(UTC+07:00) Moscow+04 - Krasnoyarsk'\n}, {\n  Value: 'Asia/Brunei',\n  Text: '(UTC+08:00) Brunei'\n}, {\n  Value: 'Asia/Shanghai',\n  Text: '(UTC+08:00) China Time - Beijing'\n}, {\n  Value: 'Asia/Choibalsan',\n  Text: '(UTC+08:00) Choibalsan'\n}, {\n  Value: 'Asia/Hong_Kong',\n  Text: '(UTC+08:00) Hong Kong'\n}, {\n  Value: 'Asia/Kuala_Lumpur',\n  Text: '(UTC+08:00) Kuala Lumpur'\n}, {\n  Value: 'Asia/Macau',\n  Text: '(UTC+08:00) Macau'\n}, {\n  Value: 'Asia/Makassar',\n  Text: '(UTC+08:00) Makassar'\n}, {\n  Value: 'Asia/Manila',\n  Text: '(UTC+08:00) Manila'\n}, {\n  Value: 'Asia/Irkutsk',\n  Text: '(UTC+08:00) Moscow+05 - Irkutsk'\n}, {\n  Value: 'Asia/Singapore',\n  Text: '(UTC+08:00) Singapore'\n}, {\n  Value: 'Asia/Taipei',\n  Text: '(UTC+08:00) Taipei'\n}, {\n  Value: 'Asia/Ulaanbaatar',\n  Text: '(UTC+08:00) Ulaanbaatar'\n}, {\n  Value: 'Australia/Perth',\n  Text: '(UTC+08:00) Western Time - Perth'\n}, {\n  Value: 'Asia/Pyongyang',\n  Text: '(UTC+08:30) Pyongyang'\n}, {\n  Value: 'Asia/Dili',\n  Text: '(UTC+09:00) Dili'\n}, {\n  Value: 'Asia/Jayapura',\n  Text: '(UTC+09:00) Jayapura'\n}, {\n  Value: 'Asia/Yakutsk',\n  Text: '(UTC+09:00) Moscow+06 - Yakutsk'\n}, {\n  Value: 'Pacific/Palau',\n  Text: '(UTC+09:00) Palau'\n}, {\n  Value: 'Asia/Seoul',\n  Text: '(UTC+09:00) Seoul'\n}, {\n  Value: 'Asia/Tokyo',\n  Text: '(UTC+09:00) Tokyo'\n}, {\n  Value: 'Australia/Darwin',\n  Text: '(UTC+09:30) Central Time - Darwin'\n}, {\n  Value: 'Antarctica/DumontDUrville',\n  Text: '(UTC+10:00) Dumont D\"Urville'\n}, {\n  Value: 'Australia/Brisbane',\n  Text: '(UTC+10:00) Eastern Time - Brisbane'\n}, {\n  Value: 'Pacific/Guam',\n  Text: '(UTC+10:00) Guam'\n}, {\n  Value: 'Asia/Vladivostok',\n  Text: '(UTC+10:00) Moscow+07 - Vladivostok'\n}, {\n  Value: 'Pacific/Port_Moresby',\n  Text: '(UTC+10:00) Port Moresby'\n}, {\n  Value: 'Pacific / Chuuk',\n  Text: '(UTC+10:00) Truk'\n}, {\n  Value: 'Australia/Adelaide',\n  Text: '(UTC+10:30) Central Time - Adelaide'\n}, {\n  Value: 'Antarctica/Casey',\n  Text: '(UTC+11:00) Casey'\n}, {\n  Value: 'Australia/Hobart',\n  Text: '(UTC+11:00) Eastern Time - Hobart'\n}, {\n  Value: 'Australia/Sydney',\n  Text: '(UTC+11:00) Eastern Time - Melbourne, Sydney'\n}, {\n  Value: 'Pacific/Efate',\n  Text: '(UTC+11:00) Efate'\n}, {\n  Value: 'Pacific/Guadalcanal',\n  Text: '(UTC+11:00) Guadalcanal'\n}, {\n  Value: 'Pacific/Kosrae',\n  Text: '(UTC+11:00) Kosrae'\n}, {\n  Value: 'Asia/Magadan',\n  Text: '(UTC+11:00) Moscow+08 - Magadan'\n}, {\n  Value: 'Pacific / Norfolk',\n  Text: '(UTC+11:00) Norfolk'\n}, {\n  Value: 'Pacific/Noumea',\n  Text: '(UTC+11:00) Noumea'\n}, {\n  Value: 'Pacific/Pohnpei',\n  Text: '(UTC+11:00) Ponape'\n}, {\n  Value: 'Pacific/Funafuti',\n  Text: '(UTC+12:00) Funafuti'\n}, {\n  Value: 'Pacific/Kwajalein',\n  Text: '(UTC+12:00) Kwajalein'\n}, {\n  Value: 'Pacific/Majuro',\n  Text: '(UTC+12:00) Majuro'\n}, {\n  Value: 'Asia/Kamchatka',\n  Text: '(UTC+12:00) Moscow+09 - Petropavlovsk - Kamchatskiy'\n}, {\n  Value: 'Pacific / Nauru',\n  Text: '(UTC+12:00) Nauru'\n}, {\n  Value: 'Pacific/Tarawa',\n  Text: '(UTC+12:00) Tarawa'\n}, {\n  Value: 'Pacific/Wake',\n  Text: '(UTC+12:00) Wake'\n}, {\n  Value: 'Pacific/Wallis',\n  Text: '(UTC+12:00) Wallis'\n}, {\n  Value: 'Pacific/Auckland',\n  Text: '(UTC+13:00) Auckland'\n}, {\n  Value: 'Pacific/Enderbury',\n  Text: '(UTC+13:00) Enderbury'\n}, {\n  Value: 'Pacific/Fakaofo',\n  Text: '(UTC+13:00) Fakaofo'\n}, {\n  Value: 'Pacific/Fiji',\n  Text: '(UTC+13:00) Fiji'\n}, {\n  Value: 'Pacific/Tongatapu',\n  Text: '(UTC+13:00) Tongatapu'\n}, {\n  Value: 'Pacific/Apia',\n  Text: '(UTC+14:00) Apia'\n}, {\n  Value: 'Pacific/Kiritimati',\n  Text: '(UTC+14:00) Kiritimati'\n}];\n/* eslint-disable max-len */\n\n/**\n * Date Generator from Recurrence Rule\n */\n\n/**\n * Generate Summary from Recurrence Rule\n *\n * @param {string} rule Accepts the Recurrence rule\n * @param {L10n} localeObject Accepts the locale object\n * @param {string} locale Accepts the locale name\n * @param {CalendarType} calendarType Accepts the calendar type\n * @returns {string} Returns the summary string from given recurrence rule\n */\n\nfunction generateSummary(rule, localeObject, locale, calendarType = 'Gregorian') {\n  const ruleObject = extractObjectFromRule(rule);\n  let summary = localeObject.getConstant(EVERY) + ' ';\n  let cldrObj;\n  let cldrObj1;\n  const calendarMode = calendarType.toLowerCase();\n\n  if (locale === 'en' || locale === 'en-US') {\n    const nameSpace1 = 'months.stand-alone.abbreviated';\n    const nameSpace = 'days.stand-alone.abbreviated';\n    cldrObj1 = getValue(nameSpace1, getDefaultDateObject(calendarMode));\n    cldrObj = getValue(nameSpace, getDefaultDateObject(calendarMode));\n  } else {\n    const nameSpace1 = 'main.' + locale + '.dates.calendars.' + calendarMode + '.months.stand-alone.abbreviated';\n    const nameSpace = 'main.' + locale + '.dates.calendars.' + calendarMode + '.days.stand-alone.abbreviated';\n    cldrObj1 = getValue(nameSpace1, cldrData);\n    cldrObj = getValue(nameSpace, cldrData);\n  }\n\n  if (ruleObject.interval > 1) {\n    summary += ruleObject.interval + ' ';\n  }\n\n  switch (ruleObject.freq) {\n    case 'DAILY':\n      summary += localeObject.getConstant(DAYS);\n      break;\n\n    case 'WEEKLY':\n      summary += localeObject.getConstant(WEEKS) + ' ' + localeObject.getConstant(ON) + ' ';\n      ruleObject.day.forEach((day, index) => {\n        summary += capitalizeFirstWord(getValue(DAYINDEXOBJECT[day], cldrObj), 'single');\n        summary += ruleObject.day.length - 1 === index ? '' : ', ';\n      });\n      break;\n\n    case 'MONTHLY':\n      summary += localeObject.getConstant(MONTHS) + ' ' + localeObject.getConstant(ON) + ' ';\n      summary += getMonthSummary(ruleObject, cldrObj, localeObject);\n      break;\n\n    case 'YEARLY':\n      summary += localeObject.getConstant(YEARS) + ' ' + localeObject.getConstant(ON) + ' ';\n      summary += capitalizeFirstWord(getValue(ruleObject.month[0].toString(), cldrObj1), 'single') + ' ';\n      summary += getMonthSummary(ruleObject, cldrObj, localeObject);\n      break;\n  }\n\n  if (ruleObject.count) {\n    summary += ', ' + ruleObject.count + ' ' + localeObject.getConstant(TIMES);\n  } else if (ruleObject.until) {\n    const tempDate = ruleObject.until;\n    summary += ', ' + localeObject.getConstant(UNTIL) + ' ' + tempDate.getDate() + ' ' + capitalizeFirstWord(getValue((tempDate.getMonth() + 1).toString(), cldrObj1), 'single') + ' ' + tempDate.getFullYear();\n  }\n\n  return summary;\n}\n/**\n * Generates Month summary\n *\n * @param {RecRule} ruleObject Accepts the recurrence rule object\n * @param {string[]} cldrObj Accepts the collections of month name from calendar\n * @param {L10n} localeObj Accepts the locale object\n * @returns {string} Returns the month summary string from given recurrence rule object\n * @private\n */\n\n\nfunction getMonthSummary(ruleObject, cldrObj, localeObj) {\n  let summary = '';\n\n  if (ruleObject.monthDay.length) {\n    summary += ruleObject.monthDay[0];\n  } else if (ruleObject.day) {\n    const pos = ruleObject.setPosition - 1;\n    summary += localeObj.getConstant(WEEKPOS[pos > -1 ? pos : WEEKPOS.length - 1]) + ' ' + capitalizeFirstWord(getValue(DAYINDEXOBJECT[ruleObject.day[0]], cldrObj), 'single');\n  }\n\n  return summary;\n}\n/**\n * Generates the date collections from the given recurrence rule\n *\n * @param {Date} startDate Accepts the rule start date\n * @param {string} rule Accepts the recurrence rule\n * @param {string} excludeDate Accepts the exception dates in string format\n * @param {number} startDayOfWeek Accepts the start day index of week\n * @param {number} maximumCount Accepts the maximum number count to generate date collections\n * @param {Date} viewDate Accepts the current date instead of start date\n * @param {CalendarType} calendarMode Accepts the calendar type\n * @param {string} oldTimezone Accepts the timezone name\n * @param {string} newTimezone Accepts the timezone name\n * @returns {number[]} Returns the collection of dates\n */\n\n\nfunction generate(startDate, rule, excludeDate, startDayOfWeek, maximumCount = MAXOCCURRENCE, viewDate = null, calendarMode = 'Gregorian', oldTimezone = null, newTimezone = null) {\n  const ruleObject = extractObjectFromRule(rule);\n  let cacheDate;\n  calendarUtil = getCalendarUtil(calendarMode);\n  const data = [];\n  const modifiedDate = new Date(startDate.getTime());\n  tempExcludeDate = [];\n  const tempDate = isNullOrUndefined(excludeDate) ? [] : excludeDate.split(',');\n  const tz = new Timezone();\n  tempDate.forEach(content => {\n    let parsedDate = getDateFromRecurrenceDateString(content);\n\n    if (oldTimezone && newTimezone) {\n      parsedDate = tz.convert(new Date(parsedDate.getTime()), oldTimezone, newTimezone);\n    }\n\n    tempExcludeDate.push(new Date(parsedDate.getTime()).setHours(0, 0, 0, 0));\n  });\n  ruleObject.recExceptionCount = !isNullOrUndefined(ruleObject.count) ? tempExcludeDate.length : 0;\n\n  if (viewDate && viewDate > startDate && !ruleObject.count) {\n    tempViewDate = new Date(new Date(viewDate.getTime()).setHours(0, 0, 0));\n  } else {\n    tempViewDate = null;\n  }\n\n  if (!ruleObject.until && tempViewDate) {\n    cacheDate = new Date(tempViewDate.getTime());\n    cacheDate.setDate(tempViewDate.getDate() + maximumCount * ruleObject.interval);\n    ruleObject.until = cacheDate;\n  }\n\n  if (ruleObject.until && startDate > ruleObject.until) {\n    return data;\n  }\n\n  maxOccurrence = maximumCount;\n  setFirstDayOfWeek(DAYINDEX[startDayOfWeek]);\n\n  if (ruleObject.until) {\n    const end = resetTime(ruleObject.until);\n    ruleObject.until = new Date(end.getFullYear(), end.getMonth(), end.getDate(), 23, 59, 59);\n  }\n\n  switch (ruleObject.freq) {\n    case 'DAILY':\n      dailyType(modifiedDate, ruleObject.until, data, ruleObject);\n      break;\n\n    case 'WEEKLY':\n      weeklyType(modifiedDate, ruleObject.until, data, ruleObject);\n      break;\n\n    case 'MONTHLY':\n      monthlyType(modifiedDate, ruleObject.until, data, ruleObject);\n      break;\n\n    case 'YEARLY':\n      yearlyType(modifiedDate, ruleObject.until, data, ruleObject);\n  }\n\n  return data;\n}\n/**\n * Generate date object from given date string\n *\n * @param {string} recDateString Accepts the exception date as string\n * @returns {Date} Returns the date from exception date string\n */\n\n\nfunction getDateFromRecurrenceDateString(recDateString) {\n  return new Date(recDateString.substr(0, 4) + '-' + recDateString.substr(4, 2) + '-' + recDateString.substr(6, 5) + ':' + recDateString.substr(11, 2) + ':' + recDateString.substr(13));\n}\n/**\n * Internal method to handle exclude date\n *\n * @param {number[]} data Accepts the exception date collections\n * @param {number} date Accepts the new exclude date\n * @returns {void}\n * @private\n */\n\n\nfunction excludeDateHandler(data, date) {\n  const zeroIndex = new Date(date).setHours(0, 0, 0, 0);\n\n  if (tempExcludeDate.indexOf(zeroIndex) === -1 && (!tempViewDate || zeroIndex >= tempViewDate.getTime())) {\n    data.push(date);\n  }\n}\n/**\n * Internal method for get date count\n *\n * @param {Date} startDate Accepts the date\n * @param {RecRule} ruleObject Accepts the recurrence rule object\n * @returns {number} Returns the number of date count\n * @private\n */\n\n\nfunction getDateCount$1(startDate, ruleObject) {\n  let count = maxOccurrence;\n\n  if (ruleObject.count) {\n    count = ruleObject.count;\n  } else if (ruleObject.until) {\n    if (ruleObject.freq === 'DAILY' || ruleObject.freq === 'WEEKLY') {\n      count = Math.floor((ruleObject.until.getTime() - startDate.getTime()) / MS_PER_DAY) + 1;\n    } else if (ruleObject.freq === 'MONTHLY' || ruleObject.freq === 'YEARLY') {\n      count = Math.floor((ruleObject.until.getMonth() + 12 * ruleObject.until.getFullYear() - (startDate.getMonth() + 12 * startDate.getFullYear())) / ruleObject.interval) + (ruleObject.day.length > 1 ? Math.floor((ruleObject.until.getTime() - startDate.getTime()) / MS_PER_DAY) + 1 : 1);\n\n      if (ruleObject.freq === 'YEARLY') {\n        count = ruleObject.month.length > 1 ? count * ruleObject.month.length : count;\n      }\n    }\n  }\n\n  return count;\n}\n/**\n *  Internal method for daily type recurrence rule\n *\n * @param {Date} startDate Accepts the strat date\n * @param {Date} endDate Accepts the end date\n * @param {number[]} data Accepts the collection of dates\n * @param {RecRule} ruleObject Accepts the recurrence rule object\n * @returns {void}\n * @private\n */\n\n\nfunction dailyType(startDate, endDate, data, ruleObject) {\n  const tempDate = new Date(startDate.getTime());\n  const interval = ruleObject.interval;\n  const expectedCount = getDateCount$1(startDate, ruleObject);\n  let state;\n  const expectedDays = ruleObject.day;\n\n  while (compareDates(tempDate, endDate)) {\n    state = true;\n    state = validateRules(tempDate, ruleObject);\n\n    if (state && (expectedDays.indexOf(DAYINDEX[tempDate.getDay()]) > -1 || expectedDays.length === 0)) {\n      excludeDateHandler(data, tempDate.getTime());\n\n      if (expectedCount && data.length + ruleObject.recExceptionCount >= expectedCount) {\n        break;\n      }\n    }\n\n    tempDate.setDate(tempDate.getDate() + interval);\n\n    if (tempDate.getHours() !== startDate.getHours()) {\n      tempDate.setHours(startDate.getHours());\n    }\n  }\n}\n/**\n * Internal method for weekly type recurrence rule\n *\n * @param {Date} startDate Accepts the strat date\n * @param {Date} endDate Accepts the end date\n * @param {number[]} data Accepts the collection of dates\n * @param {RecRule} ruleObject Accepts the recurrence rule object\n * @returns {void}\n * @private\n */\n\n\nfunction weeklyType(startDate, endDate, data, ruleObject) {\n  let tempDate = new Date(startDate.getTime());\n\n  if (!ruleObject.day.length) {\n    ruleObject.day.push(DAYINDEX[startDate.getDay()]);\n  }\n\n  const interval = ruleObject.interval;\n  const expectedDays = ruleObject.day;\n  const expectedCount = getDateCount$1(startDate, ruleObject);\n  let weekState = true;\n  let wkstIndex;\n  let weekCollection = [];\n\n  if (expectedDays.length > 1) {\n    if (isNullOrUndefined(ruleObject.wkst) || ruleObject.wkst === '') {\n      ruleObject.wkst = dayIndex[0];\n    }\n\n    wkstIndex = DAYINDEX.indexOf(ruleObject.wkst);\n\n    while (compareDates(tempDate, endDate)) {\n      let startDateDiff = DAYINDEX.indexOf(DAYINDEX[tempDate.getDay()]) - wkstIndex;\n      startDateDiff = startDateDiff === -1 ? 6 : startDateDiff;\n      const weekstartDate = addDays(tempDate, -startDateDiff);\n      let weekendDate = addDays(weekstartDate, 6);\n      let compareTempDate = new Date(tempDate.getTime());\n      weekendDate = resetTime(weekendDate);\n      compareTempDate = resetTime(compareTempDate);\n\n      while (weekendDate >= compareTempDate) {\n        if (expectedDays.indexOf(DAYINDEX[tempDate.getDay()]) > -1) {\n          weekCollection.push([tempDate.getTime()]);\n        }\n\n        if (expectedCount && data.length + ruleObject.recExceptionCount >= expectedCount) {\n          break;\n        }\n\n        tempDate.setDate(tempDate.getDate() + 1);\n\n        if (tempDate.getHours() !== startDate.getHours()) {\n          tempDate.setHours(startDate.getHours());\n        }\n\n        compareTempDate = new Date(tempDate.getTime());\n        compareTempDate = resetTime(compareTempDate);\n      }\n\n      tempDate.setDate(tempDate.getDate() - 1);\n\n      if (expectedCount && data.length + ruleObject.recExceptionCount >= expectedCount) {\n        break;\n      }\n\n      tempDate.setDate(tempDate.getDate() + 1 + (interval - 1) * 7);\n      insertDataCollection(weekCollection, weekState, startDate, endDate, data, ruleObject);\n      weekCollection = [];\n    }\n  } else {\n    tempDate = getStartDateForWeek(startDate, ruleObject.day);\n\n    while (compareDates(tempDate, endDate)) {\n      weekState = validateRules(tempDate, ruleObject);\n\n      if (weekState && expectedDays.indexOf(DAYINDEX[tempDate.getDay()]) > -1) {\n        excludeDateHandler(data, tempDate.getTime());\n      }\n\n      if (expectedCount && data.length + ruleObject.recExceptionCount >= expectedCount) {\n        break;\n      }\n\n      tempDate.setDate(tempDate.getDate() + interval * 7);\n    }\n\n    insertDataCollection(weekCollection, weekState, startDate, endDate, data, ruleObject);\n    weekCollection = [];\n  }\n}\n/**\n *  Internal method for monthly type recurrence rule\n *\n * @param {Date} startDate Accepts the strat date\n * @param {Date} endDate Accepts the end date\n * @param {number[]} data Accepts the collection of dates\n * @param {RecRule} ruleObject Accepts the recurrence rule object\n * @returns {void}\n * @private\n */\n\n\nfunction monthlyType(startDate, endDate, data, ruleObject) {\n  // Set monthday value if BYDAY, BYMONTH and Month day property is not set based on start date\n  if (!ruleObject.month.length && !ruleObject.day.length && !ruleObject.monthDay.length) {\n    ruleObject.monthDay.push(startDate.getDate());\n\n    if (ruleObject.freq === 'YEARLY') {\n      ruleObject.month.push(startDate.getMonth() + 1);\n    }\n  } else if (ruleObject.month.length > 0 && !ruleObject.day.length && !ruleObject.monthDay.length) {\n    ruleObject.monthDay.push(startDate.getDate());\n  }\n\n  const ruleType = validateMonthlyRuleType(ruleObject);\n\n  switch (ruleType) {\n    case 'day':\n      switch (ruleObject.freq) {\n        case 'MONTHLY':\n          monthlyDayTypeProcessforMonthFreq(startDate, endDate, data, ruleObject);\n          break;\n\n        case 'YEARLY':\n          monthlyDayTypeProcess(startDate, endDate, data, ruleObject);\n          break;\n      }\n\n      break;\n\n    case 'both':\n    case 'date':\n      switch (ruleObject.freq) {\n        case 'MONTHLY':\n          monthlyDateTypeProcessforMonthFreq(startDate, endDate, data, ruleObject);\n          break;\n\n        case 'YEARLY':\n          monthlyDateTypeProcess(startDate, endDate, data, ruleObject);\n          break;\n      }\n\n      break;\n  }\n}\n/**\n * Internal method for yearly type recurrence rule\n *\n * @param {Date} startDate Accepts the strat date\n * @param {Date} endDate Accepts the end date\n * @param {number[]} data Accepts the collection of dates\n * @param {RecRule} ruleObject Accepts the recurrence rule object\n * @returns {void}\n * @private\n */\n\n\nfunction yearlyType(startDate, endDate, data, ruleObject) {\n  const typeValue = checkYearlyType(ruleObject);\n\n  switch (typeValue) {\n    case 'MONTH':\n      monthlyType(startDate, endDate, data, ruleObject);\n      break;\n\n    case 'WEEKNO':\n      processWeekNo(startDate, endDate, data, ruleObject);\n      break;\n\n    case 'YEARDAY':\n      processYearDay(startDate, endDate, data, ruleObject);\n      break;\n  }\n}\n/**\n * Internal method for process week no\n *\n * @param {Date} startDate Accepts the strat date\n * @param {Date} endDate Accepts the end date\n * @param {number[]} data Accepts the collection of dates\n * @param {RecRule} ruleObject Accepts the recurrence rule object\n * @returns {void}\n * @private\n */\n\n\nfunction processWeekNo(startDate, endDate, data, ruleObject) {\n  let stDate = calendarUtil.getYearLastDate(startDate, 0);\n  let tempDate;\n  const expectedCount = getDateCount$1(startDate, ruleObject);\n  let state;\n  let startDay;\n  let firstWeekSpan;\n  const weekNos = ruleObject.weekNo;\n  let weekNo;\n  let maxDate;\n  let minDate;\n  let weekCollection = [];\n  const expectedDays = ruleObject.day;\n\n  while (compareDates(stDate, endDate)) {\n    startDay = dayIndex.indexOf(DAYINDEX[stDate.getDay()]);\n    firstWeekSpan = 6 - startDay + 1;\n\n    for (let index = 0; index < weekNos.length; index++) {\n      weekNo = weekNos[index];\n      weekNo = weekNo > 0 ? weekNo : 53 + weekNo + 1;\n      maxDate = weekNo === 1 ? firstWeekSpan : firstWeekSpan + (weekNo - 1) * 7;\n      minDate = weekNo === 1 ? firstWeekSpan - 7 : firstWeekSpan + (weekNo - 2) * 7;\n\n      while (minDate < maxDate) {\n        tempDate = new Date(stDate.getTime() + MS_PER_DAY * minDate);\n\n        if (expectedDays.length === 0 || expectedDays.indexOf(DAYINDEX[tempDate.getDay()]) > -1) {\n          if (isNullOrUndefined(ruleObject.setPosition)) {\n            insertDateCollection(state, startDate, endDate, data, ruleObject, tempDate.getTime());\n          } else {\n            weekCollection.push([tempDate.getTime()]);\n          }\n        }\n\n        minDate++;\n      }\n    }\n\n    if (!isNullOrUndefined(ruleObject.setPosition)) {\n      insertDatasIntoExistingCollection(weekCollection, state, startDate, endDate, data, ruleObject);\n    }\n\n    if (expectedCount && data.length + ruleObject.recExceptionCount >= expectedCount) {\n      return;\n    }\n\n    stDate = calendarUtil.getYearLastDate(tempDate, ruleObject.interval);\n    weekCollection = [];\n  }\n}\n/**\n * Internal method for process year day\n *\n * @param {Date} startDate Accepts the strat date\n * @param {Date} endDate Accepts the end date\n * @param {number[]} data Accepts the collection of dates\n * @param {RecRule} ruleObject Accepts the recurrence rule object\n * @returns {void}\n * @private\n */\n\n\nfunction processYearDay(startDate, endDate, data, ruleObject) {\n  let stDate = calendarUtil.getYearLastDate(startDate, 0);\n  let tempDate;\n  const expectedCount = getDateCount$1(startDate, ruleObject);\n  let state;\n  let dateCollection = [];\n  let date;\n  const expectedDays = ruleObject.day;\n\n  while (compareDates(stDate, endDate)) {\n    for (let index = 0; index < ruleObject.yearDay.length; index++) {\n      date = ruleObject.yearDay[index];\n      tempDate = new Date(stDate.getTime());\n\n      if ((date === calendarUtil.getLeapYearDaysCount() || date === -calendarUtil.getLeapYearDaysCount()) && !calendarUtil.isLeapYear(calendarUtil.getFullYear(tempDate), 1)) {\n        tempDate.setDate(tempDate.getDate() + 1);\n        continue;\n      }\n\n      tempDate.setDate(tempDate.getDate() + (date < 0 ? calendarUtil.getYearDaysCount(tempDate, 1) + 1 + date : date));\n\n      if (expectedDays.length === 0 || expectedDays.indexOf(DAYINDEX[tempDate.getDay()]) > -1) {\n        if (ruleObject.setPosition == null) {\n          insertDateCollection(state, startDate, endDate, data, ruleObject, tempDate.getTime());\n        } else {\n          dateCollection.push([tempDate.getTime()]);\n        }\n      }\n    }\n\n    if (!isNullOrUndefined(ruleObject.setPosition)) {\n      insertDatasIntoExistingCollection(dateCollection, state, startDate, endDate, data, ruleObject);\n    }\n\n    if (expectedCount && data.length + ruleObject.recExceptionCount >= expectedCount) {\n      return;\n    }\n\n    stDate = calendarUtil.getYearLastDate(tempDate, ruleObject.interval);\n    dateCollection = [];\n  }\n}\n/**\n * Internal method to check yearly type\n *\n * @param {RecRule} ruleObject Accepts the recurrence rule object\n * @returns {YearRuleType} Returns the Yearly rule type object\n * @private\n */\n\n\nfunction checkYearlyType(ruleObject) {\n  if (ruleObject.yearDay.length) {\n    return 'YEARDAY';\n  } else if (ruleObject.weekNo.length) {\n    return 'WEEKNO';\n  }\n\n  return 'MONTH';\n}\n/**\n * Internal method to initialize recurrence rule variables\n *\n * @param {Date} startDate Accepts the start date\n * @param {RecRule} ruleObject Accepts the recurrence rule object\n * @returns {RuleData} Return the rule data object\n * @private\n */\n\n\nfunction initializeRecRuleVariables(startDate, ruleObject) {\n  const ruleData = {\n    monthCollection: [],\n    index: 0,\n    tempDate: new Date(startDate.getTime()),\n    mainDate: new Date(startDate.getTime()),\n    expectedCount: getDateCount$1(startDate, ruleObject),\n    monthInit: 0,\n    dateCollection: []\n  };\n\n  if (ruleObject.month.length) {\n    calendarUtil.setMonth(ruleData.tempDate, ruleObject.month[0], ruleData.tempDate.getDate());\n  }\n\n  return ruleData;\n}\n/**\n * Internal method for process monthly date type recurrence rule\n *\n * @param {Date} startDate Accepts the strat date\n * @param {Date} endDate Accepts the end date\n * @param {number[]} data Accepts the collection of dates\n * @param {RecRule} ruleObject Accepts the recurrence rule object\n * @returns {void}\n * @private\n */\n\n\nfunction monthlyDateTypeProcess(startDate, endDate, data, ruleObject) {\n  if (ruleObject.month.length) {\n    monthlyDateTypeProcessforMonthFreq(startDate, endDate, data, ruleObject);\n    return;\n  }\n\n  const ruleData = initializeRecRuleVariables(startDate, ruleObject);\n  let currentMonthDate;\n  ruleData.tempDate = ruleData.mainDate = calendarUtil.getMonthStartDate(ruleData.tempDate);\n\n  while (compareDates(ruleData.tempDate, endDate)) {\n    currentMonthDate = new Date(ruleData.tempDate.getTime());\n\n    while (calendarUtil.isSameYear(currentMonthDate, ruleData.tempDate) && ruleData.expectedCount && data.length + ruleObject.recExceptionCount <= ruleData.expectedCount) {\n      if (ruleObject.month.length === 0 || ruleObject.month.length > 0 && !calendarUtil.checkMonth(ruleData.tempDate, ruleObject.month)) {\n        processDateCollectionForByMonthDay(ruleObject, ruleData, endDate, false);\n        ruleData.beginDate = new Date(ruleData.tempDate.getTime());\n        ruleData.monthInit = setNextValidDate(ruleData.tempDate, ruleObject, ruleData.monthInit, ruleData.beginDate);\n      } else {\n        calendarUtil.setValidDate(ruleData.tempDate, 1, 1);\n        ruleData.tempDate = getStartDateForWeek(ruleData.tempDate, ruleObject.day);\n        break;\n      }\n    }\n\n    ruleData.tempDate.setFullYear(currentMonthDate.getFullYear(), currentMonthDate.getMonth(), currentMonthDate.getDate());\n    insertDataCollection(ruleData.dateCollection, ruleData.state, startDate, endDate, data, ruleObject);\n\n    if (calendarUtil.isLastMonth(ruleData.tempDate)) {\n      calendarUtil.setValidDate(ruleData.tempDate, 1, 1);\n      ruleData.tempDate = getStartDateForWeek(ruleData.tempDate, ruleObject.day);\n    }\n\n    if (ruleData.expectedCount && data.length + ruleObject.recExceptionCount >= ruleData.expectedCount) {\n      return;\n    }\n\n    ruleData.tempDate.setFullYear(ruleData.tempDate.getFullYear() + ruleObject.interval - 1);\n    ruleData.tempDate = getStartDateForWeek(ruleData.tempDate, ruleObject.day);\n    ruleData.monthInit = setNextValidDate(ruleData.tempDate, ruleObject, ruleData.monthInit, ruleData.beginDate);\n    ruleData.dateCollection = [];\n  }\n}\n/**\n * Internal method for process monthly date type with month frequency from recurrence rule\n *\n * @param {Date} startDate Accepts the strat date\n * @param {Date} endDate Accepts the end date\n * @param {number[]} data Accepts the collection of dates\n * @param {RecRule} ruleObject Accepts the recurrence rule object\n * @returns {void}\n * @private\n */\n\n\nfunction monthlyDateTypeProcessforMonthFreq(startDate, endDate, data, ruleObject) {\n  const ruleData = initializeRecRuleVariables(startDate, ruleObject);\n  ruleData.tempDate = ruleData.mainDate = calendarUtil.getMonthStartDate(ruleData.tempDate);\n\n  if ((ruleObject.freq === 'MONTHLY' && ruleObject.interval === 12 || ruleObject.freq === 'YEARLY') && calendarUtil.getMonthDaysCount(startDate) < ruleObject.monthDay[0]) {\n    return;\n  }\n\n  while (compareDates(ruleData.tempDate, endDate)) {\n    ruleData.beginDate = new Date(ruleData.tempDate.getTime());\n    processDateCollectionForByMonthDay(ruleObject, ruleData, endDate, true, startDate, data);\n\n    if (!isNullOrUndefined(ruleObject.setPosition)) {\n      insertDatasIntoExistingCollection(ruleData.dateCollection, ruleData.state, startDate, endDate, data, ruleObject);\n    }\n\n    if (ruleData.expectedCount && data.length + ruleObject.recExceptionCount >= ruleData.expectedCount) {\n      return;\n    }\n\n    ruleData.monthInit = setNextValidDate(ruleData.tempDate, ruleObject, ruleData.monthInit, ruleData.beginDate);\n    ruleData.dateCollection = [];\n  }\n}\n/**\n * To process date collection for Monthly & Yearly based on BYMONTH Day property\n *\n * @param {RecRule} ruleObject Accepts the recurrence rule object\n * @param {RuleData} recRuleVariables Accepts the rule data\n * @param {Date} endDate Accepts the end date\n * @param {boolean} isByMonth Accepts the boolean to validate either month or not\n * @param {Date} startDate Accepts the start date\n * @param {number[]} data Accepts the collection of dates\n * @returns {void}\n * @private\n */\n\n\nfunction processDateCollectionForByMonthDay(ruleObject, recRuleVariables, endDate, isByMonth, startDate, data) {\n  for (let index = 0; index < ruleObject.monthDay.length; index++) {\n    recRuleVariables.date = ruleObject.monthDay[index];\n    recRuleVariables.tempDate = calendarUtil.getMonthStartDate(recRuleVariables.tempDate);\n    const maxDate = calendarUtil.getMonthDaysCount(recRuleVariables.tempDate);\n    recRuleVariables.date = recRuleVariables.date > 0 ? recRuleVariables.date : maxDate + recRuleVariables.date + 1;\n\n    if (validateProperDate(recRuleVariables.tempDate, recRuleVariables.date, recRuleVariables.mainDate) && recRuleVariables.date > 0) {\n      calendarUtil.setDate(recRuleVariables.tempDate, recRuleVariables.date);\n\n      if (endDate && recRuleVariables.tempDate > endDate) {\n        return;\n      }\n\n      if (ruleObject.day.length === 0 || ruleObject.day.indexOf(DAYINDEX[recRuleVariables.tempDate.getDay()]) > -1) {\n        if (isByMonth && isNullOrUndefined(ruleObject.setPosition) && recRuleVariables.expectedCount && data.length + ruleObject.recExceptionCount < recRuleVariables.expectedCount) {\n          insertDateCollection(recRuleVariables.state, startDate, endDate, data, ruleObject, recRuleVariables.tempDate.getTime());\n        } else {\n          recRuleVariables.dateCollection.push([recRuleVariables.tempDate.getTime()]);\n        }\n      }\n    }\n  }\n}\n/**\n * Internal method to set next valid date\n *\n * @param {Date} tempDate Accepts the date\n * @param {RecRule} ruleObject Accepts the recurrence rule object\n * @param {number} monthInit Accepts the initial month\n * @param {Date} beginDate Accepts the initial date\n * @param {number} interval Accepts the interval duration\n * @returns {number} Returnx the next valid date\n * @private\n */\n\n\nfunction setNextValidDate(tempDate, ruleObject, monthInit, beginDate = null, interval) {\n  let monthData = beginDate ? beginDate.getMonth() : 0;\n  const startDate = calendarUtil.getMonthStartDate(tempDate);\n  interval = isNullOrUndefined(interval) ? ruleObject.interval : interval;\n  tempDate.setFullYear(startDate.getFullYear());\n  tempDate.setMonth(startDate.getMonth());\n  tempDate.setDate(startDate.getDate());\n\n  if (ruleObject.month.length) {\n    monthInit++;\n    monthInit = monthInit % ruleObject.month.length;\n    calendarUtil.setMonth(tempDate, ruleObject.month[monthInit], 1);\n\n    if (monthInit === 0) {\n      calendarUtil.addYears(tempDate, interval, ruleObject.month[0]);\n    }\n  } else {\n    if (beginDate && beginDate.getFullYear() < tempDate.getFullYear()) {\n      monthData = tempDate.getMonth() - 1;\n    }\n\n    calendarUtil.setValidDate(tempDate, interval, 1, monthData, beginDate);\n  }\n\n  return monthInit;\n}\n/**\n * To get month collection when BYDAY property having more than one value in list.\n *\n * @param {Date} startDate Accepts the strat date\n * @param {Date} endDate Accepts the end date\n * @param {number[]} data Accepts the collection of dates\n * @param {RecRule} ruleObject Accepts the recurrence rule object\n * @returns {void}\n * @private\n */\n\n\nfunction getMonthCollection(startDate, endDate, data, ruleObject) {\n  const expectedDays = ruleObject.day;\n  let tempDate = new Date(startDate.getTime());\n  tempDate = calendarUtil.getMonthStartDate(tempDate);\n  let monthCollection = [];\n  let dateCollection = [];\n  let dates = [];\n  let index;\n  let state;\n  const expectedCount = getDateCount$1(startDate, ruleObject);\n  let monthInit = 0;\n  let beginDate;\n\n  if (ruleObject.month.length) {\n    calendarUtil.setMonth(tempDate, ruleObject.month[0], 1);\n  }\n\n  tempDate = getStartDateForWeek(tempDate, ruleObject.day);\n\n  while (compareDates(tempDate, endDate) && expectedCount && data.length + ruleObject.recExceptionCount < expectedCount) {\n    const currentMonthDate = new Date(tempDate.getTime());\n    const isHavingNumber = expectedDays.map(item => HASNUMBER.test(item));\n\n    if (isHavingNumber.indexOf(true) > -1) {\n      for (let j = 0; j <= expectedDays.length - 1; j++) {\n        const expectedDaysArray = expectedDays[j].match(SPLITNUMBERANDSTRING);\n        const position = parseInt(expectedDaysArray[0], 10);\n        tempDate = new Date(tempDate.getTime());\n        tempDate = calendarUtil.getMonthStartDate(tempDate);\n        tempDate = getStartDateForWeek(tempDate, expectedDays);\n        currentMonthDate.setFullYear(tempDate.getFullYear(), tempDate.getMonth(), tempDate.getDate());\n\n        while (calendarUtil.isSameYear(currentMonthDate, tempDate) && calendarUtil.isSameMonth(currentMonthDate, tempDate)) {\n          if (expectedDaysArray[expectedDaysArray.length - 1] === DAYINDEX[currentMonthDate.getDay()]) {\n            monthCollection.push([currentMonthDate.getTime()]);\n          }\n\n          currentMonthDate.setDate(currentMonthDate.getDate() + 1);\n        }\n\n        currentMonthDate.setDate(currentMonthDate.getDate() - 1);\n\n        if (expectedDaysArray[0].indexOf('-') > -1) {\n          index = monthCollection.length - -1 * position;\n        } else {\n          index = position - 1;\n        }\n\n        index = isNaN(index) ? 0 : index;\n\n        if (monthCollection.length > 0) {\n          if (isNullOrUndefined(ruleObject.setPosition)) {\n            insertDatasIntoExistingCollection(monthCollection, state, startDate, endDate, data, ruleObject, index);\n          } else {\n            dateCollection = [filterDateCollectionByIndex(monthCollection, index, dates)];\n          }\n        }\n\n        if (expectedCount && data.length + ruleObject.recExceptionCount >= expectedCount) {\n          return;\n        }\n\n        monthCollection = [];\n      }\n\n      if (!isNullOrUndefined(ruleObject.setPosition)) {\n        insertDateCollectionBasedonBySetPos(dateCollection, state, startDate, endDate, data, ruleObject);\n        dates = [];\n      }\n\n      monthInit = setNextValidDate(tempDate, ruleObject, monthInit, beginDate);\n      tempDate = getStartDateForWeek(tempDate, ruleObject.day);\n      monthCollection = [];\n    } else {\n      let weekCollection = [];\n      const dayCycleData = processWeekDays(expectedDays);\n      currentMonthDate.setFullYear(tempDate.getFullYear(), tempDate.getMonth(), tempDate.getDate());\n      const initialDate = new Date(tempDate.getTime());\n      beginDate = new Date(tempDate.getTime());\n\n      while (calendarUtil.isSameMonth(initialDate, tempDate)) {\n        weekCollection.push(tempDate.getTime());\n\n        if (expectedDays.indexOf(DAYINDEX[tempDate.getDay()]) > -1) {\n          monthCollection.push(weekCollection);\n          weekCollection = [];\n        }\n\n        tempDate.setDate(tempDate.getDate() + dayCycleData[DAYINDEX[tempDate.getDay()]]);\n      }\n\n      index = ruleObject.setPosition < 1 ? monthCollection.length + ruleObject.setPosition : ruleObject.setPosition - 1;\n\n      if (isNullOrUndefined(ruleObject.setPosition)) {\n        index = 0;\n        const datas = [];\n\n        for (let week = 0; week < monthCollection.length; week++) {\n          for (let row = 0; row < monthCollection[week].length; row++) {\n            datas.push(monthCollection[week][row]);\n          }\n        }\n\n        monthCollection = [datas];\n      }\n\n      if (monthCollection.length > 0) {\n        insertDatasIntoExistingCollection(monthCollection, state, startDate, endDate, data, ruleObject, index);\n      }\n\n      if (expectedCount && data.length + ruleObject.recExceptionCount >= expectedCount) {\n        return;\n      }\n\n      monthInit = setNextValidDate(tempDate, ruleObject, monthInit, beginDate);\n      tempDate = getStartDateForWeek(tempDate, ruleObject.day);\n      monthCollection = [];\n    }\n  }\n}\n/**\n * To process monday day type for FREQ=MONTHLY\n *\n * @param {Date} startDate Accepts the strat date\n * @param {Date} endDate Accepts the end date\n * @param {number[]} data Accepts the collection of dates\n * @param {RecRule} ruleObject Accepts the recurrence rule object\n * @returns {void}\n * @private\n */\n\n\nfunction monthlyDayTypeProcessforMonthFreq(startDate, endDate, data, ruleObject) {\n  const expectedDays = ruleObject.day; // When BYDAY property having more than 1 value.\n\n  if (expectedDays.length > 1) {\n    getMonthCollection(startDate, endDate, data, ruleObject);\n    return;\n  }\n\n  let tempDate = new Date(startDate.getTime());\n  const expectedCount = getDateCount$1(startDate, ruleObject);\n  let monthCollection = [];\n  let beginDate;\n  let monthInit = 0;\n  tempDate = calendarUtil.getMonthStartDate(tempDate);\n\n  if (ruleObject.month.length) {\n    calendarUtil.setMonth(tempDate, ruleObject.month[0], 1);\n  }\n\n  tempDate = getStartDateForWeek(tempDate, ruleObject.day);\n\n  while (compareDates(tempDate, endDate) && expectedCount && data.length + ruleObject.recExceptionCount < expectedCount) {\n    beginDate = new Date(tempDate.getTime());\n    const currentMonthDate = new Date(tempDate.getTime());\n\n    while (calendarUtil.isSameMonth(tempDate, currentMonthDate)) {\n      monthCollection.push([currentMonthDate.getTime()]);\n      currentMonthDate.setDate(currentMonthDate.getDate() + 7);\n    } // To filter date collection based on BYDAY Index, then BYSETPOS and to insert datas into existing collection\n\n\n    insertDateCollectionBasedonIndex(monthCollection, startDate, endDate, data, ruleObject);\n    monthInit = setNextValidDate(tempDate, ruleObject, monthInit, beginDate);\n    tempDate = getStartDateForWeek(tempDate, ruleObject.day);\n    monthCollection = [];\n  }\n}\n/**\n * To process monday day type for FREQ=YEARLY\n *\n * @param {Date} startDate Accepts the strat date\n * @param {Date} endDate Accepts the end date\n * @param {number[]} data Accepts the collection of dates\n * @param {RecRule} ruleObject Accepts the recurrence rule object\n * @returns {void}\n * @private\n */\n\n\nfunction monthlyDayTypeProcess(startDate, endDate, data, ruleObject) {\n  const expectedDays = ruleObject.day;\n  const isHavingNumber = expectedDays.map(item => HASNUMBER.test(item)); // If BYDAY property having more than 1 value in list\n\n  if (expectedDays.length > 1 && isHavingNumber.indexOf(true) > -1) {\n    processDateCollectionforByDayWithInteger(startDate, endDate, data, ruleObject);\n    return;\n  } else if (ruleObject.month.length && expectedDays.length === 1 && isHavingNumber.indexOf(true) > -1) {\n    monthlyDayTypeProcessforMonthFreq(startDate, endDate, data, ruleObject);\n    return;\n  }\n\n  let tempDate = new Date(startDate.getTime());\n  let currentMonthDate;\n  const expectedCount = getDateCount$1(startDate, ruleObject);\n  const interval = ruleObject.interval;\n  let monthCollection = [];\n\n  if (ruleObject.month.length) {\n    calendarUtil.setMonth(tempDate, ruleObject.month[0], tempDate.getDate());\n  } // Set the date as start date of the yeear if yearly freq having ByDay property alone\n\n\n  if (isNullOrUndefined(ruleObject.setPosition) && ruleObject.month.length === 0 && ruleObject.weekNo.length === 0) {\n    tempDate.setFullYear(startDate.getFullYear(), 0, 1);\n  }\n\n  tempDate = calendarUtil.getMonthStartDate(tempDate);\n  tempDate = getStartDateForWeek(tempDate, ruleObject.day);\n\n  while (compareDates(tempDate, endDate)) {\n    currentMonthDate = new Date(tempDate.getTime());\n\n    while (calendarUtil.isSameYear(currentMonthDate, tempDate) && expectedCount && data.length + ruleObject.recExceptionCount <= expectedCount) {\n      currentMonthDate = new Date(tempDate.getTime());\n\n      while (calendarUtil.isSameYear(currentMonthDate, tempDate)) {\n        if (ruleObject.month.length === 0 || ruleObject.month.length > 0 && !calendarUtil.checkMonth(tempDate, ruleObject.month)) {\n          if (expectedDays.length > 1) {\n            if (calendarUtil.compareMonth(currentMonthDate, tempDate)) {\n              calendarUtil.setValidDate(tempDate, 1, 1);\n              tempDate = getStartDateForWeek(tempDate, ruleObject.day);\n              break;\n            }\n\n            if (expectedDays.indexOf(DAYINDEX[currentMonthDate.getDay()]) > -1) {\n              monthCollection.push([currentMonthDate.getTime()]);\n            }\n\n            currentMonthDate.setDate(currentMonthDate.getDate() + 1);\n          } else {\n            // If BYDAY property having 1 value in list\n            if (currentMonthDate.getFullYear() > tempDate.getFullYear()) {\n              calendarUtil.setValidDate(tempDate, 1, 1);\n              tempDate = getStartDateForWeek(tempDate, ruleObject.day);\n              break;\n            }\n\n            const newstr = getDayString(expectedDays[0]);\n\n            if (DAYINDEX[currentMonthDate.getDay()] === newstr && new Date(currentMonthDate.getFullYear(), currentMonthDate.getMonth(), 0) > new Date(startDate.getFullYear())) {\n              monthCollection.push([currentMonthDate.getTime()]);\n            }\n\n            currentMonthDate.setDate(currentMonthDate.getDate() + 7);\n          }\n        } else {\n          calendarUtil.setValidDate(tempDate, 1, 1);\n          tempDate = getStartDateForWeek(tempDate, ruleObject.day);\n          break;\n        }\n      }\n    }\n\n    tempDate.setFullYear(currentMonthDate.getFullYear(), currentMonthDate.getMonth(), currentMonthDate.getDate()); // To filter date collection based on BYDAY Index, then BYSETPOS and to insert datas into existing collection\n\n    insertDateCollectionBasedonIndex(monthCollection, startDate, endDate, data, ruleObject);\n\n    if (calendarUtil.isLastMonth(tempDate)) {\n      calendarUtil.setValidDate(tempDate, 1, 1);\n      tempDate = getStartDateForWeek(tempDate, ruleObject.day);\n    }\n\n    tempDate.setFullYear(tempDate.getFullYear() + interval - 1);\n\n    if (expectedCount && data.length + ruleObject.recExceptionCount >= expectedCount) {\n      return;\n    }\n\n    tempDate = getStartDateForWeek(tempDate, ruleObject.day);\n    monthCollection = [];\n  }\n}\n/**\n * To process the recurrence rule when BYDAY property having values with integer\n *\n * @param {Date} startDate Accepts the strat date\n * @param {Date} endDate Accepts the end date\n * @param {number[]} data Accepts the collection of dates\n * @param {RecRule} ruleObject Accepts the recurrence rule object\n * @returns {void}\n * @private\n */\n\n\nfunction processDateCollectionforByDayWithInteger(startDate, endDate, data, ruleObject) {\n  const expectedDays = ruleObject.day;\n  const expectedCount = getDateCount$1(startDate, ruleObject);\n  let tempDate = new Date(startDate.getTime());\n  const interval = ruleObject.interval;\n  let monthCollection = [];\n  let dateCollection = [];\n  let index;\n  let state;\n  let monthInit = 0;\n  let currentMonthDate;\n  let currentDate;\n  let beginDate;\n  tempDate = calendarUtil.getMonthStartDate(tempDate);\n  let datas = [];\n\n  if (ruleObject.month.length) {\n    calendarUtil.setMonth(tempDate, ruleObject.month[0], 1);\n  }\n\n  tempDate = getStartDateForWeek(tempDate, ruleObject.day);\n\n  while (compareDates(tempDate, endDate)) {\n    currentMonthDate = new Date(tempDate.getTime());\n\n    for (let i = 0; i <= ruleObject.month.length; i++) {\n      for (let j = 0; j <= expectedDays.length - 1; j++) {\n        tempDate = calendarUtil.getMonthStartDate(tempDate);\n        tempDate = getStartDateForWeek(tempDate, ruleObject.day);\n        monthCollection = [];\n\n        while (calendarUtil.isSameYear(currentMonthDate, tempDate) && expectedCount && data.length + ruleObject.recExceptionCount <= expectedCount) {\n          while (calendarUtil.isSameYear(currentMonthDate, tempDate)) {\n            currentMonthDate = new Date(tempDate.getTime());\n\n            if (ruleObject.month.length === 0 || ruleObject.month.length > 0 && ruleObject.month[i] === calendarUtil.getMonth(currentMonthDate)) {\n              const expectedDaysArray = expectedDays[j].match(SPLITNUMBERANDSTRING);\n              const position = parseInt(expectedDaysArray[0], 10);\n              currentDate = new Date(tempDate.getTime());\n\n              while (calendarUtil.isSameYear(currentDate, tempDate) && calendarUtil.isSameMonth(currentDate, tempDate)) {\n                if (expectedDaysArray[expectedDaysArray.length - 1] === DAYINDEX[currentDate.getDay()]) {\n                  monthCollection.push([currentDate.getTime()]);\n                }\n\n                currentDate.setDate(currentDate.getDate() + 1);\n              }\n\n              currentDate.setDate(currentDate.getDate() - 1);\n\n              if (expectedDaysArray[0].indexOf('-') > -1) {\n                index = monthCollection.length - -1 * position;\n              } else {\n                index = position - 1;\n              }\n\n              index = isNaN(index) ? 0 : index;\n            }\n\n            monthInit = setNextValidDate(tempDate, ruleObject, monthInit, beginDate, 1);\n            tempDate = getStartDateForWeek(tempDate, ruleObject.day);\n          }\n        }\n\n        tempDate = j === 0 && currentDate ? new Date(currentDate.getTime()) : new Date(currentMonthDate.getTime());\n\n        if (monthCollection.length > 0) {\n          if (isNullOrUndefined(ruleObject.setPosition)) {\n            insertDatasIntoExistingCollection(monthCollection, state, startDate, endDate, data, ruleObject, index);\n          } else {\n            dateCollection = [filterDateCollectionByIndex(monthCollection, index, datas)];\n          }\n        }\n\n        if (expectedCount && data.length + ruleObject.recExceptionCount >= expectedCount) {\n          return;\n        }\n      }\n    }\n\n    if (!isNullOrUndefined(ruleObject.setPosition)) {\n      insertDateCollectionBasedonBySetPos(dateCollection, state, startDate, endDate, data, ruleObject);\n      datas = [];\n    }\n\n    if (calendarUtil.isLastMonth(tempDate)) {\n      calendarUtil.setValidDate(tempDate, 1, 1);\n      tempDate.setFullYear(tempDate.getFullYear() + interval - 1);\n    } else {\n      tempDate.setFullYear(tempDate.getFullYear() + interval);\n    }\n\n    tempDate = getStartDateForWeek(tempDate, ruleObject.day);\n\n    if (ruleObject.month.length) {\n      calendarUtil.setMonth(tempDate, ruleObject.month[0], tempDate.getDate());\n    }\n  }\n}\n/**\n * To get recurrence collection if BYSETPOS is null\n *\n * @param {number[]} monthCollection Accepts the month collection dates\n * @param {string[]} expectedDays Accepts the exception dates\n * @returns {RuleData} Returns the rule data object\n * @private\n */\n\n\nfunction getRecurrenceCollection(monthCollection, expectedDays) {\n  let index;\n  const recurrenceCollectionObject = {\n    monthCollection: [],\n    index: 0\n  };\n\n  if (expectedDays.length === 1) {\n    // To split numeric value from BYDAY property value\n    const expectedDaysArrays = expectedDays[0].match(SPLITNUMBERANDSTRING);\n    let arrPosition;\n\n    if (expectedDaysArrays.length > 1) {\n      arrPosition = parseInt(expectedDaysArrays[0], 10);\n      index = arrPosition < 1 ? monthCollection.length + arrPosition : arrPosition - 1;\n    } else {\n      index = 0;\n      monthCollection = getDateCollectionforBySetPosNull(monthCollection);\n    }\n  } else {\n    index = 0;\n    monthCollection = getDateCollectionforBySetPosNull(monthCollection);\n  }\n\n  recurrenceCollectionObject.monthCollection = monthCollection;\n  recurrenceCollectionObject.index = index;\n  return recurrenceCollectionObject;\n}\n/**\n * Internal method to process the data collections\n *\n * @param {number[]} dateCollection Accepts the date collections\n * @param {boolean} state Accepts the state\n * @param {Date} startDate Accepts the start date\n * @param {Date} endDate Accepts the end date\n * @param {number[]} data Accepts the collection of numbers\n * @param {RecRule} ruleObject Accepts the recurrence rule object\n * @returns {void}\n * @private\n */\n\n\nfunction insertDataCollection(dateCollection, state, startDate, endDate, data, ruleObject) {\n  let index = ruleObject.setPosition < 1 ? dateCollection.length + ruleObject.setPosition : ruleObject.setPosition - 1;\n\n  if (isNullOrUndefined(ruleObject.setPosition)) {\n    index = 0;\n    dateCollection = getDateCollectionforBySetPosNull(dateCollection);\n  }\n\n  if (dateCollection.length > 0) {\n    insertDatasIntoExistingCollection(dateCollection, state, startDate, endDate, data, ruleObject, index);\n  }\n}\n/**\n * To process month collection if BYSETPOS is null\n *\n * @param {number[]} monthCollection Accepts the month date collections\n * @returns {number[]} Returns the month date collections\n * @private\n */\n\n\nfunction getDateCollectionforBySetPosNull(monthCollection) {\n  const datas = [];\n\n  for (let week = 0; week < monthCollection.length; week++) {\n    for (let row = 0; row < monthCollection[week].length; row++) {\n      datas.push(new Date(monthCollection[week][row]).getTime());\n    }\n  }\n\n  monthCollection = datas.length > 0 ? [datas] : [];\n  return monthCollection;\n}\n/**\n * To filter date collection based on BYDAY Index, then BYSETPOS and to insert datas into existing collection\n *\n * @param {number[]} monthCollection Accepts the month date collections\n * @param {Date} startDate Accepts the start date\n * @param {Date} endDate Accepts the end date\n * @param {number[]} data Accepts the date collections\n * @param {RecRule} ruleObject Accepts the recurrence rule object\n * @returns {void}\n * @private\n */\n\n\nfunction insertDateCollectionBasedonIndex(monthCollection, startDate, endDate, data, ruleObject) {\n  const expectedDays = ruleObject.day;\n  let state;\n  let datas = [];\n  let dateCollection = [];\n  const recurrenceCollections = getRecurrenceCollection(monthCollection, expectedDays);\n  monthCollection = recurrenceCollections.monthCollection;\n  const index = recurrenceCollections.index;\n\n  if (ruleObject.setPosition != null) {\n    dateCollection = [filterDateCollectionByIndex(monthCollection, index, datas)];\n    insertDateCollectionBasedonBySetPos(dateCollection, state, startDate, endDate, data, ruleObject);\n  } else {\n    if (monthCollection.length > 0) {\n      insertDatasIntoExistingCollection(monthCollection, state, startDate, endDate, data, ruleObject, index);\n    }\n  }\n\n  datas = [];\n}\n/**\n * To filter date collection when BYDAY property having values with number\n *\n * @param {number[]} monthCollection Accepts the date collections\n * @param {number} index Accepts the index of date collections\n * @param {number[]} datas Accepts the collection of dates\n * @returns {number[]} Returns the collection of dates\n * @private\n */\n\n\nfunction filterDateCollectionByIndex(monthCollection, index, datas) {\n  for (let week = 0; week < monthCollection[index].length; week++) {\n    datas.push(monthCollection[index][week]);\n  }\n\n  return datas;\n}\n/**\n * To insert processed date collection in final array element\n *\n * @param {boolean} state Accepts the state of the recurrence rule\n * @param {Date} startDate Accepts the start date\n * @param {Date} endDate Accepts the end date\n * @param {number[]} data Accepts the collection of date\n * @param {RecRule} ruleObject Accepts the recurrence rule object\n * @param {number} dayData Accepts the date index\n * @returns {void}\n * @private\n */\n\n\nfunction insertDateCollection(state, startDate, endDate, data, ruleObject, dayData) {\n  const expectedCount = getDateCount$1(startDate, ruleObject);\n  const chDate = new Date(dayData);\n  state = validateRules(chDate, ruleObject);\n\n  if (chDate >= startDate && compareDates(chDate, endDate) && state && expectedCount && data.length + ruleObject.recExceptionCount < expectedCount) {\n    excludeDateHandler(data, dayData);\n  }\n}\n/**\n * Return the last week number of given month and year.\n *\n * @param {number} year Accepts the Year in number format\n * @param {number} startDayOfWeek Accepts the start date\n * @param {number[]} monthCollection Accepts the collection of dates\n * @param {number} week Accepts the week in number format\n * @param {RecRule} ruleObject Accepts the recurrence rule object\n * @returns {number} returns week number\n * @private\n */\n\n\nfunction weekCount(year, startDayOfWeek, monthCollection, week, ruleObject) {\n  const firstDayOfWeek = startDayOfWeek || 0;\n  const firstOfMonth = new Date(year, ruleObject.month[0] - 1, 1);\n  const lastOfMonth = new Date(year, ruleObject.month[0], 0);\n  const numberOfDaysInMonth = lastOfMonth.getDate();\n  const firstWeekDay = (firstOfMonth.getDay() - firstDayOfWeek + 7) % 7;\n  const used = firstWeekDay + numberOfDaysInMonth;\n  const count = Math.ceil(used / 7) - 1;\n  const dayData = monthCollection[week][count];\n  const chDate = new Date(dayData);\n  const state = validateRules(chDate, ruleObject);\n  return state ? count : count - 1;\n}\n/**\n * To process date collection based on Byset position after process the collection based on BYDAY property value index: EX:BYDAY=1SUm-1SU\n *\n * @param {number[]} monthCollection Accepts the collection of dates\n * @param {boolean} state Accepts the state of the recurrence rule\n * @param {Date} startDate Accepts the start date\n * @param {Date} endDate Accepts the end date\n * @param {number[]} data Accepts the collection of date\n * @param {RecRule} ruleObject Accepts the recurrence rule object\n * @returns {void}\n * @private\n */\n\n\nfunction insertDateCollectionBasedonBySetPos(monthCollection, state, startDate, endDate, data, ruleObject) {\n  if (monthCollection.length > 0) {\n    for (let week = 0; week < monthCollection.length; week++) {\n      monthCollection[week].sort();\n      const expectedDays = ruleObject.day;\n      const isHavingNumber = expectedDays.map(item => HASNUMBER.test(item));\n      const weekIndex = ruleObject.freq === 'YEARLY' && ruleObject.validRules.indexOf('BYMONTH') > -1 && !(isHavingNumber.indexOf(true) > -1) ? weekCount(new Date(monthCollection[0][0]).getFullYear(), 0, monthCollection, week, ruleObject) : monthCollection[week].length + ruleObject.setPosition;\n      const index = ruleObject.setPosition < 1 ? weekIndex : ruleObject.setPosition - 1;\n      const dayData = monthCollection[week][index];\n      insertDateCollection(state, startDate, endDate, data, ruleObject, dayData);\n    }\n  }\n}\n/**\n * To insert datas into existing collection which is processed from previous loop.\n *\n * @param {number[]} monthCollection Accepts the collection of dates\n * @param {boolean} state Accepts the state of the recurrence rule\n * @param {Date} startDate Accepts the start date\n * @param {Date} endDate Accepts the end date\n * @param {number[]} data Accepts the collection of date\n * @param {RecRule} ruleObject Accepts the recurrence rule object\n * @param {number} index Accepts the index value\n * @returns {void}\n * @private\n */\n\n\nfunction insertDatasIntoExistingCollection(monthCollection, state, startDate, endDate, data, ruleObject, index) {\n  if (monthCollection.length > 0) {\n    index = !isNullOrUndefined(index) ? index : ruleObject.setPosition < 1 ? monthCollection.length + ruleObject.setPosition : ruleObject.setPosition - 1;\n    monthCollection[index].sort();\n\n    for (let week = 0; week < monthCollection[index].length; week++) {\n      const dayData = monthCollection[index][week];\n      insertDateCollection(state, startDate, endDate, data, ruleObject, dayData);\n    }\n  }\n}\n/**\n * Internal method to compare dates\n *\n * @param {Date} startDate Accepts the start date\n * @param {Date} endDate Accepts the end date\n * @returns {boolean} Returns the result of checking start and end dates\n * @private\n */\n\n\nfunction compareDates(startDate, endDate) {\n  return endDate ? startDate <= endDate : true;\n}\n/**\n * Internal method to get day string\n *\n * @param {string} expectedDays Accepts the exception date string\n * @returns {string} Returns the valid string\n * @private\n */\n\n\nfunction getDayString(expectedDays) {\n  // To get BYDAY value without numeric value\n  const newstr = expectedDays.replace(REMOVENUMBERINSTRING, '');\n  return newstr;\n}\n/**\n * Internal method to check day index\n *\n * @param {number} day Accepts the day index\n * @param {string[]} expectedDays Accepts the exception dates\n * @returns {boolean} Returns the index date\n * @private\n */\n\n\nfunction checkDayIndex(day, expectedDays) {\n  const sortedExpectedDays = [];\n  expectedDays.forEach(element => {\n    const expectedDaysNumberSplit = element.match(SPLITNUMBERANDSTRING);\n\n    if (expectedDaysNumberSplit.length === 2) {\n      sortedExpectedDays.push(expectedDaysNumberSplit[1]);\n    } else {\n      sortedExpectedDays.push(expectedDaysNumberSplit[0]);\n    }\n  });\n  return sortedExpectedDays.indexOf(DAYINDEX[day]) === -1;\n}\n/**\n * Internal method to get start date of week\n *\n * @param {Date} startDate Accepts the start date\n * @param {string[]} expectedDays Accepts the exception dates\n * @returns {Date} Return the week start date\n * @private\n */\n\n\nfunction getStartDateForWeek(startDate, expectedDays) {\n  const tempDate = new Date(startDate.getTime());\n  let newstr;\n\n  if (expectedDays.length > 0) {\n    const expectedDaysArr = [];\n\n    for (let i = 0; i <= expectedDays.length - 1; i++) {\n      newstr = getDayString(expectedDays[i]);\n      expectedDaysArr.push(newstr);\n    }\n\n    if (expectedDaysArr.indexOf(DAYINDEX[tempDate.getDay()]) === -1) {\n      do {\n        tempDate.setDate(tempDate.getDate() + 1);\n      } while (expectedDaysArr.indexOf(DAYINDEX[tempDate.getDay()]) === -1);\n    }\n  }\n\n  return tempDate;\n}\n/**\n * Method to generate recurrence rule object from given rule\n *\n * @param {string} rules Accepts the recurrence rule\n * @returns {RecRule} Returns the recurrence rule object\n */\n\n\nfunction extractObjectFromRule(rules) {\n  const ruleObject = {\n    freq: null,\n    interval: 1,\n    count: null,\n    until: null,\n    day: [],\n    wkst: null,\n    month: [],\n    weekNo: [],\n    monthDay: [],\n    yearDay: [],\n    setPosition: null,\n    validRules: []\n  };\n  const rulesList = rules.split(';');\n  let splitData = [];\n  let temp;\n  rulesList.forEach(data => {\n    splitData = data.split('=');\n\n    switch (splitData[0]) {\n      case 'UNTIL':\n        temp = splitData[1];\n        ruleObject.until = getDateFromRecurrenceDateString(temp);\n        break;\n\n      case 'BYDAY':\n        ruleObject.day = splitData[1].split(',');\n        ruleObject.validRules.push(splitData[0]);\n        break;\n\n      case 'BYMONTHDAY':\n        ruleObject.monthDay = splitData[1].split(',').map(Number);\n        ruleObject.validRules.push(splitData[0]);\n        break;\n\n      case 'BYMONTH':\n        ruleObject.month = splitData[1].split(',').map(Number);\n        ruleObject.validRules.push(splitData[0]);\n        break;\n\n      case 'BYYEARDAY':\n        ruleObject.yearDay = splitData[1].split(',').map(Number);\n        ruleObject.validRules.push(splitData[0]);\n        break;\n\n      case 'BYWEEKNO':\n        ruleObject.weekNo = splitData[1].split(',').map(Number);\n        ruleObject.validRules.push(splitData[0]);\n        break;\n\n      case 'INTERVAL':\n        ruleObject.interval = parseInt(splitData[1], 10);\n        break;\n\n      case 'COUNT':\n        ruleObject.count = parseInt(splitData[1], 10);\n        break;\n\n      case 'BYSETPOS':\n        ruleObject.setPosition = parseInt(splitData[1], 10) > 4 ? -1 : parseInt(splitData[1], 10);\n        break;\n\n      case 'FREQ':\n        ruleObject.freq = splitData[1];\n        break;\n\n      case 'WKST':\n        ruleObject.wkst = splitData[1];\n        break;\n    }\n  });\n\n  if (ruleObject.freq === 'MONTHLY' && ruleObject.monthDay.length === 0) {\n    const index = ruleObject.validRules.indexOf('BYDAY');\n    ruleObject.validRules.splice(index, 1);\n  }\n\n  return ruleObject;\n}\n/**\n * Internal method to validate proper date\n *\n * @param {Date} tempDate Accepts the date value\n * @param {number} data Accepts the data value\n * @param {Date} startDate Accepts the start date\n * @returns {boolean} Returns the result of date validate\n * @private\n */\n\n\nfunction validateProperDate(tempDate, data, startDate) {\n  const maxDate = calendarUtil.getMonthDaysCount(tempDate);\n  return data <= maxDate && tempDate >= startDate;\n}\n/**\n * Internal method to process week days\n *\n * @param {string[]} expectedDays Accepts the expection dates\n * @returns {Object} Returns the weekdays object\n * @private\n */\n\n\nfunction processWeekDays(expectedDays) {\n  const dayCycle = {};\n  expectedDays.forEach((element, index) => {\n    if (index === expectedDays.length - 1) {\n      const startIndex = dayIndex.indexOf(element);\n      let temp = startIndex;\n\n      while (temp % 7 !== dayIndex.indexOf(expectedDays[0])) {\n        temp++;\n      }\n\n      dayCycle[element] = temp - startIndex;\n    } else {\n      dayCycle[element] = dayIndex.indexOf(expectedDays[index + 1]) - dayIndex.indexOf(element);\n    }\n  });\n  return dayCycle;\n}\n/**\n * Internal method to check date\n *\n * @param {Date} tempDate Accepts the date value\n * @param {number[]} expectedDate Accepts the exception dates\n * @returns {boolean} Returns the boolean value\n * @private\n */\n\n\nfunction checkDate(tempDate, expectedDate) {\n  const temp = expectedDate.slice(0);\n  let data;\n  const maxDate = calendarUtil.getMonthDaysCount(tempDate);\n  data = temp.shift();\n\n  while (data) {\n    if (data < 0) {\n      data = data + maxDate + 1;\n    }\n\n    if (data === tempDate.getDate()) {\n      return false;\n    }\n\n    data = temp.shift();\n  }\n\n  return true;\n}\n/**\n * Internal method to check the year value\n *\n * @param {Date} tempDate Accepts the date value\n * @param {number[]} expectedyearDay Accepts the exception dates in year\n * @returns {boolean} Returns the boolean value\n * @private\n */\n\n\nfunction checkYear(tempDate, expectedyearDay) {\n  const temp = expectedyearDay.slice(0);\n  let data;\n  const yearDay = getYearDay(tempDate);\n  data = temp.shift();\n\n  while (data) {\n    if (data < 0) {\n      data = data + calendarUtil.getYearDaysCount(tempDate, 0) + 1;\n    }\n\n    if (data === yearDay) {\n      return false;\n    }\n\n    data = temp.shift();\n  }\n\n  return true;\n}\n/**\n * Internal method to get the year day\n *\n * @param {Date} currentDate Accepts the date value\n * @returns {number} Returns the boolean value\n * @private\n */\n\n\nfunction getYearDay(currentDate) {\n  if (!startDateCollection[calendarUtil.getFullYear(currentDate)]) {\n    startDateCollection[calendarUtil.getFullYear(currentDate)] = calendarUtil.getYearLastDate(currentDate, 0);\n  }\n\n  const tempDate = startDateCollection[calendarUtil.getFullYear(currentDate)];\n  const diff = currentDate.getTime() - tempDate.getTime();\n  return Math.ceil(diff / MS_PER_DAY);\n}\n/**\n * Internal method to validate monthly rule type\n *\n * @param {RecRule} ruleObject Accepts the recurrence rule object\n * @returns {MonthlyType} Returns the monthly type object\n * @private\n */\n\n\nfunction validateMonthlyRuleType(ruleObject) {\n  if (ruleObject.monthDay.length && !ruleObject.day.length) {\n    return 'date';\n  } else if (!ruleObject.monthDay.length && ruleObject.day.length) {\n    return 'day';\n  }\n\n  return 'both';\n}\n/**\n * Internal method to re-order the week days based on first day of week\n *\n * @param {string[]} days Accepts the week days value\n * @returns {void}\n * @private\n */\n\n\nfunction rotate(days) {\n  const data = days.shift();\n  days.push(data);\n}\n/**\n * Internal method to set first day of week\n *\n * @param {string} day Accepts the first day string\n * @returns {void}\n * @private\n */\n\n\nfunction setFirstDayOfWeek(day) {\n  while (dayIndex[0] !== day) {\n    rotate(dayIndex);\n  }\n}\n/**\n * Internal method to validate recurrence rule\n *\n * @param {Date} tempDate Accepts the date value\n * @param {RecRule} ruleObject Accepts the recurrence rule object\n * @returns {boolean} Returns the boolean value\n * @private\n */\n\n\nfunction validateRules(tempDate, ruleObject) {\n  let state = true;\n  const expectedDays = ruleObject.day;\n  const expectedMonth = ruleObject.month;\n  const expectedDate = calendarUtil.getExpectedDays(tempDate, ruleObject.monthDay);\n  const expectedyearDay = ruleObject.yearDay;\n  ruleObject.validRules.forEach(rule => {\n    switch (rule) {\n      case 'BYDAY':\n        if (checkDayIndex(tempDate.getDay(), expectedDays)) {\n          state = false;\n        }\n\n        break;\n\n      case 'BYMONTH':\n        if (calendarUtil.checkMonth(tempDate, expectedMonth)) {\n          state = false;\n        }\n\n        break;\n\n      case 'BYMONTHDAY':\n        if (checkDate(tempDate, expectedDate)) {\n          state = false;\n        }\n\n        break;\n\n      case 'BYYEARDAY':\n        if (checkYear(tempDate, expectedyearDay)) {\n          state = false;\n        }\n\n        break;\n    }\n  });\n  return state;\n}\n/**\n * Internal method to get calendar util\n *\n * @param {CalendarType} calendarMode Accepts the calendar type object\n * @returns {CalendarUtil} Returns the calendar util object\n * @private\n */\n\n\nfunction getCalendarUtil(calendarMode) {\n  if (calendarMode === 'Islamic') {\n    return new Islamic();\n  }\n\n  return new Gregorian();\n}\n\nconst startDateCollection = {};\nlet tempExcludeDate;\nconst dayIndex = ['SU', 'MO', 'TU', 'WE', 'TH', 'FR', 'SA'];\nlet maxOccurrence;\nlet tempViewDate;\nlet calendarUtil;\nconst DAYINDEX = ['SU', 'MO', 'TU', 'WE', 'TH', 'FR', 'SA'];\nconst MAXOCCURRENCE = 43;\nconst WEEKPOS = ['first', 'second', 'third', 'fourth', 'last'];\nconst TIMES = 'summaryTimes';\nconst ON = 'summaryOn';\nconst EVERY = 'every';\nconst UNTIL = 'summaryUntil';\nconst DAYS = 'summaryDay';\nconst WEEKS = 'summaryWeek';\nconst MONTHS = 'summaryMonth';\nconst YEARS = 'summaryYear';\nconst DAYINDEXOBJECT = {\n  SU: 'sun',\n  MO: 'mon',\n  TU: 'tue',\n  WE: 'wed',\n  TH: 'thu',\n  FR: 'fri',\n  SA: 'sat'\n}; // To check string has number\n\nconst HASNUMBER = /\\d/; // To find the numbers in string\n\nconst REMOVENUMBERINSTRING = /[^A-Z]+/; // To split number and string\n\nconst SPLITNUMBERANDSTRING = /[a-z]+|[^a-z]+/gi;\n/**\n * Method to generate string from date\n *\n * @param {Date} date Accepts the date value\n * @returns {string} Returns the string value\n */\n\nfunction getRecurrenceStringFromDate(date) {\n  return [date.getUTCFullYear(), roundDateValues(date.getUTCMonth() + 1), roundDateValues(date.getUTCDate()), 'T', roundDateValues(date.getUTCHours()), roundDateValues(date.getUTCMinutes()), roundDateValues(date.getUTCSeconds()), 'Z'].join('');\n}\n/**\n * Internal method to round the date values\n *\n * @param {string | number} date Accepts the date value in either string or number format\n * @returns {string} Returns the date value in string format\n * @private\n */\n\n\nfunction roundDateValues(date) {\n  return ('0' + date).slice(-2);\n}\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\n/* eslint-disable max-len */\n\n/**\n * EventBase for appointment rendering\n */\n\n\nclass EventBase {\n  /**\n   * Constructor for EventBase\n   *\n   * @param {Schedule} parent Accepts the schedule instance\n   */\n  constructor(parent) {\n    this.slots = [];\n    this.isDoubleTapped = false;\n    this.parent = parent;\n  }\n\n  processData(events, timeZonePropChanged, oldTimezone) {\n    const start = this.parent.activeView.startDate();\n    const end = this.parent.activeView.endDate();\n    const fields = this.parent.eventFields;\n    let processed = [];\n    let temp = 1;\n    let generateID = false;\n    const resourceCollection = this.parent.resourceBase ? this.parent.resourceBase.resourceCollection : [];\n\n    if (events.length > 0 && isNullOrUndefined(events[0][fields.id])) {\n      generateID = true;\n    }\n\n    for (let event of events) {\n      if (generateID) {\n        event[fields.id] = temp++;\n      }\n\n      event = this.updateEventDateTime(event);\n\n      if (timeZonePropChanged) {\n        this.processTimezoneChange(event, oldTimezone);\n      } else if (!this.parent.isPrinting && !this.parent.uiStateValues.isResize) {\n        event = this.processTimezone(event);\n      }\n\n      for (let level = 0; level < resourceCollection.length; level++) {\n        if (event[resourceCollection[level].field] === null || event[resourceCollection[level].field] === 0) {\n          event[resourceCollection[level].field] = undefined;\n        }\n      }\n\n      if (!isNullOrUndefined(event[fields.recurrenceRule]) && event[fields.recurrenceRule] === '') {\n        event[fields.recurrenceRule] = null;\n      }\n\n      if (!isNullOrUndefined(event[fields.recurrenceRule]) && isNullOrUndefined(event[fields.recurrenceID]) && !(this.parent.crudModule && this.parent.crudModule.crudObj.isCrudAction)) {\n        processed = processed.concat(this.generateOccurrence(event, null, oldTimezone, true));\n      } else {\n        if (this.parent.crudModule && this.parent.crudModule.crudObj.isCrudAction) {\n          if (!isNullOrUndefined(event[fields.recurrenceRule]) && isNullOrUndefined(event[fields.recurrenceID])) {\n            const recurrenceEvent = this.generateOccurrence(event, null, oldTimezone, true);\n\n            for (const occurrence of recurrenceEvent) {\n              const app = this.parent.eventsProcessed.filter(data => data[fields.startTime].getTime() - occurrence[fields.startTime].getTime() === 0 && data[fields.id] === occurrence[fields.id]);\n              occurrence.Guid = app.length > 0 ? app[0].Guid : this.generateGuid();\n              processed.push(occurrence);\n            }\n          } else {\n            const app = this.parent.eventsProcessed.filter(data => data[this.parent.eventFields.id] === event[this.parent.eventFields.id]);\n            event.Guid = app.length > 0 ? app[0].Guid : this.generateGuid();\n            processed.push(event);\n          }\n        } else {\n          event.Guid = this.generateGuid();\n          processed.push(event);\n        }\n      }\n    }\n\n    this.parent.eventsProcessed = [];\n    const eventData = processed.filter(data => !data[this.parent.eventFields.isBlock]);\n    this.parent.eventsProcessed = this.filterEvents(start, end, eventData);\n    const blockData = processed.filter(data => data[this.parent.eventFields.isBlock]);\n\n    for (const eventObj of blockData) {\n      if (eventObj[fields.isAllDay]) {\n        const isDifferentDate = resetTime(new Date(eventObj[fields.startTime].getTime())) < resetTime(new Date(eventObj[fields.endTime].getTime()));\n\n        if (!isDifferentDate) {\n          eventObj[fields.startTime] = resetTime(eventObj[fields.startTime]);\n          eventObj[fields.endTime] = addDays(resetTime(eventObj[fields.endTime]), 1);\n        }\n      }\n    }\n\n    this.parent.blockProcessed = blockData;\n    return eventData;\n  }\n\n  updateEventDateTime(eventData) {\n    if (typeof eventData[this.parent.eventFields.startTime] === 'string') {\n      eventData[this.parent.eventFields.startTime] = getDateFromString(eventData[this.parent.eventFields.startTime]);\n    }\n\n    if (typeof eventData[this.parent.eventFields.endTime] === 'string') {\n      eventData[this.parent.eventFields.endTime] = getDateFromString(eventData[this.parent.eventFields.endTime]);\n    }\n\n    return eventData;\n  }\n\n  getProcessedEvents(eventCollection = this.parent.eventsData) {\n    let processed = [];\n\n    for (const event of eventCollection) {\n      if (!isNullOrUndefined(event[this.parent.eventFields.recurrenceRule]) && isNullOrUndefined(event[this.parent.eventFields.recurrenceID])) {\n        processed = processed.concat(this.generateOccurrence(event));\n      } else {\n        processed.push(event);\n      }\n    }\n\n    return processed;\n  }\n\n  timezonePropertyChange(oldTimezone) {\n    const data = this.parent.eventsData.concat(this.parent.blockData);\n    const processed = this.processData(data, true, oldTimezone);\n    this.parent.notify(dataReady, {\n      processedData: processed\n    });\n  }\n\n  timezoneConvert(eventData) {\n    const fields = this.parent.eventFields;\n    eventData[fields.startTimezone] = eventData[fields.startTimezone] || eventData[fields.endTimezone];\n    eventData[fields.endTimezone] = eventData[fields.endTimezone] || eventData[fields.startTimezone];\n\n    if (this.parent.timezone) {\n      const startTz = eventData[fields.startTimezone];\n      const endTz = eventData[fields.endTimezone];\n      eventData[fields.startTime] = this.parent.tzModule.convert(eventData[fields.startTime], this.parent.timezone, startTz);\n      eventData[fields.endTime] = this.parent.tzModule.convert(eventData[fields.endTime], this.parent.timezone, endTz);\n    }\n  }\n\n  processTimezoneChange(event, oldTimezone) {\n    const fields = this.parent.eventFields;\n\n    if (event[fields.isAllDay]) {\n      return;\n    }\n\n    if (oldTimezone && this.parent.timezone) {\n      event[fields.startTime] = this.parent.tzModule.convert(event[fields.startTime], oldTimezone, this.parent.timezone);\n      event[fields.endTime] = this.parent.tzModule.convert(event[fields.endTime], oldTimezone, this.parent.timezone);\n    } else if (!oldTimezone && this.parent.timezone) {\n      event[fields.startTime] = this.parent.tzModule.add(event[fields.startTime], this.parent.timezone);\n      event[fields.endTime] = this.parent.tzModule.add(event[fields.endTime], this.parent.timezone);\n    } else if (oldTimezone && !this.parent.timezone) {\n      event[fields.startTime] = this.parent.tzModule.remove(event[fields.startTime], oldTimezone);\n      event[fields.endTime] = this.parent.tzModule.remove(event[fields.endTime], oldTimezone);\n    }\n  }\n\n  processTimezone(event, isReverse = false) {\n    const fields = this.parent.eventFields;\n\n    if (event[fields.startTimezone] || event[fields.endTimezone]) {\n      const startTimezone = event[fields.startTimezone] || event[fields.endTimezone];\n      const endTimezone = event[fields.endTimezone] || event[fields.startTimezone];\n\n      if (isReverse) {\n        if (this.parent.timezone) {\n          event[fields.startTime] = this.parent.tzModule.convert(event[fields.startTime], startTimezone, this.parent.timezone);\n          event[fields.endTime] = this.parent.tzModule.convert(event[fields.endTime], endTimezone, this.parent.timezone);\n          event[fields.startTime] = this.parent.tzModule.remove(event[fields.startTime], this.parent.timezone);\n          event[fields.endTime] = this.parent.tzModule.remove(event[fields.endTime], this.parent.timezone);\n        } else {\n          event[fields.startTime] = this.parent.tzModule.remove(event[fields.startTime], startTimezone);\n          event[fields.endTime] = this.parent.tzModule.remove(event[fields.endTime], endTimezone);\n        }\n      } else {\n        event[fields.startTime] = this.parent.tzModule.add(event[fields.startTime], startTimezone);\n        event[fields.endTime] = this.parent.tzModule.add(event[fields.endTime], endTimezone);\n\n        if (this.parent.timezone) {\n          event[fields.startTime] = this.parent.tzModule.convert(event[fields.startTime], startTimezone, this.parent.timezone);\n          event[fields.endTime] = this.parent.tzModule.convert(event[fields.endTime], endTimezone, this.parent.timezone);\n        }\n      }\n    } else if (this.parent.timezone) {\n      if (isReverse) {\n        event[fields.startTime] = this.parent.tzModule.remove(event[fields.startTime], this.parent.timezone);\n        event[fields.endTime] = this.parent.tzModule.remove(event[fields.endTime], this.parent.timezone);\n      } else {\n        event[fields.startTime] = this.parent.tzModule.add(event[fields.startTime], this.parent.timezone);\n        event[fields.endTime] = this.parent.tzModule.add(event[fields.endTime], this.parent.timezone);\n      }\n    }\n\n    return event;\n  }\n\n  filterBlockEvents(eventObj) {\n    const fields = this.parent.eventFields;\n    const eStart = eventObj[fields.startTime];\n    const eEnd = eventObj[fields.endTime];\n    let resourceData;\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      const data = this.getGroupIndexFromEvent(eventObj);\n      resourceData = this.parent.resourceBase.lastResourceLevel[data];\n    }\n\n    const blockEvents = extend([], this.parent.blockProcessed, null, true);\n\n    for (const eventObj of blockEvents) {\n      if (eventObj[fields.isAllDay]) {\n        const isDifferentTime = eventObj[fields.endTime].getTime() > resetTime(new Date(eventObj[fields.endTime].getTime())).getTime();\n\n        if (isDifferentTime) {\n          eventObj[fields.startTime] = resetTime(eventObj[fields.startTime]);\n          eventObj[fields.endTime] = addDays(resetTime(eventObj[fields.endTime]), 1);\n        }\n      }\n    }\n\n    return this.filterEvents(eStart, eEnd, blockEvents, resourceData);\n  }\n\n  filterEvents(startDate, endDate, appointments = this.parent.eventsProcessed, resourceTdData) {\n    const fieldMapping = this.parent.eventFields;\n    const predicate = new Predicate(fieldMapping.startTime, 'greaterthanorequal', startDate).and(new Predicate(fieldMapping.endTime, 'greaterthanorequal', startDate)).and(new Predicate(fieldMapping.startTime, 'lessthan', endDate)).or(new Predicate(fieldMapping.startTime, 'lessthanorequal', startDate).and(new Predicate(fieldMapping.endTime, 'greaterthan', startDate)));\n    let filter = new DataManager({\n      json: appointments\n    }).executeLocal(new Query().where(predicate));\n\n    if (resourceTdData) {\n      filter = this.filterEventsByResource(resourceTdData, filter);\n    }\n\n    return this.sortByTime(filter);\n  }\n\n  filterEventsByRange(eventCollection, startDate, endDate) {\n    let filteredEvents = [];\n\n    if (startDate && endDate) {\n      filteredEvents = this.filterEvents(startDate, endDate, eventCollection);\n    } else if (startDate && !endDate) {\n      filteredEvents = eventCollection.filter(e => e[this.parent.eventFields.startTime] >= startDate);\n    } else if (!startDate && endDate) {\n      filteredEvents = eventCollection.filter(e => e[this.parent.eventFields.endTime] <= endDate);\n    } else {\n      filteredEvents = eventCollection;\n    }\n\n    return this.sortByTime(filteredEvents);\n  }\n\n  filterEventsByResource(resourceTdData, appointments = this.parent.eventsProcessed) {\n    const predicate = {};\n    const resourceCollection = this.parent.resourceBase.resourceCollection;\n\n    for (let level = 0; level < resourceCollection.length; level++) {\n      predicate[resourceCollection[level].field] = resourceTdData.groupOrder[level];\n    }\n\n    const keys = Object.keys(predicate);\n    const filteredCollection = appointments.filter(eventObj => keys.every(key => {\n      if (eventObj[key] instanceof Array) {\n        return eventObj[key].indexOf(predicate[key]) > -1;\n      } else {\n        return eventObj[key] === predicate[key];\n      }\n    }));\n    return filteredCollection;\n  }\n\n  sortByTime(appointmentsCollection) {\n    if (this.parent.eventSettings.sortComparer) {\n      appointmentsCollection = this.parent.eventSettings.sortComparer.call(this.parent, appointmentsCollection);\n    } else {\n      const fieldMappings = this.parent.eventFields;\n      appointmentsCollection.sort((a, b) => {\n        const d1 = a[fieldMappings.startTime];\n        const d2 = b[fieldMappings.startTime];\n        return d1.getTime() - d2.getTime();\n      });\n    }\n\n    return appointmentsCollection;\n  }\n\n  sortByDateTime(appointments) {\n    if (this.parent.eventSettings.sortComparer) {\n      appointments = this.parent.eventSettings.sortComparer.call(this.parent, appointments);\n    } else {\n      const fieldMapping = this.parent.eventFields;\n      appointments.sort((object1, object2) => {\n        const d3 = object1[fieldMapping.startTime];\n        const d4 = object2[fieldMapping.startTime];\n        const d5 = object1[fieldMapping.endTime];\n        const d6 = object2[fieldMapping.endTime];\n        const d1 = d5.getTime() - d3.getTime();\n        const d2 = d6.getTime() - d4.getTime();\n        return d3.getTime() - d4.getTime() || d2 - d1;\n      });\n    }\n\n    return appointments;\n  }\n\n  getSmallestMissingNumber(array) {\n    const large = Math.max(...array);\n\n    for (let i = 0; i < large; i++) {\n      if (array.indexOf(i) === -1) {\n        return i;\n      }\n    }\n\n    return large + 1;\n  }\n\n  splitEventByDay(event) {\n    const eventFields = this.parent.eventFields;\n    const data = [];\n    const eventStartTime = event[eventFields.startTime];\n    const eventEndTime = event[eventFields.endTime];\n    const isDifferentDate = resetTime(new Date(eventStartTime.getTime())) < resetTime(new Date(eventEndTime.getTime()));\n\n    if (isDifferentDate) {\n      let start = new Date(eventStartTime.getTime());\n      let end = addDays(resetTime(new Date(eventStartTime.getTime())), 1);\n      const endDate = eventEndTime.getHours() === 0 && eventEndTime.getMinutes() === 0 ? eventEndTime : addDays(eventEndTime, 1);\n      let index = 1;\n      const eventLength = getDaysCount(eventStartTime.getTime(), endDate.getTime());\n\n      while (end <= eventEndTime && start.getTime() !== end.getTime()) {\n        const app = extend({}, event);\n        app[eventFields.startTime] = start;\n        app[eventFields.endTime] = end;\n        app.data = {\n          index: index,\n          count: eventLength\n        };\n        app.Guid = this.generateGuid();\n        app.isSpanned = true;\n        data.push(app);\n        start = end;\n\n        if (resetTime(new Date(start.getTime())).getTime() === resetTime(new Date(eventEndTime.getTime())).getTime() && !(end.getTime() === eventEndTime.getTime())) {\n          end = new Date(start.getTime());\n          end = new Date(end.setHours(eventEndTime.getHours(), eventEndTime.getMinutes(), eventEndTime.getSeconds()));\n        } else {\n          end = addDays(resetTime(new Date(start.getTime())), 1);\n        }\n\n        index++;\n      }\n    } else {\n      data.push(event);\n    }\n\n    return data;\n  }\n\n  splitEvent(event, dateRender) {\n    const fields = this.parent.eventFields;\n    let start = resetTime(event[fields.startTime]).getTime();\n    let end = resetTime(event[fields.endTime]).getTime();\n\n    if (getDateInMs(event[fields.endTime]) <= 0) {\n      const temp = addDays(resetTime(event[fields.endTime]), -1).getTime();\n      end = start > temp ? start : temp;\n    }\n\n    const orgStart = start;\n    const orgEnd = end;\n    const ranges = [];\n\n    if (start !== end) {\n      if (start < dateRender[0].getTime()) {\n        start = dateRender[0].getTime();\n      }\n\n      if (end > dateRender[dateRender.length - 1].getTime()) {\n        end = dateRender[dateRender.length - 1].getTime();\n      }\n\n      let cStart = start;\n\n      for (let level = 0; level < this.slots.length; level++) {\n        let slot = this.slots[level];\n\n        if (this.parent.currentView === 'WorkWeek' || this.parent.currentView === 'TimelineWorkWeek' || this.parent.activeViewOptions.group.byDate || this.parent.activeViewOptions.showWeekend) {\n          const slotDates = [];\n\n          for (const s of slot) {\n            slotDates.push(new Date(s));\n          }\n\n          const renderedDates = this.getRenderedDates(slotDates);\n\n          if (!isNullOrUndefined(renderedDates) && renderedDates.length > 0) {\n            slot = [];\n\n            for (const date of renderedDates) {\n              slot.push(date.getTime());\n            }\n          }\n        }\n\n        if (typeof slot === 'number') {\n          const temp = slot;\n          slot = [];\n          slot.push(temp);\n        }\n\n        const firstSlot = slot[0];\n        cStart = cStart <= firstSlot && end >= firstSlot ? firstSlot : cStart;\n\n        if (cStart > end || firstSlot > end) {\n          break;\n        }\n\n        if (!this.parent.activeViewOptions.group.byDate && this.parent.activeViewOptions.showWeekend && this.parent.currentView !== 'WorkWeek' && this.parent.currentView !== 'TimelineWorkWeek') {\n          const startIndex = slot.indexOf(cStart);\n\n          if (startIndex !== -1) {\n            let endIndex = slot.indexOf(end);\n            const hasBreak = endIndex !== -1;\n            endIndex = hasBreak ? endIndex : slot.length - 1;\n            const count = endIndex - startIndex + 1;\n            const isLeft = slot[startIndex] !== orgStart;\n            const isRight = slot[endIndex] !== orgEnd;\n            ranges.push(this.cloneEventObject(event, slot[startIndex], slot[endIndex], count, isLeft, isRight));\n\n            if (hasBreak) {\n              break;\n            }\n          }\n        } else {\n          if (this.dateInRange(cStart, slot[0], slot[slot.length - 1])) {\n            const availSlot = [];\n\n            for (let i = 0; i < slot.length; i++) {\n              if (this.dateInRange(slot[i], orgStart, orgEnd)) {\n                availSlot.push(slot[i]);\n              }\n            }\n\n            if (availSlot.length > 0) {\n              if (!this.parent.activeViewOptions.group.byDate) {\n                const isLeft = availSlot[0] !== orgStart;\n                const isRight = availSlot[availSlot.length - 1] !== orgEnd;\n                ranges.push(this.cloneEventObject(event, availSlot[0], availSlot[availSlot.length - 1], availSlot.length, isLeft, isRight));\n              } else {\n                for (const slot of availSlot) {\n                  ranges.push(this.cloneEventObject(event, slot, slot, 1, slot !== orgStart, slot !== orgEnd));\n                }\n              }\n            }\n          }\n        }\n      }\n    } else {\n      ranges.push(this.cloneEventObject(event, start, end, 1, false, false));\n    }\n\n    return ranges;\n  }\n\n  cloneEventObject(event, start, end, count, isLeft, isRight) {\n    const fields = this.parent.eventFields;\n    const e = extend({}, event, null, true);\n    const data = {\n      count: count,\n      isLeft: isLeft,\n      isRight: isRight\n    };\n    data[fields.startTime] = event[fields.startTime];\n    data[fields.endTime] = event[fields.endTime];\n    e.data = data;\n    e[fields.startTime] = new Date(start);\n    e[fields.endTime] = new Date(end);\n    return e;\n  }\n\n  dateInRange(date, start, end) {\n    return start <= date && date <= end;\n  }\n\n  getSelectedEventElements(target) {\n    this.removeSelectedAppointmentClass();\n\n    if (this.parent.selectedElements.length <= 0) {\n      this.parent.selectedElements.push(target);\n    } else {\n      const isAlreadySelected = this.parent.selectedElements.filter(element => element.getAttribute('data-guid') === target.getAttribute('data-guid'));\n\n      if (isAlreadySelected.length <= 0) {\n        const elementSelector = 'div[data-guid=\"' + target.getAttribute('data-guid') + '\"]';\n        const focusElements = [].slice.call(this.parent.element.querySelectorAll(elementSelector));\n\n        for (const element of focusElements) {\n          this.parent.selectedElements.push(element);\n        }\n      } else {\n        const selectedElements = this.parent.selectedElements.filter(element => element.getAttribute('data-guid') !== target.getAttribute('data-guid'));\n        this.parent.selectedElements = selectedElements;\n      }\n    }\n\n    if (target && this.parent.selectedElements.length > 0) {\n      this.addSelectedAppointments(this.parent.selectedElements);\n    }\n\n    return this.parent.selectedElements;\n  }\n\n  getSelectedEvents() {\n    const eventSelect = [];\n    const elementSelect = [];\n    const selectAppointments = [].slice.call(this.parent.element.querySelectorAll('.' + APPOINTMENT_BORDER));\n    selectAppointments.filter(element => {\n      const isAlreadyAdded = eventSelect.filter(event => {\n        return event.Guid === element.getAttribute('data-guid');\n      });\n\n      if (isAlreadyAdded.length === 0) {\n        eventSelect.push(this.getEventByGuid(element.getAttribute('data-guid')));\n      }\n\n      elementSelect.push(element);\n    });\n    return {\n      event: eventSelect.length > 1 ? eventSelect : eventSelect[0],\n      element: elementSelect.length > 1 ? elementSelect : elementSelect[0]\n    };\n  }\n\n  removeSelectedAppointmentClass() {\n    const selectedAppointments = this.getSelectedAppointments();\n\n    for (const appointment of selectedAppointments) {\n      appointment.setAttribute('aria-pressed', 'false');\n    }\n\n    removeClass(selectedAppointments, APPOINTMENT_BORDER);\n\n    if (this.parent.currentView === 'Agenda' || this.parent.currentView === 'MonthAgenda') {\n      removeClass(selectedAppointments, AGENDA_SELECTED_CELL);\n    }\n  }\n\n  addSelectedAppointments(cells) {\n    for (const cell of cells) {\n      cell.setAttribute('aria-pressed', 'true');\n    }\n\n    if (this.parent.currentView !== 'MonthAgenda') {\n      this.parent.removeSelectedClass();\n    }\n\n    addClass(cells, APPOINTMENT_BORDER);\n\n    if (cells.length > 0) {\n      cells[cells.length - 1].focus();\n    }\n  }\n\n  getSelectedAppointments() {\n    return [].slice.call(this.parent.element.querySelectorAll('.' + APPOINTMENT_BORDER + ',.' + APPOINTMENT_CLASS + ':focus'));\n  }\n\n  focusElement(isFocused) {\n    if (this.parent.eventWindow.dialogObject && this.parent.eventWindow.dialogObject.visible) {\n      return;\n    }\n\n    const activeEle = document.activeElement;\n    const selectedCell = this.parent.getSelectedElements();\n\n    if (selectedCell.length > 0 && (activeEle && (this.parent.element.contains(activeEle) || selectedCell.indexOf(activeEle) !== -1) || isFocused)) {\n      if (this.parent.keyboardInteractionModule) {\n        const target = !isNullOrUndefined(this.parent.activeCellsData) && this.parent.activeCellsData.element || selectedCell[selectedCell.length - 1];\n        this.parent.keyboardInteractionModule.selectCells(target instanceof Array, target);\n      }\n\n      return;\n    }\n\n    const selectedAppointments = this.getSelectedAppointments();\n\n    if (selectedAppointments.length > 0) {\n      selectedAppointments[selectedAppointments.length - 1].focus();\n      return;\n    }\n  }\n\n  selectWorkCellByTime(eventsData) {\n    let target;\n\n    if (this.parent.currentView === 'Agenda' || this.parent.currentView === 'MonthAgenda') {\n      return target;\n    }\n\n    if (eventsData.length > 0) {\n      const selectedObject = eventsData[eventsData.length - 1];\n      const eventStartTime = selectedObject[this.parent.eventFields.startTime];\n      let nearestTime = new Date(+eventStartTime).setMinutes(0, 0, 0);\n      const isAllDay = this.isAllDayAppointment(selectedObject);\n\n      if (this.parent.currentView === 'Month' || isAllDay) {\n        nearestTime = new Date(+eventStartTime).setHours(0, 0, 0, 0);\n      }\n\n      let targetArea;\n\n      if (isAllDay && ['Day', 'Week', 'WorkWeek'].indexOf(this.parent.currentView) !== -1) {\n        targetArea = this.parent.getAllDayRow();\n      } else {\n        targetArea = this.parent.getContentTable();\n      }\n\n      let queryString = '[data-date=\"' + new Date(nearestTime).getTime() + '\"]';\n\n      if (this.parent.activeViewOptions.group.resources.length > 0) {\n        queryString += '[data-group-index=\"' + this.getGroupIndexFromEvent(selectedObject) + '\"]';\n      }\n\n      target = targetArea.querySelector(queryString);\n\n      if (target) {\n        this.parent.activeCellsData = this.parent.getCellDetails(target);\n\n        if (this.parent.keyboardInteractionModule) {\n          this.parent.keyboardInteractionModule.selectCells(false, target);\n        }\n\n        return target;\n      }\n    }\n\n    return target;\n  }\n\n  getGroupIndexFromEvent(eventData) {\n    let levelIndex;\n    let resource;\n    let levelName;\n    let idField;\n\n    for (let i = this.parent.resourceBase.resourceCollection.length - 1; i >= 0; i--) {\n      const resourceData = eventData[this.parent.resourceBase.resourceCollection[i].field];\n\n      if (!isNullOrUndefined(resourceData)) {\n        resource = this.parent.resourceBase.resourceCollection[i];\n        levelIndex = i;\n        levelName = resource.name;\n        idField = resource.field;\n        break;\n      }\n    }\n\n    if (isNullOrUndefined(levelName) && isNullOrUndefined(levelIndex)) {\n      levelName = this.parent.resourceCollection.slice(-1)[0].name;\n      levelIndex = this.parent.resourceCollection.length - 1;\n      idField = this.parent.resourceCollection.slice(-1)[0].field;\n      resource = this.parent.resourceCollection.filter((e, index) => {\n        if (e.name === levelName) {\n          levelIndex = index;\n          return e;\n        }\n\n        return null;\n      })[0];\n    }\n\n    const id = eventData[idField] instanceof Array ? eventData[idField][0] : eventData[idField];\n\n    if (levelIndex > 0) {\n      const parentField = this.parent.resourceCollection[levelIndex - 1].field;\n      return this.parent.resourceBase.getIndexFromResourceId(id, levelName, resource, eventData, parentField);\n    } else {\n      return this.parent.resourceBase.getIndexFromResourceId(id, levelName, resource);\n    }\n  }\n\n  isAllDayAppointment(event) {\n    const fieldMapping = this.parent.eventFields;\n    const isAllDay = event[fieldMapping.isAllDay];\n    const isFullDay = (getUniversalTime(event[fieldMapping.endTime]) - getUniversalTime(event[fieldMapping.startTime])) / MS_PER_DAY >= 1;\n    return isAllDay || this.parent.eventSettings.spannedEventPlacement !== 'TimeSlot' && isFullDay ? true : false;\n  }\n\n  addEventListener() {\n    this.parent.on(documentClick, this.appointmentBorderRemove, this);\n  }\n\n  removeEventListener() {\n    this.parent.off(documentClick, this.appointmentBorderRemove);\n  }\n\n  appointmentBorderRemove(event) {\n    const element = event.event.target;\n\n    if (closest(element, '.' + APPOINTMENT_CLASS)) {\n      if (this.parent.currentView !== 'MonthAgenda') {\n        this.parent.removeSelectedClass();\n      }\n    } else if (!closest(element, '.' + POPUP_OPEN)) {\n      this.removeSelectedAppointmentClass();\n      this.parent.selectedElements = [];\n    }\n  }\n\n  wireAppointmentEvents(element, event, isPreventCrud = false) {\n    const isReadOnly = !isNullOrUndefined(event) ? event[this.parent.eventFields.isReadonly] : false;\n    EventHandler.add(element, 'click', this.eventClick, this);\n\n    if (!this.parent.isAdaptive && !this.parent.activeViewOptions.readonly && !isReadOnly) {\n      EventHandler.add(element, 'touchstart', this.eventTouchClick, this);\n      EventHandler.add(element, 'dblclick', this.eventDoubleClick, this);\n    }\n\n    if (!this.parent.activeViewOptions.readonly && !isReadOnly && !isPreventCrud) {\n      if (this.parent.resizeModule) {\n        this.parent.resizeModule.wireResizeEvent(element);\n      }\n\n      if (this.parent.dragAndDropModule) {\n        this.parent.dragAndDropModule.wireDragEvent(element);\n      }\n    }\n  }\n\n  eventTouchClick(e) {\n    setTimeout(() => this.isDoubleTapped = false, 250);\n    e.preventDefault();\n\n    if (this.isDoubleTapped) {\n      this.eventDoubleClick(e);\n    } else if (!this.isDoubleTapped) {\n      this.isDoubleTapped = true;\n      this.eventClick(e);\n    }\n  }\n\n  renderResizeHandler(element, spanEvent, isReadOnly) {\n    if (!this.parent.resizeModule || !this.parent.allowResizing || this.parent.activeViewOptions.readonly || isReadOnly) {\n      return;\n    }\n\n    for (const resizeEdge of Object.keys(spanEvent)) {\n      const resizeHandler = createElement('div', {\n        className: EVENT_RESIZE_CLASS\n      });\n\n      switch (resizeEdge) {\n        case 'isLeft':\n          if (!spanEvent.isLeft) {\n            resizeHandler.appendChild(createElement('div', {\n              className: 'e-left-right-resize'\n            }));\n            addClass([resizeHandler], this.parent.enableRtl ? RIGHT_RESIZE_HANDLER : LEFT_RESIZE_HANDLER);\n            prepend([resizeHandler], element);\n          }\n\n          break;\n\n        case 'isRight':\n          if (!spanEvent.isRight) {\n            resizeHandler.appendChild(createElement('div', {\n              className: 'e-left-right-resize'\n            }));\n            addClass([resizeHandler], this.parent.enableRtl ? LEFT_RESIZE_HANDLER : RIGHT_RESIZE_HANDLER);\n            append([resizeHandler], element);\n          }\n\n          break;\n\n        case 'isTop':\n          if (!spanEvent.isTop) {\n            resizeHandler.appendChild(createElement('div', {\n              className: 'e-top-bottom-resize'\n            }));\n            addClass([resizeHandler], TOP_RESIZE_HANDLER);\n            prepend([resizeHandler], element);\n          }\n\n          break;\n\n        case 'isBottom':\n          if (!spanEvent.isBottom) {\n            resizeHandler.appendChild(createElement('div', {\n              className: 'e-top-bottom-resize'\n            }));\n            addClass([resizeHandler], BOTTOM_RESIZE_HANDLER);\n            append([resizeHandler], element);\n          }\n\n          break;\n      }\n    }\n  }\n\n  eventClick(eventData) {\n    const target = eventData.target;\n\n    if (target.classList.contains(DRAG_CLONE_CLASS) || target.classList.contains(RESIZE_CLONE_CLASS) || target.classList.contains(INLINE_SUBJECT_CLASS)) {\n      return;\n    }\n\n    if ((eventData.ctrlKey || eventData.metaKey) && eventData.which === 1 && this.parent.keyboardInteractionModule) {\n      this.parent.quickPopup.quickPopup.hide();\n      this.parent.selectedElements = [].slice.call(this.parent.element.querySelectorAll('.' + APPOINTMENT_BORDER));\n      const target = closest(eventData.target, '.' + APPOINTMENT_CLASS);\n      this.getSelectedEventElements(target);\n      this.activeEventData(eventData, false);\n      const selectArgs = {\n        data: this.parent.activeEventData.event,\n        element: this.parent.activeEventData.element,\n        event: eventData,\n        requestType: 'eventSelect'\n      };\n      this.parent.trigger(select, selectArgs);\n      const args = extend(this.parent.activeEventData, {\n        cancel: false,\n        originalEvent: eventData\n      });\n      this.parent.trigger(eventClick, args);\n    } else {\n      this.removeSelectedAppointmentClass();\n      this.activeEventData(eventData, true);\n      const selectEventArgs = {\n        data: this.parent.activeEventData.event,\n        element: this.parent.activeEventData.element,\n        event: eventData,\n        requestType: 'eventSelect'\n      };\n      this.parent.trigger(select, selectEventArgs);\n      const args = extend(this.parent.activeEventData, {\n        cancel: false,\n        originalEvent: eventData\n      });\n      this.parent.trigger(eventClick, args, eventClickArgs => {\n        if (eventClickArgs.cancel) {\n          this.removeSelectedAppointmentClass();\n          this.parent.selectedElements = [];\n\n          if (this.parent.quickPopup) {\n            this.parent.quickPopup.quickPopupHide();\n          }\n        } else {\n          if (this.parent.currentView === 'Agenda' || this.parent.currentView === 'MonthAgenda') {\n            addClass([this.parent.activeEventData.element], AGENDA_SELECTED_CELL);\n          }\n\n          if (this.parent.allowInline) {\n            const inlineArgs = {\n              data: eventClickArgs.event,\n              element: eventClickArgs.element,\n              type: 'Event'\n            };\n            this.parent.notify(inlineClick, inlineArgs);\n          } else {\n            this.parent.notify(eventClick, eventClickArgs);\n          }\n        }\n      });\n    }\n  }\n\n  eventDoubleClick(e) {\n    if (this.parent.quickPopup) {\n      this.parent.quickPopup.quickPopupHide(true);\n    }\n\n    if (e.type === 'touchstart') {\n      this.activeEventData(e, true);\n    }\n\n    this.removeSelectedAppointmentClass();\n    this.parent.selectedElements = [];\n\n    if (this.parent.activeEventData.element.classList.contains(INLINE_APPOINTMENT_CLASS) || this.parent.activeEventData.element.querySelector('.' + INLINE_SUBJECT_CLASS)) {\n      return;\n    }\n\n    if (!isNullOrUndefined(this.parent.activeEventData.event) && isNullOrUndefined(this.parent.activeEventData.event[this.parent.eventFields.recurrenceID])) {\n      this.parent.eventWindow.openEditor(this.parent.activeEventData.event, 'Save');\n    } else {\n      this.parent.currentAction = 'EditOccurrence';\n      this.parent.quickPopup.openRecurrenceAlert();\n    }\n  }\n\n  getEventByGuid(guid) {\n    return this.parent.eventsProcessed.filter(data => data.Guid === guid)[0];\n  }\n\n  getEventById(id) {\n    return this.parent.eventsData.filter(data => data[this.parent.eventFields.id] === id)[0];\n  }\n\n  generateGuid() {\n    return 'xyxxxxyx-xxxy-yxxx-xyxx-xxyxxxxyyxxx'.replace(/[xy]/g, c => {\n      const r = Math.random() * 16 | 0;\n      const v = c === 'x' ? r : r & 0x3 | 0x8;\n      return v.toString(16);\n    });\n  }\n\n  getEventIDType() {\n    if (this.parent.eventsData.length !== 0) {\n      return typeof this.parent.eventsData[0][this.parent.eventFields.id];\n    }\n\n    if (this.parent.blockData.length !== 0) {\n      return typeof this.parent.blockData[0][this.parent.eventFields.id];\n    }\n\n    return 'string';\n  }\n\n  getEventMaxID(resourceId) {\n    if (this.parent.eventsData.length < 1 && this.parent.blockData.length < 1) {\n      return 1;\n    }\n\n    let eventId;\n    const idType = this.getEventIDType();\n\n    if (idType === 'string') {\n      eventId = this.generateGuid();\n    }\n\n    if (idType === 'number') {\n      const datas = this.parent.eventsData.concat(this.parent.blockData);\n      let maxId = Math.max(...datas.map(event => event[this.parent.eventFields.id]));\n      maxId = isNullOrUndefined(resourceId) ? maxId : maxId + resourceId;\n      eventId = maxId + 1;\n    }\n\n    return eventId;\n  }\n\n  activeEventData(eventData, isMultiple) {\n    const target = closest(eventData.target, '.' + APPOINTMENT_CLASS);\n    const guid = target.getAttribute('data-guid');\n\n    if (isMultiple) {\n      this.addSelectedAppointments([].slice.call(this.parent.element.querySelectorAll('div[data-guid=\"' + guid + '\"]')));\n      target.focus();\n    }\n\n    let eventObject = this.getEventByGuid(guid);\n\n    if (eventObject && eventObject.isSpanned) {\n      eventObject = this.parent.eventsData.filter(obj => obj[this.parent.eventFields.id] === eventObject[this.parent.eventFields.id])[0];\n    }\n\n    this.parent.activeEventData = {\n      event: eventObject,\n      element: target\n    };\n  }\n\n  generateOccurrence(event, viewDate, oldTimezone, isMaxCount) {\n    const startDate = event[this.parent.eventFields.startTime];\n    const endDate = event[this.parent.eventFields.endTime];\n    const eventRule = event[this.parent.eventFields.recurrenceRule];\n    const duration = endDate.getTime() - startDate.getTime();\n    viewDate = new Date((viewDate || this.parent.activeView.startDate()).getTime() - duration);\n    const exception = event[this.parent.eventFields.recurrenceException];\n    let maxCount;\n\n    if (this.parent.currentView !== 'Agenda' && isMaxCount) {\n      maxCount = getDateCount(viewDate, this.parent.activeView.endDate()) + 1;\n    }\n\n    const newTimezone = this.parent.timezone || this.parent.tzModule.getLocalTimezoneName();\n    const firstDay = this.parent.activeViewOptions.firstDayOfWeek;\n    const calendarMode = this.parent.calendarMode;\n    const dates = generate(startDate, eventRule, exception, firstDay, maxCount, viewDate, calendarMode, oldTimezone, newTimezone);\n\n    if (this.parent.currentView === 'Agenda' && eventRule.indexOf('COUNT') === -1 && eventRule.indexOf('UNTIL') === -1) {\n      if (isNullOrUndefined(event.generatedDates)) {\n        event.generatedDates = {\n          start: new Date(dates[0]),\n          end: new Date(dates[dates.length - 1])\n        };\n      } else {\n        if (dates[0] < event.generatedDates.start.getTime()) {\n          event.generatedDates.start = new Date(dates[0]);\n        }\n\n        if (dates[dates.length - 1] > event.generatedDates.end.getTime()) {\n          event.generatedDates.end = new Date(dates[dates.length - 1]);\n        }\n      }\n    }\n\n    const occurrenceCollection = [];\n\n    for (let date of dates) {\n      const clonedObject = extend({}, event, null, true);\n      date = this.getDSTAdjustedTime(date, clonedObject);\n      clonedObject[this.parent.eventFields.startTime] = new Date(date);\n      clonedObject[this.parent.eventFields.endTime] = new Date(new Date(date).setMilliseconds(duration));\n      clonedObject[this.parent.eventFields.recurrenceID] = clonedObject[this.parent.eventFields.id];\n      delete clonedObject[this.parent.eventFields.recurrenceException];\n      delete clonedObject[this.parent.eventFields.followingID];\n      clonedObject.Guid = this.generateGuid();\n      occurrenceCollection.push(clonedObject);\n    }\n\n    return occurrenceCollection;\n  }\n\n  getDSTAdjustedTime(date, event) {\n    let occurDate = date;\n\n    if (this.parent.timezone && (event[this.parent.eventFields.startTimezone] || event[this.parent.eventFields.endTimezone])) {\n      const eventOffset = this.getDSTDiff(event[this.parent.eventFields.startTime], new Date(date), event[this.parent.eventFields.startTimezone]);\n      const schOffset = this.getDSTDiff(event[this.parent.eventFields.startTime], new Date(date), this.parent.timezone);\n      occurDate = new Date(date).getTime() - (eventOffset - schOffset) * 60000;\n    }\n\n    return occurDate;\n  }\n\n  getDSTDiff(startDate, occurDate, timezone) {\n    const startOffset = this.parent.tzModule.offset(new Date(startDate), timezone);\n    const occurOffset = this.parent.tzModule.offset(new Date(occurDate), timezone);\n    return startOffset - occurOffset;\n  }\n\n  getParentEvent(eventObj, isParent = false) {\n    let parentEvent;\n\n    do {\n      eventObj = this.getFollowingEvent(eventObj);\n\n      if (eventObj) {\n        parentEvent = extend({}, eventObj, null, true);\n      }\n    } while (eventObj && isParent);\n\n    if (isParent && parentEvent) {\n      const collection = this.getEventCollections(parentEvent);\n      let followObj = collection.follow.slice(-1)[0];\n\n      if (collection.occurrence.length > 0 && !parentEvent[this.parent.eventFields.recurrenceException]) {\n        followObj = collection.occurrence.slice(-1)[0];\n      }\n\n      if (followObj) {\n        parentEvent[this.parent.eventFields.recurrenceRule] = followObj[this.parent.eventFields.recurrenceRule];\n      }\n    }\n\n    return parentEvent;\n  }\n\n  getEventCollections(parentObj, childObj) {\n    const followingCollection = [];\n    let occurrenceCollection = [];\n    let followingEvent = parentObj;\n\n    do {\n      followingEvent = this.getFollowingEvent(followingEvent, true);\n\n      if (followingEvent) {\n        followingCollection.push(followingEvent);\n      }\n\n      occurrenceCollection = occurrenceCollection.concat(this.getOccurrenceEvent(followingEvent || parentObj));\n    } while (followingEvent);\n\n    let collections = {};\n\n    if (childObj) {\n      const fields = this.parent.eventFields;\n      collections = {\n        follow: followingCollection.filter(eventData => eventData[fields.startTime] >= childObj[fields.startTime]),\n        occurrence: occurrenceCollection.filter(eventData => eventData[fields.startTime] >= childObj[fields.startTime])\n      };\n    } else {\n      collections = {\n        follow: followingCollection,\n        occurrence: occurrenceCollection\n      };\n    }\n\n    return collections;\n  }\n\n  getFollowingEvent(parentObj, isReverse) {\n    const fields = this.parent.eventFields;\n    let fieldValue;\n\n    if (isReverse) {\n      fieldValue = parentObj[fields.id];\n    } else {\n      fieldValue = parentObj[fields.recurrenceID] || parentObj[fields.followingID];\n    }\n\n    const parentApp = this.parent.eventsData.filter(data => data[isReverse ? fields.followingID : fields.id] === fieldValue);\n    return parentApp.shift();\n  }\n\n  isFollowingEvent(parentObj, childObj) {\n    const parentStart = parentObj[this.parent.eventFields.startTime];\n    const childStart = childObj[this.parent.eventFields.startTime];\n    return parentStart.getHours() === childStart.getHours() && parentStart.getMinutes() === childStart.getMinutes() && parentStart.getSeconds() === childStart.getSeconds();\n  }\n\n  getOccurrenceEvent(eventObj, isGuid = false, isFollowing = false) {\n    const idField = isGuid ? 'Guid' : isFollowing ? this.parent.eventFields.followingID : this.parent.eventFields.recurrenceID;\n    const fieldKey = isGuid ? 'Guid' : this.parent.eventFields.id;\n    const dataSource = isGuid ? this.parent.eventsProcessed : this.parent.eventsData;\n    return dataSource.filter(data => data[idField] === eventObj[fieldKey]);\n  }\n\n  getOccurrencesByID(id) {\n    const fields = this.parent.eventFields;\n    let occurrenceCollection = [];\n    const parentObject = this.parent.eventsData.filter(obj => obj[fields.id] === id);\n\n    for (const event of parentObject) {\n      if (!isNullOrUndefined(event[fields.recurrenceRule])) {\n        occurrenceCollection = occurrenceCollection.concat(this.generateOccurrence(event));\n      }\n    }\n\n    return occurrenceCollection;\n  }\n\n  getOccurrencesByRange(startTime, endTime) {\n    const fields = this.parent.eventFields;\n    let occurrenceCollection = [];\n\n    for (const event of this.parent.eventsData) {\n      if (!isNullOrUndefined(event[fields.recurrenceRule])) {\n        occurrenceCollection = occurrenceCollection.concat(this.generateOccurrence(event));\n      }\n    }\n\n    const filter = occurrenceCollection.filter(obj => obj[fields.startTime] >= startTime && obj[fields.endTime] <= endTime && !isNullOrUndefined(obj[fields.recurrenceID]));\n    return filter;\n  }\n\n  getDeletedOccurrences(recurrenceData) {\n    const fields = this.parent.eventFields;\n    let parentObject;\n    const deletedOccurrences = [];\n\n    if (typeof recurrenceData === 'string' || typeof recurrenceData === 'number') {\n      parentObject = this.parent.eventsData.filter(obj => obj[fields.id] === recurrenceData)[0];\n    } else {\n      parentObject = extend({}, recurrenceData, null, true);\n    }\n\n    if (parentObject[fields.recurrenceException]) {\n      const exDateString = parentObject[fields.recurrenceException].split(',');\n\n      for (let i = 0, len = exDateString.length; i < len; i++) {\n        const edited = this.parent.eventsData.filter(eventObj => eventObj[fields.recurrenceID] === parentObject[fields.id] && eventObj[fields.recurrenceException] === exDateString[i]);\n\n        if (edited.length === 0) {\n          const exDate = getDateFromRecurrenceDateString(exDateString[i]);\n          const childObject = extend({}, recurrenceData, null, true);\n          childObject[fields.recurrenceID] = parentObject[fields.id];\n          delete childObject[fields.followingID];\n          childObject[fields.recurrenceException] = exDateString[i];\n          const startDate = new Date(exDate.getTime());\n          const time = parentObject[fields.endTime].getTime() - parentObject[fields.startTime].getTime();\n          const endDate = new Date(startDate.getTime());\n          endDate.setMilliseconds(time);\n          childObject[fields.startTime] = new Date(startDate.getTime());\n          childObject[fields.endTime] = new Date(endDate.getTime());\n          deletedOccurrences.push(childObject);\n        }\n      }\n    }\n\n    return deletedOccurrences;\n  }\n\n  applyResourceColor(element, data, type, index, alpha) {\n    if (!this.parent.resourceBase) {\n      return;\n    }\n\n    const alphaColor = (color, alpha) => {\n      color = color.replace('#', '');\n      const r = parseInt(color.substring(0, color.length / 3), 16);\n      const g = parseInt(color.substring(color.length / 3, 2 * color.length / 3), 16);\n      const b = parseInt(color.substring(2 * color.length / 3, 3 * color.length / 3), 16);\n      return `rgba(${r}, ${g}, ${b}, ${alpha})`;\n    }; // index refers groupOrder\n\n\n    const color = this.parent.resourceBase.getResourceColor(data, index);\n\n    if (color) {\n      element.style[type] = !isNullOrUndefined(alpha) ? alphaColor(color, alpha) : color;\n    }\n  }\n\n  createBlockAppointmentElement(record, resIndex) {\n    const eventSubject = record[this.parent.eventFields.subject] || this.parent.eventSettings.fields.subject.default;\n    const appointmentWrapper = createElement('div', {\n      className: BLOCK_APPOINTMENT_CLASS,\n      attrs: {\n        'data-id': 'Appointment_' + record[this.parent.eventFields.id],\n        'aria-disabled': 'true',\n        'aria-pressed': 'false'\n      }\n    });\n    let templateElement;\n\n    if (!isNullOrUndefined(this.parent.activeViewOptions.eventTemplate)) {\n      const scheduleId = this.parent.element.id + '_';\n      const viewName = this.parent.activeViewOptions.eventTemplateName;\n      const templateId = scheduleId + viewName + 'eventTemplate';\n      const templateName = 'eventTemplate' + (this.parent.activeViewOptions.group.resources.length > 0 && this.parent.currentView.indexOf('Year') === -1 ? '_' + resIndex : '');\n      templateElement = this.parent.getAppointmentTemplate()(record, this.parent, templateName, templateId, false);\n    } else {\n      const appointmentSubject = createElement('div', {\n        className: SUBJECT_CLASS,\n        innerHTML: eventSubject\n      });\n      templateElement = [appointmentSubject];\n    }\n\n    append(templateElement, appointmentWrapper);\n    this.setWrapperAttributes(appointmentWrapper, resIndex);\n    return appointmentWrapper;\n  }\n\n  setWrapperAttributes(appointmentWrapper, resIndex) {\n    if (!isNullOrUndefined(this.cssClass)) {\n      addClass([appointmentWrapper], this.cssClass);\n    }\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      appointmentWrapper.setAttribute('data-group-index', resIndex.toString());\n    }\n  }\n\n  getReadonlyAttribute(event) {\n    return (event[this.parent.eventFields.isReadonly] || this.parent.readonly).toString();\n  }\n\n  isBlockRange(eventData) {\n    const eventCollection = eventData instanceof Array ? eventData : [eventData];\n    let isBlockAlert = false;\n    const fields = this.parent.eventFields;\n\n    for (const event of eventCollection) {\n      let dataCol = [];\n\n      if (!isNullOrUndefined(event[fields.recurrenceRule]) && (isNullOrUndefined(event[fields.recurrenceID]) || event[fields.id] === event[fields.recurrenceID])) {\n        dataCol = this.generateOccurrence(event);\n      } else {\n        dataCol.push(event);\n      }\n\n      for (const data of dataCol) {\n        const filterBlockEvents = this.filterBlockEvents(data);\n\n        if (filterBlockEvents.length > 0) {\n          isBlockAlert = true;\n          break;\n        }\n      }\n    }\n\n    this.parent.uiStateValues.isBlock = isBlockAlert;\n    return isBlockAlert;\n  }\n\n  getFilterEventsList(dataSource, query) {\n    return new DataManager(dataSource).executeLocal(new Query().where(query));\n  }\n\n  getSeriesEvents(parentEvent, startTime) {\n    const fields = this.parent.eventFields;\n    startTime = isNullOrUndefined(startTime) ? parentEvent[fields.startTime] : startTime;\n    let deleteFutureEditEvents;\n    let futureEvents;\n    const deleteFutureEditEventList = [];\n    let delId = parentEvent[fields.id];\n    let followingId = parentEvent[fields.followingID];\n    let deleteFutureEvent;\n    const startTimeQuery = this.parent.currentAction === 'EditSeries' ? 'greaterthan' : 'greaterthanorequal';\n\n    do {\n      deleteFutureEvent = new Predicate(fields.followingID, 'equal', delId).and(new Predicate(fields.startTime, startTimeQuery, startTime));\n      futureEvents = this.getFilterEventsList(this.parent.eventsData, deleteFutureEvent);\n      deleteFutureEditEvents = futureEvents.slice(-1)[0];\n\n      if (!isNullOrUndefined(deleteFutureEditEvents) && deleteFutureEditEvents[fields.id] !== followingId) {\n        deleteFutureEditEventList.push(deleteFutureEditEvents);\n        delId = deleteFutureEditEvents[fields.id];\n        followingId = deleteFutureEditEvents[fields.followingID];\n      } else {\n        followingId = null;\n      }\n    } while (futureEvents.length === 1 && !isNullOrUndefined(deleteFutureEditEvents[fields.followingID]));\n\n    return deleteFutureEditEventList;\n  }\n\n  getEditedOccurrences(deleteFutureEditEventList, startTime) {\n    const fields = this.parent.eventFields;\n    let deleteRecurrenceEventList = [];\n    let delEditedEvents;\n\n    for (const event of deleteFutureEditEventList) {\n      let delEventQuery = new Predicate(fields.recurrenceID, 'equal', event[fields.id]).or(new Predicate(fields.recurrenceID, 'equal', event[fields.followingID]).and(new Predicate(fields.recurrenceID, 'notequal', undefined)).and(new Predicate(fields.recurrenceID, 'notequal', null)));\n\n      if (this.parent.currentAction === 'EditFollowingEvents' || this.parent.currentAction === 'DeleteFollowingEvents') {\n        delEventQuery = delEventQuery.and(new Predicate(fields.startTime, 'greaterthanorequal', startTime));\n      }\n\n      delEditedEvents = this.getFilterEventsList(this.parent.eventsData, delEventQuery);\n      deleteRecurrenceEventList = deleteRecurrenceEventList.concat(delEditedEvents);\n    }\n\n    return deleteRecurrenceEventList;\n  }\n\n  getRenderedDates(dateRender) {\n    let firstDate = 0;\n    let lastDate = dateRender.length;\n    let filteredDates;\n\n    if (dateRender[0] < this.parent.minDate && dateRender[dateRender.length - 1] > this.parent.maxDate) {\n      for (let i = 0; i < dateRender.length; i++) {\n        if (resetTime(dateRender[i]).getTime() === resetTime(new Date(this.parent.minDate)).getTime()) {\n          firstDate = i;\n        }\n\n        if (resetTime(dateRender[i]).getTime() === resetTime(new Date(this.parent.maxDate)).getTime()) {\n          lastDate = i;\n        }\n      }\n\n      filteredDates = dateRender.filter(date => date >= dateRender[firstDate] && date <= dateRender[lastDate]);\n    }\n\n    return filteredDates;\n  }\n\n  isValidEvent(eventObj, start, end, schedule) {\n    const isHourRange = end.getTime() > schedule.startHour.getTime() && start.getTime() < schedule.endHour.getTime();\n    const isSameRange = schedule.startHour.getTime() <= start.getTime() && eventObj[this.parent.eventFields.startTime].getTime() >= schedule.startHour.getTime() && eventObj[this.parent.eventFields.endTime].getTime() < schedule.endHour.getTime() && start.getTime() === end.getTime();\n    return isHourRange || isSameRange;\n  }\n\n  allDayExpandScroll(dateHeader) {\n    let indentHeight = 0;\n    const headerRows = [].slice.call(this.parent.element.querySelectorAll('.' + HEADER_ROW_CLASS));\n    headerRows.forEach(element => {\n      const tdEle = [].slice.call(element.children);\n      tdEle.forEach(ele => {\n        ele.style.top = indentHeight + 'px';\n      });\n      indentHeight += element.offsetHeight;\n    });\n    indentHeight = dateHeader.offsetHeight - indentHeight;\n    this.parent.element.querySelector('.' + ALLDAY_CELLS_CLASS).style.height = indentHeight / 12 + 'em';\n\n    if (this.parent.uiStateValues.expand) {\n      addClass([dateHeader], ALLDAY_APPOINTMENT_SCROLL);\n    } else {\n      removeClass([dateHeader], ALLDAY_APPOINTMENT_SCROLL);\n    }\n  }\n\n  updateEventMinimumDuration(startEndHours, startTime, endTime) {\n    if (startTime.getTime() < endTime.getTime()) {\n      const eventDuration = (getUniversalTime(endTime) - getUniversalTime(startTime)) / MS_PER_MINUTE;\n\n      if (eventDuration < this.parent.eventSettings.minimumEventDuration) {\n        const tempEnd = new Date(startTime);\n        tempEnd.setMinutes(tempEnd.getMinutes() + this.parent.eventSettings.minimumEventDuration);\n        endTime = tempEnd;\n\n        if (endTime.getTime() > startEndHours.endHour.getTime()) {\n          const tempStart = new Date(startEndHours.endHour.getTime());\n          tempStart.setMinutes(tempStart.getMinutes() - this.parent.eventSettings.minimumEventDuration);\n          startTime = tempStart;\n          endTime = startEndHours.endHour;\n        }\n      }\n    }\n\n    return {\n      startDate: startTime,\n      endDate: endTime\n    };\n  }\n\n  unWireEvents() {\n    const appElements = [].slice.call(this.parent.element.querySelectorAll('.' + APPOINTMENT_CLASS));\n\n    for (const element of appElements) {\n      EventHandler.clearEvents(element);\n    }\n  }\n\n  destroy() {\n    this.unWireEvents();\n    this.parent = null;\n  }\n\n}\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\n/**\n * Vertical view appointment rendering\n */\n\n\nclass VerticalEvent extends EventBase {\n  constructor(parent) {\n    super(parent);\n    this.dateRender = [];\n    this.renderedEvents = [];\n    this.renderedAllDayEvents = [];\n    this.overlapEvents = [];\n    this.moreEvents = [];\n    this.overlapList = [];\n    this.allDayEvents = [];\n    this.slotCount = this.parent.activeViewOptions.timeScale.slotCount;\n    this.interval = this.parent.activeViewOptions.timeScale.interval;\n    this.allDayLevel = 0;\n    this.startHour = this.parent.activeView.getStartHour();\n    this.endHour = this.parent.activeView.getEndHour();\n    this.element = this.parent.activeView.getPanel();\n    this.fields = this.parent.eventFields;\n    this.animation = new Animation({\n      progress: this.animationUiUpdate.bind(this)\n    });\n    this.addEventListener();\n  }\n\n  renderAppointments() {\n    if (isNullOrUndefined(this.parent)) {\n      return;\n    }\n\n    if (this.parent.dragAndDropModule) {\n      this.parent.dragAndDropModule.setDragArea();\n    }\n\n    const wrapperElements = [].slice.call(this.parent.element.querySelectorAll('.' + BLOCK_APPOINTMENT_CLASS + ',.' + APPOINTMENT_CLASS + ',.' + ROW_COUNT_WRAPPER_CLASS));\n    const isDragging = this.parent.crudModule && this.parent.crudModule.crudObj.isCrudAction ? true : false;\n\n    for (const wrapper of wrapperElements) {\n      if (isDragging && !(wrapper.classList.contains(ALLDAY_APPOINTMENT_CLASS) || wrapper.classList.contains(ROW_COUNT_WRAPPER_CLASS))) {\n        const groupIndex = parseInt(wrapper.getAttribute('data-group-index'), 10);\n\n        for (let j = 0, len = this.parent.crudModule.crudObj.sourceEvent.length; j < len; j++) {\n          if (groupIndex === this.parent.crudModule.crudObj.sourceEvent[j].groupIndex || groupIndex === this.parent.crudModule.crudObj.targetEvent[j].groupIndex) {\n            remove(wrapper);\n          }\n        }\n      } else {\n        remove(wrapper);\n      }\n    }\n\n    if (!this.element.querySelector('.' + WORK_CELLS_CLASS)) {\n      return;\n    }\n\n    this.allDayElement = [].slice.call(this.element.querySelectorAll('.' + ALLDAY_CELLS_CLASS));\n    this.setAllDayRowHeight(0);\n\n    if (this.parent.eventsProcessed.length === 0 && this.parent.blockProcessed.length === 0) {\n      return;\n    }\n\n    const expandCollapse = this.element.querySelector('.' + ALLDAY_APPOINTMENT_SECTION_CLASS);\n    EventHandler.remove(expandCollapse, 'click', this.rowExpandCollapse);\n    EventHandler.add(expandCollapse, 'click', this.rowExpandCollapse, this);\n    this.renderedEvents = [];\n    this.renderedAllDayEvents = [];\n    this.initializeValues();\n    this.processBlockEvents();\n    this.renderEvents('normalEvents');\n\n    if (this.allDayEvents.length > 0) {\n      this.allDayEvents = this.allDayEvents.filter((item, index, arr) => index === arr.map(item => item.Guid).indexOf(item.Guid));\n      removeClass(this.allDayElement, ALLDAY_ROW_ANIMATE_CLASS);\n      this.slots.push(this.parent.activeView.renderDates.map(date => +date));\n      this.renderEvents('allDayEvents');\n    }\n\n    this.parent.notify(contentReady, {});\n    addClass(this.allDayElement, ALLDAY_ROW_ANIMATE_CLASS);\n\n    if (isDragging) {\n      this.parent.crudModule.crudObj.isCrudAction = false;\n    }\n\n    this.parent.renderTemplates();\n  }\n\n  initializeValues() {\n    this.resources = this.parent.activeViewOptions.group.resources.length > 0 ? this.parent.uiStateValues.isGroupAdaptive ? [this.parent.resourceBase.lastResourceLevel[this.parent.uiStateValues.groupIndex]] : this.parent.resourceBase.lastResourceLevel : [];\n    this.cellHeight = parseFloat(this.parent.element.querySelector('.e-content-wrap tbody tr').getBoundingClientRect().height.toFixed(2));\n    this.dateRender[0] = this.parent.activeView.renderDates;\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      for (let i = 0, len = this.resources.length; i < len; i++) {\n        this.dateRender[i] = this.resources[i].renderDates;\n      }\n    }\n  }\n\n  getHeight(start, end) {\n    let appHeight = (getUniversalTime(end) - getUniversalTime(start)) / MS_PER_MINUTE * (this.cellHeight * this.slotCount) / this.interval;\n    appHeight = appHeight <= 0 ? this.cellHeight : appHeight;\n    return appHeight;\n  }\n\n  appendEvent(eventObj, appointmentElement, index, appLeft) {\n    const appointmentWrap = [].slice.call(this.element.querySelectorAll('.' + APPOINTMENT_WRAPPER_CLASS));\n\n    if (this.parent.enableRtl) {\n      setStyleAttribute(appointmentElement, {\n        'right': appLeft\n      });\n    } else {\n      setStyleAttribute(appointmentElement, {\n        'left': appLeft\n      });\n    }\n\n    const eventType = appointmentElement.classList.contains(BLOCK_APPOINTMENT_CLASS) ? 'blockEvent' : 'event';\n    const args = {\n      data: extend({}, eventObj, null, true),\n      element: appointmentElement,\n      cancel: false,\n      type: eventType\n    };\n    this.parent.trigger(eventRendered, args, eventArgs => {\n      if (!eventArgs.cancel) {\n        appointmentWrap[index].appendChild(appointmentElement);\n      }\n    });\n  }\n\n  processBlockEvents() {\n    const resources = this.getResourceList();\n    let dateCount = 0;\n\n    for (const resource of resources) {\n      const renderDates = this.dateRender[resource];\n\n      for (let day = 0, length = renderDates.length; day < length; day++) {\n        const startDate = new Date(renderDates[day].getTime());\n        const endDate = addDays(renderDates[day], 1);\n        const filterEvents = this.filterEvents(startDate, endDate, this.parent.blockProcessed, this.resources[resource]);\n\n        for (const event of filterEvents) {\n          if (this.parent.resourceBase) {\n            this.setValues(event, resource);\n          }\n\n          this.renderBlockEvents(event, day, resource, dateCount);\n          this.cssClass = null;\n          this.groupOrder = null;\n        }\n\n        dateCount += 1;\n      }\n    }\n  }\n\n  renderBlockEvents(eventObj, dayIndex, resource, dayCount) {\n    const spannedData = this.isSpannedEvent(eventObj, dayIndex, resource);\n    const eStart = spannedData[this.fields.startTime];\n    const eEnd = spannedData[this.fields.endTime];\n    const currentDate = resetTime(new Date(this.dateRender[resource][dayIndex].getTime()));\n    const schedule = getStartEndHours(currentDate, this.startHour, this.endHour);\n\n    if (eStart <= eEnd && this.isValidEvent(eventObj, eStart, eEnd, schedule)) {\n      let blockTop;\n      let blockHeight;\n\n      if (spannedData[this.fields.isAllDay]) {\n        const contentWrap = this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS + ' table');\n        blockHeight = formatUnit(contentWrap.offsetHeight);\n        blockTop = formatUnit(0);\n      } else {\n        blockHeight = formatUnit(this.getHeight(eStart, eEnd));\n        blockTop = formatUnit(this.getTopValue(eStart, dayIndex, resource));\n      }\n\n      const appointmentElement = this.createBlockAppointmentElement(eventObj, resource);\n      setStyleAttribute(appointmentElement, {\n        'width': '100%',\n        'height': blockHeight,\n        'top': blockTop\n      });\n      const index = this.parent.activeViewOptions.group.byDate ? this.resources.length * dayIndex + resource : dayCount;\n      this.appendEvent(eventObj, appointmentElement, index, '0px');\n    }\n  }\n\n  renderEvents(eventType) {\n    removeClass(this.allDayElement, ALLDAY_ROW_ANIMATE_CLASS);\n    const eventCollection = eventType === 'allDayEvents' ? this.sortByDateTime(this.allDayEvents) : undefined;\n    const resources = this.getResourceList();\n    let dateCount = 0;\n    let isRender;\n\n    for (const resource of resources) {\n      isRender = true;\n\n      if (this.parent.crudModule && this.parent.crudModule.crudObj.isCrudAction && eventType !== 'allDayEvents' && !this.parent.uiStateValues.isGroupAdaptive) {\n        if (this.parent.crudModule.crudObj.sourceEvent.filter(data => data.groupIndex === resource).length === 0 && this.parent.crudModule.crudObj.targetEvent.filter(data => data.groupIndex === resource).length === 0) {\n          isRender = false;\n        }\n      }\n\n      this.slots = [];\n      const renderDates = this.dateRender[resource];\n      const renderedDate = this.getRenderedDates(renderDates) || renderDates;\n      this.slots.push(renderDates.map(date => {\n        return +date;\n      }));\n\n      for (let day = 0, length = renderDates.length; day < length && renderDates[day] <= renderedDate[renderedDate.length - 1]; day++) {\n        this.renderedEvents = [];\n        const startDate = new Date(renderDates[day].getTime());\n        const endDate = addDays(renderDates[day], 1);\n        const filterEvents = this.filterEvents(startDate, endDate, eventCollection, this.resources[resource]);\n\n        if (isRender) {\n          for (const event of filterEvents) {\n            if (this.parent.resourceBase) {\n              this.setValues(event, resource);\n            }\n\n            if (eventType === 'allDayEvents') {\n              this.renderAllDayEvents(event, day, resource, dateCount);\n            } else {\n              if (this.isAllDayAppointment(event)) {\n                this.allDayEvents.push(extend({}, event, null, true));\n              } else {\n                if (this.parent.eventSettings.enableMaxHeight) {\n                  if (this.getOverlapIndex(event, day, false, resource) > 0) {\n                    continue;\n                  }\n                }\n\n                this.renderNormalEvents(event, day, resource, dateCount);\n              }\n            }\n\n            this.cssClass = null;\n            this.groupOrder = null;\n          }\n        } else {\n          for (const event of filterEvents) {\n            if (this.isAllDayAppointment(event)) {\n              this.allDayEvents.push(extend({}, event, null, true));\n            }\n          }\n        }\n\n        dateCount += 1;\n      }\n    }\n  }\n\n  setValues(event, resourceIndex) {\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      this.cssClass = this.resources[resourceIndex].cssClass;\n      this.groupOrder = this.resources[resourceIndex].groupOrder;\n    } else {\n      this.cssClass = this.parent.resourceBase.getCssClass(event);\n    }\n  }\n\n  getResourceList() {\n    // eslint-disable-next-line prefer-spread\n    const resources = Array.apply(null, {\n      length: this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive ? this.resources.length : 1\n    }).map((value, index) => {\n      return index;\n    });\n    return resources;\n  } // eslint-disable-next-line max-len\n\n\n  createAppointmentElement(record, isAllDay, data, resource) {\n    const fieldMapping = this.parent.eventFields;\n    const recordSubject = record[fieldMapping.subject] || this.parent.eventSettings.fields.subject.default || this.parent.localeObj.getConstant('addTitle');\n    const appointmentWrapper = createElement('div', {\n      className: APPOINTMENT_CLASS,\n      attrs: {\n        'data-id': 'Appointment_' + record[fieldMapping.id],\n        'data-guid': record.Guid,\n        'role': 'button',\n        'tabindex': '0',\n        'aria-disabled': this.parent.eventBase.getReadonlyAttribute(record),\n        'aria-pressed': 'false',\n        'aria-grabbed': 'true',\n        'aria-label': this.parent.getAnnouncementString(record)\n      }\n    });\n\n    if (record[this.fields.isReadonly]) {\n      addClass([appointmentWrapper], 'e-read-only');\n    }\n\n    const appointmentDetails = createElement('div', {\n      className: APPOINTMENT_DETAILS\n    });\n    appointmentWrapper.appendChild(appointmentDetails);\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      const resourceIndex = this.parent.uiStateValues.isGroupAdaptive ? this.parent.uiStateValues.groupIndex : resource;\n      appointmentWrapper.setAttribute('data-group-index', resourceIndex.toString());\n    }\n\n    let templateElement;\n    const eventData = data;\n\n    if (!isNullOrUndefined(this.parent.activeViewOptions.eventTemplate)) {\n      const elementId = this.parent.element.id + '_';\n      const viewName = this.parent.activeViewOptions.eventTemplateName;\n      const templateId = elementId + viewName + 'eventTemplate';\n      const resIndex = this.parent.uiStateValues.isGroupAdaptive ? this.parent.uiStateValues.groupIndex : resource;\n      const templateName = 'eventTemplate' + (this.parent.activeViewOptions.group.resources.length > 0 ? '_' + resIndex : '');\n      templateElement = this.parent.getAppointmentTemplate()(record, this.parent, templateName, templateId, false);\n    } else {\n      const appointmentSubject = createElement('div', {\n        className: SUBJECT_CLASS,\n        innerHTML: recordSubject\n      });\n\n      if (isAllDay) {\n        if (record[fieldMapping.isAllDay]) {\n          templateElement = [appointmentSubject];\n        } else {\n          templateElement = [];\n          const appointmentStartTime = createElement('div', {\n            className: APPOINTMENT_TIME + (this.parent.isAdaptive ? ' ' + DISABLE_CLASS : ''),\n            innerHTML: this.parent.getTimeString(record[fieldMapping.startTime])\n          });\n          const appointmentEndTime = createElement('div', {\n            className: APPOINTMENT_TIME + (this.parent.isAdaptive ? ' ' + DISABLE_CLASS : ''),\n            innerHTML: this.parent.getTimeString(record[fieldMapping.endTime])\n          });\n          addClass([appointmentSubject], 'e-text-center');\n\n          if (!eventData.isLeft) {\n            templateElement.push(appointmentStartTime);\n          }\n\n          templateElement.push(appointmentSubject);\n\n          if (!eventData.isRight) {\n            templateElement.push(appointmentEndTime);\n          }\n        }\n      } else {\n        const timeStr = this.parent.getTimeString(record[fieldMapping.startTime]) + ' - ' + this.parent.getTimeString(record[fieldMapping.endTime]);\n        const appointmentTime = createElement('div', {\n          className: APPOINTMENT_TIME + (this.parent.isAdaptive ? ' ' + DISABLE_CLASS : ''),\n          innerHTML: timeStr\n        });\n        const appointmentLocation = createElement('div', {\n          className: LOCATION_CLASS,\n          innerHTML: record[fieldMapping.location] || this.parent.eventSettings.fields.location.default || ''\n        });\n        templateElement = [appointmentSubject, appointmentTime, appointmentLocation];\n      }\n    }\n\n    append(templateElement, appointmentDetails);\n\n    if (!this.parent.isAdaptive && (!isNullOrUndefined(record[fieldMapping.recurrenceRule]) || !isNullOrUndefined(record[fieldMapping.recurrenceID]))) {\n      const iconClass = record[fieldMapping.id] === record[fieldMapping.recurrenceID] ? EVENT_RECURRENCE_ICON_CLASS : EVENT_RECURRENCE_EDIT_ICON_CLASS;\n      const recurrenceIcon = createElement('div', {\n        className: ICON + ' ' + iconClass\n      });\n\n      if (isAllDay) {\n        appointmentDetails.appendChild(recurrenceIcon);\n      } else {\n        appointmentWrapper.appendChild(recurrenceIcon);\n      }\n    }\n\n    this.renderSpannedIcon(isAllDay ? appointmentDetails : appointmentWrapper, eventData);\n\n    if (!isNullOrUndefined(this.cssClass)) {\n      addClass([appointmentWrapper], this.cssClass);\n    }\n\n    this.applyResourceColor(appointmentWrapper, record, 'backgroundColor', this.groupOrder);\n    this.renderResizeHandler(appointmentWrapper, eventData, record[this.fields.isReadonly]);\n    return appointmentWrapper;\n  }\n\n  createMoreIndicator(allDayRow, count, currentDay) {\n    const index = currentDay + count;\n    const countWrapper = allDayRow[index];\n\n    if (countWrapper.childElementCount <= 0) {\n      const innerCountWrap = createElement('div', {\n        className: ROW_COUNT_WRAPPER_CLASS,\n        id: ROW_COUNT_WRAPPER_CLASS + '-' + index.toString()\n      });\n      const moreIndicatorElement = createElement('div', {\n        className: MORE_INDICATOR_CLASS,\n        attrs: {\n          'tabindex': '0',\n          'data-index': index.toString(),\n          'data-count': '1'\n        },\n        innerHTML: '+1&nbsp;' + (this.parent.isAdaptive ? '' : this.parent.localeObj.getConstant('more'))\n      });\n      innerCountWrap.appendChild(moreIndicatorElement);\n      countWrapper.appendChild(innerCountWrap);\n      EventHandler.add(moreIndicatorElement, 'click', this.rowExpandCollapse, this);\n    } else {\n      const countCell = countWrapper.querySelector('.' + MORE_INDICATOR_CLASS);\n      const moreCount = parseInt(countCell.getAttribute('data-count'), 10) + 1;\n      countCell.setAttribute('data-count', moreCount.toString());\n      countCell.innerHTML = '+' + this.parent.globalize.formatNumber(moreCount) + '&nbsp;' + (this.parent.isAdaptive ? '' : this.parent.localeObj.getConstant('more'));\n    }\n  }\n\n  renderSpannedIcon(element, spanEvent) {\n    const iconElement = createElement('div', {\n      className: EVENT_INDICATOR_CLASS + ' ' + ICON\n    });\n\n    if (spanEvent.isLeft) {\n      const iconLeft = iconElement.cloneNode();\n      addClass([iconLeft], EVENT_ICON_LEFT_CLASS);\n      prepend([iconLeft], element);\n    }\n\n    if (spanEvent.isRight) {\n      const iconRight = iconElement.cloneNode();\n      addClass([iconRight], EVENT_ICON_RIGHT_CLASS);\n      append([iconRight], element);\n    }\n\n    if (spanEvent.isTop) {\n      const iconTop = iconElement.cloneNode();\n      addClass([iconTop], EVENT_ICON_UP_CLASS);\n      prepend([iconTop], element);\n    }\n\n    if (spanEvent.isBottom) {\n      const iconBottom = iconElement.cloneNode();\n      addClass([iconBottom], EVENT_ICON_DOWN_CLASS);\n      append([iconBottom], element);\n    }\n  }\n\n  isSpannedEvent(record, day, resource) {\n    let currentDate = resetTime(this.dateRender[resource][day]);\n    const renderedDate = this.getRenderedDates(this.dateRender[resource]) || [currentDate];\n    const currentDay = renderedDate.filter(date => date.getDay() === day);\n\n    if (currentDay.length === 0) {\n      currentDate = resetTime(renderedDate[0]);\n    }\n\n    const field = this.parent.eventFields;\n    const schedule = getStartEndHours(currentDate, this.startHour, this.endHour);\n    const event = extend({}, record, null, true);\n    event.isSpanned = {\n      isBottom: false,\n      isTop: false\n    };\n\n    if (record[field.startTime].getTime() < schedule.startHour.getTime()) {\n      event[field.startTime] = schedule.startHour;\n      event.isSpanned.isTop = true;\n    }\n\n    if (record[field.endTime].getTime() > schedule.endHour.getTime()) {\n      event[field.endTime] = schedule.endHour;\n      event.isSpanned.isBottom = true;\n    }\n\n    const eventDates = this.updateEventMinimumDuration(schedule, event[field.startTime], event[field.endTime]);\n    event[field.startTime] = eventDates.startDate;\n    event[field.endTime] = eventDates.endDate;\n    return event;\n  }\n\n  renderAllDayEvents(eventObj, dayIndex, resource, dayCount, inline) {\n    let currentDates = this.getRenderedDates(this.dateRender[resource]) || this.dateRender[resource];\n\n    if (this.parent.activeViewOptions.group.byDate) {\n      this.slots[0] = [this.dateRender[resource][dayIndex].getTime()];\n      currentDates = [this.dateRender[resource][dayIndex]];\n    }\n\n    const record = this.splitEvent(eventObj, currentDates)[0];\n    const allDayRowCell = this.element.querySelector('.' + ALLDAY_CELLS_CLASS + ':first-child');\n    const cellTop = allDayRowCell.offsetTop;\n    const eStart = new Date(record[this.parent.eventFields.startTime].getTime());\n    const eEnd = new Date(record[this.parent.eventFields.endTime].getTime());\n    let appWidth = 0;\n    let topValue = 1;\n    const isDateRange = currentDates[0].getTime() <= eStart.getTime() && addDays(currentDates.slice(-1)[0], 1).getTime() >= eStart.getTime();\n\n    if (eStart <= eEnd && isDateRange) {\n      let isAlreadyRendered = [];\n\n      if (this.renderedAllDayEvents[resource]) {\n        isAlreadyRendered = this.renderedAllDayEvents[resource].filter(event => event.Guid === eventObj.Guid);\n\n        if (this.parent.activeViewOptions.group.byDate) {\n          isAlreadyRendered = isAlreadyRendered.filter(event => event[this.parent.eventFields.startTime] >= currentDates[dayIndex] && event[this.parent.eventFields.endTime] <= addDays(new Date(+currentDates[dayIndex]), 1));\n        }\n      }\n\n      if (isAlreadyRendered.length === 0) {\n        const allDayDifference = record.data.count;\n        const allDayIndex = this.getOverlapIndex(record, dayIndex, true, resource);\n        record.Index = allDayIndex;\n        this.allDayLevel = this.allDayLevel < allDayIndex ? allDayIndex : this.allDayLevel;\n        const widthAdjustment = record.data.isRight ? 0 : this.parent.currentView === 'Day' ? 4 : 7;\n\n        if (allDayDifference >= 0) {\n          appWidth = allDayDifference * 100 - widthAdjustment;\n        }\n\n        if (isNullOrUndefined(this.renderedAllDayEvents[resource])) {\n          this.renderedAllDayEvents[resource] = [];\n        }\n\n        this.renderedAllDayEvents[resource].push(extend({}, record, null, true));\n        const allDayRow = [].slice.call(this.element.querySelector('.' + ALLDAY_ROW_CLASS).children);\n        const wIndex = this.parent.activeViewOptions.group.byDate ? this.resources.length * dayIndex + resource : dayCount;\n        const eventWrapper = this.element.querySelector('.' + ALLDAY_APPOINTMENT_WRAPPER_CLASS + ':nth-child(' + (wIndex + 1) + ')');\n        let appointmentElement;\n\n        if (inline) {\n          appointmentElement = this.parent.inlineModule.createInlineAppointmentElement(eventObj);\n        } else {\n          appointmentElement = this.createAppointmentElement(eventObj, true, record.data, resource);\n        }\n\n        addClass([appointmentElement], ALLDAY_APPOINTMENT_CLASS);\n        const eventData = extend({}, record.data, null, true);\n        eventObj.data = eventData;\n        const args = {\n          data: eventObj,\n          element: appointmentElement,\n          cancel: false\n        };\n        this.parent.trigger(eventRendered, args, eventArgs => {\n          if (!eventArgs.cancel) {\n            eventWrapper.appendChild(appointmentElement);\n            const appHeight = appointmentElement.offsetHeight;\n            topValue += (allDayIndex === 0 ? cellTop : cellTop + allDayIndex * appHeight) + 1;\n            setStyleAttribute(appointmentElement, {\n              'width': appWidth + '%',\n              'top': formatUnit(topValue)\n            });\n\n            if (allDayIndex > 1) {\n              this.moreEvents.push(appointmentElement);\n\n              for (let count = 0, length = allDayDifference; count < length; count++) {\n                this.createMoreIndicator(allDayRow, count, wIndex);\n              }\n            }\n\n            allDayRowCell.setAttribute('data-count', this.allDayLevel.toString());\n            const allDayRowHeight = (!this.parent.uiStateValues.expand && this.allDayLevel > 2 ? 3 * appHeight : (this.allDayLevel + 1) * appHeight) + 4;\n            this.setAllDayRowHeight(allDayRowHeight);\n            this.addOrRemoveClass();\n            this.wireAppointmentEvents(appointmentElement, eventObj);\n          }\n        });\n      }\n    }\n  }\n\n  renderNormalEvents(eventObj, dayIndex, resource, dayCount, inline) {\n    const record = this.isSpannedEvent(eventObj, dayIndex, resource);\n    const eStart = record[this.fields.startTime];\n    const eEnd = record[this.fields.endTime];\n    let appWidth = '0%';\n    const appLeft = '0%';\n    let topValue = 0;\n    const currentDate = resetTime(new Date(this.dateRender[resource][dayIndex].getTime()));\n    const schedule = getStartEndHours(currentDate, this.startHour, this.endHour);\n    const isValidEvent = this.isValidEvent(eventObj, eStart, eEnd, schedule);\n\n    if (eStart.getTime() < this.parent.minDate.getTime() || eEnd.getTime() > this.parent.maxDate.getTime()) {\n      return;\n    }\n\n    if (eStart <= eEnd && isValidEvent) {\n      const appHeight = this.getHeight(eStart, eEnd);\n\n      if (eStart.getTime() > schedule.startHour.getTime()) {\n        topValue = this.getTopValue(eStart, dayIndex, resource);\n      }\n\n      const appIndex = this.getOverlapIndex(record, dayIndex, false, resource);\n      record.Index = appIndex;\n      this.overlapList.push(record);\n\n      if (this.overlapList.length > 1) {\n        if (isNullOrUndefined(this.overlapEvents[appIndex])) {\n          this.overlapEvents[appIndex] = [];\n        }\n\n        this.overlapEvents[appIndex].push(record);\n      } else {\n        this.overlapEvents = [];\n        this.overlapEvents.push([record]);\n      }\n\n      appWidth = this.getEventWidth();\n      const argsData = {\n        index: appIndex,\n        left: appLeft,\n        width: appWidth,\n        day: dayIndex,\n        dayIndex: dayCount,\n        record: record,\n        resource: resource\n      };\n      const tempData = this.adjustOverlapElements(argsData);\n      appWidth = tempData.appWidth;\n\n      if (isNullOrUndefined(this.renderedEvents[resource])) {\n        this.renderedEvents[resource] = [];\n      }\n\n      this.renderedEvents[resource].push(extend({}, record, null, true));\n      let appointmentElement;\n\n      if (inline) {\n        appointmentElement = this.parent.inlineModule.createInlineAppointmentElement(eventObj);\n      } else {\n        appointmentElement = this.createAppointmentElement(eventObj, false, record.isSpanned, resource);\n      }\n\n      setStyleAttribute(appointmentElement, {\n        'width': this.parent.eventSettings.enableMaxHeight ? '100%' : tempData.appWidth,\n        'height': appHeight + 'px',\n        'top': topValue + 'px'\n      });\n      const iconHeight = appointmentElement.querySelectorAll('.' + EVENT_INDICATOR_CLASS).length * 15;\n      const maxHeight = appHeight - 40 - iconHeight;\n      const subjectElement = appointmentElement.querySelector('.' + SUBJECT_CLASS);\n\n      if (!this.parent.isAdaptive && subjectElement) {\n        subjectElement.style.maxHeight = formatUnit(maxHeight);\n      }\n\n      const index = this.parent.activeViewOptions.group.byDate ? this.resources.length * dayIndex + resource : dayCount;\n      const eventData = {};\n      eventData[this.fields.startTime] = eventObj[this.fields.startTime];\n      eventData[this.fields.endTime] = eventObj[this.fields.endTime];\n      record.data = eventData;\n      this.appendEvent(record, appointmentElement, index, tempData.appLeft);\n      this.wireAppointmentEvents(appointmentElement, eventObj);\n\n      if (appHeight < this.cellHeight) {\n        const resizeHandlers = [].slice.call(appointmentElement.querySelectorAll('.' + EVENT_RESIZE_CLASS));\n        resizeHandlers.forEach(resizeHandler => {\n          resizeHandler.style.height = Math.ceil(appHeight / resizeHandler.offsetHeight) + 'px';\n        });\n      }\n    }\n  }\n\n  getEventWidth() {\n    const width = this.parent.currentView === 'Day' ? 97 : 94;\n    const tempWidth = (width - this.overlapEvents.length) / this.overlapEvents.length;\n    return (tempWidth < 0 ? 0 : tempWidth) + '%';\n  }\n\n  getEventLeft(appWidth, index) {\n    const tempLeft = (parseFloat(appWidth) + 1) * index;\n    return (tempLeft > 99 ? 99 : tempLeft) + '%';\n  }\n\n  getTopValue(date, day, resource) {\n    const startEndHours = getStartEndHours(resetTime(this.dateRender[resource][day]), this.startHour, this.endHour);\n    const startHour = startEndHours.startHour;\n    const diffInMinutes = (date.getHours() - startHour.getHours()) * 60 + (date.getMinutes() - startHour.getMinutes());\n    return this.parent.activeViewOptions.timeScale.enable ? diffInMinutes * this.cellHeight * this.slotCount / this.interval : 0;\n  }\n\n  getOverlapIndex(record, day, isAllDay, resource) {\n    const fieldMapping = this.parent.eventFields;\n    let eventsList = [];\n    let appIndex = -1;\n    this.overlapEvents = [];\n\n    if (isAllDay) {\n      if (!isNullOrUndefined(this.renderedAllDayEvents[resource])) {\n        const date = resetTime(new Date(this.dateRender[resource][day].getTime()));\n        eventsList = this.renderedAllDayEvents[resource].filter(app => resetTime(app[fieldMapping.startTime]).getTime() <= date.getTime() && resetTime(app[fieldMapping.endTime]).getTime() >= date.getTime());\n\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n          eventsList = this.filterEventsByResource(this.resources[resource], eventsList);\n        }\n      }\n    } else {\n      const appointmentList = !isNullOrUndefined(this.renderedEvents[resource]) ? this.renderedEvents[resource] : [];\n      let appointment = [];\n      const recordStart = record[fieldMapping.startTime];\n      const recordEnd = record[fieldMapping.endTime];\n      this.overlapList = appointmentList.filter(data => data[fieldMapping.endTime] > recordStart && data[fieldMapping.startTime] <= recordEnd || data[fieldMapping.startTime] >= recordEnd && data[fieldMapping.endTime] <= recordStart || data[fieldMapping.endTime].getTime() === data[fieldMapping.startTime].getTime() && data[fieldMapping.startTime].getTime() === recordStart.getTime() && data[fieldMapping.endTime] < recordEnd);\n\n      if (this.parent.activeViewOptions.group.resources.length > 0) {\n        this.overlapList = this.filterEventsByResource(this.resources[resource], this.overlapList);\n      }\n\n      this.overlapList.forEach(obj => {\n        let filterList = appointmentList.filter(data => data[fieldMapping.endTime] > obj[fieldMapping.startTime] && data[fieldMapping.startTime] <= obj[fieldMapping.endTime]);\n\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n          filterList = this.filterEventsByResource(this.resources[resource], filterList);\n        }\n\n        const collection = filterList.filter(val => this.overlapList.indexOf(val) === -1);\n\n        if (collection.length > 0) {\n          appointment = appointment.concat(collection);\n        }\n      });\n\n      for (let i = 0; i < appointment.length - 1; i++) {\n        for (let j = i + 1; j < appointment.length; j++) {\n          if (appointment[i][fieldMapping.id] === appointment[j][fieldMapping.id]) {\n            appointment.splice(j, 1);\n            j--;\n          }\n        }\n      }\n\n      this.overlapList = this.overlapList.concat(appointment);\n      eventsList = this.overlapList;\n\n      for (const event of eventsList) {\n        const record = event;\n        const index = record.Index;\n\n        if (isNullOrUndefined(this.overlapEvents[index])) {\n          this.overlapEvents[index] = [event];\n        } else {\n          this.overlapEvents[index].push(event);\n        }\n      }\n    }\n\n    if (!isAllDay) {\n      eventsList = eventsList.filter(obj => obj[fieldMapping.startTime] === record[fieldMapping.startTime] && obj[fieldMapping.endTime] > record[fieldMapping.endTime] || obj[fieldMapping.endTime] > record[fieldMapping.startTime] && obj[fieldMapping.startTime] < record[fieldMapping.endTime] || obj[fieldMapping.endTime] === record[fieldMapping.startTime] && obj[fieldMapping.startTime] === record[fieldMapping.endTime] || obj[fieldMapping.startTime].getTime() === record[fieldMapping.startTime].getTime() && obj[fieldMapping.endTime].getTime() === record[fieldMapping.endTime].getTime() || obj[fieldMapping.startTime].getTime() === record[fieldMapping.startTime].getTime() && obj[fieldMapping.endTime].getTime() < record[fieldMapping.endTime].getTime() || obj[fieldMapping.endTime].getTime() > record[fieldMapping.endTime].getTime());\n    }\n\n    if (eventsList.length > 0) {\n      const appLevel = eventsList.map(obj => obj.Index);\n      appIndex = appLevel.length > 0 ? this.getSmallestMissingNumber(appLevel) : 0;\n    }\n\n    return appIndex === -1 ? 0 : appIndex;\n  }\n\n  adjustOverlapElements(args) {\n    const data = {\n      appWidth: args.width,\n      appLeft: args.left\n    };\n\n    for (let i = 0, length1 = this.overlapEvents.length; i < length1; i++) {\n      if (!isNullOrUndefined(this.overlapEvents[i])) {\n        for (let j = 0, length2 = this.overlapEvents[i].length; j < length2; j++) {\n          const dayCount = this.parent.activeViewOptions.group.byDate ? this.resources.length * args.day + args.resource : args.dayIndex;\n          const element = this.element.querySelector('#e-appointment-wrapper-' + dayCount);\n\n          if (element.childElementCount > 0) {\n            const eleGuid = this.overlapEvents[i][j].Guid;\n\n            if (element.querySelectorAll('div[data-guid=\"' + eleGuid + '\"]').length > 0 && eleGuid !== args.record.Guid) {\n              const apps = element.querySelector('div[data-guid=\"' + eleGuid + '\"]');\n\n              if (parseFloat(args.width) <= parseFloat(apps.style.width)) {\n                if (this.parent.enableRtl) {\n                  apps.style.right = this.getEventLeft(args.width, i);\n                } else {\n                  apps.style.left = this.getEventLeft(args.width, i);\n                }\n\n                apps.style.width = parseFloat(args.width) + '%';\n                data.appWidth = apps.style.width;\n              } else {\n                data.appWidth = apps.style.width;\n              }\n            } else {\n              let appWidth = args.width;\n\n              if (isNullOrUndefined(this.overlapEvents[i - 1])) {\n                appWidth = this.getEventWidth();\n              }\n\n              data.appWidth = appWidth;\n              data.appLeft = this.getEventLeft(appWidth, args.index);\n            }\n          }\n        }\n      }\n    }\n\n    return data;\n  }\n\n  setAllDayRowHeight(height) {\n    const dateHeader = this.parent.element.querySelector('.' + DATE_HEADER_WRAP_CLASS);\n\n    if (this.parent.height === 'auto' || !this.parent.enableAllDayScroll) {\n      addClass([dateHeader], ALLDAY_APPOINTMENT_AUTO);\n    }\n\n    const allDayRow = this.parent.element.querySelector('.' + ALLDAY_ROW_CLASS);\n    allDayRow.style.height = '';\n\n    if (this.parent.uiStateValues.expand && this.parent.height !== 'auto' && this.parent.enableAllDayScroll) {\n      allDayRow.style.height = height / 12 + 'em';\n      this.parent.eventBase.allDayExpandScroll(dateHeader);\n    } else {\n      dateHeader.scrollTop = 0;\n\n      for (const element of this.allDayElement) {\n        element.style.height = height / 12 + 'em';\n      }\n\n      removeClass([dateHeader], ALLDAY_APPOINTMENT_SCROLL);\n    }\n\n    this.animation.animate(this.allDayElement[0]);\n  }\n\n  addOrRemoveClass() {\n    this.moreEvents.filter(element => {\n      if (!this.parent.uiStateValues.expand && this.allDayLevel > 2) {\n        addClass([element], EVENT_COUNT_CLASS);\n        element.setAttribute('tabindex', '-1');\n      } else {\n        removeClass([element], EVENT_COUNT_CLASS);\n        element.setAttribute('tabindex', '0');\n      }\n    });\n    const moreEventCount = this.element.querySelector('.' + ALLDAY_APPOINTMENT_SECTION_CLASS);\n\n    if (this.parent.uiStateValues.expand) {\n      removeClass([moreEventCount], APPOINTMENT_ROW_EXPAND_CLASS);\n      addClass([moreEventCount], APPOINTMENT_ROW_COLLAPSE_CLASS);\n    } else {\n      removeClass([moreEventCount], APPOINTMENT_ROW_COLLAPSE_CLASS);\n      addClass([moreEventCount], APPOINTMENT_ROW_EXPAND_CLASS);\n    }\n\n    if (this.allDayLevel > 2) {\n      removeClass([moreEventCount], DISABLE_CLASS);\n    } else {\n      addClass([moreEventCount], DISABLE_CLASS);\n    }\n\n    const countCell = [].slice.call(this.element.querySelectorAll('.' + ROW_COUNT_WRAPPER_CLASS));\n    countCell.forEach(element => {\n      if (!this.parent.uiStateValues.expand && this.allDayLevel > 2) {\n        removeClass([element], DISABLE_CLASS);\n      } else {\n        addClass([element], DISABLE_CLASS);\n      }\n    });\n  }\n\n  getEventHeight() {\n    const eventElement = createElement('div', {\n      className: APPOINTMENT_CLASS,\n      styles: 'visibility:hidden'\n    });\n    const eventWrapper = this.element.querySelector('.' + ALLDAY_APPOINTMENT_WRAPPER_CLASS + ':first-child');\n    eventWrapper.appendChild(eventElement);\n    const height = eventElement.offsetHeight;\n    remove(eventElement);\n    return height;\n  }\n\n  rowExpandCollapse() {\n    const target = this.element.querySelector('.' + ALLDAY_APPOINTMENT_SECTION_CLASS);\n    this.parent.uiStateValues.expand = target.classList.contains(APPOINTMENT_ROW_EXPAND_CLASS);\n    let rowHeight;\n\n    if (this.parent.uiStateValues.expand) {\n      target.setAttribute('title', this.parent.localeObj.getConstant('collapseAllDaySection'));\n      target.setAttribute('aria-label', 'Collapse section');\n      rowHeight = (this.allDayLevel + 1) * this.getEventHeight() + 4;\n    } else {\n      target.setAttribute('title', this.parent.localeObj.getConstant('expandAllDaySection'));\n      target.setAttribute('aria-label', 'Expand section');\n      rowHeight = 3 * this.getEventHeight() + 4;\n    }\n\n    this.setAllDayRowHeight(rowHeight);\n    this.addOrRemoveClass();\n    this.animation.animate(target);\n  }\n\n  animationUiUpdate() {\n    this.parent.notify(contentReady, {});\n  }\n\n  destroy() {\n    if (!this.parent || this.parent && this.parent.isDestroyed) {\n      return;\n    }\n\n    this.removeEventListener();\n    this.allDayElement = null;\n    this.renderedAllDayEvents = null;\n    this.renderedEvents = null;\n    this.slotCount = null;\n    this.interval = null;\n    this.startHour = null;\n    this.endHour = null;\n    this.element = null;\n    this.fields = null;\n    this.animation = null;\n    super.destroy();\n  }\n\n}\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\n\nconst EVENT_GAP = 0;\n/**\n * Month view events render\n */\n\nclass MonthEvent extends EventBase {\n  constructor(parent) {\n    super(parent);\n    this.renderedEvents = [];\n    this.monthHeaderHeight = 0;\n    this.moreIndicatorHeight = 19;\n    this.renderType = 'day';\n    this.element = this.parent.activeView.getPanel();\n    this.fields = this.parent.eventFields;\n    this.maxHeight = this.parent.eventSettings.enableMaxHeight && !this.parent.eventSettings.enableIndicator && !this.parent.rowAutoHeight;\n    this.withIndicator = this.parent.eventSettings.enableMaxHeight && this.parent.eventSettings.enableIndicator && !this.parent.rowAutoHeight;\n    this.maxOrIndicator = this.maxHeight || this.withIndicator;\n    this.moreIndicatorHeight = this.parent.rowAutoHeight && this.parent.eventSettings.ignoreWhitespace ? 0 : this.moreIndicatorHeight;\n    this.addEventListener();\n  }\n\n  removeEventWrapper(appElement) {\n    if (appElement.length > 0) {\n      appElement = this.parent.currentView === 'Month' ? appElement : [appElement[0]];\n\n      for (const wrap of appElement) {\n        if (wrap.parentElement && wrap.parentElement.parentNode) {\n          remove(wrap.parentElement);\n        }\n      }\n    }\n  }\n\n  renderAppointments() {\n    if (this.parent.dragAndDropModule) {\n      this.parent.dragAndDropModule.setDragArea();\n    }\n\n    const conWrap = this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS);\n\n    if (this.parent.rowAutoHeight) {\n      this.parent.uiStateValues.top = conWrap.scrollTop;\n      this.parent.uiStateValues.left = conWrap.scrollLeft;\n    }\n\n    const appointmentWrapper = [].slice.call(this.element.querySelectorAll('.' + APPOINTMENT_WRAPPER_CLASS));\n\n    if (this.parent.crudModule && this.parent.crudModule.crudObj.isCrudAction) {\n      for (let i = 0, len = this.parent.crudModule.crudObj.sourceEvent.length; i < len; i++) {\n        const appElement = [].slice.call(this.element.querySelectorAll('.e-appointment-wrapper ' + '[data-group-index=\"' + this.parent.crudModule.crudObj.sourceEvent[i].groupIndex + '\"]'));\n        this.removeEventWrapper(appElement);\n\n        if (this.parent.crudModule.crudObj.targetEvent[i] && this.parent.crudModule.crudObj.sourceEvent[i].groupIndex !== this.parent.crudModule.crudObj.targetEvent[i].groupIndex) {\n          const ele = [].slice.call(this.element.querySelectorAll('.e-appointment-wrapper ' + '[data-group-index=\"' + this.parent.crudModule.crudObj.targetEvent[i].groupIndex + '\"]'));\n          this.removeEventWrapper(ele);\n        }\n      }\n    } else {\n      for (const wrap of appointmentWrapper) {\n        remove(wrap);\n      }\n    }\n\n    this.removeHeightProperty(CONTENT_TABLE_CLASS);\n\n    if (!this.element.querySelector('.' + WORK_CELLS_CLASS)) {\n      return;\n    }\n\n    if (this.parent.currentView === 'Month') {\n      const wrapper = createElement('div', {\n        className: APPOINTMENT_WRAPPER_CLASS\n      });\n      const cellTd = this.parent.element.querySelector('.' + WORK_CELLS_CLASS);\n      cellTd.appendChild(wrapper);\n      this.monthHeaderHeight = wrapper.offsetTop - cellTd.offsetTop;\n      cellTd.removeChild(wrapper);\n    }\n\n    this.eventHeight = getElementHeightFromClass(this.element, APPOINTMENT_CLASS);\n    const scrollTop = conWrap.scrollTop;\n\n    if (this.parent.rowAutoHeight && this.parent.virtualScrollModule && !isNullOrUndefined(this.parent.currentAction)) {\n      conWrap.scrollTop = conWrap.scrollTop - 1;\n    }\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      this.renderResourceEvents();\n\n      if (this.parent.virtualScrollModule) {\n        this.parent.virtualScrollModule.updateFocusedWorkCell();\n      }\n    } else {\n      this.renderEventsHandler(this.parent.activeView.renderDates, this.parent.activeViewOptions.workDays);\n    }\n\n    if (this.parent.rowAutoHeight) {\n      this.updateBlockElements();\n      const data = {\n        cssProperties: this.parent.getCssProperties(),\n        module: this.parent.getModuleName(),\n        isPreventScrollUpdate: true,\n        scrollPosition: {\n          left: this.parent.uiStateValues.left,\n          top: this.parent.uiStateValues.top\n        }\n      };\n\n      if (this.parent.virtualScrollModule) {\n        if (this.parent.currentAction) {\n          conWrap.scrollTop = scrollTop;\n          this.parent.currentAction = null;\n        } else {\n          this.parent.virtualScrollModule.updateVirtualScrollHeight();\n        }\n      }\n\n      if (!this.parent.enablePersistence) {\n        this.parent.notify(contentReady, {});\n      }\n\n      this.parent.notify(scrollUiUpdate, data);\n\n      if (this.parent.currentView === 'Month' && this.parent.showWeekNumber) {\n        const totalCells = [].slice.call(this.parent.element.querySelectorAll('.e-content-wrap table tr td:first-child'));\n        const weekNumberCells = [].slice.call(this.parent.element.querySelectorAll('.' + WEEK_NUMBER_CLASS));\n        weekNumberCells.forEach((cell, i) => {\n          const height = totalCells[i].offsetHeight;\n          setStyleAttribute(cell, {\n            'height': height + 'px'\n          });\n        });\n        this.parent.element.querySelector('.' + WEEK_NUMBER_WRAPPER_CLASS).scrollTop = this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS).scrollTop;\n      }\n    }\n\n    this.parent.renderTemplates();\n  }\n\n  renderEventsHandler(dateRender, workDays, resData) {\n    this.renderedEvents = [];\n    let eventsList;\n    let blockList;\n    let resIndex = 0;\n\n    if (resData) {\n      resIndex = resData.groupIndex;\n      this.cssClass = resData.cssClass;\n      this.groupOrder = resData.groupOrder;\n      eventsList = this.parent.eventBase.filterEventsByResource(resData, this.parent.eventsProcessed);\n      blockList = this.parent.eventBase.filterEventsByResource(resData, this.parent.blockProcessed);\n      this.workCells = [].slice.call(this.element.querySelectorAll('.' + WORK_CELLS_CLASS + '[data-group-index=\"' + resIndex + '\"]'));\n    } else {\n      eventsList = this.parent.eventsProcessed;\n      blockList = this.parent.blockProcessed;\n      this.workCells = [].slice.call(this.element.querySelectorAll('.' + WORK_CELLS_CLASS));\n    }\n\n    this.sortByDateTime(eventsList);\n    this.sortByDateTime(blockList);\n\n    if (this.parent.currentView === 'Month' && this.parent.rowAutoHeight && this.parent.activeViewOptions.group.resources.length === 0) {\n      const totalCells = [].slice.call(this.parent.element.querySelectorAll('.e-content-wrap table tr td:first-child'));\n      const height = this.parent.element.querySelector('.' + CONTENT_TABLE_CLASS).clientHeight / totalCells.length;\n      totalCells.forEach(cell => {\n        setStyleAttribute(cell, {\n          'height': height + 'px'\n        });\n      });\n    }\n\n    const cellDetail = this.workCells[this.parent.activeView.isTimelineView() ? 0 : this.workCells.length - 1].getBoundingClientRect();\n    this.cellWidth = cellDetail.width;\n    this.cellHeight = cellDetail.height;\n    this.dateRender = dateRender;\n    const filteredDates = this.getRenderedDates(dateRender);\n    this.getSlotDates(workDays || this.parent.activeViewOptions.workDays);\n    this.processBlockEvents(blockList, resIndex, resData);\n    let events = [];\n\n    for (const event of eventsList) {\n      if (this.parent.resourceBase && !resData) {\n        this.cssClass = this.parent.resourceBase.getCssClass(event);\n      }\n\n      events = events.concat(this.splitEvent(event, filteredDates || this.dateRender));\n    }\n\n    for (let level = 0; level < this.slots.length; level++) {\n      this.renderedEvents = [];\n      const slot = this.slots[level];\n      const endDate = addDays(new Date(slot[slot.length - 1]), 1);\n      const spannedEvents = this.filterEvents(new Date(slot[0]), endDate, events);\n\n      for (const event of spannedEvents) {\n        if (this.maxHeight) {\n          const sDate = this.parent.currentView === 'Month' ? event[this.fields.startTime] : this.getStartTime(event, event.data);\n\n          if (this.getIndex(sDate) > 0) {\n            continue;\n          }\n        }\n\n        this.updateIndicatorIcon(event);\n        this.renderEvents(event, resIndex, eventsList);\n      }\n    }\n\n    this.cssClass = null;\n    this.groupOrder = null;\n  }\n\n  processBlockEvents(blockEvents, resIndex, resData) {\n    for (const event of blockEvents) {\n      if (this.parent.resourceBase && !resData) {\n        this.cssClass = this.parent.resourceBase.getCssClass(event);\n      }\n\n      const blockSpannedList = [];\n\n      if (this.renderType === 'day' && !event[this.fields.isAllDay]) {\n        const temp = extend({}, event, null, true);\n        let isSameDate = this.isSameDate(temp[this.fields.startTime], temp[this.fields.endTime]);\n        temp.isBlockIcon = isSameDate;\n\n        if (!isSameDate && getDateInMs(temp[this.fields.startTime]) > 0) {\n          const e = extend({}, event, null, true);\n          e[this.fields.endTime] = addDays(resetTime(new Date(event[this.fields.startTime] + '')), 1);\n          e.isBlockIcon = true;\n          temp[this.fields.startTime] = e[this.fields.endTime];\n          blockSpannedList.push(e);\n        }\n\n        isSameDate = this.isSameDate(temp[this.fields.startTime], temp[this.fields.endTime]);\n\n        if (!isSameDate && getDateInMs(temp[this.fields.endTime]) > 0) {\n          const e = extend({}, event, null, true);\n          e[this.fields.startTime] = resetTime(new Date(event[this.fields.endTime] + ''));\n          e.isBlockIcon = true;\n          blockSpannedList.push(e);\n          temp[this.fields.endTime] = e[this.fields.startTime];\n        }\n\n        blockSpannedList.push(temp);\n      } else {\n        blockSpannedList.push(event);\n      }\n\n      for (const blockEvent of blockSpannedList) {\n        const spannedEvents = this.splitEvent(blockEvent, this.dateRender);\n\n        for (const event of spannedEvents) {\n          this.renderBlockEvents(event, resIndex, !!blockEvent.isBlockIcon);\n        }\n      }\n    }\n  }\n\n  isSameDate(start, end) {\n    return new Date(+start).setHours(0, 0, 0, 0) === new Date(+end).setHours(0, 0, 0, 0);\n  }\n\n  renderBlockEvents(event, resIndex, isIcon) {\n    const eventData = event.data;\n    const startTime = this.getStartTime(event, eventData);\n    const endTime = this.getEndTime(event, eventData);\n    const day = this.parent.getIndexOfDate(this.dateRender, resetTime(new Date(startTime.getTime())));\n\n    if (day < 0 || startTime > endTime) {\n      return;\n    }\n\n    const cellTd = this.getCellTd(day);\n    const position = this.getPosition(startTime, endTime, event[this.fields.isAllDay], day);\n\n    if (!isIcon) {\n      const diffInDays = eventData.count;\n      let appWidth = this.getEventWidth(startTime, endTime, event[this.fields.isAllDay], diffInDays);\n      appWidth = appWidth <= 0 ? this.cellWidth : appWidth;\n      const appLeft = this.parent.enableRtl ? 0 : position;\n      const appRight = this.parent.enableRtl ? position : 0;\n      const appHeight = this.cellHeight - this.monthHeaderHeight;\n      const appTop = this.getRowTop(resIndex);\n      const blockElement = this.createBlockAppointmentElement(event, resIndex);\n      setStyleAttribute(blockElement, {\n        'width': appWidth + 'px',\n        'height': appHeight + 'px',\n        'left': appLeft + 'px',\n        'right': appRight + 'px',\n        'top': appTop + 'px'\n      });\n      this.renderEventElement(event, blockElement, cellTd);\n    } else {\n      this.renderBlockIndicator(cellTd, position, resIndex);\n    }\n  } // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  renderBlockIndicator(cellTd, position, resIndex) {\n    const blockIndicator = createElement('div', {\n      className: 'e-icons ' + BLOCK_INDICATOR_CLASS\n    });\n\n    if (isNullOrUndefined(cellTd.querySelector('.' + BLOCK_INDICATOR_CLASS))) {\n      cellTd.appendChild(blockIndicator);\n    }\n  } // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  getStartTime(event, eventData) {\n    return event[this.fields.startTime];\n  } // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  getEndTime(event, eventData) {\n    return event[this.fields.endTime];\n  }\n\n  getCellTd(day) {\n    return this.workCells[day];\n  }\n\n  getEventWidth(startDate, endDate, isAllDay, count) {\n    return count * this.cellWidth - 1;\n  } // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  getPosition(startTime, endTime, isAllDay, day) {\n    return 0;\n  } // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  getRowTop(resIndex) {\n    return 0;\n  }\n\n  updateIndicatorIcon(event) {\n    if (this.parent.currentView.indexOf('Timeline') === -1 || this.parent.currentView === 'TimelineMonth' || event[this.fields.isAllDay]) {\n      return;\n    }\n\n    const cloneData = event.data;\n    const start = this.parent.activeView.getStartHour();\n    const end = this.parent.activeView.getEndHour();\n    const startHour = getStartEndHours(event[this.fields.startTime], start, end);\n    const endHour = getStartEndHours(event[this.fields.endTime], start, end);\n    const actualStartTime = cloneData[this.fields.startTime];\n    const actualEndTime = cloneData[this.fields.endTime];\n    cloneData.isLeft = cloneData.isLeft || actualStartTime.getTime() < startHour.startHour.getTime();\n    cloneData.isRight = cloneData.isRight || actualEndTime.getTime() > endHour.endHour.getTime();\n\n    if (resetTime(actualStartTime).getTime() !== resetTime(actualEndTime).getTime()) {\n      const actualStartHour = startHour.startHour;\n      const actualEndHour = endHour.endHour;\n      const startTime = new Date(resetTime(actualStartTime));\n      startTime.setHours(actualEndHour.getHours(), actualEndHour.getMinutes(), actualEndHour.getSeconds());\n      cloneData.isLeft = cloneData.isLeft || actualStartTime.getTime() >= (actualStartHour.getDate() === startHour.endHour.getDate() ? startTime.getTime() : addDays(startTime, 1).getTime());\n\n      if (actualEndTime.getTime() !== resetTime(actualEndTime).getTime()) {\n        const endTime = new Date(resetTime(actualEndTime));\n        cloneData.isRight = cloneData.isRight || actualEndTime.getTime() <= endTime.setHours(actualStartHour.getHours(), actualStartHour.getMinutes(), actualStartHour.getSeconds());\n      }\n    }\n  }\n\n  renderResourceEvents() {\n    const resources = this.parent.uiStateValues.isGroupAdaptive ? [this.parent.resourceBase.lastResourceLevel[this.parent.uiStateValues.groupIndex]] : this.parent.resourceBase.lastResourceLevel;\n\n    if (this.parent.crudModule && this.parent.crudModule.crudObj.isCrudAction) {\n      for (let i = 0, len = this.parent.crudModule.crudObj.sourceEvent.length; i < len; i++) {\n        const sourceRes = this.parent.crudModule.crudObj.sourceEvent[i];\n        this.renderEventsHandler(sourceRes.renderDates, sourceRes.workDays, sourceRes);\n\n        if (this.parent.crudModule.crudObj.sourceEvent[i].groupIndex !== this.parent.crudModule.crudObj.targetEvent[i].groupIndex) {\n          const target = this.parent.crudModule.crudObj.targetEvent[i];\n          this.renderEventsHandler(target.renderDates, target.workDays, target);\n        }\n      }\n\n      this.parent.crudModule.crudObj.isCrudAction = false;\n    } else {\n      for (const slotData of resources) {\n        this.renderEventsHandler(slotData.renderDates, slotData.workDays, slotData);\n      }\n    }\n  }\n\n  getSlotDates(workDays) {\n    this.slots = [];\n    const dates = this.dateRender.map(date => {\n      return +date;\n    });\n    const noOfDays = this.parent.activeViewOptions.showWeekend ? WEEK_LENGTH : workDays.length;\n\n    while (dates.length > 0) {\n      this.slots.push(dates.splice(0, noOfDays));\n    }\n  }\n\n  createAppointmentElement(record, resIndex, isCloneElement = false) {\n    const eventSubject = record[this.fields.subject] || this.parent.eventSettings.fields.subject.default || this.parent.localeObj.getConstant('addTitle');\n    const newRecord = extend({}, record, record.data, true);\n    const attrs = {\n      'data-id': 'Appointment_' + record[this.fields.id],\n      'role': 'button',\n      'tabindex': '0',\n      'aria-disabled': this.parent.eventBase.getReadonlyAttribute(record),\n      'aria-pressed': 'false',\n      'aria-grabbed': 'true',\n      'aria-label': this.parent.getAnnouncementString(newRecord, eventSubject)\n    };\n\n    if (!isCloneElement) {\n      attrs['data-guid'] = record.Guid;\n    }\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      attrs['data-group-index'] = resIndex.toString();\n    }\n\n    const appointmentWrapper = createElement('div', {\n      className: APPOINTMENT_CLASS,\n      attrs: attrs\n    });\n\n    if (!isNullOrUndefined(this.cssClass)) {\n      addClass([appointmentWrapper], this.cssClass);\n    }\n\n    if (record[this.fields.isReadonly]) {\n      addClass([appointmentWrapper], 'e-read-only');\n    }\n\n    const appointmentDetails = createElement('div', {\n      className: APPOINTMENT_DETAILS\n    });\n    appointmentWrapper.appendChild(appointmentDetails);\n    let templateElement;\n    const eventData = record.data;\n    const eventObj = this.getEventData(record);\n\n    if (!isNullOrUndefined(this.parent.activeViewOptions.eventTemplate)) {\n      const scheduleId = this.parent.element.id + '_';\n      const viewName = this.parent.activeViewOptions.eventTemplateName;\n      const templateId = scheduleId + viewName + 'eventTemplate';\n      const eventTemplate = 'eventTemplate' + (this.parent.activeViewOptions.group.resources.length > 0 ? '_' + resIndex : '');\n      templateElement = this.parent.getAppointmentTemplate()(eventObj, this.parent, eventTemplate, templateId, false);\n    } else {\n      const eventLocation = record[this.fields.location] || this.parent.eventSettings.fields.location.default || '';\n      const appointmentSubject = createElement('div', {\n        className: SUBJECT_CLASS,\n        innerHTML: eventSubject + (eventLocation ? ';&nbsp' + eventLocation : '')\n      });\n      const appointmentStartTime = createElement('div', {\n        className: APPOINTMENT_TIME + (this.parent.isAdaptive ? ' ' + DISABLE_CLASS : ''),\n        innerHTML: this.parent.getTimeString(eventData[this.fields.startTime])\n      });\n      const appointmentEndTime = createElement('div', {\n        className: APPOINTMENT_TIME + (this.parent.isAdaptive ? ' ' + DISABLE_CLASS : ''),\n        innerHTML: this.parent.getTimeString(eventData[this.fields.endTime])\n      });\n\n      if (this.parent.currentView === 'Month') {\n        if (record[this.fields.isAllDay]) {\n          templateElement = [appointmentSubject];\n          addClass([appointmentSubject], 'e-text-center');\n        } else if (eventData.count <= 1 && !eventData.isLeft && !eventData.isRight) {\n          templateElement = [appointmentStartTime, appointmentSubject];\n        } else {\n          templateElement = [];\n          addClass([appointmentSubject], 'e-text-center');\n\n          if (!eventData.isLeft) {\n            templateElement.push(appointmentStartTime);\n          }\n\n          templateElement.push(appointmentSubject);\n\n          if (!eventData.isRight) {\n            templateElement.push(appointmentEndTime);\n          }\n        }\n      } else {\n        let innerElement;\n\n        if (record[this.fields.isAllDay]) {\n          const allDayString = createElement('div', {\n            className: APPOINTMENT_TIME,\n            innerHTML: this.parent.localeObj.getConstant('allDay')\n          });\n          innerElement = [appointmentSubject, allDayString];\n        } else {\n          const timeString = this.parent.getTimeString(eventData[this.fields.startTime]) + ' - ' + this.parent.getTimeString(eventData[this.fields.endTime]);\n          const appTime = createElement('div', {\n            className: APPOINTMENT_TIME + (this.parent.isAdaptive ? ' ' + DISABLE_CLASS : ''),\n            innerHTML: timeString\n          });\n          const appLocation = createElement('div', {\n            className: LOCATION_CLASS,\n            innerHTML: eventLocation\n          });\n          innerElement = [appointmentSubject, appTime, appLocation];\n        }\n\n        const wrap = createElement('div', {\n          className: 'e-inner-wrap'\n        });\n        append(innerElement, wrap);\n        templateElement = [wrap];\n      }\n    }\n\n    append(templateElement, appointmentDetails);\n    this.appendEventIcons(record, appointmentDetails);\n    this.renderResizeHandler(appointmentWrapper, record.data, record[this.fields.isReadonly]);\n    return appointmentWrapper;\n  }\n\n  appendEventIcons(record, appointmentDetails) {\n    const eventData = record.data;\n\n    if (!isNullOrUndefined(record[this.fields.recurrenceRule]) || !isNullOrUndefined(record[this.fields.recurrenceID])) {\n      const iconClass = record[this.fields.id] === record[this.fields.recurrenceID] ? EVENT_RECURRENCE_ICON_CLASS : EVENT_RECURRENCE_EDIT_ICON_CLASS;\n      appointmentDetails.appendChild(createElement('div', {\n        className: ICON + ' ' + iconClass + (this.parent.isAdaptive ? ' ' + DISABLE_CLASS : '')\n      }));\n    }\n\n    if (eventData.isLeft) {\n      const iconLeft = createElement('div', {\n        className: EVENT_INDICATOR_CLASS + ' ' + ICON + ' ' + EVENT_ICON_LEFT_CLASS\n      });\n      prepend([iconLeft], appointmentDetails);\n    }\n\n    if (eventData.isRight) {\n      const iconRight = createElement('div', {\n        className: EVENT_INDICATOR_CLASS + ' ' + ICON + ' ' + EVENT_ICON_RIGHT_CLASS\n      });\n      append([iconRight], appointmentDetails);\n    }\n  } // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  renderEvents(event, resIndex, eventsList) {\n    const startTime = event[this.fields.startTime];\n    const endTime = event[this.fields.endTime];\n    const day = this.parent.getIndexOfDate(this.dateRender, resetTime(startTime));\n\n    if (day < 0 || startTime.getTime() < this.parent.minDate.getTime() || endTime.getTime() > this.parent.maxDate.getTime()) {\n      return;\n    }\n\n    const overlapCount = this.getIndex(startTime);\n    event.Index = overlapCount;\n    const diffInDays = event.data.count;\n\n    if (startTime.getTime() <= endTime.getTime()) {\n      const appWidth = diffInDays * this.cellWidth - 5;\n      const cellTd = this.workCells[day];\n      const appTop = overlapCount * (this.eventHeight + EVENT_GAP);\n      const height = this.monthHeaderHeight + (overlapCount + 1) * (this.eventHeight + EVENT_GAP) + this.moreIndicatorHeight;\n      const enableAppRender = this.maxOrIndicator ? overlapCount < 1 ? true : false : this.cellHeight > height;\n\n      if (this.parent.rowAutoHeight || enableAppRender) {\n        this.renderedEvents.push(extend({}, event, null, true));\n        let appointmentElement;\n\n        if (this.inlineValue) {\n          appointmentElement = this.parent.inlineModule.createInlineAppointmentElement();\n        } else {\n          appointmentElement = this.createAppointmentElement(event, resIndex);\n        }\n\n        this.applyResourceColor(appointmentElement, event, 'backgroundColor', this.groupOrder);\n        this.wireAppointmentEvents(appointmentElement, event);\n        setStyleAttribute(appointmentElement, {\n          'width': appWidth + 'px',\n          'top': appTop + 'px'\n        });\n        this.renderEventElement(event, appointmentElement, cellTd);\n\n        if (this.parent.rowAutoHeight) {\n          const firstChild = cellTd.parentElement.firstElementChild;\n          this.updateCellHeight(firstChild, height);\n        }\n      } else {\n        for (let i = 0; i < diffInDays; i++) {\n          if (this.workCells[day + i]) {\n            const indicator = this.workCells[day + i].querySelector('.' + MORE_INDICATOR_CLASS);\n\n            if (indicator) {\n              const count = parseInt(indicator.getAttribute('data-count'), 10) + 1;\n              indicator.setAttribute('data-count', count.toString());\n              indicator.innerHTML = this.getMoreIndicatorText(count);\n            } else {\n              const startDate = new Date(this.dateRender[day + i].getTime());\n              const endDate = addDays(this.dateRender[day + i], 1);\n              const groupIndex = this.workCells[day + i].getAttribute('data-group-index');\n              const moreIndicatorElement = this.getMoreIndicatorElement(1, startDate, endDate);\n\n              if (!isNullOrUndefined(groupIndex)) {\n                moreIndicatorElement.setAttribute('data-group-index', groupIndex);\n              }\n\n              moreIndicatorElement.style.top = this.cellHeight - this.monthHeaderHeight - this.moreIndicatorHeight + 'px';\n              moreIndicatorElement.style.width = this.cellWidth - 2 + 'px';\n              this.renderElement(this.workCells[day + i], moreIndicatorElement);\n              EventHandler.add(moreIndicatorElement, 'click', this.moreIndicatorClick, this);\n            }\n          }\n        }\n      }\n    }\n  }\n\n  updateCellHeight(cell, height) {\n    if (height > cell.offsetHeight) {\n      setStyleAttribute(cell, {\n        'height': height + 'px'\n      });\n    }\n  }\n\n  updateBlockElements() {\n    const blockElement = [].slice.call(this.element.querySelectorAll('.' + BLOCK_APPOINTMENT_CLASS));\n\n    for (const element of blockElement) {\n      const target = closest(element, 'tr');\n      this.monthHeaderHeight = element.offsetParent.offsetTop - target.offsetTop;\n      element.style.height = target.offsetHeight - 1 - this.monthHeaderHeight + 'px';\n      const firstChild = target.firstElementChild;\n      const width = Math.round(element.offsetWidth / firstChild.offsetWidth);\n      element.style.width = firstChild.offsetWidth * width + 'px';\n    }\n  } // eslint-disable-next-line max-len\n\n\n  getFilteredEvents(startDate, endDate, groupIndex, eventsList) {\n    let filteredEvents;\n\n    if (isNullOrUndefined(groupIndex)) {\n      filteredEvents = this.filterEvents(startDate, endDate);\n    } else {\n      const data = this.parent.resourceBase.lastResourceLevel[parseInt(groupIndex, 10)];\n      filteredEvents = this.filterEvents(startDate, endDate, isNullOrUndefined(eventsList) ? undefined : eventsList, data);\n    }\n\n    return filteredEvents;\n  }\n\n  getOverlapEvents(date, appointments) {\n    const appointmentsList = [];\n    const dateTime = resetTime(date).getTime();\n\n    for (const app of appointments) {\n      if (resetTime(app[this.fields.startTime]).getTime() <= dateTime && resetTime(app[this.fields.endTime]).getTime() >= dateTime) {\n        appointmentsList.push(app);\n      }\n    }\n\n    return appointmentsList;\n  }\n\n  getIndex(date) {\n    let appIndex = -1;\n    const appointments = this.renderedEvents;\n\n    if (appointments.length > 0) {\n      const appointmentsList = this.getOverlapEvents(date, appointments);\n      const appLevel = appointmentsList.map(obj => obj.Index);\n      appIndex = appLevel.length > 0 ? this.getSmallestMissingNumber(appLevel) : 0;\n    }\n\n    return appIndex === -1 ? 0 : appIndex;\n  }\n\n  moreIndicatorClick(event) {\n    const target = closest(event.target, '.' + MORE_INDICATOR_CLASS);\n    const startDate = new Date(parseInt(target.getAttribute('data-start-date'), 10));\n    const endDate = new Date(parseInt(target.getAttribute('data-end-date'), 10));\n    const groupIndex = target.getAttribute('data-group-index');\n    const moreArgs = {\n      cancel: false,\n      event: event,\n      element: target,\n      isPopupOpen: true,\n      startTime: startDate,\n      endTime: endDate,\n      viewName: this.parent.getNavigateView()\n    };\n\n    if (groupIndex) {\n      moreArgs.groupIndex = parseInt(groupIndex, 10);\n    }\n\n    this.parent.trigger(moreEventsClick, moreArgs, clickArgs => {\n      if (!clickArgs.cancel) {\n        if (clickArgs.isPopupOpen) {\n          const filteredEvents = this.getFilteredEvents(startDate, endDate, groupIndex);\n          const moreArgs = {\n            date: startDate,\n            event: filteredEvents,\n            element: event.target\n          };\n          this.parent.quickPopup.moreEventClick(moreArgs, endDate, groupIndex);\n        } else {\n          this.parent.setProperties({\n            selectedDate: startDate\n          }, true);\n          this.parent.changeView(clickArgs.viewName, event);\n        }\n      }\n    });\n  }\n\n  renderEventElement(event, appointmentElement, cellTd) {\n    const eventType = appointmentElement.classList.contains(BLOCK_APPOINTMENT_CLASS) ? 'blockEvent' : 'event';\n    const isAppointment = appointmentElement.classList.contains(APPOINTMENT_CLASS);\n    const eventObj = this.getEventData(event);\n    const args = {\n      data: eventObj,\n      element: appointmentElement,\n      cancel: false,\n      type: eventType\n    };\n    this.parent.trigger(eventRendered, args, eventArgs => {\n      if (eventArgs.cancel) {\n        this.renderedEvents.pop();\n      } else {\n        this.renderElement(cellTd, appointmentElement, isAppointment);\n      }\n    });\n  }\n\n  getEventData(event) {\n    const eventObj = extend({}, event, null, true);\n    eventObj[this.fields.startTime] = event.data[this.fields.startTime];\n    eventObj[this.fields.endTime] = event.data[this.fields.endTime];\n    return eventObj;\n  }\n\n  renderElement(cellTd, element, isAppointment = false) {\n    if (this.maxOrIndicator && isAppointment) {\n      this.setMaxEventHeight(element, cellTd);\n    }\n\n    const wrapperEle = cellTd.querySelector('.' + APPOINTMENT_WRAPPER_CLASS);\n\n    if (wrapperEle) {\n      wrapperEle.appendChild(element);\n    } else {\n      const wrapper = createElement('div', {\n        className: APPOINTMENT_WRAPPER_CLASS\n      });\n      wrapper.appendChild(element);\n      cellTd.appendChild(wrapper);\n    }\n  }\n\n  getMoreIndicatorElement(count, startDate, endDate) {\n    const moreIndicatorElement = createElement('div', {\n      className: MORE_INDICATOR_CLASS,\n      innerHTML: this.getMoreIndicatorText(count),\n      attrs: {\n        'tabindex': '0',\n        'data-count': count.toString(),\n        'data-start-date': startDate.getTime().toString(),\n        'data-end-date': endDate.getTime().toString()\n      }\n    });\n    return moreIndicatorElement;\n  }\n\n  getMoreIndicatorText(count) {\n    return '+' + this.parent.globalize.formatNumber(count) + '&nbsp;' + (this.parent.isAdaptive ? '' : this.parent.localeObj.getConstant('more'));\n  }\n\n  removeHeightProperty(selector) {\n    const rows = [].slice.call(this.element.querySelectorAll('.' + selector + ' tbody tr'));\n\n    for (const row of rows) {\n      row.firstElementChild.style.height = '';\n    }\n  }\n\n  setMaxEventHeight(event, cell) {\n    const headerHeight = getOuterHeight(cell.querySelector('.' + DATE_HEADER_CLASS));\n    const height = cell.offsetHeight - headerHeight - (this.maxHeight ? 0 : this.moreIndicatorHeight);\n    setStyleAttribute(event, {\n      'height': height + 'px',\n      'align-items': 'center'\n    });\n  }\n\n  destroy() {\n    this.element = null;\n    this.fields = null;\n    this.maxHeight = null;\n    this.withIndicator = null;\n    this.maxOrIndicator = null;\n    this.moreIndicatorHeight = null;\n    this.removeEventListener();\n    super.destroy();\n  }\n\n}\n/* eslint-disable max-len */\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\n\nconst EVENT_GAP$1 = 2;\nconst BLOCK_INDICATOR_WIDTH = 22;\nconst BLOCK_INDICATOR_HEIGHT = 18;\n/**\n * Timeline view events render\n */\n\nclass TimelineEvent extends MonthEvent {\n  constructor(parent, type) {\n    super(parent);\n    this.startHour = this.parent.activeView.getStartHour();\n    this.endHour = this.parent.activeView.getEndHour();\n    this.slotCount = this.parent.activeViewOptions.timeScale.slotCount;\n    this.interval = this.parent.activeViewOptions.timeScale.interval;\n    this.day = 0;\n    this.rowIndex = 0;\n    this.cellTops = [];\n    this.renderType = type;\n    this.eventContainers = [].slice.call(this.element.querySelectorAll('.' + APPOINTMENT_CONTAINER_CLASS));\n    const tr = [].slice.call(this.element.querySelectorAll('.' + CONTENT_TABLE_CLASS + ' tbody tr'));\n    this.dayLength = tr.length === 0 ? 0 : tr[0].children.length;\n    this.content = this.parent.element.querySelector('.' + CONTENT_TABLE_CLASS);\n  }\n\n  getSlotDates() {\n    this.slots = [];\n    this.slots.push(this.parent.activeView.renderDates.map(date => {\n      return +date;\n    }));\n\n    if (this.parent.activeViewOptions.headerRows.length > 0 && this.parent.activeViewOptions.headerRows.slice(-1)[0].option !== 'Hour') {\n      this.renderType = 'day';\n      this.cellWidth = this.content.offsetWidth / this.dateRender.length;\n      this.slotsPerDay = 1;\n    } else {\n      this.slotsPerDay = this.dayLength / this.dateRender.length;\n    }\n  }\n\n  getOverlapEvents(date, appointments) {\n    const appointmentsList = [];\n\n    if (this.renderType === 'day') {\n      for (const app of appointments) {\n        if (resetTime(app[this.fields.startTime]).getTime() <= resetTime(new Date(date.getTime())).getTime() && resetTime(app[this.fields.endTime]).getTime() >= resetTime(new Date(date.getTime())).getTime()) {\n          appointmentsList.push(app);\n        }\n      }\n    } else {\n      for (const app of appointments) {\n        const eventData = app.data;\n\n        if (eventData.trimStartTime.getTime() <= date.getTime() && eventData.trimEndTime.getTime() > date.getTime()) {\n          appointmentsList.push(app);\n        }\n      }\n    }\n\n    return appointmentsList;\n  }\n\n  getSortComparerIndex(startDate, endDate) {\n    let appIndex = -1;\n    const appointments = this.renderedEvents;\n\n    if (appointments.length > 0) {\n      const appointmentsList = this.getOverlapSortComparerEvents(startDate, endDate, appointments);\n      const appLevel = appointmentsList.map(obj => obj.Index);\n      appIndex = appLevel.length > 0 ? this.getSmallestMissingNumber(appLevel) : 0;\n    }\n\n    return appIndex === -1 ? 0 : appIndex;\n  }\n\n  getOverlapSortComparerEvents(startDate, endDate, appointmentsCollection) {\n    const appointments = [];\n\n    for (const app of appointmentsCollection) {\n      if (this.renderType === 'day') {\n        if (resetTime(app[this.fields.startTime]).getTime() <= resetTime(new Date(startDate.getTime())).getTime() && resetTime(app[this.fields.endTime]).getTime() >= resetTime(new Date(startDate.getTime())).getTime()) {\n          appointments.push(app);\n        }\n      } else {\n        const eventData = app.data;\n\n        if (eventData.trimStartTime.getTime() <= startDate.getTime() && startDate.getTime() < eventData.trimEndTime.getTime() || startDate.getTime() <= eventData.trimStartTime.getTime() && eventData.trimStartTime.getTime() < endDate.getTime()) {\n          appointments.push(app);\n        }\n      }\n    }\n\n    return appointments;\n  }\n\n  renderResourceEvents() {\n    this.removeHeightProperty(RESOURCE_COLUMN_TABLE_CLASS);\n    const resources = this.parent.uiStateValues.isGroupAdaptive ? [this.parent.resourceBase.lastResourceLevel[this.parent.uiStateValues.groupIndex]] : this.parent.resourceBase.renderedResources;\n\n    if (this.parent.crudModule && this.parent.crudModule.crudObj.isCrudAction) {\n      for (let i = 0, len = this.parent.crudModule.crudObj.sourceEvent.length; i < len; i++) {\n        const source = this.parent.crudModule.crudObj.sourceEvent[i];\n        this.rowIndex = source.groupIndex;\n        this.renderEventsHandler(this.parent.activeView.renderDates, this.parent.activeViewOptions.workDays, source);\n\n        if (this.parent.crudModule.crudObj.targetEvent[i] && this.parent.crudModule.crudObj.sourceEvent[i].groupIndex !== this.parent.crudModule.crudObj.targetEvent[i].groupIndex) {\n          const target = this.parent.crudModule.crudObj.targetEvent[i];\n          this.rowIndex = target.groupIndex;\n          this.renderEventsHandler(this.parent.activeView.renderDates, this.parent.activeViewOptions.workDays, target);\n        }\n      }\n\n      this.parent.crudModule.crudObj.isCrudAction = false;\n    } else {\n      for (let i = 0; i < resources.length; i++) {\n        this.rowIndex = i;\n        this.renderEventsHandler(this.parent.activeView.renderDates, this.parent.activeViewOptions.workDays, resources[i]);\n      }\n    }\n  }\n\n  renderEvents(event, resIndex, appointmentsList) {\n    let startTime = event[this.fields.startTime];\n    let endTime = event[this.fields.endTime];\n\n    if (startTime.getTime() < this.parent.minDate.getTime() || endTime.getTime() > this.parent.maxDate.getTime()) {\n      return;\n    }\n\n    const eventData = event.data;\n    startTime = this.getStartTime(event, eventData);\n    endTime = this.getEndTime(event, eventData);\n    const startEndHours = getStartEndHours(event[this.fields.startTime], this.startHour, this.endHour);\n    const eventDates = this.updateEventMinimumDuration(startEndHours, startTime, endTime);\n    startTime = eventDates.startDate;\n    endTime = eventDates.endDate;\n    this.day = this.parent.getIndexOfDate(this.dateRender, resetTime(new Date(startTime.getTime())));\n\n    if (this.day < 0) {\n      return;\n    }\n\n    const cellTd = this.getCellTd();\n    const overlapCount = isNullOrUndefined(this.parent.eventSettings.sortComparer) ? this.getIndex(startTime) : this.getSortComparerIndex(startTime, endTime);\n    event.Index = overlapCount;\n    const appHeight = this.eventHeight;\n    const diffInDays = eventData.count;\n    const eventObj = extend({}, event, null, true);\n    eventObj[this.fields.startTime] = eventData[this.fields.startTime];\n    eventObj[this.fields.endTime] = eventData[this.fields.endTime];\n    const currentDate = resetTime(new Date(this.dateRender[this.day].getTime()));\n    const schedule = getStartEndHours(currentDate, this.startHour, this.endHour);\n    const isValidEvent = this.isValidEvent(eventObj, startTime, endTime, schedule);\n\n    if (startTime <= endTime && isValidEvent) {\n      let appWidth = this.getEventWidth(startTime, endTime, event[this.fields.isAllDay], diffInDays);\n      appWidth = this.renderType === 'day' ? appWidth - 2 : appWidth;\n      let appLeft = 0;\n      let appRight = 0;\n      const position = this.getPosition(startTime, endTime, event[this.fields.isAllDay], this.day);\n      appWidth = appWidth <= 0 ? this.cellWidth : appWidth; // appWidth 0 when start and end time as same\n\n      this.renderedEvents.push(extend({}, event, null, true));\n\n      if (isNullOrUndefined(this.cellTops[resIndex])) {\n        this.cellTops[resIndex] = this.getRowTop(resIndex);\n      }\n\n      const top = this.cellTops[resIndex];\n      const appTop = top + (this.maxHeight ? 0 : EVENT_GAP$1) + overlapCount * (appHeight + EVENT_GAP$1);\n      appLeft = this.parent.enableRtl ? 0 : position;\n      appRight = this.parent.enableRtl ? position : 0;\n      const height = (overlapCount + 1) * (appHeight + EVENT_GAP$1) + this.moreIndicatorHeight;\n      const renderApp = this.maxOrIndicator ? overlapCount < 1 ? true : false : this.cellHeight > height;\n\n      if (this.parent.rowAutoHeight || renderApp) {\n        let appointmentElement;\n\n        if (isNullOrUndefined(this.inlineValue)) {\n          appointmentElement = this.createAppointmentElement(event, resIndex);\n        } else {\n          appointmentElement = this.parent.inlineModule.createInlineAppointmentElement();\n        }\n\n        this.applyResourceColor(appointmentElement, event, 'backgroundColor', this.groupOrder);\n        setStyleAttribute(appointmentElement, {\n          'width': appWidth + 'px',\n          'left': appLeft + 'px',\n          'right': appRight + 'px',\n          'top': appTop + 'px'\n        });\n        this.wireAppointmentEvents(appointmentElement, event);\n        this.renderEventElement(event, appointmentElement, cellTd);\n\n        if (this.parent.rowAutoHeight) {\n          const firstChild = this.getFirstChild(resIndex);\n          this.updateCellHeight(firstChild, height);\n        }\n\n        if (this.parent.activeViewOptions.option !== 'TimelineMonth' && this.parent.activeViewOptions.timeScale.enable && appWidth < this.cellWidth) {\n          const resizeHandlers = [].slice.call(appointmentElement.querySelectorAll('.' + EVENT_RESIZE_CLASS));\n          resizeHandlers.forEach(resizeHandler => {\n            resizeHandler.style.width = Math.ceil(appWidth / resizeHandler.getBoundingClientRect().width) + 'px';\n          });\n        }\n      } else {\n        for (let i = 0; i < diffInDays; i++) {\n          const moreIndicator = cellTd.querySelector('.' + MORE_INDICATOR_CLASS);\n          let appPos = this.parent.enableRtl ? appRight : appLeft;\n          appPos = Math.floor(appPos / this.cellWidth) * this.cellWidth;\n          const interval = this.interval / this.slotCount;\n          let startDate = this.parent.activeViewOptions.option === 'TimelineMonth' || this.renderType === 'day' || i !== 0 ? new Date(this.dateRender[this.day + i].getTime()) : new Date(startTime);\n          let endDate = addDays(this.dateRender[this.day + i], 1);\n\n          if (this.parent.activeViewOptions.option === 'TimelineMonth' || this.renderType === 'day') {\n            const position = this.getPosition(startDate, endDate, event[this.fields.isAllDay], this.day + i);\n            this.renderTimelineMoreIndicator(startTime, startDate, endDate, appHeight, interval, resIndex, appointmentsList, top, appLeft, appRight, cellTd, moreIndicator, appPos, position);\n          } else {\n            const slotCount = (getUniversalTime(endTime) - getUniversalTime(startTime)) / MS_PER_MINUTE * this.slotCount / this.interval;\n\n            for (let k = 0; k < slotCount; k++) {\n              startDate = k === 0 ? new Date(startDate.getTime()) : new Date(startDate.getTime() + 60000 * interval);\n              endDate = new Date(startDate.getTime() + 60000 * interval);\n\n              if (endDate.getTime() > endTime.getTime()) {\n                break;\n              }\n\n              const position = this.getPosition(startDate, endDate, false, this.day + i);\n\n              if (appPos > position) {\n                break;\n              }\n\n              appPos = position;\n              this.renderTimelineMoreIndicator(startTime, startDate, endDate, appHeight, interval, resIndex, appointmentsList, top, appLeft, appRight, cellTd, moreIndicator, appPos, position);\n            }\n          }\n        }\n      }\n    }\n\n    this.parent.renderTemplates();\n  }\n\n  renderTimelineMoreIndicator(startTime, startDate, endDate, appHeight, interval, resIndex, appointmentsList, top, appLeft, appRight, cellTd, moreIndicator, appPos, position) {\n    appLeft = this.parent.enableRtl ? appRight = position : position;\n    appPos = this.parent.enableRtl ? appRight : appLeft;\n    appPos = Math.floor(appPos / this.cellWidth) * this.cellWidth;\n\n    if (cellTd && isNullOrUndefined(moreIndicator) || !this.isAlreadyAvail(appPos, cellTd)) {\n      const startDateTime = this.parent.activeViewOptions.option === 'TimelineMonth' || this.renderType === 'day' ? new Date(+startTime) : startDate;\n      const slotStartTime = new Date(startDateTime.setMinutes(Math.floor(startDateTime.getMinutes() / interval) * interval));\n      const slotEndTime = new Date(slotStartTime.getTime() + 60000 * interval);\n      let groupIndex;\n\n      if (this.parent.activeViewOptions.group.resources.length > 0 && !isNullOrUndefined(resIndex)) {\n        groupIndex = resIndex.toString();\n      }\n\n      const filterEvents = this.getFilterEvents(startDate, endDate, slotStartTime, slotEndTime, groupIndex, appointmentsList);\n      const appArea = this.cellHeight - this.moreIndicatorHeight;\n      appHeight = this.withIndicator ? appArea - EVENT_GAP$1 : appHeight;\n      const renderedAppCount = Math.floor(appArea / (appHeight + EVENT_GAP$1));\n      const count = filterEvents.length - renderedAppCount <= 0 ? 1 : filterEvents.length - renderedAppCount;\n      let moreIndicatorElement;\n\n      if (this.renderType === 'day') {\n        moreIndicatorElement = this.getMoreIndicatorElement(count, startDate, endDate);\n      } else {\n        moreIndicatorElement = this.getMoreIndicatorElement(count, slotStartTime, slotEndTime);\n      }\n\n      if (!isNullOrUndefined(groupIndex)) {\n        moreIndicatorElement.setAttribute('data-group-index', groupIndex);\n      }\n\n      moreIndicatorElement.style.top = top + appArea + 'px';\n      moreIndicatorElement.style.width = this.cellWidth + 'px';\n      moreIndicatorElement.style.left = Math.floor(appLeft / this.cellWidth) * this.cellWidth + 'px';\n      moreIndicatorElement.style.right = Math.floor(appRight / this.cellWidth) * this.cellWidth + 'px';\n      this.renderElement(cellTd, moreIndicatorElement);\n      EventHandler.add(moreIndicatorElement, 'click', this.moreIndicatorClick, this);\n    }\n  }\n\n  updateCellHeight(cell, height) {\n    const cellHeight = cell.style.height === '' ? this.cellHeight : parseInt(cell.style.height, 10);\n\n    if (height > cellHeight) {\n      setStyleAttribute(cell, {\n        'height': height + 'px'\n      });\n\n      if (this.parent.activeViewOptions.group.resources.length > 0) {\n        const resourceCell = this.parent.element.querySelector('.' + RESOURCE_COLUMN_TABLE_CLASS + ' ' + 'tbody td[data-group-index=\"' + cell.getAttribute('data-group-index') + '\"]');\n\n        if (resourceCell) {\n          setStyleAttribute(resourceCell, {\n            'height': height + 'px'\n          });\n        }\n      }\n\n      const monthHeader = this.parent.element.querySelector('.e-month-header-wrapper table tr:nth-child(' + (cell.parentElement.rowIndex + 1) + ') td');\n\n      if (monthHeader) {\n        setStyleAttribute(monthHeader, {\n          'height': height + 'px'\n        });\n      }\n    }\n  }\n\n  getFirstChild(index) {\n    const query = '.' + CONTENT_TABLE_CLASS + ' tbody td';\n    let groupIndex = '';\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      groupIndex = '[data-group-index=\"' + index.toString() + '\"]';\n    }\n\n    const td = this.parent.element.querySelector(query + groupIndex);\n    return td;\n  }\n\n  updateBlockElements() {\n    const blockElement = [].slice.call(this.element.querySelectorAll('.' + BLOCK_APPOINTMENT_CLASS));\n\n    for (const element of blockElement) {\n      const resIndex = parseInt(element.getAttribute('data-group-index'), 10);\n      const firstChild = this.getFirstChild(resIndex);\n      element.style.height = firstChild.offsetHeight + 'px';\n      const width = Math.round(element.offsetWidth / firstChild.offsetWidth);\n      element.style.width = firstChild.offsetWidth * width + 'px';\n    }\n\n    const blockIndicator = [].slice.call(this.element.querySelectorAll('.' + BLOCK_INDICATOR_CLASS));\n\n    for (const element of blockIndicator) {\n      const resIndex = parseInt(element.getAttribute('data-group-index'), 10);\n      element.style.top = this.getRowTop(resIndex) + this.getFirstChild(resIndex).offsetHeight - BLOCK_INDICATOR_HEIGHT + 'px';\n    }\n  }\n\n  getStartTime(event, eventData) {\n    let startTime = event[this.fields.startTime];\n    const schedule = getStartEndHours(startTime, this.startHour, this.endHour);\n\n    if (schedule.startHour.getTime() >= eventData[this.fields.startTime]) {\n      startTime = schedule.startHour;\n    } else if (schedule.endHour.getTime() <= eventData[this.fields.startTime]) {\n      startTime = this.getNextDay(schedule.startHour, eventData);\n    } else {\n      startTime = eventData[this.fields.startTime];\n    } // To overcome the overflow\n\n\n    eventData.trimStartTime = event[this.fields.isAllDay] ? schedule.startHour : eventData[this.fields.startTime];\n    return startTime;\n  }\n\n  getNextDay(startTime, eventData) {\n    let startDate;\n\n    for (let i = 1; i <= this.dateRender.length; i++) {\n      startDate = addDays(startTime, i);\n\n      if (this.parent.getIndexOfDate(this.dateRender, resetTime(new Date(startTime.getTime()))) !== -1) {\n        eventData.count = eventData.count - 1;\n        return startDate;\n      }\n    }\n\n    return startDate;\n  }\n\n  getEndTime(event, eventData) {\n    let endTime = event[this.fields.endTime];\n    const schedule = getStartEndHours(endTime, this.startHour, this.endHour);\n\n    if (this.parent.currentView === 'TimelineMonth' || !this.parent.activeViewOptions.timeScale.enable || this.parent.activeViewOptions.headerRows.length > 0 && this.parent.activeViewOptions.headerRows.slice(-1)[0].option !== 'Hour') {\n      endTime = eventData[this.fields.endTime];\n    } else {\n      endTime = eventData[this.fields.endTime];\n\n      if (schedule.endHour.getTime() <= eventData[this.fields.endTime]) {\n        endTime = schedule.endHour;\n      }\n\n      if (schedule.startHour.getTime() >= eventData[this.fields.endTime].getTime() && !event.isAllDay) {\n        endTime = this.getPreviousDay(schedule.startHour, schedule.endHour, eventData);\n      }\n    } // To overcome the overflow\n\n\n    eventData.trimEndTime = event[this.fields.isAllDay] ? schedule.endHour : eventData[this.fields.endTime];\n    return endTime;\n  }\n\n  getPreviousDay(startTime, endTime, eventData) {\n    for (let i = 1; i <= this.dateRender.length; i++) {\n      let endDate = addDays(endTime, -i);\n\n      if (this.parent.getIndexOfDate(this.dateRender, resetTime(new Date(startTime.getTime()))) !== -1) {\n        endDate = resetTime(new Date(endDate.getTime()));\n        endDate.setHours(endTime.getHours(), endTime.getMinutes(), endTime.getSeconds());\n        const count = eventData.count;\n        const actualEndTime = eventData[this.fields.endTime];\n        eventData.count = actualEndTime.getHours() !== 0 || actualEndTime.getMinutes() !== 0 ? count - 1 : count;\n        return endDate;\n      }\n    }\n\n    return eventData[this.fields.endTime];\n  }\n\n  getEventWidth(startDate, endDate, isAllDay, count) {\n    if (this.renderType === 'day' || isAllDay) {\n      return count * this.slotsPerDay * this.cellWidth;\n    }\n\n    if (this.isSameDay(startDate, endDate)) {\n      return this.getSameDayEventsWidth(startDate, endDate);\n    } else {\n      return this.getSpannedEventsWidth(startDate, endDate, count);\n    }\n  }\n\n  getSameDayEventsWidth(startDate, endDate) {\n    return (getUniversalTime(endDate) - getUniversalTime(startDate)) / MS_PER_MINUTE * (this.cellWidth * this.slotCount) / this.interval;\n  }\n\n  getSpannedEventsWidth(startDate, endDate, diffInDays) {\n    const width = diffInDays * this.slotsPerDay * this.cellWidth;\n    let endWidth;\n    const start = getStartEndHours(resetTime(new Date(startDate.getTime())), this.startHour, this.endHour);\n    const startWidth = this.getSameDayEventsWidth(start.startHour, startDate);\n\n    if (this.parent.getIndexOfDate(this.dateRender, resetTime(new Date(endDate.getTime()))) === -1) {\n      endWidth = 0;\n    } else {\n      const end = getStartEndHours(resetTime(new Date(endDate.getTime())), this.startHour, this.endHour);\n      endWidth = this.getSameDayEventsWidth(endDate, end.endHour);\n      endWidth = this.slotsPerDay * this.cellWidth === endWidth ? 0 : endWidth;\n    }\n\n    const spannedWidth = startWidth + endWidth;\n    return width > spannedWidth ? width - spannedWidth : width - startWidth;\n  }\n\n  isSameDay(startTime, endTime) {\n    const startDay = this.parent.getIndexOfDate(this.dateRender, resetTime(new Date(startTime.getTime())));\n    const endDay = this.parent.getIndexOfDate(this.dateRender, resetTime(new Date(endTime.getTime())));\n    return startDay === endDay;\n  }\n\n  getAppointmentLeft(schedule, startTime, day) {\n    const slotTd = this.isSameDay(startTime, schedule.startHour) ? (getUniversalTime(startTime) - getUniversalTime(schedule.startHour)) / (MS_PER_MINUTE * this.interval) * this.slotCount : 0;\n\n    if (day === 0) {\n      return slotTd;\n    } else {\n      const daySlot = Math.round((getUniversalTime(schedule.endHour) - getUniversalTime(schedule.startHour)) / MS_PER_MINUTE / this.interval * this.slotCount);\n      return daySlot * day + slotTd;\n    }\n  }\n\n  getPosition(startTime, endTime, isAllDay, day) {\n    if (this.renderType === 'day' || isAllDay) {\n      return day * this.slotsPerDay * this.cellWidth;\n    }\n\n    const currentDate = resetTime(new Date(this.dateRender[day].getTime()));\n    const schedule = getStartEndHours(currentDate, this.startHour, this.endHour);\n    let cellIndex;\n\n    if (schedule.endHour.getTime() <= endTime.getTime() && schedule.startHour.getTime() >= startTime.getTime()) {\n      cellIndex = this.getAppointmentLeft(schedule, schedule.startHour, day);\n    } else if (schedule.endHour.getTime() <= endTime.getTime()) {\n      cellIndex = this.getAppointmentLeft(schedule, startTime, day);\n    } else if (schedule.startHour.getTime() >= startTime.getTime()) {\n      cellIndex = this.getAppointmentLeft(schedule, schedule.startHour, day);\n    } else {\n      cellIndex = this.getAppointmentLeft(schedule, startTime, day);\n    }\n\n    return cellIndex * this.cellWidth;\n  }\n\n  getFilterEvents(startDate, endDate, startTime, endTime, gIndex, eventsList) {\n    if (this.renderType === 'day') {\n      return this.getFilteredEvents(startDate, endDate, gIndex, eventsList);\n    } else {\n      return this.getFilteredEvents(startTime, endTime, gIndex, eventsList);\n    }\n  }\n\n  isAlreadyAvail(appPos, cellTd) {\n    const moreIndicator = [].slice.call(cellTd.querySelectorAll('.' + MORE_INDICATOR_CLASS));\n\n    for (let i = 0; i < moreIndicator.length; i++) {\n      let indicatorPos;\n\n      if (moreIndicator) {\n        indicatorPos = this.parent.enableRtl ? moreIndicator[i].style.right : moreIndicator[i].style.left;\n      }\n\n      if (parseInt(indicatorPos, 10) === Math.floor(appPos)) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  getRowTop(resIndex) {\n    if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n      return this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS + ' ' + 'tbody td[data-group-index=\"' + resIndex.toString() + '\"]').offsetTop;\n    }\n\n    return 0;\n  }\n\n  getCellTd() {\n    const wrapIndex = this.parent.uiStateValues.isGroupAdaptive ? 0 : this.rowIndex;\n    return this.eventContainers[wrapIndex];\n  }\n\n  renderBlockIndicator(cellTd, position, resIndex) {\n    // No need to render block icon for Year, Month and Week header rows\n    if (this.parent.headerRows.length > 0 && (this.parent.headerRows[this.parent.headerRows.length - 1].option !== 'Hour' || this.parent.headerRows[this.parent.headerRows.length - 1].option !== 'Date')) {\n      return;\n    }\n\n    position = Math.floor(position / this.cellWidth) * this.cellWidth + this.cellWidth - BLOCK_INDICATOR_WIDTH;\n\n    if (!this.isAlreadyAvail(position, cellTd)) {\n      const blockIndicator = createElement('div', {\n        className: 'e-icons ' + BLOCK_INDICATOR_CLASS\n      });\n\n      if (this.parent.activeViewOptions.group.resources.length > 0) {\n        blockIndicator.setAttribute('data-group-index', resIndex.toString());\n      }\n\n      if (this.parent.enableRtl) {\n        blockIndicator.style.right = position + 'px';\n      } else {\n        blockIndicator.style.left = position + 'px';\n      }\n\n      blockIndicator.style.top = this.getRowTop(resIndex) + this.cellHeight - BLOCK_INDICATOR_HEIGHT + 'px';\n      this.renderElement(cellTd, blockIndicator);\n    }\n  } // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  setMaxEventHeight(event, cell) {\n    setStyleAttribute(event, {\n      'height': this.cellHeight - (this.maxHeight ? 0 : EVENT_GAP$1) - (this.maxHeight ? 0 : this.moreIndicatorHeight) + 'px'\n    });\n  }\n\n  destroy() {\n    this.renderType = null;\n    this.eventContainers = null;\n    this.dayLength = null;\n    this.content = null;\n    super.destroy();\n    this.parent = null;\n  }\n\n}\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\n/**\n * Inline Edit interactions\n */\n\n\nclass InlineEdit {\n  constructor(parent) {\n    this.parent = parent;\n    this.parent.on(inlineClick, this.inlineEdit, this);\n  }\n\n  inlineEdit(args) {\n    if (this.parent.quickPopup) {\n      this.parent.quickPopup.quickPopupHide();\n    }\n\n    if (args.type === 'Cell') {\n      const moreWrapper = this.parent.element.querySelector('.' + MORE_POPUP_WRAPPER_CLASS);\n\n      if (moreWrapper && moreWrapper.classList.contains(POPUP_OPEN)) {\n        this.parent.quickPopup.morePopup.hide();\n      }\n\n      this.removeInlineAppointmentElement();\n      this.cellEdit(args);\n    } else {\n      if (this.parent.element.querySelector('.' + INLINE_SUBJECT_CLASS) !== args.element.querySelector('.' + INLINE_SUBJECT_CLASS)) {\n        this.removeInlineAppointmentElement();\n      }\n\n      this.eventEdit(args);\n    }\n  }\n\n  cellEdit(args) {\n    const saveObj = this.generateEventData();\n    let cellIndex = args.element.cellIndex;\n    let count = this.getEventDaysCount(saveObj);\n\n    if (count > 1) {\n      count = Math.round(count);\n      count--;\n      cellIndex = cellIndex - count;\n    }\n\n    const start = resetTime(new Date('' + saveObj[this.parent.eventFields.startTime])).getTime();\n    const end = resetTime(new Date('' + saveObj[this.parent.eventFields.endTime])).getTime();\n    const resIndex = args.groupIndex || 0;\n\n    if (this.parent.currentView === 'Day' || this.parent.currentView === 'Week' || this.parent.currentView === 'WorkWeek') {\n      const dayIndex = saveObj[this.parent.eventFields.startTime].getDay();\n      this.createVerticalViewInline(saveObj, dayIndex, resIndex, cellIndex);\n    } else if (this.parent.currentView === 'Month') {\n      this.createMonthViewInline(saveObj, resIndex, start, end);\n    } else {\n      this.createTimelineViewInline(saveObj, start, end, resIndex);\n    }\n\n    const inlineSubject = this.parent.element.querySelector('.' + INLINE_SUBJECT_CLASS);\n\n    if (inlineSubject) {\n      inlineSubject.focus();\n    }\n  }\n\n  eventEdit(args) {\n    let inlineSubject = args.element.querySelector('.' + INLINE_SUBJECT_CLASS);\n    let subject;\n\n    if (inlineSubject) {\n      subject = inlineSubject.value;\n    } else {\n      const subEle = args.element.querySelector('.' + SUBJECT_CLASS);\n      const timeEle = args.element.querySelector('.' + APPOINTMENT_TIME);\n      subject = subEle.innerText;\n      inlineSubject = createElement('input', {\n        className: INLINE_SUBJECT_CLASS,\n        attrs: {\n          value: subject\n        }\n      });\n      addClass([subEle], DISABLE_CLASS);\n\n      if (closest(args.element, '.' + MORE_POPUP_WRAPPER_CLASS)) {\n        args.element.insertBefore(inlineSubject, subEle);\n      } else if (['Agenda', 'MonthAgenda'].indexOf(this.parent.currentView) > -1) {\n        const subjectWrap = args.element.querySelector('.' + SUBJECT_WRAP);\n        subjectWrap.insertBefore(inlineSubject, subjectWrap.firstChild);\n      } else {\n        const elementSelector = ['TimelineDay', 'TimelineWeek', 'TimelineWorkWeek', 'TimelineMonth'].indexOf(this.parent.currentView) > -1 ? '.e-inner-wrap' : '.e-appointment-details';\n        args.element.querySelector(elementSelector).insertBefore(inlineSubject, timeEle);\n      }\n\n      inlineSubject.focus();\n    }\n\n    inlineSubject.setSelectionRange(subject.length, subject.length);\n  }\n\n  createVerticalViewInline(saveObj, dayIndex, resIndex, daysCount) {\n    const count = this.getEventDaysCount(saveObj);\n    const verticalEvent = new VerticalEvent(this.parent);\n    verticalEvent.initializeValues();\n    const index = verticalEvent.dateRender[resIndex].map(date => date.getDay()).indexOf(dayIndex);\n\n    if (count >= 1) {\n      verticalEvent.allDayElement = [].slice.call(this.parent.element.querySelectorAll('.' + ALLDAY_CELLS_CLASS));\n      verticalEvent.slots.push(...this.parent.activeView.renderDates.map(date => +date));\n      const allDayElements = [].slice.call(this.parent.element.querySelectorAll('.' + ALLDAY_APPOINTMENT_CLASS));\n      let allDayLevel = 0;\n\n      if (allDayElements.length > 0) {\n        allDayLevel = Math.floor(this.parent.element.querySelector('.' + ALLDAY_ROW_CLASS).getBoundingClientRect().height / allDayElements[0].offsetHeight) - 1;\n      }\n\n      verticalEvent.allDayLevel = allDayLevel;\n      verticalEvent.renderAllDayEvents(saveObj, index, resIndex, daysCount, this.parent.allowInline);\n    } else {\n      verticalEvent.renderNormalEvents(saveObj, index, resIndex, daysCount, this.parent.allowInline);\n    }\n  }\n\n  createMonthViewInline(saveObj, index, start, end) {\n    const count = this.getEventDaysCount(saveObj);\n    const saveObject = this.parent.eventBase.cloneEventObject(saveObj, start, end, count, false, false);\n    const monthEvent = new MonthEvent(this.parent);\n    monthEvent.dateRender = this.parent.activeView.renderDates;\n    monthEvent.inlineValue = this.parent.allowInline;\n    let renderDates = this.parent.activeView.renderDates;\n    let workDays = this.parent.activeViewOptions.workDays;\n    let monthCellSelector = '.' + WORK_CELLS_CLASS;\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      monthCellSelector += '[data-group-index=\"' + index + '\"]';\n      const resourceData = this.parent.resourceBase.lastResourceLevel[index];\n      renderDates = resourceData.renderDates;\n      workDays = resourceData.workDays;\n    }\n\n    monthEvent.workCells = [].slice.call(this.parent.element.querySelectorAll(monthCellSelector));\n    monthEvent.cellWidth = monthEvent.workCells[0].offsetWidth;\n    monthEvent.cellHeight = monthEvent.workCells[0].offsetHeight;\n    monthEvent.eventHeight = getElementHeightFromClass(this.parent.monthModule.element, APPOINTMENT_CLASS);\n    monthEvent.getSlotDates(workDays);\n    const filteredDates = monthEvent.getRenderedDates(renderDates);\n    const spannedEvents = monthEvent.splitEvent(saveObject, filteredDates || renderDates);\n\n    for (const eventData of spannedEvents) {\n      monthEvent.renderEvents(eventData, index);\n    }\n\n    const inlineSubject = this.parent.element.querySelector('.' + INLINE_SUBJECT_CLASS);\n    inlineSubject.focus();\n  }\n\n  createTimelineViewInline(saveObj, start, end, resIndex) {\n    const count = this.getEventDaysCount(saveObj);\n    const saveObject = this.parent.eventBase.cloneEventObject(saveObj, start, end, count, false, false);\n    const timelineView = new TimelineEvent(this.parent, this.parent.activeViewOptions.timeScale.enable ? 'hour' : 'day');\n    timelineView.dateRender = this.parent.activeView.renderDates;\n    timelineView.eventContainers = [].slice.call(this.parent.element.querySelectorAll('.' + APPOINTMENT_CONTAINER_CLASS));\n    const workCell = this.parent.element.querySelector('.' + WORK_CELLS_CLASS);\n    timelineView.inlineValue = this.parent.allowInline;\n    timelineView.cellWidth = workCell.offsetWidth;\n    timelineView.cellHeight = workCell.offsetHeight;\n    const dayLength = this.parent.element.querySelectorAll('.' + CONTENT_TABLE_CLASS + ' tbody tr').length === 0 ? 0 : this.parent.element.querySelectorAll('.' + CONTENT_TABLE_CLASS + ' tbody tr')[0].children.length;\n    timelineView.slotsPerDay = dayLength / timelineView.dateRender.length;\n    timelineView.eventHeight = getElementHeightFromClass(timelineView.element, APPOINTMENT_CLASS);\n    timelineView.renderEvents(saveObject, resIndex);\n  }\n\n  getEventDaysCount(saveObj) {\n    const startDate = saveObj[this.parent.eventFields.startTime];\n    const endDate = saveObj[this.parent.eventFields.endTime];\n    const daysCount = Math.abs(endDate.getTime() - startDate.getTime()) / MS_PER_DAY;\n    return daysCount;\n  }\n\n  generateEventData(target) {\n    const inlineElement = this.parent.element.querySelector('.' + INLINE_SUBJECT_CLASS);\n    const subject = inlineElement ? inlineElement.value : target ? target.innerHTML : '';\n    const saveObj = {};\n    saveObj[this.parent.eventFields.id] = this.parent.eventBase.getEventMaxID();\n    saveObj[this.parent.eventFields.subject] = subject;\n    saveObj[this.parent.eventFields.startTime] = this.parent.activeCellsData.startTime;\n    saveObj[this.parent.eventFields.endTime] = this.parent.activeCellsData.endTime;\n    saveObj[this.parent.eventFields.isAllDay] = this.parent.activeCellsData.isAllDay;\n    this.parent.eventWindow.setDefaultValueToObject(saveObj);\n\n    if (this.parent.resourceBase) {\n      this.parent.resourceBase.setResourceValues(saveObj, this.parent.activeCellsData.groupIndex);\n    }\n\n    return saveObj;\n  }\n\n  documentClick() {\n    const target = this.parent.element.querySelector('.' + INLINE_SUBJECT_CLASS);\n\n    if (target && target.value !== '') {\n      this.inlineCrudActions(target);\n    } else {\n      this.removeInlineAppointmentElement();\n    }\n  }\n\n  inlineCrudActions(target) {\n    if (closest(target, '.' + INLINE_APPOINTMENT_CLASS)) {\n      const saveObj = this.generateEventData(target);\n      this.parent.addEvent(saveObj);\n    } else {\n      const eventTarget = closest(target, '.' + APPOINTMENT_CLASS);\n      const eventDetails = this.parent.getEventDetails(eventTarget);\n      eventDetails[this.parent.eventFields.subject] = target.value;\n      let currentAction;\n\n      if (eventDetails[this.parent.eventFields.id] === eventDetails[this.parent.eventFields.recurrenceID]) {\n        currentAction = 'EditOccurrence';\n        eventDetails[this.parent.eventFields.id] = this.parent.eventBase.getEventMaxID();\n      }\n\n      this.parent.saveEvent(eventDetails, currentAction);\n    }\n\n    this.removeInlineAppointmentElement();\n  }\n\n  createInlineAppointmentElement(inlineData) {\n    const inlineAppointmentElement = createElement('div', {\n      className: APPOINTMENT_CLASS + ' ' + INLINE_APPOINTMENT_CLASS\n    });\n    const inlineDetails = createElement('div', {\n      className: APPOINTMENT_DETAILS\n    });\n    inlineAppointmentElement.appendChild(inlineDetails);\n    const inline = createElement('input', {\n      className: INLINE_SUBJECT_CLASS\n    });\n    inlineDetails.appendChild(inline);\n\n    if (inlineData) {\n      this.parent.eventBase.applyResourceColor(inlineAppointmentElement, inlineData, 'backgroundColor');\n    }\n\n    return inlineAppointmentElement;\n  }\n\n  removeInlineAppointmentElement() {\n    const inlineAppointment = [].slice.call(this.parent.element.querySelectorAll('.' + INLINE_APPOINTMENT_CLASS));\n\n    if (inlineAppointment.length > 0) {\n      inlineAppointment.forEach(node => remove(node));\n    }\n\n    const inlineSubject = this.parent.element.querySelector('.' + INLINE_SUBJECT_CLASS);\n\n    if (inlineSubject) {\n      const appointmentSubject = closest(inlineSubject, '.' + APPOINTMENT_CLASS);\n      removeClass([appointmentSubject.querySelector('.' + SUBJECT_CLASS)], DISABLE_CLASS);\n      remove(inlineSubject);\n    }\n  }\n\n  destroy() {\n    this.parent.off(inlineClick, this.inlineEdit);\n  }\n\n}\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\n/**\n * Appointment window field validation\n */\n\n\nclass FieldValidator {\n  renderFormValidator(form, rules, element, locale) {\n    this.element = element;\n    this.formObj = new FormValidator(form, {\n      locale: locale,\n      customPlacement: (inputElement, error) => {\n        this.errorPlacement(inputElement, error);\n      },\n      rules: rules,\n      validationComplete: args => {\n        this.validationComplete(args);\n      },\n      focusout: args => {\n        this.focusOut(args);\n      }\n    });\n  }\n\n  focusOut(args) {\n    const target = args.relatedTarget;\n\n    if (target && (target.classList.contains('e-dlg-closeicon-btn') || target.classList.contains('e-close') || target.classList.contains(ALLDAY_CELLS_CLASS) || target.classList.contains(HEADER_CELLS_CLASS) || target.classList.contains(QUICK_POPUP_EVENT_DETAILS_CLASS) || target.classList.contains(WORK_CELLS_CLASS) || target.classList.contains(EVENT_WINDOW_CANCEL_BUTTON_CLASS))) {\n      this.ignoreError = true;\n    } else {\n      this.ignoreError = false;\n    }\n  }\n\n  validationComplete(args) {\n    const elem = this.element.querySelector('#' + args.inputName + '_Error');\n\n    if (elem) {\n      elem.style.display = args.status === 'failure' ? '' : 'none';\n    }\n  }\n\n  errorPlacement(inputElement, error) {\n    const id = error.getAttribute('for');\n    const elem = this.element.querySelector('#' + id + '_Error');\n\n    if (!elem && !this.ignoreError) {\n      this.createTooltip(inputElement, error, id, '');\n    }\n\n    if (!isNullOrUndefined(elem)) {\n      elem.querySelector('.e-error').innerHTML = error.innerHTML;\n    }\n  }\n\n  createTooltip(element, error, name, display) {\n    let dlgContent;\n    let client;\n    const inputClient = element.getBoundingClientRect();\n\n    if (this.element.classList.contains(POPUP_WRAPPER_CLASS)) {\n      dlgContent = this.element;\n      client = this.element.getBoundingClientRect();\n    } else {\n      dlgContent = this.element.querySelector('.e-schedule-dialog .e-dlg-content');\n      client = dlgContent.getBoundingClientRect();\n    }\n\n    const div = createElement('div', {\n      className: 'e-tooltip-wrap e-popup ' + ERROR_VALIDATION_CLASS,\n      id: name + '_Error',\n      styles: 'display:' + display + ';top:' + (inputClient.bottom - client.top + dlgContent.scrollTop + 9) + 'px;left:' + (inputClient.left - client.left + dlgContent.scrollLeft + inputClient.width / 2) + 'px;'\n    });\n    const content = createElement('div', {\n      className: 'e-tip-content'\n    });\n    content.appendChild(error);\n    const arrow = createElement('div', {\n      className: 'e-arrow-tip e-tip-top'\n    });\n    arrow.appendChild(createElement('div', {\n      className: 'e-arrow-tip-outer e-tip-top'\n    }));\n    arrow.appendChild(createElement('div', {\n      className: 'e-arrow-tip-inner e-tip-top'\n    }));\n    div.appendChild(content);\n    div.appendChild(arrow);\n    dlgContent.appendChild(div);\n    div.style.left = parseInt(div.style.left, 10) - div.offsetWidth / 2 + 'px';\n  }\n\n  destroyToolTip() {\n    if (this.element) {\n      const elements = [].slice.call(this.element.querySelectorAll('.' + ERROR_VALIDATION_CLASS));\n\n      for (const elem of elements) {\n        remove(elem);\n      }\n    }\n\n    if (this.formObj && this.formObj.element) {\n      this.formObj.reset();\n    }\n  }\n\n  destroy() {\n    if (this.formObj && this.formObj.element && !this.formObj.isDestroyed) {\n      this.formObj.destroy();\n    }\n\n    this.formObj = null;\n    this.element = null;\n  }\n\n}\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\n\nconst EVENT_FIELD = 'e-field';\n/**\n * Quick Popups interactions\n */\n\nclass QuickPopups {\n  constructor(parent) {\n    this.isMultipleEventSelect = false;\n    this.isCrudAction = false;\n    this.parent = parent;\n    this.l10n = this.parent.localeObj;\n    this.fieldValidator = new FieldValidator();\n    this.render();\n    this.addEventListener();\n  }\n\n  render() {\n    this.renderQuickPopup();\n    this.renderMorePopup();\n    this.renderQuickDialog();\n  }\n\n  renderQuickPopup() {\n    const quickPopupWrapper = createElement('div', {\n      className: POPUP_WRAPPER_CLASS + ' e-popup-close'\n    });\n\n    if (this.parent.isAdaptive) {\n      document.body.appendChild(quickPopupWrapper);\n      addClass([quickPopupWrapper], DEVICE_CLASS);\n    } else {\n      this.parent.element.appendChild(quickPopupWrapper);\n    }\n\n    this.quickPopup = new Popup(quickPopupWrapper, {\n      targetType: this.parent.isAdaptive ? 'container' : 'relative',\n      enableRtl: this.parent.enableRtl,\n      open: this.quickPopupOpen.bind(this),\n      close: this.quickPopupClose.bind(this),\n      hideAnimation: this.parent.isAdaptive ? {\n        name: 'ZoomOut'\n      } : {\n        name: 'FadeOut',\n        duration: 150\n      },\n      showAnimation: this.parent.isAdaptive ? {\n        name: 'ZoomIn'\n      } : {\n        name: 'FadeIn',\n        duration: 150\n      },\n      collision: this.parent.isAdaptive ? {\n        X: 'fit',\n        Y: 'fit'\n      } : this.parent.enableRtl ? {\n        X: 'flip',\n        Y: 'fit'\n      } : {\n        X: 'none',\n        Y: 'fit'\n      },\n      position: this.parent.isAdaptive || this.parent.enableRtl ? {\n        X: 'left',\n        Y: 'top'\n      } : {\n        X: 'right',\n        Y: 'top'\n      },\n      viewPortElement: this.parent.isAdaptive ? document.body : this.parent.element,\n      zIndex: this.parent.isAdaptive ? 1004 : 3\n    });\n  }\n\n  renderMorePopup() {\n    const moreEventPopup = `<div class=\"${MORE_EVENT_POPUP_CLASS}\"><div class=\"${MORE_EVENT_HEADER_CLASS}\">` + `<div class=\"${MORE_EVENT_CLOSE_CLASS}\" title=\"${this.l10n.getConstant('close')}\" tabindex=\"0\"></div>` + `<div class=\"${MORE_EVENT_DATE_HEADER_CLASS}\"><div class=\"${MORE_EVENT_HEADER_DAY_CLASS}\"></div>` + `<div class=\"${MORE_EVENT_HEADER_DATE_CLASS} ${NAVIGATE_CLASS}\" tabindex=\"0\"></div></div></div></div>`;\n    const moreEventWrapper = createElement('div', {\n      className: MORE_POPUP_WRAPPER_CLASS + ' e-popup-close',\n      innerHTML: moreEventPopup\n    });\n\n    if (this.parent.isAdaptive) {\n      document.body.appendChild(moreEventWrapper);\n      addClass([moreEventWrapper], DEVICE_CLASS);\n    } else {\n      this.parent.element.appendChild(moreEventWrapper);\n    }\n\n    this.morePopup = new Popup(moreEventWrapper, {\n      targetType: this.parent.isAdaptive ? 'container' : 'relative',\n      enableRtl: this.parent.enableRtl,\n      hideAnimation: {\n        name: 'ZoomOut',\n        duration: 300\n      },\n      showAnimation: {\n        name: 'ZoomIn',\n        duration: 300\n      },\n      open: this.morePopupOpen.bind(this),\n      close: this.morePopupClose.bind(this),\n      collision: this.parent.isAdaptive ? {\n        X: 'fit',\n        Y: 'fit'\n      } : this.parent.enableRtl ? {\n        X: 'flip',\n        Y: 'fit'\n      } : {\n        X: 'flip',\n        Y: 'flip'\n      },\n      viewPortElement: this.parent.isAdaptive ? document.body : this.parent.element,\n      zIndex: this.parent.isAdaptive ? 1002 : 2\n    });\n    const closeButton = this.morePopup.element.querySelector('.' + MORE_EVENT_CLOSE_CLASS);\n    this.renderButton('e-round', ICON + ' ' + CLOSE_ICON_CLASS, false, closeButton, this.closeClick);\n    EventHandler.add(this.morePopup.element.querySelector('.' + MORE_EVENT_HEADER_DATE_CLASS), 'click', this.navigationClick, this);\n  }\n\n  renderQuickDialog() {\n    const buttonModel = [{\n      buttonModel: {\n        cssClass: 'e-quick-alertok e-flat',\n        isPrimary: true\n      },\n      click: this.dialogButtonClick.bind(this)\n    }, {\n      buttonModel: {\n        cssClass: 'e-quick-alertcancel e-flat',\n        isPrimary: false\n      },\n      click: this.dialogButtonClick.bind(this)\n    }, {\n      buttonModel: {\n        cssClass: 'e-quick-dialog-cancel e-disable e-flat',\n        isPrimary: false\n      },\n      click: this.dialogButtonClick.bind(this)\n    }];\n\n    if (this.parent.eventSettings.editFollowingEvents) {\n      const followingSeriesButton = {\n        buttonModel: {\n          cssClass: 'e-quick-alertfollowing e-flat',\n          isPrimary: false\n        },\n        click: this.dialogButtonClick.bind(this)\n      };\n      buttonModel.splice(1, 0, followingSeriesButton);\n    }\n\n    this.quickDialog = new Dialog({\n      animationSettings: {\n        effect: 'Zoom'\n      },\n      buttons: buttonModel,\n      cssClass: QUICK_DIALOG_CLASS,\n      closeOnEscape: true,\n      enableRtl: this.parent.enableRtl,\n      beforeClose: this.beforeQuickDialogClose.bind(this),\n      isModal: true,\n      position: {\n        X: 'center',\n        Y: 'center'\n      },\n      showCloseIcon: true,\n      target: document.body,\n      visible: false,\n      width: 'auto'\n    });\n    const dialogElement = createElement('div', {\n      id: this.parent.element.id + 'QuickDialog'\n    });\n    this.parent.element.appendChild(dialogElement);\n    this.quickDialog.appendTo(dialogElement);\n    const okButton = this.quickDialog.element.querySelector('.' + QUICK_DIALOG_ALERT_OK);\n\n    if (okButton) {\n      okButton.setAttribute('aria-label', this.l10n.getConstant('occurrence'));\n      okButton.setAttribute('aria-label', okButton.innerHTML);\n    }\n\n    const cancelButton = this.quickDialog.element.querySelector('.' + QUICK_DIALOG_ALERT_CANCEL);\n\n    if (cancelButton) {\n      cancelButton.setAttribute('aria-label', this.l10n.getConstant('series'));\n      cancelButton.setAttribute('aria-label', cancelButton.innerHTML);\n    }\n\n    if (this.quickDialog.element.querySelector('.e-dlg-closeicon-btn')) {\n      this.quickDialog.element.querySelector('.e-dlg-closeicon-btn').setAttribute('title', this.l10n.getConstant('close'));\n    }\n  } // eslint-disable-next-line max-len\n\n\n  renderButton(className, iconName, isDisabled, element, clickEvent) {\n    const buttonObj = new Button({\n      cssClass: className,\n      disabled: isDisabled,\n      enableRtl: this.parent.enableRtl,\n      iconCss: iconName\n    });\n    buttonObj.appendTo(element);\n    EventHandler.add(element, 'click', clickEvent, this);\n    removeClass([element], ICON);\n  }\n\n  quickDialogClass(action) {\n    const classList$$1 = [QUICK_DIALOG_OCCURRENCE_CLASS, QUICK_DIALOG_SERIES_CLASS, QUICK_DIALOG_DELETE_CLASS, QUICK_DIALOG_CANCEL_CLASS, QUICK_DIALOG_ALERT_BTN_CLASS, DISABLE_CLASS];\n    const okButton = this.quickDialog.element.querySelector('.' + QUICK_DIALOG_ALERT_OK);\n    const cancelButton = this.quickDialog.element.querySelector('.' + QUICK_DIALOG_ALERT_CANCEL);\n    const followingEventButton = this.quickDialog.element.querySelector('.' + QUICK_DIALOG_ALERT_FOLLOWING);\n    removeClass([okButton, cancelButton], classList$$1);\n    addClass([this.quickDialog.element.querySelector('.' + QUICK_DIALOG_CANCEL_CLASS)], DISABLE_CLASS);\n\n    if (this.parent.eventSettings.editFollowingEvents) {\n      addClass([followingEventButton], DISABLE_CLASS);\n      removeClass([this.quickDialog.element], FOLLOWING_EVENTS_DIALOG);\n    }\n\n    switch (action) {\n      case 'Recurrence':\n        addClass([okButton], QUICK_DIALOG_OCCURRENCE_CLASS);\n        addClass([cancelButton], QUICK_DIALOG_SERIES_CLASS);\n\n        if (this.parent.eventSettings.editFollowingEvents) {\n          removeClass([followingEventButton], DISABLE_CLASS);\n          addClass([this.quickDialog.element], FOLLOWING_EVENTS_DIALOG);\n          addClass([followingEventButton], QUICK_DIALOG_FOLLOWING_EVENTS_CLASS);\n        }\n\n        break;\n\n      case 'Delete':\n        addClass([okButton], QUICK_DIALOG_DELETE_CLASS);\n        addClass([cancelButton], QUICK_DIALOG_CANCEL_CLASS);\n        break;\n\n      case 'Alert':\n        addClass([okButton], [QUICK_DIALOG_ALERT_OK, QUICK_DIALOG_ALERT_BTN_CLASS]);\n        addClass([cancelButton], [QUICK_DIALOG_ALERT_CANCEL, DISABLE_CLASS]);\n        break;\n    }\n  }\n\n  applyFormValidation() {\n    const form = this.quickPopup.element.querySelector('.' + FORM_CLASS);\n    const rules = {};\n    rules[this.parent.eventSettings.fields.subject.name] = this.parent.eventSettings.fields.subject.validation;\n    this.fieldValidator.renderFormValidator(form, rules, this.quickPopup.element, this.parent.locale);\n  }\n\n  openRecurrenceAlert() {\n    const editDeleteOnly = this.quickDialog.element.querySelector('.' + QUICK_DIALOG_ALERT_OK);\n\n    if (editDeleteOnly) {\n      editDeleteOnly.innerHTML = this.l10n.getConstant(this.parent.currentAction === 'Delete' ? 'deleteEvent' : 'editEvent');\n      editDeleteOnly.setAttribute('aria-label', editDeleteOnly.innerHTML);\n    }\n\n    const editFollowingEventsOnly = this.quickDialog.element.querySelector('.' + QUICK_DIALOG_ALERT_FOLLOWING);\n\n    if (editFollowingEventsOnly) {\n      editFollowingEventsOnly.innerHTML = this.l10n.getConstant('editFollowingEvent');\n      editFollowingEventsOnly.setAttribute('aria-label', editFollowingEventsOnly.innerHTML);\n    }\n\n    const editDeleteSeries = this.quickDialog.element.querySelector('.' + QUICK_DIALOG_ALERT_CANCEL);\n\n    if (editDeleteSeries) {\n      editDeleteSeries.innerHTML = this.l10n.getConstant(this.parent.currentAction === 'Delete' ? 'deleteSeries' : 'editSeries');\n      editDeleteSeries.setAttribute('aria-label', editDeleteSeries.innerHTML);\n    }\n\n    this.quickDialog.content = this.l10n.getConstant('editContent');\n    this.quickDialog.header = this.l10n.getConstant(this.parent.currentAction === 'Delete' ? 'deleteTitle' : 'editTitle');\n    this.quickDialogClass('Recurrence');\n    const activeEvent = this.parent.activeEventData.event;\n\n    if (this.parent.eventSettings.editFollowingEvents && this.parent.currentAction === 'EditOccurrence' && !isNullOrUndefined(activeEvent[this.parent.eventFields.recurrenceID]) && activeEvent[this.parent.eventFields.recurrenceID] !== activeEvent[this.parent.eventFields.id]) {\n      const followingEventButton = this.quickDialog.element.querySelector('.' + QUICK_DIALOG_ALERT_FOLLOWING);\n      addClass([followingEventButton], DISABLE_CLASS);\n    }\n\n    this.showQuickDialog('RecurrenceAlert');\n  }\n\n  openRecurrenceValidationAlert(type) {\n    this.quickDialogClass('Alert');\n    const okButton = this.quickDialog.element.querySelector('.' + QUICK_DIALOG_ALERT_OK);\n    okButton.innerHTML = this.l10n.getConstant('ok');\n    okButton.setAttribute('aria-label', okButton.innerHTML);\n    const cancelButton = this.quickDialog.element.querySelector('.' + QUICK_DIALOG_ALERT_CANCEL);\n    cancelButton.innerHTML = this.l10n.getConstant('cancel');\n    cancelButton.setAttribute('aria-label', cancelButton.innerHTML);\n    this.quickDialog.header = this.l10n.getConstant('alert');\n    let dialogCancel;\n\n    switch (type) {\n      case 'wrongPattern':\n        addClass([cancelButton], DISABLE_CLASS);\n        this.quickDialog.content = this.l10n.getConstant('wrongPattern');\n        break;\n\n      case 'createError':\n        addClass([cancelButton], DISABLE_CLASS);\n        this.quickDialog.content = this.l10n.getConstant('createError');\n        break;\n\n      case 'sameDayAlert':\n        addClass([cancelButton], DISABLE_CLASS);\n        this.quickDialog.content = this.l10n.getConstant('sameDayAlert');\n        break;\n\n      case 'seriesChangeAlert':\n        dialogCancel = this.quickDialog.element.querySelector('.' + QUICK_DIALOG_CANCEL_CLASS);\n        removeClass([cancelButton, dialogCancel], DISABLE_CLASS);\n        this.quickDialog.content = this.l10n.getConstant('seriesChangeAlert');\n        okButton.innerHTML = this.l10n.getConstant('yes');\n        cancelButton.innerHTML = this.l10n.getConstant('no');\n        dialogCancel.innerHTML = this.l10n.getConstant('cancel');\n        break;\n\n      case 'occurrenceAlert':\n        addClass([cancelButton], DISABLE_CLASS);\n        this.quickDialog.content = this.l10n.getConstant('occurenceAlert');\n        break;\n    }\n\n    if (!this.parent.enableRecurrenceValidation && type === 'wrongPattern' || this.parent.enableRecurrenceValidation) {\n      this.showQuickDialog('RecurrenceValidationAlert');\n    }\n  }\n\n  openDeleteAlert() {\n    if (this.parent.activeViewOptions.readonly) {\n      return;\n    }\n\n    const okButton = this.quickDialog.element.querySelector('.' + QUICK_DIALOG_ALERT_OK);\n\n    if (okButton) {\n      okButton.innerHTML = this.l10n.getConstant('delete');\n      okButton.setAttribute('aria-label', okButton.innerHTML);\n    }\n\n    const cancelButton = this.quickDialog.element.querySelector('.' + QUICK_DIALOG_ALERT_CANCEL);\n\n    if (cancelButton) {\n      cancelButton.innerHTML = this.l10n.getConstant('cancel');\n      cancelButton.setAttribute('aria-label', cancelButton.innerHTML);\n    }\n\n    this.quickDialog.content = this.parent.activeEventData.event.length > 1 ? this.l10n.getConstant('deleteMultipleContent') : this.l10n.getConstant('deleteContent');\n    this.quickDialog.header = this.parent.activeEventData.event.length > 1 ? this.l10n.getConstant('deleteMultipleEvent') : this.l10n.getConstant('deleteEvent');\n    this.quickDialogClass('Delete');\n    this.showQuickDialog('DeleteAlert');\n  }\n\n  openValidationError(type, eventData) {\n    this.quickDialog.header = this.l10n.getConstant('alert');\n    this.quickDialog.content = this.l10n.getConstant(type);\n    const okButton = this.quickDialog.element.querySelector('.' + QUICK_DIALOG_ALERT_OK);\n\n    if (okButton) {\n      okButton.innerHTML = this.l10n.getConstant('ok');\n      okButton.setAttribute('aria-label', okButton.innerHTML);\n    }\n\n    const cancelButton = this.quickDialog.element.querySelector('.' + QUICK_DIALOG_ALERT_CANCEL);\n\n    if (cancelButton) {\n      cancelButton.innerHTML = this.l10n.getConstant('cancel');\n      okButton.setAttribute('aria-label', cancelButton.innerHTML);\n    }\n\n    this.quickDialogClass('Alert');\n    this.showQuickDialog('ValidationAlert', eventData);\n  }\n\n  showQuickDialog(popupType, eventData) {\n    this.quickDialog.dataBind();\n    const eventProp = {\n      type: popupType,\n      cancel: false,\n      element: this.quickDialog.element,\n      data: extend({}, eventData || this.parent.activeEventData.event, null, true)\n    };\n    this.parent.trigger(popupOpen, eventProp, popupArgs => {\n      if (!popupArgs.cancel) {\n        this.quickDialog.show();\n      }\n    });\n  }\n\n  createMoreEventList(eventCollection, groupOrder, groupIndex) {\n    const fields = this.parent.eventFields;\n    const moreEventContentEle = createElement('div', {\n      className: MORE_EVENT_CONTENT_CLASS\n    });\n    let moreEventWrapperEle = createElement('div', {\n      className: MORE_EVENT_WRAPPER_CLASS\n    });\n\n    if (eventCollection.length === 0) {\n      moreEventWrapperEle = createElement('div', {\n        className: MORE_EVENT_CONTENT_CLASS,\n        innerHTML: this.l10n.getConstant('emptyContainer')\n      });\n    } else {\n      for (const eventData of eventCollection) {\n        const eventText = eventData[fields.subject] || this.parent.eventSettings.fields.subject.default || this.parent.localeObj.getConstant('addTitle');\n        const appointmentElement = createElement('div', {\n          className: APPOINTMENT_CLASS,\n          attrs: {\n            'data-id': '' + eventData[fields.id],\n            'data-guid': eventData.Guid,\n            'role': 'button',\n            'tabindex': '0',\n            'aria-disabled': this.parent.eventBase.getReadonlyAttribute(eventData),\n            'aria-pressed': 'false',\n            'aria-grabbed': 'true',\n            'aria-label': this.parent.getAnnouncementString(eventData)\n          }\n        });\n        let templateElement;\n\n        if (!isNullOrUndefined(this.parent.activeViewOptions.eventTemplate)) {\n          const tempId = this.parent.element.id + '_' + this.parent.activeViewOptions.eventTemplateName + 'eventTemplate';\n          templateElement = this.parent.getAppointmentTemplate()(eventData, this.parent, 'eventTemplate', tempId, false);\n          append(templateElement, appointmentElement);\n        } else {\n          appointmentElement.appendChild(createElement('div', {\n            className: SUBJECT_CLASS,\n            innerHTML: eventText\n          }));\n        }\n\n        if (!isNullOrUndefined(groupIndex)) {\n          appointmentElement.setAttribute('data-group-index', groupIndex);\n        }\n\n        if (!isNullOrUndefined(eventData[fields.recurrenceRule])) {\n          const iconClass = eventData[fields.id] === eventData[fields.recurrenceID] ? EVENT_RECURRENCE_ICON_CLASS : EVENT_RECURRENCE_EDIT_ICON_CLASS;\n          appointmentElement.appendChild(createElement('div', {\n            className: ICON + ' ' + iconClass\n          }));\n        }\n\n        const args = {\n          data: extend({}, eventData, null, true),\n          element: appointmentElement,\n          cancel: false\n        };\n        this.parent.trigger(eventRendered, args, eventArgs => {\n          if (!eventArgs.cancel) {\n            moreEventWrapperEle.appendChild(appointmentElement);\n            const isPreventCrud = this.parent.isAdaptive || this.parent.currentView === 'Year';\n            this.parent.eventBase.wireAppointmentEvents(appointmentElement, eventData, isPreventCrud);\n            this.parent.eventBase.applyResourceColor(appointmentElement, eventData, 'backgroundColor', groupOrder);\n          }\n        });\n      }\n    }\n\n    moreEventContentEle.appendChild(moreEventWrapperEle);\n    return moreEventContentEle;\n  }\n\n  tapHoldEventPopup(e) {\n    const target = closest(e.target, '.' + APPOINTMENT_CLASS);\n    this.isMultipleEventSelect = false;\n    this.parent.selectedElements = [];\n    this.isMultipleEventSelect = true;\n    this.parent.eventBase.getSelectedEventElements(target);\n    this.parent.activeEventData = this.parent.eventBase.getSelectedEvents();\n    const guid = target.getAttribute('data-guid');\n    const eventObj = this.parent.eventBase.getEventByGuid(guid);\n\n    if (isNullOrUndefined(eventObj)) {\n      return;\n    }\n\n    const eventTitle = eventObj[this.parent.eventFields.subject] || this.l10n.getConstant('noTitle');\n    const eventTemplate = `<div class=\"${MULTIPLE_EVENT_POPUP_CLASS}\"><div class=\"${POPUP_HEADER_CLASS}\">` + `<button class=\"${CLOSE_CLASS}\" title=\"${this.l10n.getConstant('close')}\"></button>` + `<div class=\"${SUBJECT_CLASS}\">${eventTitle}</div>` + `<button class=\"${EDIT_CLASS}\" title=\"${this.l10n.getConstant('edit')}\"></button>` + `<button class=\"${DELETE_CLASS}\" title=\"${this.l10n.getConstant('delete')}\"></button></div></div>`;\n    this.quickPopup.element.innerHTML = eventTemplate;\n    const closeIcon = this.quickPopup.element.querySelector('.' + CLOSE_CLASS);\n    this.renderButton('e-flat e-round e-small', ICON + ' ' + CLOSE_ICON_CLASS, false, closeIcon, this.closeClick);\n    const readonly = this.parent.activeViewOptions.readonly || eventObj[this.parent.eventFields.isReadonly];\n    const editAction = !this.parent.eventSettings.allowEditing || readonly;\n    const deleteAction = !this.parent.eventSettings.allowDeleting || readonly;\n    const editIcon = this.quickPopup.element.querySelector('.' + EDIT_CLASS);\n\n    if (editIcon) {\n      this.renderButton('e-flat e-round e-small', ICON + ' ' + EDIT_ICON_CLASS, editAction, editIcon, this.editClick);\n    }\n\n    const deleteIcon = this.quickPopup.element.querySelector('.' + DELETE_CLASS);\n\n    if (deleteIcon) {\n      this.renderButton('e-flat e-round e-small', ICON + ' ' + DELETE_ICON_CLASS, deleteAction, deleteIcon, this.deleteClick);\n    }\n\n    this.beforeQuickPopupOpen(target);\n  }\n\n  isCellBlocked(args) {\n    const tempObj = {};\n    tempObj[this.parent.eventFields.startTime] = this.parent.activeCellsData.startTime;\n    tempObj[this.parent.eventFields.endTime] = this.parent.activeCellsData.endTime;\n    tempObj[this.parent.eventFields.isAllDay] = this.parent.activeCellsData.isAllDay;\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      const targetCell = args.element instanceof Array ? args.element[0] : args.element;\n      const groupIndex = parseInt(targetCell.getAttribute('data-group-index'), 10);\n      this.parent.resourceBase.setResourceValues(tempObj, isNaN(groupIndex) ? null : groupIndex);\n    }\n\n    return this.parent.eventBase.isBlockRange(tempObj);\n  }\n\n  cellClick(args) {\n    const date = new Date(args.startTime.getTime());\n\n    if (!this.parent.showQuickInfo || !this.parent.eventSettings.allowAdding || this.parent.currentView === 'MonthAgenda' || this.isCellBlocked(args) || !this.parent.isMinMaxDate(new Date(date.setHours(0, 0, 0, 0)))) {\n      this.quickPopupHide();\n      return;\n    }\n\n    const targetEle = !isNullOrUndefined(args.event) ? args.event.target : args.element;\n\n    if (this.parent.isAdaptive) {\n      this.quickPopupHide();\n      let newEventClone = this.parent.element.querySelector('.' + NEW_EVENT_CLASS);\n\n      if (isNullOrUndefined(newEventClone)) {\n        newEventClone = createElement('div', {\n          className: NEW_EVENT_CLASS,\n          innerHTML: `<div class=\"e-title\">+ ${this.l10n.getConstant('newEvent')}</div>`\n        });\n      }\n\n      const targetCell = closest(targetEle, '.' + WORK_CELLS_CLASS + ',.' + ALLDAY_CELLS_CLASS);\n\n      if (targetCell) {\n        targetCell.appendChild(newEventClone);\n      }\n\n      return;\n    }\n\n    const target = closest(targetEle, '.' + WORK_CELLS_CLASS + ',.' + ALLDAY_CELLS_CLASS + ',.' + HEADER_CELLS_CLASS);\n\n    if (isNullOrUndefined(target) || targetEle.classList.contains(MORE_INDICATOR_CLASS)) {\n      return;\n    }\n\n    const isSameTarget = this.quickPopup.relateTo === target;\n\n    if (isSameTarget && this.quickPopup.element.classList.contains(POPUP_OPEN)) {\n      const subjectElement = this.quickPopup.element.querySelector('.' + SUBJECT_CLASS);\n\n      if (subjectElement) {\n        subjectElement.focus();\n      }\n\n      return;\n    }\n\n    const temp = {};\n    temp[this.parent.eventFields.startTime] = this.parent.activeCellsData.startTime;\n    temp[this.parent.eventFields.endTime] = this.parent.activeCellsData.endTime;\n    temp[this.parent.eventFields.isAllDay] = this.parent.activeCellsData.isAllDay;\n    const quickCellPopup = createElement('div', {\n      className: CELL_POPUP_CLASS\n    });\n    quickCellPopup.appendChild(this.getPopupHeader('Cell', temp));\n    quickCellPopup.appendChild(this.getPopupContent('Cell', args, temp));\n    quickCellPopup.appendChild(this.getPopupFooter('Cell', temp));\n    const subjectElement = quickCellPopup.querySelector('.' + SUBJECT_CLASS);\n\n    if (subjectElement) {\n      Input.createInput({\n        element: subjectElement,\n        properties: {\n          placeholder: this.l10n.getConstant('addTitle')\n        }\n      });\n    }\n\n    if (!isNullOrUndefined(this.parent.eventSettings.fields.subject.default)) {\n      subjectElement.value = this.parent.eventSettings.fields.subject.default;\n    }\n\n    const closeIcon = quickCellPopup.querySelector('.' + CLOSE_CLASS);\n\n    if (closeIcon) {\n      this.renderButton('e-flat e-round e-small', ICON + ' ' + CLOSE_ICON_CLASS, false, closeIcon, this.popupClose);\n    }\n\n    const moreButton = quickCellPopup.querySelector('.' + QUICK_POPUP_EVENT_DETAILS_CLASS);\n\n    if (moreButton) {\n      this.renderButton('e-flat', '', false, moreButton, this.detailsClick);\n    }\n\n    const saveButton = quickCellPopup.querySelector('.' + EVENT_CREATE_CLASS);\n\n    if (saveButton) {\n      this.renderButton('e-flat e-primary', '', this.parent.activeViewOptions.readonly, saveButton, this.saveClick);\n    }\n\n    if (this.morePopup) {\n      this.morePopup.hide();\n    }\n\n    this.quickPopup.content = quickCellPopup;\n    this.quickPopup.relateTo = target;\n    this.quickPopup.dataBind();\n    this.beforeQuickPopupOpen(target);\n  }\n\n  isSameEventClick(events) {\n    const isSameTarget = this.quickPopup.relateTo === closest(events.element, '.' + APPOINTMENT_CLASS);\n\n    if (isSameTarget && this.quickPopup.element.classList.contains(POPUP_OPEN)) {\n      const editIcon = this.quickPopup.element.querySelector('.' + EDIT_CLASS);\n\n      if (editIcon) {\n        editIcon.focus();\n      }\n\n      if (!this.parent.isAdaptive) {\n        const editButton = this.quickPopup.element.querySelector('.' + EDIT_EVENT_CLASS);\n\n        if (editButton) {\n          editButton.focus();\n        }\n      }\n\n      return true;\n    }\n\n    return false;\n  }\n\n  isQuickTemplate(type) {\n    return this.parent.quickInfoTemplates.templateType === 'Both' || this.parent.quickInfoTemplates.templateType === type;\n  }\n\n  eventClick(events) {\n    if (this.parent.eventTooltip) {\n      this.parent.eventTooltip.close();\n    }\n\n    if (!this.parent.showQuickInfo) {\n      return;\n    }\n\n    if (this.parent.isAdaptive && this.isMultipleEventSelect) {\n      this.updateTapHoldEventPopup(closest(events.element, '.' + APPOINTMENT_CLASS));\n    } else {\n      const isSameTarget = this.isSameEventClick(events);\n      this.parent.selectedElements = [];\n\n      if (isSameTarget) {\n        return;\n      }\n\n      const eventData = events.event;\n      const quickEventPopup = createElement('div', {\n        className: EVENT_POPUP_CLASS\n      });\n      quickEventPopup.appendChild(this.getPopupHeader('Event', eventData));\n      quickEventPopup.appendChild(this.getPopupContent('Event', events, eventData));\n      quickEventPopup.appendChild(this.getPopupFooter('Event', eventData));\n      const readonly = this.parent.activeViewOptions.readonly || eventData[this.parent.eventFields.isReadonly];\n      const editAction = !this.parent.eventSettings.allowEditing || readonly;\n      const deleteAction = !this.parent.eventSettings.allowDeleting || readonly;\n      const editIcon = quickEventPopup.querySelector('.' + EDIT_CLASS);\n      const buttonClass = 'e-flat e-round e-small';\n\n      if (editIcon) {\n        this.renderButton(buttonClass, ICON + ' ' + EDIT_ICON_CLASS, editAction, editIcon, this.editClick);\n      }\n\n      const deleteIcon = quickEventPopup.querySelector('.' + DELETE_CLASS);\n\n      if (deleteIcon) {\n        this.renderButton(buttonClass, ICON + ' ' + DELETE_ICON_CLASS, deleteAction, deleteIcon, this.deleteClick);\n      }\n\n      const closeIcon = quickEventPopup.querySelector('.' + CLOSE_CLASS);\n\n      if (closeIcon) {\n        this.renderButton(buttonClass, ICON + ' ' + CLOSE_ICON_CLASS, false, closeIcon, this.popupClose);\n      }\n\n      const editButton = quickEventPopup.querySelector('.' + EDIT_EVENT_CLASS);\n\n      if (editButton) {\n        this.renderButton('e-flat e-primary', '', editAction, editButton, this.editClick);\n      }\n\n      const deleteButton = quickEventPopup.querySelector('.' + DELETE_EVENT_CLASS);\n\n      if (deleteButton) {\n        this.renderButton('e-flat', '', deleteAction, deleteButton, this.deleteClick);\n      }\n\n      if (this.morePopup && !closest(events.element, '.' + MORE_EVENT_WRAPPER_CLASS)) {\n        this.morePopup.hide();\n      }\n\n      this.quickPopup.content = quickEventPopup;\n      this.quickPopup.relateTo = this.parent.isAdaptive ? document.body : closest(events.element, '.' + APPOINTMENT_CLASS);\n      this.quickPopup.dataBind();\n      this.beforeQuickPopupOpen(events.element);\n    }\n  }\n\n  getPopupHeader(headerType, headerData) {\n    const headerTemplate = createElement('div', {\n      className: POPUP_HEADER_CLASS\n    });\n\n    if (this.isQuickTemplate(headerType) && this.parent.quickInfoTemplates.header) {\n      const headerArgs = extend({}, headerData, {\n        elementType: headerType.toLowerCase()\n      }, true);\n      const templateId = this.parent.element.id;\n      const headerTemp = [].slice.call(this.parent.getQuickInfoTemplatesHeader()(headerArgs, this.parent, 'header', templateId + '_headerTemplate', false));\n      append([].slice.call(headerTemp), headerTemplate);\n    } else {\n      let header;\n      let args;\n\n      switch (headerType) {\n        case 'Cell':\n          header = `<div class=\"${POPUP_HEADER_ICON_WRAPPER}\"><button class=\"${CLOSE_CLASS}\" title=` + `\"${this.l10n.getConstant('close')}\"></button></div>`;\n          break;\n\n        case 'Event':\n          args = this.getFormattedString(headerData);\n          header = `<div class=\"${POPUP_HEADER_ICON_WRAPPER}\">` + `<button class=\"${EDIT_CLASS + ' ' + ICON}\" title=\"${this.l10n.getConstant('edit')}\"></button>` + `<button class=\"${DELETE_CLASS + ' ' + ICON}\" title=\"${this.l10n.getConstant('delete')}\"></button>` + `<button class=\"${CLOSE_CLASS}\" title=\"${this.l10n.getConstant('close')}\"></button></div>` + `<div class=\"${SUBJECT_WRAP}\"><div class=\"${SUBJECT_CLASS} ${TEXT_ELLIPSIS}\" ` + `title=\"${args.eventSubject ? args.eventSubject.replaceAll('\"', '\\'') : args.eventSubject}\">${args.eventSubject}</div></div >`;\n          break;\n      }\n\n      const templateWrapper = createElement('div', {\n        innerHTML: header\n      });\n      append([].slice.call(templateWrapper.childNodes), headerTemplate);\n    }\n\n    return headerTemplate;\n  }\n\n  getPopupContent(type, args, data) {\n    const contentTemplate = createElement('div', {\n      className: POPUP_CONTENT_CLASS\n    });\n\n    if (this.isQuickTemplate(type) && this.parent.quickInfoTemplates.content) {\n      const contentArgs = extend({}, data, {\n        elementType: type.toLowerCase()\n      }, true);\n      const templateId = this.parent.element.id;\n      const contentTemp = [].slice.call(this.parent.getQuickInfoTemplatesContent()(contentArgs, this.parent, 'content', templateId + '_contentTemplate', false));\n      append([].slice.call(contentTemp), contentTemplate);\n    } else {\n      let content;\n      let cellDetails;\n      let argsData;\n      const resourceText = this.getResourceText(args, type.toLowerCase());\n\n      switch (type) {\n        case 'Cell':\n          cellDetails = this.getFormattedString(data);\n          content = `<table class=\"${POPUP_TABLE_CLASS}\"><tbody><tr><td><form class=\"${FORM_CLASS}\" onsubmit=` + `\"return false;\"><input class=\"${SUBJECT_CLASS} ${EVENT_FIELD}\" type=\"text\" name=` + `\"${this.parent.eventFields.subject}\" /></form></td></tr><tr><td><div class=\"${DATE_TIME_CLASS}\">` + `<div class=\"${DATE_TIME_ICON_CLASS} ${ICON}\"></div><div class=\"${DATE_TIME_DETAILS_CLASS} ` + `${TEXT_ELLIPSIS}\">${cellDetails.details}</div></div>` + `${this.parent.activeViewOptions.group.resources.length > 0 ? `<div class=\"${RESOURCE_CLASS}\">` + `<div class=\"${RESOURCE_ICON_CLASS} ${ICON} \"></div><div class=\"${RESOURCE_DETAILS_CLASS} ` + `${TEXT_ELLIPSIS}\">${resourceText}</div></div>` : ''}</td></tr></tbody></table>`;\n          break;\n\n        case 'Event':\n          argsData = this.getFormattedString(data);\n          content = '<div class=\"' + DATE_TIME_CLASS + '\"><div class=\"' + DATE_TIME_ICON_CLASS + ' ' + ICON + '\"></div><div class=\"' + DATE_TIME_WRAPPER_CLASS + ' ' + TEXT_ELLIPSIS + '\"><div class=\"' + DATE_TIME_DETAILS_CLASS + ' ' + TEXT_ELLIPSIS + '\">' + argsData.details + '</div>';\n\n          if (data[this.parent.eventFields.recurrenceRule]) {\n            content += '<div class=\"' + RECURRENCE_SUMMARY_CLASS + ' ' + TEXT_ELLIPSIS + '\">' + this.getRecurrenceSummary(data) + '</div>';\n          }\n\n          content += '</div></div>';\n\n          if (data[this.parent.eventFields.location]) {\n            content += '<div class=\"' + LOCATION_CLASS + '\"><div class=\"' + LOCATION_ICON_CLASS + ' ' + ICON + '\"></div><div class=\"' + LOCATION_DETAILS_CLASS + ' ' + TEXT_ELLIPSIS + '\">' + data[this.parent.eventFields.location] + '</div></div>';\n          }\n\n          if (data[this.parent.eventFields.startTimezone] || data[this.parent.eventFields.endTimezone]) {\n            content += '<div class=\"' + TIME_ZONE_CLASS + '\"><div class=\"' + TIME_ZONE_ICON_CLASS + ' ' + ICON + '\"></div><div class=\"' + TIME_ZONE_DETAILS_CLASS + ' ' + TEXT_ELLIPSIS + '\">' + this.getTimezone(data) + '</div></div>';\n          }\n\n          if (data[this.parent.eventFields.description]) {\n            content += '<div class=\"' + DESCRIPTION_CLASS + '\"><div class=\"' + DESCRIPTION_ICON_CLASS + ' ' + ICON + '\"></div><div class=\"' + DESCRIPTION_DETAILS_CLASS + ' ' + TEXT_ELLIPSIS + '\">' + data[this.parent.eventFields.description] + '</div></div>';\n          }\n\n          if (this.parent.resourceCollection.length > 0) {\n            content += '<div class=\"' + RESOURCE_CLASS + '\"><div class=\"' + RESOURCE_ICON_CLASS + ' ' + ICON + '\"></div><div class=\"' + RESOURCE_DETAILS_CLASS + ' ' + TEXT_ELLIPSIS + '\">' + resourceText + '</div></div>';\n          }\n\n          break;\n      }\n\n      const templateWrapper = createElement('div', {\n        innerHTML: content\n      });\n      append([].slice.call(templateWrapper.childNodes), contentTemplate);\n    }\n\n    return contentTemplate;\n  }\n\n  getPopupFooter(footerType, footerData) {\n    const footerTemplate = createElement('div', {\n      className: POPUP_FOOTER_CLASS\n    });\n\n    if (this.isQuickTemplate(footerType) && this.parent.quickInfoTemplates.footer) {\n      const footerArgs = extend({}, footerData, {\n        elementType: footerType.toLowerCase()\n      }, true);\n      const templateId = this.parent.element.id;\n      const footerTemp = [].slice.call(this.parent.getQuickInfoTemplatesFooter()(footerArgs, this.parent, 'footer', templateId + '_footerTemplate', false));\n      append([].slice.call(footerTemp), footerTemplate);\n    } else {\n      let footer;\n\n      switch (footerType) {\n        case 'Cell':\n          footer = `<button class=\"${QUICK_POPUP_EVENT_DETAILS_CLASS + ' ' + TEXT_ELLIPSIS}\" title=` + `\"${this.l10n.getConstant('moreDetails')}\">${this.l10n.getConstant('moreDetails')}</button>` + `<button class=\"${EVENT_CREATE_CLASS} ${TEXT_ELLIPSIS}\" title=\"${this.l10n.getConstant('save')}\">` + `${this.l10n.getConstant('save')}</button>`;\n          break;\n\n        case 'Event':\n          footer = `${this.parent.isAdaptive ? '' : `<button class=\"${EDIT_EVENT_CLASS} ` + `${TEXT_ELLIPSIS}\" title=\"${this.l10n.getConstant('edit')}\">${this.l10n.getConstant('edit')}</button>` + `<button class=\"${DELETE_EVENT_CLASS} ${TEXT_ELLIPSIS}\" title=\"${this.l10n.getConstant('delete')}\">` + `${this.l10n.getConstant('delete')}</button>`}`;\n          break;\n      }\n\n      const templateWrapper = createElement('div', {\n        innerHTML: footer\n      });\n      append([].slice.call(templateWrapper.childNodes), footerTemplate);\n    }\n\n    return footerTemplate;\n  }\n\n  getResourceText(args, type) {\n    if (this.parent.resourceCollection.length === 0) {\n      return null;\n    }\n\n    let resourceValue = '';\n\n    if (this.parent.activeViewOptions.group.resources.length === 0) {\n      const resourceCollection = this.parent.resourceBase.resourceCollection.slice(-1)[0];\n      const resourceData = resourceCollection.dataSource;\n\n      if (type === 'event') {\n        const eventData = args.event;\n\n        for (const data of resourceData) {\n          const resourceId = eventData[resourceCollection.field];\n\n          if (resourceId instanceof Array) {\n            if (resourceId.indexOf(data[resourceCollection.idField]) > -1) {\n              const id = resourceId[resourceId.indexOf(data[resourceCollection.idField])];\n              const resource = resourceData.filter(e => e[resourceCollection.idField] === id)[0];\n              resourceValue += resourceValue === '' ? resource[resourceCollection.textField] : ', ' + resource[resourceCollection.textField];\n            }\n          } else if (data[resourceCollection.idField] === resourceId) {\n            resourceValue = data[resourceCollection.textField].toString();\n          }\n        }\n      } else {\n        resourceValue = resourceData[0][resourceCollection.textField].toString();\n      }\n    } else {\n      if (type === 'event') {\n        const eventData = args.event;\n        let resourceData;\n        let lastResource;\n\n        for (let i = this.parent.resourceBase.resourceCollection.length - 1; i >= 0; i--) {\n          resourceData = eventData[this.parent.resourceBase.resourceCollection[i].field];\n\n          if (!isNullOrUndefined(resourceData)) {\n            lastResource = this.parent.resourceBase.resourceCollection[i];\n            break;\n          }\n        }\n\n        if (!Array.isArray(resourceData)) {\n          resourceData = [resourceData];\n        }\n\n        const resNames = [];\n        const lastResourceData = lastResource.dataSource;\n        resourceData.forEach(value => {\n          let text;\n          const i = findIndexInData(lastResourceData, lastResource.idField, value);\n\n          if (i > -1) {\n            text = lastResourceData[i][lastResource.textField];\n          }\n\n          if (text) {\n            resNames.push(text);\n          }\n        });\n        resourceValue = resNames.join(', ');\n      } else {\n        const argsData = args;\n        const groupIndex = !isNullOrUndefined(argsData.groupIndex) ? argsData.groupIndex : 0;\n        const resourceDetails = this.parent.resourceBase.lastResourceLevel[groupIndex];\n        resourceValue = resourceDetails.resourceData[resourceDetails.resource.textField];\n      }\n    }\n\n    return resourceValue;\n  }\n\n  getFormattedString(eventData) {\n    const fields = this.parent.eventFields;\n    const eventSubject = eventData[fields.subject] || this.l10n.getConstant('noTitle');\n    const startDate = eventData[fields.startTime];\n    const endDate = eventData[fields.endTime];\n    const startDateDetails = this.getDateFormat(startDate, 'long');\n    const endDateDetails = eventData[fields.isAllDay] && endDate.getHours() === 0 && endDate.getMinutes() === 0 ? this.getDateFormat(addDays(new Date(endDate.getTime()), -1), 'long') : this.getDateFormat(endDate, 'long');\n    const startTimeDetail = this.parent.getTimeString(startDate);\n    const endTimeDetail = this.parent.getTimeString(endDate);\n    let details = '';\n    const spanLength = endDate.getDate() !== startDate.getDate() && (endDate.getTime() - startDate.getTime()) / (60 * 60 * 1000) < 24 ? 1 : 0;\n\n    if (eventData[fields.isAllDay]) {\n      details = startDateDetails + ' (' + this.l10n.getConstant('allDay') + ')';\n\n      if ((getUniversalTime(endDate) - getUniversalTime(startDate)) / MS_PER_DAY > 1) {\n        details += '&nbsp;-&nbsp;' + endDateDetails + ' (' + this.l10n.getConstant('allDay') + ')';\n      }\n    } else if ((getUniversalTime(endDate) - getUniversalTime(startDate)) / MS_PER_DAY >= 1 || spanLength > 0) {\n      details = startDateDetails + ' (' + startTimeDetail + ')' + '&nbsp;-&nbsp;' + endDateDetails + ' (' + endTimeDetail + ')';\n    } else {\n      details = startDateDetails + ' (' + (startTimeDetail + '&nbsp;-&nbsp;' + endTimeDetail) + ')';\n    }\n\n    return {\n      eventSubject: eventSubject,\n      details: details\n    };\n  }\n\n  moreEventClick(data, endDate, groupIndex) {\n    this.quickPopupHide(true);\n    const moreEventContentEle = this.morePopup.element.querySelector('.' + MORE_EVENT_CONTENT_CLASS);\n\n    if (moreEventContentEle) {\n      remove(moreEventContentEle);\n    }\n\n    const selectedDate = data.date.getTime().toString();\n    const target = closest(data.element, '.' + MORE_INDICATOR_CLASS + ',.' + WORK_CELLS_CLASS);\n    const day = this.parent.globalize.formatDate(data.date, {\n      format: 'E',\n      calendar: this.parent.getCalendarMode()\n    });\n    this.morePopup.element.querySelector('.' + MORE_EVENT_HEADER_DAY_CLASS).innerHTML = capitalizeFirstWord(day, 'single');\n    const dateElement = this.morePopup.element.querySelector('.' + MORE_EVENT_HEADER_DATE_CLASS);\n    dateElement.innerHTML = this.getDateFormat(data.date, 'd');\n    dateElement.setAttribute('data-date', selectedDate);\n    dateElement.setAttribute('data-end-date', endDate.getTime().toString());\n    let groupOrder;\n\n    if (!isNullOrUndefined(groupIndex)) {\n      dateElement.setAttribute('data-group-index', groupIndex);\n      groupOrder = this.parent.resourceBase.lastResourceLevel[parseInt(groupIndex, 10)].groupOrder;\n    }\n\n    const moreEventElements = this.createMoreEventList(data.event, groupOrder, groupIndex);\n    this.morePopup.element.querySelector('.' + MORE_EVENT_POPUP_CLASS).appendChild(moreEventElements);\n    removeClass(this.morePopup.element.querySelector('.' + MORE_EVENT_DATE_HEADER_CLASS).childNodes, CURRENTDATE_CLASS);\n\n    if (resetTime(data.date).getTime() === resetTime(this.parent.getCurrentTime()).getTime()) {\n      addClass(this.morePopup.element.querySelector('.' + MORE_EVENT_DATE_HEADER_CLASS).childNodes, CURRENTDATE_CLASS);\n    }\n\n    if (!this.parent.isAdaptive) {\n      if (this.parent.currentView.indexOf('Timeline') !== -1) {\n        const gIndex = target.getAttribute('data-group-index');\n        const startDate = new Date(parseInt(target.getAttribute('data-start-date'), 10));\n        startDate.setHours(startDate.getHours(), startDate.getMinutes(), 0);\n        const tdDate = startDate.getTime().toString();\n\n        if (isNullOrUndefined(gIndex)) {\n          this.morePopup.relateTo = this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS + ' tbody tr td[data-date=\"' + tdDate + '\"]');\n        } else {\n          this.morePopup.relateTo = this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS + ' tbody tr td[data-group-index=\"' + gIndex + '\"][data-date=\"' + tdDate + '\"]');\n\n          if (isNullOrUndefined(this.morePopup.relateTo)) {\n            const workCells = [].slice.call(this.parent.element.querySelectorAll('.' + CONTENT_WRAP_CLASS + ' tbody tr td[data-group-index=\"' + gIndex + '\"]'));\n\n            for (let i = 0; i < workCells.length; i++) {\n              const date = workCells[i].getAttribute('data-date');\n\n              if (date < tdDate) {\n                this.morePopup.relateTo = workCells[i];\n              }\n            }\n          }\n        }\n      } else {\n        this.morePopup.relateTo = closest(target, '.' + WORK_CELLS_CLASS);\n      }\n    }\n\n    this.parent.renderTemplates();\n    const eventProp = {\n      type: 'EventContainer',\n      cancel: false,\n      element: this.morePopup.element,\n      data: data\n    };\n    this.parent.trigger(popupOpen, eventProp, popupArgs => {\n      if (!popupArgs.cancel) {\n        this.morePopup.show();\n      }\n    });\n  }\n\n  saveClick(event) {\n    this.applyFormValidation();\n    this.dialogEvent = event;\n    this.isCrudAction = true;\n    this.quickPopupHide();\n  }\n\n  detailsClick(event) {\n    const subjectEle = this.quickPopup.element.querySelector('.' + SUBJECT_CLASS);\n\n    if (subjectEle && subjectEle.value !== '') {\n      extend(this.parent.activeCellsData, {\n        subject: subjectEle.value\n      });\n    }\n\n    this.dialogEvent = event;\n    this.isCrudAction = false;\n    this.fieldValidator.destroyToolTip();\n    this.quickPopupHide();\n    this.parent.eventWindow.openEditor(this.parent.activeCellsData, 'Add');\n  }\n\n  editClick(event) {\n    this.dialogEvent = event;\n    this.quickPopupHide(true);\n    const data = this.parent.activeEventData.event;\n    this.parent.currentAction = 'EditSeries';\n\n    if (!isNullOrUndefined(data[this.parent.eventFields.recurrenceRule])) {\n      this.parent.currentAction = 'EditOccurrence';\n      this.openRecurrenceAlert();\n    } else {\n      this.parent.eventWindow.openEditor(data, this.parent.currentAction);\n    }\n  }\n\n  deleteClick(event) {\n    this.dialogEvent = event;\n    this.quickPopupHide(true);\n    this.parent.currentAction = 'Delete';\n\n    if (this.parent.activeEventData.event[this.parent.eventFields.recurrenceRule]) {\n      this.openRecurrenceAlert();\n    } else {\n      this.openDeleteAlert();\n    }\n  }\n\n  updateMoreEventContent() {\n    if (this.morePopup.element.classList.contains('e-popup-close')) {\n      return;\n    }\n\n    const moreEventContentEle = this.morePopup.element.querySelector('.' + MORE_EVENT_CONTENT_CLASS);\n\n    if (moreEventContentEle) {\n      remove(moreEventContentEle);\n    }\n\n    const dateElement = this.morePopup.element.querySelector('.' + MORE_EVENT_HEADER_DATE_CLASS);\n    const startDate = new Date(parseInt(dateElement.getAttribute('data-date'), 10));\n    const endDate = new Date(parseInt(dateElement.getAttribute('data-end-date'), 10));\n    const groupIndex = dateElement.getAttribute('data-group-index');\n    let data;\n    let groupOrder;\n\n    if (!isNullOrUndefined(groupIndex)) {\n      data = this.parent.resourceBase.lastResourceLevel[parseInt(groupIndex, 10)];\n      groupOrder = data.groupOrder;\n    }\n\n    const events = this.parent.eventBase.filterEvents(startDate, endDate, this.parent.eventsProcessed, data);\n    const moreElement = this.createMoreEventList(events, groupOrder, groupIndex);\n    this.morePopup.element.querySelector('.' + MORE_EVENT_POPUP_CLASS).appendChild(moreElement);\n  }\n\n  closeClick(event) {\n    this.dialogEvent = event;\n\n    if (this.parent.currentView === 'Year' && this.parent.activeCellsData && this.parent.activeCellsData.element) {\n      this.parent.selectCell(this.parent.activeCellsData.element);\n    }\n\n    this.quickPopupHide();\n    this.morePopup.hide();\n  }\n\n  dialogButtonClick(event) {\n    this.dialogEvent = event;\n    this.quickDialog.hide();\n    const target = event.target;\n    const cancelBtn = this.quickDialog.element.querySelector('.' + QUICK_DIALOG_ALERT_CANCEL);\n    const eventData = this.parent.activeEventData.event;\n\n    if (target.classList.contains(QUICK_DIALOG_OCCURRENCE_CLASS)) {\n      this.parent.currentAction = this.parent.currentAction === 'Delete' ? 'DeleteOccurrence' : 'EditOccurrence';\n\n      switch (this.parent.currentAction) {\n        case 'EditOccurrence':\n          this.parent.eventWindow.openEditor(eventData, this.parent.currentAction);\n          break;\n\n        case 'DeleteOccurrence':\n          this.parent.crudModule.deleteEvent(eventData, this.parent.currentAction);\n          break;\n      }\n    } else if (target.classList.contains(QUICK_DIALOG_FOLLOWING_EVENTS_CLASS)) {\n      this.parent.currentAction = this.parent.currentAction === 'Delete' ? 'DeleteFollowingEvents' : 'EditFollowingEvents';\n\n      switch (this.parent.currentAction) {\n        case 'EditFollowingEvents':\n          this.parent.eventWindow.openEditor(eventData, this.parent.currentAction);\n          break;\n\n        case 'DeleteFollowingEvents':\n          this.parent.crudModule.deleteEvent(eventData, this.parent.currentAction);\n          break;\n      }\n    } else if (target.classList.contains(QUICK_DIALOG_SERIES_CLASS)) {\n      this.parent.currentAction = this.parent.currentAction === 'Delete' ? 'DeleteSeries' : 'EditSeries';\n\n      switch (this.parent.currentAction) {\n        case 'EditSeries':\n          this.parent.eventWindow.openEditor(this.parent.eventBase.getParentEvent(eventData, true), this.parent.currentAction);\n          break;\n\n        case 'DeleteSeries':\n          this.parent.crudModule.deleteEvent(eventData, this.parent.currentAction);\n          break;\n      }\n    } else if (target.classList.contains(QUICK_DIALOG_DELETE_CLASS)) {\n      this.parent.crudModule.deleteEvent(eventData, this.parent.currentAction);\n    } else if (!cancelBtn.classList.contains(DISABLE_CLASS) && (target.classList.contains(QUICK_DIALOG_ALERT_OK) || target.classList.contains(QUICK_DIALOG_ALERT_CANCEL) && !cancelBtn.classList.contains(QUICK_DIALOG_CANCEL_CLASS))) {\n      this.parent.uiStateValues.isIgnoreOccurrence = target.classList.contains(QUICK_DIALOG_ALERT_CANCEL);\n      this.parent.eventWindow.eventSave(event, this.l10n.getConstant('ok'));\n    }\n  }\n\n  updateTapHoldEventPopup(target) {\n    const selectedElements = this.parent.eventBase.getSelectedEventElements(target);\n    this.parent.activeEventData = this.parent.eventBase.getSelectedEvents();\n\n    if (selectedElements.length > 0) {\n      const eventObj = this.parent.eventBase.getEventByGuid(selectedElements[0].getAttribute('data-guid'));\n      const titleContent = selectedElements.length === 1 ? eventObj[this.parent.eventFields.subject] || this.l10n.getConstant('noTitle') : '(' + selectedElements.length + ')' + '&nbsp;' + this.l10n.getConstant('selectedItems');\n      this.quickPopup.element.querySelector('.' + SUBJECT_CLASS).innerHTML = titleContent;\n\n      if (selectedElements.length > 1) {\n        addClass([this.quickPopup.element.querySelector('.' + EDIT_ICON_CLASS)], HIDDEN_CLASS);\n      } else {\n        removeClass([this.quickPopup.element.querySelector('.' + EDIT_ICON_CLASS)], HIDDEN_CLASS);\n      }\n    } else {\n      this.parent.selectedElements = [];\n      this.quickPopupHide();\n    }\n  }\n\n  getTimezone(event) {\n    let zoneDetails = '';\n    zoneDetails += event[this.parent.eventFields.startTimezone] || '';\n    zoneDetails += zoneDetails === '' ? '' : ' - ';\n    zoneDetails += event[this.parent.eventFields.endTimezone] || '';\n    return zoneDetails;\n  }\n\n  getRecurrenceSummary(event) {\n    const recurrenceEditor = this.parent.eventWindow.getRecurrenceEditorInstance();\n\n    if (recurrenceEditor) {\n      const ruleSummary = recurrenceEditor.getRuleSummary(event[this.parent.eventFields.recurrenceRule]);\n      return ruleSummary.charAt(0).toUpperCase() + ruleSummary.slice(1);\n    }\n\n    return '';\n  }\n\n  getDateFormat(date, skeletonString) {\n    return capitalizeFirstWord(this.parent.globalize.formatDate(date, {\n      skeleton: skeletonString,\n      calendar: this.parent.getCalendarMode()\n    }), 'single');\n  }\n\n  getDataFromTarget(target) {\n    if (target.classList.contains(APPOINTMENT_CLASS)) {\n      return this.parent.activeEventData.event;\n    } // Deprecated cells data in quick popups\n\n\n    const eventObj = {\n      startTime: this.parent.activeCellsData.startTime,\n      endTime: this.parent.activeCellsData.endTime,\n      isAllDay: this.parent.activeCellsData.isAllDay,\n      groupIndex: this.parent.activeCellsData.groupIndex\n    };\n    const cellsData = this.parent.activeCellsData;\n    this.parent.eventWindow.convertToEventData(cellsData, eventObj);\n    return eventObj;\n  }\n\n  beforeQuickDialogClose(e) {\n    const args = {\n      event: e.event || this.dialogEvent,\n      type: isNullOrUndefined(this.parent.activeEventData.event) ? 'ValidationAlert' : !isNullOrUndefined(this.parent.activeEventData.event[this.parent.eventFields.recurrenceRule]) ? 'RecurrenceAlert' : 'DeleteAlert',\n      cancel: false,\n      data: this.parent.activeEventData.event,\n      element: this.quickDialog.element\n    };\n    this.parent.trigger(popupClose, args, popupCloseArgs => {\n      if (!popupCloseArgs.cancel) {\n        this.parent.eventBase.focusElement(true);\n      }\n    });\n  }\n\n  beforeQuickPopupOpen(target) {\n    this.parent.renderTemplates();\n    const isEventPopup = this.quickPopup.element.querySelector('.' + EVENT_POPUP_CLASS);\n    const popupType = this.parent.isAdaptive ? isEventPopup ? 'ViewEventInfo' : 'EditEventInfo' : 'QuickInfo';\n    const eventProp = {\n      type: popupType,\n      cancel: false,\n      data: extend({}, this.getDataFromTarget(target), null, true),\n      target: target,\n      element: this.quickPopup.element\n    };\n    this.parent.trigger(popupOpen, eventProp, popupArgs => {\n      if (popupArgs.cancel) {\n        this.quickPopupHide();\n        this.destroyPopupButtons('quickPopup');\n\n        if (popupArgs.element.classList.contains(POPUP_OPEN)) {\n          this.quickPopupClose();\n        }\n\n        removeChildren(this.quickPopup.element);\n        this.isMultipleEventSelect = false;\n      } else {\n        const display = this.quickPopup.element.style.display;\n        this.quickPopup.element.style.display = 'block';\n\n        if (this.parent.isAdaptive) {\n          this.quickPopup.element.removeAttribute('style');\n          this.quickPopup.element.style.display = 'block';\n          this.quickPopup.element.style.height = formatUnit(popupType === 'EditEventInfo' ? 65 : window.innerHeight);\n        } else {\n          this.quickPopup.offsetX = 10;\n          this.quickPopup.collision = {\n            X: this.parent.enableRtl ? 'flip' : 'none',\n            Y: 'fit'\n          };\n          this.quickPopup.position = {\n            X: this.parent.enableRtl ? 'left' : 'right',\n            Y: this.parent.enableRtl ? 'bottom' : 'top'\n          };\n          this.quickPopup.dataBind();\n          this.quickPopup.refreshPosition(null, true);\n          const collide = isCollide(this.quickPopup.element, this.parent.element);\n\n          if (collide.indexOf(this.parent.enableRtl ? 'left' : 'right') > -1) {\n            this.quickPopup.offsetX = -target.offsetWidth - 10 - this.quickPopup.element.offsetWidth;\n            this.quickPopup.dataBind();\n            const leftCollide = isCollide(this.quickPopup.element, this.parent.element);\n\n            if (leftCollide.indexOf('left') > -1) {\n              this.quickPopup.position = {\n                X: 'center',\n                Y: 'center'\n              };\n              this.quickPopup.collision = {\n                X: 'fit',\n                Y: 'fit'\n              };\n              this.quickPopup.offsetX = -(this.quickPopup.element.offsetWidth / 2);\n              this.quickPopup.dataBind();\n            }\n          }\n\n          if (this.parent.virtualScrollModule && (collide.indexOf('top') > -1 || collide.indexOf('bottom') > -1)) {\n            const element = this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS + ' table');\n            const translateY = getTranslateY(element);\n            this.quickPopup.offsetY = translateY;\n            this.quickPopup.dataBind();\n          }\n        }\n\n        if (isEventPopup) {\n          this.applyEventColor();\n        }\n\n        this.quickPopup.element.style.display = display;\n        this.quickPopup.dataBind();\n        this.quickPopup.show();\n      }\n    });\n  }\n\n  applyEventColor() {\n    let colorField = '';\n\n    if (this.parent.currentView === 'Agenda' || this.parent.currentView === 'MonthAgenda') {\n      colorField = this.parent.enableRtl ? 'border-right-color' : 'border-left-color';\n    } else {\n      colorField = 'background-color';\n    }\n\n    let color = this.parent.activeEventData.element.style[colorField];\n\n    if (color === '') {\n      return;\n    }\n\n    let colorEle = this.quickPopup.element.querySelector('.' + POPUP_HEADER_CLASS);\n    const footerEle = this.quickPopup.element.querySelector('.' + POPUP_FOOTER_CLASS);\n\n    if (footerEle && footerEle.offsetParent) {\n      colorEle = this.quickPopup.element.querySelector('.' + SUBJECT_CLASS);\n\n      if (colorEle) {\n        colorEle.style.borderLeftColor = color;\n        color = `rgba(${color.match(/\\d+/g).join()},0.3)`;\n      }\n    }\n\n    if (colorEle) {\n      colorEle.style.backgroundColor = color;\n    }\n  }\n\n  quickPopupOpen() {\n    if (this.parent.isAdaptive) {\n      this.quickPopup.element.style.top = '0px';\n      return;\n    }\n\n    if (this.quickPopup.element.querySelector('.' + CELL_POPUP_CLASS)) {\n      const subjectElement = this.quickPopup.element.querySelector('.' + SUBJECT_CLASS);\n\n      if (subjectElement) {\n        subjectElement.focus();\n      }\n    } else {\n      const editElement = this.quickPopup.element.querySelector('.' + EDIT_EVENT_CLASS);\n\n      if (editElement) {\n        editElement.focus();\n      }\n\n      const editIcon = this.quickPopup.element.querySelector('.' + EDIT_CLASS);\n\n      if (editIcon) {\n        editIcon.focus();\n      }\n    }\n  }\n\n  quickPopupClose() {\n    this.parent.eventBase.focusElement();\n    this.quickPopup.relateTo = WORK_CELLS_CLASS;\n    this.fieldValidator.destroyToolTip();\n\n    if (this.quickPopup.element.querySelectorAll('.e-formvalidator').length) {\n      this.fieldValidator.destroy();\n    }\n\n    this.destroyPopupButtons('quickPopup');\n    removeChildren(this.quickPopup.element);\n  }\n\n  morePopupOpen() {\n    if (this.parent.isAdaptive) {\n      this.morePopup.element.style.top = '0px';\n      this.morePopup.element.style.left = '0px';\n      this.morePopup.element.style.height = formatUnit(window.innerHeight);\n      return;\n    }\n\n    this.morePopup.element.querySelector('.' + MORE_EVENT_HEADER_DATE_CLASS).focus();\n    this.morePopup.refreshPosition();\n  }\n\n  morePopupClose() {\n    const moreWrapper = this.parent.element.querySelector('.' + MORE_EVENT_WRAPPER_CLASS);\n\n    if (moreWrapper) {\n      remove(moreWrapper);\n    }\n  }\n\n  popupClose(event) {\n    this.dialogEvent = event;\n    this.isCrudAction = false;\n    this.quickPopupHide(true);\n  }\n\n  quickPopupHide(hideAnimation) {\n    if (!this.quickPopup.element.classList.contains(POPUP_OPEN)) {\n      return;\n    }\n\n    const isCellPopup = this.quickPopup.element.querySelector('.' + CELL_POPUP_CLASS);\n    let popupData;\n\n    if (isCellPopup) {\n      const formvalidator = this.quickPopup.element.querySelector('.e-formvalidator');\n\n      if (this.isCrudAction && formvalidator && !formvalidator.ej2_instances[0].validate()) {\n        return;\n      }\n\n      const fields = this.parent.eventFields;\n      const saveObj = this.parent.eventWindow.getObjectFromFormData(POPUP_WRAPPER_CLASS);\n      this.parent.eventWindow.setDefaultValueToObject(saveObj);\n      saveObj[fields.id] = this.parent.eventBase.getEventMaxID();\n      saveObj[fields.startTime] = this.parent.activeCellsData.startTime;\n      saveObj[fields.endTime] = this.parent.activeCellsData.endTime;\n      saveObj[fields.isAllDay] = this.parent.activeCellsData.isAllDay;\n\n      if (this.parent.resourceBase) {\n        this.parent.resourceBase.setResourceValues(saveObj);\n      }\n\n      popupData = saveObj;\n    } else {\n      popupData = this.parent.activeEventData.event;\n    }\n\n    const isEventPopup = this.quickPopup.element.querySelector('.' + EVENT_POPUP_CLASS);\n    const args = {\n      event: this.dialogEvent,\n      type: this.parent.isAdaptive ? isEventPopup ? 'ViewEventInfo' : 'EditEventInfo' : 'QuickInfo',\n      cancel: false,\n      data: popupData,\n      element: this.quickPopup.element,\n      target: isCellPopup ? this.parent.activeCellsData.element : this.parent.activeEventData.element\n    };\n    this.parent.trigger(popupClose, args, popupCloseArgs => {\n      if (!popupCloseArgs.cancel) {\n        if (this.quickPopup.element.classList.contains('e-popup-open')) {\n          if (isCellPopup && this.isCrudAction) {\n            this.parent.currentAction = 'Add';\n            this.parent.crudModule.addEvent(popupCloseArgs.data);\n          }\n\n          if (hideAnimation) {\n            const animation = this.quickPopup.hideAnimation;\n            this.quickPopup.hideAnimation = null;\n            this.quickPopup.hide();\n            this.quickPopup.hideAnimation = animation;\n          } else {\n            this.quickPopup.hide();\n          }\n\n          this.isMultipleEventSelect = false;\n          this.isCrudAction = false;\n        }\n      }\n    });\n  }\n\n  navigationClick(e) {\n    const navigateEle = closest(e.target, '.' + NAVIGATE_CLASS);\n\n    if (!isNullOrUndefined(navigateEle)) {\n      const date = this.parent.getDateFromElement(e.currentTarget);\n\n      if (!isNullOrUndefined(date)) {\n        this.closeClick(e);\n        this.parent.setProperties({\n          selectedDate: date\n        }, true);\n        this.parent.changeView(this.parent.getNavigateView(), e);\n      }\n    }\n  }\n\n  documentClick(e) {\n    const target = e.event.target;\n    const classNames = '.' + POPUP_WRAPPER_CLASS + ',.' + HEADER_CELLS_CLASS + ',.' + ALLDAY_CELLS_CLASS + ',.' + WORK_CELLS_CLASS + ',.' + APPOINTMENT_CLASS + ',.e-popup';\n    const popupWrap = this.parent.element.querySelector('.' + POPUP_WRAPPER_CLASS);\n\n    if (popupWrap && popupWrap.childElementCount > 0 && !closest(target, classNames) || !closest(target, classNames)) {\n      this.quickPopupHide();\n      this.parent.removeNewEventElement();\n    }\n\n    const tar = this.parent.element.querySelector('.' + INLINE_SUBJECT_CLASS);\n\n    if (tar && tar !== target && this.parent.allowInline) {\n      this.parent.inlineModule.documentClick();\n    }\n\n    if (closest(target, '.' + APPOINTMENT_CLASS + ',.' + HEADER_CELLS_CLASS)) {\n      this.parent.removeNewEventElement();\n    }\n\n    if (!closest(target, '.' + MORE_POPUP_WRAPPER_CLASS) && target.classList && !target.classList.contains(MORE_INDICATOR_CLASS) && !closest(target, '.' + POPUP_OPEN) && !closest(target, '.' + WORK_CELLS_CLASS)) {\n      this.morePopup.hide();\n    }\n  }\n\n  onClosePopup(event) {\n    if (!isNullOrUndefined(event)) {\n      this.dialogEvent = event;\n    }\n\n    this.quickPopupHide();\n    this.parent.eventBase.focusElement();\n  }\n\n  addEventListener() {\n    this.parent.on(cellClick, this.cellClick, this);\n    this.parent.on(eventClick, this.eventClick, this);\n    this.parent.on(documentClick, this.documentClick, this);\n    this.parent.on(dataReady, this.updateMoreEventContent, this);\n  }\n\n  removeEventListener() {\n    this.parent.off(cellClick, this.cellClick);\n    this.parent.off(eventClick, this.eventClick);\n    this.parent.off(documentClick, this.documentClick);\n    this.parent.off(dataReady, this.updateMoreEventContent);\n  }\n\n  destroyPopupButtons(popupName) {\n    const popup = popupName === 'quickPopup' ? this.quickPopup : this.morePopup;\n    const buttonCollections = [].slice.call(popup.element.querySelectorAll('.e-control.e-btn'));\n\n    for (const button of buttonCollections) {\n      const instance = button.ej2_instances[0];\n\n      if (instance) {\n        instance.destroy();\n      }\n    }\n  }\n\n  refreshQuickDialog() {\n    this.destroyQuickDialog();\n    this.renderQuickDialog();\n  }\n\n  refreshQuickPopup() {\n    this.destroyQuickPopup();\n    this.renderQuickPopup();\n  }\n\n  refreshMorePopup() {\n    this.destroyMorePopup();\n    this.renderMorePopup();\n  }\n\n  destroyQuickDialog() {\n    if (this.quickDialog.element) {\n      this.quickDialog.destroy();\n      remove(this.quickDialog.element);\n      this.quickDialog = null;\n    }\n  }\n\n  destroyQuickPopup() {\n    if (this.quickPopup.element) {\n      this.destroyPopupButtons('quickPopup');\n      this.quickPopup.destroy();\n      remove(this.quickPopup.element);\n      this.quickPopup = null;\n    }\n  }\n\n  destroyMorePopup() {\n    if (this.morePopup.element) {\n      this.destroyPopupButtons('morePopup');\n      this.morePopup.destroy();\n      remove(this.morePopup.element);\n      this.morePopup = null;\n    }\n  }\n\n  destroy() {\n    if (this.quickPopup.element.querySelectorAll('.e-formvalidator').length) {\n      this.fieldValidator.destroy();\n    }\n\n    this.removeEventListener();\n    this.destroyQuickPopup();\n    this.destroyMorePopup();\n    this.destroyQuickDialog();\n    this.parent = null;\n    this.l10n = null;\n    this.isCrudAction = null;\n    this.fieldValidator = null;\n    this.isMultipleEventSelect = null;\n  }\n\n}\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\n/**\n * Tooltip for Schedule\n */\n\n\nclass EventTooltip {\n  constructor(parent) {\n    this.parent = parent;\n    this.tooltipObj = new Tooltip({\n      animation: {\n        close: {\n          effect: 'FadeOut'\n        }\n      },\n      content: 'No title',\n      position: 'BottomRight',\n      offsetY: 10,\n      mouseTrail: this.parent.isAdaptive ? false : true,\n      showTipPointer: false,\n      cssClass: this.parent.cssClass + ' ' + EVENT_TOOLTIP_ROOT_CLASS,\n      target: this.getTargets(),\n      beforeRender: this.onBeforeRender.bind(this),\n      beforeClose: this.onBeforeClose.bind(this),\n      enableRtl: this.parent.enableRtl\n    });\n    this.tooltipObj.appendTo(this.parent.element);\n  }\n\n  getTargets() {\n    const targets = [];\n\n    if (this.parent.activeViewOptions.group.headerTooltipTemplate) {\n      targets.push('.' + RESOURCE_CELLS_CLASS);\n    }\n\n    if (this.parent.eventSettings.enableTooltip) {\n      targets.push('.' + APPOINTMENT_CLASS);\n    }\n\n    return targets.join(',');\n  }\n\n  onBeforeRender(args) {\n    if (!isNullOrUndefined(args.target.getAttribute('data-tooltip-id'))) {\n      return;\n    }\n\n    if (args.target.classList.contains(RESOURCE_CELLS_CLASS) && this.parent.activeViewOptions.group.resources.length > 0) {\n      let resCollection;\n\n      if (this.parent.activeView.isTimelineView()) {\n        const index = parseInt(args.target.getAttribute('data-group-index'), 10);\n        resCollection = this.parent.resourceBase.lastResourceLevel[index];\n      } else {\n        const rowIndex = args.target.parentNode.sectionRowIndex;\n        const cellIndex = args.target.cellIndex;\n        resCollection = this.parent.activeView.getColumnLevels()[rowIndex][cellIndex];\n      }\n\n      const data = {\n        resource: resCollection.resource,\n        resourceData: resCollection.resourceData\n      };\n      const contentContainer = createElement('div');\n      const templateId = this.parent.element.id + '_headerTooltipTemplate';\n      const tooltipTemplate = [].slice.call(this.parent.getHeaderTooltipTemplate()(data, this.parent, 'headerTooltipTemplate', templateId, false));\n      append(tooltipTemplate, contentContainer);\n      this.setContent(contentContainer);\n      this.parent.renderTemplates();\n      return;\n    }\n\n    const record = this.parent.eventBase.getEventByGuid(args.target.getAttribute('data-guid'));\n\n    if (isNullOrUndefined(record)) {\n      return;\n    }\n\n    if (!isNullOrUndefined(this.parent.eventSettings.tooltipTemplate)) {\n      const contentContainer = createElement('div');\n      const templateId = this.parent.element.id + '_tooltipTemplate';\n      const tooltipTemplate = [].slice.call(this.parent.getEventTooltipTemplate()(record, this.parent, 'tooltipTemplate', templateId, false));\n      append(tooltipTemplate, contentContainer);\n      this.setContent(contentContainer);\n    } else {\n      const globalize = this.parent.globalize;\n      const fields = this.parent.eventFields;\n      const eventStart = new Date('' + record[fields.startTime]);\n      let eventEnd = new Date('' + record[fields.endTime]);\n      eventEnd = eventEnd.getHours() === 0 && eventEnd.getMinutes() === 0 ? new Date(eventEnd.setMilliseconds(-1000)) : eventEnd;\n      const startDate = resetTime(new Date('' + eventStart));\n      const endDate = resetTime(new Date('' + eventEnd));\n      const tooltipSubject = record[fields.subject] || this.parent.eventSettings.fields.subject.default || this.parent.localeObj.getConstant('addTitle');\n      const tooltipLocation = !isNullOrUndefined(record[fields.location]) ? record[fields.location] : '';\n      let startMonthDate = '';\n      let startMonthYearDate = '';\n      let endMonthYearDate = '';\n      startMonthDate = globalize.formatDate(eventStart, {\n        type: 'date',\n        skeleton: 'MMMd',\n        calendar: this.parent.getCalendarMode()\n      });\n      startMonthYearDate = globalize.formatDate(eventStart, {\n        type: 'date',\n        skeleton: 'medium',\n        calendar: this.parent.getCalendarMode()\n      });\n      endMonthYearDate = globalize.formatDate(eventEnd, {\n        type: 'date',\n        skeleton: 'medium',\n        calendar: this.parent.getCalendarMode()\n      });\n      startMonthDate = capitalizeFirstWord(startMonthDate, 'single');\n      startMonthYearDate = capitalizeFirstWord(startMonthYearDate, 'single');\n      endMonthYearDate = capitalizeFirstWord(endMonthYearDate, 'single');\n      const skeleton = 'short';\n      const startTime = globalize.formatDate(eventStart, {\n        type: 'time',\n        skeleton: skeleton,\n        calendar: this.parent.getCalendarMode()\n      });\n      const endTime = globalize.formatDate(eventEnd, {\n        type: 'time',\n        skeleton: skeleton,\n        calendar: this.parent.getCalendarMode()\n      });\n      let tooltipDetails;\n\n      if (startDate.getTime() === endDate.getTime()) {\n        tooltipDetails = globalize.formatDate(eventStart, {\n          type: 'date',\n          skeleton: 'long',\n          calendar: this.parent.getCalendarMode()\n        });\n        tooltipDetails = capitalizeFirstWord(tooltipDetails, 'single');\n      } else {\n        tooltipDetails = startDate.getFullYear() === endDate.getFullYear() ? startMonthDate + ' - ' + endMonthYearDate : startMonthYearDate + ' - ' + endMonthYearDate;\n      }\n\n      const tooltipTime = record[fields.isAllDay] ? this.parent.localeObj.getConstant('allDay') : startTime + ' - ' + endTime;\n      const content = '<div><div class=\"e-subject\">' + tooltipSubject + '</div>' + '<div class=\"e-location\">' + tooltipLocation + '</div>' + '<div class=\"e-details\">' + tooltipDetails + '</div>' + '<div class=\"e-all-day\">' + tooltipTime + '</div></div>';\n      this.setContent(content);\n    }\n\n    this.parent.renderTemplates();\n  }\n\n  onBeforeClose() {\n    this.parent.resetTemplates(['tooltipTemplate', 'headerTooltipTemplate']);\n  }\n\n  setContent(content) {\n    this.tooltipObj.setProperties({\n      content: content\n    }, true);\n  }\n\n  close() {\n    this.tooltipObj.close();\n  }\n\n  destroy() {\n    this.tooltipObj.destroy();\n    addClass([this.parent.element], 'e-control');\n    this.tooltipObj = null;\n    this.parent = null;\n  }\n\n}\n\nvar __decorate$1 = undefined && undefined.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nconst HEADER = 'e-editor';\nconst INPUTWARAPPER = 'e-input-wrapper';\nconst INPUTWARAPPERSIDE = 'e-input-wrapper-side';\nconst REPEATELEMENT = 'e-repeat-element';\nconst REPEATINTERVAL = 'e-repeat-interval';\nconst INTERVALCLASS = 'e-interval';\nconst DAYWRAPPER = 'e-days';\nconst WEEKWRAPPER = 'e-non-week';\nconst WEEKPOSITION = 'e-week-position';\nconst DAYPOSITION = 'e-day-position';\nconst YEAREXPANDERWRAPPER = 'e-year-expander';\nconst YEAREXPANDERELEMENT = 'e-year-expander-element';\nconst MONETHEXPANDERWRAPPER = 'e-month-expander';\nconst MONETHEXPANDWRAPPER = 'e-month-expand-wrapper';\nconst MONTHEXPANDERELEMENT = 'e-month-expander-element';\nconst MONTHEXPANDERCHECKBOXWRAPPER = 'e-month-expander-checkbox-wrapper';\nconst FORMLEFT = 'e-form-left';\nconst FORMRIGHT = 'e-form-right';\nconst MONTHDAYWRAPPER = 'e-month-day';\nconst MONTHEXPANNDERELEM = 'e-month-expander-wrapper';\nconst MONTHPOS = 'e-month-pos';\nconst MONTHWEEK = 'e-month-week';\nconst ENDON = 'e-end-on';\nconst MONTHEXPANDERLABEL = 'e-month-expander-label';\nconst WEEKEXPANDERLABEL = 'e-week-expander-label';\nconst ENDONLABEL = 'e-end-on-label';\nconst ENDONLEFT = 'e-end-on-left';\nconst MONTHDAYELEMENT = 'e-monthday-element';\nconst ENDONELEMENT = 'e-end-on-element';\nconst ENDONDATE = 'e-end-on-date';\nconst UNTILDATE = 'e-until-date';\nconst ENDONCOUNTWRAPPER = 'e-end-on-count';\nconst ENDONCOUNT = 'e-recurrence-count';\nconst HIDEWRAPPER = 'e-hide-recurrence-element';\nconst RTLCLASS = 'e-rtl';\nconst PRIMARY = 'e-primary';\nconst ACTIVE = 'e-active';\nconst RECURRENCETABLE = 'e-recurrence-table';\nconst REPEATCONTENT = 'e-repeat-content';\nconst REPEATCONTENTWRAPPER = 'e-repeat-content-wrapper';\nconst NONE = 'none';\nconst DAILY = 'daily';\nconst WEEKLY = 'weekly';\nconst MONTHLY = 'monthly';\nconst YEARLY = 'yearly';\nconst NEVER = 'never';\nconst UNTIL$1 = 'until';\nconst COUNT = 'count';\nconst TEXTFIELD = 'text';\nconst VALUEFIELD = 'value';\nconst LAST = 'last';\nconst REPEAT = 'repeat';\nconst REPEATEVERY = 'repeatEvery';\nconst ON$1 = 'on';\nconst END = 'end';\nconst RADIOLABEL = 'onDay';\nconst RULEUNTIL = 'UNTIL';\nconst RULEBYDAY = 'BYDAY';\nconst RULEBYMONTHDAY = 'BYMONTHDAY';\nconst RULEBYMONTH = 'BYMONTH';\nconst RULEINTERVAL = 'INTERVAL';\nconst RULECOUNT = 'COUNT';\nconst RULESETPOS = 'BYSETPOS';\nconst RULEFREQ = 'FREQ';\nconst RULEDAILY = 'DAILY';\nconst RULEWEEKLY = 'WEEKLY';\nconst RULEMONTHLY = 'MONTHLY';\nconst RULEYEARLY = 'YEARLY';\nconst RULESUNDAY = 'SU';\nconst RULEMONDAY = 'MO';\nconst RULETUESDAY = 'TU';\nconst RULEWEDNESDAY = 'WE';\nconst RULETHURSDAY = 'TH';\nconst RULEFRIDAY = 'FR';\nconst RULESATURDAY = 'SA';\nconst KEYSUNDAY = 'sun';\nconst KEYMONDAY = 'mon';\nconst KEYTUESDAY = 'tue';\nconst KEYWEDNESDAY = 'wed';\nconst KEYTHURSDAY = 'thu';\nconst KEYFRIDAY = 'fri';\nconst KEYSATURDAY = 'sat';\nconst EQUAL = '=';\nconst SEMICOLON = ';';\nconst COMMA = ',';\nconst FIRST = 'first';\nconst SECOND = 'second';\nconst THIRD = 'third';\nconst FOURTH = 'fourth';\nconst contentType = {\n  none: '',\n  daily: 'days',\n  weekly: 'weeks',\n  monthly: 'months',\n  yearly: 'years'\n};\nconst valueData = {\n  'sun': RULESUNDAY,\n  'mon': RULEMONDAY,\n  'tue': RULETUESDAY,\n  'wed': RULEWEDNESDAY,\n  'thu': RULETHURSDAY,\n  'fri': RULEFRIDAY,\n  'sat': RULESATURDAY\n};\nconst neverClassList = [DAYWRAPPER, WEEKWRAPPER, ENDON, INTERVALCLASS, YEAREXPANDERWRAPPER, MONETHEXPANDERWRAPPER];\nconst weekClassList = [WEEKWRAPPER];\nconst monthClassList = [DAYWRAPPER, YEAREXPANDERWRAPPER];\nconst yearClassList = [DAYWRAPPER];\nconst dailyClassList = [DAYWRAPPER, WEEKWRAPPER, YEAREXPANDERWRAPPER, MONETHEXPANDERWRAPPER];\nconst noEndClassList = [ENDONDATE, ENDONCOUNTWRAPPER];\nconst endOnCountClassList = [ENDONDATE];\nconst endOnDateClassList = [ENDONCOUNTWRAPPER];\n/**\n * Represents the RecurrenceEditor component.\n * ```html\n * <div id=\"recurrence\"></div>\n * ```\n * ```typescript\n * <script>\n *   var recObj = new RecurrenceEditor();\n *   recObj.appendTo(\"#recurrence\");\n * </script>\n * ```\n */\n\nlet RecurrenceEditor = class RecurrenceEditor extends Component {\n  /**\n   * Constructor for creating the widget\n   *\n   * @param {RecurrenceEditorModel} options Accepts the recurrence editor model properties to initiate the rendering\n   * @param {string | HTMLElement} element Accepts the DOM element reference\n   */\n  constructor(options, element) {\n    super(options, element); // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\n    this.defaultLocale = {\n      none: 'None',\n      daily: 'Daily',\n      weekly: 'Weekly',\n      monthly: 'Monthly',\n      month: 'Month',\n      yearly: 'Yearly',\n      never: 'Never',\n      until: 'Until',\n      count: 'Count',\n      first: 'First',\n      second: 'Second',\n      third: 'Third',\n      fourth: 'Fourth',\n      last: 'Last',\n      repeat: 'Repeat',\n      repeatEvery: 'Repeat every',\n      on: 'Repeat On',\n      end: 'End',\n      onDay: 'Day',\n      days: 'Day(s)',\n      weeks: 'Week(s)',\n      months: 'Month(s)',\n      years: 'Year(s)',\n      every: 'every',\n      summaryTimes: 'time(s)',\n      summaryOn: 'on',\n      summaryUntil: 'until',\n      summaryRepeat: 'Repeats',\n      summaryDay: 'day(s)',\n      summaryWeek: 'week(s)',\n      summaryMonth: 'month(s)',\n      summaryYear: 'year(s)',\n      monthWeek: 'Month Week',\n      monthPosition: 'Month Position',\n      monthExpander: 'Month Expander',\n      yearExpander: 'Year Expander',\n      repeatInterval: 'Repeat Interval'\n    };\n    this.renderStatus = false;\n    this.dayButtons = [];\n    this.monthButtons = [];\n  }\n\n  startState(freq, endOn, startDate) {\n    this.showFormElement();\n    this.updateForm(freq);\n    this.freshOnEndForm();\n    this.updateEndOnForm(endOn);\n    this.selectMonthDay(startDate);\n    this.updateUntilDate(startDate);\n    this.onMonthDay.setProperties({\n      checked: true\n    });\n  }\n\n  preRender() {\n    this.localeObj = new L10n(this.getModuleName(), this.defaultLocale, this.locale);\n    this.calendarUtil = getCalendarUtil(this.calendarMode);\n  }\n\n  applyCustomClass(cssClass) {\n    if (cssClass) {\n      addClass([this.element], cssClass.split(' '));\n    }\n  }\n\n  initialize() {\n    addClass([this.element], 'e-' + this.getModuleName());\n    this.renderComponent();\n\n    if (!isNullOrUndefined(this.value) && this.value !== '') {\n      this.setRecurrenceRule(this.value);\n    } else {\n      if (!isNullOrUndefined(this.repeatType.value)) {\n        this.startState(this.repeatType.value.toString().toUpperCase(), NEVER, this.startDate);\n        this.updateForm(this.repeatType.value.toString());\n      }\n\n      if (this.selectedType > 0) {\n        this.setProperties({\n          value: this.getRecurrenceRule()\n        }, false);\n      }\n    }\n\n    this.applyCustomClass(this.cssClass);\n  }\n\n  triggerChangeEvent() {\n    if (this.renderStatus) {\n      const value = this.getRecurrenceRule();\n      this.trigger('change', {\n        value: value\n      }, args => this.setProperties({\n        value: args.value\n      }, false));\n    }\n  }\n\n  resetDayButton() {\n    const elements = [].slice.call(this.element.querySelectorAll('.' + DAYWRAPPER + ' button'));\n    elements.forEach(element => removeClass([element], [ACTIVE, PRIMARY]));\n  }\n\n  daySelection(dayIndex) {\n    this.resetDayButton();\n    const days = [0, 1, 2, 3, 4, 5, 6];\n    this.rotateArray(days, this.firstDayOfWeek);\n    const element = this.element.querySelector('.' + DAYWRAPPER + ' button[data-index=\"' + days.indexOf(dayIndex) + '\"]');\n\n    if (element) {\n      addClass([element], [ACTIVE, PRIMARY]);\n    }\n  }\n\n  rtlClass(status) {\n    if (status) {\n      addClass([this.element], RTLCLASS);\n    } else {\n      removeClass([this.element], RTLCLASS);\n    }\n  }\n\n  updateUntilDate(date) {\n    const tempDate = new Date(date.getTime());\n    tempDate.setDate(tempDate.getDate() + 60);\n    this.untilDateObj.setProperties({\n      value: tempDate\n    });\n  }\n\n  selectMonthDay(date) {\n    const weekday = [KEYSUNDAY, KEYMONDAY, KEYTUESDAY, KEYWEDNESDAY, KEYTHURSDAY, KEYFRIDAY, KEYSATURDAY];\n    this.monthDate.setProperties({\n      value: this.calendarUtil.getDate(date)\n    });\n    this.monthWeekDays.setProperties({\n      value: valueData[weekday[date.getDay()]]\n    });\n    this.monthValue.setProperties({\n      value: '' + this.calendarUtil.getMonth(date)\n    });\n    this.monthWeekPos.setProperties({\n      value: this.getDayPosition(date)\n    });\n    this.daySelection(date.getDay());\n  }\n\n  updateForm(state) {\n    this.repeatType.setProperties({\n      value: state\n    });\n    const end = this.element.querySelector('.' + ENDON);\n\n    if (state === DAILY) {\n      classList(end, [FORMLEFT], [FORMRIGHT]);\n    } else {\n      classList(end, [FORMRIGHT], [FORMLEFT]);\n    }\n\n    switch (state) {\n      case NONE:\n        neverClassList.forEach(className => addClass([this.element.querySelector('.' + className)], HIDEWRAPPER));\n        break;\n\n      case WEEKLY:\n        weekClassList.forEach(className => addClass([this.element.querySelector('.' + className)], HIDEWRAPPER));\n        break;\n\n      case MONTHLY:\n        monthClassList.forEach(className => addClass([this.element.querySelector('.' + className)], HIDEWRAPPER));\n        break;\n\n      case YEARLY:\n        yearClassList.forEach(className => addClass([this.element.querySelector('.' + className)], HIDEWRAPPER));\n        break;\n\n      case DAILY:\n        dailyClassList.forEach(className => addClass([this.element.querySelector('.' + className)], HIDEWRAPPER));\n        break;\n    }\n  }\n\n  updateEndOnForm(state) {\n    this.endType.setProperties({\n      value: state\n    });\n\n    switch (state) {\n      case NEVER:\n        noEndClassList.forEach(className => addClass([this.element.querySelector('.' + className)], HIDEWRAPPER));\n        break;\n\n      case UNTIL$1:\n        endOnDateClassList.forEach(className => addClass([this.element.querySelector('.' + className)], HIDEWRAPPER));\n        break;\n\n      case COUNT:\n        endOnCountClassList.forEach(className => addClass([this.element.querySelector('.' + className)], HIDEWRAPPER));\n        break;\n    }\n  }\n\n  freshOnEndForm() {\n    noEndClassList.forEach(className => {\n      const element = this.element.querySelector('.' + className);\n\n      if (element) {\n        removeClass([element], HIDEWRAPPER);\n      }\n    });\n  }\n\n  showFormElement() {\n    neverClassList.forEach(className => {\n      const hideElement = this.element.querySelector('.' + className);\n\n      if (hideElement) {\n        removeClass([hideElement], HIDEWRAPPER);\n      }\n    });\n  }\n\n  renderDropdowns() {\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    const self = this;\n    this.repeatType = new DropDownList({\n      //set the data to dataSource property\n      dataSource: this.getRepeatData(),\n      floatLabelType: 'Always',\n      enableRtl: this.enableRtl,\n      index: this.selectedType,\n      fields: {\n        text: TEXTFIELD,\n        value: VALUEFIELD\n      },\n      placeholder: this.localeObj.getConstant(REPEAT),\n      htmlAttributes: {\n        'title': this.localeObj.getConstant(REPEAT),\n        role: 'option'\n      },\n      change: args => {\n        self.setProperties({\n          selectedType: this.frequencies.indexOf(args.value)\n        }, false);\n        self.element.querySelector('.' + REPEATCONTENT).innerHTML = self.localeObj.getConstant(contentType[args.value]);\n        self.showFormElement();\n        self.updateForm(args.value);\n        self.resetFormValues();\n        self.triggerChangeEvent();\n      }\n    }); // set placeholder to DropDownList input element\n\n    this.repeatType.appendTo(this.element.querySelector('.' + REPEATELEMENT));\n    this.endType = new DropDownList({\n      dataSource: this.getEndData(),\n      popupWidth: this.getPopupWidth(),\n      enableRtl: this.enableRtl,\n      index: 1,\n      fields: {\n        text: TEXTFIELD,\n        value: VALUEFIELD\n      },\n      htmlAttributes: {\n        role: 'option'\n      },\n      change: args => {\n        self.freshOnEndForm();\n        self.updateEndOnForm(args.value);\n        self.resetFormValues();\n        self.triggerChangeEvent();\n      }\n    });\n    this.endType.appendTo(this.element.querySelector('.' + ENDONELEMENT));\n\n    const renderDropDownList = dropDownData => {\n      return new DropDownList({\n        dataSource: dropDownData,\n        popupWidth: this.getPopupWidth(),\n        enableRtl: this.enableRtl,\n        fields: {\n          text: TEXTFIELD,\n          value: VALUEFIELD\n        },\n        htmlAttributes: {\n          role: 'option'\n        },\n        index: 1,\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        change: args => {\n          self.onWeekDay.setProperties({\n            checked: true\n          });\n          self.resetFormValues();\n          self.triggerChangeEvent();\n        }\n      });\n    };\n\n    this.monthWeekPos = renderDropDownList(this.getMonthPosData());\n    this.monthWeekPos.appendTo(this.element.querySelector('.' + MONTHPOS));\n    this.monthWeekDays = renderDropDownList(this.getDayData('wide'));\n    this.monthWeekDays.appendTo(this.element.querySelector('.' + MONTHWEEK));\n    this.monthValue = new DropDownList({\n      dataSource: this.getMonthData(),\n      fields: {\n        text: TEXTFIELD,\n        value: VALUEFIELD\n      },\n      htmlAttributes: {\n        role: 'option'\n      },\n      enableRtl: this.enableRtl,\n      index: 7,\n      // eslint-disable-next-line @typescript-eslint/no-unused-vars\n      change: args => {\n        self.resetFormValues();\n        self.triggerChangeEvent();\n      }\n    });\n    this.monthValue.appendTo(this.element.querySelector('.' + YEAREXPANDERELEMENT));\n  }\n\n  setDefaultValue() {\n    const formelement = [].slice.call(this.element.querySelectorAll('.e-control .e-numerictextbox'));\n\n    for (const element of formelement) {\n      const instance = element.ej2_instances[0];\n\n      if (instance.element.classList.contains(REPEATINTERVAL)) {\n        instance.value = 1;\n        instance.dataBind();\n      } else if (instance.element.classList.contains(ENDONCOUNT)) {\n        instance.value = 10;\n        instance.dataBind();\n      }\n    }\n  }\n\n  resetFormValues() {\n    const recurreneElement = [].slice.call(this.element.querySelectorAll('.e-control [type=\"text\"]'));\n\n    for (const element of recurreneElement) {\n      let instance;\n\n      if (element.classList.contains('e-datepicker')) {\n        instance = element.ej2_instances[0];\n\n        if (instance.value) {\n          // eslint-disable-next-line no-self-assign\n          instance.value = instance.value;\n          instance.dataBind();\n        } else {\n          this.updateUntilDate(this.startDate);\n        }\n      } else if (element.classList.contains('e-dropdownlist')) {\n        instance = element.ej2_instances[0];\n        instance.index = instance.index || 0;\n        instance.dataBind();\n      } else if (element.classList.contains('e-numerictextbox')) {\n        instance = element.ej2_instances[0];\n        let value;\n\n        if (instance.element.classList.contains(REPEATINTERVAL)) {\n          value = 1;\n        } else if (instance.element.classList.contains(ENDONCOUNT)) {\n          value = 10;\n        } else {\n          value = this.startDate.getDate();\n        }\n\n        instance.value = instance.value || value;\n        instance.dataBind();\n      }\n    }\n  }\n\n  getPopupWidth() {\n    return Browser.isDevice ? '100%' : 'auto';\n  }\n\n  renderDatePickers() {\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    const self = this;\n    this.untilDateObj = new DatePicker({\n      firstDayOfWeek: this.firstDayOfWeek,\n      enableRtl: this.enableRtl,\n      locale: this.locale,\n      min: this.minDate,\n      max: this.maxDate,\n      format: isNullOrUndefined(this.dateFormat) ? this.getFormat('dateFormats') : this.dateFormat,\n      change: args => {\n        if (args.value) {\n          self.triggerChangeEvent();\n        }\n      }\n    });\n    this.untilDateObj.appendTo(this.element.querySelector('.' + UNTILDATE));\n  }\n\n  getFormat(formatType) {\n    let format;\n\n    if (this.locale === 'en' || this.locale === 'en-US') {\n      format = getValue(formatType + '.short', getDefaultDateObject(this.getCalendarMode()));\n    } else {\n      format = getValue('main.' + '' + this.locale + '.dates.calendars.' + this.getCalendarMode() + '.' + formatType + '.short', cldrData);\n    }\n\n    return format;\n  }\n\n  dayButtonRender() {\n    const btns = [].slice.call(this.element.querySelectorAll('.' + DAYWRAPPER + ' button')); // eslint-disable-next-line @typescript-eslint/no-this-alias\n\n    const self = this;\n\n    for (const btn of btns) {\n      const button = new Button({\n        isToggle: true,\n        enableRtl: this.enableRtl\n      }, btn);\n      this.dayButtons.push(button);\n      EventHandler.add(btn, 'click', args => {\n        const btns = [].slice.call(this.element.querySelectorAll('.' + DAYWRAPPER + ' button.' + PRIMARY));\n        const element = args.target;\n\n        if (!element.classList.contains(PRIMARY)) {\n          addClass([element], PRIMARY);\n          self.triggerChangeEvent();\n        } else if (btns.length > 1) {\n          removeClass([element], PRIMARY);\n          self.triggerChangeEvent();\n        }\n      });\n    }\n  }\n\n  radioButtonRender() {\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    const self = this;\n    this.onMonthDay = new RadioButton({\n      label: this.localeObj.getConstant(RADIOLABEL),\n      enableRtl: this.enableRtl,\n      name: 'monthType',\n      value: 'day',\n      change: () => {\n        self.resetFormValues();\n        self.triggerChangeEvent();\n      }\n    });\n    this.onMonthDay.appendTo(this.element.querySelector('.' + MONTHEXPANDERELEMENT));\n    this.monthButtons.push(this.onMonthDay);\n    this.onWeekDay = new RadioButton({\n      label: this.localeObj.getConstant('monthExpander'),\n      cssClass: 'e-month-type',\n      name: 'monthType',\n      enableRtl: this.enableRtl,\n      value: 'daypos',\n      change: () => {\n        self.resetFormValues();\n        self.triggerChangeEvent();\n      }\n    });\n    this.onWeekDay.appendTo(this.element.querySelector('.' + MONTHEXPANNDERELEM));\n    this.monthButtons.push(this.onWeekDay);\n  }\n\n  numericTextboxRender() {\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    const self = this;\n    this.recurrenceCount = new NumericTextBox({\n      value: 10,\n      format: '#',\n      enableRtl: this.enableRtl,\n      min: 1,\n      max: 999,\n      change: () => {\n        self.triggerChangeEvent();\n      }\n    });\n    this.recurrenceCount.appendTo(this.element.querySelector('.' + ENDONCOUNT));\n    this.monthDate = new NumericTextBox({\n      value: 1,\n      format: '#',\n      enableRtl: this.enableRtl,\n      min: 1,\n      max: 31,\n      change: () => {\n        self.onMonthDay.setProperties({\n          checked: true\n        });\n        self.triggerChangeEvent();\n      }\n    });\n    this.monthDate.appendTo(this.element.querySelector('.' + MONTHDAYWRAPPER));\n    this.repeatInterval = new NumericTextBox({\n      value: 1,\n      format: '#',\n      min: 1,\n      max: 999,\n      enableRtl: this.enableRtl,\n      floatLabelType: 'Always',\n      placeholder: this.localeObj.getConstant(REPEATEVERY),\n      change: () => {\n        self.triggerChangeEvent();\n      }\n    });\n    this.repeatInterval.appendTo(this.element.querySelector('.' + REPEATINTERVAL));\n  }\n\n  renderComponent() {\n    this.setTemplate();\n    this.renderDropdowns();\n    this.renderDatePickers();\n    this.dayButtonRender();\n    this.radioButtonRender();\n    this.numericTextboxRender();\n  }\n\n  rotateArray(data, count) {\n    let temp;\n\n    for (let index = 0; index < count; index++) {\n      temp = data.shift();\n      data.push(temp);\n    }\n  }\n\n  getEndData() {\n    const endData = [NEVER, UNTIL$1, COUNT]; // eslint-disable-next-line @typescript-eslint/no-this-alias\n\n    const self = this;\n    const dataSource = [];\n    endData.forEach(data => {\n      dataSource.push({\n        text: self.localeObj.getConstant(data),\n        value: data\n      });\n    });\n    return dataSource;\n  }\n\n  getDayPosition(date) {\n    let temp = new Date(date.getTime());\n    let endDate = new Date(date.getTime());\n    const day = date.getDay();\n    const positionCollection = [];\n    temp = this.calendarUtil.getMonthStartDate(temp);\n    endDate = this.calendarUtil.getMonthEndDate(endDate);\n\n    while (temp < endDate) {\n      if (temp.getDay() === day) {\n        positionCollection.push(temp.getTime());\n      }\n\n      temp.setDate(temp.getDate() + 1);\n    }\n\n    if (positionCollection.indexOf(date.getTime()) === positionCollection.length - 1) {\n      return -1;\n    }\n\n    return positionCollection.indexOf(date.getTime()) + 1;\n  }\n\n  getRepeatData() {\n    const data = []; // eslint-disable-next-line @typescript-eslint/no-this-alias\n\n    const self = this;\n    this.frequencies.forEach(element => {\n      const textValue = element === NONE ? NEVER : element;\n      data.push({\n        text: self.localeObj.getConstant(textValue),\n        value: element\n      });\n    });\n    return data;\n  }\n\n  getMonthPosData() {\n    const monthpos = [FIRST, SECOND, THIRD, FOURTH, LAST];\n    const monthposValue = {\n      first: 1,\n      second: 2,\n      third: 3,\n      fourth: 4,\n      last: -1\n    }; // eslint-disable-next-line @typescript-eslint/no-this-alias\n\n    const self = this;\n    const dataSource = [];\n    monthpos.forEach(data => {\n      dataSource.push({\n        text: self.localeObj.getConstant(data),\n        value: monthposValue[data]\n      });\n    });\n    return dataSource;\n  }\n\n  getDayData(format) {\n    const weekday = [KEYSUNDAY, KEYMONDAY, KEYTUESDAY, KEYWEDNESDAY, KEYTHURSDAY, KEYFRIDAY, KEYSATURDAY];\n    const dayData = [];\n    let cldrObj;\n    this.rotateArray(weekday, this.firstDayOfWeek);\n\n    if (this.locale === 'en' || this.locale === 'en-US') {\n      const nameSpaceString = 'days.stand-alone.';\n      cldrObj = getValue(nameSpaceString + format, getDefaultDateObject(this.getCalendarMode()));\n    } else {\n      const nameSpaceString = 'main.' + '' + this.locale + '.dates.calendars.' + this.getCalendarMode() + '.days.stand-alone.' + format;\n      cldrObj = getValue(nameSpaceString, cldrData);\n    }\n\n    for (const obj of weekday) {\n      const day = getValue(obj, cldrObj);\n      dayData.push({\n        text: format === 'narrow' ? day : capitalizeFirstWord(day, 'single'),\n        value: valueData[obj]\n      });\n    }\n\n    return dayData;\n  }\n\n  getMonthData() {\n    const monthData = [];\n    let cldrObj;\n\n    if (this.locale === 'en' || this.locale === 'en-US') {\n      const nameSpaceString = 'months.stand-alone.wide';\n      cldrObj = getValue(nameSpaceString, getDefaultDateObject(this.getCalendarMode()));\n    } else {\n      const nameSpaceString = 'main.' + '' + this.locale + '.dates.calendars.' + this.getCalendarMode() + '.months.stand-alone.wide';\n      cldrObj = getValue(nameSpaceString, cldrData);\n    }\n\n    for (const obj of Object.keys(cldrObj)) {\n      monthData.push({\n        text: capitalizeFirstWord(getValue(obj, cldrObj), 'single'),\n        value: obj\n      });\n    }\n\n    return monthData;\n  }\n\n  setTemplate() {\n    const dayData = this.getDayData('narrow');\n    const fullDay = this.getDayData('wide');\n    this.element.innerHTML = '<div class=\"' + HEADER + '\">' + '<div class=\"' + INPUTWARAPPER + ' ' + FORMLEFT + '\">' + '<input type=\"text\" tabindex=\"0\" class=\"' + REPEATELEMENT + '\"label=\"' + REPEATELEMENT.substr(2) + '\" />' + '</div><div class=\"' + INPUTWARAPPER + ' ' + INTERVALCLASS + ' ' + FORMRIGHT + '\"><table  class=\"' + RECURRENCETABLE + ' ' + REPEATCONTENTWRAPPER + '\"><tr>' + '<td><input type=\"text\" tabindex=\"0\" class=\"' + REPEATINTERVAL + '\"title=\"' + this.localeObj.getConstant('repeatEvery') + '\" /></td>' + '<td><span class=\"' + REPEATCONTENT + '\"></span></td>' + '</tr></table></div><div class=\"' + INPUTWARAPPERSIDE + ' ' + DAYWRAPPER + ' ' + FORMLEFT + '\">' + '<div class=' + WEEKEXPANDERLABEL + '>' + this.localeObj.getConstant(ON$1) + '</div>' + '<button type=\"button\" class=\"e-round\" data-index=\"0\" title=\"' + fullDay[0].text + '\">' + dayData[0].text + '</button>' + '<button type=\"button\" class=\"e-round\" data-index=\"1\" title=\"' + fullDay[1].text + '\">' + dayData[1].text + '</button>' + '<button type=\"button\" class=\"e-round\" data-index=\"2\" title=\"' + fullDay[2].text + '\">' + dayData[2].text + '</button>' + '<button type=\"button\" class=\"e-round\" data-index=\"3\" title=\"' + fullDay[3].text + '\">' + dayData[3].text + '</button>' + '<button type=\"button\" class=\"e-round\" data-index=\"4\" title=\"' + fullDay[4].text + '\">' + dayData[4].text + '</button>' + '<button type=\"button\" class=\"e-round\" data-index=\"5\" title=\"' + fullDay[5].text + '\">' + dayData[5].text + '</button>' + '<button type=\"button\" class=\"e-round\" data-index=\"6\" title=\"' + fullDay[6].text + '\">' + dayData[6].text + '</button></div>' + '<div class=\"' + INPUTWARAPPERSIDE + ' ' + WEEKWRAPPER + ' ' + FORMLEFT + '\">' + '<div class=' + MONTHEXPANDERLABEL + '>' + this.localeObj.getConstant(ON$1) + '</div>' + '<div class=\"' + YEAREXPANDERWRAPPER + '\">' + '<input class=\"' + YEAREXPANDERELEMENT + '\" type=\"text\" tabindex=\"0\" title=\"' + this.localeObj.getConstant('yearExpander') + '\"/>' + '</div>' + '<div class=\"' + MONETHEXPANDERWRAPPER + '\">' + '<table class=\"' + RECURRENCETABLE + ' ' + MONETHEXPANDWRAPPER + '\"><tr><td>' + '<div class=\"' + INPUTWARAPPER + ' ' + MONTHEXPANDERCHECKBOXWRAPPER + '\">' + '<input class=\"' + MONTHEXPANDERELEMENT + '\"title=\"' + this.localeObj.getConstant('monthExpander') + '\" type=\"radio\">' + '</div></td>' + '<td colspan=\"2\"><div class=\"' + INPUTWARAPPER + ' ' + MONTHDAYELEMENT + '\">' + '<input type=\"text\" tabindex=\"0\" class=\"' + MONTHDAYWRAPPER + '\"title=\"' + this.localeObj.getConstant('on') + '\" />' + '</div></td></tr>' + '<tr><td>' + '<div class=\"' + INPUTWARAPPER + ' ' + MONTHEXPANDERCHECKBOXWRAPPER + '\" style=\"min-width: 30px;margin-bottom:18px;\">' + '<input class=\"' + MONTHEXPANNDERELEM + '\"title=\"' + this.localeObj.getConstant('monthExpander') + '\" type=\"radio\">' + '</div></td>' + '<td><div class=\"' + INPUTWARAPPER + ' ' + WEEKPOSITION + '\" >' + '<input type=\"text\" tabindex=\"0\" class=\"' + MONTHPOS + '\"title=\"' + this.localeObj.getConstant('monthPosition') + '\" />' + '</div></td>' + '<td><div class=\"' + INPUTWARAPPER + ' ' + DAYPOSITION + '\">' + '<input type=\"text\" tabindex=\"0\" class=\"' + MONTHWEEK + '\"title=\"' + this.localeObj.getConstant('monthWeek') + '\" />' + '</div></td></tr></table>' + '</div></div>' + '<div class=\"' + INPUTWARAPPERSIDE + ' ' + ENDON + ' ' + FORMRIGHT + '\">' + '<div class=' + ENDONLABEL + '>' + this.localeObj.getConstant(END) + '</div>' + '<div class=\"' + INPUTWARAPPER + ' ' + ENDONLEFT + '\">' + '<input type=\"text\" tabindex=\"0\" class=\"' + ENDONELEMENT + '\"title=\"' + this.localeObj.getConstant(END) + '\" />' + '</div>' + '<div class=\"' + INPUTWARAPPER + ' ' + ENDONDATE + '\" >' + '<input type=\"text\" tabindex=\"0\" class=\"' + UNTILDATE + '\"title=\"' + this.localeObj.getConstant(UNTIL$1) + '\" />' + '</div>' + '<div class=\"' + INPUTWARAPPER + ' ' + ENDONCOUNTWRAPPER + '\">' + '<input type=\"text\" tabindex=\"0\" class=\"' + ENDONCOUNT + '\"title=\"' + this.localeObj.getConstant(COUNT) + '\" />' + '</div></div>' + '</div></div>';\n  }\n\n  getSelectedDaysData() {\n    let ruleData = RULEBYDAY + EQUAL;\n    const elements = [].slice.call(this.element.querySelectorAll('.' + DAYWRAPPER + ' button.' + PRIMARY));\n    const weekday = [RULESUNDAY, RULEMONDAY, RULETUESDAY, RULEWEDNESDAY, RULETHURSDAY, RULEFRIDAY, RULESATURDAY];\n    this.rotateArray(weekday, this.firstDayOfWeek);\n\n    for (let index = 0; index < elements.length; index++) {\n      ruleData += weekday[parseInt(elements[index].getAttribute('data-index'), 10)] + (index === elements.length - 1 ? '' : COMMA);\n    }\n\n    return ruleData + SEMICOLON;\n  }\n\n  getSelectedMonthData() {\n    let ruleData;\n\n    if (this.onWeekDay.checked) {\n      ruleData = RULEBYDAY + EQUAL + this.monthWeekDays.value + SEMICOLON + RULESETPOS + EQUAL + this.monthWeekPos.value + SEMICOLON;\n    } else {\n      ruleData = RULEBYMONTHDAY + EQUAL + this.monthDate.value + SEMICOLON;\n    }\n\n    return ruleData;\n  }\n\n  getIntervalData() {\n    return RULEINTERVAL + EQUAL + this.repeatInterval.value + SEMICOLON;\n  }\n\n  getEndOnCount() {\n    return RULECOUNT + EQUAL + this.recurrenceCount.value + SEMICOLON;\n  }\n\n  getYearMonthRuleData() {\n    return RULEBYMONTH + EQUAL + this.monthValue.value + SEMICOLON;\n  }\n\n  updateWeekButton(keys) {\n    const weekday = [RULESUNDAY, RULEMONDAY, RULETUESDAY, RULEWEDNESDAY, RULETHURSDAY, RULEFRIDAY, RULESATURDAY];\n    this.rotateArray(weekday, this.firstDayOfWeek);\n\n    for (const obj of this.dayButtons) {\n      const index = parseInt(obj.element.getAttribute('data-index'), 10);\n\n      if (keys.indexOf(weekday[index]) !== -1) {\n        obj.setProperties({\n          isPrimary: true\n        });\n      } else {\n        obj.setProperties({\n          isPrimary: false\n        });\n      }\n    }\n  }\n\n  updateMonthUI() {\n    if (this.ruleObject.monthDay.length) {\n      this.monthDate.setProperties({\n        value: this.ruleObject.monthDay[0]\n      });\n      this.onMonthDay.setProperties({\n        checked: true\n      });\n    } else {\n      this.onWeekDay.setProperties({\n        checked: true\n      });\n      this.monthWeekPos.setProperties({\n        value: this.ruleObject.setPosition\n      });\n\n      for (const key of Object.keys(valueData)) {\n        if (valueData[key] === this.ruleObject.day[0]) {\n          this.monthWeekDays.setProperties({\n            value: this.ruleObject.day[0]\n          });\n          break;\n        }\n      }\n    }\n  }\n\n  updateUI(repeat, state) {\n    this.repeatInterval.setProperties({\n      value: this.ruleObject.interval\n    });\n\n    switch (state) {\n      case UNTIL$1:\n        this.untilDateObj.setProperties({\n          value: this.ruleObject.until\n        });\n        break;\n\n      case COUNT:\n        this.recurrenceCount.setProperties({\n          value: this.ruleObject.count\n        });\n        break;\n    }\n\n    switch (repeat) {\n      case WEEKLY:\n        this.updateWeekButton(this.ruleObject.day);\n        break;\n\n      case YEARLY:\n        this.monthValue.setProperties({\n          index: this.ruleObject.month[0] - 1\n        });\n        this.updateMonthUI();\n        break;\n\n      case MONTHLY:\n        this.updateMonthUI();\n        break;\n    }\n  }\n\n  getUntilData() {\n    if (!this.untilDateObj.value) {\n      return '';\n    }\n\n    const tempStr = getRecurrenceStringFromDate(this.untilDateObj.value);\n    return RULEUNTIL + EQUAL + tempStr + SEMICOLON;\n  }\n\n  destroyComponents() {\n    if (!this.recurrenceCount.isDestroyed) {\n      this.recurrenceCount.destroy();\n    }\n\n    if (!this.monthDate.isDestroyed) {\n      this.monthDate.destroy();\n    }\n\n    if (!this.repeatInterval.isDestroyed) {\n      this.repeatInterval.destroy();\n    }\n\n    if (!this.untilDateObj.isDestroyed) {\n      this.untilDateObj.destroy();\n    }\n\n    if (!this.repeatType.isDestroyed) {\n      this.repeatType.destroy();\n    }\n\n    if (!this.endType.isDestroyed) {\n      this.endType.destroy();\n    }\n\n    if (!this.monthWeekPos.isDestroyed) {\n      this.monthWeekPos.destroy();\n    }\n\n    if (!this.monthWeekDays.isDestroyed) {\n      this.monthWeekDays.destroy();\n    }\n\n    if (!this.monthValue.isDestroyed) {\n      this.monthValue.destroy();\n    }\n\n    this.dayButtons.forEach(element => {\n      if (!element.isDestroyed) {\n        element.destroy();\n      }\n    });\n    this.dayButtons = [];\n    this.monthButtons.forEach(element => {\n      if (!element.isDestroyed) {\n        element.destroy();\n      }\n    });\n    this.monthButtons = [];\n  }\n\n  resetFields() {\n    this.startState(NONE, NEVER, this.startDate);\n    this.setDefaultValue();\n  }\n\n  updateRuleUntilDate(startDate) {\n    if (this.untilDateObj.value && startDate) {\n      const untilDate = this.untilDateObj.value;\n      const newUntilDate = new Date(untilDate.getFullYear(), untilDate.getMonth(), untilDate.getDate(), startDate.getHours(), startDate.getMinutes(), startDate.getMilliseconds());\n      this.untilDateObj.setProperties({\n        value: newUntilDate\n      });\n    }\n  }\n\n  getCalendarMode() {\n    return this.calendarMode.toLowerCase();\n  }\n\n  getRuleSummary(rule = this.getRecurrenceRule()) {\n    return generateSummary(rule, this.localeObj, this.locale, this.calendarMode);\n  }\n\n  getRecurrenceDates(startDate, rule, excludeDate, maximumCount, viewDate) {\n    viewDate = isNullOrUndefined(viewDate) ? this.startDate : viewDate;\n    return generate(startDate, rule, excludeDate, this.firstDayOfWeek, maximumCount, viewDate, this.calendarMode);\n  }\n\n  getRecurrenceRule() {\n    let ruleData = RULEFREQ + EQUAL;\n\n    switch (this.repeatType.value) {\n      case DAILY:\n        ruleData += RULEDAILY + SEMICOLON;\n        break;\n\n      case WEEKLY:\n        ruleData += RULEWEEKLY + SEMICOLON + this.getSelectedDaysData();\n        break;\n\n      case MONTHLY:\n        ruleData += RULEMONTHLY + SEMICOLON + this.getSelectedMonthData();\n        break;\n\n      case YEARLY:\n        ruleData += RULEYEARLY + SEMICOLON + this.getSelectedMonthData() + this.getYearMonthRuleData();\n        break;\n\n      case NONE:\n        return '';\n    }\n\n    ruleData += this.getIntervalData();\n\n    switch (this.endType.value) {\n      case UNTIL$1:\n        ruleData += this.getUntilData();\n        break;\n\n      case COUNT:\n        ruleData += this.getEndOnCount();\n        break;\n    }\n\n    return ruleData;\n  }\n\n  setRecurrenceRule(rule, startDate = this.startDate) {\n    if (!rule) {\n      this.repeatType.setProperties({\n        value: NONE\n      });\n      return;\n    }\n\n    this.renderStatus = false;\n    this.ruleObject = extractObjectFromRule(rule);\n    const endon = this.ruleObject.count ? COUNT : this.ruleObject.until ? UNTIL$1 : NEVER;\n\n    switch (this.ruleObject.freq) {\n      case RULEDAILY:\n        this.startState(DAILY, endon, startDate);\n        this.updateUI(DAILY, endon);\n        break;\n\n      case RULEWEEKLY:\n        this.startState(WEEKLY, endon, startDate);\n        this.updateUI(WEEKLY, endon);\n        break;\n\n      case RULEMONTHLY:\n        this.startState(MONTHLY, endon, startDate);\n        this.updateUI(MONTHLY, endon);\n        break;\n\n      case RULEYEARLY:\n        this.startState(YEARLY, endon, startDate);\n        this.updateUI(YEARLY, endon);\n        break;\n    }\n\n    this.renderStatus = true;\n    this.triggerChangeEvent();\n  }\n  /**\n   * Destroys the widget.\n   *\n   * @returns {void}\n   */\n\n\n  destroy() {\n    this.destroyComponents();\n    super.destroy();\n    let removeClasses = ['e-' + this.getModuleName()];\n\n    if (this.cssClass) {\n      removeClasses = removeClasses.concat(this.cssClass.split(' '));\n    }\n\n    removeClass([this.element], removeClasses);\n\n    while (this.element.firstElementChild) {\n      this.element.removeChild(this.element.firstElementChild);\n    }\n  }\n  /**\n   * Get component name.\n   *\n   * @returns {string} Returns the module name\n   * @private\n   */\n\n\n  getModuleName() {\n    return 'recurrenceeditor';\n  }\n  /**\n   * Get the properties to be maintained in the persisted state.\n   *\n   * @returns {string} Returns the persisted state\n   */\n\n\n  getPersistData() {\n    return this.addOnPersist([]);\n  }\n  /**\n   * Initialize the control rendering\n   *\n   * @returns {void}\n   * @private\n   */\n\n\n  render() {\n    this.initialize();\n    this.rtlClass(this.enableRtl);\n    this.renderStatus = true;\n    this.renderComplete();\n  }\n  /**\n   * Called internally, if any of the property value changed.\n   *\n   * @param {RecurrenceEditorModel} newProp Accepts the changed properties new values\n   * @param {RecurrenceEditorModel} oldProp Accepts the changed properties old values\n   * @returns {void}\n   * @private\n   */\n\n\n  onPropertyChanged(newProp, oldProp) {\n    for (const prop of Object.keys(newProp)) {\n      switch (prop) {\n        case 'startDate':\n          this.selectMonthDay(newProp.startDate);\n          this.updateUntilDate(newProp.startDate);\n          this.endType.setProperties({\n            index: 0\n          });\n          break;\n\n        case 'enableRtl':\n          this.rtlClass(newProp.enableRtl);\n          break;\n\n        case 'cssClass':\n          if (oldProp.cssClass) {\n            removeClass([this.element], oldProp.cssClass.split(' '));\n          }\n\n          if (newProp.cssClass) {\n            addClass([this.element], newProp.cssClass.split(' '));\n          }\n\n          break;\n\n        case 'selectedType':\n          this.repeatType.setProperties({\n            index: this.selectedType\n          });\n          break;\n\n        case 'minDate':\n          this.untilDateObj.setProperties({\n            minDate: this.minDate\n          });\n          break;\n\n        case 'maxDate':\n          this.untilDateObj.setProperties({\n            maxDate: this.maxDate\n          });\n          break;\n\n        case 'value':\n          if (this.getRecurrenceRule() !== this.value) {\n            this.setRecurrenceRule(this.value);\n          }\n\n          break;\n\n        case 'calendarMode':\n          this.calendarMode = newProp.calendarMode;\n          this.calendarUtil = getCalendarUtil(newProp.calendarMode);\n          break;\n\n        case 'locale':\n        case 'frequencies':\n        case 'firstDayOfWeek':\n          this.refresh();\n          break;\n\n        case 'dateFormat':\n          this.untilDateObj.setProperties({\n            format: newProp.dateFormat\n          });\n          break;\n      }\n    }\n  }\n\n};\n\n__decorate$1([Property(['none', 'daily', 'weekly', 'monthly', 'yearly'])], RecurrenceEditor.prototype, \"frequencies\", void 0);\n\n__decorate$1([Property(0)], RecurrenceEditor.prototype, \"firstDayOfWeek\", void 0);\n\n__decorate$1([Property(new Date())], RecurrenceEditor.prototype, \"startDate\", void 0);\n\n__decorate$1([Property()], RecurrenceEditor.prototype, \"dateFormat\", void 0);\n\n__decorate$1([Property('Gregorian')], RecurrenceEditor.prototype, \"calendarMode\", void 0);\n\n__decorate$1([Property()], RecurrenceEditor.prototype, \"cssClass\", void 0);\n\n__decorate$1([Property()], RecurrenceEditor.prototype, \"value\", void 0);\n\n__decorate$1([Property(new Date(1900, 0, 1))], RecurrenceEditor.prototype, \"minDate\", void 0);\n\n__decorate$1([Property(new Date(2099, 11, 31))], RecurrenceEditor.prototype, \"maxDate\", void 0);\n\n__decorate$1([Property(0)], RecurrenceEditor.prototype, \"selectedType\", void 0);\n\n__decorate$1([Event()], RecurrenceEditor.prototype, \"change\", void 0);\n\nRecurrenceEditor = __decorate$1([NotifyPropertyChanges], RecurrenceEditor);\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\nconst EVENT_FIELD$1 = 'e-field';\nconst REPEAT_CONTAINER_CLASS = 'e-recurrence-container';\nconst REPEAT_BUTTON_ICON_CLASS = 'e-recurrence-edit';\nconst REPEAT_BUTTON_CLASS = 'e-recurrence-edit-button';\nconst REPEAT_DIALOG_CLASS = 'e-recurrence-dialog';\nconst HIDE_STYLE_CLASS = 'e-hide';\n/**\n * Event editor window\n */\n\nclass EventWindow {\n  constructor(parent) {\n    this.parent = parent;\n    this.l10n = this.parent.localeObj;\n    this.fields = this.parent.eventFields;\n    this.eventWindowTime = {\n      startTime: new Date(),\n      endTime: new Date()\n    };\n    this.renderEventWindow();\n  }\n\n  renderEventWindow() {\n    this.element = createElement('div', {\n      id: this.parent.element.id + '_dialog_wrapper'\n    });\n    this.parent.element.appendChild(this.element);\n    const dialogModel = {\n      animationSettings: {\n        effect: 'Zoom'\n      },\n      content: this.getEventWindowContent(),\n      cssClass: EVENT_WINDOW_DIALOG_CLASS,\n      enableRtl: this.parent.enableRtl,\n      height: this.parent.isAdaptive ? '100%' : 'auto',\n      minHeight: '300px',\n      isModal: true,\n      showCloseIcon: this.parent.isAdaptive ? false : true,\n      target: document.body,\n      visible: false,\n      width: '500px',\n      beforeOpen: this.onBeforeOpen.bind(this),\n      beforeClose: this.onBeforeClose.bind(this)\n    };\n\n    if (this.parent.isAdaptive) {\n      dialogModel.cssClass = EVENT_WINDOW_DIALOG_CLASS + ' ' + DEVICE_CLASS;\n      dialogModel.header = '<div class=\"e-title-header\"><div class=\"e-back-icon e-icons\"></div><div class=\"e-title-text\">' + this.l10n.getConstant('newEvent') + '</div><div class=\"e-save-icon e-icons\"></div></div>';\n    } else {\n      dialogModel.buttons = [{\n        buttonModel: {\n          content: this.l10n.getConstant('deleteButton'),\n          cssClass: DELETE_EVENT_CLASS,\n          disabled: !this.parent.eventSettings.allowDeleting || this.parent.readonly\n        },\n        click: this.eventDelete.bind(this)\n      }, {\n        buttonModel: {\n          content: this.l10n.getConstant('saveButton'),\n          cssClass: 'e-primary ' + EVENT_WINDOW_SAVE_BUTTON_CLASS,\n          isPrimary: true,\n          disabled: !this.parent.eventSettings.allowAdding || this.parent.readonly\n        },\n        click: this.eventSave.bind(this)\n      }, {\n        buttonModel: {\n          cssClass: EVENT_WINDOW_CANCEL_BUTTON_CLASS,\n          content: this.l10n.getConstant('cancelButton')\n        },\n        click: this.dialogClose.bind(this)\n      }];\n      dialogModel.header = '<div class=\"e-title-text\">' + this.l10n.getConstant('newEvent') + '</div>';\n    }\n\n    this.dialogObject = new Dialog(dialogModel, this.element);\n\n    if (this.dialogObject.element.querySelector('.e-dlg-closeicon-btn')) {\n      this.dialogObject.element.querySelector('.e-dlg-closeicon-btn').setAttribute('title', this.l10n.getConstant('close'));\n    }\n\n    addClass([this.element.parentElement], EVENT_WINDOW_DIALOG_CLASS + '-container');\n\n    if (this.parent.isAdaptive) {\n      EventHandler.add(this.element.querySelector('.' + EVENT_WINDOW_BACK_ICON_CLASS), 'click', this.dialogClose, this);\n      EventHandler.add(this.element.querySelector('.' + EVENT_WINDOW_SAVE_ICON_CLASS), 'click', this.eventSave, this);\n    }\n\n    EventHandler.add(this.dialogObject.element, 'keydown', this.preventEventSave, this);\n    this.applyFormValidation();\n  }\n\n  refresh() {\n    this.destroy(true);\n    this.renderEventWindow();\n  }\n\n  refreshRecurrenceEditor() {\n    if (this.recurrenceEditor) {\n      const recurrenceEditor = this.recurrenceEditor.element;\n      this.recurrenceEditor.destroy();\n      this.createRecurrenceEditor(recurrenceEditor);\n    }\n  }\n\n  setRecurrenceEditor(recurrenceEditor) {\n    if (this.parent.editorTemplate) {\n      this.recurrenceEditor = recurrenceEditor;\n    }\n  }\n\n  openEditor(data, type, isEventData, repeatType) {\n    this.parent.currentAction = type;\n    this.parent.removeNewEventElement();\n\n    if (this.parent.quickPopup) {\n      this.parent.quickPopup.quickPopupHide(true);\n    }\n\n    this.parent.inlineModule.removeInlineAppointmentElement();\n\n    if (type === 'Add') {\n      let eventObj = {};\n      this.cellClickAction = !isEventData;\n      this.parent.activeCellsData = data;\n      const event = data;\n\n      if (this.cellClickAction) {\n        this.convertToEventData(event, eventObj);\n      } else {\n        this.parent.activeCellsData = {\n          startTime: event.startTime || event[this.fields.startTime],\n          endTime: event.endTime || event[this.fields.endTime],\n          isAllDay: event.isAllDay || event[this.fields.isAllDay],\n          element: event.element,\n          groupIndex: event.groupIndex\n        };\n        eventObj = event;\n      }\n\n      data = eventObj;\n    }\n\n    if (!isNullOrUndefined(this.parent.editorTemplate)) {\n      this.renderFormElements(this.element.querySelector('.e-schedule-form'), data);\n    }\n\n    if (!this.parent.isAdaptive && isNullOrUndefined(this.parent.editorTemplate)) {\n      removeClass([this.dialogObject.element.querySelector('.e-recurrenceeditor')], DISABLE_CLASS);\n    }\n\n    if (this.recurrenceEditor) {\n      this.recurrenceEditor.firstDayOfWeek = this.parent.activeViewOptions.firstDayOfWeek;\n    }\n\n    switch (type) {\n      case 'Add':\n        this.onCellDetailsUpdate(data, repeatType);\n        break;\n\n      case 'Save':\n      case 'EditOccurrence':\n      case 'EditSeries':\n      case 'EditFollowingEvents':\n        if (type === 'EditOccurrence' && !this.parent.isAdaptive && isNullOrUndefined(this.parent.editorTemplate)) {\n          addClass([this.dialogObject.element.querySelector('.e-recurrenceeditor')], DISABLE_CLASS);\n        }\n\n        this.cellClickAction = false;\n        this.onEventDetailsUpdate(data);\n        break;\n    }\n  }\n\n  setDialogContent() {\n    this.dialogObject.content = this.getEventWindowContent();\n    this.dialogObject.dataBind();\n    this.applyFormValidation();\n  }\n\n  preventEventSave(e) {\n    if (this.parent && !this.parent.allowKeyboardInteraction && e.code === 'Enter') {\n      this.isEnterKey = true;\n    }\n  }\n\n  onBeforeOpen(args) {\n    const eventProp = {\n      type: 'Editor',\n      data: this.eventData,\n      cancel: false,\n      element: this.element,\n      target: this.cellClickAction ? this.parent.activeCellsData.element : this.parent.activeEventData.element\n    };\n\n    if (this.cellClickAction) {\n      eventProp.duration = this.getSlotDuration();\n    }\n\n    const saveObj = this.getInstance(EVENT_WINDOW_SAVE_BUTTON_CLASS);\n\n    if (saveObj) {\n      saveObj.disabled = !(this.cellClickAction ? this.parent.eventSettings.allowAdding : this.parent.eventSettings.allowEditing);\n      saveObj.dataBind();\n    }\n\n    const deleteObj = this.getInstance(DELETE_EVENT_CLASS);\n\n    if (deleteObj) {\n      deleteObj.disabled = !this.parent.eventSettings.allowDeleting;\n      deleteObj.dataBind();\n    }\n\n    const callBackPromise = new Deferred();\n    this.parent.trigger(popupOpen, eventProp, popupArgs => {\n      args.cancel = popupArgs.cancel;\n      this.duration = this.cellClickAction ? popupArgs.duration : null;\n      this.refreshDateTimePicker(this.duration);\n\n      if (this.cellClickAction && popupArgs.duration !== this.getSlotDuration() && isNullOrUndefined(this.parent.editorTemplate)) {\n        const startObj = this.getInstance(EVENT_WINDOW_START_CLASS);\n        const endObj = this.getInstance(EVENT_WINDOW_END_CLASS);\n        endObj.value = new Date(startObj.value.getTime() + MS_PER_MINUTE * popupArgs.duration);\n        endObj.dataBind();\n      }\n\n      if (this.parent.editorTemplate && this.element.querySelector('.e-recurrenceeditor') && !this.recurrenceEditor) {\n        this.recurrenceEditor = this.getInstance('e-recurrenceeditor');\n      }\n\n      callBackPromise.resolve(args);\n    });\n    return callBackPromise;\n  }\n\n  onBeforeClose(args) {\n    if (args.isInteracted) {\n      this.isCrudAction = false;\n    }\n\n    const eventProp = {\n      type: 'Editor',\n      event: args.event || this.dialogEvent,\n      data: this.eventCrudData,\n      cancel: false,\n      element: this.element,\n      target: this.cellClickAction ? this.parent.activeCellsData.element : this.parent.activeEventData.element\n    };\n    const callBackPromise = new Deferred();\n    this.parent.trigger(popupClose, eventProp, popupArgs => {\n      args.cancel = popupArgs.cancel;\n\n      if (!popupArgs.cancel) {\n        if (this.isCrudAction) {\n          args.cancel = this.processCrudActions(popupArgs.data);\n          this.isCrudAction = args.cancel;\n        }\n\n        if (!this.isCrudAction) {\n          this.resetForm();\n          this.parent.eventBase.focusElement(true);\n          this.eventCrudData = null;\n        }\n      }\n\n      callBackPromise.resolve(args);\n    });\n    return callBackPromise;\n  }\n\n  getEventWindowContent() {\n    const container = createElement('div', {\n      className: FORM_CONTAINER_CLASS\n    });\n    const form = createElement('form', {\n      id: this.parent.element.id + 'EditForm',\n      className: FORM_CLASS,\n      attrs: {\n        onsubmit: 'return false;'\n      }\n    });\n    this.renderFormElements(form);\n    container.appendChild(form);\n    return container;\n  }\n\n  renderFormElements(form, args) {\n    if (!isNullOrUndefined(this.parent.editorTemplate)) {\n      if (args) {\n        if (this.recurrenceEditor) {\n          this.recurrenceEditor.destroy();\n          this.recurrenceEditor = null;\n        }\n\n        this.destroyComponents();\n        const formElements = [].slice.call(form.children);\n\n        for (const element of formElements) {\n          remove(element);\n        }\n      }\n\n      const templateId = this.parent.element.id + '_editorTemplate';\n      const tempEle = [].slice.call(this.parent.getEditorTemplate()(args || {}, this.parent, 'editorTemplate', templateId, false));\n      append(tempEle, form);\n      this.parent.renderTemplates();\n    } else {\n      form.appendChild(this.getDefaultEventWindowContent());\n    }\n  }\n\n  getDefaultEventWindowContent() {\n    const parentDiv = this.createDivElement(EVENT_WINDOW_DIALOG_PARENT_CLASS);\n    const titleLocationDiv = this.createDivElement(EVENT_WINDOW_TITLE_LOCATION_DIV_CLASS);\n    parentDiv.appendChild(titleLocationDiv);\n    titleLocationDiv.appendChild(this.renderTextBox(SUBJECT_CLASS));\n    titleLocationDiv.querySelector('.' + SUBJECT_CLASS).setAttribute('title', this.parent.editorTitles.subject);\n    titleLocationDiv.appendChild(this.renderTextBox(LOCATION_CLASS));\n    titleLocationDiv.querySelector('.' + LOCATION_CLASS).setAttribute('title', this.parent.editorTitles.location);\n    const startEndDateTimeDiv = this.createDivElement(EVENT_WINDOW_START_END_DIV_CLASS);\n    parentDiv.appendChild(startEndDateTimeDiv);\n    startEndDateTimeDiv.appendChild(this.renderDateTimePicker(EVENT_WINDOW_START_CLASS, this.onTimeChange.bind(this)));\n    startEndDateTimeDiv.querySelector('.' + EVENT_WINDOW_START_CLASS).setAttribute('title', this.parent.editorTitles.startTime);\n    startEndDateTimeDiv.appendChild(this.renderDateTimePicker(EVENT_WINDOW_END_CLASS));\n    startEndDateTimeDiv.querySelector('.' + EVENT_WINDOW_END_CLASS).setAttribute('title', this.parent.editorTitles.endTime);\n    const allDayTimezoneDiv = this.createDivElement(EVENT_WINDOW_ALLDAY_TZ_DIV_CLASS);\n    parentDiv.appendChild(allDayTimezoneDiv);\n    allDayTimezoneDiv.appendChild(this.renderCheckBox(EVENT_WINDOW_ALL_DAY_CLASS));\n    allDayTimezoneDiv.appendChild(this.renderCheckBox(TIME_ZONE_CLASS));\n    const timezoneParentDiv = this.createDivElement(EVENT_WINDOW_TIME_ZONE_DIV_CLASS);\n    parentDiv.appendChild(timezoneParentDiv);\n    timezoneParentDiv.appendChild(this.renderDropDown(EVENT_WINDOW_START_TZ_CLASS));\n    timezoneParentDiv.appendChild(this.renderDropDown(EVENT_WINDOW_END_TZ_CLASS));\n    const repeatParentDiv = this.createDivElement(EVENT_WINDOW_REPEAT_DIV_CLASS);\n    parentDiv.appendChild(repeatParentDiv);\n    const repeatDiv = this.renderCheckBox(EVENT_WINDOW_REPEAT_CLASS);\n    const repeatEditContainer = createElement('span', {\n      className: REPEAT_CONTAINER_CLASS\n    });\n    const button = createElement('button', {\n      className: REPEAT_BUTTON_CLASS,\n      attrs: {\n        type: 'button',\n        'title': this.l10n.getConstant('editRecurrence')\n      }\n    });\n    this.buttonObj = new Button({\n      iconCss: REPEAT_BUTTON_ICON_CLASS + ' e-icons',\n      cssClass: 'e-medium ' + this.parent.cssClass\n    });\n    repeatEditContainer.appendChild(button);\n    this.buttonObj.appendTo(button);\n    repeatDiv.appendChild(repeatEditContainer);\n    repeatParentDiv.appendChild(repeatDiv);\n\n    if (this.parent.isAdaptive) {\n      EventHandler.add(button, 'click', this.loadRecurrenceEditor, this);\n    } else {\n      this.createRecurrenceEditor(parentDiv);\n    }\n\n    if (this.parent.resourceCollection.length > 0) {\n      const resourceParentDiv = this.createDivElement(EVENT_WINDOW_RESOURCES_DIV_CLASS);\n\n      for (const resource of this.parent.resourceBase.resourceCollection) {\n        resourceParentDiv.appendChild(this.renderResourceDetails(resource));\n      }\n\n      parentDiv.appendChild(resourceParentDiv);\n    }\n\n    const description = this.createDivElement(DESCRIPTION_CLASS + '-row');\n    description.appendChild(this.renderTextBox(DESCRIPTION_CLASS));\n    description.querySelector('.' + DESCRIPTION_CLASS).setAttribute('title', this.parent.editorTitles.description);\n    parentDiv.appendChild(description);\n    const submit = createElement('button', {\n      attrs: {\n        type: 'hidden',\n        title: 'submit',\n        style: 'display:none'\n      }\n    });\n    parentDiv.appendChild(submit);\n    return parentDiv;\n  }\n\n  createRecurrenceEditor(parentDiv) {\n    const recurrenceEditor = this.createDivElement();\n    parentDiv.appendChild(recurrenceEditor);\n    this.recurrenceEditor = this.renderRecurrenceEditor();\n    this.recurrenceEditor.appendTo(recurrenceEditor);\n    this.updateMinMaxDateToEditor();\n  }\n\n  createDivElement(className) {\n    return createElement('div', {\n      className: className\n    });\n  }\n\n  createInputElement(className, fieldName, type) {\n    return createElement(type || 'input', {\n      className: className,\n      attrs: {\n        type: 'text',\n        name: fieldName,\n        value: '',\n        id: fieldName,\n        title: this.l10n.getConstant(fieldName.charAt(0).toLowerCase() + fieldName.slice(1)) === '' ? fieldName : this.l10n.getConstant(fieldName.charAt(0).toLowerCase() + fieldName.slice(1))\n      }\n    });\n  }\n\n  getSlotDuration() {\n    return this.parent.activeViewOptions.timeScale.interval / this.parent.activeViewOptions.timeScale.slotCount;\n  }\n\n  renderDateTimePicker(value, changeEvent) {\n    const dateTimeDiv = this.createDivElement(value + '-container');\n    const fieldName = this.getFieldName(value);\n    const dateTimeInput = this.createInputElement(value + ' ' + EVENT_FIELD$1, fieldName);\n    dateTimeDiv.appendChild(dateTimeInput);\n    const dateTimePicker = new DateTimePicker({\n      change: changeEvent,\n      firstDayOfWeek: this.parent.activeViewOptions.firstDayOfWeek,\n      calendarMode: this.parent.calendarMode,\n      min: this.parent.minDate,\n      max: new Date(new Date(+this.parent.maxDate).setHours(23, 59, 59)),\n      cssClass: this.parent.cssClass,\n      enableRtl: this.parent.enableRtl,\n      locale: this.parent.locale,\n      floatLabelType: 'Always',\n      timeFormat: this.parent.activeViewOptions.timeFormat,\n      format: (isNullOrUndefined(this.parent.dateFormat) ? this.getFormat('dateFormats') : this.parent.dateFormat) + ' ' + this.parent.activeViewOptions.timeFormat,\n      placeholder: this.getFieldLabel(value),\n      step: this.getSlotDuration(),\n      width: '100%'\n    });\n    dateTimePicker.appendTo(dateTimeInput);\n    return dateTimeDiv;\n  }\n\n  refreshDateTimePicker(duration) {\n    const elementSelector = '.' + EVENT_WINDOW_START_CLASS + ',.' + EVENT_WINDOW_END_CLASS;\n    const startEndElement = [].slice.call(this.element.querySelectorAll(elementSelector));\n\n    for (const element of startEndElement) {\n      const instance = element.ej2_instances[0];\n      instance.firstDayOfWeek = this.parent.activeViewOptions.firstDayOfWeek;\n      instance.timeFormat = this.parent.activeViewOptions.timeFormat;\n      instance.step = duration || this.getSlotDuration();\n      instance.dataBind();\n    }\n  }\n\n  onTimeChange() {\n    const startObj = this.getInstance(EVENT_WINDOW_START_CLASS);\n\n    if (startObj.element.parentElement.classList.contains('e-input-focus')) {\n      const endObj = this.getInstance(EVENT_WINDOW_END_CLASS);\n      let duration = 0;\n\n      if (this.cellClickAction) {\n        duration = MS_PER_MINUTE * this.duration;\n        this.eventWindowTime.startTime = startObj.value;\n      } else {\n        duration = this.eventData[this.fields.endTime].getTime() - this.eventData[this.fields.startTime].getTime();\n      }\n\n      const endDate = isNullOrUndefined(startObj.value) ? null : new Date(startObj.value.getTime() + duration);\n\n      if (this.cellClickAction) {\n        this.eventWindowTime.endTime = endDate;\n      }\n\n      endObj.value = endDate;\n      endObj.dataBind();\n    }\n\n    if (this.recurrenceEditor) {\n      this.recurrenceEditor.updateRuleUntilDate(this.eventWindowTime.startTime);\n    }\n  }\n\n  renderResourceDetails(resourceData) {\n    const fieldName = resourceData.field;\n    const value = 'e-' + fieldName;\n    const labelValue = resourceData.title;\n    const resourceDiv = this.createDivElement(value + '-container' + ' ' + 'e-resources');\n    const resourceInput = this.createInputElement(value + ' ' + EVENT_FIELD$1, fieldName);\n    resourceDiv.appendChild(resourceInput);\n    const resourceTemplate = '<div class=\"e-resource-template\"><div class=\"e-resource-color\" style=\"background-color:${' + resourceData.colorField + '}\"></div><div class=\"e-resource-text\">${' + resourceData.textField + '}</div></div>';\n\n    if (resourceData.allowMultiple) {\n      const listObj = new MultiSelect({\n        enableRtl: this.parent.enableRtl,\n        cssClass: this.parent.cssClass || '',\n        dataSource: resourceData.dataSource,\n        change: this.onMultiselectResourceChange.bind(this),\n        itemTemplate: resourceTemplate,\n        fields: {\n          text: resourceData.textField,\n          value: resourceData.idField\n        },\n        htmlAttributes: {\n          'title': labelValue,\n          'name': fieldName\n        },\n        floatLabelType: 'Always',\n        placeholder: labelValue,\n        popupHeight: '230px',\n        popupWidth: '447px',\n        mode: 'Box'\n      });\n      listObj.appendTo(resourceInput);\n    } else {\n      const dropDownList = new DropDownList({\n        cssClass: this.parent.cssClass || '',\n        change: this.onDropdownResourceChange.bind(this),\n        dataSource: resourceData.dataSource,\n        enableRtl: this.parent.enableRtl,\n        fields: {\n          text: resourceData.textField,\n          value: resourceData.idField\n        },\n        htmlAttributes: {\n          'title': labelValue,\n          'name': fieldName\n        },\n        floatLabelType: 'Always',\n        placeholder: labelValue,\n        popupHeight: '230px',\n        popupWidth: '447px',\n        itemTemplate: resourceTemplate\n      });\n      dropDownList.appendTo(resourceInput);\n    }\n\n    return resourceDiv;\n  }\n\n  renderDropDown(value) {\n    const fieldName = this.getFieldName(value);\n    const timezoneDiv = this.createDivElement(value + '-container');\n    const timezoneInput = this.createInputElement(value + ' ' + EVENT_FIELD$1, fieldName);\n    timezoneDiv.appendChild(timezoneInput);\n    const dropDownList = new DropDownList({\n      allowFiltering: true,\n      change: this.onTimezoneChange.bind(this),\n      cssClass: this.parent.cssClass || '',\n      dataSource: this.parent.timezoneDataSource,\n      enableRtl: this.parent.enableRtl,\n      fields: {\n        text: 'Text',\n        value: 'Value'\n      },\n      filterBarPlaceholder: this.parent.localeObj.getConstant('searchTimezone'),\n      noRecordsTemplate: this.parent.localeObj.getConstant('noRecords'),\n      filtering: e => {\n        let query = new Query();\n        query = e.text !== '' ? query.where('Text', 'contains', e.text, true) : query;\n        e.updateData(this.parent.timezoneDataSource, query);\n      },\n      htmlAttributes: {\n        'title': this.getFieldLabel(value),\n        'name': fieldName,\n        role: 'option'\n      },\n      floatLabelType: 'Always',\n      placeholder: this.getFieldLabel(value),\n      popupHeight: '230px'\n    });\n    dropDownList.appendTo(timezoneInput);\n    return timezoneDiv;\n  }\n\n  onMultiselectResourceChange(args) {\n    if (!args.value || !this.parent.activeViewOptions.group.byGroupID || this.parent.resourceCollection.length <= 1) {\n      return;\n    }\n\n    const resourceCollection = this.parent.resourceBase.resourceCollection;\n    const fieldName = args.element.getAttribute('name') || this.getColumnName(args.element);\n\n    for (let i = 0; i < resourceCollection.length; i++) {\n      if (resourceCollection[i].field === fieldName && i < resourceCollection.length - 1) {\n        const resObject = this.createInstance(i);\n        let datasource = [];\n\n        for (let j = 0; j < args.value.length; j++) {\n          const resourceModel = resourceCollection[i + 1]; // eslint-disable-next-line max-len\n\n          const filter = resourceModel.dataSource.filter(data => data[resourceModel.groupIDField] === args.value[j])[0];\n          const groupId = filter[resourceCollection[i + 1].groupIDField];\n          const filterRes = this.filterDatasource(i, groupId);\n          datasource = datasource.concat(filterRes);\n        }\n\n        resObject.dataSource = datasource;\n        resObject.dataBind();\n      }\n    }\n  }\n\n  createInstance(index) {\n    const resourceData = this.parent.resourceBase.resourceCollection[index + 1];\n    const resObject = this.element.querySelector('.e-' + resourceData.field).ej2_instances[0];\n    return resObject;\n  }\n\n  onDropdownResourceChange(args) {\n    if (!args.value || this.parent.resourceCollection.length <= 1 || !this.parent.activeViewOptions.group.byGroupID) {\n      return;\n    }\n\n    const fieldName = args.element.getAttribute('name') || this.getColumnName(args.element);\n    const resourceCollection = this.parent.resourceBase.resourceCollection;\n\n    for (let i = 0; i < resourceCollection.length; i++) {\n      if (i < resourceCollection.length - 1 && resourceCollection[i].field === fieldName) {\n        const resObj = this.createInstance(i);\n        const groupId = args.itemData[resourceCollection[i].idField];\n        resObj.dataSource = this.filterDatasource(i, groupId);\n        resObj.dataBind();\n        const resValue = resObj.dataSource[0][resourceCollection[i + 1].idField];\n        resObj.value = resourceCollection[i + 1].allowMultiple ? [resValue] : resValue;\n        resObj.dataBind();\n      }\n    }\n  }\n\n  filterDatasource(index, groupId) {\n    const resourceData = this.parent.resourceBase.resourceCollection[index + 1];\n    return resourceData.dataSource.filter(data => data[resourceData.groupIDField] === groupId);\n  }\n\n  onTimezoneChange(args) {\n    const fieldName = args.element.getAttribute('name') || this.getColumnName(args.element);\n\n    if (fieldName === this.parent.eventFields.startTimezone) {\n      const startTimezoneObj = this.getInstance(EVENT_WINDOW_START_TZ_CLASS);\n      const endTimezoneObj = this.getInstance(EVENT_WINDOW_END_TZ_CLASS);\n      endTimezoneObj.value = startTimezoneObj.value;\n      endTimezoneObj.dataBind();\n    }\n  }\n\n  renderCheckBox(value) {\n    const checkBoxDiv = this.createDivElement(value + '-container');\n    const fieldName = this.getFieldName(value);\n    const checkBoxInput = this.createInputElement(value + ' ' + EVENT_FIELD$1, fieldName);\n    checkBoxDiv.appendChild(checkBoxInput);\n    const checkBox = new CheckBox({\n      change: this.onChange.bind(this),\n      cssClass: value + ' ' + this.parent.cssClass,\n      enableRtl: this.parent.enableRtl,\n      label: this.getFieldLabel(value)\n    });\n    checkBox.appendTo(checkBoxInput);\n    checkBoxInput.setAttribute('name', fieldName);\n\n    if (fieldName === 'Repeat') {\n      this.repeatStatus = checkBox;\n    }\n\n    return checkBoxDiv;\n  }\n\n  renderTextBox(value) {\n    const textBoxDiv = this.createDivElement(value + '-container');\n    const fieldName = this.getFieldName(value);\n    const elementType = value === DESCRIPTION_CLASS ? 'textarea' : 'input';\n    const textBoxInput = this.createInputElement(value + ' ' + EVENT_FIELD$1, fieldName, elementType);\n    textBoxDiv.appendChild(textBoxInput);\n    Input.createInput({\n      element: textBoxInput,\n      floatLabelType: 'Always',\n      properties: {\n        enableRtl: this.parent.enableRtl,\n        placeholder: this.getFieldLabel(value)\n      }\n    });\n    return textBoxDiv;\n  }\n\n  getFieldName(name) {\n    let fieldName = '';\n\n    switch (name) {\n      case SUBJECT_CLASS:\n        fieldName = this.fields.subject;\n        break;\n\n      case LOCATION_CLASS:\n        fieldName = this.fields.location;\n        break;\n\n      case EVENT_WINDOW_START_CLASS:\n        fieldName = this.fields.startTime;\n        break;\n\n      case EVENT_WINDOW_END_CLASS:\n        fieldName = this.fields.endTime;\n        break;\n\n      case DESCRIPTION_CLASS:\n        fieldName = this.fields.description;\n        break;\n\n      case EVENT_WINDOW_ALL_DAY_CLASS:\n        fieldName = this.fields.isAllDay;\n        break;\n\n      case EVENT_WINDOW_START_TZ_CLASS:\n        fieldName = this.fields.startTimezone;\n        break;\n\n      case EVENT_WINDOW_END_TZ_CLASS:\n        fieldName = this.fields.endTimezone;\n        break;\n\n      case TIME_ZONE_CLASS:\n        fieldName = 'Timezone';\n        break;\n\n      case EVENT_WINDOW_REPEAT_CLASS:\n        fieldName = 'Repeat';\n        break;\n    }\n\n    return fieldName;\n  }\n\n  getFieldLabel(fieldName) {\n    let labelText = '';\n\n    switch (fieldName) {\n      case SUBJECT_CLASS:\n        labelText = this.parent.editorTitles.subject;\n        break;\n\n      case LOCATION_CLASS:\n        labelText = this.parent.editorTitles.location;\n        break;\n\n      case DESCRIPTION_CLASS:\n        labelText = this.parent.editorTitles.description;\n        break;\n\n      case EVENT_WINDOW_START_CLASS:\n        labelText = this.parent.editorTitles.startTime;\n        break;\n\n      case EVENT_WINDOW_END_CLASS:\n        labelText = this.parent.editorTitles.endTime;\n        break;\n\n      case EVENT_WINDOW_START_TZ_CLASS:\n        labelText = this.parent.editorTitles.startTimezone;\n        break;\n\n      case EVENT_WINDOW_END_TZ_CLASS:\n        labelText = this.parent.editorTitles.endTimezone;\n        break;\n\n      case EVENT_WINDOW_REPEAT_CLASS:\n        labelText = this.parent.editorTitles.recurrenceRule;\n        break;\n\n      case EVENT_WINDOW_ALL_DAY_CLASS:\n        labelText = this.parent.editorTitles.isAllDay;\n        break;\n\n      case TIME_ZONE_CLASS:\n        labelText = this.l10n.getConstant('timezone');\n        break;\n    }\n\n    return labelText;\n  }\n\n  onChange(args) {\n    const targetSelector = `.${EVENT_WINDOW_ALL_DAY_CLASS},.${TIME_ZONE_CLASS},.${EVENT_WINDOW_REPEAT_CLASS}`;\n    const target = closest(args.event.target, targetSelector);\n\n    if (target.classList.contains(EVENT_WINDOW_ALL_DAY_CLASS)) {\n      this.onAllDayChange(args.checked);\n    } else if (target.classList.contains(TIME_ZONE_CLASS)) {\n      this.timezoneChangeStyle(args.checked);\n    } else if (target.classList.contains(EVENT_WINDOW_REPEAT_CLASS)) {\n      this.onRepeatChange(args.checked);\n    }\n  }\n\n  renderRepeatDialog() {\n    const element = createElement('div');\n    this.repeatDialogObject = new Dialog({\n      header: this.l10n.getConstant('recurrence'),\n      visible: false,\n      content: '<div class=\"e-rec-editor\"></div>',\n      closeOnEscape: true,\n      width: '90%',\n      buttons: [{\n        click: this.repeatSaveDialog.bind(this),\n        buttonModel: {\n          content: this.l10n.getConstant('save'),\n          cssClass: 'e-save',\n          isPrimary: true\n        }\n      }, {\n        click: this.repeatCancelDialog.bind(this),\n        buttonModel: {\n          cssClass: 'e-cancel',\n          content: this.l10n.getConstant('cancel')\n        }\n      }],\n      target: this.element,\n      animationSettings: {\n        effect: 'Zoom'\n      },\n      enableRtl: this.parent.enableRtl,\n      isModal: true,\n      cssClass: REPEAT_DIALOG_CLASS,\n      open: this.repeatOpenDialog.bind(this)\n    });\n    this.element.appendChild(element);\n    this.repeatDialogObject.appendTo(element);\n    this.createRecurrenceEditor(this.repeatDialogObject.element.querySelector('.e-rec-editor'));\n  }\n\n  loadRecurrenceEditor() {\n    this.repeatDialogObject.show();\n\n    if (this.recurrenceEditor && this.repeatRule) {\n      this.recurrenceEditor.setRecurrenceRule(this.repeatRule);\n    }\n  }\n\n  onRepeatChange(state) {\n    if (state) {\n      if (!this.repeatDialogObject) {\n        this.renderRepeatDialog();\n      }\n\n      this.recurrenceEditor.setProperties({\n        startDate: this.repeatStartDate,\n        selectedType: 0\n      });\n      this.loadRecurrenceEditor();\n    } else {\n      if (this.repeatDialogObject) {\n        this.repeatDialogObject.hide();\n      }\n\n      this.repeatRule = '';\n\n      if (this.recurrenceEditor) {\n        this.recurrenceEditor.setRecurrenceRule(this.repeatRule);\n        this.updateRepeatLabel(this.repeatRule);\n      }\n\n      const element = this.element.querySelector('.' + REPEAT_CONTAINER_CLASS);\n      addClass([element], HIDE_STYLE_CLASS);\n    }\n  }\n\n  repeatSaveDialog() {\n    this.repeatRule = this.recurrenceEditor.getRecurrenceRule();\n    const element = this.element.querySelector('.' + REPEAT_CONTAINER_CLASS);\n\n    if (this.recurrenceEditor.getRecurrenceRule()) {\n      removeClass([element], HIDE_STYLE_CLASS);\n    } else {\n      addClass([element], HIDE_STYLE_CLASS);\n      this.repeatStatus.setProperties({\n        checked: false\n      });\n    }\n\n    this.updateRepeatLabel(this.repeatRule);\n    this.closeRepeatDialog();\n  }\n\n  closeRepeatDialog() {\n    this.repeatDialogObject.hide();\n  }\n\n  repeatCancelDialog() {\n    this.closeRepeatDialog();\n\n    if (this.recurrenceEditor) {\n      this.recurrenceEditor.setRecurrenceRule(this.repeatTempRule);\n    }\n\n    if (!this.repeatTempRule) {\n      this.repeatStatus.setProperties({\n        checked: false\n      });\n    }\n  }\n\n  repeatOpenDialog() {\n    this.repeatTempRule = this.recurrenceEditor.getRecurrenceRule();\n  }\n\n  onCellDetailsUpdate(eventObj, repeatType) {\n    if (!this.parent.eventSettings.allowAdding) {\n      return;\n    }\n\n    this.element.querySelector('.' + FORM_CLASS).removeAttribute('data-id');\n    this.element.querySelector('.' + EVENT_WINDOW_TITLE_TEXT_CLASS).innerHTML = this.l10n.getConstant('newEvent');\n    eventObj.Timezone = false;\n    this.repeatStartDate = eventObj[this.fields.startTime];\n    this.repeatRule = '';\n\n    if (!isNullOrUndefined(this.parent.eventSettings.fields.subject.default)) {\n      eventObj[this.fields.subject] = this.parent.eventSettings.fields.subject.default;\n    }\n\n    if (!isNullOrUndefined(this.parent.eventSettings.fields.location.default)) {\n      eventObj[this.fields.location] = this.parent.eventSettings.fields.location.default;\n    }\n\n    if (!isNullOrUndefined(this.parent.eventSettings.fields.description.default)) {\n      eventObj[this.fields.description] = this.parent.eventSettings.fields.description.default;\n    }\n\n    this.showDetails(eventObj);\n\n    if (eventObj[this.fields.recurrenceRule] && this.recurrenceEditor) {\n      this.recurrenceEditor.setRecurrenceRule(eventObj[this.fields.recurrenceRule], eventObj[this.fields.startTime]);\n      this.repeatRule = eventObj[this.fields.recurrenceRule];\n    }\n\n    const deleteButton = this.element.querySelector('.' + DELETE_EVENT_CLASS);\n\n    if (deleteButton) {\n      addClass([deleteButton], DISABLE_CLASS);\n    }\n\n    if (this.recurrenceEditor) {\n      this.recurrenceEditor.setProperties({\n        startDate: eventObj[this.fields.startTime],\n        selectedType: !isNullOrUndefined(repeatType) ? repeatType : !isNullOrUndefined(eventObj[this.fields.recurrenceRule]) ? this.recurrenceEditor.selectedType : 0\n      });\n    }\n\n    if (this.parent.isAdaptive && isNullOrUndefined(this.parent.editorTemplate)) {\n      const element = this.element.querySelector('.' + REPEAT_CONTAINER_CLASS);\n      addClass([element], HIDE_STYLE_CLASS);\n      this.updateRepeatLabel(this.repeatRule);\n    } else {\n      const saveButton = this.element.querySelector('.' + EVENT_WINDOW_SAVE_BUTTON_CLASS);\n      this.disableButton(saveButton, false);\n    }\n\n    this.dialogObject.show();\n  }\n\n  convertToEventData(cellsData, eventObj) {\n    if (cellsData.subject) {\n      eventObj[this.fields.subject] = cellsData.subject;\n    }\n\n    eventObj[this.fields.startTime] = cellsData.startTime;\n    eventObj[this.fields.endTime] = cellsData.endTime;\n    eventObj[this.fields.isAllDay] = cellsData.isAllDay;\n\n    if (cellsData.RecurrenceRule) {\n      eventObj[this.fields.recurrenceRule] = cellsData.RecurrenceRule;\n    }\n\n    if (this.parent.resourceCollection.length > 0 || this.parent.activeViewOptions.group.resources.length > 0) {\n      this.parent.resourceBase.setResourceValues(eventObj);\n    }\n  }\n\n  applyFormValidation() {\n    const getValidationRule = rules => rules && Object.keys(rules).length > 0 ? rules : undefined;\n\n    const form = this.element.querySelector('.' + FORM_CLASS);\n    const rules = {};\n    rules[this.parent.eventSettings.fields.subject.name] = getValidationRule(this.parent.eventSettings.fields.subject.validation);\n    rules[this.parent.eventSettings.fields.location.name] = getValidationRule(this.parent.eventSettings.fields.location.validation);\n    rules[this.parent.eventSettings.fields.startTime.name] = getValidationRule(this.parent.eventSettings.fields.startTime.validation);\n    rules[this.parent.eventSettings.fields.endTime.name] = getValidationRule(this.parent.eventSettings.fields.endTime.validation);\n    rules[this.parent.eventSettings.fields.description.name] = getValidationRule(this.parent.eventSettings.fields.description.validation);\n    this.fieldValidator = new FieldValidator();\n    this.fieldValidator.renderFormValidator(form, rules, this.element, this.parent.locale);\n  }\n\n  showDetails(eventData) {\n    const eventObj = extend({}, eventData, null, true);\n\n    if ((!this.cellClickAction || this.cellClickAction && !isNullOrUndefined(this.parent.editorTemplate)) && eventObj[this.fields.endTime].getHours() === 0 && eventObj[this.fields.endTime].getMinutes() === 0) {\n      this.trimAllDay(eventObj);\n    }\n\n    this.eventData = eventObj;\n    const formElements = this.getFormElements(EVENT_WINDOW_DIALOG_CLASS);\n    const keyNames = Object.keys(eventObj);\n\n    for (const curElement of formElements) {\n      const columnName = curElement.name || this.getColumnName(curElement);\n\n      if (!isNullOrUndefined(columnName) && columnName !== '') {\n        if (keyNames.indexOf(columnName) !== -1) {\n          this.setValueToElement(curElement, eventObj[columnName]);\n        } else {\n          this.setDefaultValueToElement(curElement);\n        }\n      }\n    }\n\n    if (isNullOrUndefined(this.parent.editorTemplate)) {\n      this.onAllDayChange(eventObj[this.fields.isAllDay]);\n      const timezoneObj = this.getInstance(TIME_ZONE_CLASS + '.' + EVENT_FIELD$1);\n\n      if (!(isNullOrUndefined(eventObj[this.fields.startTimezone]) && isNullOrUndefined(eventObj[this.fields.endTimezone]))) {\n        timezoneObj.checked = true;\n        timezoneObj.dataBind();\n      }\n\n      this.timezoneChangeStyle(timezoneObj.checked);\n      delete eventObj.Timezone;\n    }\n  }\n\n  getColumnName(element) {\n    let attrName = element.getAttribute('data-name') || '';\n\n    if (attrName === '') {\n      let isDropDowns = false;\n      let fieldSelector = '';\n\n      if (element.classList.contains('e-dropdownlist')) {\n        fieldSelector = 'e-ddl';\n        isDropDowns = true;\n      } else if (element.classList.contains('e-multiselect')) {\n        fieldSelector = 'e-multiselect';\n        isDropDowns = true;\n      } else if (element.classList.contains('e-datetimepicker')) {\n        fieldSelector = 'e-datetimepicker';\n      } else if (element.classList.contains('e-datepicker')) {\n        fieldSelector = 'e-datepicker';\n      } else if (element.classList.contains('e-checkbox')) {\n        fieldSelector = 'e-checkbox';\n      }\n\n      const classSelector = isDropDowns ? `.${fieldSelector}:not(.e-control)` : `.${fieldSelector}`;\n      const control = closest(element, classSelector) || element.querySelector(`.${fieldSelector}`);\n\n      if (control) {\n        const attrEle = control.querySelector('[name]');\n\n        if (attrEle) {\n          attrName = attrEle.name;\n        }\n      }\n    }\n\n    return attrName;\n  }\n\n  onAllDayChange(allDayStatus) {\n    const startObj = this.getInstance(EVENT_WINDOW_START_CLASS);\n    const endObj = this.getInstance(EVENT_WINDOW_END_CLASS);\n    const timezoneDiv = this.element.querySelector('.e-time-zone-container');\n    let format;\n\n    if (allDayStatus) {\n      format = isNullOrUndefined(this.parent.dateFormat) ? this.getFormat('dateFormats') : this.parent.dateFormat;\n      addClass(this.element.querySelectorAll('.e-time-icon'), EVENT_WINDOW_ICON_DISABLE_CLASS);\n      addClass([timezoneDiv], DISABLE_CLASS);\n\n      if (this.element.querySelector('.' + EVENT_WINDOW_TIME_ZONE_DIV_CLASS)) {\n        removeClass([this.element.querySelector('.' + EVENT_WINDOW_TIME_ZONE_DIV_CLASS)], ENABLE_CLASS);\n      }\n\n      startObj.format = endObj.format = format;\n    } else {\n      format = isNullOrUndefined(this.parent.dateFormat) ? this.getFormat('dateFormats') + ' ' + this.parent.activeViewOptions.timeFormat : this.parent.dateFormat + ' ' + this.parent.activeViewOptions.timeFormat;\n      removeClass(this.element.querySelectorAll('.e-time-icon'), EVENT_WINDOW_ICON_DISABLE_CLASS);\n      removeClass([timezoneDiv], DISABLE_CLASS);\n\n      if (this.element.querySelector('.e-checkbox-wrapper .e-time-zone').checked) {\n        addClass([this.element.querySelector('.' + EVENT_WINDOW_TIME_ZONE_DIV_CLASS)], ENABLE_CLASS);\n      }\n\n      startObj.format = endObj.format = format;\n    }\n\n    if (this.cellClickAction) {\n      this.updateDateTime(allDayStatus, startObj, endObj);\n    }\n\n    startObj.dataBind();\n    endObj.dataBind();\n\n    if (!isNullOrUndefined(this.recurrenceEditor)) {\n      this.recurrenceEditor.updateRuleUntilDate(startObj.value);\n    }\n  }\n\n  updateDateTime(allDayStatus, startObj, endObj) {\n    let startDate;\n    let endDate;\n\n    if (allDayStatus) {\n      startDate = resetTime(new Date(this.eventWindowTime.startTime.getTime()));\n\n      if (this.parent.activeCellsData.isAllDay) {\n        const temp = addDays(new Date(this.eventWindowTime.endTime.getTime()), -1).getTime();\n        endDate = +this.eventWindowTime.startTime > temp ? this.eventWindowTime.endTime : new Date(temp);\n      } else {\n        endDate = resetTime(new Date(this.eventWindowTime.endTime.getTime()));\n      }\n    } else {\n      const start = this.parent.activeCellsData.startTime;\n      startDate = new Date(this.eventWindowTime.startTime.getTime());\n      startDate.setHours(start.getHours(), start.getMinutes(), start.getSeconds());\n\n      if (this.parent.activeCellsData.isAllDay) {\n        const startHour = this.parent.getStartEndTime(this.parent.workHours.start);\n        startDate.setHours(startHour.getHours(), startHour.getMinutes(), startHour.getSeconds());\n        endDate = new Date(startDate.getTime());\n        endDate.setMilliseconds(MS_PER_MINUTE * this.getSlotDuration());\n      } else {\n        endDate = new Date(startDate.getTime());\n        endDate.setMilliseconds(this.parent.activeCellsData.endTime.getTime() - this.parent.activeCellsData.startTime.getTime());\n      }\n    }\n\n    this.eventWindowTime = {\n      startTime: new Date(startDate.getTime()),\n      endTime: new Date(endDate.getTime())\n    };\n    startObj.value = startDate;\n    endObj.value = endDate;\n    startObj.dataBind();\n    endObj.dataBind();\n  }\n\n  getFormat(formatType) {\n    let format;\n\n    if (this.parent.locale === 'en' || this.parent.locale === 'en-US') {\n      format = getValue(formatType + '.short', getDefaultDateObject(this.parent.getCalendarMode()));\n    } else {\n      format = getValue(`main.${this.parent.locale}.dates.calendars.${this.parent.getCalendarMode()}.${formatType}.short`, cldrData);\n    }\n\n    return format;\n  }\n\n  onEventDetailsUpdate(eventObj) {\n    if (!this.parent.eventSettings.allowEditing) {\n      return;\n    }\n\n    if (!this.parent.isAdaptive) {\n      removeClass([this.element.querySelector('.' + DELETE_EVENT_CLASS)], DISABLE_CLASS);\n    }\n\n    this.element.querySelector('.' + EVENT_WINDOW_TITLE_TEXT_CLASS).innerHTML = this.l10n.getConstant('editEvent');\n    this.element.querySelector('.' + FORM_CLASS).setAttribute('data-id', eventObj[this.fields.id].toString());\n\n    if (isNullOrUndefined(this.parent.editorTemplate)) {\n      eventObj = extend({}, eventObj, null, true);\n      const timezoneObj = this.getInstance(TIME_ZONE_CLASS + '.' + EVENT_FIELD$1);\n      let timezoneValue;\n\n      if (eventObj[this.fields.startTimezone] || eventObj[this.fields.endTimezone]) {\n        timezoneValue = true;\n        this.parent.eventBase.timezoneConvert(eventObj);\n      } else {\n        timezoneValue = false;\n      }\n\n      eventObj.Timezone = timezoneValue;\n      timezoneObj.checked = timezoneValue;\n      timezoneObj.dataBind();\n    }\n\n    this.showDetails(eventObj);\n\n    if (eventObj[this.fields.recurrenceRule] && this.recurrenceEditor) {\n      this.recurrenceEditor.setRecurrenceRule(eventObj[this.fields.recurrenceRule], eventObj[this.fields.startTime]);\n    } else if (!this.parent.isAdaptive && this.recurrenceEditor) {\n      this.recurrenceEditor.setProperties({\n        startDate: eventObj[this.fields.startTime]\n      });\n      this.recurrenceEditor.setRecurrenceRule('');\n    }\n\n    this.repeatStartDate = eventObj[this.fields.startTime];\n    this.repeatRule = '';\n\n    if (eventObj[this.fields.recurrenceRule]) {\n      if (this.recurrenceEditor) {\n        this.recurrenceEditor.setRecurrenceRule(eventObj[this.fields.recurrenceRule], eventObj[this.fields.startTime]);\n      }\n\n      this.repeatRule = eventObj[this.fields.recurrenceRule];\n    }\n\n    if (this.parent.isAdaptive && isNullOrUndefined(this.parent.editorTemplate)) {\n      const element = this.element.querySelector('.' + REPEAT_CONTAINER_CLASS);\n\n      if (eventObj[this.fields.recurrenceRule]) {\n        removeClass([element], HIDE_STYLE_CLASS);\n        this.repeatStatus.setProperties({\n          checked: true\n        });\n      } else {\n        addClass([element], HIDE_STYLE_CLASS);\n        this.repeatStatus.setProperties({\n          checked: false\n        });\n      }\n\n      this.updateRepeatLabel(this.repeatRule);\n    }\n\n    const isDisable = this.parent.readonly || eventObj[this.fields.isReadonly];\n\n    if (!this.parent.isAdaptive) {\n      const saveButton = this.element.querySelector('.' + EVENT_WINDOW_SAVE_BUTTON_CLASS);\n      const deleteButton = this.element.querySelector('.' + DELETE_EVENT_CLASS);\n      this.disableButton(saveButton, isDisable);\n      this.disableButton(deleteButton, isDisable);\n    } else {\n      const saveIcon = this.element.querySelector('.' + EVENT_WINDOW_SAVE_ICON_CLASS);\n\n      if (saveIcon) {\n        if (isDisable) {\n          addClass([saveIcon], ICON_DISABLE_CLASS);\n        } else {\n          removeClass([saveIcon], ICON_DISABLE_CLASS);\n        }\n      }\n    }\n\n    this.dialogObject.show();\n  }\n\n  disableButton(element, value) {\n    if (element) {\n      element.ej2_instances[0].disabled = value;\n    }\n  }\n\n  renderRecurrenceEditor() {\n    return new RecurrenceEditor({\n      calendarMode: this.parent.calendarMode,\n      cssClass: this.parent.cssClass,\n      dateFormat: this.parent.dateFormat,\n      enableRtl: this.parent.enableRtl,\n      firstDayOfWeek: this.parent.activeViewOptions.firstDayOfWeek,\n      locale: this.parent.locale\n    });\n  }\n\n  updateMinMaxDateToEditor() {\n    const startDate = this.element.querySelector('.e-start');\n    const endDate = this.element.querySelector('.e-end');\n\n    if (startDate && endDate) {\n      const startObj = startDate.ej2_instances[0];\n      const endObj = endDate.ej2_instances[0];\n      startObj.min = this.parent.minDate;\n      startObj.max = this.parent.maxDate;\n      endObj.min = this.parent.minDate;\n      endObj.max = this.parent.maxDate;\n      startObj.dataBind();\n      endObj.dataBind();\n    }\n\n    if (this.recurrenceEditor) {\n      const untilDate = this.recurrenceEditor.element.querySelector('.e-until-date');\n\n      if (untilDate) {\n        const untilObj = untilDate.ej2_instances[0];\n        untilObj.min = this.parent.minDate;\n        untilObj.max = this.parent.maxDate;\n        untilObj.dataBind();\n      }\n    }\n  }\n\n  updateRepeatLabel(repeatRule) {\n    if (this.parent.isAdaptive && !this.repeatDialogObject) {\n      this.renderRepeatDialog();\n    }\n\n    const data = repeatRule ? this.l10n.getConstant('repeats') + ' ' + this.recurrenceEditor.getRuleSummary(repeatRule) : this.l10n.getConstant('repeat');\n    this.repeatStatus.setProperties({\n      label: data\n    });\n  }\n\n  dialogClose(event) {\n    if (this.isEnterKey) {\n      this.isEnterKey = false;\n      return;\n    }\n\n    this.dialogEvent = event;\n    this.isCrudAction = false;\n    this.parent.activeEventData = {\n      event: undefined,\n      element: undefined\n    };\n    this.parent.currentAction = null;\n    this.dialogObject.hide();\n  }\n\n  resetForm() {\n    this.fieldValidator.destroyToolTip();\n    this.resetFormFields();\n\n    if (!this.parent.isAdaptive && this.recurrenceEditor && !this.recurrenceEditor.isDestroyed) {\n      this.recurrenceEditor.resetFields();\n    }\n  }\n\n  timezoneChangeStyle(value) {\n    const timezoneDiv = this.element.querySelector('.' + EVENT_WINDOW_TIME_ZONE_DIV_CLASS);\n    const localTimezoneName = this.parent.tzModule.getLocalTimezoneName();\n\n    if (value) {\n      addClass([timezoneDiv], ENABLE_CLASS);\n      const startTimezoneObj = this.getInstance(EVENT_WINDOW_START_TZ_CLASS);\n      const endTimezoneObj = this.getInstance(EVENT_WINDOW_END_TZ_CLASS);\n      const timezone = startTimezoneObj.dataSource;\n\n      if (!startTimezoneObj.value || !this.parent.timezone) {\n        const found = timezone.some(tz => {\n          return tz.Value === localTimezoneName;\n        });\n\n        if (!found) {\n          timezone.push({\n            Value: localTimezoneName,\n            Text: localTimezoneName\n          });\n          startTimezoneObj.dataSource = timezone;\n          endTimezoneObj.dataSource = timezone;\n          startTimezoneObj.dataBind();\n          endTimezoneObj.dataBind();\n        }\n      }\n\n      startTimezoneObj.value = startTimezoneObj.value || this.parent.timezone || localTimezoneName;\n      endTimezoneObj.value = endTimezoneObj.value || this.parent.timezone || localTimezoneName;\n      startTimezoneObj.dataBind();\n      endTimezoneObj.dataBind();\n    } else {\n      removeClass([timezoneDiv], ENABLE_CLASS);\n    }\n  }\n\n  resetFormFields() {\n    const formElement = this.getFormElements(EVENT_WINDOW_DIALOG_CLASS);\n\n    for (const currentElement of formElement) {\n      const columnName = currentElement.name || this.getColumnName(currentElement);\n\n      if (!isNullOrUndefined(columnName) && columnName !== '') {\n        this.setDefaultValueToElement(currentElement);\n      }\n    }\n  }\n\n  eventSave(event, alert) {\n    if (this.isEnterKey) {\n      this.isEnterKey = false;\n      return;\n    }\n\n    const formElement = this.element.querySelector('.' + FORM_CLASS);\n\n    if (formElement && formElement.classList.contains('e-formvalidator') && !formElement.ej2_instances[0].validate()) {\n      return;\n    }\n\n    const dataCollection = this.getEventDataFromEditor();\n\n    if (this.processEventValidation(dataCollection.tempData, alert)) {\n      return;\n    }\n\n    this.eventCrudData = dataCollection.eventData;\n    this.dialogEvent = event;\n    this.isCrudAction = true;\n    this.dialogObject.hide();\n  }\n\n  getEventDataFromEditor() {\n    const eventObj = extend({}, this.getObjectFromFormData(EVENT_WINDOW_DIALOG_CLASS));\n\n    if (!eventObj.Timezone) {\n      eventObj[this.fields.startTimezone] = null;\n      eventObj[this.fields.endTimezone] = null;\n    }\n\n    delete eventObj.Timezone;\n    delete eventObj.Repeat;\n    this.setDefaultValueToObject(eventObj);\n    eventObj[this.fields.recurrenceRule] = this.recurrenceEditor ? this.recurrenceEditor.getRecurrenceRule() || null : undefined;\n    const tempObj = extend({}, eventObj, null, true);\n\n    if (eventObj[this.fields.isAllDay]) {\n      eventObj[this.fields.startTime] = isNullOrUndefined(eventObj[this.fields.startTime]) ? null : resetTime(new Date(eventObj[this.fields.startTime].getTime()));\n      eventObj[this.fields.endTime] = isNullOrUndefined(eventObj[this.fields.endTime]) ? null : addDays(resetTime(new Date(eventObj[this.fields.endTime].getTime())), 1);\n    }\n\n    return {\n      eventData: eventObj,\n      tempData: tempObj\n    };\n  }\n\n  processEventValidation(eventObj, alert) {\n    let alertType;\n\n    if (isNullOrUndefined(this.parent.editorTemplate)) {\n      if (!eventObj[this.fields.startTime] || !eventObj[this.fields.endTime]) {\n        this.parent.quickPopup.openValidationError('invalidDateError');\n        return true;\n      }\n\n      if (eventObj[this.fields.startTime] > eventObj[this.fields.endTime]) {\n        this.parent.quickPopup.openValidationError('startEndError');\n        return true;\n      }\n    }\n\n    if (this.recurrenceEditor && this.recurrenceEditor.value && this.recurrenceEditor.value !== '') {\n      alertType = this.recurrenceValidation(eventObj[this.fields.startTime], eventObj[this.fields.endTime], alert);\n      let isShowAlert = true;\n\n      if (alertType === 'seriesChangeAlert' && this.parent.uiStateValues.isIgnoreOccurrence) {\n        isShowAlert = false;\n      }\n\n      if (!isNullOrUndefined(alertType) && isShowAlert && (!this.parent.enableRecurrenceValidation && alertType === 'wrongPattern' || this.parent.enableRecurrenceValidation)) {\n        this.parent.quickPopup.openRecurrenceValidationAlert(alertType);\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  processCrudActions(eventObj) {\n    this.parent.uiStateValues.isBlock = false;\n    const resourceData = this.getResourceData(eventObj);\n    const isResourceEventExpand = (this.parent.activeViewOptions.group.resources.length > 0 || this.parent.resourceCollection.length > 0) && !this.parent.activeViewOptions.group.allowGroupEdit && !isNullOrUndefined(resourceData);\n    const eventId = this.getEventIdFromForm();\n\n    if (!isNullOrUndefined(eventId)) {\n      let eveId = this.parent.eventBase.getEventIDType() === 'string' ? eventId : parseInt(eventId, 10);\n      let editedData = this.parent.eventsData.filter(data => data[this.fields.id] === eveId)[0];\n\n      if (isNullOrUndefined(editedData)) {\n        editedData = this.parent.blockData.filter(data => data[this.fields.id] === eveId)[0];\n      }\n\n      eventObj = extend({}, editedData, eventObj);\n\n      if (eventObj[this.fields.isReadonly]) {\n        return false;\n      }\n\n      let currentAction;\n\n      if (!isNullOrUndefined(editedData[this.fields.recurrenceRule])) {\n        currentAction = this.parent.currentAction;\n        eventObj.Guid = this.parent.activeEventData.event.Guid;\n\n        if (this.parent.currentAction === 'EditOccurrence') {\n          if (!eventObj[this.fields.recurrenceID]) {\n            eventObj[this.fields.id] = this.parent.eventBase.getEventMaxID();\n            eventObj.Guid = this.parent.activeEventData.event.Guid;\n          } else {\n            eveId = eventObj[this.fields.recurrenceID];\n            currentAction = null;\n          }\n\n          if (this.parent.enableRecurrenceValidation && this.editOccurrenceValidation(eveId, eventObj)) {\n            return true;\n          }\n        }\n\n        if (this.parent.currentAction === 'EditSeries' || eventObj[this.fields.id] !== editedData[this.fields.id]) {\n          eventObj[this.fields.recurrenceID] = editedData[this.fields.id];\n        } else if (this.parent.currentAction === 'EditFollowingEvents') {\n          eventObj[this.fields.id] = this.parent.eventBase.getEventMaxID();\n          eventObj[this.fields.followingID] = editedData[this.fields.id];\n        }\n      }\n\n      if (isResourceEventExpand) {\n        this.resourceSaveEvent(eventObj, 'Save', currentAction);\n      } else {\n        this.parent.saveEvent(eventObj, currentAction);\n      }\n    } else {\n      this.parent.currentAction = 'Add';\n\n      if (isResourceEventExpand) {\n        this.resourceSaveEvent(eventObj, this.parent.currentAction);\n      } else {\n        eventObj[this.fields.id] = this.parent.eventBase.getEventMaxID();\n        this.parent.addEvent(eventObj);\n      }\n    }\n\n    return this.parent.uiStateValues.isBlock;\n  }\n\n  getResourceData(eventObj) {\n    let resourceData = null;\n\n    if (!isNullOrUndefined(this.parent.resourceBase) && !isNullOrUndefined(this.parent.resourceBase.resourceCollection) && this.parent.resourceBase.resourceCollection.length > 0) {\n      const lastResourceData = this.parent.resourceBase.resourceCollection.slice(-1)[0];\n      resourceData = eventObj[lastResourceData.field];\n    }\n\n    return resourceData;\n  }\n\n  getObjectFromFormData(className) {\n    const formElement = this.getFormElements(className);\n    const eventObj = {};\n\n    for (const currentElement of formElement) {\n      const columnName = currentElement.name || this.getColumnName(currentElement);\n\n      if (!isNullOrUndefined(columnName) && columnName !== '') {\n        eventObj[columnName] = this.getValueFromElement(currentElement);\n      }\n    }\n\n    return eventObj;\n  }\n\n  setDefaultValueToObject(eventObj) {\n    if (!isNullOrUndefined(eventObj[this.fields.subject])) {\n      eventObj[this.fields.subject] = eventObj[this.fields.subject] || this.parent.eventSettings.fields.subject.default || this.l10n.getConstant('addTitle');\n    }\n\n    if (!isNullOrUndefined(eventObj[this.fields.location])) {\n      eventObj[this.fields.location] = eventObj[this.fields.location] || this.parent.eventSettings.fields.location.default;\n    }\n\n    if (!isNullOrUndefined(eventObj[this.fields.description])) {\n      eventObj[this.fields.description] = eventObj[this.fields.description] || this.parent.eventSettings.fields.description.default;\n    }\n  }\n\n  recurrenceValidation(startDate, endDate, alert) {\n    let alertMessage;\n    const recEditor = this.recurrenceEditor;\n    const interval = this.getInstance('e-repeat-interval.e-numerictextbox').value;\n\n    if (alert !== this.l10n.getConstant('ok')) {\n      const activeEvent = this.parent.activeEventData.event;\n      let excludedEvents = [];\n\n      if ((this.parent.currentAction === 'EditSeries' || this.parent.currentAction === 'EditFollowingEvents') && !isNullOrUndefined(activeEvent)) {\n        const eventStartTime = activeEvent[this.parent.eventFields.startTime];\n        const seriesEvents = this.parent.eventBase.getSeriesEvents(this.eventData, eventStartTime);\n\n        if (seriesEvents.length > 0) {\n          excludedEvents = this.parent.eventBase.getEditedOccurrences(seriesEvents, eventStartTime);\n        } else {\n          const event = this.parent.eventBase.getEventById(activeEvent[this.parent.eventFields.id]);\n          excludedEvents = this.parent.eventBase.getEditedOccurrences([event], eventStartTime);\n        }\n\n        if (this.parent.currentAction === 'EditSeries' && !isNullOrUndefined(this.eventData[this.parent.eventFields.recurrenceException])) {\n          excludedEvents.push(this.eventData);\n        }\n      }\n\n      if (excludedEvents.length > 0) {\n        alertMessage = 'seriesChangeAlert';\n      }\n\n      if (this.getInstance('e-end-on-left .e-ddl .e-dropdownlist').value === 'until' && this.getInstance('e-end-on-date .e-datepicker').value < startDate) {\n        alertMessage = 'wrongPattern';\n      }\n\n      if (isNullOrUndefined(alertMessage)) {\n        let types = recEditor.value.split(';')[1].split('=')[1].split(',');\n        const obj = {\n          'SU': 0,\n          'MO': 1,\n          'TU': 2,\n          'WE': 3,\n          'TH': 4,\n          'FR': 5,\n          'SA': 6\n        };\n        const temp = [];\n        const tempDiff = [];\n        let tempValue;\n\n        switch (recEditor.value.split(';')[0].split('=')[1]) {\n          case 'DAILY':\n            if ((endDate.getTime() - startDate.getTime()) / (1000 * 3600) > interval * 24) {\n              alertMessage = 'createError';\n            }\n\n            break;\n\n          case 'WEEKLY':\n            types = recEditor.value.split(';')[1].split('=')[1].split(',');\n\n            for (let index = 0; index < types.length * (interval + 1); index++) {\n              temp[index] = types.length > index ? obj[types[index]] : temp[index - types.length] + 7 * interval;\n            }\n\n            tempValue = temp.sort((a, b) => a - b);\n\n            for (let index = 1; index < tempValue.length; index++) {\n              tempDiff.push(tempValue[index] - tempValue[index - 1]);\n            }\n\n            if ((endDate.getTime() - startDate.getTime()) / (1000 * 3600) >= Math.min(...tempDiff) * 24 || isNullOrUndefined(interval)) {\n              alertMessage = 'createError';\n            }\n\n            break;\n\n          case 'MONTHLY':\n            if (endDate.getTime() >= new Date(+startDate).setMonth(startDate.getMonth() + interval)) {\n              alertMessage = 'createError';\n            }\n\n            break;\n\n          case 'YEARLY':\n            if (endDate.getTime() >= new Date(+startDate).setFullYear(startDate.getFullYear() + interval)) {\n              alertMessage = 'createError';\n            }\n\n            break;\n        }\n      }\n    } else {\n      if (endDate.getTime() >= new Date(+startDate).setMonth(startDate.getMonth() + interval)) {\n        alertMessage = 'createError';\n      }\n\n      if (isNullOrUndefined(alertMessage)) {\n        this.parent.quickPopup.quickDialog.hide();\n      }\n    }\n\n    if (isNullOrUndefined(interval)) {\n      alertMessage = 'createError';\n    }\n\n    return alertMessage;\n  }\n\n  getRecurrenceIndex(recColl, event) {\n    let recIndex;\n\n    for (let index = 0; index < recColl.length; index++) {\n      if (event[this.fields.startTime].valueOf() === recColl[index][this.fields.startTime].valueOf()) {\n        recIndex = index;\n        break;\n      }\n    }\n\n    return recIndex;\n  }\n\n  trimAllDay(data) {\n    if (data[this.fields.isAllDay]) {\n      const temp = addDays(new Date(+data[this.fields.endTime]), -1).getTime();\n      data[this.fields.endTime] = +data[this.fields.startTime] > temp ? data[this.fields.endTime] : new Date(temp);\n    }\n  }\n\n  editOccurrenceValidation(eventId, currentData, editData) {\n    if (editData === void 0) {\n      editData = this.eventData;\n    }\n\n    const recurColl = this.parent.getOccurrencesByID(eventId);\n    const excludedDatas = this.parent.eventsData.filter(data => data[this.fields.recurrenceID] === eventId);\n    excludedDatas.map(data => recurColl.push(extend({}, data)));\n    currentData = extend({}, currentData);\n    this.trimAllDay(currentData);\n\n    for (const data of recurColl) {\n      this.trimAllDay(data);\n    }\n\n    this.parent.eventBase.sortByTime(recurColl);\n    const index = this.getRecurrenceIndex(recurColl, editData);\n\n    if (isNullOrUndefined(index)) {\n      return false;\n    }\n\n    if (index === 0) {\n      if (!isNullOrUndefined(recurColl[index + 1])) {\n        if (!(resetTime(new Date(+recurColl[index + 1][this.fields.startTime])).getTime() > resetTime(new Date(+currentData[this.fields.endTime])).getTime()) && resetTime(new Date(+recurColl[recurColl.length - 1][this.fields.endTime])).getTime() >= resetTime(new Date(+currentData[this.fields.startTime])).getTime()) {\n          this.parent.quickPopup.openRecurrenceValidationAlert('sameDayAlert');\n          return true;\n        } else if (resetTime(new Date(+recurColl[recurColl.length - 1][this.fields.endTime])).getTime() < resetTime(new Date(+currentData[this.fields.startTime])).getTime()) {\n          this.parent.quickPopup.openRecurrenceValidationAlert('occurrenceAlert');\n          return true;\n        }\n      }\n\n      return false;\n    } else {\n      if (index === recurColl.length - 1) {\n        if (!(resetTime(new Date(+recurColl[index - 1][this.fields.endTime])).getTime() < resetTime(new Date(+currentData[this.fields.startTime])).getTime()) && resetTime(new Date(+recurColl[recurColl.length - 1 - index][this.fields.startTime])).getTime() <= resetTime(new Date(+currentData[this.fields.endTime])).getTime()) {\n          this.parent.quickPopup.openRecurrenceValidationAlert('sameDayAlert');\n          return true;\n        } else if (resetTime(new Date(+recurColl[recurColl.length - 1 - index][this.fields.endTime])).getTime() > resetTime(new Date(+currentData[this.fields.startTime])).getTime()) {\n          this.parent.quickPopup.openRecurrenceValidationAlert('occurrenceAlert');\n          return true;\n        }\n      } else if (!((resetTime(new Date(+recurColl[index - 1][this.fields.endTime])).getTime() < resetTime(new Date(+currentData[this.fields.startTime])).getTime() || resetTime(new Date(+recurColl[0][this.fields.startTime])).getTime() > resetTime(new Date(+currentData[this.fields.startTime])).getTime()) && (resetTime(new Date(+recurColl[index + 1][this.fields.startTime])).getTime() > resetTime(new Date(+currentData[this.fields.endTime])).getTime() || resetTime(new Date(+recurColl[recurColl.length - 1][this.fields.endTime])).getTime() < resetTime(new Date(+currentData[this.fields.startTime])).getTime()))) {\n        this.parent.quickPopup.openRecurrenceValidationAlert('sameDayAlert');\n        return true;\n      } else if (resetTime(new Date(+recurColl[index + 1][this.fields.endTime])).getTime() < resetTime(new Date(+currentData[this.fields.startTime])).getTime() || resetTime(new Date(+recurColl[index - 1][this.fields.startTime])).getTime() > resetTime(new Date(+currentData[this.fields.endTime])).getTime()) {\n        this.parent.quickPopup.openRecurrenceValidationAlert('occurrenceAlert');\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  resourceSaveEvent(eventObj, action, currentAction) {\n    const lastResourceData = this.parent.resourceBase.resourceCollection.slice(-1)[0];\n    let resourceData = eventObj[lastResourceData.field];\n    resourceData = resourceData instanceof Array ? resourceData : [resourceData];\n    const lastLevel = this.parent.resourceBase.lastResourceLevel;\n    const eventList = [];\n\n    for (let i = 0; i < resourceData.length; i++) {\n      const events = extend({}, eventObj, null, true);\n      events[this.fields.id] = this.parent.eventBase.getEventMaxID();\n      const temp = [];\n\n      const addValues = () => {\n        if (action === 'Save' && i === resourceData.length - 1) {\n          if (temp.length > 0) {\n            temp[0][this.fields.id] = eventObj[this.fields.id];\n\n            for (let k = 1; k < temp.length; k++) {\n              temp[k][this.fields.id] = this.parent.eventBase.getEventMaxID(i);\n              eventList.push(temp[k]);\n              this.parent.saveEvent(temp[0], currentAction);\n            }\n          } else {\n            events[this.fields.id] = eventObj[this.fields.id];\n            this.parent.saveEvent(events, currentAction);\n          }\n        } else {\n          if (temp.length > 0) {\n            for (let j = 0; j < temp.length; j++) {\n              temp[j][this.fields.id] = this.parent.eventBase.getEventMaxID(j);\n              eventList.push(temp[j]);\n            }\n          } else {\n            events[this.fields.id] = this.parent.eventBase.getEventMaxID(i);\n            eventList.push(events);\n          }\n        }\n      };\n\n      if (this.parent.activeViewOptions.group.byGroupID && !isNullOrUndefined(lastLevel)) {\n        const lastResource = lastResourceData.dataSource;\n        const resCol = this.parent.resourceCollection;\n        let index;\n\n        if (resCol.length > 1) {\n          index = findIndexInData(lastResource, lastResourceData.idField, resourceData[i], events, resCol);\n        } else {\n          index = findIndexInData(lastResource, lastResourceData.idField, resourceData[i]);\n        }\n\n        if (index < 0) {\n          return;\n        }\n\n        const groupId = lastResource[index][lastResourceData.groupIDField];\n        const filter = lastLevel.filter(obj => obj.resourceData[lastResourceData.idField] === resourceData[i]).filter(obj => obj.resourceData[lastResourceData.groupIDField] === groupId)[0];\n        const groupOrder = filter.groupOrder;\n\n        for (let index = 0; index < this.parent.resourceBase.resourceCollection.length; index++) {\n          const field = this.parent.resourceBase.resourceCollection[index].field;\n          events[field] = groupOrder[index] instanceof Array ? groupOrder[index][0] : groupOrder[index];\n        }\n\n        addValues();\n      } else {\n        for (let index = 0; index < this.parent.resourceBase.resourceCollection.length - 1; index++) {\n          const field = this.parent.resourceBase.resourceCollection[index].field;\n\n          if (events[field] instanceof Array && events[field].length > 1) {\n            for (let k = 0; k < events[field].length; k++) {\n              const event = extend({}, events, null, true);\n              event[field] = eventObj[field][k];\n              event[lastResourceData.field] = resourceData[i];\n              temp.push(event);\n            }\n          } else {\n            if (temp.length === 0) {\n              events[field] = eventObj[field] instanceof Array ? eventObj[field][0] : eventObj[field];\n              events[lastResourceData.field] = resourceData[i];\n            } else {\n              for (let l = 0; l < temp.length; l++) {\n                temp[l][field] = eventObj[field] instanceof Array ? eventObj[field][0] : eventObj[field];\n              }\n            }\n          }\n        }\n\n        events[lastResourceData.field] = resourceData[i];\n        addValues();\n      }\n    }\n\n    if (eventList.length > 0) {\n      for (const event of eventList) {\n        event[this.fields.recurrenceException] = null;\n        event[this.fields.recurrenceID] = null;\n      }\n\n      this.parent.addEvent(eventList);\n    }\n  }\n\n  getEventIdFromForm() {\n    return this.element.querySelector('.' + FORM_CLASS).getAttribute('data-id');\n  }\n\n  getFormElements(className) {\n    let elements = [];\n\n    if (className === EVENT_WINDOW_DIALOG_CLASS) {\n      elements = [].slice.call(this.element.querySelectorAll('.' + EVENT_FIELD$1));\n    } else {\n      elements = [].slice.call(this.parent.element.querySelectorAll('.' + className + ' .' + EVENT_FIELD$1));\n    }\n\n    return elements;\n  }\n\n  getValueFromElement(element) {\n    let value;\n\n    if (element.classList.contains('e-datepicker')) {\n      value = element.ej2_instances[0].value;\n    } else if (element.classList.contains('e-datetimepicker')) {\n      value = element.ej2_instances[0].value;\n    } else if (element.classList.contains('e-dropdownlist')) {\n      value = element.ej2_instances[0].value;\n    } else if (element.classList.contains('e-multiselect')) {\n      value = element.ej2_instances[0].value;\n    } else if (element.classList.contains('e-checkbox')) {\n      value = element.ej2_instances[0].checked;\n    } else {\n      if (element.type === 'checkbox') {\n        value = element.checked;\n      } else {\n        value = SanitizeHtmlHelper.sanitize(element.value);\n      }\n    }\n\n    return value;\n  }\n\n  setValueToElement(element, value) {\n    if (element.classList.contains('e-datepicker')) {\n      const instance = element.ej2_instances[0];\n      instance.value = value;\n      instance.dataBind();\n    } else if (element.classList.contains('e-datetimepicker')) {\n      const instance = element.ej2_instances[0];\n\n      if (instance.element.classList.contains(EVENT_WINDOW_START_CLASS)) {\n        this.eventWindowTime.startTime = new Date('' + value);\n      } else {\n        this.eventWindowTime.endTime = new Date('' + value);\n      }\n\n      instance.value = value;\n      instance.dataBind();\n    } else if (element.classList.contains('e-dropdownlist')) {\n      const instance = element.ej2_instances[0];\n      instance.value = value;\n      instance.dataBind();\n    } else if (element.classList.contains('e-multiselect')) {\n      const instance = element.ej2_instances[0];\n      instance.value = [];\n      instance.value = value instanceof Array ? value : [value];\n      instance.dataBind();\n    } else if (element.classList.contains('e-checkbox')) {\n      const instance = element.ej2_instances[0];\n      instance.checked = value;\n      instance.dataBind();\n    } else {\n      if (element.type !== 'checkbox') {\n        element.value = value || '';\n      } else {\n        element.checked = value;\n      }\n    }\n  }\n\n  setDefaultValueToElement(element) {\n    if (element.classList.contains('e-datepicker')) {\n      const instance = element.ej2_instances[0];\n      instance.value = this.parent.getCurrentTime();\n      instance.dataBind();\n    } else if (element.classList.contains('e-datetimepicker')) {\n      const instance = element.ej2_instances[0];\n      const dateValue = this.parent.getCurrentTime();\n      this.eventWindowTime = {\n        startTime: dateValue,\n        endTime: dateValue\n      };\n      instance.value = dateValue;\n      instance.dataBind();\n    } else if (element.classList.contains('e-dropdownlist')) {\n      const instance = element.ej2_instances[0];\n      instance.value = null;\n      instance.dataBind();\n    } else if (element.classList.contains('e-multiselect')) {\n      const instance = element.ej2_instances[0];\n      instance.value = [];\n      instance.dataBind();\n    } else if (element.classList.contains('e-checkbox')) {\n      const instance = element.ej2_instances[0];\n      instance.checked = false;\n      instance.dataBind();\n    } else {\n      if (element.type === 'checkbox') {\n        element.checked = false;\n      } else {\n        element.value = '';\n      }\n    }\n  }\n\n  getInstance(className) {\n    const element = this.element.querySelector('.' + className);\n    return element ? element.ej2_instances[0] : null;\n  }\n\n  eventDelete(event) {\n    if (this.isEnterKey) {\n      this.isEnterKey = false;\n      return;\n    }\n\n    switch (this.parent.currentAction) {\n      case 'EditOccurrence':\n        if (!isNullOrUndefined(this.parent.activeEventData.event[this.parent.eventFields.recurrenceRule])) {\n          this.parent.currentAction = 'DeleteOccurrence';\n        } else {\n          this.parent.currentAction = 'Delete';\n        }\n\n        break;\n\n      case 'EditSeries':\n        this.parent.currentAction = 'DeleteSeries';\n        break;\n\n      case 'Save':\n        this.parent.currentAction = 'Delete';\n        break;\n\n      case 'EditFollowingEvents':\n        if (!isNullOrUndefined(this.parent.activeEventData.event[this.parent.eventFields.recurrenceRule])) {\n          this.parent.currentAction = 'DeleteFollowingEvents';\n        }\n\n        break;\n    }\n\n    this.dialogEvent = event;\n    this.isCrudAction = false;\n    this.dialogObject.hide();\n    this.parent.quickPopup.openDeleteAlert();\n  }\n\n  getRecurrenceEditorInstance() {\n    if (this.parent.isAdaptive && !this.repeatDialogObject) {\n      this.renderRepeatDialog();\n    }\n\n    return this.recurrenceEditor;\n  }\n\n  destroyComponents() {\n    const formElements = this.getFormElements(EVENT_WINDOW_DIALOG_CLASS);\n\n    for (const element of formElements) {\n      let instance;\n\n      if (element.classList.contains('e-datetimepicker')) {\n        instance = element.ej2_instances;\n      } else if (element.classList.contains('e-datepicker')) {\n        instance = element.ej2_instances;\n      } else if (element.classList.contains('e-checkbox')) {\n        instance = element.ej2_instances;\n      } else if (element.classList.contains('e-dropdownlist')) {\n        instance = element.ej2_instances;\n      } else if (element.classList.contains('e-multiselect')) {\n        instance = element.ej2_instances;\n      }\n\n      if (instance && instance[0]) {\n        instance[0].destroy();\n      }\n    }\n\n    if (this.buttonObj) {\n      this.buttonObj.destroy();\n    }\n  }\n\n  destroy(isIgnore) {\n    if (this.parent && !this.parent.isDestroyed) {\n      this.parent.resetTemplates(['editorTemplate']);\n    }\n\n    this.destroyComponents();\n\n    if (this.recurrenceEditor) {\n      this.recurrenceEditor.destroy();\n      this.recurrenceEditor = null;\n    }\n\n    if (this.fieldValidator) {\n      this.fieldValidator.destroy();\n      this.fieldValidator = null;\n    }\n\n    if (this.repeatDialogObject) {\n      this.repeatDialogObject.destroy();\n      this.repeatDialogObject = null;\n    }\n\n    if (this.dialogObject) {\n      if (this.dialogObject.element) {\n        EventHandler.remove(this.dialogObject.element, 'keydown', this.preventEventSave);\n      }\n\n      this.dialogObject.destroy();\n      this.dialogObject = null;\n    }\n\n    if (this.element) {\n      remove(this.element);\n      this.element = null;\n    }\n\n    if (!isIgnore) {\n      this.l10n = null;\n      this.parent = null;\n      this.fields = null;\n      this.buttonObj = null;\n      this.repeatStatus = null;\n      this.eventWindowTime = null;\n    }\n  }\n\n}\n/**\n * Virtual Scroll\n */\n\n\nclass VirtualScroll {\n  constructor(parent) {\n    this.translateY = 0;\n    this.itemSize = 60;\n    this.bufferCount = 3;\n    this.renderedLength = 0;\n    this.averageRowHeight = 0;\n    this.isScrollHeightNull = true;\n    this.parent = parent;\n    this.addEventListener();\n  }\n\n  addEventListener() {\n    if (!this.parent || this.parent && this.parent.isDestroyed) {\n      return;\n    }\n\n    this.parent.on(virtualScroll, this.virtualScrolling, this);\n  }\n\n  removeEventListener() {\n    if (!this.parent || this.parent && this.parent.isDestroyed) {\n      return;\n    }\n\n    this.parent.off(virtualScroll, this.virtualScrolling);\n  }\n\n  getRenderedCount() {\n    this.setItemSize();\n    return Math.ceil(this.parent.element.clientHeight / this.itemSize) + this.bufferCount;\n  }\n\n  setTranslateValue() {\n    const resWrap = this.parent.element.querySelector('.' + RESOURCE_COLUMN_WRAP_CLASS);\n    const conWrap = this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS);\n    const eventWrap = this.parent.element.querySelector('.' + EVENT_TABLE_CLASS);\n    const timeIndicator = this.parent.element.querySelector('.' + CURRENT_TIMELINE_CLASS);\n    this.renderVirtualTrackHeight(conWrap, resWrap);\n    this.setTranslate(resWrap, conWrap, eventWrap, timeIndicator);\n  }\n\n  renderVirtualTrackHeight(contentWrap, resourceWrap) {\n    this.parent.resourceBase.setExpandedResources();\n\n    if (this.isScrollHeightNull) {\n      const wrap = createElement('div', {\n        className: VIRTUAL_TRACK_CLASS\n      });\n      const resWrap = [].slice.call(resourceWrap.querySelectorAll('table td'));\n      const startIndex = parseInt(resWrap[0].getAttribute('data-group-index'), 10);\n      const endIndex = parseInt(resWrap[resWrap.length - 1].getAttribute('data-group-index'), 10);\n      this.parent.resourceBase.renderedResources = this.parent.resourceBase.expandedResources.filter(resource => resource.groupIndex >= startIndex && resource.groupIndex <= endIndex);\n      this.setItemSize();\n      wrap.style.height = this.parent.resourceBase.expandedResources.length * this.itemSize + 'px';\n      this.isScrollHeightNull = false;\n      const virtual = this.parent.element.querySelector('.' + VIRTUAL_TRACK_CLASS);\n\n      if (!isNullOrUndefined(virtual)) {\n        remove(virtual);\n      }\n\n      contentWrap.appendChild(wrap);\n    }\n  }\n\n  renderVirtualTrack(contentWrap) {\n    const wrap = createElement('div', {\n      className: VIRTUAL_TRACK_CLASS\n    });\n    wrap.style.height = this.parent.resourceBase.expandedResources.length * this.itemSize + 'px';\n    contentWrap.appendChild(wrap);\n  }\n\n  updateVirtualScrollHeight() {\n    const virtual = this.parent.element.querySelector('.' + VIRTUAL_TRACK_CLASS);\n    const lastResourceIndex = this.parent.resourceBase.expandedResources[this.parent.resourceBase.expandedResources.length - 1].groupIndex;\n    const lastRenderIndex = this.parent.resourceBase.renderedResources[this.parent.resourceBase.renderedResources.length - 1].groupIndex;\n\n    if (lastRenderIndex !== lastResourceIndex) {\n      const conTable = this.parent.element.querySelector('.' + CONTENT_TABLE_CLASS);\n      this.renderedLength = conTable.querySelector('tbody').children.length;\n      virtual.style.height = conTable.offsetHeight + (this.parent.resourceBase.expandedResources.length - this.renderedLength) * conTable.offsetHeight / this.renderedLength + 'px';\n    } else {\n      virtual.style.height = '';\n    }\n\n    this.averageRowHeight = virtual.offsetHeight / this.parent.resourceBase.expandedResources.length;\n  }\n\n  updateVirtualTrackHeight(wrap) {\n    const resourceCount = this.parent.resourceBase.renderedResources.length;\n\n    if (resourceCount !== this.getRenderedCount()) {\n      wrap.style.height = this.parent.element.querySelector('.e-content-wrap').clientHeight + 'px';\n      const resWrap = this.parent.element.querySelector('.' + RESOURCE_COLUMN_WRAP_CLASS);\n      const conWrap = this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS);\n      const eventWrap = this.parent.element.querySelector('.' + EVENT_TABLE_CLASS);\n      this.translateY = 0;\n      this.setTranslate(resWrap, conWrap, eventWrap);\n    } else {\n      const lastRenderIndex = this.parent.resourceBase.renderedResources[resourceCount - 1].groupIndex;\n      const lastCollIndex = this.parent.resourceBase.expandedResources[this.parent.resourceBase.expandedResources.length - 1].groupIndex;\n      let renderedResCount = resourceCount + (lastCollIndex - lastRenderIndex);\n      renderedResCount = renderedResCount > this.parent.resourceBase.expandedResources.length ? this.parent.resourceBase.expandedResources.length : renderedResCount;\n      wrap.style.height = renderedResCount * this.itemSize + 'px';\n    }\n  }\n\n  setItemSize() {\n    this.itemSize = getElementHeightFromClass(this.parent.activeView.element, WORK_CELLS_CLASS) || this.itemSize;\n  }\n\n  renderEvents() {\n    this.setTabIndex();\n    this.parent.refreshEvents(false);\n    this.parent.notify(contentReady, {});\n    this.parent.hideSpinner();\n  }\n\n  virtualScrolling() {\n    if (this.parent.quickPopup) {\n      this.parent.quickPopup.quickPopupHide();\n      this.parent.quickPopup.morePopup.hide();\n    }\n\n    const resWrap = this.parent.element.querySelector('.' + RESOURCE_COLUMN_WRAP_CLASS);\n    const conWrap = this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS);\n    const eventWrap = this.parent.element.querySelector('.' + EVENT_TABLE_CLASS);\n    const timeIndicator = this.parent.element.querySelector('.' + CURRENT_TIMELINE_CLASS);\n    const conTable = this.parent.element.querySelector('.' + CONTENT_TABLE_CLASS);\n    this.renderedLength = resWrap.querySelector('tbody').children.length;\n    const firstTDIndex = parseInt(resWrap.querySelector('tbody td').getAttribute('data-group-index'), 10);\n    const scrollHeight = this.parent.rowAutoHeight ? conTable.offsetHeight - conWrap.offsetHeight : this.bufferCount * this.itemSize;\n    addClass([conWrap], 'e-transition');\n    let resCollection = [];\n\n    if (conWrap.scrollTop - this.translateY < 0) {\n      resCollection = this.upScroll(conWrap, firstTDIndex);\n    } else if (conWrap.scrollTop - this.translateY > scrollHeight) {\n      resCollection = this.downScroll(conWrap, firstTDIndex);\n    }\n\n    if (!isNullOrUndefined(resCollection) && resCollection.length > 0) {\n      this.parent.showSpinner();\n      const selectedEle = this.parent.getSelectedElements();\n      this.focusedEle = selectedEle[selectedEle.length - 1] || this.focusedEle;\n      this.updateContent(resWrap, conWrap, eventWrap, resCollection);\n      this.setTranslate(resWrap, conWrap, eventWrap, timeIndicator);\n\n      if (this.parent.dragAndDropModule && this.parent.dragAndDropModule.actionObj.action === 'drag') {\n        this.parent.dragAndDropModule.navigationWrapper();\n      }\n\n      window.clearTimeout(this.timeValue);\n      this.timeValue = window.setTimeout(() => {\n        this.renderEvents();\n      }, 250);\n    }\n  }\n\n  upScroll(conWrap, firstTDIndex) {\n    let index = 0;\n    index = ~~(conWrap.scrollTop / this.itemSize) + Math.ceil(conWrap.clientHeight / this.itemSize) - this.renderedLength;\n\n    if (this.parent.rowAutoHeight) {\n      index = index > firstTDIndex ? firstTDIndex - this.bufferCount : index;\n    }\n\n    index = index > 0 ? index : 0;\n    const prevSetCollection = this.getBufferCollection(index, index + this.renderedLength);\n    this.parent.resourceBase.renderedResources = prevSetCollection;\n\n    if (firstTDIndex === 0) {\n      this.translateY = conWrap.scrollTop;\n    } else {\n      let height = this.parent.rowAutoHeight ? this.averageRowHeight : this.itemSize;\n      height = height > 0 ? height : this.itemSize;\n      this.translateY = conWrap.scrollTop - this.bufferCount * height > 0 ? conWrap.scrollTop - this.bufferCount * height : 0;\n    }\n\n    return prevSetCollection;\n  }\n\n  downScroll(conWrap, firstTDIndex) {\n    const lastResource = this.parent.resourceBase.renderedResources[this.parent.resourceBase.renderedResources.length - 1].groupIndex;\n    const lastResourceIndex = this.parent.resourceBase.expandedResources[this.parent.resourceBase.expandedResources.length - 1].groupIndex;\n\n    if (lastResource === lastResourceIndex) {\n      return null;\n    }\n\n    let nextSetResIndex = 0;\n    nextSetResIndex = ~~(conWrap.scrollTop / this.itemSize);\n\n    if (this.parent.rowAutoHeight) {\n      nextSetResIndex = ~~((conWrap.scrollTop - this.translateY) / this.averageRowHeight) + firstTDIndex;\n      nextSetResIndex = nextSetResIndex > firstTDIndex + this.bufferCount ? nextSetResIndex : firstTDIndex + this.bufferCount;\n    }\n\n    let lastIndex = nextSetResIndex + this.renderedLength;\n    lastIndex = lastIndex > this.parent.resourceBase.expandedResources.length ? nextSetResIndex + (this.parent.resourceBase.expandedResources.length - nextSetResIndex) : lastIndex;\n    const nextSetCollection = this.getBufferCollection(lastIndex - this.renderedLength, lastIndex);\n    this.translateY = conWrap.scrollTop;\n    return nextSetCollection;\n  }\n\n  updateContent(resWrap, conWrap, eventWrap, resCollection) {\n    const renderedLength = resWrap.querySelector('tbody').children.length;\n\n    if (document.activeElement && document.activeElement.classList.contains(RESOURCE_CELLS_CLASS)) {\n      this.isResourceCell = true;\n      this.parent.element.focus();\n    }\n\n    for (let i = 0; i < renderedLength; i++) {\n      remove(resWrap.querySelector('tbody tr'));\n      remove(conWrap.querySelector('tbody tr'));\n      remove(eventWrap.querySelector('div'));\n    }\n\n    this.parent.resourceBase.renderedResources = resCollection;\n    const resourceRows = this.parent.resourceBase.getContentRows(resCollection, true);\n    const contentRows = this.parent.activeView.getContentRows();\n    const eventRows = this.parent.activeView.getEventRows(resCollection.length);\n    append(resourceRows, resWrap.querySelector('tbody'));\n    append(contentRows, conWrap.querySelector('tbody'));\n    append(eventRows, eventWrap);\n  }\n\n  getBufferCollection(startIndex, endIndex) {\n    return this.parent.resourceBase.expandedResources.slice(startIndex, endIndex);\n  }\n\n  setTranslate(resWrap, conWrap, eventWrap, timeIndicator) {\n    setStyleAttribute(resWrap.querySelector('table'), {\n      transform: `translateY(${this.translateY}px)`\n    });\n    setStyleAttribute(conWrap.querySelector('table'), {\n      transform: `translateY(${this.translateY}px)`\n    });\n    setStyleAttribute(eventWrap, {\n      transform: `translateY(${this.translateY}px)`\n    });\n\n    if (!isNullOrUndefined(timeIndicator)) {\n      setStyleAttribute(timeIndicator, {\n        transform: `translateY(${this.translateY}px)`\n      });\n    }\n  }\n\n  updateFocusedWorkCell() {\n    if (this.focusedEle) {\n      const date = parseInt(this.focusedEle.getAttribute('data-date'), 10);\n      const groupIndex = parseInt(this.focusedEle.getAttribute('data-group-index'), 10);\n      const ele = this.parent.element.querySelector(`.${WORK_CELLS_CLASS}[data-date=\"${date}\"][data-group-index=\"${groupIndex}\"]`);\n\n      if (ele) {\n        this.parent.addSelectedClass([ele], ele, true);\n      }\n\n      this.focusedEle = null;\n    }\n  }\n\n  setTabIndex() {\n    const resColWrap = this.parent.element.querySelector('.' + RESOURCE_COLUMN_WRAP_CLASS);\n    const resCells = [].slice.call(this.parent.element.querySelectorAll('.' + RESOURCE_CELLS_CLASS));\n\n    if (resCells && resColWrap) {\n      resCells.forEach(element => {\n        if (element.getBoundingClientRect().top >= resColWrap.getBoundingClientRect().top) {\n          element.setAttribute('tabindex', '0');\n        }\n      });\n    }\n\n    const focusResCell = this.parent.element.querySelector(`.${RESOURCE_CELLS_CLASS}[tabindex=\"${0}\"]`);\n\n    if (this.isResourceCell && focusResCell) {\n      focusResCell.focus();\n      this.isResourceCell = false;\n    }\n  }\n\n  destroy() {\n    this.removeEventListener();\n  }\n\n}\n/**\n * Schedule DOM rendering\n */\n\n\nclass Render {\n  constructor(parent) {\n    this.parent = parent;\n  }\n\n  render(viewName, isDataRefresh = true) {\n    this.initializeLayout(viewName);\n\n    if (this.parent.activeView && isDataRefresh) {\n      this.parent.crudModule.refreshDataManager();\n    }\n  }\n\n  initializeLayout(viewName) {\n    if (this.parent.activeView) {\n      const templates = ['cellTemplate', 'eventTemplate', 'tooltipTemplate', 'majorSlotTemplate', 'minorSlotTemplate', 'headerTooltipTemplate', 'dateHeaderTemplate', 'dayHeaderTemplate', 'mothHeaderTemplate', 'headerIndentTemplate', 'resourceHeaderTemplate', 'cellHeaderTemplate'];\n      this.parent.resetTemplates(templates);\n      this.parent.activeView.removeEventListener();\n      this.parent.activeView.destroy();\n    }\n\n    switch (viewName) {\n      case 'Day':\n        this.parent.activeView = this.parent.dayModule;\n        break;\n\n      case 'Week':\n        this.parent.activeView = this.parent.weekModule;\n        break;\n\n      case 'WorkWeek':\n        this.parent.activeView = this.parent.workWeekModule;\n        break;\n\n      case 'Month':\n        this.parent.activeView = this.parent.monthModule;\n        break;\n\n      case 'Year':\n        this.parent.activeView = this.parent.yearModule;\n        break;\n\n      case 'Agenda':\n        this.parent.activeView = this.parent.agendaModule;\n        break;\n\n      case 'MonthAgenda':\n        this.parent.activeView = this.parent.monthAgendaModule;\n        break;\n\n      case 'TimelineDay':\n        this.parent.activeView = this.parent.timelineViewsModule;\n        this.parent.activeView.viewClass = 'e-timeline-day-view';\n        break;\n\n      case 'TimelineWorkWeek':\n        this.parent.activeView = this.parent.timelineViewsModule;\n        this.parent.activeView.viewClass = 'e-timeline-work-week-view';\n        break;\n\n      case 'TimelineWeek':\n        this.parent.activeView = this.parent.timelineViewsModule;\n        this.parent.activeView.viewClass = 'e-timeline-week-view';\n        break;\n\n      case 'TimelineMonth':\n        this.parent.activeView = this.parent.timelineMonthModule;\n        break;\n\n      case 'TimelineYear':\n        this.parent.activeView = this.parent.timelineYearModule;\n        break;\n    }\n\n    if (isNullOrUndefined(this.parent.activeView)) {\n      const firstView = this.parent.viewCollections[0].option;\n\n      if (firstView) {\n        this.parent.setProperties({\n          currentView: firstView\n        }, true);\n\n        if (this.parent.headerModule) {\n          this.parent.headerModule.updateActiveView();\n          this.parent.headerModule.setCalendarView();\n        }\n\n        return this.initializeLayout(firstView);\n      }\n\n      throw Error('Inject required modules');\n    }\n\n    this.parent.activeView.viewIndex = this.parent.viewIndex;\n    this.updateLabelText(viewName);\n    this.parent.activeView.addEventListener();\n    this.parent.activeView.getRenderDates();\n    this.parent.uiStateValues.isGroupAdaptive = this.parent.activeViewOptions.group.resources.length > 0 && (this.parent.enableAdaptiveUI && !this.parent.isAdaptive || this.parent.isAdaptive && this.parent.activeViewOptions.group.enableCompactView);\n\n    if (this.parent.virtualScrollModule) {\n      this.parent.virtualScrollModule.destroy();\n      this.parent.virtualScrollModule = null;\n    }\n\n    if (this.parent.currentView.indexOf('Timeline') !== -1 && (this.parent.currentView.indexOf('Year') === -1 || this.parent.currentView === 'TimelineYear' && this.parent.activeViewOptions.orientation === 'Vertical') && this.parent.activeViewOptions.allowVirtualScrolling && this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n      this.parent.virtualScrollModule = new VirtualScroll(this.parent);\n      this.parent.uiStateValues.top = 0;\n    }\n\n    this.updateHeader();\n    this.parent.activeView.renderLayout(CURRENT_PANEL_CLASS);\n    this.parent.renderTemplates();\n\n    if (this.parent.eventTooltip) {\n      this.parent.eventTooltip.destroy();\n      this.parent.eventTooltip = null;\n    }\n\n    if (this.parent.eventSettings.enableTooltip || this.parent.activeViewOptions.group.resources.length > 0 && this.parent.activeViewOptions.group.headerTooltipTemplate) {\n      this.parent.eventTooltip = new EventTooltip(this.parent);\n    }\n  }\n\n  updateHeader() {\n    if (this.parent.headerModule) {\n      this.parent.headerModule.setDayOfWeek(this.parent.activeViewOptions.firstDayOfWeek);\n\n      if (this.parent.activeViewOptions.readonly) {\n        addClass([this.parent.element], READ_ONLY);\n      } else if (this.parent.element.classList.contains(READ_ONLY)) {\n        removeClass([this.parent.element], READ_ONLY);\n      }\n\n      this.parent.headerModule.updateDateRange(this.parent.activeView.getDateRangeText());\n      this.parent.headerModule.updateHeaderItems('remove');\n    }\n  }\n\n  updateLabelText(view) {\n    const content = this.parent.activeView.getLabelText(view);\n    this.parent.element.setAttribute('role', 'main');\n    this.parent.element.setAttribute('aria-label', content);\n  }\n\n}\n\nvar __decorate$2 = undefined && undefined.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n/**\n * A class that represents the configuration of working hours related options of scheduler.\n */\n\n\nclass WorkHours extends ChildProperty {}\n\n__decorate$2([Property(true)], WorkHours.prototype, \"highlight\", void 0);\n\n__decorate$2([Property('09:00')], WorkHours.prototype, \"start\", void 0);\n\n__decorate$2([Property('18:00')], WorkHours.prototype, \"end\", void 0);\n\nvar __decorate$3 = undefined && undefined.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n/**\n * A class that represents the configuration of options related to timescale on scheduler.\n */\n\n\nclass TimeScale extends ChildProperty {}\n\n__decorate$3([Property(true)], TimeScale.prototype, \"enable\", void 0);\n\n__decorate$3([Property(60)], TimeScale.prototype, \"interval\", void 0);\n\n__decorate$3([Property(2)], TimeScale.prototype, \"slotCount\", void 0);\n\n__decorate$3([Property()], TimeScale.prototype, \"minorSlotTemplate\", void 0);\n\n__decorate$3([Property()], TimeScale.prototype, \"majorSlotTemplate\", void 0);\n\nvar __decorate$4 = undefined && undefined.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n/**\n * A class that defines the template options available to customize the quick popup of scheduler.\n */\n\n\nclass QuickInfoTemplates extends ChildProperty {}\n\n__decorate$4([Property('Both')], QuickInfoTemplates.prototype, \"templateType\", void 0);\n\n__decorate$4([Property()], QuickInfoTemplates.prototype, \"header\", void 0);\n\n__decorate$4([Property()], QuickInfoTemplates.prototype, \"content\", void 0);\n\n__decorate$4([Property()], QuickInfoTemplates.prototype, \"footer\", void 0);\n\nvar __decorate$5 = undefined && undefined.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n/**\n * A class that represents the header rows related configurations on timeline views.\n */\n\n\nclass HeaderRows extends ChildProperty {}\n\n__decorate$5([Property()], HeaderRows.prototype, \"option\", void 0);\n\n__decorate$5([Property()], HeaderRows.prototype, \"template\", void 0);\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\n/* eslint-disable max-len */\n\n/**\n * Schedule CRUD operations\n */\n\n\nclass Crud {\n  constructor(parent) {\n    this.parent = parent;\n    this.crudObj = {\n      sourceEvent: null,\n      targetEvent: null,\n      isCrudAction: false\n    };\n  }\n\n  getQuery() {\n    const start = this.parent.activeView.startDate();\n    const end = this.parent.activeView.endDate();\n    return this.parent.dataModule.generateQuery(start, end);\n  }\n\n  getTable() {\n    if (this.parent.eventSettings.query) {\n      const query = this.parent.eventSettings.query.clone();\n      return query.fromTable;\n    }\n\n    return null;\n  }\n\n  refreshDataManager() {\n    if (!this.parent.activeView) {\n      return;\n    }\n\n    const start = this.parent.activeView.startDate();\n    const end = this.parent.activeView.endDate();\n    const dataManager = this.parent.dataModule.getData(this.parent.dataModule.generateQuery(start, end));\n    dataManager.then(e => this.dataManagerSuccess(e)).catch(e => this.dataManagerFailure(e));\n  }\n\n  dataManagerSuccess(e) {\n    if (!this.parent || this.parent && this.parent.isDestroyed) {\n      return;\n    }\n\n    this.parent.trigger(dataBinding, e, args => {\n      const resultData = extend([], args.result, null, true);\n      this.parent.eventsData = resultData.filter(data => !data[this.parent.eventFields.isBlock]);\n      this.parent.blockData = resultData.filter(data => data[this.parent.eventFields.isBlock]);\n      this.parent.refreshEvents(false);\n\n      if (this.parent.dragAndDropModule && this.parent.dragAndDropModule.actionObj.action === 'drag') {\n        this.parent.dragAndDropModule.navigationWrapper();\n      }\n\n      this.parent.trigger(dataBound, null, () => {\n        this.parent.hideSpinner();\n\n        if (this.parent.isPrinting) {\n          this.parent.notify(print$1, {});\n        }\n      });\n    });\n  }\n\n  dataManagerFailure(e) {\n    if (!this.parent || this.parent && this.parent.isDestroyed) {\n      return;\n    }\n\n    this.parent.trigger(actionFailure, {\n      error: e\n    }, () => this.parent.hideSpinner());\n  }\n\n  refreshData(args) {\n    const actionArgs = {\n      requestType: args.requestType,\n      cancel: false,\n      data: args.data,\n      addedRecords: args.editParams.addedRecords,\n      changedRecords: args.editParams.changedRecords,\n      deletedRecords: args.editParams.deletedRecords\n    };\n\n    if (this.parent.dragAndDropModule && this.parent.dragAndDropModule.actionObj && this.parent.dragAndDropModule.actionObj.element) {\n      this.parent.dragAndDropModule.actionObj.element.style.display = 'none';\n    }\n\n    if (this.parent.resizeModule && this.parent.resizeModule.actionObj && this.parent.resizeModule.actionObj.element) {\n      this.parent.resizeModule.actionObj.element.style.display = 'none';\n    }\n\n    if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.activeViewOptions.group.allowGroupEdit && !this.parent.rowAutoHeight && !this.parent.virtualScrollModule && this.parent.activeViewOptions.group.byGroupID) {\n      if (args.requestType === 'eventCreated' || args.requestType === 'eventRemoved') {\n        this.crudObj.isCrudAction = true;\n        this.crudObj.sourceEvent = [];\n        const crudData = args.data instanceof Array ? args.data.length === 0 && args.requestType === 'eventRemoved' ? args.editParams.deletedRecords : args.data : (typeof args.data === 'string' || typeof args.data === 'number') && args.requestType === 'eventRemoved' ? args.editParams.deletedRecords : [args.data];\n\n        for (const data of crudData) {\n          this.crudObj.isCrudAction = !(args.requestType === 'eventRemoved' && !isNullOrUndefined(data.parent));\n          const groupIndex = this.parent.eventBase.getGroupIndexFromEvent(data);\n\n          if (groupIndex > -1 && this.parent.crudModule.crudObj.sourceEvent.filter(tdData => tdData.groupIndex === groupIndex).length === 0 && this.crudObj.isCrudAction) {\n            this.crudObj.sourceEvent.push(this.parent.resourceBase.lastResourceLevel[groupIndex]);\n          }\n        }\n\n        this.crudObj.targetEvent = this.crudObj.sourceEvent;\n      }\n    }\n\n    if (this.parent.dataModule.dataManager.dataSource.offline) {\n      this.parent.trigger(actionComplete, actionArgs, offlineArgs => {\n        if (!offlineArgs.cancel) {\n          this.refreshDataManager();\n        }\n      });\n    } else {\n      args.promise.then(() => {\n        if (!this.parent || this.parent && this.parent.isDestroyed) {\n          return;\n        }\n\n        this.parent.trigger(actionComplete, actionArgs, onlineArgs => {\n          if (!onlineArgs.cancel) {\n            this.refreshDataManager();\n          }\n        });\n      }).catch(e => {\n        if (!this.parent || this.parent && this.parent.isDestroyed) {\n          return;\n        }\n\n        this.parent.trigger(actionFailure, {\n          error: e\n        });\n      });\n    }\n  }\n\n  addEvent(eventData) {\n    if (this.parent.eventSettings.allowAdding && !this.parent.activeViewOptions.readonly) {\n      if (!this.isBlockEvent(eventData) && this.parent.eventBase.isBlockRange(eventData)) {\n        this.parent.quickPopup.openValidationError('blockAlert', eventData);\n        return;\n      }\n\n      const addEvents = eventData instanceof Array ? eventData : [eventData];\n      const args = {\n        requestType: 'eventCreate',\n        cancel: false,\n        data: addEvents,\n        addedRecords: addEvents,\n        changedRecords: [],\n        deletedRecords: []\n      };\n      this.parent.trigger(actionBegin, args, addArgs => {\n        if (!addArgs.cancel) {\n          const fields = this.parent.eventFields;\n          const editParams = {\n            addedRecords: [],\n            changedRecords: [],\n            deletedRecords: []\n          };\n          let promise;\n\n          if (addArgs.addedRecords instanceof Array) {\n            for (let event of addArgs.addedRecords) {\n              event = this.parent.eventBase.updateEventDateTime(event);\n              const eventData = extend({}, this.parent.eventBase.processTimezone(event, true), null, true);\n              editParams.addedRecords.push(eventData);\n            }\n\n            promise = this.parent.dataModule.dataManager.saveChanges(editParams, fields.id, this.getTable(), this.getQuery());\n          } else {\n            const event = this.parent.eventBase.processTimezone(addArgs.addedRecords, true);\n            editParams.addedRecords.push(event);\n            promise = this.parent.dataModule.dataManager.insert(event, this.getTable(), this.getQuery());\n          }\n\n          const crudArgs = {\n            requestType: 'eventCreated',\n            cancel: false,\n            data: addArgs.addedRecords,\n            promise: promise,\n            editParams: editParams\n          };\n          this.refreshData(crudArgs);\n        }\n      });\n    }\n  }\n\n  saveEvent(eventData, action) {\n    if (this.parent.eventSettings.allowEditing && !this.parent.activeViewOptions.readonly) {\n      if (this.parent.currentAction !== 'EditFollowingEvents' && !this.isBlockEvent(eventData) && this.parent.eventBase.isBlockRange(eventData)) {\n        this.parent.quickPopup.openValidationError('blockAlert', eventData);\n        return;\n      }\n\n      this.parent.currentAction = action;\n\n      if (action) {\n        switch (action) {\n          case 'Save':\n            this.processSave(eventData);\n            break;\n\n          case 'EditOccurrence':\n            this.processOccurrences(eventData, action);\n            break;\n\n          case 'EditFollowingEvents':\n            this.processFollowSeries(eventData, action);\n            break;\n\n          case 'EditSeries':\n            this.processEntireSeries(eventData, action);\n            break;\n        }\n      } else {\n        const updateEvents = eventData instanceof Array ? eventData : [eventData];\n        const args = {\n          requestType: 'eventChange',\n          cancel: false,\n          data: eventData,\n          addedRecords: [],\n          changedRecords: updateEvents,\n          deletedRecords: []\n        };\n        this.parent.trigger(actionBegin, args, saveArgs => {\n          if (!saveArgs.cancel) {\n            let promise;\n            const fields = this.parent.eventFields;\n            const editParams = {\n              addedRecords: [],\n              changedRecords: [],\n              deletedRecords: []\n            };\n\n            if (saveArgs.changedRecords instanceof Array) {\n              for (let event of saveArgs.changedRecords) {\n                event = this.parent.eventBase.updateEventDateTime(event);\n                const eventData = extend({}, this.parent.eventBase.processTimezone(event, true), null, true);\n                editParams.changedRecords.push(eventData);\n              }\n\n              promise = this.parent.dataModule.dataManager.saveChanges(editParams, fields.id, this.getTable(), this.getQuery());\n            } else {\n              const event = this.parent.eventBase.processTimezone(saveArgs.changedRecords, true);\n              editParams.changedRecords.push(event);\n              promise = this.parent.dataModule.dataManager.update(fields.id, event, this.getTable(), this.getQuery());\n            }\n\n            const crudArgs = {\n              requestType: 'eventChanged',\n              cancel: false,\n              data: saveArgs.changedRecords,\n              promise: promise,\n              editParams: editParams\n            };\n            this.refreshData(crudArgs);\n          }\n        });\n      }\n    }\n  }\n\n  deleteEvent(eventData, action) {\n    if (this.parent.eventSettings.allowDeleting && !this.parent.activeViewOptions.readonly) {\n      this.parent.currentAction = action;\n      let deleteEvents = [];\n\n      if (typeof eventData === 'string' || typeof eventData === 'number') {\n        deleteEvents = this.parent.eventsData.filter(eventObj => eventObj[this.parent.eventFields.id] === eventData);\n      } else {\n        deleteEvents = eventData instanceof Array ? eventData : [eventData];\n      }\n\n      if (action) {\n        switch (action) {\n          case 'Delete':\n            this.processDelete(deleteEvents);\n            break;\n\n          case 'DeleteOccurrence':\n            this.processOccurrences(deleteEvents, action);\n            break;\n\n          case 'DeleteFollowingEvents':\n            this.processFollowSeries(deleteEvents, action);\n            break;\n\n          case 'DeleteSeries':\n            this.processEntireSeries(deleteEvents, action);\n            break;\n        }\n      } else {\n        const args = {\n          requestType: 'eventRemove',\n          cancel: false,\n          data: eventData,\n          addedRecords: [],\n          changedRecords: [],\n          deletedRecords: deleteEvents\n        };\n        this.parent.trigger(actionBegin, args, deleteArgs => {\n          if (!deleteArgs.cancel) {\n            let promise;\n            const fields = this.parent.eventFields;\n            const editParams = {\n              addedRecords: [],\n              changedRecords: [],\n              deletedRecords: []\n            };\n\n            if (deleteArgs.deletedRecords.length > 1) {\n              editParams.deletedRecords = editParams.deletedRecords.concat(deleteArgs.deletedRecords);\n              promise = this.parent.dataModule.dataManager.saveChanges(editParams, fields.id, this.getTable(), this.getQuery());\n            } else {\n              editParams.deletedRecords.push(deleteArgs.deletedRecords[0]);\n              promise = this.parent.dataModule.dataManager.remove(fields.id, deleteArgs.deletedRecords[0], this.getTable(), this.getQuery());\n            }\n\n            this.parent.eventBase.selectWorkCellByTime(deleteArgs.deletedRecords);\n            const crudArgs = {\n              requestType: 'eventRemoved',\n              cancel: false,\n              data: deleteArgs.deletedRecords,\n              promise: promise,\n              editParams: editParams\n            };\n            this.refreshData(crudArgs);\n          }\n        });\n      }\n    }\n  }\n\n  processOccurrences(eventData, action) {\n    let occurrenceData = [];\n    let isDeletedRecords = false;\n\n    if (eventData instanceof Array) {\n      for (const event of eventData) {\n        occurrenceData.push({\n          occurrence: event,\n          parent: this.getParentEvent(event)\n        });\n      }\n    } else {\n      occurrenceData = {\n        occurrence: eventData,\n        parent: this.getParentEvent(eventData)\n      };\n    }\n\n    const updateEvents = eventData instanceof Array ? eventData : [eventData];\n    const args = {\n      requestType: action === 'EditOccurrence' ? 'eventChange' : 'eventRemove',\n      cancel: false,\n      addedRecords: [],\n      changedRecords: updateEvents,\n      deletedRecords: []\n    };\n    args.data = occurrenceData;\n    this.parent.trigger(actionBegin, args, occurrenceArgs => {\n      if (!occurrenceArgs.cancel) {\n        const fields = this.parent.eventFields;\n        const editParams = {\n          addedRecords: [],\n          changedRecords: [],\n          deletedRecords: []\n        };\n        const occurrenceEvents = occurrenceData instanceof Array ? occurrenceData : [occurrenceData];\n\n        for (let a = 0, count = occurrenceArgs.changedRecords.length; a < count; a++) {\n          const childEvent = occurrenceArgs.changedRecords[a];\n          const parentEvent = occurrenceEvents[a].parent;\n          const parentException = parentEvent[fields.recurrenceException];\n          let editedData;\n          let exceptionDate;\n\n          switch (action) {\n            case 'EditOccurrence':\n              editedData = this.parent.eventsProcessed.filter(event => event.Guid === childEvent.Guid)[0];\n              exceptionDate = this.excludeDateCheck(editedData[fields.startTime], parentException);\n\n              if (exceptionDate !== parentEvent[fields.recurrenceException]) {\n                parentEvent[fields.recurrenceException] = exceptionDate;\n                childEvent[fields.recurrenceException] = getRecurrenceStringFromDate(editedData[fields.startTime]);\n                childEvent[fields.recurrenceID] = parentEvent[fields.id];\n                childEvent[fields.followingID] = null;\n                editParams.changedRecords.push(this.parent.eventBase.processTimezone(parentEvent, true));\n                editParams.addedRecords.push(this.parent.eventBase.processTimezone(childEvent, true));\n              } else {\n                editParams.changedRecords.push(this.parent.eventBase.processTimezone(childEvent, true));\n              }\n\n              break;\n\n            case 'DeleteOccurrence':\n              if (!childEvent[fields.recurrenceException]) {\n                parentEvent[fields.recurrenceException] = this.excludeDateCheck(childEvent[fields.startTime], parentException);\n                editParams.changedRecords.push(this.parent.eventBase.processTimezone(parentEvent, true));\n              }\n\n              if (childEvent[fields.id] !== parentEvent[fields.id]) {\n                editParams.deletedRecords.push(childEvent);\n                isDeletedRecords = true;\n              }\n\n              break;\n          }\n        }\n\n        const promise = this.parent.dataModule.dataManager.saveChanges(editParams, fields.id, this.getTable(), this.getQuery());\n        this.parent.eventBase.selectWorkCellByTime(occurrenceArgs.changedRecords);\n        const crudArgs = {\n          requestType: action === 'EditOccurrence' ? 'eventChanged' : 'eventRemoved',\n          cancel: false,\n          data: isDeletedRecords ? occurrenceArgs.deletedRecords : occurrenceArgs.changedRecords,\n          promise: promise,\n          editParams: editParams\n        };\n        this.refreshData(crudArgs);\n      }\n    });\n  }\n\n  processFollowSeries(eventData, action) {\n    let followData = [];\n\n    if (eventData instanceof Array) {\n      for (const event of eventData) {\n        followData.push({\n          occurrence: event,\n          parent: this.getParentEvent(event)\n        });\n      }\n    } else {\n      followData = {\n        occurrence: eventData,\n        parent: this.getParentEvent(eventData)\n      };\n    }\n\n    const updateFollowEvents = eventData instanceof Array ? eventData : [eventData];\n    const args = {\n      requestType: action === 'EditFollowingEvents' ? 'eventChange' : 'eventRemove',\n      cancel: false,\n      addedRecords: [],\n      changedRecords: updateFollowEvents,\n      deletedRecords: []\n    };\n    args.data = followData;\n    this.parent.trigger(actionBegin, args, followArgs => {\n      if (!followArgs.cancel) {\n        const fields = this.parent.eventFields;\n        const editParams = {\n          addedRecords: [],\n          changedRecords: [],\n          deletedRecords: []\n        };\n        const followEvents = followData instanceof Array ? followData : [followData];\n\n        for (let a = 0, count = followArgs.changedRecords.length; a < count; a++) {\n          const childEvent = followArgs.changedRecords[a];\n          const parentEvent = followEvents[a].parent;\n          const followData = this.parent.eventBase.getEventCollections(parentEvent, childEvent);\n          let isSpanned;\n\n          switch (action) {\n            case 'EditFollowingEvents':\n              this.processRecurrenceRule(parentEvent, childEvent);\n              isSpanned = !this.parent.eventBase.isFollowingEvent(parentEvent, childEvent);\n              childEvent[fields.followingID] = isSpanned ? null : parentEvent[fields.id];\n              childEvent[fields.recurrenceID] = null;\n              editParams.addedRecords.push(this.parent.eventBase.processTimezone(childEvent, true));\n              editParams.changedRecords.push(this.parent.eventBase.processTimezone(parentEvent, true));\n\n              if (!this.parent.uiStateValues.isIgnoreOccurrence) {\n                childEvent[fields.recurrenceException] = null;\n\n                if (followData.occurrence.length > 0) {\n                  const rule = followData.occurrence.slice(-1)[0][fields.recurrenceRule];\n\n                  if (rule.indexOf('COUNT') === -1) {\n                    childEvent[fields.recurrenceRule] = rule;\n                  }\n                }\n\n                if (followData.follow.length > 0) {\n                  childEvent[fields.recurrenceRule] = followData.follow.slice(-1)[0][fields.recurrenceRule];\n                  editParams.deletedRecords = editParams.deletedRecords.concat(followData.follow);\n                }\n\n                if (isSpanned) {\n                  followData.occurrence = followData.occurrence.filter(eventObj => eventObj[fields.recurrenceID] === childEvent[fields.id]);\n                }\n\n                editParams.deletedRecords = editParams.deletedRecords.concat(followData.occurrence);\n              }\n\n              break;\n\n            case 'DeleteFollowingEvents':\n              this.processRecurrenceRule(parentEvent, childEvent[fields.startTime]);\n              editParams.changedRecords.push(this.parent.eventBase.processTimezone(parentEvent, true));\n              editParams.deletedRecords = editParams.deletedRecords.concat(followData.occurrence).concat(followData.follow);\n              break;\n          }\n        }\n\n        const promise = this.parent.dataModule.dataManager.saveChanges(editParams, fields.id, this.getTable(), this.getQuery());\n        this.parent.eventBase.selectWorkCellByTime(followArgs.changedRecords);\n        const crudArgs = {\n          requestType: action === 'EditFollowingEvents' ? 'eventChanged' : 'eventRemoved',\n          cancel: false,\n          data: followArgs.changedRecords,\n          promise: promise,\n          editParams: editParams\n        };\n        this.refreshData(crudArgs);\n      }\n    });\n  }\n\n  processEntireSeries(eventData, action) {\n    let seriesData = [];\n    let isDeletedRecords = false;\n\n    if (eventData instanceof Array) {\n      for (const event of eventData) {\n        seriesData.push(this.getParentEvent(event, true));\n      }\n    } else {\n      seriesData = this.getParentEvent(eventData, true);\n    }\n\n    const updateSeriesEvents = eventData instanceof Array ? eventData : [eventData];\n    const args = {\n      requestType: action === 'EditSeries' ? 'eventChange' : 'eventRemove',\n      cancel: false,\n      addedRecords: [],\n      changedRecords: updateSeriesEvents,\n      deletedRecords: []\n    };\n    args.data = seriesData;\n    this.parent.trigger(actionBegin, args, seriesArgs => {\n      if (!seriesArgs.cancel) {\n        const fields = this.parent.eventFields;\n        const editParams = {\n          addedRecords: [],\n          changedRecords: [],\n          deletedRecords: []\n        };\n        const seriesEvents = seriesData instanceof Array ? seriesData : [seriesData];\n\n        for (let a = 0, count = seriesArgs.changedRecords.length; a < count; a++) {\n          const childEvent = seriesArgs.changedRecords[a];\n          const parentEvent = seriesEvents[a];\n          const eventCollections = this.parent.eventBase.getEventCollections(parentEvent);\n          const deletedEvents = eventCollections.follow.concat(eventCollections.occurrence);\n\n          switch (action) {\n            case 'EditSeries':\n              if (childEvent[fields.startTime] > parentEvent[fields.startTime] && childEvent[fields.recurrenceRule]) {\n                this.processRecurrenceRule(parentEvent, childEvent);\n              }\n\n              childEvent[fields.id] = parentEvent[fields.id];\n              childEvent[fields.recurrenceID] = null;\n              childEvent[fields.followingID] = null;\n\n              if (this.parent.uiStateValues.isIgnoreOccurrence && childEvent[fields.recurrenceException]) {\n                const originalParent = this.parent.eventsData.filter(eventObj => eventObj[fields.id] === childEvent[fields.id]);\n\n                if (originalParent.length > 0) {\n                  childEvent[fields.recurrenceRule] = originalParent[0][fields.recurrenceRule];\n                }\n              } else {\n                childEvent[fields.recurrenceException] = null;\n                editParams.deletedRecords = editParams.deletedRecords.concat(deletedEvents);\n              }\n\n              editParams.changedRecords.push(this.parent.eventBase.processTimezone(childEvent, true));\n              this.parent.uiStateValues.isIgnoreOccurrence = false;\n              break;\n\n            case 'DeleteSeries':\n              editParams.deletedRecords = editParams.deletedRecords.concat(deletedEvents.concat(parentEvent));\n              isDeletedRecords = true;\n              break;\n          }\n        }\n\n        const promise = this.parent.dataModule.dataManager.saveChanges(editParams, fields.id, this.getTable(), this.getQuery());\n        this.parent.eventBase.selectWorkCellByTime(seriesArgs.changedRecords);\n        const crudArgs = {\n          requestType: action === 'EditSeries' ? 'eventChanged' : 'eventRemoved',\n          cancel: false,\n          data: isDeletedRecords ? seriesArgs.deletedRecords : seriesArgs.changedRecords,\n          promise: promise,\n          editParams: editParams\n        };\n        this.refreshData(crudArgs);\n      }\n    });\n  }\n\n  processDelete(eventData) {\n    const deleteData = [];\n\n    for (const eventObj of eventData) {\n      if (eventObj[this.parent.eventFields.recurrenceRule]) {\n        deleteData.push({\n          occurrence: eventObj,\n          parent: this.getParentEvent(eventObj)\n        });\n      } else {\n        deleteData.push(eventObj);\n      }\n    }\n\n    const args = {\n      requestType: 'eventRemove',\n      cancel: false,\n      addedRecords: [],\n      changedRecords: [],\n      deletedRecords: eventData\n    };\n    args.data = deleteData;\n    this.parent.trigger(actionBegin, args, deleteArgs => {\n      if (!deleteArgs.cancel) {\n        const fields = this.parent.eventFields;\n        const editParams = {\n          addedRecords: [],\n          changedRecords: [],\n          deletedRecords: []\n        };\n\n        for (let a = 0, count = deleteArgs.deletedRecords.length; a < count; a++) {\n          let isDelete = isNullOrUndefined(deleteArgs.deletedRecords[a][this.parent.eventFields.recurrenceRule]);\n\n          if (!isDelete) {\n            const parentEvent = deleteData[a].parent;\n            const isEdited = editParams.changedRecords.filter(obj => obj[fields.id] === parentEvent[fields.id]);\n            const editedDate = deleteArgs.deletedRecords[a][fields.startTime];\n\n            if (isEdited.length > 0) {\n              const editedData = isEdited[0];\n              editedData[fields.recurrenceException] = this.excludeDateCheck(editedDate, editedData[fields.recurrenceException]);\n            } else {\n              parentEvent[fields.recurrenceException] = this.excludeDateCheck(editedDate, parentEvent[fields.recurrenceException]);\n            }\n\n            if (isEdited.length === 0) {\n              editParams.changedRecords.push(this.parent.eventBase.processTimezone(parentEvent, true));\n            }\n\n            isDelete = deleteArgs.deletedRecords[a][fields.id] !== parentEvent[fields.id];\n          }\n\n          if (isDelete) {\n            editParams.deletedRecords.push(deleteArgs.deletedRecords[a]);\n          }\n        }\n\n        const promise = this.parent.dataModule.dataManager.saveChanges(editParams, fields.id, this.getTable(), this.getQuery());\n        const crudArgs = {\n          requestType: 'eventRemoved',\n          cancel: false,\n          data: deleteArgs.deletedRecords,\n          promise: promise,\n          editParams: editParams\n        };\n        this.refreshData(crudArgs);\n      }\n    });\n  }\n\n  processSave(data) {\n    const eventData = data instanceof Array ? data : [data];\n    const editData = [];\n\n    for (const eventObj of eventData) {\n      if (eventObj[this.parent.eventFields.recurrenceRule]) {\n        editData.push({\n          occurrence: eventObj,\n          parent: this.getParentEvent(eventObj)\n        });\n      } else {\n        editData.push(eventObj);\n      }\n    }\n\n    const args = {\n      requestType: 'eventChange',\n      cancel: false,\n      addedRecords: [],\n      changedRecords: eventData,\n      deletedRecords: []\n    };\n    args.data = editData;\n    this.parent.trigger(actionBegin, args, editArgs => {\n      if (!editArgs.cancel) {\n        const fields = this.parent.eventFields;\n        const editParams = {\n          addedRecords: [],\n          changedRecords: [],\n          deletedRecords: []\n        };\n\n        for (const record of editArgs.changedRecords) {\n          if (!isNullOrUndefined(record[fields.recurrenceRule]) && isNullOrUndefined(record[fields.recurrenceException])) {\n            const exceptionString = getRecurrenceStringFromDate(record[fields.startTime]);\n            const parentEle = this.getParentEvent(record);\n            parentEle[fields.recurrenceException] = isNullOrUndefined(parentEle[fields.recurrenceException]) ? exceptionString : parentEle[fields.recurrenceException].concat(',' + exceptionString);\n            record[fields.id] = this.parent.getEventMaxID();\n            record[fields.recurrenceException] = exceptionString;\n            editParams.addedRecords.push(this.parent.eventBase.processTimezone(record, true));\n            editParams.changedRecords.push(this.parent.eventBase.processTimezone(parentEle, true));\n          } else {\n            editParams.changedRecords.push(this.parent.eventBase.processTimezone(record, true));\n          }\n        }\n\n        const promise = this.parent.dataModule.dataManager.saveChanges(editParams, fields.id, this.getTable(), this.getQuery());\n        const crudArgs = {\n          requestType: 'eventChanged',\n          cancel: false,\n          data: editArgs.changedRecords,\n          promise: promise,\n          editParams: editParams\n        };\n        this.refreshData(crudArgs);\n      }\n    });\n  }\n\n  getParentEvent(event, isParent = false) {\n    const parentEvent = this.parent.eventBase.getParentEvent(event, isParent) || event;\n\n    if (parentEvent[this.parent.eventFields.startTimezone] || parentEvent[this.parent.eventFields.endTimezone]) {\n      this.parent.eventBase.timezoneConvert(parentEvent);\n    }\n\n    return parentEvent;\n  }\n\n  excludeDateCheck(eventStartTime, exceptionDateList) {\n    const exDate = getRecurrenceStringFromDate(eventStartTime);\n\n    if (!isNullOrUndefined(exceptionDateList)) {\n      if (exceptionDateList.indexOf(exDate) === -1) {\n        exceptionDateList = !isNullOrUndefined(exceptionDateList) ? exceptionDateList + ',' + exDate : exDate;\n      }\n    } else {\n      exceptionDateList = exDate;\n    }\n\n    return exceptionDateList;\n  }\n\n  processRecurrenceRule(parentEvent, followEvent) {\n    const fields = this.parent.eventFields;\n    const recurrenceRule = parentEvent[fields.recurrenceRule];\n    let endDate;\n\n    if (followEvent instanceof Date) {\n      endDate = new Date(+followEvent);\n    } else {\n      endDate = new Date(+followEvent[fields.startTime]);\n      const newRecurrenceRule = followEvent[fields.recurrenceRule];\n\n      if (newRecurrenceRule) {\n        const startDate = parentEvent[fields.startTime];\n        const ruleException = this.parent.currentAction === 'DeleteFollowingEvents' ? followEvent[fields.recurrenceException] : null;\n        const dateCollection = generate(startDate, newRecurrenceRule, ruleException, this.parent.activeViewOptions.firstDayOfWeek);\n        const untilDate = new Date(dateCollection.slice(-1)[0]);\n        untilDate.setHours(endDate.getHours(), endDate.getMinutes(), endDate.getSeconds());\n        endDate.setHours(startDate.getHours(), startDate.getMinutes(), startDate.getSeconds());\n        followEvent[fields.recurrenceRule] = this.getUpdatedRecurrenceRule(newRecurrenceRule, new Date(+untilDate), false);\n      }\n    }\n\n    parentEvent[fields.recurrenceRule] = this.getUpdatedRecurrenceRule(recurrenceRule, addDays(new Date(endDate.getTime()), -1), true);\n  }\n\n  getUpdatedRecurrenceRule(recurrenceRule, untilDate, isParent) {\n    const splitRule = recurrenceRule.split(';');\n    let updatedRule = '';\n\n    for (let rule of splitRule) {\n      if (rule !== '') {\n        const ruleKey = rule.split('=')[0];\n        let ruleValue = rule.split('=')[1];\n\n        if (ruleKey === 'COUNT' || ruleKey === 'UNTIL') {\n          ruleValue = getRecurrenceStringFromDate(untilDate);\n          rule = rule.replace(rule, 'UNTIL=' + ruleValue);\n        }\n\n        updatedRule += rule + ';';\n      }\n    }\n\n    if (isParent && updatedRule.indexOf('UNTIL') === -1) {\n      updatedRule += 'UNTIL=' + getRecurrenceStringFromDate(untilDate);\n    }\n\n    return updatedRule;\n  }\n\n  isBlockEvent(eventData) {\n    const eventCollection = eventData instanceof Array ? eventData : [eventData];\n    let value = false;\n\n    for (const event of eventCollection) {\n      value = event[this.parent.eventFields.isBlock] || false;\n    }\n\n    return value;\n  }\n  /**\n   * To destroy the crud module.\n   *\n   * @returns {void}\n   * @private\n   */\n\n\n  destroy() {\n    this.crudObj = null;\n    this.parent = null;\n  }\n\n}\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\n/**\n * Work cell interactions\n */\n\n\nclass WorkCellInteraction {\n  constructor(parent) {\n    this.parent = parent;\n    EventHandler.add(this.parent.element, 'mouseover', this.onHover, this);\n  }\n\n  cellMouseDown(e) {\n    if (this.isPreventAction(e)) {\n      return;\n    }\n\n    this.parent.notify(cellMouseDown, {\n      event: e\n    });\n  }\n\n  cellClick(e) {\n    if (this.isPreventAction(e)) {\n      return;\n    }\n\n    const queryStr = '.' + WORK_CELLS_CLASS + ',.' + ALLDAY_CELLS_CLASS + ',.' + HEADER_CELLS_CLASS;\n    const target = closest(e.target, queryStr);\n\n    if (isNullOrUndefined(target)) {\n      return;\n    }\n\n    if (!isNullOrUndefined(closest(e.target, '.' + NEW_EVENT_CLASS))) {\n      this.parent.eventWindow.openEditor(this.parent.activeCellsData, 'Add');\n      return;\n    }\n\n    const navigateEle = closest(e.target, '.' + NAVIGATE_CLASS);\n    const navigateView = this.parent.getNavigateView();\n    const sameView = this.parent.currentView === navigateView;\n\n    if (isNullOrUndefined(navigateEle) || sameView || isNullOrUndefined(this.parent.viewOptions[navigateView.charAt(0).toLowerCase() + navigateView.slice(1)])) {\n      if (this.parent.activeViewOptions.readonly && this.parent.currentView !== 'MonthAgenda') {\n        if (this.parent.quickPopup) {\n          this.parent.quickPopup.quickPopupHide();\n        }\n\n        return;\n      }\n\n      if (this.parent.isAdaptive && (e.target.classList.contains(MORE_INDICATOR_CLASS) || closest(e.target, '.' + MORE_INDICATOR_CLASS))) {\n        return;\n      }\n\n      const isWorkCell = target.classList.contains(WORK_CELLS_CLASS) || target.classList.contains(ALLDAY_CELLS_CLASS);\n\n      if (isWorkCell && e.shiftKey && e.which === 1 && this.parent.keyboardInteractionModule) {\n        this.parent.keyboardInteractionModule.onMouseSelection(e);\n        return;\n      }\n\n      this.parent.activeCellsData = this.parent.getCellDetails(target);\n      const args = extend(this.parent.activeCellsData, {\n        cancel: false,\n        event: e,\n        name: 'cellClick'\n      });\n      this.parent.trigger(cellClick, args, clickArgs => {\n        if (!clickArgs.cancel) {\n          if (isWorkCell) {\n            this.parent.selectCell(target);\n          }\n\n          if (this.parent.allowInline) {\n            const inlineArgs = {\n              element: clickArgs.element,\n              groupIndex: clickArgs.groupIndex,\n              type: 'Cell'\n            };\n            this.parent.notify(inlineClick, inlineArgs);\n          } else {\n            this.parent.notify(cellClick, clickArgs);\n          }\n        } else {\n          if (this.parent.quickPopup) {\n            this.parent.quickPopup.quickPopupHide();\n          }\n        }\n      });\n    } else {\n      const date = this.parent.getDateFromElement(target);\n\n      if (!isNullOrUndefined(date) && !this.parent.isAdaptive && this.parent.isMinMaxDate(date)) {\n        this.parent.setProperties({\n          selectedDate: date\n        }, true);\n        this.parent.changeView(this.parent.getNavigateView(), e);\n      }\n    }\n  }\n\n  cellDblClick(e) {\n    const queryStr = '.' + WORK_CELLS_CLASS + ',.' + ALLDAY_CELLS_CLASS + ',.' + HEADER_CELLS_CLASS;\n    const target = closest(e.target, queryStr);\n\n    if (this.parent.activeViewOptions.readonly || this.isPreventAction(e) || isNullOrUndefined(target)) {\n      return;\n    }\n\n    const args = extend(this.parent.activeCellsData, {\n      cancel: false,\n      event: e,\n      name: 'cellDoubleClick'\n    });\n    this.parent.trigger(cellDoubleClick, args, clickArgs => {\n      const date = new Date(clickArgs.startTime.getTime());\n\n      if (!this.parent.isMinMaxDate(new Date(date.setHours(0, 0, 0, 0)))) {\n        return;\n      }\n\n      if (!clickArgs.cancel) {\n        this.parent.eventWindow.openEditor(this.parent.activeCellsData, 'Add');\n      }\n    });\n  }\n\n  onHover(e) {\n    const targetSelector = '.' + WORK_CELLS_CLASS + ',.' + TIME_SLOT_CLASS + ',.' + ALLDAY_CELLS_CLASS + ',.' + HEADER_CELLS_CLASS + ',.' + RESOURCE_CELLS_CLASS + ',.' + APPOINTMENT_CLASS + ',.' + WEEK_NUMBER_CLASS + ',.' + MONTH_HEADER_CLASS;\n    const hoverTarget = closest(e.target, targetSelector);\n\n    if (hoverTarget) {\n      const hoverArgs = {\n        element: hoverTarget,\n        event: e\n      };\n      this.parent.trigger(hover, hoverArgs);\n    }\n  }\n\n  isPreventAction(e) {\n    if (closest(e.target, '.' + NAVIGATE_CLASS)) {\n      return false;\n    }\n\n    if (closest(e.target, '.' + APPOINTMENT_WRAPPER_CLASS) && !closest(e.target, '.' + MORE_INDICATOR_CLASS)) {\n      return true;\n    }\n\n    let target = closest(e.target, '.' + APPOINTMENT_CLASS + ',.' + RESOURCE_GROUP_CELLS_CLASS);\n\n    if (!isNullOrUndefined(target)) {\n      return true;\n    }\n\n    target = closest(e.target, '.' + HEADER_CELLS_CLASS);\n\n    if (this.parent.activeView.isTimelineView() && !isNullOrUndefined(target)) {\n      return true;\n    }\n\n    return false;\n  }\n\n  destroy() {\n    EventHandler.remove(this.parent.element, 'mouseover', this.onHover);\n  }\n\n}\n\nvar __decorate$8 = undefined && undefined.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\n/**\n * Configuration that applies on each appointment field options of scheduler.\n */\n\n\nclass FieldOptions extends ChildProperty {}\n\n__decorate$8([Property()], FieldOptions.prototype, \"name\", void 0);\n\n__decorate$8([Property()], FieldOptions.prototype, \"default\", void 0);\n\n__decorate$8([Property()], FieldOptions.prototype, \"title\", void 0);\n\n__decorate$8([Property({})], FieldOptions.prototype, \"validation\", void 0);\n\nvar __decorate$7 = undefined && undefined.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n/**\n * A Class that holds the collection of event fields that requires to be mapped with the dataSource\n * fields along with its available configuration settings. Each field in it accepts both string and Object\n *  data type. When each of the field is assigned with simple `string` value, it is assumed that the dataSource field\n *  name is mapped with it. If the `object` type is defined on each fields, then the validation related settings and mapping of\n *  those fields with dataSource can be given altogether within it.\n */\n\n\nclass Field extends ChildProperty {}\n\n__decorate$7([Property('Id')], Field.prototype, \"id\", void 0);\n\n__decorate$7([Property('IsBlock')], Field.prototype, \"isBlock\", void 0);\n\n__decorate$7([Complex({\n  name: 'Subject'\n}, FieldOptions)], Field.prototype, \"subject\", void 0);\n\n__decorate$7([Complex({\n  name: 'StartTime'\n}, FieldOptions)], Field.prototype, \"startTime\", void 0);\n\n__decorate$7([Complex({\n  name: 'EndTime'\n}, FieldOptions)], Field.prototype, \"endTime\", void 0);\n\n__decorate$7([Complex({\n  name: 'StartTimezone'\n}, FieldOptions)], Field.prototype, \"startTimezone\", void 0);\n\n__decorate$7([Complex({\n  name: 'EndTimezone'\n}, FieldOptions)], Field.prototype, \"endTimezone\", void 0);\n\n__decorate$7([Complex({\n  name: 'Location'\n}, FieldOptions)], Field.prototype, \"location\", void 0);\n\n__decorate$7([Complex({\n  name: 'Description'\n}, FieldOptions)], Field.prototype, \"description\", void 0);\n\n__decorate$7([Complex({\n  name: 'IsAllDay'\n}, FieldOptions)], Field.prototype, \"isAllDay\", void 0);\n\n__decorate$7([Complex({\n  name: 'RecurrenceID'\n}, FieldOptions)], Field.prototype, \"recurrenceID\", void 0);\n\n__decorate$7([Complex({\n  name: 'RecurrenceRule'\n}, FieldOptions)], Field.prototype, \"recurrenceRule\", void 0);\n\n__decorate$7([Complex({\n  name: 'RecurrenceException'\n}, FieldOptions)], Field.prototype, \"recurrenceException\", void 0);\n\n__decorate$7([Property('IsReadonly')], Field.prototype, \"isReadonly\", void 0);\n\n__decorate$7([Property('FollowingID')], Field.prototype, \"followingID\", void 0);\n\nvar __decorate$6 = undefined && undefined.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\n/**\n * Holds the configuration of event related options and dataSource binding to Schedule.\n */\n\n\nclass EventSettings extends ChildProperty {}\n\n__decorate$6([Property()], EventSettings.prototype, \"template\", void 0);\n\n__decorate$6([Property([])], EventSettings.prototype, \"dataSource\", void 0);\n\n__decorate$6([Property()], EventSettings.prototype, \"query\", void 0);\n\n__decorate$6([Complex({}, Field)], EventSettings.prototype, \"fields\", void 0);\n\n__decorate$6([Property(false)], EventSettings.prototype, \"enableTooltip\", void 0);\n\n__decorate$6([Property('AllDayRow')], EventSettings.prototype, \"spannedEventPlacement\", void 0);\n\n__decorate$6([Property(1)], EventSettings.prototype, \"minimumEventDuration\", void 0);\n\n__decorate$6([Property()], EventSettings.prototype, \"tooltipTemplate\", void 0);\n\n__decorate$6([Property()], EventSettings.prototype, \"resourceColorField\", void 0);\n\n__decorate$6([Property(false)], EventSettings.prototype, \"editFollowingEvents\", void 0);\n\n__decorate$6([Property(true)], EventSettings.prototype, \"allowAdding\", void 0);\n\n__decorate$6([Property(true)], EventSettings.prototype, \"allowEditing\", void 0);\n\n__decorate$6([Property(true)], EventSettings.prototype, \"allowDeleting\", void 0);\n\n__decorate$6([Property(false)], EventSettings.prototype, \"enableMaxHeight\", void 0);\n\n__decorate$6([Property(false)], EventSettings.prototype, \"enableIndicator\", void 0);\n\n__decorate$6([Property(false)], EventSettings.prototype, \"ignoreWhitespace\", void 0);\n\n__decorate$6([Property()], EventSettings.prototype, \"sortComparer\", void 0);\n\nvar __decorate$9 = undefined && undefined.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n/**\n * A class that holds the resource grouping related configurations on Schedule.\n */\n\n\nclass Group extends ChildProperty {}\n\n__decorate$9([Property(false)], Group.prototype, \"byDate\", void 0);\n\n__decorate$9([Property(true)], Group.prototype, \"byGroupID\", void 0);\n\n__decorate$9([Property(false)], Group.prototype, \"allowGroupEdit\", void 0);\n\n__decorate$9([Property([])], Group.prototype, \"resources\", void 0);\n\n__decorate$9([Property(true)], Group.prototype, \"enableCompactView\", void 0);\n\n__decorate$9([Property()], Group.prototype, \"headerTooltipTemplate\", void 0);\n\nvar __decorate$10 = undefined && undefined.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\n/**\n * A class that represents the resource related configurations and its data binding options.\n */\n\n\nclass Resources extends ChildProperty {}\n\n__decorate$10([Property()], Resources.prototype, \"field\", void 0);\n\n__decorate$10([Property()], Resources.prototype, \"title\", void 0);\n\n__decorate$10([Property()], Resources.prototype, \"name\", void 0);\n\n__decorate$10([Property(false)], Resources.prototype, \"allowMultiple\", void 0);\n\n__decorate$10([Property([])], Resources.prototype, \"dataSource\", void 0);\n\n__decorate$10([Property()], Resources.prototype, \"query\", void 0);\n\n__decorate$10([Property('Id')], Resources.prototype, \"idField\", void 0);\n\n__decorate$10([Property('Text')], Resources.prototype, \"textField\", void 0);\n\n__decorate$10([Property('Expanded')], Resources.prototype, \"expandedField\", void 0);\n\n__decorate$10([Property('GroupID')], Resources.prototype, \"groupIDField\", void 0);\n\n__decorate$10([Property('Color')], Resources.prototype, \"colorField\", void 0);\n\n__decorate$10([Property('StartHour')], Resources.prototype, \"startHourField\", void 0);\n\n__decorate$10([Property('EndHour')], Resources.prototype, \"endHourField\", void 0);\n\n__decorate$10([Property('WorkDays')], Resources.prototype, \"workDaysField\", void 0);\n\n__decorate$10([Property('CssClass')], Resources.prototype, \"cssClassField\", void 0);\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\n/* eslint-disable max-len */\n\n\nclass ResourceBase {\n  constructor(parent) {\n    this.resourceCollection = [];\n    this.leftPixel = 25;\n    this.parent = parent;\n  }\n\n  renderResourceHeaderIndent(tr) {\n    const resColTd = createElement('td', {\n      className: RESOURCE_LEFT_TD_CLASS\n    });\n    const resColDiv = createElement('div', {\n      className: RESOURCE_TEXT_CLASS\n    });\n\n    if (this.parent.activeViewOptions.headerIndentTemplate) {\n      const data = {\n        className: [resColTd.className],\n        type: 'emptyCells'\n      };\n      this.parent.renderHeaderIndentTemplate(data, resColTd);\n    } else {\n      resColTd.appendChild(resColDiv);\n    }\n\n    const args = {\n      elementType: 'emptyCells',\n      element: resColTd\n    };\n    this.parent.trigger(renderCell, args);\n    tr.appendChild(resColTd);\n  }\n\n  hideResourceRows(tBody) {\n    if (this.resourceCollection.length <= 1 || this.parent.virtualScrollModule) {\n      return;\n    }\n\n    const trCount = this.lastResourceLevel.length;\n\n    for (let i = 0; i < trCount; i++) {\n      const resData = this.lastResourceLevel[i].resourceData;\n      const res = this.lastResourceLevel[i].resource;\n\n      if (resData.ClassName === RESOURCE_PARENT_CLASS && !resData[res.expandedField] && !isNullOrUndefined(resData[res.expandedField])) {\n        const trCollection = [].slice.call(tBody.children);\n        const slicedCollection = trCollection.slice(i + 1, i + (parseInt(resData.Count, 10) + 1));\n        addClass(slicedCollection, HIDDEN_CLASS);\n      }\n    }\n  }\n\n  createResourceColumn() {\n    const resColl = this.resourceCollection;\n    const resDiv = createElement('div', {\n      className: RESOURCE_COLUMN_WRAP_CLASS\n    });\n    const tbl = this.parent.activeView.createTableLayout(RESOURCE_COLUMN_TABLE_CLASS);\n\n    if (!this.parent.uiStateValues.isGroupAdaptive && this.parent.rowAutoHeight && this.parent.activeView.isTimelineView() && this.parent.activeViewOptions.group.resources.length > 0) {\n      addClass([tbl], AUTO_HEIGHT);\n    }\n\n    const tBody = tbl.querySelector('tbody');\n    let resData = this.generateTreeData(true);\n    this.countCalculation(resColl.slice(0, -2), resColl.slice(0, -1));\n    this.renderedResources = this.lastResourceLevel;\n\n    if (this.parent.virtualScrollModule) {\n      const resourceCount = this.parent.virtualScrollModule.getRenderedCount();\n      this.setExpandedResources();\n      resData = this.expandedResources.slice(0, resourceCount);\n      this.renderedResources = resData;\n    }\n\n    append(this.getContentRows(resData), tBody);\n    this.hideResourceRows(tBody);\n    tbl.appendChild(tBody);\n    resDiv.appendChild(tbl);\n    return resDiv;\n  }\n\n  setRenderedResources() {\n    const resColl = this.resourceCollection; // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n    const temp = this.generateTreeData(true);\n    this.countCalculation(resColl.slice(0, -2), resColl.slice(0, -1));\n    this.renderedResources = this.lastResourceLevel;\n  }\n\n  setExpandedResources() {\n    const resources = [];\n\n    for (let i = 0; i < this.lastResourceLevel.length; i++) {\n      const resource = this.lastResourceLevel[i].resourceData;\n      const count = resource.Count;\n      resources.push(this.lastResourceLevel[i]);\n      const isExpanded = resource[this.lastResourceLevel[i].resource.expandedField];\n\n      if (!isNullOrUndefined(isExpanded) && !isExpanded && count > 0) {\n        i = i + count;\n      }\n    }\n\n    this.expandedResources = resources;\n  }\n\n  getContentRows(resData, isVirtualScroll) {\n    const resRows = [];\n    let left;\n    let rIndex;\n    const resColl = this.resourceCollection;\n    const tr = createElement('tr');\n    const td = createElement('td', {\n      attrs: {\n        tabindex: isVirtualScroll ? '-1' : '0'\n      }\n    });\n\n    for (let i = 0; i < resData.length; i++) {\n      const ntd = td.cloneNode();\n      rIndex = findIndexInData(resColl, 'name', resData[i].resource.name);\n\n      if (rIndex === resColl.length - 1) {\n        extend(resData[i].resourceData, {\n          ClassName: RESOURCE_CHILD_CLASS\n        });\n        this.renderedResources[i].className = [RESOURCE_CHILD_CLASS];\n      } else {\n        extend(resData[i].resourceData, {\n          ClassName: RESOURCE_PARENT_CLASS\n        });\n        this.renderedResources[i].className = [RESOURCE_PARENT_CLASS];\n      }\n\n      left = rIndex * this.leftPixel + 'px';\n\n      if (resData[i].resourceData.ClassName === RESOURCE_PARENT_CLASS && !isNullOrUndefined(resData[i].resourceData.Count) && resData[i].resourceData.Count > 0) {\n        let iconClass;\n\n        if (resData[i].resourceData[resColl[rIndex].expandedField] || isNullOrUndefined(resData[i].resourceData[resColl[rIndex].expandedField])) {\n          iconClass = RESOURCE_COLLAPSE_CLASS;\n        } else {\n          iconClass = RESOURCE_EXPAND_CLASS;\n        }\n\n        const iconDiv = createElement('div');\n        addClass([iconDiv], [RESOURCE_TREE_ICON_CLASS, iconClass]);\n        this.setMargin(iconDiv, left);\n        ntd.appendChild(iconDiv);\n\n        if (this.resourceCollection.length > 1) {\n          EventHandler.add(iconDiv, 'click', this.onTreeIconClick, this);\n        }\n      }\n\n      this.parent.activeView.setResourceHeaderContent(ntd, resData[i], RESOURCE_TEXT_CLASS);\n      ntd.setAttribute('data-group-index', resData[i].groupIndex.toString());\n      ntd.setAttribute('aria-label', resData[i].resourceData[resData[i].resource.textField] + ' resource');\n\n      if (!this.parent.activeViewOptions.resourceHeaderTemplate) {\n        this.setMargin(ntd.querySelector('.' + RESOURCE_TEXT_CLASS), left);\n      }\n\n      const classCollection = [RESOURCE_CELLS_CLASS, resData[i].resourceData.ClassName];\n      addClass([ntd], classCollection);\n      const args = {\n        elementType: 'resourceHeader',\n        element: ntd,\n        groupIndex: resData[i].groupIndex\n      };\n      this.parent.trigger(renderCell, args);\n      const ntr = tr.cloneNode();\n      ntr.appendChild(ntd);\n      resRows.push(ntr);\n    }\n\n    return resRows;\n  }\n\n  setMargin(element, value) {\n    if (!this.parent.enableRtl) {\n      element.style.marginLeft = value;\n    } else {\n      element.style.marginRight = value;\n    }\n  }\n\n  countCalculation(parentCollection, wholeCollection) {\n    let collection;\n\n    for (let y = 0; y < parentCollection.length; y++) {\n      const data = parentCollection[parentCollection.length - (y + 1)].dataSource;\n\n      for (let x = 0; x < data.length; x++) {\n        let totalCount = 0;\n\n        if (this.parent.activeViewOptions.group.byGroupID) {\n          const query = new Query().where(wholeCollection[wholeCollection.length - 1].groupIDField, 'equal', data[x][parentCollection[parentCollection.length - (y + 1)].idField]);\n          collection = new DataManager(wholeCollection[wholeCollection.length - 1].dataSource).executeLocal(query);\n        } else {\n          collection = wholeCollection[wholeCollection.length - 1].dataSource;\n        }\n\n        for (let z = 0; z < collection.length; z++) {\n          totalCount = totalCount + parseInt(collection[z].Count, 10);\n        }\n\n        totalCount = totalCount + parseInt(data[x].Count, 10);\n        extend(data[x], {\n          Count: totalCount\n        });\n      }\n\n      wholeCollection = wholeCollection.slice(0, -1);\n    }\n  }\n\n  onTreeIconClick(e) {\n    if (this.parent.eventTooltip) {\n      this.parent.eventTooltip.close();\n    }\n\n    const target = e.target;\n    let hide;\n    const trElement = closest(target, '.' + RESOURCE_PARENT_CLASS).parentElement;\n    const index = parseInt(trElement.children[0].getAttribute('data-group-index'), 10);\n    let args = {\n      cancel: false,\n      event: e,\n      groupIndex: index,\n      requestType: !target.classList.contains(RESOURCE_COLLAPSE_CLASS) ? 'resourceExpand' : 'resourceCollapse'\n    };\n    this.parent.trigger(actionBegin, args, actionArgs => {\n      if (!actionArgs.cancel) {\n        if (target.classList.contains(RESOURCE_COLLAPSE_CLASS)) {\n          classList(target, [RESOURCE_EXPAND_CLASS], [RESOURCE_COLLAPSE_CLASS]);\n          hide = true;\n        } else {\n          classList(target, [RESOURCE_COLLAPSE_CLASS], [RESOURCE_EXPAND_CLASS]);\n          hide = false;\n        }\n\n        const eventElements = [].slice.call(this.parent.element.querySelectorAll('.' + APPOINTMENT_CLASS));\n\n        for (const element of eventElements) {\n          remove(element);\n        }\n\n        if (this.parent.virtualScrollModule) {\n          this.updateVirtualContent(index, hide, e, target);\n        } else {\n          this.updateContent(index, hide);\n        }\n\n        const data = {\n          cssProperties: this.parent.getCssProperties(),\n          module: 'scroll'\n        };\n        this.parent.notify(scrollUiUpdate, data);\n        args = {\n          cancel: false,\n          event: e,\n          groupIndex: index,\n          requestType: target.classList.contains(RESOURCE_COLLAPSE_CLASS) ? 'resourceExpanded' : 'resourceCollapsed'\n        };\n        this.parent.refreshEvents(false);\n        this.parent.trigger(actionComplete, args);\n      }\n    });\n  }\n\n  updateContent(index, hide) {\n    const rowCollection = [];\n    const workCellCollection = [];\n    const headerRowCollection = [];\n    let pNode;\n    const clickedRes = this.lastResourceLevel[index].resourceData;\n    const resRows = [].slice.call(this.parent.element.querySelectorAll('.' + RESOURCE_COLUMN_WRAP_CLASS + ' ' + 'tr'));\n    const contentRows = [].slice.call(this.parent.element.querySelectorAll('.' + CONTENT_WRAP_CLASS + ' ' + 'tbody tr'));\n    const eventRows = [].slice.call(this.parent.element.querySelectorAll('.' + CONTENT_WRAP_CLASS + ' .' + APPOINTMENT_CONTAINER_CLASS));\n\n    for (let j = 0; j < clickedRes.Count; j++) {\n      rowCollection.push(resRows[index + j + 1]);\n      workCellCollection.push(contentRows[index + j + 1]);\n      headerRowCollection.push(eventRows[index + j + 1]);\n    }\n\n    const clonedCollection = this.lastResourceLevel;\n\n    for (let i = 0; i < rowCollection.length; i++) {\n      let expanded = true;\n      pNode = rowCollection[i].children[0].classList.contains(RESOURCE_PARENT_CLASS);\n      clonedCollection[index].resourceData[clonedCollection[index].resource.expandedField] = !hide;\n\n      if (hide) {\n        if (pNode) {\n          const trElem = rowCollection[i].querySelector('.' + RESOURCE_TREE_ICON_CLASS);\n\n          if (trElem) {\n            classList(trElem, [RESOURCE_EXPAND_CLASS], [RESOURCE_COLLAPSE_CLASS]);\n          }\n        }\n\n        if (!rowCollection[i].classList.contains(HIDDEN_CLASS)) {\n          addClass([rowCollection[i], workCellCollection[i], headerRowCollection[i]], HIDDEN_CLASS);\n        }\n      } else {\n        if (pNode) {\n          const rowIndex = rowCollection[i].rowIndex;\n\n          if (!clonedCollection[rowIndex].resourceData[clonedCollection[rowIndex].resource.expandedField] && !isNullOrUndefined(clonedCollection[rowIndex].resourceData[clonedCollection[rowIndex].resource.expandedField])) {\n            rowCollection.splice(i + 1, parseInt(clonedCollection[rowIndex].resourceData.Count, 10));\n            workCellCollection.splice(i + 1, parseInt(clonedCollection[rowIndex].resourceData.Count, 10));\n            headerRowCollection.splice(i + 1, parseInt(clonedCollection[rowIndex].resourceData.Count, 10));\n            expanded = false;\n          }\n\n          if (expanded) {\n            const trElem = rowCollection[i].querySelector('.' + RESOURCE_TREE_ICON_CLASS);\n\n            if (trElem) {\n              classList(trElem, [RESOURCE_COLLAPSE_CLASS], [RESOURCE_EXPAND_CLASS]);\n            }\n          }\n        }\n\n        if (rowCollection[i].classList.contains(HIDDEN_CLASS)) {\n          removeClass([rowCollection[i], workCellCollection[i], headerRowCollection[i]], HIDDEN_CLASS);\n        }\n      }\n    }\n  } // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  updateVirtualContent(index, expand, e, target) {\n    this.lastResourceLevel[index].resourceData[this.lastResourceLevel[index].resource.expandedField] = !expand;\n    this.setExpandedResources();\n    const resourceCount = this.parent.virtualScrollModule.getRenderedCount();\n    const startIndex = this.expandedResources.indexOf(this.renderedResources[0]);\n    this.renderedResources = this.expandedResources.slice(startIndex, startIndex + resourceCount);\n\n    if (this.renderedResources.length < resourceCount) {\n      let sIndex = this.expandedResources.length - resourceCount;\n      sIndex = sIndex > 0 ? sIndex : 0;\n      this.renderedResources = this.expandedResources.slice(sIndex, this.expandedResources.length);\n    }\n\n    const virtualTrack = this.parent.element.querySelector('.' + VIRTUAL_TRACK_CLASS);\n    this.parent.virtualScrollModule.updateVirtualTrackHeight(virtualTrack);\n    const resTable = this.parent.element.querySelector('.' + RESOURCE_COLUMN_WRAP_CLASS + ' ' + 'table');\n    const contentTable = this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS + ' ' + 'table');\n    const eventTable = this.parent.element.querySelector('.' + EVENT_TABLE_CLASS);\n    this.parent.virtualScrollModule.updateContent(resTable, contentTable, eventTable, this.renderedResources);\n    const timeIndicator = this.parent.element.querySelector('.' + CURRENT_TIMELINE_CLASS);\n\n    if (!isNullOrUndefined(timeIndicator)) {\n      timeIndicator.style.height = this.parent.element.querySelector('.' + CONTENT_TABLE_CLASS).offsetHeight + 'px';\n    }\n  }\n\n  renderResourceHeader() {\n    const resourceWrapper = createElement('div', {\n      className: RESOURCE_TOOLBAR_CONTAINER\n    });\n    resourceWrapper.innerHTML = '<div class=\"' + RESOURCE_HEADER_TOOLBAR + '\"><div class=\"' + RESOURCE_MENU + '\">' + '<div class=\"e-icons ' + RESOURCE_MENU_ICON + '\"></div></div><div class=\"' + RESOURCE_LEVEL_TITLE + '\"></div></div>';\n\n    if (this.parent.currentView === 'MonthAgenda') {\n      const target = this.parent.activeView.getPanel().querySelector('.' + CONTENT_WRAP_CLASS);\n      target.insertBefore(resourceWrapper, target.querySelector('.' + WRAPPER_CONTAINER_CLASS));\n    } else {\n      this.parent.element.insertBefore(resourceWrapper, this.parent.element.querySelector('.' + TABLE_CONTAINER_CLASS));\n    }\n\n    this.renderResourceHeaderText();\n    EventHandler.add(resourceWrapper.querySelector('.' + RESOURCE_MENU_ICON), 'click', this.menuClick, this);\n  }\n\n  renderResourceTree() {\n    this.popupOverlay = createElement('div', {\n      className: RESOURCE_TREE_POPUP_OVERLAY\n    });\n    const treeWrapper = createElement('div', {\n      className: RESOURCE_TREE_POPUP + ' e-popup-close'\n    });\n\n    if (this.parent.currentView === 'MonthAgenda') {\n      const target = this.parent.activeView.getPanel().querySelector('.' + WRAPPER_CONTAINER_CLASS);\n      target.insertBefore(treeWrapper, target.children[0]);\n      target.appendChild(this.popupOverlay);\n    } else {\n      this.parent.element.querySelector('.' + TABLE_CONTAINER_CLASS).appendChild(treeWrapper);\n      this.parent.element.querySelector('.' + TABLE_CONTAINER_CLASS).appendChild(this.popupOverlay);\n    }\n\n    const resourceTree = createElement('div', {\n      className: RESOURCE_TREE\n    });\n    treeWrapper.appendChild(resourceTree);\n    this.treeViewObj = new TreeView({\n      cssClass: this.parent.cssClass,\n      enableRtl: this.parent.enableRtl,\n      fields: {\n        dataSource: [].slice.call(this.generateTreeData()),\n        id: 'resourceId',\n        text: 'resourceName',\n        child: 'resourceChild'\n      },\n      nodeTemplate: this.parent.resourceHeaderTemplate,\n      nodeClicked: this.resourceClick.bind(this)\n    });\n    this.treeViewObj.appendTo(resourceTree);\n    this.treeViewObj.expandAll();\n    this.treePopup = new Popup(treeWrapper, {\n      targetType: 'relative',\n      actionOnScroll: 'none',\n      content: this.treeViewObj.element,\n      relateTo: this.parent.element.querySelector('.' + TABLE_CONTAINER_CLASS),\n      enableRtl: this.parent.enableRtl,\n      hideAnimation: {\n        name: 'SlideLeftOut',\n        duration: 500\n      },\n      showAnimation: {\n        name: 'SlideLeftIn',\n        duration: 500\n      },\n      viewPortElement: this.parent.element.querySelector('.' + (this.parent.currentView === 'MonthAgenda' ? WRAPPER_CONTAINER_CLASS : TABLE_CONTAINER_CLASS))\n    });\n    this.parent.on(documentClick, this.documentClick, this);\n  }\n\n  generateTreeData(isTimeLine) {\n    const treeCollection = [];\n    const resTreeColl = [];\n    let groupIndex = 0;\n\n    for (let i = 0, len = this.resourceTreeLevel.length; i < len; i++) {\n      const treeHandler = (treeLevel, index, levelId) => {\n        const resource = this.resourceCollection[index];\n        let treeArgs;\n        let resObj;\n\n        if (!isTimeLine) {\n          treeArgs = {\n            resourceId: levelId,\n            resourceName: treeLevel.resourceData[resource.textField],\n            resource: treeLevel.resource,\n            resourceData: treeLevel.resourceData\n          };\n        } else {\n          resObj = {\n            type: 'resourceHeader',\n            resource: treeLevel.resource,\n            resourceData: treeLevel.resourceData,\n            groupIndex: groupIndex,\n            groupOrder: treeLevel.groupOrder\n          };\n          resTreeColl.push(resObj);\n          groupIndex++;\n        }\n\n        if (treeLevel.child.length > 0 && !isTimeLine) {\n          treeArgs.resourceChild = [];\n        }\n\n        let count = 1;\n\n        for (const tree of treeLevel.child) {\n          if (!isTimeLine) {\n            treeArgs.resourceChild.push(treeHandler(tree, index + 1, levelId + '-' + count));\n          } else {\n            treeHandler(tree, index + 1, levelId + '-' + count);\n          }\n\n          count += 1;\n        }\n\n        if (isTimeLine) {\n          extend(resObj.resourceData, {\n            Count: count - 1\n          });\n        }\n\n        return treeArgs;\n      };\n\n      if (!isTimeLine) {\n        treeCollection.push(treeHandler(this.resourceTreeLevel[i], 0, (i + 1).toString()));\n      } else {\n        treeHandler(this.resourceTreeLevel[i], 0, (i + 1).toString());\n      }\n    }\n\n    if (isTimeLine) {\n      this.lastResourceLevel = resTreeColl;\n      return resTreeColl;\n    } else {\n      return treeCollection;\n    }\n  }\n\n  renderResourceHeaderText() {\n    const resource = this.lastResourceLevel[this.parent.uiStateValues.groupIndex];\n    const headerCollection = [];\n\n    for (let i = 0, len = resource.groupOrder.length; i < len; i++) {\n      const resourceLevel = this.resourceCollection[i];\n      const resourceText = resourceLevel.dataSource.filter(resData => resData[resourceLevel.idField] === resource.groupOrder[i]);\n      const resourceName = createElement('div', {\n        className: RESOURCE_NAME,\n        innerHTML: resourceText[0][resourceLevel.textField]\n      });\n      headerCollection.push(resourceName);\n      const levelIcon = createElement('div', {\n        className: 'e-icons e-icon-next'\n      });\n      headerCollection.push(levelIcon);\n    }\n\n    headerCollection.pop();\n    const target = this.parent.currentView === 'MonthAgenda' ? this.parent.activeView.getPanel() : this.parent.element;\n    const headerWrapper = target.querySelector('.' + RESOURCE_LEVEL_TITLE);\n    removeChildren(headerWrapper);\n\n    for (const header of headerCollection) {\n      headerWrapper.appendChild(header);\n    }\n\n    if (this.lastResourceLevel.length === 1) {\n      addClass([this.parent.element.querySelector('.' + RESOURCE_MENU)], DISABLE_CLASS);\n    }\n  } // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  menuClick(event) {\n    if (this.parent.element.querySelector('.' + RESOURCE_TREE_POPUP).classList.contains(POPUP_OPEN)) {\n      this.treePopup.hide();\n      removeClass([this.popupOverlay], ENABLE_CLASS);\n    } else {\n      const treeNodes = [].slice.call(this.treeViewObj.element.querySelectorAll('.e-list-item:not(.e-has-child)'));\n      removeClass(treeNodes, 'e-active');\n      addClass([treeNodes[this.parent.uiStateValues.groupIndex]], 'e-active');\n      this.treePopup.show();\n      addClass([this.popupOverlay], ENABLE_CLASS);\n    }\n  }\n\n  selectResourceByIndex(groupIndex) {\n    if (this.lastResourceLevel && groupIndex > -1 && groupIndex < this.lastResourceLevel.length) {\n      this.triggerEvents(groupIndex);\n    }\n  }\n\n  resourceClick(event) {\n    if (!event.node.classList.contains('e-has-child')) {\n      this.treePopup.hide();\n      removeClass([this.popupOverlay], ENABLE_CLASS);\n      const treeNodes = [].slice.call(this.treeViewObj.element.querySelectorAll('.e-list-item:not(.e-has-child)'));\n      const groupIndex = treeNodes.indexOf(event.node);\n      this.triggerEvents(groupIndex, event);\n      event.event.preventDefault();\n    }\n  }\n\n  triggerEvents(groupIndex, event) {\n    let args = {\n      cancel: false,\n      event: event ? event.event : null,\n      groupIndex: groupIndex,\n      requestType: 'resourceChange'\n    };\n    this.parent.trigger(actionBegin, args, actionArgs => {\n      if (!actionArgs.cancel) {\n        this.parent.uiStateValues.groupIndex = actionArgs.groupIndex;\n        this.parent.renderModule.render(this.parent.currentView);\n        args = {\n          cancel: false,\n          event: event ? event.event : null,\n          groupIndex: this.parent.uiStateValues.groupIndex,\n          requestType: 'resourceChanged'\n        };\n        this.parent.trigger(actionComplete, args);\n      }\n    });\n  }\n\n  documentClick(args) {\n    if (closest(args.event.target, '.' + RESOURCE_TREE_POPUP)) {\n      return;\n    }\n\n    const treeWrapper = this.parent.element.querySelector('.' + RESOURCE_TREE_POPUP);\n\n    if (treeWrapper && treeWrapper.classList.contains(POPUP_OPEN)) {\n      this.treePopup.hide();\n      removeClass([this.popupOverlay], ENABLE_CLASS);\n    }\n  }\n\n  bindResourcesData(isSetModel) {\n    this.parent.showSpinner();\n    const promises = [];\n\n    for (const resource of this.parent.resources) {\n      const dataModule = new Data(resource.dataSource, resource.query);\n      promises.push(dataModule.getData(dataModule.generateQuery()));\n    }\n\n    Promise.all(promises).then(e => this.dataManagerSuccess(e, isSetModel)).catch(e => this.parent.crudModule.dataManagerFailure(e));\n  }\n\n  dataManagerSuccess(e, isSetModel) {\n    if (!this.parent || this.parent && this.parent.isDestroyed) {\n      return;\n    }\n\n    this.parent.resourceCollection = [];\n\n    for (let i = 0, length = e.length; i < length; i++) {\n      const resource = this.parent.resources[i];\n      const resourceObj = this.getResourceModel(resource, e[i].result);\n      this.parent.resourceCollection.push(resourceObj);\n    }\n\n    this.refreshLayout(isSetModel);\n  }\n\n  getResourceModel(resource, resourceData) {\n    const resourceObj = {\n      field: resource.field,\n      title: resource.title,\n      name: resource.name,\n      allowMultiple: resource.allowMultiple,\n      dataSource: resourceData || resource.dataSource,\n      idField: resource.idField,\n      textField: resource.textField,\n      groupIDField: resource.groupIDField,\n      colorField: resource.colorField,\n      startHourField: resource.startHourField,\n      endHourField: resource.endHourField,\n      workDaysField: resource.workDaysField,\n      expandedField: resource.expandedField,\n      cssClassField: resource.cssClassField\n    };\n    return resourceObj;\n  }\n\n  refreshLayout(isSetModel) {\n    if (isNullOrUndefined(this.parent.uiStateValues.groupIndex) || !this.parent.enablePersistence) {\n      this.parent.uiStateValues.groupIndex = 0;\n    }\n\n    this.parent.renderElements(isSetModel);\n  }\n\n  setResourceCollection() {\n    let requiredResources = [];\n    this.resourceCollection = [];\n    this.colorIndex = null;\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      for (const resource of this.parent.activeViewOptions.group.resources) {\n        const index = findIndexInData(this.parent.resourceCollection, 'name', resource);\n\n        if (index >= 0) {\n          requiredResources.push(this.parent.resourceCollection[index]);\n        }\n      }\n    } else if (this.parent.resourceCollection.length > 0) {\n      requiredResources = this.parent.resourceCollection;\n    }\n\n    let index = 0;\n\n    for (const resource of requiredResources) {\n      const resources = this.getResourceModel(resource);\n\n      if (resource.name === this.parent.eventSettings.resourceColorField) {\n        this.colorIndex = index;\n      }\n\n      index++;\n      this.resourceCollection.push(resources);\n    }\n\n    if (isNullOrUndefined(this.colorIndex)) {\n      this.colorIndex = this.resourceCollection.length - 1;\n    }\n  }\n\n  generateResourceLevels(innerDates, isTimeLine) {\n    const resources = this.resourceCollection;\n    const resTreeGroup = [];\n    let lastColumnDates = [];\n\n    const group = (resources, index, prevResource, prevResourceData, prevOrder) => {\n      const resTree = [];\n      const resource = resources[0];\n\n      if (resource) {\n        let data;\n\n        if (prevResourceData && this.parent.activeViewOptions.group.byGroupID) {\n          const id = prevResourceData[prevResource.idField];\n          data = resource.dataSource.filter(e => e[resource.groupIDField] === id);\n        } else {\n          data = resource.dataSource;\n        }\n\n        for (let i = 0; i < data.length; i++) {\n          let groupOrder = [];\n\n          if (prevOrder && prevOrder.length > 0) {\n            groupOrder = groupOrder.concat(prevOrder);\n          }\n\n          groupOrder.push(data[i][resource.idField]);\n          const items = group(resources.slice(1), index + 1, resource, data[i], groupOrder); // Here validate child item empty top level resource only\n\n          if (index === 0 && items.length === 0 && this.resourceCollection.length > 1) {\n            continue;\n          }\n\n          let dateCol = [];\n          let renderDates = this.parent.activeView.renderDates;\n          let resWorkDays;\n\n          if (!this.parent.activeViewOptions.group.byDate && index + 1 === this.resourceCollection.length) {\n            const workDays = data[i][resource.workDaysField];\n            const resStartHour = data[i][resource.startHourField];\n            const resEndHour = data[i][resource.endHourField];\n\n            if (workDays && workDays.length > 0) {\n              renderDates = this.parent.activeView.getRenderDates(workDays);\n              resWorkDays = workDays;\n              dateCol = this.parent.activeView.getDateSlots(renderDates, workDays);\n            } else {\n              resWorkDays = this.parent.activeViewOptions.workDays;\n              dateCol = innerDates;\n            }\n\n            const dateSlots = this.generateCustomHours(dateCol, resStartHour, resEndHour, groupOrder);\n            lastColumnDates = lastColumnDates.concat(dateSlots);\n          }\n\n          const resCssClass = data[i][resource.cssClassField];\n          const slotData = {\n            type: 'resourceHeader',\n            className: ['e-resource-cells'],\n            resourceLevelIndex: index,\n            groupOrder: groupOrder,\n            resource: resource,\n            resourceData: data[i],\n            colSpan: this.parent.activeViewOptions.group.byDate ? 1 : dateCol.length,\n            renderDates: renderDates,\n            workDays: resWorkDays,\n            cssClass: resCssClass,\n            child: items\n          };\n          resTree.push(slotData);\n        }\n\n        if (!resTreeGroup[index]) {\n          resTreeGroup[index] = [];\n        }\n\n        if (resTree.length > 0) {\n          resTreeGroup[index].push(resTree);\n        }\n\n        return resTree;\n      }\n\n      return [];\n    };\n\n    this.resourceTreeLevel = group(resources, 0);\n    return isTimeLine ? [] : this.generateHeaderLevels(resTreeGroup, lastColumnDates, innerDates);\n  }\n\n  generateCustomHours(renderDates, startHour, endHour, groupOrder) {\n    const dateSlots = extend([], renderDates, null, true);\n\n    for (const dateSlot of dateSlots) {\n      if (startHour) {\n        dateSlot.startHour = this.parent.getStartEndTime(startHour);\n      }\n\n      if (endHour) {\n        dateSlot.endHour = this.parent.getStartEndTime(endHour);\n      }\n\n      if (groupOrder) {\n        dateSlot.groupOrder = groupOrder;\n      }\n    }\n\n    return dateSlots;\n  }\n\n  generateHeaderLevels(resTreeGroup, lastColumnDates, headerDates) {\n    const headerLevels = [];\n\n    for (let i = resTreeGroup.length - 1; i >= 0; i--) {\n      let temp = 0;\n\n      for (const currentLevelChilds of resTreeGroup[i]) {\n        for (const currentLevelChild of currentLevelChilds) {\n          if (resTreeGroup[i + 1] && resTreeGroup[i + 1].length > 0) {\n            const nextLevelChilds = resTreeGroup[i + 1][temp];\n\n            if (!nextLevelChilds) {\n              continue;\n            }\n\n            let colSpan = 0;\n\n            for (const nextLevelChild of nextLevelChilds) {\n              if (!this.parent.activeViewOptions.group.byGroupID || this.parent.activeViewOptions.group.byGroupID && nextLevelChild.resourceData[nextLevelChild.resource.groupIDField] === currentLevelChild.resourceData[currentLevelChild.resource.idField]) {\n                colSpan += nextLevelChild.colSpan;\n              }\n            }\n\n            currentLevelChild.colSpan = colSpan;\n          }\n\n          currentLevelChild.groupIndex = temp;\n          temp++;\n          headerLevels[currentLevelChild.resourceLevelIndex] = headerLevels[currentLevelChild.resourceLevelIndex] || [];\n          headerLevels[currentLevelChild.resourceLevelIndex].push(currentLevelChild);\n        }\n      }\n    }\n\n    this.lastResourceLevel = headerLevels.slice(-1)[0] || [];\n\n    if (!this.parent.activeViewOptions.group.byDate) {\n      let index = 0;\n\n      for (const lastLevelResource of this.lastResourceLevel) {\n        for (let i = 0; i < lastLevelResource.colSpan; i++) {\n          lastColumnDates[index].groupIndex = lastLevelResource.groupIndex;\n          index++;\n        }\n      }\n\n      headerLevels.push(lastColumnDates);\n      return headerLevels;\n    }\n\n    const dateHeaderLevels = [];\n    const levels = extend([], headerLevels, null, true);\n    let dateColSpan = 0;\n\n    for (const firstRowTd of levels[0]) {\n      dateColSpan += firstRowTd.colSpan;\n    }\n\n    const datesColumn = [];\n\n    for (const headerDate of headerDates) {\n      headerDate.colSpan = dateColSpan;\n      datesColumn.push(headerDate);\n      const resGroup = extend([], levels, null, true);\n\n      for (let k = 0, length = resGroup.length; k < length; k++) {\n        if (k === resGroup.length - 1) {\n          for (const resTd of resGroup[k]) {\n            resTd.date = headerDate.date;\n            resTd.workDays = headerDate.workDays;\n            resTd.startHour = this.parent.getStartEndTime(resTd.resourceData[resTd.resource.startHourField]) || headerDate.startHour;\n            resTd.endHour = this.parent.getStartEndTime(resTd.resourceData[resTd.resource.endHourField]) || headerDate.endHour;\n          }\n        }\n\n        if (!dateHeaderLevels[k]) {\n          dateHeaderLevels[k] = [];\n        }\n\n        dateHeaderLevels[k] = dateHeaderLevels[k].concat(resGroup[k]);\n      }\n    }\n\n    dateHeaderLevels.unshift(datesColumn);\n    return dateHeaderLevels;\n  }\n\n  setResourceValues(eventObj, groupIndex) {\n    const setValues = (index, field, value) => {\n      if (this.resourceCollection[index].allowMultiple && this.parent.activeViewOptions.group.allowGroupEdit) {\n        eventObj[field] = [value];\n      } else {\n        eventObj[field] = value;\n      }\n    };\n\n    if (groupIndex === void 0) {\n      groupIndex = this.parent.uiStateValues.isGroupAdaptive ? this.parent.uiStateValues.groupIndex : this.parent.activeCellsData.groupIndex;\n    }\n\n    if (this.parent.activeViewOptions.group.resources.length > 0 && !isNullOrUndefined(groupIndex)) {\n      const groupOrder = this.lastResourceLevel[groupIndex].groupOrder;\n\n      for (let index = 0; index < this.resourceCollection.length; index++) {\n        setValues(index, this.resourceCollection[index].field, groupOrder[index]);\n      }\n    } else if (this.parent.resourceCollection.length > 0) {\n      for (let index = 0; index < this.resourceCollection.length; index++) {\n        const data = this.resourceCollection[index].dataSource[0];\n\n        if (data) {\n          setValues(index, this.resourceCollection[index].field, data[this.resourceCollection[index].idField]);\n        }\n      }\n    }\n  }\n\n  getResourceColor(eventObj, groupOrder) {\n    const colorFieldIndex = !isNullOrUndefined(groupOrder) && this.colorIndex > groupOrder.length - 1 ? groupOrder.length - 1 : this.colorIndex;\n    const resource = this.resourceCollection[colorFieldIndex];\n\n    if (isNullOrUndefined(groupOrder) && this.parent.activeViewOptions.group.allowGroupEdit && resource.allowMultiple) {\n      return undefined;\n    }\n\n    const id = isNullOrUndefined(groupOrder) ? eventObj[resource.field] : groupOrder[colorFieldIndex];\n    const data = this.filterData(resource.dataSource, resource.idField, id);\n\n    if (data.length > 0) {\n      return data[0][resource.colorField];\n    }\n\n    return undefined;\n  }\n\n  getCssClass(eventObj) {\n    const resource = this.resourceCollection.slice(-1)[0];\n\n    if (this.parent.activeViewOptions.group.allowGroupEdit && resource.allowMultiple) {\n      return undefined;\n    }\n\n    const data = this.filterData(resource.dataSource, resource.idField, eventObj[resource.field]);\n\n    if (data.length > 0) {\n      return data[0][resource.cssClassField];\n    }\n\n    return undefined;\n  }\n\n  getResourceRenderDates() {\n    // eslint-disable-next-line prefer-spread\n    const resourceDates = [].concat.apply([], this.lastResourceLevel.map(e => e.renderDates));\n\n    const removeDuplicateDates = dateColl => dateColl.filter((date, index, dates) => dates.map(dateObj => dateObj.getTime()).indexOf(date.getTime()) === index);\n\n    const renderDates = removeDuplicateDates(resourceDates);\n    renderDates.sort((a, b) => a.getTime() - b.getTime());\n    return renderDates;\n  }\n\n  filterData(dataSource, field, value) {\n    return dataSource.filter(data => data[field] === value);\n  }\n\n  getResourceData(eventObj, index, groupEditIndex) {\n    if (this.parent.activeViewOptions.group.allowGroupEdit) {\n      const resourceObj = {};\n\n      for (const groupIndex of groupEditIndex) {\n        const resourceLevel = this.lastResourceLevel[groupIndex].groupOrder;\n\n        for (let level = 0, length = resourceLevel.length; level < length; level++) {\n          const fieldName = this.resourceCollection[level].field;\n\n          if (isNullOrUndefined(resourceObj[fieldName])) {\n            resourceObj[fieldName] = [];\n          }\n\n          resourceObj[fieldName].push(resourceLevel[level]);\n        }\n      }\n\n      eventObj = extend(eventObj, resourceObj);\n    } else {\n      for (let level = 0, length = this.resourceCollection.length; level < length; level++) {\n        if (this.lastResourceLevel[index]) {\n          eventObj[this.resourceCollection[level].field] = this.lastResourceLevel[index].groupOrder[level];\n        }\n      }\n    }\n  }\n\n  addResource(resources, name, index) {\n    const resourceCollection = resources instanceof Array ? resources : [resources];\n\n    for (const resource of this.parent.resourceCollection) {\n      if (resource.name === name) {\n        resourceCollection.forEach((addObj, i) => new DataManager({\n          json: resource.dataSource\n        }).insert(addObj, null, null, index + i));\n        break;\n      }\n    }\n\n    this.refreshLayout(true);\n  }\n\n  removeResource(resourceId, name) {\n    const resourceCollection = resourceId instanceof Array ? resourceId : [resourceId];\n\n    for (const resource of this.parent.resourceCollection) {\n      if (resource.name === name) {\n        resourceCollection.forEach(removeObj => new DataManager({\n          json: resource.dataSource\n        }).remove(resource.idField, removeObj));\n        break;\n      }\n    }\n\n    this.refreshLayout(true);\n  }\n\n  getIndexFromResourceId(id, name, resourceData, event, parentField) {\n    name = name || this.parent.resourceCollection.slice(-1)[0].name;\n\n    if (isNullOrUndefined(resourceData)) {\n      resourceData = this.resourceCollection.filter(e => e.name === name)[0];\n\n      if (isNullOrUndefined(resourceData)) {\n        return null;\n      }\n    }\n\n    const resource = resourceData.dataSource.filter(e => {\n      if (event && e[resourceData.idField] === id) {\n        if (e[resourceData.groupIDField] === event[parentField]) {\n          return e[resourceData.idField] === id;\n        }\n\n        return null;\n      } else {\n        return e[resourceData.idField] === id;\n      }\n    })[0];\n    return this.lastResourceLevel.map(e => e.resourceData).indexOf(resource);\n  }\n\n  resourceExpand(id, name, hide) {\n    const resource = this.parent.resourceCollection.filter(e => {\n      if (e.name === name) {\n        return e;\n      }\n\n      return null;\n    })[0];\n    let index = 0;\n    const resourceData = resource.dataSource.filter(e => e[resource.idField] === id)[0];\n\n    if (!this.parent.activeViewOptions.group.byGroupID) {\n      index = this.getIndexFromResourceId(id, name, resource);\n    } else {\n      index = this.lastResourceLevel.map(e => e.resourceData).indexOf(resourceData);\n    }\n\n    const target = this.parent.element.querySelector('.' + RESOURCE_COLUMN_WRAP_CLASS + ' ' + `[data-group-index=\"${index}\"]` + ' ' + '.' + RESOURCE_TREE_ICON_CLASS);\n\n    if (target) {\n      if (target.classList.contains(RESOURCE_EXPAND_CLASS) && !hide) {\n        target.click();\n      } else if (target.classList.contains(RESOURCE_COLLAPSE_CLASS) && hide) {\n        target.click();\n      }\n    }\n  }\n\n  resourceScroll(id, name) {\n    if (this.parent.isAdaptive || ['Agenda', 'MonthAgenda'].indexOf(this.parent.currentView) > -1) {\n      return;\n    }\n\n    const levelName = name || this.parent.resourceCollection.slice(-1)[0].name;\n    let levelIndex = this.parent.resourceCollection.length - 1;\n    const resource = this.parent.resourceCollection.filter((e, index) => {\n      if (e.name === levelName) {\n        levelIndex = index;\n        return e;\n      }\n\n      return null;\n    })[0];\n    const scrollElement = this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS);\n    let index = 0;\n\n    if (this.parent.activeView.isTimelineView()) {\n      if (!this.parent.activeViewOptions.group.byGroupID) {\n        index = this.getIndexFromResourceId(id, levelName, resource);\n      } else {\n        const resourceData = resource.dataSource.filter(e => e[resource.idField] === id)[0];\n        index = this.lastResourceLevel.map(e => e.resourceData).indexOf(resourceData);\n      }\n\n      if (this.parent.virtualScrollModule) {\n        const virtual = this.parent.element.querySelector('.' + VIRTUAL_TRACK_CLASS);\n        const averageRowHeight = Math.round(virtual.offsetHeight / this.expandedResources.length);\n\n        if (this.parent.rowAutoHeight) {\n          scrollElement.scrollTop = 0;\n          this.parent.virtualScrollModule.virtualScrolling();\n        }\n\n        scrollElement.scrollTop = index * averageRowHeight - (this.parent.virtualScrollModule.bufferCount - 1) * averageRowHeight;\n        this.parent.virtualScrollModule.virtualScrolling();\n\n        if (this.parent.rowAutoHeight) {\n          const td = this.parent.element.querySelector(`.${WORK_CELLS_CLASS}[data-group-index=\"${index}\"]`);\n\n          if (td && !td.parentElement.classList.contains(HIDDEN_CLASS)) {\n            scrollElement.scrollTop = scrollElement.scrollTop < td.offsetTop ? td.offsetTop : scrollElement.scrollTop + td.offsetTop;\n          }\n        } else {\n          scrollElement.scrollTop = index * averageRowHeight;\n        }\n      } else {\n        const td = this.parent.element.querySelector(`.${WORK_CELLS_CLASS}[data-group-index=\"${index}\"]`);\n\n        if (td && !td.parentElement.classList.contains(HIDDEN_CLASS)) {\n          scrollElement.scrollTop = td.offsetTop;\n        }\n      }\n    } else {\n      if (!this.parent.activeViewOptions.group.byGroupID) {\n        index = this.getIndexFromResourceId(id, levelName, resource);\n      } else {\n        if (levelName === this.parent.resourceCollection.slice(-1)[0].name) {\n          index = this.lastResourceLevel.map(e => e.resourceData[resource.idField]).indexOf(id);\n        } else {\n          index = resource.dataSource.map(e => e[resource.idField]).indexOf(id);\n        }\n      }\n\n      const offsetTarget = this.parent.element.querySelector(`.${HEADER_ROW_CLASS}:nth-child(${levelIndex + 1})`);\n      const offset = [].slice.call(offsetTarget.children).map(node => node.offsetLeft);\n      scrollElement.scrollLeft = offset[index];\n    }\n  }\n\n  destroy() {\n    this.parent.off(documentClick, this.documentClick);\n\n    if (this.treeViewObj) {\n      this.treeViewObj.destroy();\n      this.treeViewObj = null;\n    }\n\n    if (this.treePopup) {\n      this.treePopup.destroy();\n      this.treePopup = null;\n      remove(this.parent.element.querySelector('.' + RESOURCE_TREE_POPUP));\n      remove(this.parent.element.querySelector('.' + RESOURCE_TREE_POPUP_OVERLAY));\n    }\n\n    const resToolBarEle = this.parent.element.querySelector('.' + RESOURCE_TOOLBAR_CONTAINER);\n\n    if (resToolBarEle) {\n      remove(resToolBarEle);\n    }\n  }\n\n}\n\nvar __decorate = undefined && undefined.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\n/**\n * Represents the Schedule component that displays a list of events scheduled against specific date and timings,\n * thus helping us to plan and manage it properly.\n * ```html\n * <div id=\"schedule\"></div>\n * ```\n * ```typescript\n * <script>\n *   var scheduleObj = new Schedule();\n *   scheduleObj.appendTo(\"#schedule\");\n * </script>\n * ```\n */\n\n\nlet Schedule = class Schedule extends Component {\n  /**\n   * Constructor for creating the Schedule widget\n   *\n   * @param {ScheduleModel} options Accepts the schedule model properties to initiate the rendering\n   * @param {string | HTMLElement} element Accepts the DOM element reference\n   */\n  constructor(options, element) {\n    super(options, element);\n  }\n  /**\n   * Core method that initializes the control rendering.\n   *\n   * @returns {void}\n   * @private\n   */\n\n\n  render() {\n    const addClasses = [];\n    const removeClasses = [];\n    addClasses.push(ROOT);\n\n    if (this.enableRtl) {\n      addClasses.push(RTL);\n    } else {\n      removeClasses.push(RTL);\n    }\n\n    if (this.isAdaptive) {\n      addClasses.push(DEVICE_CLASS);\n    } else {\n      removeClasses.push(DEVICE_CLASS);\n    }\n\n    if (this.allowMultiDrag) {\n      addClasses.push(MULTI_DRAG);\n    } else {\n      removeClasses.push(MULTI_DRAG);\n    }\n\n    if (this.cssClass) {\n      const cssClass = this.cssClass.split(' ');\n\n      for (const cls of cssClass) {\n        addClasses.push(cls);\n      }\n    }\n\n    classList(this.element, addClasses, removeClasses);\n    this.validateDate();\n    createSpinner({\n      target: this.element\n    });\n    this.scrollModule = new Scroll(this);\n    this.scrollModule.setWidth();\n    this.scrollModule.setHeight();\n    this.renderModule = new Render(this);\n    this.eventBase = new EventBase(this);\n    this.workCellAction = new WorkCellInteraction(this);\n\n    if (this.allowKeyboardInteraction) {\n      this.keyboardInteractionModule = new KeyboardInteraction(this);\n    }\n\n    this.inlineModule = new InlineEdit(this);\n    this.initializeDataModule();\n    this.renderTableContainer();\n    this.activeViewOptions = this.getActiveViewOptions();\n    this.initializeResources();\n    this.wireEvents();\n  }\n\n  renderTableContainer() {\n    if (!this.element.querySelector('.' + TABLE_CONTAINER_CLASS)) {\n      this.element.appendChild(this.createElement('div', {\n        className: TABLE_CONTAINER_CLASS\n      }));\n    }\n  }\n  /**\n   * Method to render react templates\n   *\n   * @returns {void}\n   * @private\n   */\n\n\n  renderTemplates() {\n    if (this.isReact) {\n      this.renderReactTemplates();\n    }\n  }\n  /**\n   * Method to reset react templates\n   *\n   * @param {string[]} templates Accepts the template ID\n   * @returns {void}\n   * @private\n   */\n\n\n  resetTemplates(templates) {\n    if (this.isAngular || this.isReact) {\n      this.clearTemplate(templates);\n    }\n  }\n\n  initializeResources(isSetModel = false) {\n    if (this.resources.length > 0) {\n      this.resourceBase = new ResourceBase(this);\n      this.resourceBase.bindResourcesData(isSetModel);\n    } else {\n      this.resourceBase = null;\n      this.resourceCollection = [];\n      this.renderElements(isSetModel);\n    }\n  }\n  /**\n   * Method to render the layout elements\n   *\n   * @param {boolean} isLayoutOnly Accepts the boolean value to render layout or not\n   * @returns {void}\n   * @private\n   */\n\n\n  renderElements(isLayoutOnly) {\n    if (isLayoutOnly) {\n      this.initializeView(this.currentView);\n      this.eventWindow.refresh();\n      return;\n    }\n\n    this.destroyHeaderModule();\n\n    if (this.showHeaderBar) {\n      this.headerModule = new HeaderRenderer(this);\n    }\n\n    this.renderTableContainer();\n\n    if (Browser.isDevice || Browser.isTouch) {\n      this.scheduleTouchModule = new ScheduleTouch(this);\n    }\n\n    this.initializeView(this.currentView);\n    this.destroyPopups();\n\n    if (!this.isPrinting) {\n      this.initializePopups();\n    }\n  }\n\n  validateDate(selectedDate = this.selectedDate) {\n    // persist the selected date value\n    let date = selectedDate instanceof Date ? new Date(selectedDate.getTime()) : new Date(selectedDate);\n    const minDate = this.minDate instanceof Date ? new Date(this.minDate.getTime()) : new Date(this.minDate);\n    const maxDate = this.maxDate instanceof Date ? new Date(this.maxDate.getTime()) : new Date(this.maxDate);\n\n    if (minDate <= maxDate) {\n      if (date < minDate) {\n        date = minDate;\n      }\n\n      if (date > maxDate) {\n        date = maxDate;\n      }\n\n      this.setProperties({\n        selectedDate: new Date('' + date),\n        minDate: new Date('' + minDate),\n        maxDate: new Date('' + maxDate)\n      }, true);\n\n      if (this.eventWindow) {\n        this.eventWindow.updateMinMaxDateToEditor();\n      }\n    } else {\n      throw Error('minDate should be equal or less than maxDate');\n    }\n  }\n\n  getViewIndex(viewName) {\n    for (let item = 0; item < this.viewCollections.length; item++) {\n      const checkIndex = this.viewCollections[item].option;\n\n      if (checkIndex === viewName) {\n        return item;\n      }\n    }\n\n    return -1;\n  }\n\n  setViewOptions(isModuleLoad = false) {\n    this.viewOptions = {};\n    this.viewCollections = [];\n    let viewName;\n    let selectedView;\n    const prevIndex = this.viewIndex;\n    let count = 0;\n    this.viewIndex = -1;\n\n    for (const view of this.views) {\n      const isOptions = typeof view === 'string' ? false : true;\n\n      if (typeof view === 'string') {\n        viewName = view;\n\n        if (this.currentView === viewName) {\n          selectedView = viewName;\n          this.viewIndex = count;\n        }\n      } else {\n        viewName = view.option;\n\n        if (view.isSelected) {\n          selectedView = viewName;\n          this.viewIndex = count;\n        }\n      }\n\n      const obj = extend({\n        option: viewName\n      }, isOptions ? view : {});\n      const fieldViewName = viewName.charAt(0).toLowerCase() + viewName.slice(1);\n      obj.cellHeaderTemplateName = obj.cellHeaderTemplate ? obj.option : '';\n      obj.dateHeaderTemplateName = obj.dateHeaderTemplate ? obj.option : '';\n      obj.cellTemplateName = obj.cellTemplate ? obj.option : '';\n      obj.dayHeaderTemplateName = obj.dayHeaderTemplate ? obj.option : '';\n      obj.monthHeaderTemplateName = obj.monthHeaderTemplate ? obj.option : '';\n      obj.resourceHeaderTemplateName = obj.resourceHeaderTemplate ? obj.option : '';\n      obj.headerIndentTemplateName = obj.headerIndentTemplate ? obj.option : '';\n      obj.eventTemplateName = obj.eventTemplate ? obj.option : '';\n\n      if (!isNullOrUndefined(obj.firstDayOfWeek) && obj.firstDayOfWeek === 0) {\n        delete obj.firstDayOfWeek;\n      }\n\n      if (!isNullOrUndefined(obj.interval) && obj.interval === 1) {\n        delete obj.interval;\n      }\n\n      this.viewCollections.push(obj);\n\n      if (isNullOrUndefined(this.viewOptions[fieldViewName])) {\n        this.viewOptions[fieldViewName] = [obj];\n      } else {\n        this.viewOptions[fieldViewName].push(obj);\n      }\n\n      count++;\n    }\n\n    if (!isModuleLoad && selectedView) {\n      this.setProperties({\n        currentView: selectedView\n      }, true);\n    }\n\n    if (this.viewIndex === -1) {\n      const currentIndex = this.getViewIndex(this.currentView);\n      this.viewIndex = typeof this.views[0] !== 'string' && !isNullOrUndefined(prevIndex) && prevIndex !== -1 ? prevIndex : currentIndex === -1 ? 0 : currentIndex;\n    }\n  }\n\n  getActiveViewOptions() {\n    const timeScale = {\n      enable: this.timeScale.enable,\n      interval: this.timeScale.interval,\n      slotCount: this.timeScale.slotCount,\n      majorSlotTemplate: this.timeScale.majorSlotTemplate,\n      minorSlotTemplate: this.timeScale.minorSlotTemplate\n    };\n    const isYearView = this.viewCollections[this.viewIndex].option.indexOf('Year') > -1;\n    const group = {\n      byDate: isYearView ? false : this.group.byDate,\n      byGroupID: this.group.byGroupID,\n      allowGroupEdit: this.group.allowGroupEdit,\n      resources: this.group.resources,\n      headerTooltipTemplate: this.group.headerTooltipTemplate,\n      enableCompactView: this.group.enableCompactView\n    };\n    const workDays = this.viewCollections[this.viewIndex].workDays ? [] : this.workDays;\n    const scheduleOptions = {\n      dateFormat: this.dateFormat,\n      endHour: this.endHour,\n      isSelected: false,\n      option: null,\n      readonly: this.readonly,\n      startHour: this.startHour,\n      allowVirtualScrolling: false,\n      cellHeaderTemplate: this.cellHeaderTemplate,\n      dayHeaderTemplate: this.dayHeaderTemplate,\n      monthHeaderTemplate: this.monthHeaderTemplate,\n      cellTemplate: this.cellTemplate,\n      eventTemplate: this.eventSettings.template,\n      dateHeaderTemplate: this.dateHeaderTemplate,\n      resourceHeaderTemplate: this.resourceHeaderTemplate,\n      headerIndentTemplate: this.headerIndentTemplate,\n      firstMonthOfYear: this.firstMonthOfYear,\n      firstDayOfWeek: this.firstDayOfWeek,\n      workDays: workDays,\n      monthsCount: this.monthsCount,\n      showWeekend: this.showWeekend,\n      showWeekNumber: this.showWeekNumber,\n      displayName: null,\n      interval: 1,\n      timeScale: timeScale,\n      timeFormat: this.internalTimeFormat,\n      group: group,\n      headerRows: this.headerRows,\n      orientation: 'Horizontal',\n      numberOfWeeks: 0,\n      displayDate: null\n    };\n    const viewOptions = this.viewCollections[this.viewIndex];\n    const viewsData = extend(scheduleOptions, viewOptions, undefined, true);\n\n    if (this.firstDayOfWeek !== 0 && viewOptions.firstDayOfWeek && this.firstDayOfWeek !== viewOptions.firstDayOfWeek) {\n      viewsData.firstDayOfWeek = this.firstDayOfWeek;\n    }\n\n    if (viewsData.displayDate) {\n      viewsData.displayDate = viewsData.displayDate instanceof Date ? new Date(viewsData.displayDate.getTime()) : new Date(viewsData.displayDate);\n    }\n\n    return viewsData;\n  }\n\n  initializeDataModule() {\n    this.eventFields = {\n      id: this.eventSettings.fields.id,\n      isBlock: this.eventSettings.fields.isBlock,\n      subject: this.eventSettings.fields.subject.name,\n      startTime: this.eventSettings.fields.startTime.name,\n      endTime: this.eventSettings.fields.endTime.name,\n      startTimezone: this.eventSettings.fields.startTimezone.name,\n      endTimezone: this.eventSettings.fields.endTimezone.name,\n      location: this.eventSettings.fields.location.name,\n      description: this.eventSettings.fields.description.name,\n      isAllDay: this.eventSettings.fields.isAllDay.name,\n      recurrenceID: this.eventSettings.fields.recurrenceID.name,\n      recurrenceRule: this.eventSettings.fields.recurrenceRule.name,\n      recurrenceException: this.eventSettings.fields.recurrenceException.name,\n      isReadonly: this.eventSettings.fields.isReadonly,\n      followingID: this.eventSettings.fields.followingID\n    };\n    this.setEditorTitles();\n    this.dataModule = new Data(this.eventSettings.dataSource, this.eventSettings.query);\n    this.crudModule = new Crud(this);\n  }\n\n  setEditorTitles() {\n    this.editorTitles = {\n      subject: this.eventSettings.fields.subject.title || this.localeObj.getConstant('title'),\n      startTime: this.eventSettings.fields.startTime.title || this.localeObj.getConstant('start'),\n      endTime: this.eventSettings.fields.endTime.title || this.localeObj.getConstant('end'),\n      isAllDay: this.eventSettings.fields.isAllDay.title || this.localeObj.getConstant('allDay'),\n      startTimezone: this.eventSettings.fields.startTimezone.title || this.localeObj.getConstant('startTimezone'),\n      endTimezone: this.eventSettings.fields.endTimezone.title || this.localeObj.getConstant('endTimezone'),\n      location: this.eventSettings.fields.location.title || this.localeObj.getConstant('location'),\n      description: this.eventSettings.fields.description.title || this.localeObj.getConstant('description'),\n      recurrenceRule: this.eventSettings.fields.recurrenceRule.title || this.localeObj.getConstant('repeat')\n    };\n  }\n\n  initializeView(viewName) {\n    this.showSpinner();\n    this.activeViewOptions = this.getActiveViewOptions();\n\n    if (this.resourceBase) {\n      this.resourceBase.setResourceCollection();\n    }\n\n    this.initializeTemplates();\n    this.renderModule.render(viewName);\n  }\n\n  initializeTemplates() {\n    this.cellHeaderTemplateFn = this.templateParser(this.activeViewOptions.cellHeaderTemplate);\n    this.dayHeaderTemplateFn = this.templateParser(this.activeViewOptions.dayHeaderTemplate);\n    this.monthHeaderTemplateFn = this.templateParser(this.activeViewOptions.monthHeaderTemplate);\n    this.cellTemplateFn = this.templateParser(this.activeViewOptions.cellTemplate);\n    this.dateHeaderTemplateFn = this.templateParser(this.activeViewOptions.dateHeaderTemplate);\n    this.majorSlotTemplateFn = this.templateParser(this.activeViewOptions.timeScale.majorSlotTemplate);\n    this.minorSlotTemplateFn = this.templateParser(this.activeViewOptions.timeScale.minorSlotTemplate);\n    this.appointmentTemplateFn = this.templateParser(this.activeViewOptions.eventTemplate);\n    this.resourceHeaderTemplateFn = this.templateParser(this.activeViewOptions.resourceHeaderTemplate);\n    this.headerIndentTemplateFn = this.templateParser(this.activeViewOptions.headerIndentTemplate);\n    this.headerTooltipTemplateFn = this.templateParser(this.activeViewOptions.group.headerTooltipTemplate);\n    this.eventTooltipTemplateFn = this.templateParser(this.eventSettings.tooltipTemplate);\n    this.editorTemplateFn = this.templateParser(this.editorTemplate);\n    this.quickInfoTemplatesHeaderFn = this.templateParser(this.quickInfoTemplates.header);\n    this.quickInfoTemplatesContentFn = this.templateParser(this.quickInfoTemplates.content);\n    this.quickInfoTemplatesFooterFn = this.templateParser(this.quickInfoTemplates.footer);\n  }\n\n  initializePopups() {\n    this.eventWindow = new EventWindow(this);\n    this.quickPopup = new QuickPopups(this);\n  }\n  /**\n   * Method to get day names\n   *\n   * @param {string} type Accepts the day name\n   * @returns {string[]} Returns the collection of day names\n   * @private\n   */\n\n\n  getDayNames(type) {\n    const culShortNames = [];\n    let cldrObj;\n    let nameSpace = '';\n\n    if (this.locale === 'en' || this.locale === 'en-US') {\n      nameSpace = 'days.stand-alone.';\n      cldrObj = getValue(nameSpace + type, getDefaultDateObject(this.getCalendarMode()));\n    } else {\n      nameSpace = 'main.' + '' + this.locale + '.dates.calendars.' + this.getCalendarMode() + '.days.format.' + type;\n      cldrObj = getValue(nameSpace, cldrData);\n    }\n\n    for (const obj of Object.keys(cldrObj)) {\n      culShortNames.push(getValue(obj, cldrObj));\n    }\n\n    return culShortNames;\n  }\n\n  setCldrTimeFormat() {\n    if (!isNullOrUndefined(this.timeFormat)) {\n      this.internalTimeFormat = this.timeFormat;\n      return;\n    }\n\n    if (this.locale === 'en' || this.locale === 'en-US') {\n      this.internalTimeFormat = getValue('timeFormats.short', getDefaultDateObject(this.getCalendarMode()));\n    } else {\n      this.internalTimeFormat = getValue('main.' + '' + this.locale + '.dates.calendars.' + this.getCalendarMode() + '.timeFormats.short', cldrData);\n    }\n  }\n  /**\n   * Method to get calendar mode\n   *\n   * @returns {string} Returns the calendar mode\n   * @private\n   */\n\n\n  getCalendarMode() {\n    return this.calendarMode.toLowerCase();\n  }\n  /**\n   * Method to get time in string\n   *\n   * @param {Date} date Accepts the date object\n   * @returns {string} Returns the time in string\n   * @private\n   */\n\n\n  getTimeString(date) {\n    const time = this.globalize.formatDate(date, {\n      format: this.activeViewOptions.timeFormat,\n      type: 'time',\n      calendar: this.getCalendarMode()\n    });\n    return time.toLocaleUpperCase();\n  }\n  /**\n   * Method to get  date object\n   *\n   * @param {Date} date Accepts the date object\n   * @returns {Date} Returns the date object\n   * @private\n   */\n\n\n  getDateTime(date) {\n    return date instanceof Date ? new Date(date.getTime()) : new Date(date);\n  }\n\n  setCalendarMode() {\n    if (this.calendarMode === 'Islamic') {\n      this.calendarUtil = new Islamic();\n    } else {\n      this.calendarUtil = new Gregorian();\n    }\n  }\n  /**\n   * Method to change the current view\n   *\n   * @param {View} view Accepts the view name\n   * @param {Event} event Accepts the event object\n   * @param {boolean} muteOnChange Accepts the value to enable or disable mute on change\n   * @param {number} index Accepts the index value\n   * @returns {void}\n   * @private\n   */\n\n\n  changeView(view, event, muteOnChange, index) {\n    if (isNullOrUndefined(index)) {\n      index = this.getViewIndex(view);\n    }\n\n    if (!muteOnChange && index === this.viewIndex && this.currentView === view || index < 0) {\n      return;\n    }\n\n    this.viewIndex = index;\n    let args = {\n      requestType: 'viewNavigate',\n      cancel: false,\n      event: event\n    };\n    this.trigger(actionBegin, args, actionArgs => {\n      if (!actionArgs.cancel) {\n        const navArgs = {\n          action: 'view',\n          cancel: false,\n          currentDate: this.selectedDate,\n          previousView: this.currentView,\n          currentView: view,\n          viewIndex: this.viewIndex\n        };\n        this.trigger(navigating, navArgs, navigationArgs => {\n          if (!navigationArgs.cancel) {\n            this.uiStateValues.isInitial = view.indexOf('Timeline') > -1 || this.currentView.indexOf('Timeline') > -1 ? true : this.uiStateValues.isInitial;\n            this.viewIndex = navigationArgs.viewIndex;\n            this.setProperties({\n              currentView: view\n            }, true);\n\n            if (this.headerModule) {\n              this.headerModule.updateActiveView();\n              this.headerModule.setCalendarDate(this.selectedDate);\n              this.headerModule.setCalendarView();\n            }\n\n            this.initializeView(this.currentView);\n            this.animateLayout();\n            args = {\n              requestType: 'viewNavigate',\n              cancel: false,\n              event: event\n            };\n            this.trigger(actionComplete, args);\n          }\n        });\n      }\n    });\n  }\n  /**\n   * Method to change the view date\n   *\n   * @param {Date} selectedDate Accepts the selected date\n   * @param {Event} event Accepts the event object\n   * @returns {void}\n   * @private\n   */\n\n\n  changeDate(selectedDate, event) {\n    let args = {\n      requestType: 'dateNavigate',\n      cancel: false,\n      event: event\n    };\n    this.trigger(actionBegin, args, actionArgs => {\n      if (!actionArgs.cancel) {\n        const navArgs = {\n          action: 'date',\n          cancel: false,\n          previousDate: this.selectedDate,\n          currentDate: selectedDate\n        };\n        this.trigger(navigating, navArgs, navigationArgs => {\n          if (!navigationArgs.cancel) {\n            this.uiStateValues.isInitial = this.activeView.isTimelineView() ? true : this.uiStateValues.isInitial;\n            this.validateDate(navigationArgs.currentDate);\n\n            if (this.headerModule) {\n              this.headerModule.setCalendarDate(navigationArgs.currentDate);\n            }\n\n            this.initializeView(this.currentView);\n            this.animateLayout();\n            args = {\n              requestType: 'dateNavigate',\n              cancel: false,\n              event: event\n            };\n            this.trigger(actionComplete, args);\n          }\n        });\n      }\n    });\n  }\n  /**\n   * Method to validate min and max date\n   *\n   * @param {Date} date Accepts the date object\n   * @returns {boolean} Returns the boolean result to validate the min and max date\n   * @private\n   */\n\n\n  isMinMaxDate(date = this.selectedDate) {\n    return date.getTime() >= this.minDate.getTime() && date.getTime() <= this.maxDate.getTime();\n  }\n  /**\n   * Method to validate the selected date\n   *\n   * @param {Date} date Accepts the date object\n   * @returns {boolean} Returns the boolean value for given date is selected date or not\n   * @private\n   */\n\n\n  isSelectedDate(date) {\n    return date.setHours(0, 0, 0, 0) === new Date('' + this.selectedDate).setHours(0, 0, 0, 0);\n  }\n  /**\n   * Method to get the current time\n   *\n   * @param {Date} date Accepts the date object\n   * @returns {Date} Returns the date object after performing the timezone conversion\n   * @private\n   */\n\n\n  getCurrentTime(date = new Date()) {\n    if (this.timezone) {\n      return this.tzModule.convert(date, this.tzModule.getLocalTimezoneName(), this.timezone);\n    }\n\n    return date;\n  }\n  /** Method to get navigate view\n   *\n   * @returns {View} Return the navigate view name\n   * @private\n   */\n\n\n  getNavigateView() {\n    if (this.activeView.isTimelineView()) {\n      return this.currentView === 'TimelineMonth' || this.currentView === 'TimelineYear' ? 'TimelineDay' : 'Agenda';\n    }\n\n    return 'Day';\n  }\n\n  animateLayout() {\n    if (!this.activeView.element) {\n      return;\n    }\n\n    new Animation({\n      duration: 600,\n      name: 'FadeIn',\n      timingFunction: 'easeIn'\n    }).animate(this.activeView.element);\n  }\n  /**\n   * To provide the array of modules needed for control rendering\n   *\n   * @returns {ModuleDeclaration[]} Returns the declared modules\n   * @private\n   */\n\n\n  requiredModules() {\n    const modules = [];\n    this.setViewOptions(true);\n\n    for (let view of Object.keys(this.viewOptions)) {\n      view = view === 'timelineDay' || view === 'timelineWeek' || view === 'timelineWorkWeek' ? 'timelineViews' : view;\n      modules.push({\n        member: view,\n        args: [this]\n      });\n    }\n\n    if (this.allowDragAndDrop) {\n      modules.push({\n        member: 'dragAndDrop',\n        args: [this]\n      });\n    }\n\n    if (this.allowResizing) {\n      modules.push({\n        member: 'resize',\n        args: [this]\n      });\n    }\n\n    modules.push({\n      member: 'excelExport',\n      args: [this]\n    });\n    modules.push({\n      member: 'iCalendarExport',\n      args: [this]\n    });\n    modules.push({\n      member: 'iCalendarImport',\n      args: [this]\n    });\n    modules.push({\n      member: 'print',\n      args: [this]\n    });\n    return modules;\n  }\n  /**\n   * Initializes the values of private members.\n   *\n   * @returns {void}\n   * @private\n   */\n\n\n  preRender() {\n    this.isAdaptive = Browser.isDevice || isIPadDevice();\n    this.globalize = new Internationalization(this.locale);\n    this.tzModule = new Timezone();\n\n    if (this && isNullOrUndefined(this.uiStateValues) || !this.enablePersistence) {\n      this.uiStateValues = {\n        expand: false,\n        isInitial: true,\n        left: 0,\n        top: 0,\n        isGroupAdaptive: false,\n        isIgnoreOccurrence: false,\n        groupIndex: 0,\n        action: false,\n        isBlock: false,\n        isCustomMonth: true,\n        isResize: false\n      };\n    }\n\n    this.activeCellsData = {\n      startTime: this.getCurrentTime(),\n      endTime: this.getCurrentTime(),\n      isAllDay: false\n    };\n    this.activeEventData = {\n      event: undefined,\n      element: undefined\n    };\n    this.getDefaultLocale();\n    this.localeObj = new L10n(this.getModuleName(), this.defaultLocale, this.locale);\n    this.setCldrTimeFormat();\n    this.setCalendarMode();\n    this.eventsData = [];\n    this.eventsProcessed = [];\n    this.blockData = [];\n    this.blockProcessed = [];\n    this.resourceCollection = [];\n    this.currentAction = null;\n    this.selectedElements = [];\n    this.setViewOptions();\n  }\n\n  getDefaultLocale() {\n    this.defaultLocale = {\n      day: 'Day',\n      week: 'Week',\n      workWeek: 'Work Week',\n      month: 'Month',\n      year: 'Year',\n      agenda: 'Agenda',\n      weekAgenda: 'Week Agenda',\n      workWeekAgenda: 'Work Week Agenda',\n      monthAgenda: 'Month Agenda',\n      today: 'Today',\n      noEvents: 'No events',\n      emptyContainer: 'There are no events scheduled on this day.',\n      allDay: 'All day',\n      start: 'Start',\n      end: 'End',\n      more: 'more',\n      close: 'Close',\n      cancel: 'Cancel',\n      noTitle: '(No Title)',\n      delete: 'Delete',\n      deleteEvent: 'Delete Event',\n      deleteMultipleEvent: 'Delete Multiple Events',\n      selectedItems: 'Items selected',\n      deleteSeries: 'Entire Series',\n      edit: 'Edit',\n      editSeries: 'Entire Series',\n      editEvent: 'Edit Event',\n      createEvent: 'Create',\n      subject: 'Subject',\n      addTitle: 'Add title',\n      moreDetails: 'More Details',\n      save: 'Save',\n      editContent: 'How would you like to change the appointment in the series?',\n      deleteContent: 'Are you sure you want to delete this event?',\n      deleteMultipleContent: 'Are you sure you want to delete the selected events?',\n      newEvent: 'New Event',\n      title: 'Title',\n      location: 'Location',\n      description: 'Description',\n      timezone: 'Timezone',\n      startTimezone: 'Start Timezone',\n      endTimezone: 'End Timezone',\n      repeat: 'Repeat',\n      saveButton: 'Save',\n      cancelButton: 'Cancel',\n      deleteButton: 'Delete',\n      recurrence: 'Recurrence',\n      wrongPattern: 'The recurrence pattern is not valid.',\n      seriesChangeAlert: 'Do you want to cancel the changes made to specific ' + 'instances of this series and match it to the whole series again?',\n      createError: 'The duration of the event must be shorter than how frequently it occurs. ' + 'Shorten the duration, or change the recurrence pattern in the recurrence event editor.',\n      sameDayAlert: 'Two occurrences of the same event cannot occur on the same day.',\n      occurenceAlert: 'Cannot reschedule an occurrence of the recurring appointment if it skips over ' + 'a later occurrence of the same appointment.',\n      editRecurrence: 'Edit Recurrence',\n      repeats: 'Repeats',\n      alert: 'Alert',\n      startEndError: 'The selected end date occurs before the start date.',\n      invalidDateError: 'The entered date value is invalid.',\n      blockAlert: 'Events cannot be scheduled within the blocked time range.',\n      ok: 'Ok',\n      yes: 'Yes',\n      no: 'No',\n      occurrence: 'Occurrence',\n      series: 'Series',\n      previous: 'Previous',\n      next: 'Next',\n      timelineDay: 'Timeline Day',\n      timelineWeek: 'Timeline Week',\n      timelineWorkWeek: 'Timeline Work Week',\n      timelineMonth: 'Timeline Month',\n      timelineYear: 'Timeline Year',\n      editFollowingEvent: 'Following Events',\n      deleteTitle: 'Delete Event',\n      editTitle: 'Edit Event',\n      beginFrom: 'Begin From',\n      endAt: 'Ends At',\n      expandAllDaySection: 'Expand-all-day-section',\n      collapseAllDaySection: 'Collapse-all-day-section',\n      searchTimezone: 'Search Timezone',\n      noRecords: 'No records found'\n    };\n  }\n\n  wireEvents() {\n    EventHandler.add(window, 'resize', this.onScheduleResize, this);\n    EventHandler.add(window, 'orientationchange', this.onScheduleResize, this);\n    EventHandler.add(document, Browser.touchStartEvent, this.onDocumentClick, this);\n  }\n  /**\n   * Method to remove selected class\n   *\n   * @returns {void}\n   * @private\n   */\n\n\n  removeSelectedClass() {\n    const selectedCells = this.getSelectedElements();\n\n    for (const cell of selectedCells) {\n      cell.setAttribute('aria-selected', 'false');\n      cell.removeAttribute('tabindex');\n    }\n\n    removeClass(selectedCells, SELECTED_CELL_CLASS);\n  }\n  /**\n   * Method to add selected class\n   *\n   * @param {HTMLTableCellElement[]} cells Accepts the collection of elements\n   * @param {HTMLTableCellElement} focusCell Accepts the focus element\n   * @param {boolean} isPreventScroll Accepts the boolean value to prevent scroll\n   * @returns {void}\n   * @private\n   */\n\n\n  addSelectedClass(cells, focusCell, isPreventScroll) {\n    for (const cell of cells) {\n      cell.setAttribute('aria-selected', 'true');\n    }\n\n    addClass(cells, SELECTED_CELL_CLASS);\n\n    if (focusCell) {\n      focusCell.setAttribute('tabindex', '0');\n      focusCell.focus({\n        preventScroll: isPreventScroll || false\n      });\n    }\n  }\n  /**\n   * Method to select cell\n   *\n   * @param {HTMLElement | HTMLTableCellElement} element Accepts the select element\n   * @returns {void}\n   * @private\n   */\n\n\n  selectCell(element) {\n    this.removeSelectedClass();\n    this.addSelectedClass([element], element);\n  }\n  /**\n   * Method to get all day row element\n   *\n   * @returns {Element} Returns the all day row element\n   * @private\n   */\n\n\n  getAllDayRow() {\n    return this.element.querySelector('.' + ALLDAY_ROW_CLASS);\n  }\n  /**\n   * Method to get content table element\n   *\n   * @returns {HTMLElement} Returns the content table element\n   * @private\n   */\n\n\n  getContentTable() {\n    return this.activeView.element.querySelector('.' + CONTENT_TABLE_CLASS + ' tbody');\n  }\n  /**\n   * Method to get all content table rows\n   *\n   * @returns {HTMLElement[]} Returns the content table rows\n   * @private\n   */\n\n\n  getTableRows() {\n    return [].slice.call(this.element.querySelectorAll('.' + CONTENT_TABLE_CLASS + ' tbody tr:not(.' + HIDDEN_CLASS + ')'));\n  }\n  /**\n   * Method to get work cell elements\n   *\n   * @returns {Element[]} Returns the all work cell elements\n   * @private\n   */\n\n\n  getWorkCellElements() {\n    return [].slice.call(this.element.querySelectorAll('.' + WORK_CELLS_CLASS));\n  }\n  /**\n   * Method to get the index from date collection\n   *\n   * @param {Date[]} collection Accepts the collections of date\n   * @param {Date} date Accepts the date object\n   * @returns {number} Returns the index compared date with date collections\n   * @private\n   */\n\n\n  getIndexOfDate(collection, date) {\n    return collection.map(Number).indexOf(+date);\n  }\n  /**\n   * Method to find all day cell\n   *\n   * @param {Element} td Accepts the DOM Element\n   * @returns {boolean} Returns the boolean value\n   * @private\n   */\n\n\n  isAllDayCell(td) {\n    if (['Month', 'TimelineMonth', 'TimelineYear', 'MonthAgenda'].indexOf(this.currentView) > -1 || td.classList.contains(ALLDAY_CELLS_CLASS) || td.classList.contains(HEADER_CELLS_CLASS) || !this.activeViewOptions.timeScale.enable) {\n      return true;\n    }\n\n    if (this.activeView.isTimelineView() && this.activeViewOptions.headerRows.length > 0 && this.activeViewOptions.headerRows.slice(-1)[0].option !== 'Hour') {\n      return true;\n    }\n\n    return false;\n  }\n  /**\n   * Method to get date from element\n   *\n   * @param {Element} td Accepts the DOM element\n   * @returns {Date} Returns the date object\n   * @private\n   */\n\n\n  getDateFromElement(td) {\n    let dateString;\n\n    if (!isNullOrUndefined(td)) {\n      dateString = td.getAttribute('data-date');\n    }\n\n    if (!isNullOrUndefined(dateString)) {\n      const dateInMS = parseInt(dateString, 10);\n      const date = new Date(dateInMS);\n      return date;\n    }\n\n    return undefined;\n  }\n  /**\n   * Method to get target element from given selector\n   *\n   * @param {string} selector Accepts the element selector\n   * @param {number} left Accepts the pageX value\n   * @param {number} top Accepts the pageY value\n   * @returns {Element[]} Returns the collection of elements based on the given selector\n   * @private\n   */\n\n\n  getTargetElement(selector, left, top) {\n    const element = document.elementFromPoint(left, top);\n    let targetElement;\n\n    if (element) {\n      targetElement = element.closest(selector);\n    }\n\n    return targetElement ? [targetElement] : null;\n  }\n  /**\n   * Method to process cell header template\n   *\n   * @returns {CallbackFunction} Returns the callback function\n   * @private\n   */\n\n\n  getCellHeaderTemplate() {\n    return this.cellHeaderTemplateFn;\n  }\n  /**\n   * Method to process cell header template in year view.\n   *\n   * @returns {CallbackFunction} Returns the callback function\n   * @private\n   */\n\n\n  getDayHeaderTemplate() {\n    return this.dayHeaderTemplateFn;\n  }\n  /**\n   * Method to process cell header template in year view.\n   *\n   * @returns {CallbackFunction} Returns the callback function\n   * @private\n   */\n\n\n  getMonthHeaderTemplate() {\n    return this.monthHeaderTemplateFn;\n  }\n  /**\n   * Method to process cell template\n   *\n   * @returns {CallbackFunction} Returns the callback function\n   * @private\n   */\n\n\n  getCellTemplate() {\n    return this.cellTemplateFn;\n  }\n  /**\n   * Method to process date header template\n   *\n   * @returns {CallbackFunction} Returns the callback function\n   * @private\n   */\n\n\n  getDateHeaderTemplate() {\n    return this.dateHeaderTemplateFn;\n  }\n  /**\n   * Method to process major slot template\n   *\n   * @returns {CallbackFunction} Returns the callback function\n   * @private\n   */\n\n\n  getMajorSlotTemplate() {\n    return this.majorSlotTemplateFn;\n  }\n  /**\n   * Method to process minor slot template\n   *\n   * @returns {CallbackFunction} Returns the callback function\n   * @private\n   */\n\n\n  getMinorSlotTemplate() {\n    return this.minorSlotTemplateFn;\n  }\n  /**\n   * Method to process appointment template\n   *\n   * @returns {CallbackFunction} Returns the callback function\n   * @private\n   */\n\n\n  getAppointmentTemplate() {\n    return this.appointmentTemplateFn;\n  }\n  /**\n   * Method to process appointment tooltip template\n   *\n   * @returns {CallbackFunction} Returns the callback function\n   * @private\n   */\n\n\n  getEventTooltipTemplate() {\n    return this.eventTooltipTemplateFn;\n  }\n  /**\n   * Method to process header tooltip template\n   *\n   * @returns {CallbackFunction} Returns the callback function\n   * @private\n   */\n\n\n  getHeaderTooltipTemplate() {\n    return this.headerTooltipTemplateFn;\n  }\n  /**\n   * Method to process editor template\n   *\n   * @returns {CallbackFunction} Returns the callback function\n   * @private\n   */\n\n\n  getEditorTemplate() {\n    return this.editorTemplateFn;\n  }\n  /**\n   * Method to process quick info header template\n   *\n   * @returns {CallbackFunction} Returns the callback function\n   * @private\n   */\n\n\n  getQuickInfoTemplatesHeader() {\n    return this.quickInfoTemplatesHeaderFn;\n  }\n  /**\n   * Method to process quick info content template\n   *\n   * @returns {CallbackFunction} Returns the callback function\n   * @private\n   */\n\n\n  getQuickInfoTemplatesContent() {\n    return this.quickInfoTemplatesContentFn;\n  }\n  /**\n   * Method to process quick info footer template\n   *\n   * @returns {CallbackFunction} Returns the callback function\n   * @private\n   */\n\n\n  getQuickInfoTemplatesFooter() {\n    return this.quickInfoTemplatesFooterFn;\n  }\n  /**\n   * Method to process resource header template\n   *\n   * @returns {CallbackFunction} Returns the callback function\n   * @private\n   */\n\n\n  getResourceHeaderTemplate() {\n    return this.resourceHeaderTemplateFn;\n  }\n  /**\n   * Method to process indent template\n   *\n   * @returns {CallbackFunction} Returns the callback function\n   * @private\n   */\n\n\n  getHeaderIndentTemplate() {\n    return this.headerIndentTemplateFn;\n  }\n  /**\n   * Method to get dynamic CSS properties\n   *\n   * @returns {ScrollCss} Returns the CSS properties dynamically\n   * @private\n   */\n\n\n  getCssProperties() {\n    const cssProps = {\n      border: this.enableRtl ? 'borderLeftWidth' : 'borderRightWidth',\n      padding: this.enableRtl ? 'paddingLeft' : 'paddingRight',\n      rtlBorder: this.enableRtl ? 'borderRightWidth' : 'borderLeftWidth',\n      rtlPadding: this.enableRtl ? 'paddingRight' : 'paddingLeft'\n    };\n    return cssProps;\n  }\n  /**\n   * Method to remove new event element in adaptive mode\n   *\n   * @returns {void}\n   * @private\n   */\n\n\n  removeNewEventElement() {\n    const eventClone = this.element.querySelector('.' + NEW_EVENT_CLASS);\n\n    if (!isNullOrUndefined(eventClone)) {\n      remove(eventClone);\n    }\n  }\n  /**\n   * Method to get start end time from string\n   *\n   * @param {string} startEndTime Accepts the start end time string value\n   * @returns {Date} Returns the date object\n   * @private\n   */\n\n\n  getStartEndTime(startEndTime) {\n    if (!isNullOrUndefined(startEndTime) && startEndTime !== '') {\n      const startEndDate = resetTime(this.getCurrentTime());\n      const timeString = startEndTime.split(':');\n\n      if (timeString.length === 2) {\n        startEndDate.setHours(parseInt(timeString[0], 10), parseInt(timeString[1], 10), 0);\n      }\n\n      return startEndDate;\n    }\n\n    return null;\n  }\n\n  onDocumentClick(args) {\n    this.notify(documentClick, {\n      event: args\n    });\n  }\n\n  onScheduleResize() {\n    if (isNullOrUndefined(this.activeView) || (this.isAdaptive || isMobile()) && document.activeElement && document.activeElement.classList.contains(SUBJECT_CLASS)) {\n      return;\n    }\n\n    if (this.activeViewOptions.timeScale.enable && this.activeView) {\n      this.activeView.highlightCurrentTime();\n    }\n\n    if (this.quickPopup) {\n      this.quickPopup.onClosePopup();\n    }\n\n    if (this.currentView === 'Month' || this.currentView !== 'Agenda' && this.currentView !== 'MonthAgenda' && !this.activeViewOptions.timeScale.enable || this.activeView.isTimelineView()) {\n      this.uiStateValues.isResize = true;\n      this.activeView.resetColWidth();\n      this.notify(scrollUiUpdate, {\n        cssProperties: this.getCssProperties(),\n        isPreventScrollUpdate: true\n      });\n      this.refreshEvents(false);\n      this.uiStateValues.isResize = false;\n    } else {\n      this.notify(contentReady, {});\n    }\n  }\n  /**\n   * Method to process the templates\n   *\n   * @param {string} template Accepts the template in string\n   * @returns {CallbackFunction} Returns the callback function\n   * @private\n   */\n\n\n  templateParser(template) {\n    if (template) {\n      try {\n        if (document.querySelectorAll(template).length) {\n          return compile(document.querySelector(template).innerHTML.trim());\n        } else {\n          return compile(template);\n        }\n      } catch (error) {\n        return compile(template);\n      }\n    }\n\n    return undefined;\n  }\n  /**\n   * Method to generate the announcement string\n   *\n   * @param {Object} event Accepts the event object\n   * @param {string} subject Accepts the subject text\n   * @returns {string} Returns the announcement string\n   * @private\n   */\n\n\n  getAnnouncementString(event, subject) {\n    let resourceName;\n\n    if (this.quickPopup && this.activeViewOptions.group.resources.length > 0) {\n      const constantText = '\"s event - ';\n      resourceName = this.quickPopup.getResourceText({\n        event: event\n      }, 'event') + constantText;\n    }\n\n    const recordSubject = subject || event[this.eventFields.subject] || this.eventSettings.fields.subject.default;\n    const skeleton = 'full';\n    const startDateText = this.globalize.formatDate(event[this.eventFields.startTime], {\n      type: 'dateTime',\n      skeleton: skeleton,\n      calendar: this.getCalendarMode()\n    });\n    const endDateText = this.globalize.formatDate(event[this.eventFields.endTime], {\n      type: 'dateTime',\n      skeleton: skeleton,\n      calendar: this.getCalendarMode()\n    });\n    let announcementString = recordSubject + ' ' + this.localeObj.getConstant('beginFrom') + ' ' + startDateText + ' ' + this.localeObj.getConstant('endAt') + ' ' + endDateText;\n\n    if (resourceName) {\n      announcementString = resourceName + ' ' + announcementString;\n    }\n\n    return announcementString;\n  }\n  /**\n   * Method to process the element boundary validation\n   *\n   * @param {number} pageY Accepts the pageY value\n   * @param {number} pageX Accepts the pageX value\n   * @returns {ResizeEdges} Returns the boundary validation object\n   * @private\n   */\n\n\n  boundaryValidation(pageY, pageX) {\n    const autoScrollDistance = 30;\n    const scrollEdges = {\n      left: false,\n      right: false,\n      top: false,\n      bottom: false\n    };\n    const viewBoundaries = this.element.querySelector('.' + CONTENT_WRAP_CLASS).getBoundingClientRect();\n\n    if (pageY < viewBoundaries.top + autoScrollDistance + window.pageYOffset && pageY > viewBoundaries.top + window.pageYOffset) {\n      scrollEdges.top = true;\n    }\n\n    if (pageY > viewBoundaries.bottom - autoScrollDistance + window.pageYOffset && pageY < viewBoundaries.bottom + window.pageYOffset) {\n      scrollEdges.bottom = true;\n    }\n\n    if (pageX < viewBoundaries.left + autoScrollDistance + window.pageXOffset && pageX > viewBoundaries.left + window.pageXOffset) {\n      scrollEdges.left = true;\n    }\n\n    if (pageX > viewBoundaries.right - autoScrollDistance + window.pageXOffset && pageX < viewBoundaries.right + window.pageXOffset) {\n      scrollEdges.right = true;\n    }\n\n    return scrollEdges;\n  }\n  /**\n   * Method to get the week number.\n   *\n   * @param {Date[]} dates Accepts the date collections\n   * @returns {number} Returns the week number\n   * @private\n   */\n\n\n  getWeekNumberContent(dates) {\n    let weekNumber;\n\n    if (this.weekRule === 'FirstDay') {\n      const weekNumberDate = getWeekLastDate(dates.slice(-1)[0], this.firstDayOfWeek);\n      weekNumber = this.globalize.formatNumber(getWeekNumber(weekNumberDate));\n    } else if (this.weekRule === 'FirstFourDayWeek') {\n      const weekFirstDate = getWeekFirstDate(dates.slice(-1)[0], this.firstDayOfWeek);\n      const weekLastDate = getWeekLastDate(dates.slice(-1)[0], this.firstDayOfWeek);\n      const weekMidDate = getWeekMiddleDate(weekFirstDate, weekLastDate);\n      weekNumber = this.globalize.formatNumber(getWeekNumber(weekMidDate));\n    } else if (this.weekRule === 'FirstFullWeek') {\n      const weekFirstDate = getWeekFirstDate(dates.slice(-1)[0], this.firstDayOfWeek);\n      weekNumber = this.globalize.formatNumber(getWeekNumber(weekFirstDate));\n    }\n\n    return weekNumber;\n  }\n  /**\n   * Method to render the header indent template.\n   *\n   * @param {TdData} data Accepts the td data\n   * @param {Element} td Accepts the td element\n   * @returns {void}\n   * @private\n   */\n\n\n  renderHeaderIndentTemplate(data, td) {\n    if (this.activeViewOptions.headerIndentTemplate) {\n      const scheduleId = this.element.id + '_';\n      const viewName = this.activeViewOptions.headerIndentTemplateName;\n      const templateId = scheduleId + viewName + 'headerIndentTemplate';\n      const indentTemplate = [].slice.call(this.getHeaderIndentTemplate()(data, this, 'headerIndentTemplate', templateId, false));\n      append(indentTemplate, td);\n    }\n  }\n\n  unWireEvents() {\n    EventHandler.remove(window, 'resize', this.onScheduleResize);\n    EventHandler.remove(window, 'orientationchange', this.onScheduleResize);\n    EventHandler.remove(document, Browser.touchStartEvent, this.onDocumentClick);\n  }\n  /**\n   * Core method to return the component name.\n   *\n   * @returns {string} Returns the module name\n   * @private\n   */\n\n\n  getModuleName() {\n    return 'schedule';\n  }\n  /**\n   * Returns the properties to be maintained in the persisted state.\n   *\n   * @returns {string} Returns the persistance data\n   * @private\n   */\n\n\n  getPersistData() {\n    return this.addOnPersist(['currentView', 'selectedDate', 'scrollTop', 'scrollLeft']);\n  }\n  /**\n   * Called internally, if any of the property value changed.\n   *\n   * @returns {void}\n   * @private\n   */\n\n\n  onPropertyChanged(newProp, oldProp) {\n    if (this.isReact && isNullOrUndefined(this.activeView)) {\n      return;\n    }\n\n    const state = {\n      isRefresh: false,\n      isResource: false,\n      isDate: false,\n      isView: false,\n      isLayout: false,\n      isDataManager: false\n    };\n\n    for (const prop of Object.keys(newProp)) {\n      switch (prop) {\n        case 'views':\n          this.setViewOptions();\n\n          if (this.headerModule) {\n            this.headerModule.updateItems();\n          }\n\n          state.isView = true;\n          break;\n\n        case 'currentView':\n          state.isView = true;\n          break;\n\n        case 'minDate':\n        case 'maxDate':\n        case 'selectedDate':\n          state.isDate = true;\n          break;\n\n        case 'dateFormat':\n          this.activeViewOptions = this.getActiveViewOptions();\n\n          if (this.headerModule) {\n            this.headerModule.updateDateRange(this.activeView.getDateRangeText());\n          }\n\n          break;\n\n        case 'showHeaderBar':\n          this.destroyHeaderModule();\n\n          if (newProp.showHeaderBar) {\n            this.headerModule = new HeaderRenderer(this);\n            this.headerModule.updateDateRange(this.activeView.getDateRangeText());\n          }\n\n          this.notify(scrollUiUpdate, {\n            cssProperties: this.getCssProperties()\n          });\n\n          if (this.activeView.isTimelineView()) {\n            this.refreshEvents(false);\n          }\n\n          break;\n\n        case 'workDays':\n          if (JSON.stringify(oldProp.workDays) !== JSON.stringify(newProp.workDays)) {\n            state.isLayout = true;\n          }\n\n          break;\n\n        case 'showWeekend':\n        case 'startHour':\n        case 'endHour':\n        case 'workHours':\n        case 'readonly':\n        case 'headerRows':\n        case 'showWeekNumber':\n        case 'rowAutoHeight':\n          state.isLayout = true;\n          break;\n\n        case 'locale':\n        case 'calendarMode':\n          this.globalize = new Internationalization(this.locale);\n          this.localeObj = new L10n(this.getModuleName(), this.defaultLocale, this.locale);\n          this.setCldrTimeFormat();\n          this.setCalendarMode();\n          state.isRefresh = true;\n          break;\n\n        case 'firstDayOfWeek':\n          this.activeViewOptions.firstDayOfWeek = newProp.firstDayOfWeek;\n\n          if (this.eventWindow) {\n            this.eventWindow.refreshRecurrenceEditor();\n          }\n\n          state.isLayout = true;\n          break;\n\n        case 'showTimeIndicator':\n          if (this.activeViewOptions.timeScale.enable && this.activeView) {\n            this.activeView.highlightCurrentTime();\n          }\n\n          break;\n\n        case 'cellHeaderTemplate':\n          this.activeViewOptions.cellHeaderTemplate = newProp.cellHeaderTemplate;\n          this.cellHeaderTemplateFn = this.templateParser(this.activeViewOptions.cellHeaderTemplate);\n          state.isLayout = true;\n          break;\n\n        case 'cellTemplate':\n          this.activeViewOptions.cellTemplate = newProp.cellTemplate;\n          this.cellTemplateFn = this.templateParser(this.activeViewOptions.cellTemplate);\n          state.isLayout = true;\n          break;\n\n        case 'dateHeaderTemplate':\n          this.activeViewOptions.dateHeaderTemplate = newProp.dateHeaderTemplate;\n          this.dateHeaderTemplateFn = this.templateParser(this.activeViewOptions.dateHeaderTemplate);\n          state.isLayout = true;\n          break;\n\n        case 'dayHeaderTemplate':\n          this.activeViewOptions.dayHeaderTemplate = newProp.dayHeaderTemplate;\n          this.dayHeaderTemplateFn = this.templateParser(this.activeViewOptions.dayHeaderTemplate);\n          state.isLayout = true;\n          break;\n\n        case 'monthHeaderTemplate':\n          this.activeViewOptions.monthHeaderTemplate = newProp.monthHeaderTemplate;\n          this.monthHeaderTemplateFn = this.templateParser(this.activeViewOptions.monthHeaderTemplate);\n          state.isLayout = true;\n          break;\n\n        case 'resourceHeaderTemplate':\n          this.activeViewOptions.resourceHeaderTemplate = newProp.resourceHeaderTemplate;\n          this.resourceHeaderTemplateFn = this.templateParser(this.activeViewOptions.resourceHeaderTemplate);\n          state.isLayout = true;\n          break;\n\n        case 'timezone':\n          this.eventBase.timezonePropertyChange(oldProp.timezone);\n          this.headerModule.setCalendarTimezone();\n          break;\n\n        case 'enableRtl':\n          this.setRtlClass();\n          state.isRefresh = true;\n          break;\n\n        default:\n          this.extendedPropertyChange(prop, newProp, oldProp, state);\n          break;\n      }\n    }\n\n    this.propertyChangeAction(state);\n  }\n\n  propertyChangeAction(state) {\n    if (state.isRefresh) {\n      this.refresh();\n    } else if (state.isResource) {\n      this.initializeResources(true);\n    } else if (state.isView) {\n      this.changeView(this.currentView, null, true);\n    } else if (state.isDate) {\n      this.changeDate(this.selectedDate);\n    } else if (state.isLayout) {\n      this.initializeView(this.currentView);\n    } else if (state.isDataManager && this.crudModule) {\n      if (this.dragAndDropModule) {\n        this.dragAndDropModule.actionObj.action = '';\n        removeClass([this.element], EVENT_ACTION_CLASS);\n      }\n\n      this.crudModule.refreshDataManager();\n    }\n  }\n\n  allDayRowScrollUpdate() {\n    const dateHeader = this.element.querySelector('.' + DATE_HEADER_WRAP_CLASS);\n    const allDayRow = this.element.querySelector('.' + ALLDAY_ROW_CLASS);\n\n    if (this.height === 'auto' || !this.enableAllDayScroll) {\n      addClass([dateHeader], ALLDAY_APPOINTMENT_AUTO);\n\n      if (dateHeader.classList.contains(ALLDAY_APPOINTMENT_SCROLL)) {\n        removeClass([dateHeader], ALLDAY_APPOINTMENT_SCROLL);\n      }\n\n      if (this.uiStateValues.expand) {\n        const allDayCells = [].slice.call(this.element.querySelectorAll('.' + ALLDAY_CELLS_CLASS));\n        allDayCells[0].style.height = allDayRow.style.height ? allDayRow.style.height : allDayCells[1].style.height;\n      }\n    } else {\n      if (dateHeader.classList.contains(ALLDAY_APPOINTMENT_AUTO)) {\n        removeClass([dateHeader], ALLDAY_APPOINTMENT_AUTO);\n      }\n\n      this.eventBase.allDayExpandScroll(dateHeader);\n    }\n\n    if (!this.uiStateValues.expand) {\n      allDayRow.style.height = '';\n    }\n  }\n\n  extendedPropertyChange(prop, newProp, oldProp, state) {\n    switch (prop) {\n      case 'width':\n      case 'height':\n      case 'enableAllDayScroll':\n        if (['Day', 'Week', 'WorkWeek'].indexOf(this.currentView) > -1) {\n          this.allDayRowScrollUpdate();\n        }\n\n        this.notify(uiUpdate, {\n          module: 'scroll',\n          properties: {\n            width: newProp.width,\n            height: newProp.height\n          }\n        });\n        break;\n\n      case 'cssClass':\n        if (oldProp.cssClass) {\n          removeClass([this.element], oldProp.cssClass.split(' '));\n        }\n\n        if (newProp.cssClass) {\n          addClass([this.element], newProp.cssClass.split(' '));\n        }\n\n        break;\n\n      case 'hideEmptyAgendaDays':\n      case 'agendaDaysCount':\n        this.activeViewOptions = this.getActiveViewOptions();\n        state.isView = true;\n        break;\n\n      case 'eventSettings':\n        this.onEventSettingsPropertyChanged(newProp.eventSettings, oldProp.eventSettings, state);\n        break;\n\n      case 'allowKeyboardInteraction':\n        if (this.keyboardInteractionModule) {\n          this.keyboardInteractionModule.destroy();\n          this.keyboardInteractionModule = null;\n        }\n\n        if (newProp.allowKeyboardInteraction) {\n          this.keyboardInteractionModule = new KeyboardInteraction(this);\n        }\n\n        break;\n\n      case 'timezoneDataSource':\n        if (this.eventWindow) {\n          this.eventWindow.refresh();\n        }\n\n        break;\n\n      case 'editorTemplate':\n        if (!isNullOrUndefined(this.editorTemplate)) {\n          this.editorTemplateFn = this.templateParser(this.editorTemplate);\n        }\n\n        if (this.eventWindow) {\n          this.eventWindow.setDialogContent();\n        }\n\n        break;\n\n      case 'quickInfoTemplates':\n        if (this.quickInfoTemplates.header) {\n          this.quickInfoTemplatesHeaderFn = this.templateParser(this.quickInfoTemplates.header);\n        }\n\n        if (this.quickInfoTemplates.content) {\n          this.quickInfoTemplatesContentFn = this.templateParser(this.quickInfoTemplates.content);\n        }\n\n        if (this.quickInfoTemplates.footer) {\n          this.quickInfoTemplatesFooterFn = this.templateParser(this.quickInfoTemplates.footer);\n        }\n\n        break;\n\n      case 'group':\n        this.onGroupSettingsPropertyChanged(newProp.group, oldProp.group, state);\n        break;\n\n      case 'resources':\n        state.isResource = true;\n        break;\n\n      case 'timeScale':\n        this.activeViewOptions.timeScale.interval = newProp.timeScale.interval || this.activeViewOptions.timeScale.interval;\n        this.activeViewOptions.timeScale.slotCount = newProp.timeScale.slotCount || this.activeViewOptions.timeScale.slotCount;\n\n        if (this.eventWindow) {\n          this.eventWindow.refreshDateTimePicker();\n        }\n\n        state.isLayout = true;\n        break;\n\n      case 'allowDragAndDrop':\n      case 'allowResizing':\n      case 'eventDragArea':\n        this.refreshEvents(false);\n        break;\n\n      case 'weekRule':\n        state.isLayout = true;\n        break;\n\n      case 'firstMonthOfYear':\n        this.activeViewOptions.firstMonthOfYear = newProp.firstMonthOfYear;\n        this.viewIndex = this.activeView.viewIndex;\n        state.isLayout = true;\n        break;\n\n      case 'monthsCount':\n        this.activeViewOptions.monthsCount = newProp.monthsCount;\n        this.viewIndex = this.activeView.viewIndex;\n        state.isLayout = true;\n        break;\n\n      case 'timeFormat':\n        this.internalTimeFormat = newProp.timeFormat || this.activeViewOptions.timeFormat;\n\n        if (this.eventWindow) {\n          this.eventWindow.refreshDateTimePicker();\n        }\n\n        state.isLayout = true;\n        break;\n\n      case 'enableAdaptiveUI':\n        if (this.showHeaderBar && this.headerModule) {\n          this.destroyHeaderModule();\n          this.headerModule = new HeaderRenderer(this);\n          this.headerModule.updateDateRange(this.activeView.getDateRangeText());\n        }\n\n        state.isLayout = true;\n        break;\n\n      case 'headerIndentTemplate':\n        this.activeViewOptions.headerIndentTemplate = newProp.headerIndentTemplate;\n        this.headerIndentTemplateFn = this.templateParser(this.activeViewOptions.headerIndentTemplate);\n        state.isLayout = true;\n        break;\n    }\n  }\n\n  setRtlClass() {\n    if (this.enableRtl) {\n      addClass([this.element], 'e-rtl');\n    } else {\n      removeClass([this.element], 'e-rtl');\n    }\n  }\n\n  onGroupSettingsPropertyChanged(newProp, oldProp, state) {\n    for (const prop of Object.keys(newProp)) {\n      if (prop === 'headerTooltipTemplate') {\n        this.headerTooltipTemplateFn = this.templateParser(newProp[prop]);\n      } else {\n        state.isLayout = true;\n\n        if (this.eventWindow) {\n          this.eventWindow.refresh();\n        }\n      }\n    }\n  }\n\n  onEventSettingsPropertyChanged(newProp, oldProp, state) {\n    for (const prop of Object.keys(newProp)) {\n      switch (prop) {\n        case 'dataSource':\n        case 'query':\n        case 'fields':\n          this.initializeDataModule();\n          state.isDataManager = true;\n          break;\n\n        case 'template':\n          this.activeViewOptions.eventTemplate = newProp.template;\n          this.appointmentTemplateFn = this.templateParser(this.activeViewOptions.eventTemplate);\n          state.isDataManager = true;\n          break;\n\n        case 'enableTooltip':\n          if (this.eventTooltip) {\n            this.eventTooltip.destroy();\n            this.eventTooltip = null;\n          }\n\n          if (newProp.enableTooltip) {\n            this.eventTooltip = new EventTooltip(this);\n          }\n\n          break;\n\n        case 'tooltipTemplate':\n          this.eventTooltipTemplateFn = this.templateParser(this.eventSettings.tooltipTemplate);\n          break;\n\n        case 'resourceColorField':\n          if (this.resourceBase) {\n            this.resourceBase.setResourceCollection();\n          }\n\n          state.isDataManager = true;\n          break;\n\n        case 'editFollowingEvents':\n          if (this.quickPopup) {\n            this.quickPopup.refreshQuickDialog();\n          }\n\n          break;\n\n        case 'allowAdding':\n        case 'allowEditing':\n        case 'allowDeleting':\n          if (this.showHeaderBar && this.headerModule) {\n            this.headerModule.updateAddIcon();\n          }\n\n          if (this.eventWindow) {\n            this.eventWindow.refresh();\n          }\n\n          break;\n\n        case 'spannedEventPlacement':\n        case 'minimumEventDuration':\n        case 'enableMaxHeight':\n        case 'enableIndicator':\n          this.refreshEvents(false);\n          break;\n\n        case 'ignoreWhitespace':\n          state.isLayout = true;\n          break;\n      }\n    }\n  }\n\n  destroyHeaderModule() {\n    if (this.headerModule) {\n      this.headerModule.destroy();\n      this.headerModule = null;\n    }\n  }\n\n  destroyPopups() {\n    if (this.quickPopup) {\n      this.quickPopup.destroy();\n      this.quickPopup = null;\n    }\n\n    if (this.eventWindow) {\n      this.eventWindow.destroy();\n      this.eventWindow = null;\n    }\n  }\n  /**\n   * Allows to show the spinner on schedule at the required scenarios.\n   *\n   * @function showSpinner\n   * @returns {void}\n   */\n\n\n  showSpinner() {\n    showSpinner(this.element);\n  }\n  /**\n   * When the spinner is shown manually using `showSpinner` method, it can be hidden using this `hideSpinner` method.\n   *\n   * @function hideSpinner\n   * @returns {void}\n   */\n\n\n  hideSpinner() {\n    hideSpinner(this.element);\n  }\n  /**\n   * Sets different working hours on the required working days by accepting the required start and end time as well as the date collection\n   *  as its parameters.\n   *\n   * @function setWorkHours\n   * @param {Date} dates Collection of dates on which the given start and end hour range needs to be applied.\n   * @param {string} start Defines the work start hour.\n   * @param {string} end Defines the work end hour.\n   * @param {number} groupIndex Defines the resource index from last level.\n   * @returns {void}\n   */\n\n\n  setWorkHours(dates, start, end, groupIndex) {\n    let cells = [];\n    cells = this.getWorkHourCells(dates, start, end, groupIndex);\n    addClass(cells, WORK_HOURS_CLASS);\n  }\n  /**\n   * Removes or resets different working hours on the required working days by accepting the required start and end time as well as the\n   * date collection as its parameters.\n   * if no parameters has been passed to this function, it will remove all the work hours.\n   *\n   * @param {Date} dates Collection of dates on which the given start and end hour range need to be applied.\n   * @param {string} start Defines the work start hour.\n   * @param {string} end Defines the work end hour.\n   * @param {number} groupIndex Defines the resource index from last level.\n   * @returns {void}\n   */\n\n\n  resetWorkHours(dates = this.activeView.renderDates, start, end, groupIndex) {\n    if (dates && start && end) {\n      const cells = this.getWorkHourCells(dates, start, end, groupIndex);\n      removeClass(cells, WORK_HOURS_CLASS);\n    } else {\n      const workHourCells = [].slice.call(this.element.querySelectorAll('.' + WORK_HOURS_CLASS));\n      removeClass(workHourCells, WORK_HOURS_CLASS);\n    }\n  }\n\n  getWorkHourCells(dates, start, end, groupIndex) {\n    if (['Agenda', 'MonthAgenda', 'Month', 'TimelineMonth'].indexOf(this.currentView) > -1) {\n      return [];\n    }\n\n    let startHour = this.getStartEndTime(start);\n    let endHour = this.getStartEndTime(end);\n    const tableEle = this.getContentTable();\n\n    if (isNullOrUndefined(startHour) || isNullOrUndefined(endHour) || !tableEle) {\n      return [];\n    }\n\n    startHour.setMilliseconds(0);\n    endHour.setMilliseconds(0);\n    const viewStartHour = this.activeView.getStartHour();\n\n    if (startHour < viewStartHour) {\n      startHour = viewStartHour;\n    }\n\n    const viewEndHour = this.activeView.getEndHour();\n\n    if (endHour > viewEndHour) {\n      endHour = viewEndHour;\n    }\n\n    const msMajorInterval = this.activeViewOptions.timeScale.interval * MS_PER_MINUTE;\n    const msInterval = msMajorInterval / this.activeViewOptions.timeScale.slotCount;\n    let startIndex = Math.round((startHour.getTime() - viewStartHour.getTime()) / msInterval);\n    let endIndex = Math.ceil((endHour.getTime() - viewStartHour.getTime()) / msInterval);\n    const tempStartIndex = startIndex;\n    const tempEndIndex = endIndex;\n    const cells = [];\n\n    for (let date of dates) {\n      date = this.getDateTime(date);\n      resetTime(date);\n      let renderDates = this.activeView.renderDates;\n\n      if (!isNullOrUndefined(groupIndex) && this.resourceBase && !this.activeView.isTimelineView()) {\n        renderDates = this.resourceBase.lastResourceLevel[groupIndex].renderDates;\n      }\n\n      const colIndex = this.getIndexOfDate(renderDates, date);\n\n      if (colIndex >= 0) {\n        if (this.activeView.isTimelineView()) {\n          const slotsPerDay = Math.round((viewEndHour.getTime() - viewStartHour.getTime()) / msInterval);\n          startIndex = tempStartIndex + colIndex * slotsPerDay;\n          endIndex = tempEndIndex + colIndex * slotsPerDay;\n        }\n\n        for (let i = startIndex; i < endIndex; i++) {\n          if (this.activeView.isTimelineView()) {\n            const rowIndex = !isNullOrUndefined(groupIndex) ? groupIndex : 0;\n            cells.push(tableEle.rows[rowIndex].cells[i]);\n          } else {\n            if (!isNullOrUndefined(groupIndex)) {\n              const selector = '.' + WORK_CELLS_CLASS + '[data-group-index=\"' + groupIndex + '\"]';\n              const tds = [].slice.call(tableEle.rows[i].querySelectorAll(selector));\n              cells.push(tds[colIndex]);\n            } else {\n              cells.push(tableEle.rows[i].cells[colIndex]);\n            }\n          }\n        }\n      }\n    }\n\n    return cells;\n  }\n  /**\n   * Retrieves the start and end time information of the specific cell element.\n   *\n   * @function getCellDetails\n   * @param {Element | Element[]} tdCol Accepts the single or collection of elements.\n   * @returns {CellClickEventArgs} Object An object holding the startTime, endTime and all-day information along with the target HTML element will be returned.\n   */\n\n\n  getCellDetails(tdCol) {\n    const td = tdCol instanceof Array ? tdCol : [tdCol];\n    const firstTd = getElement(td[0]);\n    const lastTd = getElement(td.slice(-1)[0]);\n    const startTime = this.getDateFromElement(firstTd);\n    let endTime = this.getDateFromElement(lastTd);\n\n    if (isNullOrUndefined(startTime) || isNullOrUndefined(endTime)) {\n      return undefined;\n    }\n\n    const endDateFromColSpan = this.activeView.isTimelineView() && !isNullOrUndefined(lastTd.getAttribute('colSpan')) && this.headerRows.length > 0;\n    const duration = endDateFromColSpan ? parseInt(lastTd.getAttribute('colSpan'), 10) : 1;\n\n    if (!this.activeViewOptions.timeScale.enable || endDateFromColSpan || lastTd.classList.contains(ALLDAY_CELLS_CLASS) || lastTd.classList.contains(HEADER_CELLS_CLASS)) {\n      endTime = addDays(new Date(endTime.getTime()), duration);\n    } else {\n      endTime = this.activeView.getEndDateFromStartDate(endTime);\n    }\n\n    const data = {\n      startTime: startTime,\n      endTime: endTime,\n      isAllDay: this.isAllDayCell(firstTd),\n      element: tdCol\n    };\n    const groupIndex = firstTd.getAttribute('data-group-index');\n\n    if (!isNullOrUndefined(groupIndex)) {\n      data.groupIndex = parseInt(groupIndex, 10);\n    }\n\n    return data;\n  }\n  /**\n   * Retrieves the selected cell elements.\n   *\n   * @function getSelectedElements\n   * @returns {Element[]} The elements of currently selected cells will be returned.\n   */\n\n\n  getSelectedElements() {\n    return [].slice.call(this.element.querySelectorAll('.' + SELECTED_CELL_CLASS));\n  }\n  /**\n   * To get the resource collection\n   *\n   * @function getResourceCollections\n   * @returns {ResourcesModel[]} Returns the resource collections\n   */\n\n\n  getResourceCollections() {\n    return this.resourceCollection;\n  }\n  /**\n   * To set the resource collection\n   *\n   * @function setResourceCollections\n   * @param {ResourcesModel[]} resourceCol Accepts the resource collections in ResourcesModel type\n   * @returns {void}\n   */\n\n\n  setResourceCollections(resourceCol) {\n    this.setProperties({\n      resources: resourceCol\n    }, false);\n  }\n  /**\n   * Current View could be change based on the provided parameters.\n   *\n   * @function changeCurrentView\n   * @param {View} viewName Accept the view in the viewCollections.\n   * @param {number} viewIndex Accept the viewIndex in the viewCollections.\n   * @returns {void}\n   */\n\n\n  changeCurrentView(viewName, viewIndex) {\n    let index = this.getViewIndex(viewName);\n    const view = viewName.charAt(0).toLowerCase() + viewName.slice(1);\n    const viewOptions = this.viewOptions[view];\n\n    if (viewOptions) {\n      index = this.viewCollections.indexOf(viewOptions[viewIndex || 0]);\n    }\n\n    if (index === -1 || index === this.viewIndex) {\n      return;\n    }\n\n    this.changeView(viewName, null, null, index);\n  }\n  /**\n   * Return the current view Index.\n   *\n   * @function getCurrentViewIndex\n   * @returns {number} Returns the view index\n   */\n\n\n  getCurrentViewIndex() {\n    return this.viewIndex;\n  }\n  /**\n   * Retrieves the resource details based on the provided resource index.\n   *\n   * @param {number} index index of the resources at the last level.\n   * @returns {ResourceDetails} Object An object holding the details of resource and resourceData.\n   */\n\n\n  getResourcesByIndex(index) {\n    if (this.resourceBase && this.resourceBase.lastResourceLevel) {\n      if (index < 0 || index >= this.resourceBase.lastResourceLevel.length) {\n        return undefined;\n      }\n\n      const data = this.resourceBase.lastResourceLevel[index];\n      const groupData = {};\n      this.resourceBase.setResourceValues(groupData, index);\n      return {\n        resource: data.resource,\n        resourceData: data.resourceData,\n        groupData: groupData\n      };\n    }\n\n    return undefined;\n  }\n  /**\n   * This method allows to expand the resource that available on the scheduler.\n   *\n   * @function expandResource\n   * @param {string | number} resourceId Accepts the resource id in either string or number type\n   * @param {string} name Accepts the name of the resource collection\n   * @returns {void}\n   */\n\n\n  expandResource(resourceId, name) {\n    if (this.activeView.isTimelineView() && this.resourceBase && this.resourceCollection.length > 1) {\n      this.resourceBase.resourceExpand(resourceId, name, false);\n    }\n  }\n  /**\n   * This method allows to collapse the resource that available on the scheduler.\n   *\n   * @function collapseResource\n   * @param {string | number} resourceId Accepts the resource id in either string or number type\n   * @param {string} name Accepts the name of the resource collection\n   * @returns {void}\n   */\n\n\n  collapseResource(resourceId, name) {\n    if (this.activeView.isTimelineView() && this.resourceBase && this.resourceCollection.length > 1) {\n      this.resourceBase.resourceExpand(resourceId, name, true);\n    }\n  }\n  /**\n   * Scrolls the Schedule content area to the specified time.\n   *\n   * @function scrollTo\n   * @param {string} hour Accepts the time value in the skeleton format of 'Hm'.\n   * @param {Date} scrollDate Accepts the date object value.\n   * @returns {void}\n   */\n\n\n  scrollTo(hour, scrollDate) {\n    if (this.activeView.scrollToDate && isNullOrUndefined(hour) && scrollDate) {\n      this.activeView.scrollToDate(scrollDate);\n    } else if (this.activeView.scrollToHour) {\n      this.activeView.scrollToHour(hour, scrollDate);\n    }\n  }\n  /**\n   * This method allows scroll to the position of the any resources that available on the scheduler.\n   * This method is applicable for without Agenda and Month agenda views of the schedule.\n   *\n   * @function scrollToResource\n   * @param {string | number} resourceId Accepts the resource id in either string or number type\n   * @param {string} groupName Accepts the name of the resource collection\n   * @returns {void}\n   */\n\n\n  scrollToResource(resourceId, groupName) {\n    if (this.resourceBase && this.resourceBase.lastResourceLevel) {\n      this.resourceBase.resourceScroll(resourceId, groupName);\n    }\n  }\n  /**\n   * Exports the Scheduler events to a calendar (.ics) file. By default, the calendar is exported with a file name `Calendar.ics`.\n   * To change this file name on export, pass the custom string value as `fileName` to get the file downloaded with this provided name.\n   *\n   * @function exportToICalendar\n   * @param {string} fileName Accepts the string value.\n   * @param {Object[]} customData Accepts the collection of objects.\n   * @returns {void}\n   */\n\n\n  exportToICalendar(fileName, customData) {\n    if (this.iCalendarExportModule) {\n      this.iCalendarExportModule.initializeCalendarExport(fileName, customData);\n    } else {\n      throw Error('Inject ICalendarExport module');\n    }\n  }\n  /**\n   * Imports the events from an .ics file downloaded from any of the calendars like Google or Outlook into the Scheduler.\n   * This method accepts the blob object or string format of an .ics file to be imported as a mandatory argument.\n   *\n   * @function importICalendar\n   * @param {Blob | string} fileContent Accepts the file object or string format of an .ics file.\n   * @returns {void}\n   */\n\n\n  importICalendar(fileContent) {\n    if (this.iCalendarImportModule) {\n      this.iCalendarImportModule.initializeCalendarImport(fileContent);\n    } else {\n      throw Error('Inject ICalendarImport module');\n    }\n  }\n  /**\n   * Adds the newly created event into the Schedule dataSource.\n   *\n   * @function addEvent\n   * @param {Object | Object[]} data Single or collection of event objects to be added into Schedule.\n   * @returns {void}\n   */\n\n\n  addEvent(data) {\n    this.crudModule.addEvent(data);\n  }\n  /**\n   * Allows the Scheduler events data to be exported as an Excel file either in .xlsx or .csv file formats.\n   * By default, the whole event collection bound to the Scheduler gets exported as an Excel file.\n   * To export only the specific events of Scheduler, you need to pass the custom data collection as\n   * a parameter to this `exportToExcel` method. This method accepts the export options as arguments such as fileName,\n   * exportType, fields, customData, and includeOccurrences. The `fileName` denotes the name to be given for the exported\n   * file and the `exportType` allows you to set the format of an Excel file to be exported either as .xlsx or .csv.\n   * The custom or specific field collection of event dataSource to be exported can be provided through `fields` option\n   * and the custom data collection can be exported by passing them through the `customData` option. There also exists\n   * option to export each individual instances of the recurring events to an Excel file, by setting true or false to the\n   * `includeOccurrences` option, denoting either to include or exclude the occurrences as separate instances on an exported Excel file.\n   *\n   * @function exportToExcel\n   * @param {ExportOptions} excelExportOptions The export options to be set before start with exporting the Scheduler events to an Excel file.\n   * @returns {void}\n   */\n\n\n  exportToExcel(excelExportOptions) {\n    if (this.excelExportModule) {\n      this.excelExportModule.initializeExcelExport(excelExportOptions);\n    } else {\n      throw Error('Inject ExcelExport module');\n    }\n  }\n  /**\n   * Method allows to print the scheduler.\n   *\n   * @function print\n   * @param {ScheduleModel} printOptions The export options to be set before start with exporting\n   * the Scheduler events to the print window.\n   * @returns {void}\n   */\n\n\n  print(printOptions) {\n    if (this.printModule) {\n      this.printModule.print(printOptions);\n    } else {\n      throw Error('Inject Print module');\n    }\n  }\n  /**\n   * Updates the changes made in the event object by passing it as an parameter into the dataSource.\n   *\n   * @function saveEvent\n   * @param {Object | Object[]} data Single or collection of event objects to be saved into Schedule.\n   * @param {CurrentAction} currentAction Denotes the action that takes place either for editing occurrence or series.\n   *  The valid current action names are `EditOccurrence` or `EditSeries`.\n   * @returns {void}\n   */\n\n\n  saveEvent(data, currentAction) {\n    this.crudModule.saveEvent(data, currentAction);\n  }\n  /**\n   * Deletes the events based on the provided ID or event collection in the argument list.\n   *\n   * @function deleteEvent\n   * @param {string | number | Object | Object[]} id Accepts the ID as string or number type or single or collection of the event object which needs to be removed from the Schedule.\n   * @param {CurrentAction} currentAction Denotes the delete action that takes place either on occurrence or series events.\n   *  The valid current action names are `Delete`, `DeleteOccurrence` or `DeleteSeries`.\n   * @returns {void}\n   */\n\n\n  deleteEvent(id, currentAction) {\n    this.crudModule.deleteEvent(id, currentAction);\n  }\n  /**\n   * Retrieves the entire collection of events bound to the Schedule.\n   *\n   * @function getEvents\n   * @param {Date} startDate Accepts the start date.\n   * @param {Date} endDate Accepts te end date.\n   * @param {boolean} includeOccurrences Accepts the boolean value to process the occurrence from recurrence series.\n   * @returns {Object[]} Returns the collection of event objects from the Schedule.\n   */\n\n\n  getEvents(startDate, endDate, includeOccurrences) {\n    let eventCollections = [];\n\n    if (includeOccurrences) {\n      eventCollections = this.eventBase.getProcessedEvents();\n    } else {\n      eventCollections = this.eventsData;\n    }\n\n    if (startDate) {\n      startDate = this.getDateTime(startDate);\n    }\n\n    if (endDate) {\n      endDate = this.getDateTime(endDate);\n    }\n\n    eventCollections = this.eventBase.filterEventsByRange(eventCollections, startDate, endDate);\n    return eventCollections;\n  }\n  /**\n   * Retrieves the entire collection of block events bound to the Schedule.\n   *\n   * @function getBlockEvents\n   * @param {Date} startDate Accepts the start date.\n   * @param {Date} endDate Accepts te end date.\n   * @param {boolean} includeOccurrences Accepts the boolean value to process the occurrence from recurrence series.\n   * @returns {Object[]} Returns the collection of block event objects from the Schedule.\n   */\n\n\n  getBlockEvents(startDate, endDate, includeOccurrences) {\n    let eventCollections = [];\n\n    if (includeOccurrences) {\n      eventCollections = this.eventBase.getProcessedEvents(this.blockData);\n    } else {\n      eventCollections = this.blockData;\n    }\n\n    if (startDate) {\n      startDate = this.getDateTime(startDate);\n    }\n\n    if (endDate) {\n      endDate = this.getDateTime(endDate);\n    }\n\n    eventCollections = this.eventBase.filterEventsByRange(eventCollections, startDate, endDate);\n    return eventCollections;\n  }\n  /**\n   * Retrieves the occurrences of a single recurrence event based on the provided parent ID.\n   *\n   * @function getOccurrencesByID\n   * @param {number} eventID ID of the parent recurrence data from which the occurrences are fetched.\n   * @returns {Object[]} Returns the collection of occurrence event objects.\n   */\n\n\n  getOccurrencesByID(eventID) {\n    return this.eventBase.getOccurrencesByID(eventID);\n  }\n  /**\n   * Retrieves all the occurrences that lies between the specific start and end time range.\n   *\n   * @function getOccurrencesByRange\n   * @param {Date} startTime Denotes the start time range.\n   * @param {Date} endTime Denotes the end time range.\n   * @returns {Object[]} Returns the collection of occurrence event objects that lies between the provided start and end time.\n   */\n\n\n  getOccurrencesByRange(startTime, endTime) {\n    startTime = this.getDateTime(startTime);\n    endTime = this.getDateTime(endTime);\n    return this.eventBase.getOccurrencesByRange(startTime, endTime);\n  }\n  /**\n   * Retrieves the dates that lies on active view of Schedule.\n   *\n   * @function getCurrentViewDates\n   * @returns {Date[]} Returns the collection of dates.\n   */\n\n\n  getCurrentViewDates() {\n    return this.activeView ? this.activeView.renderDates : [];\n  }\n  /**\n   * Set the recurrence editor instance from custom editor template.\n   *\n   * @function setRecurrenceEditor\n   * @param {RecurrenceEditor} recurrenceEditor instance has passed to fetch the instance in event window.\n   * @returns {void}\n   */\n\n\n  setRecurrenceEditor(recurrenceEditor) {\n    this.eventWindow.setRecurrenceEditor(recurrenceEditor);\n  }\n  /**\n   * Get the maximum id of an event.\n   *\n   * @function getEventMaxID\n   * @returns {number | string} Returns the maximum ID from scheduler data collections.\n   */\n\n\n  getEventMaxID() {\n    return this.eventBase.getEventMaxID();\n  }\n  /**\n   * Get deleted occurrences from given recurrence series.\n   *\n   * @function getDeletedOccurrences\n   * @param {string | number | Object} recurrenceData Accepts the parent ID of the event object or parent event object\n   * @returns {Object[]} Returns the collection of deleted occurrence events.\n   */\n\n\n  getDeletedOccurrences(recurrenceData) {\n    return this.eventBase.getDeletedOccurrences(recurrenceData);\n  }\n  /**\n   * Retrieves the events that lies on the current date range of the active view of Schedule.\n   *\n   * @function getCurrentViewEvents\n   * @returns {Object[]} Returns the collection of events.\n   */\n\n\n  getCurrentViewEvents() {\n    return this.eventsProcessed;\n  }\n  /**\n   * Refreshes the event dataSource. This method may be useful when the events alone in the schedule needs to be re-rendered.\n   *\n   * @function refreshEvents\n   * @param {boolean} isRemoteRefresh Accepts the boolean to refresh data from remote or local\n   * @returns {void}\n   */\n\n\n  refreshEvents(isRemoteRefresh = true) {\n    if (this.dragAndDropModule) {\n      this.dragAndDropModule.actionObj.action = '';\n      removeClass([this.element], EVENT_ACTION_CLASS);\n    }\n\n    if (isRemoteRefresh) {\n      this.crudModule.refreshDataManager();\n    } else {\n      if (this.activeViewOptions && this.activeViewOptions.eventTemplate) {\n        let templateNames = ['eventTemplate'];\n\n        if (this.crudModule && this.crudModule.crudObj.isCrudAction && ['Agenda', 'MonthAgenda', 'Year', 'TimelineYear'].indexOf(this.currentView) === -1) {\n          templateNames = [];\n\n          for (let i = 0, len = this.crudModule.crudObj.sourceEvent.length; i < len; i++) {\n            templateNames.push('eventTemplate_' + this.crudModule.crudObj.sourceEvent[i].groupIndex);\n\n            if (this.crudModule.crudObj.targetEvent[i] && this.crudModule.crudObj.sourceEvent[i].groupIndex !== this.crudModule.crudObj.targetEvent[i].groupIndex) {\n              templateNames.push('eventTemplate_' + this.crudModule.crudObj.targetEvent[i].groupIndex);\n            }\n          }\n        }\n\n        this.resetTemplates(templateNames);\n      }\n\n      const eventsData = this.eventsData || [];\n      const blockData = this.blockData || [];\n      const data = eventsData.concat(blockData);\n      this.notify(dataReady, {\n        processedData: this.eventBase ? this.eventBase.processData(data) : []\n      });\n    }\n  }\n  /**\n   * Method to refresh the given Schedule templates\n   *\n   * @param {string} templateName Accepts the template name\n   * @returns {void}\n   */\n\n\n  refreshTemplates(templateName) {\n    if (templateName) {\n      this.resetTemplates([templateName]);\n    } else {\n      this.resetTemplates();\n    }\n\n    switch (templateName) {\n      case 'eventTemplate':\n        this.appointmentTemplateFn = this.templateParser(this.activeViewOptions.eventTemplate);\n        this.refreshEvents(false);\n        break;\n\n      case 'dateHeaderTemplate':\n        this.dateHeaderTemplateFn = this.templateParser(this.activeViewOptions.dateHeaderTemplate);\n        this.activeView.refreshHeader();\n        break;\n\n      case 'resourceHeaderTemplate':\n        this.resourceHeaderTemplateFn = this.templateParser(this.activeViewOptions.resourceHeaderTemplate);\n\n        if (this.activeView.isTimelineView()) {\n          this.activeView.refreshResourceHeader();\n        } else {\n          this.activeView.refreshHeader();\n        }\n\n        break;\n\n      case 'quickInfoTemplates':\n        if (this.quickPopup) {\n          this.quickPopup.destroy();\n          this.quickPopup = null;\n        }\n\n        this.quickPopup = new QuickPopups(this);\n        this.quickInfoTemplatesHeaderFn = this.templateParser(this.quickInfoTemplates.header);\n        this.quickInfoTemplatesContentFn = this.templateParser(this.quickInfoTemplates.content);\n        this.quickInfoTemplatesFooterFn = this.templateParser(this.quickInfoTemplates.footer);\n        break;\n\n      case 'editorTemplate':\n        if (this.eventWindow) {\n          this.eventWindow.destroy();\n          this.eventWindow = null;\n        }\n\n        this.eventWindow = new EventWindow(this);\n        this.editorTemplateFn = this.templateParser(this.editorTemplate);\n        break;\n\n      case 'tooltipTemplate':\n      case 'headerTooltipTemplate':\n        if (this.eventTooltip) {\n          this.eventTooltip.destroy();\n          this.eventTooltip = null;\n        }\n\n        this.eventTooltip = new EventTooltip(this);\n        this.eventTooltipTemplateFn = this.templateParser(this.eventSettings.tooltipTemplate);\n        this.headerTooltipTemplateFn = this.templateParser(this.activeViewOptions.group.headerTooltipTemplate);\n        break;\n\n      default:\n        this.initializeView(this.currentView);\n        break;\n    }\n  }\n  /**\n   * Refreshes the Schedule layout without re-render.\n   *\n   * @function refreshLayout\n   * @returns {void}\n   */\n\n\n  refreshLayout() {\n    this.onScheduleResize();\n\n    if (this.headerModule) {\n      this.headerModule.refresh();\n    }\n\n    if (this.eventWindow) {\n      this.eventWindow.refresh();\n    }\n  }\n  /**\n   * To retrieve the appointment object from element.\n   *\n   * @function getEventDetails\n   * @param {Element} element Denotes the event UI element on the Schedule.\n   * @returns {Object} Returns the event details.\n   */\n\n\n  getEventDetails(element) {\n    element = getElement(element);\n    const guid = element.getAttribute('data-guid');\n\n    if (guid) {\n      return this.eventBase.getEventByGuid(guid);\n    }\n\n    return {};\n  }\n  /**\n   * To check whether the given time range slots are available for event creation or already occupied by other events.\n   *\n   * @function isSlotAvailable\n   * @param {Date | Object} startTime Denotes the start time of the slot.\n   * @param {Date} endTime Denotes the end time of the slot.\n   * @param {number} groupIndex Defines the resource index from last level.\n   * @returns {boolean} Returns true, if the slot that lies in the provided time range does not contain any other events.\n   */\n\n\n  isSlotAvailable(startTime, endTime, groupIndex) {\n    let eventStart;\n    let eventEnd;\n    let eventObj = this.activeEventData.event;\n\n    if (startTime instanceof Date || typeof startTime === 'string') {\n      eventStart = startTime;\n      eventEnd = endTime;\n    } else {\n      eventObj = startTime;\n      eventStart = startTime[this.eventFields.startTime];\n      eventEnd = startTime[this.eventFields.endTime];\n\n      if (this.resourceBase) {\n        groupIndex = this.eventBase.getGroupIndexFromEvent(startTime);\n      }\n    }\n\n    if (isNullOrUndefined(eventStart) || isNullOrUndefined(eventEnd)) {\n      return true;\n    }\n\n    eventStart = this.getDateTime(eventStart);\n    eventEnd = this.getDateTime(eventEnd);\n    let eventCollection = this.eventBase.filterEvents(eventStart, eventEnd);\n\n    if (!isNullOrUndefined(groupIndex) && this.resourceBase && this.resourceBase.lastResourceLevel.length > 0) {\n      eventCollection = this.eventBase.filterEventsByResource(this.resourceBase.lastResourceLevel[groupIndex], eventCollection);\n    }\n\n    if (eventObj) {\n      if (eventObj.Guid) {\n        eventCollection = eventCollection.filter(event => event.Guid !== eventObj.Guid);\n      } else {\n        eventCollection = eventCollection.filter(event => event[this.eventFields.id] !== eventObj[this.eventFields.id]);\n      }\n    }\n\n    return eventCollection.length > 0 ? false : true;\n  }\n  /**\n   * To manually open the event editor on specific time or on certain events.\n   *\n   * @function openEditor\n   * @param {Object} data It can be either cell data or event data.\n   * @param {CurrentAction} action Defines the action for which the editor needs to be opened such as either for new event creation or\n   *  for editing of existing events. The applicable action names that can be used here are `Add`, `Save`, `EditOccurrence`\n   *  and `EditSeries`.\n   * @param {boolean} isEventData It allows to decide whether the editor needs to be opened with the clicked cell details or with the\n   *  passed event details.\n   * @param {number} repeatType It opens the editor with the recurrence options based on the provided repeat type.\n   * @returns {void}\n   */\n\n\n  openEditor(data, action, isEventData, repeatType) {\n    if (action === 'Add' && !isEventData) {\n      data.startTime = this.getDateTime(data.startTime);\n      data.endTime = this.getDateTime(data.endTime);\n\n      if (!isNullOrUndefined(data.element)) {\n        data.element = getElement(data.element);\n      }\n    } else {\n      data[this.eventFields.startTime] = this.getDateTime(data[this.eventFields.startTime]);\n      data[this.eventFields.endTime] = this.getDateTime(data[this.eventFields.endTime]);\n    }\n\n    this.currentAction = action;\n\n    if (action !== 'Add') {\n      this.activeEventData.event = data;\n    }\n\n    this.eventWindow.openEditor(data, action, isEventData, repeatType);\n  }\n  /**\n   * To manually close the event editor window\n   *\n   * @function closeEditor\n   * @returns {void}\n   */\n\n\n  closeEditor() {\n    if (this.eventWindow) {\n      this.eventWindow.dialogClose();\n    }\n  }\n  /**\n   * To manually open the quick info popup based on cell or event details.\n   *\n   * @param {object} data Defines the cell or event data. If the data contains valid ID, it will open event quick info popup,\n   * otherwise cell quick info popup displayed.\n   * @returns {void}\n   */\n\n\n  openQuickInfoPopup(data) {\n    if (this.currentView === 'Year' || isNullOrUndefined(data)) {\n      return;\n    }\n\n    if (isNullOrUndefined(data[this.eventFields.id])) {\n      if (this.currentView === 'Agenda' || this.currentView === 'MonthAgenda' || isNullOrUndefined(this.activeView)) {\n        return;\n      }\n\n      const cellData = {\n        startTime: this.activeCellsData.startTime = this.getDateTime(data[this.eventFields.startTime]),\n        endTime: this.activeCellsData.endTime = this.getDateTime(data[this.eventFields.endTime]),\n        isAllDay: this.activeCellsData.isAllDay = !isNullOrUndefined(data[this.eventFields.isAllDay]) ? data[this.eventFields.isAllDay] : false\n      };\n      const startTime = this.activeView.getAdjustedDate(new Date(cellData.startTime));\n\n      if (startTime) {\n        let query = '.' + WORK_CELLS_CLASS + '[data-date=\"' + startTime.getTime() + '\"]';\n\n        if (this.activeViewOptions.group.resources.length > 0 && !this.uiStateValues.isGroupAdaptive && this.resourceBase && this.eventBase) {\n          cellData.groupIndex = this.eventBase.getGroupIndexFromEvent(data);\n          query = '.' + WORK_CELLS_CLASS + '[data-date=\"' + startTime.getTime() + '\"][data-group-index=\"' + cellData.groupIndex + '\"]';\n        }\n\n        const workCell = this.element.querySelector(query);\n\n        if (workCell) {\n          workCell.focus();\n          cellData.element = workCell;\n          this.notify(cellClick, cellData);\n        }\n      }\n    } else {\n      const app = this.getCurrentViewEvents().filter(item => data[this.eventFields.id] === item[this.eventFields.id]);\n\n      if (app.length <= 0) {\n        return;\n      }\n\n      let selectEvent = app[0];\n\n      if (data[this.eventFields.recurrenceRule]) {\n        const occurence = app.filter(x => x[this.eventFields.startTime].getTime() === data[this.eventFields.startTime].getTime());\n\n        if (occurence.length > 0) {\n          selectEvent = occurence[0];\n        }\n      }\n\n      const element = this.element.querySelector('div[data-guid=\"' + selectEvent.Guid + '\"]');\n\n      if (element) {\n        this.eventBase.removeSelectedAppointmentClass();\n        this.eventBase.addSelectedAppointments([element]);\n        this.activeEventData = {\n          event: selectEvent,\n          element: element\n        };\n\n        if (this.currentView === 'Agenda' || this.currentView === 'MonthAgenda') {\n          addClass([this.activeEventData.element], AGENDA_SELECTED_CELL);\n        }\n\n        this.notify(eventClick, this.activeEventData);\n      }\n    }\n  }\n  /**\n   * To manually close the quick info popup\n   *\n   * @function closeQuickInfoPopup\n   * @returns {void}\n   */\n\n\n  closeQuickInfoPopup() {\n    if (this.quickPopup) {\n      this.quickPopup.quickPopupHide(true);\n    }\n  }\n  /**\n   * Select the resource based on group index in mobile mode.\n   *\n   * @param {number} groupIndex Defines the resource index based on last level.\n   * @returns {void}\n   */\n\n\n  selectResourceByIndex(groupIndex) {\n    if (this.resourceBase && this.uiStateValues.isGroupAdaptive) {\n      this.resourceBase.selectResourceByIndex(groupIndex);\n    }\n  }\n  /**\n   * Select the resources to the based on id.\n   *\n   * @param {string | number} id id of the resource defined in resources collection.\n   * @param {string} name Name of the resource defined in resources collection.\n   * @returns {number} Returns the group index\n   */\n\n\n  getIndexFromResourceId(id, name) {\n    if (this.resourceBase) {\n      return this.resourceBase.getIndexFromResourceId(id, name);\n    }\n\n    return null;\n  }\n  /**\n   * Adds the resources to the specified index.\n   *\n   * @param {Object | Object[]} resources Accepts the resource data in single or collection of data.\n   * @param {string} name Name of the resource defined in resources collection.\n   * @param {number} index Index or position where the resource should be added.\n   * @returns {void}\n   */\n\n\n  addResource(resources, name, index) {\n    this.resourceBase.addResource(resources, name, index);\n  }\n  /**\n   * Removes the specified resource.\n   *\n   * @param {string | string[] | number | number[]} resourceId Specifies the resource id to be removed.\n   * @param {string} name Specifies the resource name from which the id should be referred.\n   * @returns {void}\n   */\n\n\n  removeResource(resourceId, name) {\n    this.resourceBase.removeResource(resourceId, name);\n  }\n  /**\n   * Destroys the Schedule component.\n   *\n   * @function destroy\n   * @returns {void}\n   */\n\n\n  destroy() {\n    if (this.eventTooltip) {\n      this.eventTooltip.destroy();\n      this.eventTooltip = null;\n    }\n\n    this.destroyPopups();\n    this.hideSpinner();\n    this.unWireEvents();\n    this.destroyHeaderModule();\n\n    if (this.eventTooltip) {\n      this.eventTooltip.destroy();\n      this.eventTooltip = null;\n    }\n\n    if (this.eventBase) {\n      this.eventBase.destroy();\n      this.eventBase = null;\n    }\n\n    if (this.workCellAction) {\n      this.workCellAction.destroy();\n      this.workCellAction = null;\n    }\n\n    if (this.inlineModule) {\n      this.inlineModule.destroy();\n      this.inlineModule = null;\n    }\n\n    if (this.keyboardInteractionModule) {\n      this.keyboardInteractionModule.destroy();\n      this.keyboardInteractionModule = null;\n    }\n\n    if (this.scrollModule) {\n      this.scrollModule.destroy();\n      this.scrollModule = null;\n    }\n\n    if (this.printModule) {\n      this.printModule.destroy();\n    }\n\n    if (this.activeView) {\n      this.resetTemplates();\n      this.activeView.removeEventListener();\n      this.activeView.destroy();\n      this.activeView = null;\n    }\n\n    if (this.scheduleTouchModule) {\n      this.scheduleTouchModule.destroy();\n      this.scheduleTouchModule = null;\n    }\n\n    if (this.crudModule) {\n      this.crudModule.destroy();\n      this.crudModule = null;\n    }\n\n    if (this.dataModule) {\n      this.dataModule.destroy();\n      this.dataModule = null;\n    }\n\n    super.destroy();\n    const modules = ['dayModule', 'weekModule', 'workWeekModule', 'monthModule', 'monthAgendaModule', 'yearModule', 'agendaModule', 'timelineViewsModule', 'timelineMonthModule', 'timelineYearModule', 'resizeModule', 'dragAndDropModule', 'excelExportModule', 'printModule', 'iCalendarExportModule', 'iCalendarImportModule', 'tzModule', 'eventsData', 'eventsProcessed', 'blockData', 'blockProcessed', 'uiStateValues', 'viewCollections', 'viewOptions', 'defaultLocale', 'localeObj', 'selectedElements', 'resourceCollection', 'editorTitles', 'eventFields', 'activeViewOptions', 'activeEventData', 'activeCellsData', 'renderModule'];\n\n    for (const module of modules) {\n      this[module] = null;\n    }\n\n    removeChildren(this.element);\n    let removeClasses = [ROOT, RTL, DEVICE_CLASS, MULTI_DRAG];\n\n    if (this.cssClass) {\n      removeClasses = removeClasses.concat(this.cssClass.split(' '));\n    }\n\n    removeClass([this.element], removeClasses);\n  }\n\n};\n\n__decorate([Property('auto')], Schedule.prototype, \"width\", void 0);\n\n__decorate([Property('auto')], Schedule.prototype, \"height\", void 0);\n\n__decorate([Property(true)], Schedule.prototype, \"showHeaderBar\", void 0);\n\n__decorate([Property(true)], Schedule.prototype, \"showTimeIndicator\", void 0);\n\n__decorate([Property('Week')], Schedule.prototype, \"currentView\", void 0);\n\n__decorate([Property(['Day', 'Week', 'WorkWeek', 'Month', 'Agenda'])], Schedule.prototype, \"views\", void 0);\n\n__decorate([Property(new Date())], Schedule.prototype, \"selectedDate\", void 0);\n\n__decorate([Property(new Date(1900, 0, 1))], Schedule.prototype, \"minDate\", void 0);\n\n__decorate([Property(new Date(2099, 11, 31))], Schedule.prototype, \"maxDate\", void 0);\n\n__decorate([Property()], Schedule.prototype, \"dateFormat\", void 0);\n\n__decorate([Property('Gregorian')], Schedule.prototype, \"calendarMode\", void 0);\n\n__decorate([Property(true)], Schedule.prototype, \"showWeekend\", void 0);\n\n__decorate([Property(0)], Schedule.prototype, \"firstDayOfWeek\", void 0);\n\n__decorate([Property('FirstDay')], Schedule.prototype, \"weekRule\", void 0);\n\n__decorate([Property([1, 2, 3, 4, 5])], Schedule.prototype, \"workDays\", void 0);\n\n__decorate([Property(12)], Schedule.prototype, \"monthsCount\", void 0);\n\n__decorate([Property('00:00')], Schedule.prototype, \"startHour\", void 0);\n\n__decorate([Property('24:00')], Schedule.prototype, \"endHour\", void 0);\n\n__decorate([Property(null)], Schedule.prototype, \"timeFormat\", void 0);\n\n__decorate([Property(false)], Schedule.prototype, \"enableAllDayScroll\", void 0);\n\n__decorate([Property(false)], Schedule.prototype, \"enableAdaptiveUI\", void 0);\n\n__decorate([Property(true)], Schedule.prototype, \"allowResizing\", void 0);\n\n__decorate([Complex({}, WorkHours)], Schedule.prototype, \"workHours\", void 0);\n\n__decorate([Complex({}, TimeScale)], Schedule.prototype, \"timeScale\", void 0);\n\n__decorate([Property(true)], Schedule.prototype, \"allowKeyboardInteraction\", void 0);\n\n__decorate([Property(true)], Schedule.prototype, \"allowDragAndDrop\", void 0);\n\n__decorate([Property()], Schedule.prototype, \"dateHeaderTemplate\", void 0);\n\n__decorate([Property()], Schedule.prototype, \"cellHeaderTemplate\", void 0);\n\n__decorate([Property()], Schedule.prototype, \"dayHeaderTemplate\", void 0);\n\n__decorate([Property()], Schedule.prototype, \"monthHeaderTemplate\", void 0);\n\n__decorate([Property()], Schedule.prototype, \"cellTemplate\", void 0);\n\n__decorate([Property(false)], Schedule.prototype, \"readonly\", void 0);\n\n__decorate([Property(true)], Schedule.prototype, \"showQuickInfo\", void 0);\n\n__decorate([Property(false)], Schedule.prototype, \"allowInline\", void 0);\n\n__decorate([Property(true)], Schedule.prototype, \"allowMultiCellSelection\", void 0);\n\n__decorate([Property(true)], Schedule.prototype, \"allowMultiRowSelection\", void 0);\n\n__decorate([Property(false)], Schedule.prototype, \"quickInfoOnSelectionEnd\", void 0);\n\n__decorate([Property(false)], Schedule.prototype, \"showWeekNumber\", void 0);\n\n__decorate([Property(false)], Schedule.prototype, \"rowAutoHeight\", void 0);\n\n__decorate([Property(false)], Schedule.prototype, \"allowMultiDrag\", void 0);\n\n__decorate([Property(0)], Schedule.prototype, \"firstMonthOfYear\", void 0);\n\n__decorate([Property()], Schedule.prototype, \"editorTemplate\", void 0);\n\n__decorate([Complex({}, QuickInfoTemplates)], Schedule.prototype, \"quickInfoTemplates\", void 0);\n\n__decorate([Property(7)], Schedule.prototype, \"agendaDaysCount\", void 0);\n\n__decorate([Property(true)], Schedule.prototype, \"hideEmptyAgendaDays\", void 0);\n\n__decorate([Property(true)], Schedule.prototype, \"enableRecurrenceValidation\", void 0);\n\n__decorate([Property()], Schedule.prototype, \"timezone\", void 0);\n\n__decorate([Complex({}, EventSettings)], Schedule.prototype, \"eventSettings\", void 0);\n\n__decorate([Property(timezoneData)], Schedule.prototype, \"timezoneDataSource\", void 0);\n\n__decorate([Property()], Schedule.prototype, \"resourceHeaderTemplate\", void 0);\n\n__decorate([Property()], Schedule.prototype, \"headerIndentTemplate\", void 0);\n\n__decorate([Complex({}, Group)], Schedule.prototype, \"group\", void 0);\n\n__decorate([Collection([], Resources)], Schedule.prototype, \"resources\", void 0);\n\n__decorate([Collection([], HeaderRows)], Schedule.prototype, \"headerRows\", void 0);\n\n__decorate([Property()], Schedule.prototype, \"cssClass\", void 0);\n\n__decorate([Property()], Schedule.prototype, \"eventDragArea\", void 0);\n\n__decorate([Event()], Schedule.prototype, \"created\", void 0);\n\n__decorate([Event()], Schedule.prototype, \"destroyed\", void 0);\n\n__decorate([Event()], Schedule.prototype, \"cellClick\", void 0);\n\n__decorate([Event()], Schedule.prototype, \"cellDoubleClick\", void 0);\n\n__decorate([Event()], Schedule.prototype, \"moreEventsClick\", void 0);\n\n__decorate([Event()], Schedule.prototype, \"hover\", void 0);\n\n__decorate([Event()], Schedule.prototype, \"select\", void 0);\n\n__decorate([Event()], Schedule.prototype, \"actionBegin\", void 0);\n\n__decorate([Event()], Schedule.prototype, \"actionComplete\", void 0);\n\n__decorate([Event()], Schedule.prototype, \"actionFailure\", void 0);\n\n__decorate([Event()], Schedule.prototype, \"navigating\", void 0);\n\n__decorate([Event()], Schedule.prototype, \"renderCell\", void 0);\n\n__decorate([Event()], Schedule.prototype, \"eventClick\", void 0);\n\n__decorate([Event()], Schedule.prototype, \"eventRendered\", void 0);\n\n__decorate([Event()], Schedule.prototype, \"dataBinding\", void 0);\n\n__decorate([Event()], Schedule.prototype, \"popupOpen\", void 0);\n\n__decorate([Event()], Schedule.prototype, \"popupClose\", void 0);\n\n__decorate([Event()], Schedule.prototype, \"dragStart\", void 0);\n\n__decorate([Event()], Schedule.prototype, \"drag\", void 0);\n\n__decorate([Event()], Schedule.prototype, \"dragStop\", void 0);\n\n__decorate([Event()], Schedule.prototype, \"resizeStart\", void 0);\n\n__decorate([Event()], Schedule.prototype, \"resizing\", void 0);\n\n__decorate([Event()], Schedule.prototype, \"resizeStop\", void 0);\n\n__decorate([Event()], Schedule.prototype, \"dataBound\", void 0);\n\nSchedule = __decorate([NotifyPropertyChanges], Schedule);\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\n/**\n * Base class for the common drag and resize related actions\n */\n\nclass ActionBase {\n  constructor(parent) {\n    this.daysVariation = 0;\n    this.parent = parent;\n    this.actionObj = {\n      X: 0,\n      Y: 0,\n      groupIndex: 0,\n      cellWidth: 0,\n      cellHeight: 0,\n      slotInterval: 0,\n      interval: 0,\n      actionIndex: 0,\n      cloneElement: [],\n      originalElement: [],\n      action: null,\n      isAllDay: null,\n      excludeSelectors: null,\n      index: 0,\n      navigationInterval: null,\n      scrollInterval: null\n    };\n    this.scrollArgs = {\n      element: null,\n      width: 0,\n      height: 0\n    };\n    this.resizeEdges = {\n      left: false,\n      right: false,\n      top: false,\n      bottom: false\n    };\n    this.scrollEdges = {\n      left: false,\n      right: false,\n      top: false,\n      bottom: false\n    };\n  }\n\n  getChangedData(multiData) {\n    const eventObj = extend({}, this.actionObj.event, null, true);\n    eventObj[this.parent.eventFields.startTime] = this.actionObj.start;\n    eventObj[this.parent.eventFields.endTime] = this.actionObj.end;\n\n    if (!isNullOrUndefined(this.actionObj.isAllDay)) {\n      eventObj[this.parent.eventFields.isAllDay] = this.actionObj.isAllDay;\n    }\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      const originalElement = this.getOriginalElement(this.actionObj.element);\n\n      if (originalElement) {\n        let indexCol = originalElement.map(element => parseInt(element.getAttribute('data-group-index'), 10));\n\n        if (indexCol.indexOf(this.actionObj.groupIndex) === -1 || !isNullOrUndefined(multiData) && multiData.length > 0) {\n          const cloneIndex = parseInt(this.actionObj.clone.getAttribute('data-group-index'), 10);\n          indexCol = indexCol.filter(index => index !== cloneIndex);\n          indexCol.push(this.actionObj.groupIndex);\n\n          if (multiData && multiData.length > 0) {\n            multiData.forEach(data => {\n              this.parent.resourceBase.getResourceData(data, this.actionObj.groupIndex, indexCol);\n            });\n          } else {\n            this.parent.resourceBase.getResourceData(eventObj, this.actionObj.groupIndex, indexCol);\n          }\n        }\n      }\n    }\n\n    return eventObj;\n  }\n\n  saveChangedData(eventArgs, isMultiSelect = false) {\n    this.parent.activeEventData.event = this.actionObj.event;\n    this.parent.currentAction = 'Save';\n    let currentAction;\n    let eventsCollection = [eventArgs.data];\n\n    if (isMultiSelect) {\n      eventsCollection = eventArgs.selectedData;\n    }\n\n    for (const eventObj of eventsCollection) {\n      const isSameResource = this.parent.activeViewOptions.group.resources.length > 0 ? parseInt(this.actionObj.element.getAttribute('data-group-index'), 10) === this.actionObj.groupIndex : true;\n\n      if (+eventObj[this.parent.eventFields.startTime] === +this.actionObj.event[this.parent.eventFields.startTime] && +eventObj[this.parent.eventFields.endTime] === +this.actionObj.event[this.parent.eventFields.endTime] && isSameResource) {\n        return;\n      }\n\n      if (eventObj[this.parent.eventFields.recurrenceRule]) {\n        const eveId = eventObj[this.parent.eventFields.recurrenceID] || eventObj[this.parent.eventFields.id];\n\n        if (eventObj[this.parent.eventFields.id] === eventObj[this.parent.eventFields.recurrenceID]) {\n          eventObj[this.parent.eventFields.id] = this.parent.eventBase.getEventMaxID();\n          currentAction = 'EditOccurrence';\n        }\n\n        if (this.parent.enableRecurrenceValidation && this.parent.eventWindow.editOccurrenceValidation(eveId, eventObj, this.actionObj.event)) {\n          return;\n        }\n      } else {\n        currentAction = null;\n      }\n\n      if (eventObj[this.parent.eventFields.startTimezone] || eventObj[this.parent.eventFields.endTimezone]) {\n        this.parent.eventBase.timezoneConvert(eventObj);\n      }\n\n      this.parent.crudModule.saveEvent(eventObj, currentAction);\n    }\n  }\n\n  calculateIntervalTime(date) {\n    const intervalTime = new Date(+date);\n    intervalTime.setMinutes(Math.floor(intervalTime.getMinutes() / this.actionObj.interval) * this.actionObj.interval);\n    return intervalTime;\n  }\n\n  getContentAreaDimension() {\n    const viewElement = this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS);\n    let trElement = [].slice.call(viewElement.querySelector('tr').children);\n\n    if (!this.parent.activeView.isTimelineView() && this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.isAdaptive && !this.parent.enableAdaptiveUI) {\n      trElement = this.getResourceElements(trElement);\n    }\n\n    const leftOffset = trElement[0].getBoundingClientRect();\n    const rightOffset = trElement.slice(-1)[0].getBoundingClientRect();\n    const viewDimension = {\n      bottom: viewElement.scrollHeight - 5,\n      left: this.parent.enableRtl ? rightOffset.left : leftOffset.left,\n      right: this.parent.enableRtl ? leftOffset.right : rightOffset.right,\n      top: 0,\n      leftOffset: this.parent.enableRtl ? rightOffset.right : leftOffset.right,\n      rightOffset: this.parent.enableRtl ? leftOffset.left : rightOffset.left\n    };\n    return viewDimension;\n  }\n\n  getPageCoordinates(e) {\n    const eventArgs = e.event;\n    return eventArgs && eventArgs.changedTouches ? eventArgs.changedTouches[0] : e.changedTouches ? e.changedTouches[0] : eventArgs || e;\n  }\n\n  getIndex(index) {\n    const contentElements = [].slice.call(this.parent.getContentTable().querySelector('tr').children);\n    const indexes = {\n      minIndex: 0,\n      maxIndex: contentElements.length - 1\n    };\n\n    if (this.actionObj.action === 'resize' && this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive && !this.parent.activeView.isTimelineView()) {\n      const groupElements = this.getResourceElements(contentElements);\n      indexes.minIndex = groupElements[0].cellIndex;\n      indexes.maxIndex = groupElements.slice(-1)[0].cellIndex;\n    }\n\n    if (index < indexes.minIndex) {\n      index = indexes.minIndex;\n    }\n\n    if (index > indexes.maxIndex) {\n      index = indexes.maxIndex;\n    }\n\n    return index;\n  }\n\n  updateTimePosition(date, multiData) {\n    let index = 0;\n\n    for (const cloneElement of this.actionObj.cloneElement) {\n      const timeElement = cloneElement.querySelector('.' + APPOINTMENT_TIME);\n\n      if (timeElement) {\n        let startTime = this.actionObj.start;\n        let endTime = this.actionObj.end;\n\n        if (multiData && multiData.length > 0) {\n          startTime = multiData[index][this.parent.eventFields.startTime];\n          endTime = multiData[index][this.parent.eventFields.endTime];\n        }\n\n        timeElement.innerHTML = this.parent.getTimeString(startTime) + ' - ' + this.parent.getTimeString(endTime);\n      }\n\n      index++;\n    }\n\n    if (!this.parent.activeViewOptions.timeScale.enable || !this.parent.isAdaptive || this.parent.currentView === 'Month' || this.parent.currentView === 'TimelineMonth') {\n      return;\n    }\n\n    let timeIndicator = this.parent.element.querySelector('.' + CLONE_TIME_INDICATOR_CLASS);\n\n    if (!timeIndicator) {\n      timeIndicator = createElement('div', {\n        className: CLONE_TIME_INDICATOR_CLASS\n      });\n      const wrapperClass = this.parent.activeView.isTimelineView() ? DATE_HEADER_WRAP_CLASS : TIME_CELLS_WRAP_CLASS;\n      this.parent.element.querySelector('.' + wrapperClass).appendChild(timeIndicator);\n    }\n\n    timeIndicator.innerHTML = this.parent.getTimeString(date);\n    let offsetValue = 0;\n\n    if (this.parent.activeView.isTimelineView()) {\n      if (this.parent.enableRtl) {\n        const rightValue = parseInt(this.actionObj.clone.style.right, 10);\n        offsetValue = this.actionObj.action === 'drag' || this.resizeEdges.left ? rightValue + this.actionObj.clone.offsetWidth : rightValue;\n        timeIndicator.style.right = formatUnit(offsetValue);\n      } else {\n        const leftValue = parseInt(this.actionObj.clone.style.left, 10);\n        offsetValue = this.actionObj.action === 'drag' || this.resizeEdges.left ? leftValue : leftValue + this.actionObj.clone.offsetWidth;\n        timeIndicator.style.left = formatUnit(offsetValue);\n      }\n    } else {\n      offsetValue = this.actionObj.action === 'drag' || this.resizeEdges.top ? this.actionObj.clone.offsetTop : this.actionObj.clone.offsetTop + this.actionObj.clone.offsetHeight;\n      timeIndicator.style.top = formatUnit(offsetValue);\n    }\n  }\n\n  getResourceElements(table) {\n    return table.filter(element => parseInt(element.getAttribute('data-group-index'), 10) === this.actionObj.groupIndex);\n  }\n\n  getOriginalElement(element) {\n    let originalElement;\n    const guid = element.getAttribute('data-guid');\n    const isMorePopup = element.offsetParent && element.offsetParent.classList.contains(MORE_EVENT_POPUP_CLASS);\n\n    if (isMorePopup || this.parent.activeView.isTimelineView()) {\n      originalElement = [].slice.call(this.parent.element.querySelectorAll('[data-guid=\"' + guid + '\"]'));\n    } else {\n      const tr = closest(element, 'tr');\n\n      if (tr) {\n        originalElement = [].slice.call(tr.querySelectorAll('[data-guid=\"' + guid + '\"]'));\n      }\n    }\n\n    return originalElement;\n  }\n\n  createCloneElement(element) {\n    const cloneWrapper = createElement('div', {\n      innerHTML: element.outerHTML\n    });\n    const cloneElement = cloneWrapper.children[0];\n    const cloneClassLists = [CLONE_ELEMENT_CLASS];\n    cloneClassLists.push(this.actionObj.action === 'drag' ? DRAG_CLONE_CLASS : RESIZE_CLONE_CLASS);\n\n    if (this.parent.currentView === 'Month' || this.parent.currentView === 'TimelineMonth') {\n      cloneClassLists.push(MONTH_CLONE_ELEMENT_CLASS);\n    }\n\n    addClass([cloneElement], cloneClassLists);\n    addClass([element], EVENT_ACTION_CLASS);\n\n    if (!isNullOrUndefined(element.parentElement)) {\n      element.parentElement.appendChild(cloneElement);\n    }\n\n    cloneElement.style.width = formatUnit(cloneElement.offsetWidth - 2);\n    const dragElement = document.querySelector(this.parent.eventDragArea);\n\n    if (this.parent.eventDragArea && this.actionObj.action === 'drag' && dragElement) {\n      dragElement.appendChild(cloneElement);\n    }\n\n    setStyleAttribute(cloneElement, {\n      border: '0px'\n    });\n    return cloneElement;\n  }\n\n  removeCloneElementClasses() {\n    let elements = this.actionObj.originalElement;\n\n    if (this.parent.currentView === 'Month' || this.parent.currentView === 'TimelineYear' || this.parent.currentView === 'Day' || this.parent.currentView === 'Week' || this.parent.currentView === 'WorkWeek') {\n      elements = [].slice.call(this.parent.element.querySelectorAll('.' + EVENT_ACTION_CLASS));\n    }\n\n    removeClass(elements, EVENT_ACTION_CLASS);\n  }\n\n  removeCloneElement() {\n    this.actionObj.originalElement = [];\n    const dynamicEle = [].slice.call(this.parent.element.querySelectorAll('.e-dynamic-clone'));\n\n    for (const cloneEle of dynamicEle) {\n      remove(cloneEle);\n    }\n\n    for (const cloneElement of this.actionObj.cloneElement) {\n      if (!isNullOrUndefined(cloneElement.parentNode)) {\n        remove(cloneElement);\n      }\n    }\n\n    this.actionObj.cloneElement = [];\n    const timeIndicator = this.parent.element.querySelector('.' + CLONE_TIME_INDICATOR_CLASS);\n\n    if (timeIndicator) {\n      remove(timeIndicator);\n    }\n  }\n\n  getCursorElement(e) {\n    const pages = this.getPageCoordinates(e);\n    return document.elementFromPoint(pages.clientX, pages.clientY);\n  }\n\n  autoScroll() {\n    const parent = this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS);\n    const yIsScrollable = parent.offsetHeight <= parent.scrollHeight;\n    const xIsScrollable = parent.offsetWidth <= parent.scrollWidth;\n    const yInBounds = yIsScrollable && parent.scrollTop >= 0 && parent.scrollTop + parent.offsetHeight <= parent.scrollHeight;\n    let xInBounds = xIsScrollable && parent.scrollLeft >= 0 && parent.scrollLeft + parent.offsetWidth <= parent.scrollWidth;\n\n    if (this.actionObj.action === 'resize' && this.scrollEdges.right && parent.scrollLeft + parent.offsetWidth > parent.scrollWidth) {\n      const tdCollections = [].slice.call(this.parent.getContentTable().querySelector('tr').children).length - 1;\n      const cellIndex = Math.ceil((this.actionObj.clone.offsetLeft + this.actionObj.clone.offsetWidth) / this.actionObj.cellWidth);\n      xInBounds = cellIndex === tdCollections;\n    }\n\n    if (yInBounds && (this.scrollEdges.top || this.scrollEdges.bottom)) {\n      parent.scrollTop += this.scrollEdges.top ? -this.actionObj.scroll.scrollBy : this.actionObj.scroll.scrollBy;\n\n      if (this.actionObj.action === 'resize') {\n        if (parent.scrollHeight !== parent.offsetHeight + parent.scrollTop && parent.scrollTop > 0) {\n          this.actionObj.Y += this.scrollEdges.top ? this.actionObj.scroll.scrollBy : -this.actionObj.scroll.scrollBy;\n        }\n      }\n    }\n\n    if (xInBounds && (this.scrollEdges.left || this.scrollEdges.right)) {\n      parent.scrollLeft += this.scrollEdges.left ? -this.actionObj.scroll.scrollBy : this.actionObj.scroll.scrollBy;\n\n      if (this.actionObj.action === 'resize') {\n        if (parent.scrollWidth !== parent.offsetWidth + parent.scrollLeft && parent.scrollLeft > 0) {\n          this.actionObj.X += this.scrollEdges.left ? this.actionObj.scroll.scrollBy : -this.actionObj.scroll.scrollBy;\n        }\n      }\n    }\n  }\n\n  autoScrollValidation() {\n    if (!this.actionObj.scroll.enable) {\n      return false;\n    }\n\n    const res = this.parent.boundaryValidation(this.actionObj.pageY, this.actionObj.pageX);\n    this.scrollEdges = res;\n    return res.bottom || res.top || res.left || res.right;\n  }\n\n  actionClass(type) {\n    if (type === 'addClass') {\n      addClass([this.parent.element], EVENT_ACTION_CLASS);\n    } else {\n      removeClass([this.parent.element], EVENT_ACTION_CLASS);\n    }\n  }\n\n  updateScrollPosition(e) {\n    this.scrollEventArgs = e;\n\n    if (this.actionObj.scroll.enable && isNullOrUndefined(this.actionObj.scrollInterval)) {\n      this.actionObj.scrollInterval = window.setInterval(() => {\n        if (this.autoScrollValidation() && !this.actionObj.clone.classList.contains(ALLDAY_APPOINTMENT_CLASS)) {\n          if (this.parent.activeView.isTimelineView() && this.parent.activeViewOptions.group.resources.length > 0 && this.actionObj.groupIndex < 0) {\n            return;\n          }\n\n          this.autoScroll();\n\n          if (this.actionObj.action === 'drag') {\n            this.parent.dragAndDropModule.updateDraggingDateTime(this.scrollEventArgs);\n          } else {\n            this.parent.resizeModule.updateResizingDirection(this.scrollEventArgs);\n          }\n        }\n      }, this.actionObj.scroll.timeDelay);\n    }\n  }\n\n  updateOriginalElement(cloneElement) {\n    let query = '[data-id=\"' + cloneElement.getAttribute('data-id') + '\"]';\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      query = query.concat('[data-group-index = \"' + cloneElement.getAttribute('data-group-index') + '\"]');\n    }\n\n    const elements = [].slice.call(this.parent.element.querySelectorAll(query));\n    addClass(elements, EVENT_ACTION_CLASS);\n    const eventWrappers = [].slice.call(this.parent.element.querySelectorAll('.' + CLONE_ELEMENT_CLASS));\n    removeClass(eventWrappers, EVENT_ACTION_CLASS);\n  }\n\n  getUpdatedEvent(startTime, endTime, eventObj) {\n    const event = JSON.parse(JSON.stringify(eventObj));\n    event[this.parent.eventFields.startTime] = startTime;\n    event[this.parent.eventFields.endTime] = endTime;\n    return event;\n  }\n\n  dynamicYearlyEventsRendering(event, isResize = false) {\n    let appWidth = this.actionObj.cellWidth - 7;\n\n    if (isResize && (this.resizeEdges.left || this.resizeEdges.right)) {\n      appWidth = this.actionObj.cellWidth * event.count;\n    }\n\n    if (!isResize && this.parent.activeViewOptions.orientation === 'Horizontal' && this.parent.activeViewOptions.group.resources.length === 0) {\n      const eventObj = this.yearEvent.isSpannedEvent(event, event[this.parent.eventFields.startTime]);\n\n      if (eventObj[this.parent.eventFields.startTime].getTime() === eventObj[this.parent.eventFields.endTime].getTime()) {\n        eventObj.isSpanned.count = 1;\n      }\n\n      appWidth = eventObj.isSpanned.count * this.actionObj.cellWidth;\n    }\n\n    const appointmentElement = this.createAppointmentElement(this.actionObj.groupIndex, event[this.parent.eventFields.subject]);\n    appointmentElement.setAttribute('drag', 'true');\n    addClass([appointmentElement], CLONE_ELEMENT_CLASS);\n    setStyleAttribute(appointmentElement, {\n      'width': appWidth + 'px',\n      'border': '0px',\n      'pointer-events': 'none',\n      'position': 'absolute',\n      'overflow': 'hidden',\n      'padding': '3px'\n    });\n\n    if (this.actionObj.clone.style.backgroundColor !== '') {\n      setStyleAttribute(appointmentElement, {\n        'backgroundColor': this.actionObj.clone.style.backgroundColor\n      });\n    }\n\n    const date = resetTime(event[this.parent.eventFields.startTime]).getTime();\n    let query = '.' + WORK_CELLS_CLASS + '[data-date=\"' + date + '\"]';\n\n    if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n      query = '.' + WORK_CELLS_CLASS + '[data-date=\"' + date + '\"][data-group-index=\"' + this.actionObj.groupIndex + '\"]';\n    }\n\n    const cellTd = this.parent.element.querySelector(query);\n\n    if (isNullOrUndefined(cellTd)) {\n      return;\n    }\n\n    if (isResize) {\n      const dateHeader = cellTd.querySelector('.' + DATE_HEADER_CLASS);\n      let appHeight = this.actionObj.cellHeight * event.count - (dateHeader ? dateHeader.offsetHeight : 0) - 7;\n\n      if (this.resizeEdges.right || this.resizeEdges.left) {\n        appHeight = parseInt(this.actionObj.clone.style.height, 10);\n      }\n\n      setStyleAttribute(appointmentElement, {\n        'height': appHeight + 'px'\n      });\n    }\n\n    this.renderDynamicElement(cellTd, appointmentElement, true);\n    this.actionObj.cloneElement.push(appointmentElement);\n  } // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  renderDynamicElement(cellTd, element, isAppointment = false) {\n    if (cellTd.querySelector('.' + APPOINTMENT_WRAPPER_CLASS)) {\n      cellTd.querySelector('.' + APPOINTMENT_WRAPPER_CLASS).appendChild(element);\n    } else {\n      const wrapper = createElement('div', {\n        className: APPOINTMENT_WRAPPER_CLASS\n      });\n      wrapper.appendChild(element);\n      cellTd.appendChild(wrapper);\n    }\n  }\n\n  createAppointmentElement(resIndex, innerText) {\n    const appointmentWrapper = createElement('div', {\n      className: APPOINTMENT_CLASS,\n      innerHTML: innerText\n    });\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      appointmentWrapper.setAttribute('data-group-index', resIndex.toString());\n    }\n\n    return appointmentWrapper;\n  }\n\n  dynamicEventsRendering(event) {\n    let dateRender = this.parent.activeView.renderDates;\n    let workCells = [].slice.call(this.parent.element.querySelectorAll('.' + WORK_CELLS_CLASS));\n    let workDays = this.parent.activeViewOptions.workDays;\n    let groupOrder;\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      const resources = this.parent.resourceBase.lastResourceLevel.filter(res => res.groupIndex === this.actionObj.groupIndex);\n      dateRender = resources[0].renderDates;\n      const elementSelector = `.${WORK_CELLS_CLASS}[data-group-index=\"${this.actionObj.groupIndex}\"]`;\n      workCells = [].slice.call(this.parent.element.querySelectorAll(elementSelector));\n      workDays = resources[0].workDays;\n      groupOrder = resources[0].groupOrder;\n    }\n\n    this.monthEvent.dateRender = dateRender;\n    this.monthEvent.getSlotDates(workDays);\n\n    if (this.resizeEdges.left || this.resizeEdges.right) {\n      const eventWrappers = [].slice.call(this.parent.element.querySelectorAll('.' + CLONE_ELEMENT_CLASS));\n\n      for (const wrapper of eventWrappers) {\n        remove(wrapper);\n      }\n    }\n\n    const spannedEvents = this.monthEvent.splitEvent(event, dateRender);\n\n    for (const event of spannedEvents) {\n      const day = this.parent.getIndexOfDate(dateRender, resetTime(event[this.monthEvent.fields.startTime]));\n      const diffInDays = event.data.count;\n      const appWidth = diffInDays * this.actionObj.cellWidth - 7;\n      const appointmentElement = this.monthEvent.createAppointmentElement(event, this.actionObj.groupIndex, true);\n      appointmentElement.setAttribute('drag', 'true');\n      addClass([appointmentElement], CLONE_ELEMENT_CLASS);\n      this.monthEvent.applyResourceColor(appointmentElement, event, 'backgroundColor', groupOrder);\n      setStyleAttribute(appointmentElement, {\n        'width': appWidth + 'px',\n        'border': '0px',\n        'pointer-events': 'none'\n      });\n      const cellTd = workCells[day];\n\n      if (cellTd && isNullOrUndefined(this.parent.eventDragArea)) {\n        this.monthEvent.renderElement(cellTd, appointmentElement, true);\n        this.actionObj.cloneElement.push(appointmentElement);\n      }\n    }\n  }\n\n  destroy() {\n    if (!this.parent || this.parent && this.parent.isDestroyed) {\n      return;\n    }\n\n    this.actionObj = {};\n    this.scrollArgs = {};\n    this.resizeEdges = {\n      left: false,\n      right: false,\n      top: false,\n      bottom: false\n    };\n    this.scrollEdges = {\n      left: false,\n      right: false,\n      top: false,\n      bottom: false\n    };\n  }\n\n}\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\n/**\n * Schedule events resize actions\n */\n\n\nclass Resize extends ActionBase {\n  wireResizeEvent(element) {\n    const resizeElement = [].slice.call(element.querySelectorAll('.' + EVENT_RESIZE_CLASS));\n\n    for (const element of resizeElement) {\n      EventHandler.add(element, Browser.touchStartEvent, this.resizeStart, this);\n    }\n  }\n\n  resizeHelper() {\n    if (this.parent.activeViewOptions.group.resources.length > 0 && this.parent.activeViewOptions.group.allowGroupEdit) {\n      for (let i = 0, len = this.actionObj.originalElement.length; i < len; i++) {\n        const cloneElement = this.createCloneElement(this.actionObj.originalElement[i]);\n        this.actionObj.cloneElement[i] = cloneElement;\n\n        if (this.actionObj.element === this.actionObj.originalElement[i]) {\n          this.actionObj.clone = cloneElement;\n        }\n      }\n    } else {\n      if (this.actionObj.element) {\n        this.actionObj.clone = this.createCloneElement(this.actionObj.element);\n      }\n\n      this.actionObj.cloneElement = [this.actionObj.clone];\n      this.actionObj.originalElement = [this.actionObj.element];\n    }\n  }\n\n  resizeStart(e) {\n    this.actionObj.action = 'resize';\n    this.actionObj.slotInterval = this.parent.activeViewOptions.timeScale.interval / this.parent.activeViewOptions.timeScale.slotCount;\n    this.actionObj.interval = this.actionObj.slotInterval;\n    const resizeTarget = closest(e.target, '.' + EVENT_RESIZE_CLASS);\n    this.actionObj.element = closest(resizeTarget, '.' + APPOINTMENT_CLASS);\n    this.actionObj.event = this.parent.eventBase.getEventByGuid(this.actionObj.element.getAttribute('data-guid'));\n    const eventObj = extend({}, this.actionObj.event, null, true);\n    const resizeArgs = {\n      cancel: false,\n      data: eventObj,\n      element: this.actionObj.element,\n      event: e,\n      interval: this.actionObj.interval,\n      scroll: {\n        enable: true,\n        scrollBy: 30,\n        timeDelay: 100\n      }\n    };\n    this.parent.trigger(resizeStart, resizeArgs, resizeEventArgs => {\n      if (resizeEventArgs.cancel) {\n        return;\n      }\n\n      this.actionClass('addClass');\n      this.parent.uiStateValues.action = true;\n      this.resizeEdges = {\n        left: resizeTarget.classList.contains(LEFT_RESIZE_HANDLER),\n        right: resizeTarget.classList.contains(RIGHT_RESIZE_HANDLER),\n        top: resizeTarget.classList.contains(TOP_RESIZE_HANDLER),\n        bottom: resizeTarget.classList.contains(BOTTOM_RESIZE_HANDLER)\n      };\n      this.actionObj.groupIndex = this.parent.uiStateValues.isGroupAdaptive ? this.parent.uiStateValues.groupIndex : 0;\n      const workCell = this.parent.element.querySelector('.' + WORK_CELLS_CLASS).getBoundingClientRect();\n      this.actionObj.cellWidth = workCell.width;\n      this.actionObj.cellHeight = workCell.height;\n      const hRows = this.parent.activeViewOptions.headerRows.map(row => row.option);\n\n      if (this.parent.activeView.isTimelineView() && hRows.length > 0 && ['Date', 'Hour'].indexOf(hRows.slice(-1)[0]) < 0) {\n        const tr = this.parent.getContentTable().querySelector('tr');\n        let noOfDays = 0;\n        const tdCollections = [].slice.call(tr.children);\n\n        for (const td of tdCollections) {\n          noOfDays += parseInt(td.getAttribute('colspan'), 10);\n        }\n\n        const trRect = tr.getBoundingClientRect();\n        this.actionObj.cellWidth = trRect.width / noOfDays;\n        this.actionObj.cellHeight = trRect.height;\n      }\n\n      const pages = this.getPageCoordinates(e);\n      this.actionObj.X = pages.pageX;\n      this.actionObj.Y = pages.pageY;\n      this.actionObj.groupIndex = parseInt(this.actionObj.element.getAttribute('data-group-index') || '0', 10);\n      this.actionObj.interval = resizeEventArgs.interval;\n      this.actionObj.scroll = resizeEventArgs.scroll;\n      this.actionObj.start = new Date(eventObj[this.parent.eventFields.startTime].getTime());\n      this.actionObj.end = new Date(eventObj[this.parent.eventFields.endTime].getTime());\n      this.actionObj.originalElement = this.getOriginalElement(this.actionObj.element);\n\n      if (this.parent.currentView === 'Month') {\n        this.daysVariation = -1;\n        this.monthEvent = new MonthEvent(this.parent);\n      }\n\n      const viewElement = this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS);\n      this.scrollArgs = {\n        element: viewElement,\n        width: viewElement.scrollWidth,\n        height: viewElement.scrollHeight\n      };\n      EventHandler.add(document, Browser.touchMoveEvent, this.resizing, this);\n      EventHandler.add(document, Browser.touchEndEvent, this.resizeStop, this);\n    });\n  }\n\n  resizing(e) {\n    if (this.parent.quickPopup) {\n      this.parent.quickPopup.quickPopupHide();\n    }\n\n    if (this.parent.element.querySelectorAll('.' + RESIZE_CLONE_CLASS).length === 0) {\n      this.resizeHelper();\n    }\n\n    if (!isNullOrUndefined(e.target) && e.target.classList.contains(DISABLE_DATES)) {\n      return;\n    }\n\n    const pages = this.getPageCoordinates(e);\n    this.actionObj.pageX = pages.pageX;\n    this.actionObj.pageY = pages.pageY;\n    this.updateScrollPosition(e);\n    this.updateResizingDirection(e);\n    const eventObj = extend({}, this.actionObj.event, null, true);\n    const resizeArgs = {\n      cancel: false,\n      data: eventObj,\n      element: this.actionObj.element,\n      event: e,\n      startTime: this.actionObj.start,\n      endTime: this.actionObj.end\n    };\n\n    if (this.parent.group.resources.length > 0) {\n      resizeArgs.groupIndex = this.actionObj.groupIndex;\n    }\n\n    this.parent.trigger(resizing, resizeArgs);\n  }\n\n  updateResizingDirection(e) {\n    if (this.parent.currentView === 'Month' || this.parent.currentView === 'TimelineYear') {\n      this.monthResizing();\n      return;\n    }\n\n    const resizeValidation = this.resizeValidation(e);\n\n    if (this.resizeEdges.left) {\n      if (resizeValidation) {\n        const leftStyles = this.getLeftRightStyles(e, true);\n\n        if (parseInt(leftStyles.width, 10) < 1) {\n          return;\n        }\n\n        for (const cloneElement of this.actionObj.cloneElement) {\n          setStyleAttribute(cloneElement, leftStyles);\n          addClass([cloneElement], LEFT_RESIZE_HANDLER);\n        }\n      }\n\n      this.horizontalResizing(!this.parent.enableRtl);\n    }\n\n    if (this.resizeEdges.right) {\n      if (resizeValidation) {\n        const rightStyles = this.getLeftRightStyles(e, false);\n\n        if (parseInt(rightStyles.width, 10) < 1) {\n          return;\n        }\n\n        for (const cloneElement of this.actionObj.cloneElement) {\n          setStyleAttribute(cloneElement, rightStyles);\n          addClass([cloneElement], RIGHT_RESIZE_HANDLER);\n        }\n      }\n\n      this.horizontalResizing(this.parent.enableRtl);\n    }\n\n    if (this.resizeEdges.top) {\n      if (resizeValidation) {\n        const topStyles = this.getTopBottomStyles(e, true);\n\n        if (parseInt(topStyles.height, 10) < 1) {\n          return;\n        }\n\n        for (const cloneElement of this.actionObj.cloneElement) {\n          setStyleAttribute(cloneElement, topStyles);\n          addClass([cloneElement], TOP_RESIZE_HANDLER);\n        }\n      }\n\n      this.verticalResizing(true);\n    }\n\n    if (this.resizeEdges.bottom) {\n      if (resizeValidation) {\n        const bottomStyles = this.getTopBottomStyles(e, false);\n\n        if (parseInt(bottomStyles.height, 10) < 1) {\n          return;\n        }\n\n        for (const cloneElement of this.actionObj.cloneElement) {\n          setStyleAttribute(cloneElement, bottomStyles);\n          addClass([cloneElement], BOTTOM_RESIZE_HANDLER);\n        }\n      }\n\n      this.verticalResizing(false);\n    }\n  }\n\n  monthResizing() {\n    this.removeCloneElement();\n\n    if (isNullOrUndefined(this.actionObj.pageX) || isNullOrUndefined(this.actionObj.pageY)) {\n      return;\n    }\n\n    const td = document.elementFromPoint(this.actionObj.pageX, this.actionObj.pageY);\n\n    if (isNullOrUndefined(td)) {\n      return;\n    }\n\n    const resizeTime = this.parent.getDateFromElement(td);\n    const isSameCell = this.parent.activeViewOptions.group.resources.length > 0 ? parseInt(td.getAttribute('data-group-index'), 10) === this.actionObj.groupIndex : true;\n    let startTime = new Date(this.actionObj.event[this.parent.eventFields.startTime].getTime());\n    let endTime = new Date(this.actionObj.event[this.parent.eventFields.endTime].getTime());\n\n    if (!this.parent.enableRtl && this.resizeEdges.left || this.parent.enableRtl && this.resizeEdges.right || this.resizeEdges.top) {\n      startTime = resizeTime;\n    } else if (!this.parent.enableRtl && this.resizeEdges.right || this.parent.enableRtl && this.resizeEdges.left || this.resizeEdges.bottom) {\n      endTime = addDays(resizeTime, 1);\n    }\n\n    if (isSameCell && startTime < endTime) {\n      this.actionObj.start = startTime;\n      this.actionObj.end = endTime;\n      const event = this.getUpdatedEvent(this.actionObj.start, this.actionObj.end, this.actionObj.event);\n\n      if (this.parent.currentView === 'TimelineYear') {\n        this.yearEventsRendering(event);\n      } else {\n        this.dynamicEventsRendering(event);\n      }\n\n      this.updateOriginalElement(this.actionObj.clone);\n    }\n  }\n\n  yearEventsRendering(event) {\n    const eventWrappers = [].slice.call(this.parent.element.querySelectorAll('.' + CLONE_ELEMENT_CLASS));\n\n    for (const wrapper of eventWrappers) {\n      remove(wrapper);\n    }\n\n    let endDate = new Date(event[this.parent.eventFields.endTime]);\n    let monthDiff = 0;\n\n    if (this.parent.activeViewOptions.group.resources.length === 0) {\n      monthDiff = this.getMonthDiff(event[this.parent.eventFields.startTime], addDays(endDate, -1));\n    }\n\n    for (let i = 0; i <= monthDiff; i++) {\n      let eventObj;\n\n      if (this.parent.activeViewOptions.group.resources.length === 0) {\n        eventObj = this.getEventCount(event, this.actionObj.start.getMonth() + i);\n      } else {\n        eventObj = extend({}, event, null, true);\n        endDate = this.resizeEdges.left || this.resizeEdges.right ? addDays(endDate, -1) : endDate;\n        eventObj.count = this.getMonthDiff(event[this.parent.eventFields.startTime], endDate) + 1;\n      }\n\n      this.dynamicYearlyEventsRendering(eventObj, true);\n    }\n  }\n\n  getMonthDiff(startDate, endDate) {\n    let months;\n    months = (endDate.getFullYear() - startDate.getFullYear()) * 12;\n    months -= startDate.getMonth();\n    months += endDate.getMonth();\n    return months <= 0 ? 0 : months;\n  }\n\n  getEventCount(eventObj, month) {\n    const eventData = extend({}, eventObj, null, true);\n    const eventStart = eventData[this.parent.eventFields.startTime];\n    const eventEnd = eventData[this.parent.eventFields.endTime];\n    const monthStart = new Date(this.parent.selectedDate.getFullYear(), month, 1);\n    const monthEnd = addDays(new Date(this.parent.selectedDate.getFullYear(), month + 1, 0), 1);\n    let count = 1;\n\n    if (eventStart.getTime() < monthStart.getTime()) {\n      eventData[this.parent.eventFields.startTime] = monthStart;\n    }\n\n    if (eventEnd.getTime() > monthEnd.getTime()) {\n      eventData[this.parent.eventFields.endTime] = monthEnd;\n    }\n\n    if (this.parent.activeViewOptions.group.resources.length === 0) {\n      count = Math.ceil((eventData[this.parent.eventFields.endTime].getTime() - eventData[this.parent.eventFields.startTime].getTime()) / MS_PER_DAY);\n    }\n\n    eventData.count = count;\n    return eventData;\n  }\n\n  resizeStop(e) {\n    EventHandler.remove(document, Browser.touchMoveEvent, this.resizing);\n    EventHandler.remove(document, Browser.touchEndEvent, this.resizeStop);\n    clearInterval(this.actionObj.scrollInterval);\n    this.actionObj.scrollInterval = null;\n    this.removeCloneElementClasses();\n    this.removeCloneElement();\n    this.actionClass('removeClass');\n    this.parent.uiStateValues.action = false;\n    const resizeArgs = {\n      cancel: false,\n      data: this.getChangedData(),\n      element: this.actionObj.element,\n      event: e\n    };\n    this.parent.trigger(resizeStop, resizeArgs, resizeEventArgs => {\n      if (resizeEventArgs.cancel) {\n        return;\n      }\n\n      if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.rowAutoHeight && !this.parent.activeViewOptions.group.allowGroupEdit && !this.parent.virtualScrollModule && this.parent.activeViewOptions.group.byGroupID) {\n        this.parent.crudModule.crudObj.sourceEvent = [this.parent.resourceBase.lastResourceLevel[parseInt(resizeEventArgs.element.getAttribute('data-group-index'), 10)]];\n        this.parent.crudModule.crudObj.targetEvent = this.parent.crudModule.crudObj.sourceEvent;\n        this.parent.crudModule.crudObj.isCrudAction = true;\n      }\n\n      this.saveChangedData(resizeEventArgs);\n    });\n  }\n\n  verticalResizing(isTop) {\n    let offsetValue = this.actionObj.clone.offsetTop;\n\n    if (!isTop) {\n      offsetValue += this.actionObj.clone.offsetHeight;\n    }\n\n    const minutes = offsetValue / this.actionObj.cellHeight * this.actionObj.slotInterval;\n    const element = this.actionObj.clone.offsetParent;\n\n    if (isNullOrUndefined(element)) {\n      return;\n    }\n\n    const resizeTime = resetTime(this.parent.getDateFromElement(element));\n    resizeTime.setHours(this.parent.activeView.getStartHour().getHours());\n    resizeTime.setMinutes(minutes + this.parent.activeView.getStartHour().getMinutes());\n\n    if (isTop) {\n      this.actionObj.start = this.calculateIntervalTime(resizeTime);\n    } else {\n      this.actionObj.end = this.calculateIntervalTime(resizeTime);\n    }\n\n    this.updateTimePosition(resizeTime);\n  }\n\n  horizontalResizing(isLeft) {\n    const eventStart = new Date(this.actionObj.event[this.parent.eventFields.startTime].getTime());\n    const eventEnd = new Date(this.actionObj.event[this.parent.eventFields.endTime].getTime());\n    let resizeTime;\n    let isDateHeader = false;\n    let headerName = this.parent.currentView;\n    const isTimeViews = ['TimelineDay', 'TimelineWeek', 'TimelineWorkWeek'].indexOf(this.parent.currentView) > -1;\n    const isTimelineMonth = this.parent.currentView === 'TimelineMonth';\n    const isWithoutScale = isTimelineMonth || isTimeViews && !this.parent.activeViewOptions.timeScale.enable;\n\n    if (this.parent.activeView.isTimelineView()) {\n      const tr = this.parent.getContentTable().querySelector('tr');\n\n      if (this.parent.activeViewOptions.headerRows.length > 0) {\n        const rows = this.parent.activeViewOptions.headerRows.map(row => row.option);\n        headerName = rows.slice(-1)[0];\n\n        if (isTimelineMonth && headerName === 'Hour') {\n          headerName = rows.slice(-2)[0] || 'Month';\n        }\n      }\n\n      resizeTime = isLeft ? eventStart : eventEnd;\n      let cellIndex = 0;\n      const tdCollections = [].slice.call(tr.children);\n      let isLastCell = false;\n      const pixelsPerMinute = this.actionObj.cellWidth / (this.parent.activeViewOptions.timeScale.interval / this.parent.activeViewOptions.timeScale.slotCount);\n      let offset = parseFloat(this.parent.enableRtl ? this.actionObj.clone.style.right : this.actionObj.clone.style.left);\n      offset = Math.round(offset / pixelsPerMinute) * pixelsPerMinute;\n\n      if (['Year', 'Month', 'Week', 'Date'].indexOf(headerName) !== -1) {\n        let noOfDays = 0;\n\n        for (const td of tdCollections) {\n          noOfDays += parseInt(td.getAttribute('colspan'), 10);\n        }\n\n        let offsetValue = this.parent.enableRtl ? parseInt(this.actionObj.clone.style.right, 10) : parseInt(this.actionObj.clone.style.left, 10);\n        offsetValue = Math.round(offsetValue / this.actionObj.cellWidth) * this.actionObj.cellWidth;\n\n        if (!isLeft) {\n          offsetValue += this.actionObj.clone.getBoundingClientRect().width - this.actionObj.cellWidth;\n        }\n\n        cellIndex = Math.floor(offsetValue / Math.floor(tr.getBoundingClientRect().width / noOfDays));\n        isDateHeader = isTimeViews && headerName === 'Date';\n        cellIndex = isLeft ? cellIndex : isTimelineMonth ? cellIndex + 1 : cellIndex;\n        isLastCell = cellIndex === tdCollections.length;\n        cellIndex = cellIndex < 0 ? 0 : cellIndex >= noOfDays ? noOfDays - 1 : cellIndex;\n      } else {\n        const cellWidth = this.actionObj.cellWidth;\n        cellIndex = isLeft ? Math.floor(offset / this.actionObj.cellWidth) : Math.ceil((offset + (this.actionObj.clone.getBoundingClientRect().width - cellWidth)) / this.actionObj.cellWidth);\n\n        if (this.parent.enableRtl) {\n          let cellOffsetWidth = 0;\n\n          if (headerName === 'TimelineMonth' || !this.parent.activeViewOptions.timeScale.enable && !isTimelineMonth) {\n            cellOffsetWidth = this.actionObj.cellWidth;\n          }\n\n          const offsetWidth = Math.floor(offset / this.actionObj.cellWidth) * this.actionObj.cellWidth + (isLeft ? 0 : this.actionObj.clone.getBoundingClientRect().width - cellOffsetWidth);\n          cellIndex = Math.floor(offsetWidth / this.actionObj.cellWidth);\n        }\n\n        isLastCell = cellIndex === tdCollections.length;\n        cellIndex = this.getIndex(cellIndex);\n      }\n\n      let resizeDate;\n\n      if (['Year', 'Month', 'Week', 'Date'].indexOf(headerName) !== -1) {\n        resizeDate = new Date(this.parent.activeView.renderDates[cellIndex].getTime());\n      } else {\n        resizeDate = this.parent.getDateFromElement(tr.children[cellIndex]);\n      }\n\n      if (['TimelineMonth', 'Year', 'Month', 'Week', 'Date'].indexOf(headerName) !== -1 || !this.parent.activeViewOptions.timeScale.enable) {\n        resizeTime = new Date(resizeDate.setHours(resizeTime.getHours(), resizeTime.getMinutes(), resizeTime.getSeconds()));\n      } else {\n        if (!isLeft) {\n          offset += this.actionObj.clone.getBoundingClientRect().width;\n        }\n\n        let spanMinutes = Math.ceil(this.actionObj.slotInterval / this.actionObj.cellWidth * (offset - Math.floor(offset / this.actionObj.cellWidth) * this.actionObj.cellWidth));\n        spanMinutes = isLastCell || !isLeft && spanMinutes === 0 ? this.actionObj.slotInterval : spanMinutes;\n        resizeTime = new Date(resizeDate.getTime());\n        resizeTime.setMinutes(resizeTime.getMinutes() + spanMinutes);\n        this.updateTimePosition(resizeTime);\n      }\n    } else {\n      const cloneIndex = closest(this.actionObj.clone, 'td').cellIndex;\n      const originalWidth = Math.ceil((isLeft ? this.actionObj.element.getBoundingClientRect().width : 0) / this.actionObj.cellWidth) * this.actionObj.cellWidth;\n      const noOfDays = Math.ceil((this.actionObj.clone.getBoundingClientRect().width - originalWidth) / this.actionObj.cellWidth);\n      const tr = closest(this.actionObj.clone, 'tr');\n      let dayIndex = isLeft ? cloneIndex - noOfDays : cloneIndex + noOfDays - 1;\n      dayIndex = this.getIndex(dayIndex);\n      resizeTime = this.parent.getDateFromElement(tr.children[dayIndex]);\n\n      if (isLeft) {\n        resizeTime.setHours(eventStart.getHours(), eventStart.getMinutes(), eventStart.getSeconds());\n      } else {\n        resizeTime.setHours(eventEnd.getHours(), eventEnd.getMinutes(), eventEnd.getSeconds());\n      }\n    }\n\n    if (isLeft) {\n      if (eventEnd.getTime() - resizeTime.getTime() <= 0) {\n        resizeTime = isWithoutScale ? resetTime(eventEnd) : eventStart;\n      }\n\n      this.actionObj.start = this.parent.activeViewOptions.timeScale.enable ? this.calculateIntervalTime(resizeTime) : resizeTime;\n    } else {\n      const isTimeScaleViews = isTimeViews && this.parent.activeViewOptions.timeScale.enable;\n      let resizeEnd = (!isTimeScaleViews || isDateHeader || isTimeViews && ['Week', 'Month', 'Year'].indexOf(headerName) > -1) && resizeTime.getHours() === 0 && resizeTime.getMinutes() === 0 ? addDays(resizeTime, 1) : resizeTime;\n\n      if (isWithoutScale && resizeEnd.getTime() - eventStart.getTime() <= 0) {\n        resizeEnd = addDays(resetTime(eventStart), 1);\n      }\n\n      this.actionObj.end = this.parent.activeViewOptions.timeScale.enable && this.parent.currentView !== 'Month' ? this.calculateIntervalTime(resizeEnd) : resizeEnd;\n    }\n  }\n\n  getTopBottomStyles(e, isTop) {\n    const viewElement = this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS);\n    const slotInterval = this.actionObj.cellHeight / this.actionObj.slotInterval * this.actionObj.interval;\n    let clnHeight = isTop ? this.actionObj.element.offsetHeight + (this.actionObj.Y - this.actionObj.pageY) : this.actionObj.element.offsetHeight + (this.actionObj.pageY - this.actionObj.Y);\n    let clnTop = isTop ? this.actionObj.element.offsetTop - (this.actionObj.Y - this.actionObj.pageY) : this.actionObj.clone.offsetTop;\n    clnHeight = clnTop < 0 ? this.actionObj.clone.offsetHeight : this.actionObj.clone.offsetTop + this.actionObj.clone.offsetHeight > this.scrollArgs.height ? this.actionObj.clone.offsetHeight : clnHeight;\n    clnTop = clnTop < 0 ? 0 : clnTop;\n    clnTop = isTop ? Math.floor(clnTop / slotInterval) * slotInterval : clnTop;\n    clnHeight = clnTop + clnHeight >= viewElement.scrollHeight ? viewElement.scrollHeight - clnTop : Math.ceil(clnHeight / slotInterval) * slotInterval;\n    const styles = {\n      height: formatUnit(clnHeight < this.actionObj.cellHeight ? Math.floor(clnHeight / slotInterval) * slotInterval : clnHeight),\n      top: formatUnit(clnHeight < this.actionObj.cellHeight && isTop ? Math.ceil(clnTop / slotInterval) * slotInterval : clnTop),\n      left: '0px',\n      right: '0px',\n      width: '100%'\n    };\n    return styles;\n  }\n\n  getLeftRightStyles(e, isLeft) {\n    const styles = {};\n    const isTimelineView = this.parent.activeView.isTimelineView();\n    const isTimeViews = ['TimelineDay', 'TimelineWeek', 'TimelineWorkWeek'].indexOf(this.parent.currentView) > -1 && this.parent.activeViewOptions.timeScale.enable;\n    const slotInterval = this.actionObj.cellWidth / this.actionObj.slotInterval * this.actionObj.interval;\n    const pageWidth = isLeft ? this.actionObj.X - this.actionObj.pageX : this.actionObj.pageX - this.actionObj.X;\n    const targetWidth = isTimelineView ? this.actionObj.element.getBoundingClientRect().width / this.actionObj.cellWidth * this.actionObj.cellWidth : this.parent.currentView === 'Month' ? this.actionObj.element.getBoundingClientRect().width : Math.ceil(this.actionObj.element.getBoundingClientRect().width / this.actionObj.cellWidth) * this.actionObj.cellWidth;\n    let offsetWidth = targetWidth + Math.ceil(pageWidth / this.actionObj.cellWidth) * this.actionObj.cellWidth;\n    const left = this.parent.enableRtl ? parseInt(this.actionObj.element.style.right, 10) : this.actionObj.clone.offsetLeft;\n\n    if (isTimeViews) {\n      offsetWidth = targetWidth + Math.ceil(pageWidth / slotInterval) * slotInterval;\n      offsetWidth = Math.round((left + offsetWidth) / slotInterval) * slotInterval - left;\n      this.actionObj.event[this.parent.eventFields.isAllDay] = false;\n    }\n\n    let width = !isLeft && offsetWidth + this.actionObj.clone.offsetLeft > this.scrollArgs.width ? this.actionObj.clone.getBoundingClientRect().width : offsetWidth < this.actionObj.cellWidth ? offsetWidth : offsetWidth;\n\n    if (this.parent.enableRtl) {\n      let rightValue = isTimelineView ? parseInt(this.actionObj.element.style.right, 10) : -(offsetWidth - this.actionObj.cellWidth);\n      rightValue = isTimelineView ? rightValue : isLeft ? 0 : rightValue > 0 ? 0 : rightValue;\n\n      if (isTimelineView && !isLeft) {\n        rightValue = Math.ceil((this.actionObj.element.offsetLeft + (this.actionObj.element.getBoundingClientRect().width + (this.actionObj.pageX - this.actionObj.X))) / slotInterval) * slotInterval;\n        rightValue = rightValue < 0 ? Math.abs(rightValue) : -rightValue;\n      }\n\n      rightValue = rightValue >= this.scrollArgs.width ? this.scrollArgs.width - this.actionObj.cellWidth : rightValue;\n      styles.right = formatUnit(rightValue);\n      width = width + rightValue > this.scrollArgs.width ? this.actionObj.clone.getBoundingClientRect().width : width;\n    } else {\n      let offsetLeft = isLeft ? this.actionObj.element.offsetLeft - (this.actionObj.X - this.actionObj.pageX) : this.parent.enableRtl ? this.actionObj.element.offsetLeft : 0;\n\n      if (isTimelineView) {\n        offsetLeft = isLeft ? offsetLeft : parseInt(this.actionObj.clone.style.left, 10);\n\n        if (this.parent.enableRtl) {\n          offsetLeft = !isLeft ? this.actionObj.pageX < this.actionObj.X - this.actionObj.clone.getBoundingClientRect().width ? parseInt(this.actionObj.clone.style.right, 10) : offsetLeft : offsetLeft;\n        } else {\n          offsetLeft = isLeft ? this.actionObj.pageX > this.actionObj.X + this.actionObj.clone.getBoundingClientRect().width && this.actionObj.clone.getBoundingClientRect().width === this.actionObj.cellWidth ? parseInt(this.actionObj.clone.style.left, 10) : offsetLeft : offsetLeft;\n        }\n      }\n\n      const leftValue = offsetLeft;\n      offsetLeft = isTimelineView ? isTimeViews ? isLeft ? Math.floor(offsetLeft / slotInterval) * slotInterval : offsetLeft : Math.floor(offsetLeft / this.actionObj.cellWidth) * this.actionObj.cellWidth : Math.ceil(Math.abs(offsetLeft) / this.actionObj.cellWidth) * this.actionObj.cellWidth;\n\n      if (offsetLeft < 0) {\n        offsetLeft = 0;\n        width = this.actionObj.clone.getBoundingClientRect().width;\n      }\n\n      const cloneWidth = Math.ceil(this.actionObj.clone.getBoundingClientRect().width / this.actionObj.cellWidth) * this.actionObj.cellWidth;\n\n      if (isLeft) {\n        styles.left = formatUnit(isTimelineView ? offsetLeft : isLeft ? leftValue < 0 ? -offsetLeft : Math.ceil((targetWidth - cloneWidth) / this.actionObj.cellWidth) * this.actionObj.cellWidth : offsetLeft);\n      }\n    }\n\n    styles.width = formatUnit(width);\n    return styles;\n  }\n\n  resizeValidation(e) {\n    const pages = this.getPageCoordinates(e);\n    const viewDimension = this.getContentAreaDimension();\n    const isTimeScale = this.parent.activeView.isTimelineView() && this.parent.activeViewOptions.timeScale.enable;\n    let cellWidth = this.actionObj.cellWidth;\n    let resizeValidation = false;\n\n    if (this.resizeEdges.left) {\n      if (pages.pageX < viewDimension.leftOffset && pages.pageX >= viewDimension.left && isTimeScale) {\n        cellWidth = 0;\n      }\n\n      resizeValidation = pages.pageX - cellWidth >= viewDimension.left;\n    }\n\n    if (this.resizeEdges.right) {\n      if (pages.pageX > viewDimension.rightOffset && pages.pageX <= viewDimension.right && isTimeScale) {\n        cellWidth = 0;\n      }\n\n      resizeValidation = pages.pageX + cellWidth <= viewDimension.right;\n    }\n\n    if (this.resizeEdges.top) {\n      resizeValidation = this.actionObj.clone.offsetTop >= viewDimension.top;\n    }\n\n    if (this.resizeEdges.bottom) {\n      resizeValidation = this.actionObj.clone.offsetTop + this.actionObj.clone.offsetHeight <= this.scrollArgs.height;\n    }\n\n    return resizeValidation;\n  }\n  /**\n   * Get module name\n   *\n   * @returns {string} Returns the module name..\n   */\n\n\n  getModuleName() {\n    return 'resize';\n  }\n\n}\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\n\nconst EVENT_GAP$2 = 2;\n/**\n * Year view events render\n */\n\nclass YearEvent extends TimelineEvent {\n  constructor(parent) {\n    super(parent, 'day');\n    this.isResource = false;\n  }\n\n  renderAppointments() {\n    if (this.parent.dragAndDropModule) {\n      this.parent.dragAndDropModule.setDragArea();\n    }\n\n    this.fields = this.parent.eventFields;\n    const elementSelector = this.parent.currentView === 'Year' ? '.' + APPOINTMENT_CLASS : '.' + APPOINTMENT_WRAPPER_CLASS + ',.' + MORE_INDICATOR_CLASS;\n    const eventWrappers = [].slice.call(this.parent.element.querySelectorAll(elementSelector));\n\n    for (const wrapper of eventWrappers) {\n      remove(wrapper);\n    }\n\n    this.renderedEvents = [];\n\n    if (this.parent.currentView === 'Year') {\n      this.yearViewEvents();\n    } else {\n      this.removeCellHeight();\n\n      if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n        this.isResource = true;\n        this.timelineResourceEvents();\n      } else {\n        this.timelineYearViewEvents();\n      }\n    }\n\n    this.parent.renderTemplates();\n    this.parent.notify(contentReady, {});\n  }\n\n  yearViewEvents() {\n    const months = this.getMonths();\n\n    for (const month of months) {\n      const queryString = `.e-month-calendar:nth-child(${months.indexOf(month) + 1}) td.e-work-cells`;\n      const workCells = [].slice.call(this.parent.element.querySelectorAll(queryString));\n      const monthDate = new Date(this.parent.selectedDate.getFullYear(), month, 1);\n      const monthStart = this.parent.calendarUtil.getMonthStartDate(new Date(monthDate.getTime()));\n      const monthEnd = this.parent.calendarUtil.getMonthEndDate(new Date(monthDate.getTime()));\n      let startDate = getWeekFirstDate(monthStart, this.parent.firstDayOfWeek);\n      const endDate = addDays(getWeekLastDate(monthEnd, this.parent.firstDayOfWeek), 1);\n\n      for (let index = 0; startDate.getTime() < endDate.getTime(); index++) {\n        const start = resetTime(new Date(startDate.getTime()));\n        const end = addDays(new Date(start.getTime()), 1);\n        const filterEvents = this.parent.eventBase.filterEvents(start, end);\n\n        if (filterEvents.length > 0) {\n          const workCell = workCells[index];\n\n          if (workCell) {\n            workCell.appendChild(createElement('div', {\n              className: APPOINTMENT_CLASS\n            }));\n          }\n        }\n\n        startDate = addDays(new Date(startDate.getTime()), 1);\n      }\n    }\n  }\n\n  timelineYearViewEvents() {\n    const workCell = this.parent.element.querySelector('.' + WORK_CELLS_CLASS + ':not(.' + OTHERMONTH_CLASS + ')');\n    this.cellWidth = workCell.offsetWidth;\n    this.cellHeader = getOuterHeight(workCell.querySelector('.' + DATE_HEADER_CLASS));\n    const eventTable = this.parent.element.querySelector('.' + EVENT_TABLE_CLASS);\n    this.eventHeight = getElementHeightFromClass(eventTable, APPOINTMENT_CLASS);\n    const wrapperCollection = [].slice.call(this.parent.element.querySelectorAll('.' + APPOINTMENT_CONTAINER_CLASS));\n    const months = this.getMonths();\n\n    for (let row = 0; row < months.length; row++) {\n      const wrapper = wrapperCollection[row];\n      let td = row + 1;\n      const eventWrapper = createElement('div', {\n        className: APPOINTMENT_WRAPPER_CLASS\n      });\n      wrapper.appendChild(eventWrapper);\n      let monthStart = new Date(this.parent.selectedDate.getFullYear(), months[row], 1);\n      const monthEnd = new Date(monthStart.getFullYear(), monthStart.getMonth() + 1, 0);\n      let dayIndex = monthStart.getDay();\n      const isSpannedCollection = [];\n\n      if (this.parent.activeViewOptions.orientation === 'Horizontal') {\n        this.renderedEvents = [];\n      }\n\n      while (monthStart.getTime() <= monthEnd.getTime()) {\n        let leftValue;\n        let rightValue;\n\n        if (this.parent.activeViewOptions.orientation === 'Vertical') {\n          const wrapper = wrapperCollection[dayIndex];\n          td = dayIndex + 1;\n          let eventWrapper = wrapper.querySelector('.' + APPOINTMENT_WRAPPER_CLASS);\n\n          if (!eventWrapper) {\n            eventWrapper = createElement('div', {\n              className: APPOINTMENT_WRAPPER_CLASS\n            });\n            wrapper.appendChild(eventWrapper);\n          }\n\n          if (this.parent.enableRtl) {\n            rightValue = row * this.cellWidth;\n          } else {\n            leftValue = row * this.cellWidth;\n          }\n        } else {\n          if (this.parent.enableRtl) {\n            rightValue = (dayIndex + monthStart.getDate() - 1) * this.cellWidth;\n          } else {\n            leftValue = (dayIndex + monthStart.getDate() - 1) * this.cellWidth;\n          }\n        }\n\n        const rowTd = this.parent.element.querySelector(`.e-content-wrap tr:nth-child(${td}) td`);\n        this.cellHeight = rowTd.offsetHeight;\n        const dayStart = resetTime(new Date(monthStart.getTime()));\n        const dayEnd = addDays(new Date(dayStart.getTime()), 1);\n        let resource;\n\n        if (this.parent.uiStateValues.isGroupAdaptive) {\n          resource = this.parent.resourceBase.lastResourceLevel[this.parent.uiStateValues.groupIndex];\n        }\n\n        let dayEvents = this.parent.eventBase.filterEvents(dayStart, dayEnd, undefined, resource);\n        dayEvents = this.parent.eventBase.sortByDateTime(dayEvents);\n\n        for (let index = 0, count = dayEvents.length; index < count; index++) {\n          const eventData = extend({}, dayEvents[index], null, true);\n          this.updateSpannedEvents(eventData, dayStart, dayEnd);\n          const overlapIndex = this.getIndex(dayStart);\n          eventData.Index = overlapIndex;\n          const availedHeight = this.cellHeader + this.eventHeight * (overlapIndex + 1) + EVENT_GAP$2 + this.moreIndicatorHeight;\n          const appArea = this.cellHeight - this.cellHeader - this.moreIndicatorHeight;\n          const renderedAppCount = Math.floor(appArea / (this.eventHeight + EVENT_GAP$2));\n          const moreIndicatorCount = count - renderedAppCount <= 0 ? 1 : count - renderedAppCount;\n\n          if (this.parent.activeViewOptions.orientation === 'Horizontal') {\n            const isRendered = this.renderedEvents.filter(eventObj => eventObj.Guid === eventData.Guid);\n            const isSpanned = isSpannedCollection.filter(eventObj => eventObj.Guid === eventData.Guid);\n\n            if (isRendered.length > 0 && isRendered[0].MoreIndicator || isSpanned.length > 0 && isSpanned[0].MoreIndicator) {\n              const moreIndex = this.parent.activeViewOptions.orientation === 'Horizontal' ? row : dayIndex;\n              this.renderMoreIndicator(eventWrapper, moreIndicatorCount, dayStart, moreIndex, leftValue, rightValue);\n              continue;\n            } else if (isRendered.length > 0 || isSpanned.length > 0) {\n              continue;\n            }\n          }\n\n          const isRowAutoHeight = this.parent.rowAutoHeight && this.parent.activeViewOptions.orientation === 'Horizontal';\n\n          if (isRowAutoHeight || this.cellHeight > availedHeight) {\n            this.renderEvent(eventWrapper, eventData, row, leftValue, rightValue, monthStart, dayIndex);\n            this.updateCellHeight(rowTd, availedHeight);\n            isSpannedCollection.push(eventData);\n          } else {\n            const moreIndex = this.parent.activeViewOptions.orientation === 'Horizontal' ? row : dayIndex;\n            this.renderMoreIndicator(eventWrapper, moreIndicatorCount, dayStart, moreIndex, leftValue, rightValue);\n\n            if (this.parent.activeViewOptions.orientation === 'Horizontal') {\n              eventData.MoreIndicator = true;\n              this.renderedEvents.push(eventData);\n              isSpannedCollection.push(eventData);\n            }\n          }\n        }\n\n        monthStart = addDays(new Date(monthStart.getTime()), 1);\n\n        if (this.parent.activeViewOptions.orientation === 'Vertical') {\n          dayIndex++;\n          this.renderedEvents = [];\n        }\n      }\n    }\n  }\n\n  updateSpannedEvents(eventObj, dayStart, dayEnd) {\n    const isLeftRightResize = this.isResource && this.parent.activeViewOptions.orientation === 'Vertical' || !this.isResource && this.parent.activeViewOptions.orientation === 'Horizontal';\n    const data = {\n      isLeft: true,\n      isRight: true,\n      isBottom: true,\n      isTop: true\n    };\n\n    if (dayStart.getTime() <= eventObj[this.fields.startTime].getTime()) {\n      if (isLeftRightResize) {\n        data.isLeft = false;\n      } else {\n        data.isTop = false;\n      }\n    }\n\n    if (dayEnd.getTime() >= eventObj[this.fields.endTime].getTime() || isLeftRightResize && !this.isResource && addDays(dayEnd, -1).getMonth() === eventObj[this.fields.endTime].getMonth()) {\n      if (isLeftRightResize) {\n        data.isRight = false;\n      } else {\n        data.isBottom = false;\n      }\n    }\n\n    eventObj.data = data;\n  }\n\n  timelineResourceEvents() {\n    const workCell = this.parent.element.querySelector('.' + WORK_CELLS_CLASS);\n    this.cellWidth = workCell.offsetWidth;\n    this.cellHeader = 0;\n    const eventTable = this.parent.element.querySelector('.' + EVENT_TABLE_CLASS);\n    this.eventHeight = getElementHeightFromClass(eventTable, APPOINTMENT_CLASS);\n    const wrapperCollection = [].slice.call(this.parent.element.querySelectorAll('.' + APPOINTMENT_CONTAINER_CLASS));\n    const resources = this.parent.uiStateValues.isGroupAdaptive ? [this.parent.resourceBase.lastResourceLevel[this.parent.uiStateValues.groupIndex]] : this.parent.activeViewOptions.allowVirtualScrolling ? this.parent.resourceBase.renderedResources : this.parent.resourceBase.lastResourceLevel;\n    const months = this.getMonths();\n\n    if (this.parent.activeViewOptions.orientation === 'Horizontal') {\n      for (let month = 0; month < months.length; month++) {\n        const monthStart = new Date(this.parent.selectedDate.getFullYear(), months[month], 1);\n\n        for (let i = 0, len = resources.length; i < len; i++) {\n          this.renderedEvents = [];\n          this.renderResourceEvent(wrapperCollection[month], resources[i], month, i, monthStart);\n        }\n      }\n    } else {\n      for (let i = 0, len = resources.length; i < len; i++) {\n        this.renderedEvents = [];\n\n        for (let month = 0; month < months.length; month++) {\n          const monthStart = new Date(this.parent.selectedDate.getFullYear(), months[month], 1);\n          this.renderResourceEvent(wrapperCollection[i], resources[i], month, i, monthStart);\n        }\n      }\n    }\n  }\n\n  renderResourceEvent(wrapper, resource, month, index, monthStart) {\n    const eventWrapper = createElement('div', {\n      className: APPOINTMENT_WRAPPER_CLASS\n    });\n    wrapper.appendChild(eventWrapper);\n    const monthEnd = addDays(lastDateOfMonth(new Date(monthStart.getTime())), 1);\n    const eventDatas = this.parent.eventBase.filterEvents(monthStart, monthEnd, undefined, resource);\n    const rowIndex = this.parent.activeViewOptions.orientation === 'Vertical' ? index : month;\n    const td = this.parent.element.querySelector(`.e-content-wrap tr:nth-child(${rowIndex + 1}) td`);\n    this.cellHeight = td.offsetHeight;\n    this.groupOrder = resource.groupOrder;\n\n    for (let a = 0; a < eventDatas.length; a++) {\n      const data = eventDatas[a];\n      let overlapIndex;\n      const eventData = extend({}, data, null, true);\n\n      if (this.parent.activeViewOptions.group.resources.length > 0) {\n        const eventObj = this.isSpannedEvent(eventData, monthStart);\n        overlapIndex = this.getIndex(eventObj[this.fields.startTime]);\n        eventData.Index = overlapIndex;\n      } else {\n        overlapIndex = this.getIndex(eventData[this.fields.startTime]);\n        eventData.Index = overlapIndex;\n      }\n\n      const availedHeight = this.cellHeader + this.eventHeight * (a + 1) + EVENT_GAP$2 + this.moreIndicatorHeight;\n      const leftValue = this.parent.activeViewOptions.orientation === 'Vertical' ? month * this.cellWidth : index * this.cellWidth;\n\n      if (this.parent.rowAutoHeight || this.cellHeight > availedHeight) {\n        this.renderEvent(eventWrapper, eventData, month, leftValue, leftValue, monthStart, index);\n        this.updateCellHeight(td, availedHeight);\n      } else {\n        const moreIndex = this.parent.activeViewOptions.orientation === 'Horizontal' ? month : index;\n        this.renderMoreIndicator(eventWrapper, eventDatas.length - a, monthStart, moreIndex, leftValue, leftValue, index);\n\n        if (this.parent.activeViewOptions.orientation === 'Horizontal') {\n          for (let i = index; i < eventDatas.length; i++) {\n            this.renderedEvents.push(extend({}, eventDatas[i], {\n              Index: overlapIndex + i\n            }, true));\n          }\n        }\n\n        break;\n      }\n    }\n  } // eslint-disable-next-line max-len\n\n\n  renderEvent(wrapper, eventData, row, left, right, monthDate, rowIndex) {\n    const eventObj = this.isSpannedEvent(eventData, monthDate);\n    const wrap = this.createEventElement(eventObj);\n    let width;\n    let index;\n\n    if (eventObj.isSpanned.count === 1) {\n      const endTime = addDays(eventObj[this.fields.endTime], -1);\n      eventObj[this.fields.endTime] = endTime > eventObj[this.fields.startTime] ? endTime : eventObj[this.fields.endTime];\n    }\n\n    if (eventObj[this.fields.startTime] > eventObj[this.fields.endTime]) {\n      return;\n    }\n\n    if (this.parent.activeViewOptions.orientation === 'Horizontal') {\n      index = row + 1;\n\n      if (eventObj[this.fields.startTime].getTime() === eventObj[this.fields.endTime].getTime()) {\n        eventObj.isSpanned.count = 1;\n      }\n\n      width = eventObj.isSpanned.count * this.cellWidth;\n    } else {\n      index = rowIndex + 1;\n      width = this.cellWidth;\n    }\n\n    const rowTd = this.parent.element.querySelector(`.e-content-wrap tr:nth-child(${index}) td`);\n    const top = rowTd.offsetTop + this.cellHeader + this.eventHeight * eventObj.Index + EVENT_GAP$2;\n    setStyleAttribute(wrap, {\n      'width': width + 'px',\n      'height': this.eventHeight + 'px',\n      'left': left + 'px',\n      'right': right + 'px',\n      'top': top + 'px'\n    });\n    const args = {\n      data: eventObj,\n      element: wrap,\n      cancel: false,\n      type: 'event'\n    };\n    this.parent.trigger(eventRendered, args, eventArgs => {\n      if (!eventArgs.cancel) {\n        wrapper.appendChild(wrap);\n        this.wireAppointmentEvents(wrap, eventObj);\n\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n          this.renderedEvents.push(extend({}, eventObj, null, true));\n        } else if (this.parent.activeViewOptions.orientation === 'Vertical') {\n          this.renderedEvents.push(extend({}, eventObj, null, true));\n        } else if ((eventObj.isSpanned.isRight || eventObj.isSpanned.isLeft) && this.parent.activeViewOptions.orientation === 'Horizontal' || !eventObj.isSpanned.isRight) {\n          this.renderedEvents.push(extend({}, eventObj, null, true));\n        }\n      }\n    });\n  } // eslint-disable-next-line max-len\n\n\n  renderMoreIndicator(wrapper, count, startDate, row, left, right, index) {\n    if (this.parent.activeViewOptions.group.resources.length === 0 && wrapper.querySelector('[data-start-date=\"' + startDate.getTime() + '\"]')) {\n      return;\n    }\n\n    let endDate;\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      endDate = addDays(lastDateOfMonth(new Date(startDate.getTime())), 1);\n    } else {\n      endDate = addDays(new Date(startDate.getTime()), 1);\n    }\n\n    const moreIndicator = this.getMoreIndicatorElement(count, startDate, endDate);\n    const rowTr = this.parent.element.querySelector(`.e-content-wrap tr:nth-child(${row + 1})`);\n    const top = rowTr.offsetTop + (this.cellHeight - this.moreIndicatorHeight);\n    left = Math.floor(left / this.cellWidth) * this.cellWidth;\n    right = Math.floor(right / this.cellWidth) * this.cellWidth;\n    setStyleAttribute(moreIndicator, {\n      'width': this.cellWidth + 'px',\n      'left': left + 'px',\n      'right': right + 'px',\n      'top': top + 'px'\n    });\n\n    if (!isNullOrUndefined(index)) {\n      moreIndicator.setAttribute('data-group-index', index.toString());\n    }\n\n    wrapper.appendChild(moreIndicator);\n    EventHandler.add(moreIndicator, 'click', this.moreIndicatorClick, this);\n  }\n\n  createEventElement(record) {\n    const eventSubject = record[this.fields.subject] || this.parent.eventSettings.fields.subject.default || this.parent.localeObj.getConstant('addTitle');\n    const eventWrapper = createElement('div', {\n      className: APPOINTMENT_CLASS,\n      attrs: {\n        'data-id': 'Appointment_' + record[this.fields.id],\n        'data-guid': record.Guid,\n        'role': 'button',\n        'tabindex': '0',\n        'aria-disabled': this.parent.eventBase.getReadonlyAttribute(record),\n        'aria-pressed': 'false',\n        'aria-grabbed': 'true',\n        'aria-label': this.parent.getAnnouncementString(record)\n      }\n    });\n\n    if (this.cssClass) {\n      addClass([eventWrapper], this.cssClass);\n    }\n\n    if (record[this.fields.isReadonly]) {\n      addClass([eventWrapper], READ_ONLY);\n    }\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      const resIndex = this.getGroupIndexFromEvent(record);\n      eventWrapper.setAttribute('data-group-index', resIndex.toString());\n    }\n\n    let templateElement = [];\n    const eventObj = extend({}, record, null, true);\n\n    if (this.parent.activeViewOptions.eventTemplate) {\n      const templateId = this.parent.element.id + '_' + this.parent.activeViewOptions.eventTemplateName + 'eventTemplate';\n      templateElement = this.parent.getAppointmentTemplate()(eventObj, this.parent, 'eventTemplate', templateId, false);\n    } else {\n      const locationEle = record[this.fields.location] || this.parent.eventSettings.fields.location.default || '';\n      const subjectEle = createElement('div', {\n        className: SUBJECT_CLASS,\n        innerHTML: eventSubject + (locationEle ? ';&nbsp' + locationEle : '')\n      });\n      const startTimeEle = createElement('div', {\n        className: APPOINTMENT_TIME + (this.parent.isAdaptive ? ' ' + DISABLE_CLASS : ''),\n        innerHTML: this.parent.getTimeString(eventObj[this.fields.startTime])\n      });\n      const endTimeEle = createElement('div', {\n        className: APPOINTMENT_TIME + (this.parent.isAdaptive ? ' ' + DISABLE_CLASS : ''),\n        innerHTML: this.parent.getTimeString(eventObj[this.fields.endTime])\n      });\n      addClass([subjectEle], 'e-text-center');\n\n      if (record[this.fields.isAllDay]) {\n        templateElement = [subjectEle];\n      } else if (!eventObj.isLeft && !eventObj.isRight) {\n        templateElement = [startTimeEle, subjectEle, endTimeEle];\n      } else {\n        if (!eventObj.isLeft) {\n          templateElement.push(startTimeEle);\n        }\n\n        templateElement.push(subjectEle);\n\n        if (!eventObj.isRight) {\n          templateElement.push(endTimeEle);\n        }\n      }\n    }\n\n    const appointmentDetails = createElement('div', {\n      className: APPOINTMENT_DETAILS\n    });\n    append(templateElement, appointmentDetails);\n    eventWrapper.appendChild(appointmentDetails);\n    this.renderResizeHandler(eventWrapper, record.data, record[this.fields.isReadonly]);\n    this.applyResourceColor(eventWrapper, eventObj, 'backgroundColor', this.groupOrder);\n    return eventWrapper;\n  }\n\n  isSpannedEvent(eventObj, monthDate) {\n    const monthStart = new Date(monthDate.getFullYear(), monthDate.getMonth(), 1);\n    const monthEnd = addDays(new Date(monthDate.getFullYear(), monthDate.getMonth() + 1, 0), 1);\n    const eventData = extend({}, eventObj, null, true);\n    const eventStart = eventData[this.fields.startTime];\n    const eventEnd = eventData[this.fields.endTime];\n    const isSpanned = {\n      isLeft: false,\n      isRight: false,\n      count: 1\n    };\n\n    if (this.isResource) {\n      this.updateSpannedEvents(eventObj, monthStart, monthEnd);\n    }\n\n    if (eventStart.getTime() < monthStart.getTime()) {\n      eventData[this.fields.startTime] = monthStart;\n      isSpanned.isLeft = true;\n    }\n\n    if (eventEnd.getTime() > monthEnd.getTime()) {\n      eventData[this.fields.endTime] = monthEnd;\n      isSpanned.isRight = true;\n    }\n\n    if (this.parent.activeViewOptions.group.resources.length === 0) {\n      let end = resetTime(eventData[this.fields.endTime]).getTime();\n      const start = resetTime(eventData[this.fields.startTime]).getTime();\n\n      if (eventObj[this.fields.isAllDay] && end === eventObj[this.fields.endTime].getTime() || isSpanned.isRight) {\n        end = addDays(new Date(end), -1).getTime();\n      }\n\n      isSpanned.count = Math.ceil((end - start) / MS_PER_DAY) + 1;\n    }\n\n    eventData.isSpanned = isSpanned;\n\n    if (resetTime(eventStart).getTime() < resetTime(this.parent.minDate).getTime()) {\n      eventData[this.fields.startTime] = this.parent.minDate;\n    }\n\n    if (resetTime(eventEnd).getTime() > resetTime(this.parent.maxDate).getTime()) {\n      eventData[this.fields.endTime] = this.parent.maxDate;\n    }\n\n    return eventData;\n  }\n\n  getOverlapEvents(date, appointments) {\n    const appointmentsList = [];\n    let dateStart;\n    let dateEnd;\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      const monthStart = this.parent.calendarUtil.getMonthStartDate(new Date(date.getTime()));\n      const monthEnd = addDays(this.parent.calendarUtil.getMonthEndDate(new Date(date.getTime())), -1);\n      dateStart = resetTime(new Date(monthStart.getTime())).getTime();\n      dateEnd = resetTime(new Date(monthEnd.getTime())).getTime();\n    } else {\n      if (this.parent.rowAutoHeight) {\n        dateStart = resetTime(new Date(date.getTime())).getTime();\n        dateEnd = addDays(resetTime(new Date(date.getTime())), 1).getTime();\n      } else {\n        dateStart = dateEnd = resetTime(new Date(date.getTime())).getTime();\n      }\n    }\n\n    for (const app of appointments) {\n      const appStart = new Date(app[this.fields.startTime].getTime());\n      const appEnd = new Date(app[this.fields.endTime].getTime());\n\n      if (this.parent.activeViewOptions.orientation === 'Vertical' && this.parent.activeViewOptions.group.resources.length > 0) {\n        if (resetTime(appStart).getTime() >= dateStart && resetTime(appEnd).getTime() <= dateEnd) {\n          appointmentsList.push(app);\n        }\n      } else {\n        const timeCondition = app[this.fields.isAllDay] ? resetTime(appEnd).getTime() > dateStart : resetTime(appEnd).getTime() >= dateStart;\n\n        if (resetTime(appStart).getTime() <= dateStart && timeCondition || resetTime(appStart).getTime() >= dateStart && resetTime(appEnd).getTime() <= dateEnd) {\n          appointmentsList.push(app);\n        }\n      }\n    }\n\n    return appointmentsList;\n  }\n\n  getMonths() {\n    // eslint-disable-next-line prefer-spread\n    return Array.apply(null, {\n      length: this.parent.monthsCount\n    }).map((value, index) => this.parent.firstMonthOfYear + index);\n  }\n\n  removeCellHeight() {\n    const elementSelector = `.${MONTH_HEADER_WRAPPER} tbody tr,.${RESOURCE_COLUMN_TABLE_CLASS} tbody tr,.${CONTENT_TABLE_CLASS} tbody tr`;\n    const rows = [].slice.call(this.element.querySelectorAll(elementSelector));\n\n    for (const row of rows) {\n      row.firstElementChild.style.height = '';\n    }\n  }\n\n  destroy() {\n    super.destroy();\n    this.parent = null;\n  }\n\n}\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\n\nconst MINUTES_PER_DAY = 1440;\n/**\n * Schedule events drag actions\n */\n\nclass DragAndDrop extends ActionBase {\n  constructor() {\n    super(...arguments);\n    this.widthUptoCursorPoint = 0;\n    this.heightUptoCursorPoint = 0;\n    this.cursorPointIndex = 0;\n    this.isHeaderRows = false;\n    this.isTimelineDayProcess = false;\n    this.widthPerMinute = 0;\n    this.heightPerMinute = 0;\n    this.minDiff = 0;\n    this.isStepDragging = false;\n    this.isMorePopupOpened = false;\n    this.isAllDayDrag = false;\n    this.isMultiSelect = false;\n    this.multiData = [];\n    this.updatedData = [];\n    this.swagData = [];\n    this.startTime = 0;\n    this.isAllDayTarget = false;\n    this.targetTd = null;\n    this.isCursorAhead = false;\n  }\n\n  wireDragEvent(element) {\n    new Draggable(element, {\n      abort: '.' + EVENT_RESIZE_CLASS,\n      clone: true,\n      isDragScroll: true,\n      enableTapHold: this.parent.isAdaptive,\n      enableTailMode: this.parent.eventDragArea ? true : false,\n      cursorAt: this.parent.eventDragArea ? {\n        left: -20,\n        top: -20\n      } : {\n        left: 0,\n        top: 0\n      },\n      dragArea: this.dragArea,\n      dragStart: this.dragStart.bind(this),\n      drag: this.drag.bind(this),\n      dragStop: this.dragStop.bind(this),\n      enableAutoScroll: false,\n      helper: this.dragHelper.bind(this),\n      queryPositionInfo: this.dragPosition.bind(this)\n    });\n  }\n\n  setDragArea() {\n    const dragElement = document.querySelector(this.parent.eventDragArea);\n    this.dragArea = this.parent.eventDragArea && dragElement ? dragElement : this.parent.element.querySelector('.' + CONTENT_TABLE_CLASS);\n  }\n\n  dragHelper(e) {\n    this.setDragActionDefaultValues();\n    this.actionObj.element = e.element;\n    this.actionObj.action = 'drag';\n    let elements = [];\n\n    if (!this.parent.allowMultiDrag || isNullOrUndefined(this.parent.selectedElements) || this.parent.selectedElements.length === 0 || this.parent.selectedElements.length > 0 && this.parent.selectedElements.indexOf(this.actionObj.element) === -1) {\n      elements = [e.element];\n    } else {\n      elements = this.parent.selectedElements;\n      this.isMultiSelect = true;\n    }\n\n    elements.forEach(ele => {\n      const cloneElement = this.createCloneElement(ele);\n\n      if (ele.getAttribute('data-guid') === this.actionObj.element.getAttribute('data-guid')) {\n        this.actionObj.clone = cloneElement;\n\n        if (!this.parent.eventDragArea && this.parent.currentView !== 'Month' && this.parent.activeViewOptions.timeScale.enable && !this.parent.activeView.isTimelineView() && !this.actionObj.element.classList.contains(ALLDAY_APPOINTMENT_CLASS)) {\n          setStyleAttribute(this.actionObj.clone, {\n            cursor: 'move',\n            left: '0%',\n            right: '0%',\n            width: '100%'\n          });\n        }\n\n        this.actionObj.clone.style.top = formatUnit(this.actionObj.element.offsetTop);\n      }\n\n      this.actionObj.cloneElement.push(cloneElement);\n      this.actionObj.originalElement.push(ele);\n    });\n    return this.actionObj.clone;\n  }\n\n  dragPosition(e) {\n    if (this.parent.eventDragArea) {\n      return {\n        left: e.left,\n        top: e.top\n      };\n    }\n\n    const cellHeight = this.actionObj.cellHeight / this.actionObj.slotInterval * this.actionObj.interval;\n    let leftValue = formatUnit(0);\n\n    if (this.parent.currentView === 'Month') {\n      leftValue = e.left;\n    }\n\n    let cloneRight;\n\n    if (this.isStepDragging) {\n      cloneRight = Math.ceil(this.actionObj.clone.getBoundingClientRect().right) + this.actionObj.interval;\n    } else {\n      cloneRight = this.actionObj.clone.getBoundingClientRect().right;\n    }\n\n    const dragArea = this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS);\n    const contentWrapRight = dragArea.getBoundingClientRect().right;\n\n    if (this.parent.activeView.isTimelineView() && this.parent.currentView !== 'TimelineYear' && !this.parent.enableRtl && this.actionObj.pageX > cloneRight && !this.isMorePopupOpened && !(this.actionObj.pageX > contentWrapRight)) {\n      this.isCursorAhead = true;\n    }\n\n    if (this.parent.activeView.isTimelineView()) {\n      leftValue = formatUnit(this.actionObj.clone.offsetLeft);\n    }\n\n    let topValue;\n\n    if (this.parent.activeView.isTimelineView() || !this.parent.timeScale.enable || !isNullOrUndefined(this.actionObj.clone.offsetParent) && this.actionObj.clone.offsetParent.classList.contains(MORE_EVENT_POPUP_CLASS)) {\n      topValue = formatUnit(this.actionObj.clone.offsetTop);\n    } else if (this.parent.currentView === 'Month') {\n      topValue = formatUnit(0);\n    } else if (this.actionObj.clone.classList.contains(ALLDAY_APPOINTMENT_CLASS)) {\n      topValue = formatUnit(this.parent.element.querySelector('.' + ALLDAY_ROW_CLASS).offsetTop);\n      setStyleAttribute(this.actionObj.clone, {\n        width: formatUnit(Math.ceil(this.actionObj.clone.offsetWidth / this.actionObj.cellWidth) * this.actionObj.cellWidth),\n        right: this.parent.enableRtl && formatUnit(0)\n      });\n    } else {\n      if (this.actionObj.element.classList.contains(ALLDAY_APPOINTMENT_CLASS) && !this.actionObj.clone.classList.contains(ALLDAY_APPOINTMENT_CLASS)) {\n        setStyleAttribute(this.actionObj.clone, {\n          height: formatUnit(this.actionObj.cellHeight),\n          width: formatUnit(this.actionObj.cellWidth - 1),\n          pointerEvents: 'none'\n        });\n      }\n\n      let top = parseInt(e.top, 10);\n      top = top < 0 ? 0 : top;\n      topValue = formatUnit(Math.ceil(top / cellHeight) * cellHeight);\n      const scrollHeight = this.parent.element.querySelector('.e-content-wrap').scrollHeight;\n      const cloneBottom = parseInt(topValue, 10) + this.actionObj.clone.offsetHeight;\n\n      if (cloneBottom > scrollHeight) {\n        topValue = parseInt(topValue, 10) - (cloneBottom - scrollHeight) + 'px';\n      }\n    }\n\n    return {\n      left: leftValue,\n      top: topValue\n    };\n  }\n\n  setDragActionDefaultValues() {\n    this.actionObj.action = 'drag';\n    this.actionObj.isAllDay = null;\n    this.actionObj.slotInterval = this.parent.activeViewOptions.timeScale.interval / this.parent.activeViewOptions.timeScale.slotCount;\n    this.actionObj.interval = this.actionObj.slotInterval;\n    const workCell = this.parent.element.querySelector('.' + WORK_CELLS_CLASS);\n    this.actionObj.cellWidth = workCell.offsetWidth;\n    this.actionObj.cellHeight = workCell.offsetHeight;\n  }\n\n  dragStart(e) {\n    const eventGuid = this.actionObj.element.getAttribute('data-guid');\n    this.actionObj.event = this.parent.eventBase.getEventByGuid(eventGuid);\n    const eventObj = extend({}, this.actionObj.event, null, true);\n\n    if (!isNullOrUndefined(eventObj)) {\n      this.startTime = eventObj[this.parent.eventFields.startTime].getTime();\n    }\n\n    const dragArgs = {\n      cancel: false,\n      data: eventObj,\n      selectedData: this.getSelectedData(),\n      event: e,\n      excludeSelectors: null,\n      element: this.actionObj.element,\n      interval: this.actionObj.interval,\n      navigation: {\n        enable: false,\n        timeDelay: 2000\n      },\n      scroll: {\n        enable: true,\n        scrollBy: 30,\n        timeDelay: 100\n      }\n    };\n    this.parent.trigger(dragStart, dragArgs, dragEventArgs => {\n      if (dragEventArgs.cancel || !isNullOrUndefined(this.actionObj.element) && isNullOrUndefined(this.actionObj.element.parentElement)) {\n        const dragObj = this.actionObj.element.ej2_instances[0];\n\n        if (!isNullOrUndefined(dragObj)) {\n          dragObj.intDestroy(e.event);\n        }\n\n        this.actionObj.action = '';\n        this.removeCloneElementClasses();\n        this.removeCloneElement();\n        return;\n      }\n\n      this.actionClass('addClass');\n      this.parent.uiStateValues.action = true;\n      this.actionObj.start = eventObj[this.parent.eventFields.startTime];\n      this.actionObj.end = eventObj[this.parent.eventFields.endTime];\n      this.actionObj.groupIndex = parseInt(this.actionObj.element.getAttribute('data-group-index') || '0', 10);\n      this.actionObj.interval = dragEventArgs.interval;\n      this.actionObj.navigation = dragEventArgs.navigation;\n      this.actionObj.scroll = dragEventArgs.scroll;\n      this.actionObj.excludeSelectors = dragEventArgs.excludeSelectors;\n      const viewElement = this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS);\n      this.scrollArgs = {\n        element: viewElement,\n        width: viewElement.scrollWidth,\n        height: viewElement.scrollHeight\n      };\n      this.widthPerMinute = this.actionObj.cellWidth / this.actionObj.slotInterval * this.actionObj.interval;\n      this.heightPerMinute = this.actionObj.cellHeight / this.actionObj.slotInterval * this.actionObj.interval;\n      this.widthUptoCursorPoint = 0;\n      this.heightUptoCursorPoint = 0;\n      this.cursorPointIndex = -1;\n      this.isHeaderRows = false;\n      this.isTimelineDayProcess = false;\n      this.minDiff = 0;\n      this.isMorePopupOpened = false;\n      this.daysVariation = -1;\n      this.isAllDayTarget = this.actionObj.clone.classList.contains(ALLDAY_APPOINTMENT_CLASS);\n\n      if ((this.parent.activeView.isTimelineView() || !this.parent.timeScale.enable) && this.parent.currentView !== 'TimelineYear') {\n        if (!isNullOrUndefined(this.actionObj.clone.offsetParent) && this.actionObj.clone.offsetParent.classList.contains(MORE_EVENT_POPUP_CLASS)) {\n          this.isMorePopupOpened = true;\n        }\n\n        this.actionObj.pageX = e.event.pageX;\n        const rows = this.parent.activeViewOptions.headerRows;\n        this.isHeaderRows = rows.length > 0 && rows[rows.length - 1].option !== 'Hour' && rows[rows.length - 1].option !== 'Date';\n        this.isTimelineDayProcess = !this.parent.activeViewOptions.timeScale.enable || this.isHeaderRows || this.parent.currentView === 'TimelineMonth' || rows.length > 0 && rows[rows.length - 1].option === 'Date';\n        this.isStepDragging = !this.isTimelineDayProcess && this.actionObj.slotInterval !== this.actionObj.interval;\n\n        if (this.isTimelineDayProcess) {\n          this.timelineEventModule = new TimelineEvent(this.parent, 'day');\n        } else {\n          this.timelineEventModule = new TimelineEvent(this.parent, 'hour');\n        }\n      }\n\n      if (this.parent.currentView === 'TimelineYear') {\n        this.yearEvent = new YearEvent(this.parent);\n      }\n\n      if (this.parent.currentView === 'Month') {\n        this.startTime = resetTime(new Date(this.startTime)).getTime();\n        this.updateOriginalElement(this.actionObj.clone);\n        this.monthEvent = new MonthEvent(this.parent);\n      }\n\n      if (this.parent.currentView === 'Day' || this.parent.currentView === 'Week' || this.parent.currentView === 'WorkWeek') {\n        this.verticalEvent = new VerticalEvent(this.parent);\n        this.verticalEvent.initializeValues();\n        const splitEvents = this.splitEvent(this.actionObj.event);\n        splitEvents.forEach(event => {\n          let query = `.e-day-wrapper[data-date=\"${resetTime(event[this.parent.eventFields.startTime]).getTime()}\"]`;\n\n          if (this.parent.activeViewOptions.group.resources.length > 0) {\n            query = query.concat('[data-group-index = \"' + this.actionObj.groupIndex + '\"]');\n          }\n\n          const appWrap = this.parent.element.querySelector(query);\n\n          if (appWrap) {\n            const appEle = appWrap.querySelector('[data-id=\"' + this.actionObj.clone.getAttribute('data-id') + '\"]');\n\n            if (appEle) {\n              addClass([appEle], EVENT_ACTION_CLASS);\n            }\n          }\n        });\n      }\n    });\n  }\n\n  getSelectedData() {\n    if (this.isMultiSelect && this.multiData.length === 0 && this.parent.selectedElements.length > 0) {\n      for (const element of this.parent.selectedElements) {\n        const eventGuid = element.getAttribute('data-guid');\n        const data = this.parent.eventBase.getEventByGuid(eventGuid);\n        this.multiData.push(extend({}, data, null, true));\n      }\n    }\n\n    return this.multiData;\n  }\n\n  drag(e) {\n    if (this.parent.quickPopup) {\n      this.parent.quickPopup.quickPopupHide(true);\n    }\n\n    if (!isNullOrUndefined(e.target) && e.target.classList.contains(DISABLE_DATES)) {\n      return;\n    }\n\n    const eventObj = extend({}, this.actionObj.event, null, true);\n    const eventArgs = this.getPageCoordinates(e);\n    this.actionObj.Y = this.actionObj.pageY = eventArgs.pageY;\n    this.actionObj.X = this.actionObj.pageX = eventArgs.pageX;\n    this.actionObj.target = e.target;\n    this.widthUptoCursorPoint = this.widthUptoCursorPoint === 0 ? Math.ceil(Math.abs(this.actionObj.clone.getBoundingClientRect().left - this.actionObj.X) / this.widthPerMinute) * this.widthPerMinute : this.widthUptoCursorPoint;\n    this.widthUptoCursorPoint = this.isMorePopupOpened ? this.actionObj.cellWidth : this.widthUptoCursorPoint;\n    this.heightUptoCursorPoint = this.heightUptoCursorPoint === 0 ? Math.ceil(Math.abs(this.actionObj.clone.getBoundingClientRect().top - this.actionObj.Y) / this.heightPerMinute) * this.heightPerMinute : this.heightUptoCursorPoint;\n    this.isAllDayDrag = this.parent.activeViewOptions.timeScale.enable ? this.actionObj.clone.classList.contains(ALLDAY_APPOINTMENT_CLASS) : this.actionObj.event[this.parent.eventFields.isAllDay];\n\n    if (this.isStepDragging && this.minDiff === 0) {\n      this.calculateMinutesDiff(eventObj);\n    }\n\n    if ((this.parent.currentView === 'Month' || this.isAllDayDrag) && this.daysVariation < 0) {\n      const date = this.parent.getDateFromElement(this.actionObj.target);\n\n      if (!isNullOrUndefined(date)) {\n        const currentDate = resetTime(date);\n        const startDate = resetTime(new Date(eventObj[this.parent.eventFields.startTime].getTime()));\n        this.daysVariation = (currentDate.getTime() - startDate.getTime()) / MS_PER_DAY;\n      } else {\n        this.daysVariation = 0;\n      }\n    } else {\n      this.daysVariation = 0;\n    }\n\n    if (this.parent.eventDragArea) {\n      const targetElement = eventArgs.target;\n      this.actionObj.clone.style.top = formatUnit(targetElement.offsetTop);\n      this.actionObj.clone.style.left = formatUnit(targetElement.offsetLeft);\n      const currentTarget = closest(targetElement, '.' + ROOT);\n\n      if (!currentTarget) {\n        this.actionObj.clone.style.height = '';\n        this.actionObj.clone.style.width = '';\n      } else {\n        if (!(this.parent.currentView === 'Week' || this.parent.currentView === 'WorkWeek' || this.parent.currentView === 'Day')) {\n          this.actionObj.clone.style.width = formatUnit(this.actionObj.element.offsetWidth);\n        }\n      }\n    }\n\n    this.updateScrollPosition(e);\n    this.updateNavigatingPosition(e);\n    this.updateDraggingDateTime(e);\n    const dragArgs = {\n      data: eventObj,\n      event: e,\n      element: this.actionObj.element,\n      startTime: this.actionObj.start,\n      endTime: this.actionObj.end,\n      selectedData: this.updatedData\n    };\n\n    if (this.parent.group.resources.length > 0) {\n      dragArgs.groupIndex = this.actionObj.groupIndex;\n    }\n\n    this.parent.trigger(drag, dragArgs);\n  }\n\n  calculateMinutesDiff(eventObj) {\n    if (this.parent.enableRtl) {\n      this.minDiff = (this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint) / this.widthPerMinute * this.actionObj.interval;\n    } else {\n      this.minDiff = this.widthUptoCursorPoint / this.widthPerMinute * this.actionObj.interval;\n    }\n\n    const startDate = eventObj[this.parent.eventFields.startTime];\n    const startTime = this.parent.activeView.renderDates[0];\n    const startEndHours = getStartEndHours(startTime, this.parent.activeView.getStartHour(), this.parent.activeView.getEndHour());\n\n    if (startEndHours.startHour.getTime() > startDate.getTime()) {\n      this.minDiff = this.minDiff + (startEndHours.startHour.getTime() - startDate.getTime()) / MS_PER_MINUTE;\n    }\n  }\n\n  dragStop(e) {\n    this.isCursorAhead = false;\n    this.removeCloneElementClasses();\n    this.removeCloneElement();\n    clearInterval(this.actionObj.navigationInterval);\n    this.actionObj.navigationInterval = null;\n    clearInterval(this.actionObj.scrollInterval);\n    this.actionObj.scrollInterval = null;\n    this.actionClass('removeClass');\n    this.parent.uiStateValues.action = false;\n    this.actionObj.action = null;\n\n    if (this.isAllowDrop(e)) {\n      return;\n    }\n\n    const target = !e.target.classList.contains('e-work-cells') && this.parent.cellTemplate ? closest(e.target, '.e-work-cells') : e.target;\n    const dragArgs = {\n      cancel: false,\n      data: this.getChangedData(this.updatedData),\n      selectedData: this.updatedData,\n      event: e,\n      element: this.actionObj.element,\n      target: target\n    };\n    this.parent.trigger(dragStop, dragArgs, dragEventArgs => {\n      if (dragEventArgs.cancel) {\n        return;\n      }\n\n      if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.activeViewOptions.group.allowGroupEdit && !this.parent.rowAutoHeight && !this.parent.virtualScrollModule && this.parent.activeViewOptions.group.byGroupID) {\n        this.parent.crudModule.crudObj.isCrudAction = true;\n        this.parent.crudModule.crudObj.sourceEvent = [this.parent.resourceBase.lastResourceLevel[parseInt(dragArgs.element.getAttribute('data-group-index'), 10)]];\n        const currentGroupIndex = parseInt(dragArgs.target.getAttribute('data-group-index'), 10) || this.actionObj.groupIndex;\n        this.parent.crudModule.crudObj.targetEvent = [this.parent.resourceBase.lastResourceLevel[currentGroupIndex]];\n      }\n\n      this.saveChangedData(dragEventArgs, this.isMultiSelect);\n    });\n    this.updatedData = [];\n    this.multiData = [];\n    this.isMultiSelect = false;\n    this.parent.selectedElements = [];\n  }\n\n  updateNavigatingPosition(e) {\n    if (this.actionObj.navigation.enable) {\n      let currentDate = this.parent.getCurrentTime();\n\n      if (isNullOrUndefined(this.actionObj.navigationInterval)) {\n        this.actionObj.navigationInterval = window.setInterval(() => {\n          if (currentDate) {\n            const crtDate = this.parent.getCurrentTime();\n            const end = crtDate.getSeconds();\n            let start = currentDate.getSeconds() + this.actionObj.navigation.timeDelay / 1000;\n            start = start >= 60 ? start - 60 : start;\n\n            if (start === end) {\n              currentDate = this.parent.getCurrentTime();\n              this.viewNavigation(e);\n              this.updateDraggingDateTime(e);\n            }\n          }\n        }, this.actionObj.navigation.timeDelay);\n      }\n    }\n  }\n\n  updateDraggingDateTime(e) {\n    if (!isNullOrUndefined(this.actionObj.clone.offsetParent) && this.actionObj.clone.offsetParent.classList.contains(MORE_EVENT_POPUP_CLASS)) {\n      this.morePopupEventDragging(e);\n    } else if (this.parent.activeView.isTimelineView() && this.parent.currentView !== 'TimelineYear') {\n      this.timelineEventModule.dateRender = this.parent.activeView.renderDates;\n      this.timelineEventModule.cellWidth = this.actionObj.cellWidth;\n      this.timelineEventModule.getSlotDates();\n      this.actionObj.cellWidth = this.isHeaderRows ? this.timelineEventModule.cellWidth : this.actionObj.cellWidth;\n      this.calculateTimelineTime(e);\n    } else {\n      if (this.parent.currentView === 'Month' || this.parent.currentView === 'TimelineYear') {\n        this.calculateVerticalDate(e);\n      } else {\n        this.calculateVerticalTime(e);\n      }\n    }\n  }\n\n  navigationWrapper() {\n    if (!this.parent.activeView.isTimelineView()) {\n      if (this.parent.currentView === 'Month' || !this.parent.timeScale.enable) {\n        const outerWrapperCls = [].slice.call(this.parent.element.querySelectorAll('.' + WORK_CELLS_CLASS));\n        this.actionObj.index = this.parent.activeView.renderDates.length < this.actionObj.index ? this.parent.activeView.renderDates.length - 1 : this.actionObj.index;\n        let targetWrapper = outerWrapperCls[this.actionObj.index].querySelector('.' + APPOINTMENT_WRAPPER_CLASS);\n\n        if (!targetWrapper) {\n          targetWrapper = createElement('div', {\n            className: APPOINTMENT_WRAPPER_CLASS\n          });\n          outerWrapperCls[this.actionObj.index].appendChild(targetWrapper);\n        }\n\n        targetWrapper.appendChild(this.actionObj.clone);\n      } else {\n        const wrapperClass = this.actionObj.clone.classList.contains(ALLDAY_APPOINTMENT_CLASS) ? '.' + ALLDAY_APPOINTMENT_WRAPPER_CLASS : '.' + APPOINTMENT_WRAPPER_CLASS;\n        this.parent.element.querySelectorAll(wrapperClass).item(this.actionObj.index).appendChild(this.actionObj.clone);\n\n        if (wrapperClass === '.' + ALLDAY_APPOINTMENT_WRAPPER_CLASS) {\n          const elementHeight = this.getAllDayEventHeight();\n          const event = [].slice.call(this.parent.element.querySelectorAll('.' + ALLDAY_CELLS_CLASS + ':first-child'));\n\n          if (event[0].offsetHeight < elementHeight) {\n            for (const e of event) {\n              e.style.height = (elementHeight + 2) / 12 + 'em';\n            }\n          }\n\n          this.actionObj.clone.style.height = formatUnit(elementHeight);\n        }\n\n        this.actionObj.height = parseInt(this.actionObj.clone.style.height, 10);\n      }\n    } else {\n      let outWrapper;\n\n      if (this.parent.activeViewOptions.group.resources.length > 0) {\n        outWrapper = this.parent.element.querySelectorAll('.e-appointment-container:not(.e-hidden)').item(this.actionObj.index);\n      } else {\n        outWrapper = this.parent.element.querySelector('.' + APPOINTMENT_CONTAINER_CLASS);\n      }\n\n      if (!isNullOrUndefined(outWrapper)) {\n        let tarWrapper = outWrapper.querySelector('.' + APPOINTMENT_WRAPPER_CLASS);\n\n        if (!tarWrapper) {\n          tarWrapper = createElement('div', {\n            className: APPOINTMENT_WRAPPER_CLASS\n          });\n          outWrapper.appendChild(tarWrapper);\n        }\n\n        this.actionObj.cloneElement.forEach(ele => {\n          tarWrapper.appendChild(ele);\n        });\n      }\n    }\n  } // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  viewNavigation(e) {\n    let navigationType;\n    const dragArea = this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS);\n\n    if (dragArea && (!this.scrollEdges.top && !this.scrollEdges.bottom || closest(this.actionObj.clone, '.' + ALLDAY_APPOINTMENT_WRAPPER_CLASS))) {\n      if (dragArea.scrollLeft === 0 && Math.round(this.actionObj.X) <= Math.round(dragArea.getBoundingClientRect().left + this.actionObj.cellWidth + window.pageXOffset)) {\n        navigationType = this.parent.enableRtl ? 'next' : 'previous';\n      } else if (Math.round(dragArea.scrollLeft) + dragArea.clientWidth === dragArea.scrollWidth && Math.round(this.actionObj.X) >= Math.round(dragArea.getBoundingClientRect().right - this.actionObj.cellWidth + window.pageXOffset)) {\n        navigationType = this.parent.enableRtl ? 'previous' : 'next';\n      }\n\n      if (navigationType) {\n        this.parent.changeDate(this.parent.activeView.getNextPreviousDate(navigationType));\n      }\n    }\n  }\n\n  morePopupEventDragging(e) {\n    if (isNullOrUndefined(e.target) || e.target && isNullOrUndefined(closest(e.target, 'td'))) {\n      return;\n    }\n\n    const eventObj = extend({}, this.actionObj.event, null, true);\n    const eventDuration = eventObj[this.parent.eventFields.endTime].getTime() - eventObj[this.parent.eventFields.startTime].getTime();\n    const td = closest(e.target, 'td');\n\n    if (this.parent.currentView === 'TimelineYear' && !td.classList.contains('e-work-cells')) {\n      return;\n    }\n\n    const dragStart$$1 = this.parent.getDateFromElement(td);\n    const dragEnd = new Date(dragStart$$1.getTime());\n    dragEnd.setMilliseconds(eventDuration);\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      this.actionObj.groupIndex = parseInt(td.getAttribute('data-group-index'), 10);\n    }\n\n    this.actionObj.start = new Date(dragStart$$1.getTime());\n    this.actionObj.end = new Date(dragEnd.getTime());\n    this.actionObj.clone.style.top = formatUnit(td.offsetParent.offsetTop);\n    this.actionObj.clone.style.left = formatUnit(td.offsetLeft);\n    this.actionObj.clone.style.width = formatUnit(td.offsetWidth);\n    let eventContainer = td;\n    let eventWrapper;\n\n    if (this.parent.activeView.isTimelineView()) {\n      const rowIndex = closest(td, 'tr').rowIndex;\n      eventContainer = this.parent.element.querySelectorAll('.e-appointment-container').item(rowIndex);\n    }\n\n    eventWrapper = eventContainer.querySelector('.' + APPOINTMENT_WRAPPER_CLASS);\n\n    if (!eventWrapper) {\n      eventWrapper = createElement('div', {\n        className: APPOINTMENT_WRAPPER_CLASS\n      });\n      eventContainer.appendChild(eventWrapper);\n    }\n\n    this.appendCloneElement(eventWrapper);\n  }\n\n  calculateVerticalTime(e) {\n    if (isNullOrUndefined(this.actionObj.target) || this.actionObj.target && isNullOrUndefined(closest(this.actionObj.target, 'tr')) || !closest(this.actionObj.target, 'td').classList.contains(WORK_CELLS_CLASS) && !closest(this.actionObj.target, 'td').classList.contains(ALLDAY_CELLS_CLASS)) {\n      return;\n    }\n\n    if (this.parent.activeViewOptions.timeScale.enable) {\n      this.swapDragging(e);\n    }\n\n    const dragArea = this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS);\n    const eventObj = extend({}, this.actionObj.event, null, true);\n    const eventStart = eventObj[this.parent.eventFields.startTime];\n    const eventEnd = eventObj[this.parent.eventFields.endTime];\n    const eventDuration = getUniversalTime(eventEnd) - getUniversalTime(eventStart);\n    let offsetTop = Math.floor(parseInt(this.actionObj.clone.style.top, 10) / this.actionObj.cellHeight) * this.actionObj.cellHeight;\n    offsetTop = offsetTop < 0 ? 0 : offsetTop;\n\n    if (this.scrollEdges.top || this.scrollEdges.bottom) {\n      offsetTop = this.scrollEdges.top ? dragArea.scrollTop - this.heightUptoCursorPoint + this.actionObj.cellHeight + window.pageYOffset : dragArea.scrollTop + dragArea.offsetHeight - this.actionObj.clone.offsetHeight + window.pageYOffset + (this.actionObj.clone.offsetHeight - this.heightUptoCursorPoint);\n      offsetTop = Math.round(offsetTop / this.actionObj.cellHeight) * this.actionObj.cellHeight;\n      this.actionObj.clone.style.top = formatUnit(offsetTop);\n    }\n\n    const rowIndex = this.parent.activeViewOptions.timeScale.enable ? offsetTop / this.actionObj.cellHeight : 0;\n    const heightPerMinute = this.actionObj.cellHeight / this.actionObj.slotInterval;\n    const diffInMinutes = parseInt(this.actionObj.clone.style.top, 10) - offsetTop;\n    let tr;\n\n    if (this.isAllDayDrag) {\n      tr = this.parent.element.querySelector('.' + ALLDAY_ROW_CLASS);\n    } else {\n      const trCollections = [].slice.call(this.parent.getContentTable().querySelectorAll('tr'));\n      tr = trCollections[rowIndex];\n    }\n\n    let index;\n\n    if (closest(this.actionObj.target, 'td').classList.contains(WORK_CELLS_CLASS) || closest(this.actionObj.target, 'td').classList.contains(ALLDAY_CELLS_CLASS)) {\n      index = closest(this.actionObj.target, 'td').cellIndex;\n    }\n\n    const colIndex = isNullOrUndefined(index) ? closest(this.actionObj.clone, 'td').cellIndex : index;\n    this.actionObj.index = colIndex;\n\n    if (isNullOrUndefined(tr)) {\n      return;\n    }\n\n    const td = tr.children[colIndex];\n\n    if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n      this.actionObj.groupIndex = parseInt(td.getAttribute('data-group-index'), 10);\n    }\n\n    let dragStart$$1;\n    let dragEnd;\n\n    if (this.parent.activeViewOptions.timeScale.enable && !this.isAllDayDrag) {\n      this.appendCloneElement(this.getEventWrapper(colIndex));\n      dragStart$$1 = this.parent.getDateFromElement(td);\n      dragStart$$1.setMinutes(dragStart$$1.getMinutes() + diffInMinutes / heightPerMinute);\n      dragEnd = new Date(dragStart$$1.getTime());\n\n      if (this.actionObj.element.classList.contains(ALLDAY_APPOINTMENT_CLASS)) {\n        dragEnd.setMinutes(dragEnd.getMinutes() + this.actionObj.slotInterval);\n      } else {\n        dragEnd.setMilliseconds(eventDuration);\n      }\n    } else {\n      dragStart$$1 = this.parent.getDateFromElement(td);\n      dragStart$$1.setDate(dragStart$$1.getDate() - this.daysVariation);\n      dragStart$$1.setHours(eventStart.getHours(), eventStart.getMinutes(), eventStart.getSeconds());\n      dragEnd = new Date(dragStart$$1.getTime());\n      dragEnd.setMilliseconds(eventDuration);\n\n      if (!this.actionObj.element.classList.contains(ALLDAY_APPOINTMENT_CLASS) && this.actionObj.clone.classList.contains(ALLDAY_APPOINTMENT_CLASS)) {\n        dragEnd = addDays(resetTime(dragEnd), 1);\n      }\n\n      this.updateAllDayEvents(dragStart$$1, dragEnd, this.parent.activeViewOptions.group.byDate ? colIndex : undefined);\n    }\n\n    this.actionObj.start = new Date(+dragStart$$1);\n    this.actionObj.end = new Date(+dragEnd);\n    const event = this.getUpdatedEvent(this.actionObj.start, this.actionObj.end, this.actionObj.event);\n    const dynamicWrappers = [].slice.call(this.parent.element.querySelectorAll('.e-dynamic-clone'));\n\n    for (const wrapper of dynamicWrappers) {\n      remove(wrapper);\n    }\n\n    if (this.multiData.length > 0) {\n      if (this.isAllDayTarget && this.isAllDayDrag && !isNullOrUndefined(this.actionObj.isAllDay) && !this.actionObj.isAllDay) {\n        const targetCellTime = parseInt(closest(this.actionObj.target, 'td').getAttribute('data-date'), 10);\n        this.multiData.forEach(data => {\n          this.swagData.push(extend({}, data, null, true));\n\n          if (data[this.parent.eventFields.isAllDay]) {\n            data[this.parent.eventFields.startTime] = new Date(data[this.parent.eventFields.startTime].getTime() + (targetCellTime - this.startTime));\n            const startTime = new Date(data[this.parent.eventFields.startTime]);\n            const endTime = new Date(startTime.setMinutes(startTime.getMinutes() + this.actionObj.slotInterval));\n            data[this.parent.eventFields.endTime] = endTime;\n            data[this.parent.eventFields.isAllDay] = false;\n          }\n        });\n        this.startTime = targetCellTime;\n      }\n\n      if (this.isAllDayTarget && this.isAllDayDrag && !isNullOrUndefined(this.actionObj.isAllDay) && this.actionObj.isAllDay && this.swagData.length > 0) {\n        this.multiData = this.swagData;\n        this.swagData = [];\n        const eventObj = extend({}, this.actionObj.event, null, true);\n        this.startTime = eventObj[this.parent.eventFields.startTime].getTime();\n      }\n\n      const startTimeDiff = event[this.parent.eventFields.startTime].getTime() - this.startTime;\n\n      for (let index = 0; index < this.multiData.length; index++) {\n        this.updatedData[index] = this.updateMultipleData(this.multiData[index], startTimeDiff);\n        const dayIndex = this.getDayIndex(this.updatedData[index]);\n\n        if (dayIndex >= 0) {\n          const wrapper = this.getEventWrapper(dayIndex, this.updatedData[index][this.parent.eventFields.isAllDay]);\n          this.appendCloneElement(wrapper, this.actionObj.cloneElement[index]);\n          this.updateEventHeight(this.updatedData[index], index, dayIndex);\n        } else {\n          if (!isNullOrUndefined(this.actionObj.cloneElement[index].parentNode)) {\n            remove(this.actionObj.cloneElement[index]);\n          }\n        }\n      }\n    } else {\n      this.updateEventHeight(event);\n    }\n\n    this.updateTimePosition(this.actionObj.start, this.updatedData);\n  }\n\n  splitEvent(event) {\n    const eventFields = this.parent.eventFields;\n    const eventData = [];\n    const startTime = event[eventFields.startTime];\n    const endTime = event[eventFields.endTime];\n\n    if (resetTime(new Date(startTime.getTime())) < resetTime(new Date(endTime.getTime()))) {\n      let startReferenceDate = resetTime(new Date(startTime.getTime()));\n      let endReferenceDate = new Date(startReferenceDate.getTime());\n\n      for (let i = 0; startReferenceDate < new Date(endTime.getTime()); i++) {\n        endReferenceDate = new Date(endReferenceDate.setDate(startReferenceDate.getDate() + 1));\n        const eventObj = extend({}, event, null, true);\n        eventObj[eventFields.startTime] = new Date(startReferenceDate);\n        eventObj[eventFields.endTime] = new Date(endReferenceDate);\n        startReferenceDate = new Date(startReferenceDate.setDate(startReferenceDate.getDate() + 1));\n        eventData.push(eventObj);\n      }\n\n      const index = eventData.length - 1;\n      eventData[0][eventFields.startTime] = startTime;\n      eventData[index][eventFields.endTime] = endTime;\n    } else {\n      eventData.push(event);\n    }\n\n    return eventData;\n  }\n\n  updateMultipleData(data, timeDifference) {\n    const eventObj = extend({}, data, null, true);\n\n    if (!isNullOrUndefined(this.actionObj.isAllDay) && this.parent.activeViewOptions.timeScale.enable && (this.isAllDayTarget && eventObj[this.parent.eventFields.isAllDay] || !this.isAllDayTarget && !eventObj[this.parent.eventFields.isAllDay])) {\n      eventObj[this.parent.eventFields.isAllDay] = this.actionObj.isAllDay;\n    }\n\n    const endTimeDiff = eventObj[this.parent.eventFields.endTime].getTime() - eventObj[this.parent.eventFields.startTime].getTime();\n\n    if (eventObj[this.parent.eventFields.isAllDay]) {\n      const differInDays = Math.ceil(timeDifference / (1000 * 3600 * 24));\n      const day = Math.ceil(endTimeDiff / (1000 * 3600 * 24));\n      const startTime = new Date(eventObj[this.parent.eventFields.startTime]);\n      eventObj[this.parent.eventFields.startTime] = resetTime(new Date(startTime.setDate(startTime.getDate() + differInDays)));\n      eventObj[this.parent.eventFields.endTime] = addDays(eventObj[this.parent.eventFields.startTime], day);\n    } else {\n      eventObj[this.parent.eventFields.startTime] = new Date(eventObj[this.parent.eventFields.startTime].getTime() + timeDifference);\n      eventObj[this.parent.eventFields.endTime] = new Date(eventObj[this.parent.eventFields.startTime].getTime() + endTimeDiff);\n    }\n\n    return eventObj;\n  }\n\n  getDayIndex(event) {\n    const eventObj = extend({}, event, null, true);\n    const startTime = resetTime(eventObj[this.parent.eventFields.startTime]).getTime();\n    let query = '';\n    let wrapper = DAY_WRAPPER_CLASS;\n\n    if (this.parent.activeViewOptions.timeScale.enable && eventObj[this.parent.eventFields.isAllDay]) {\n      wrapper = ALLDAY_APPOINTMENT_WRAPPER_CLASS;\n    } else {\n      wrapper = WORK_CELLS_CLASS;\n    }\n\n    query = '.' + wrapper + '[data-date=\"' + startTime + '\"]';\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      query = query + '[data-group-index=\"' + this.actionObj.groupIndex + '\"]';\n    }\n\n    this.targetTd = this.parent.element.querySelector(query);\n\n    if (isNullOrUndefined(this.targetTd)) {\n      return -1;\n    }\n\n    return this.targetTd.cellIndex;\n  }\n\n  updateEventHeight(event, index, colIndex) {\n    this.verticalEvent.initializeValues();\n    let datesCount = 0;\n\n    if (!this.parent.uiStateValues.isGroupAdaptive) {\n      for (let i = 0; i < this.actionObj.groupIndex; i++) {\n        datesCount = datesCount + this.verticalEvent.dateRender[i].length;\n      }\n    }\n\n    const indexGroup = this.parent.uiStateValues.isGroupAdaptive ? datesCount : this.actionObj.groupIndex;\n    const target = this.parent.activeViewOptions.group.byDate && !isNullOrUndefined(this.parent.getDateFromElement(this.actionObj.target)) ? true : false;\n\n    if (target || !this.parent.activeViewOptions.group.byDate) {\n      let dynamicIndex = -1;\n      let dayIndex = !this.parent.activeViewOptions.group.byDate ? isNullOrUndefined(index) ? this.actionObj.index - datesCount : colIndex - datesCount : this.parent.getIndexOfDate(this.verticalEvent.dateRender[indexGroup], resetTime( // eslint-disable-next-line max-len\n      this.parent.getDateFromElement(isNullOrUndefined(index) ? this.actionObj.target : this.targetTd)));\n      const splitEvents = this.splitEvent(event);\n      const events = this.parent.eventBase.isAllDayAppointment(event) || splitEvents.length > 2 || this.parent.eventSettings.spannedEventPlacement !== 'TimeSlot' ? [event] : splitEvents;\n\n      for (let i = 0; i < events.length; i++) {\n        if (i > 0) {\n          let filterQuery = `.e-day-wrapper[data-date=\"${resetTime(events[i][this.parent.eventFields.startTime]).getTime()}\"]`;\n\n          if (this.parent.activeViewOptions.group.resources.length > 0) {\n            filterQuery = filterQuery.concat('[data-group-index = \"' + this.actionObj.groupIndex + '\"]');\n          }\n\n          const appWrap = this.parent.element.querySelector(filterQuery);\n\n          if (appWrap) {\n            dayIndex = dayIndex + 1;\n            dynamicIndex = appWrap.cellIndex;\n          } else {\n            dayIndex = -1;\n          }\n        }\n\n        if (dayIndex >= 0) {\n          const record = this.verticalEvent.isSpannedEvent(events[i], dayIndex, indexGroup);\n          const eStart = record[this.verticalEvent.fields.startTime];\n          const eEnd = record[this.verticalEvent.fields.endTime];\n          let appHeight = this.parent.activeViewOptions.timeScale.enable ? this.verticalEvent.getHeight(eStart, eEnd) : this.actionObj.element.offsetHeight;\n          let topValue = this.parent.activeViewOptions.timeScale.enable ? this.verticalEvent.getTopValue(eStart, dayIndex, indexGroup) : this.actionObj.element.offsetTop;\n\n          if (isNullOrUndefined(index)) {\n            if (i === 0) {\n              this.actionObj.clone.style.top = formatUnit(topValue);\n              this.actionObj.clone.style.height = formatUnit(appHeight);\n            } else {\n              this.renderSpannedEvents(record, dynamicIndex, topValue, appHeight);\n            }\n          } else {\n            let appWidth = this.actionObj.cellWidth;\n\n            if (event[this.parent.eventFields.isAllDay]) {\n              topValue = this.parent.element.querySelector('.' + ALLDAY_ROW_CLASS).offsetTop;\n              appHeight = this.getAllDayEventHeight();\n              const timeDiff = event[this.parent.eventFields.endTime].getTime() - event[this.parent.eventFields.startTime].getTime();\n              const allDayDifference = Math.ceil(timeDiff / (1000 * 3600 * 24));\n\n              if (allDayDifference >= 0) {\n                appWidth = allDayDifference * this.actionObj.cellWidth;\n              }\n            }\n\n            if (this.actionObj.cloneElement[index]) {\n              if (i === 0) {\n                this.actionObj.cloneElement[index].style.top = formatUnit(topValue);\n                this.actionObj.cloneElement[index].style.height = formatUnit(appHeight);\n                this.actionObj.cloneElement[index].style.width = formatUnit(appWidth);\n                this.actionObj.cloneElement[index].style.left = formatUnit(0);\n              } else {\n                this.renderSpannedEvents(record, dynamicIndex, topValue, appHeight);\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n\n  renderSpannedEvents(record, index, top, height) {\n    const startTime = record[this.parent.eventFields.startTime].getTime();\n    const endTime = record[this.parent.eventFields.endTime].getTime();\n\n    if (startTime !== endTime) {\n      const appointmentElement = this.verticalEvent.createAppointmentElement(record, false, record.isSpanned, this.actionObj.groupIndex);\n      addClass([appointmentElement], [CLONE_ELEMENT_CLASS, 'e-dynamic-clone']);\n      setStyleAttribute(appointmentElement, {\n        'width': '100%',\n        'height': height + 'px',\n        'top': top + 'px',\n        'border': '0px'\n      });\n      const appointmentWrap = [].slice.call(this.parent.element.querySelectorAll('.' + APPOINTMENT_WRAPPER_CLASS));\n      appointmentWrap[index].appendChild(appointmentElement);\n    }\n  }\n\n  getRenderedDates() {\n    let renderDates = this.parent.activeView.renderDates;\n    this.parent.eventBase.slots.push(...this.parent.activeView.renderDates.map(date => +date));\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      this.parent.eventBase.slots = [];\n      const resources = this.parent.resourceBase.lastResourceLevel.filter(res => res.groupIndex === this.actionObj.groupIndex);\n      renderDates = resources[0].renderDates;\n      this.parent.eventBase.slots.push(...renderDates.map(date => +date));\n    }\n\n    return renderDates;\n  }\n\n  updateAllDayEvents(startDate, endDate, colIndex) {\n    this.parent.eventBase.slots = [];\n    const event = this.getUpdatedEvent(startDate, endDate, this.actionObj.event);\n    const renderDates = this.getRenderedDates();\n    const events = this.parent.eventBase.splitEvent(event, renderDates);\n    let query = `.e-all-day-cells[data-date=\"${events[0][this.parent.eventFields.startTime].getTime()}\"]`;\n\n    if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n      query = query.concat('[data-group-index = \"' + this.actionObj.groupIndex + '\"]');\n    }\n\n    const cell = [].slice.call(this.parent.element.querySelectorAll(query));\n\n    if (cell.length > 0 || !isNullOrUndefined(colIndex)) {\n      const cellIndex = !isNullOrUndefined(colIndex) ? colIndex : cell[0].cellIndex;\n      this.appendCloneElement(this.getEventWrapper(cellIndex)); // eslint-disable-next-line max-len\n\n      this.actionObj.clone.style.width = formatUnit(events[0].data.count * this.actionObj.cellWidth);\n    }\n  } // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  swapDragging(e) {\n    const colIndex = closest(this.actionObj.target, 'td').cellIndex;\n\n    if (closest(this.actionObj.target, '.' + DATE_HEADER_WRAP_CLASS) && !closest(this.actionObj.clone, '.' + ALLDAY_APPOINTMENT_WRAPPER_CLASS)) {\n      addClass([this.actionObj.clone], ALLDAY_APPOINTMENT_CLASS);\n      this.appendCloneElement(this.getEventWrapper(colIndex));\n      this.actionObj.isAllDay = true;\n      const eventHeight = this.getAllDayEventHeight();\n      const allDayElement = [].slice.call(this.parent.element.querySelectorAll('.' + ALLDAY_CELLS_CLASS + ':first-child'));\n\n      if (allDayElement[0].offsetHeight < eventHeight) {\n        for (const element of allDayElement) {\n          element.style.height = (eventHeight + 2) / 12 + 'em';\n        }\n      }\n\n      setStyleAttribute(this.actionObj.clone, {\n        width: formatUnit(this.actionObj.cellWidth),\n        height: formatUnit(eventHeight),\n        top: formatUnit(this.parent.element.querySelector('.' + ALLDAY_ROW_CLASS).offsetTop)\n      });\n    }\n\n    if (closest(this.actionObj.target, '.' + WORK_CELLS_CLASS) && !closest(this.actionObj.clone, '.' + DAY_WRAPPER_CLASS)) {\n      removeClass([this.actionObj.clone], ALLDAY_APPOINTMENT_CLASS);\n      this.appendCloneElement(this.getEventWrapper(colIndex));\n      this.actionObj.isAllDay = false; // eslint-disable-next-line max-len\n\n      const height = this.actionObj.element.offsetHeight === 0 ? this.actionObj.height : this.actionObj.element.offsetHeight;\n      setStyleAttribute(this.actionObj.clone, {\n        left: formatUnit(0),\n        height: formatUnit(height),\n        width: formatUnit(this.actionObj.cellWidth)\n      });\n    }\n  }\n\n  calculateVerticalDate(e) {\n    if (isNullOrUndefined(e.target) || e.target && isNullOrUndefined(closest(e.target, 'tr')) || e.target && e.target.tagName === 'DIV') {\n      return;\n    }\n\n    const eventObj = extend({}, this.actionObj.event, null, true);\n\n    if (isNullOrUndefined(this.parent.eventDragArea)) {\n      this.removeCloneElement();\n    }\n\n    const eventDuration = getUniversalTime(eventObj[this.parent.eventFields.endTime]) - getUniversalTime(eventObj[this.parent.eventFields.startTime]);\n    let td = closest(this.actionObj.target, 'td');\n\n    if (!isNullOrUndefined(td)) {\n      const tr = td.parentElement;\n      this.actionObj.index = tr.rowIndex * tr.children.length + td.cellIndex;\n      const workCells = [].slice.call(this.parent.element.querySelectorAll('.' + WORK_CELLS_CLASS));\n      td = workCells[this.actionObj.index];\n      const currentDate = this.parent.getDateFromElement(td);\n\n      if (!isNullOrUndefined(currentDate)) {\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n          this.actionObj.groupIndex = parseInt(td.getAttribute('data-group-index'), 10);\n        }\n\n        const timeString = new Date(currentDate.setDate(currentDate.getDate() - this.daysVariation));\n        const dragStart$$1 = new Date(timeString.getTime());\n        const startTimeDiff = getUniversalTime(eventObj[this.parent.eventFields.startTime]) - getUniversalTime(resetTime(new Date(+eventObj[this.parent.eventFields.startTime])));\n        dragStart$$1.setMilliseconds(startTimeDiff);\n        const dragEnd = new Date(dragStart$$1.getTime());\n        dragEnd.setMilliseconds(eventDuration);\n        this.actionObj.start = new Date(dragStart$$1.getTime());\n        this.actionObj.end = new Date(dragEnd.getTime());\n      }\n    }\n\n    const event = this.getUpdatedEvent(this.actionObj.start, this.actionObj.end, this.actionObj.event);\n    const eventWrappers = [].slice.call(this.parent.element.querySelectorAll('.' + CLONE_ELEMENT_CLASS));\n\n    for (const wrapper of eventWrappers) {\n      remove(wrapper);\n    }\n\n    if (this.multiData && this.multiData.length > 0) {\n      const startTime = resetTime(new Date(event[this.parent.eventFields.startTime]));\n      let startTimeDiff = startTime.getTime() - this.startTime;\n\n      if (this.parent.currentView === 'TimelineYear' && this.parent.group.resources.length > 0) {\n        startTimeDiff = (startTime.getFullYear() - new Date(this.startTime).getFullYear()) * 12;\n        startTimeDiff -= new Date(this.startTime).getMonth();\n        startTimeDiff += startTime.getMonth();\n      }\n\n      for (let index = 0; index < this.multiData.length; index++) {\n        this.updatedData[index] = this.updateMultipleVerticalDate(this.multiData[index], startTimeDiff);\n\n        if (this.parent.currentView === 'TimelineYear') {\n          this.dynamicYearlyEventsRendering(this.updatedData[index]);\n        } else {\n          this.dynamicEventsRendering(this.updatedData[index]);\n        }\n      }\n    } else {\n      if (this.parent.currentView === 'TimelineYear') {\n        this.dynamicYearlyEventsRendering(event);\n      } else {\n        this.dynamicEventsRendering(event);\n      }\n    }\n  }\n\n  updateMultipleVerticalDate(data, timeDifference) {\n    const eventObj = extend({}, data, null, true);\n    const eventDuration = eventObj[this.parent.eventFields.endTime].getTime() - eventObj[this.parent.eventFields.startTime].getTime();\n    const startDate = new Date(eventObj[this.parent.eventFields.startTime]);\n\n    if (this.parent.currentView === 'TimelineYear' && this.parent.group.resources.length > 0) {\n      eventObj[this.parent.eventFields.startTime] = new Date(startDate.setMonth(startDate.getMonth() + timeDifference));\n    } else {\n      const differInDays = Math.ceil(timeDifference / MS_PER_DAY);\n      eventObj[this.parent.eventFields.startTime] = new Date(startDate.setDate(startDate.getDate() + differInDays));\n    }\n\n    eventObj[this.parent.eventFields.endTime] = new Date(eventObj[this.parent.eventFields.startTime].getTime() + eventDuration);\n    return eventObj;\n  }\n\n  calculateTimelineTime(e) {\n    const eventObj = extend({}, this.actionObj.event, null, true);\n    const eventDuration = getUniversalTime(eventObj[this.parent.eventFields.endTime]) - getUniversalTime(eventObj[this.parent.eventFields.startTime]);\n    let offsetLeft = this.parent.enableRtl ? Math.abs(this.actionObj.clone.offsetLeft) - this.actionObj.clone.offsetWidth : parseInt(this.actionObj.clone.style.left, 10);\n    offsetLeft = Math.floor(offsetLeft / this.actionObj.cellWidth) * this.actionObj.cellWidth;\n    let rightOffset;\n\n    if (this.parent.enableRtl) {\n      rightOffset = Math.abs(parseInt(this.actionObj.clone.style.right, 10));\n      this.actionObj.clone.style.right = formatUnit(rightOffset);\n    }\n\n    offsetLeft = this.getOffsetValue(offsetLeft, rightOffset);\n    const colIndex = this.getColumnIndex(offsetLeft);\n    const dragArea = this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS);\n    const contentWrapRight = dragArea.getBoundingClientRect().right;\n    const cursorDrag = this.parent.activeView.isTimelineView() && !this.parent.enableRtl && this.actionObj.pageX > this.actionObj.clone.getBoundingClientRect().right && !this.isMorePopupOpened && !(this.actionObj.pageX > contentWrapRight);\n    const leftVal = this.parent.eventDragArea ? dragArea.scrollLeft - dragArea.offsetLeft : 0;\n\n    if ((this.isCursorAhead || cursorDrag) && !this.isStepDragging) {\n      this.isCursorAhead = true;\n    }\n\n    let cloneIndex = Math.floor((this.actionObj.pageX - this.actionObj.clone.getBoundingClientRect().left + leftVal) / this.actionObj.cellWidth);\n\n    if (this.parent.enableRtl) {\n      cloneIndex = Math.abs(Math.floor((this.actionObj.pageX - this.actionObj.clone.getBoundingClientRect().right) / this.actionObj.cellWidth)) - 1;\n    }\n\n    if (this.cursorPointIndex < 0) {\n      this.cursorIndex(e, eventObj, offsetLeft, cloneIndex);\n    }\n\n    const tr = this.parent.getContentTable().querySelector('tr');\n    let index = this.getCursorCurrentIndex(colIndex, cloneIndex, tr);\n    index = index < 0 ? 0 : index;\n    let eventStart = this.isHeaderRows ? new Date(this.timelineEventModule.dateRender[index].getTime()) : this.parent.getDateFromElement(tr.children[index]);\n\n    if (this.isStepDragging) {\n      const widthDiff = this.getWidthDiff(tr, index);\n\n      if (widthDiff !== 0) {\n        const timeDiff = Math.round(widthDiff / this.widthPerMinute);\n        eventStart.setMinutes(eventStart.getMinutes() + timeDiff * this.actionObj.interval);\n\n        if (this.isCursorAhead || cursorDrag) {\n          eventStart.setMilliseconds(-eventDuration);\n        } else {\n          eventStart.setMinutes(eventStart.getMinutes() - this.minDiff);\n        }\n      } else {\n        eventStart = this.actionObj.start;\n      }\n    } else {\n      if (this.isCursorAhead || cursorDrag) {\n        eventStart.setMinutes(eventStart.getMinutes() + (this.isTimelineDayProcess ? MINUTES_PER_DAY : this.actionObj.slotInterval));\n        eventStart.setMilliseconds(-eventDuration);\n      } else {\n        eventStart.setMinutes(eventStart.getMinutes() - this.cursorPointIndex * (this.isTimelineDayProcess ? MINUTES_PER_DAY : this.actionObj.slotInterval));\n      }\n    }\n\n    eventStart = this.calculateIntervalTime(eventStart);\n\n    if (this.isTimelineDayProcess) {\n      const eventSrt = eventObj[this.parent.eventFields.startTime];\n      eventStart.setHours(eventSrt.getHours(), eventSrt.getMinutes(), eventSrt.getSeconds());\n    }\n\n    if (this.parent.eventDragArea) {\n      const targetDate = this.parent.getDateFromElement(e.target);\n\n      if (!isNullOrUndefined(targetDate)) {\n        if (!this.parent.activeViewOptions.timeScale.enable || this.parent.currentView === 'TimelineMonth') {\n          const eventSrt = eventObj[this.parent.eventFields.startTime];\n          eventStart = new Date(targetDate.setHours(eventSrt.getHours(), eventSrt.getMinutes(), eventSrt.getSeconds()));\n        } else {\n          eventStart = targetDate;\n        }\n      }\n    }\n\n    const eventEnd = new Date(eventStart.getTime());\n    eventEnd.setMilliseconds(eventDuration);\n    let eventsData = [this.getUpdatedEvent(eventStart, eventEnd, this.actionObj.event)];\n\n    if (this.multiData.length > 0) {\n      const startTimeDiff = eventsData[0][this.parent.eventFields.startTime].getTime() - this.startTime;\n\n      for (let i = 0; i < this.multiData.length; i++) {\n        this.updatedData[i] = this.updateMultipleData(this.multiData[i], startTimeDiff);\n      }\n\n      eventsData = this.updatedData;\n    }\n\n    for (let dataIndex = 0; dataIndex < eventsData.length; dataIndex++) {\n      const events = this.timelineEventModule.splitEvent(eventsData[dataIndex], this.timelineEventModule.dateRender);\n      const eventData = events[0].data;\n      const startTime = this.timelineEventModule.getStartTime(events[0], eventData);\n      const endTime = this.timelineEventModule.getEndTime(events[0], eventData); // eslint-disable-next-line max-len\n\n      const width = this.timelineEventModule.getEventWidth(startTime, endTime, eventObj[this.parent.eventFields.isAllDay], eventData.count); // eslint-disable-next-line max-len\n\n      let day = this.parent.getIndexOfDate(this.timelineEventModule.dateRender, resetTime(new Date(startTime.getTime())));\n      day = day < 0 ? 0 : day;\n      const left = this.timelineEventModule.getPosition(startTime, endTime, eventObj[this.parent.eventFields.isAllDay], day);\n      const cloneElement = this.multiData.length > 0 ? this.actionObj.cloneElement[dataIndex] : this.actionObj.clone;\n\n      if (this.parent.enableRtl) {\n        cloneElement.style.right = formatUnit(left);\n      } else {\n        cloneElement.style.left = formatUnit(left);\n      }\n\n      if (!this.isMorePopupOpened) {\n        cloneElement.style.width = formatUnit(width);\n      }\n\n      if (this.parent.activeViewOptions.group.resources.length > 0) {\n        this.calculateResourceGroupingPosition(e, cloneElement);\n      }\n\n      this.actionObj.start = new Date(eventStart.getTime());\n      this.actionObj.end = new Date(eventEnd.getTime());\n      this.updateTimePosition(this.actionObj.start, this.updatedData);\n    }\n  }\n\n  getOffsetValue(offsetLeft, rightOffset) {\n    if (this.scrollEdges.left || this.scrollEdges.right) {\n      const viewEle = this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS);\n\n      if (this.parent.enableRtl) {\n        rightOffset = viewEle.offsetWidth - viewEle.scrollLeft;\n\n        if (this.scrollEdges.right) {\n          rightOffset = rightOffset - viewEle.offsetWidth + this.actionObj.clone.offsetWidth - (this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint);\n        } else {\n          rightOffset = rightOffset + this.widthUptoCursorPoint;\n\n          if (rightOffset - this.widthUptoCursorPoint >= viewEle.scrollWidth) {\n            this.actionObj.clone.style.width = formatUnit(this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint + this.actionObj.cellWidth);\n            rightOffset = viewEle.scrollLeft - viewEle.scrollWidth;\n          }\n        }\n\n        this.actionObj.clone.style.left = formatUnit(rightOffset);\n      } else {\n        if (this.scrollEdges.left) {\n          offsetLeft = viewEle.scrollLeft - this.widthUptoCursorPoint + this.actionObj.cellWidth;\n\n          if (viewEle.scrollLeft + viewEle.offsetWidth >= viewEle.offsetWidth) {\n            viewEle.scrollLeft = viewEle.scrollLeft - 1;\n          } else if (this.actionObj.clone.offsetLeft === 0) {\n            offsetLeft = viewEle.scrollLeft;\n          }\n        } else {\n          offsetLeft = viewEle.scrollLeft + viewEle.offsetWidth - this.actionObj.clone.offsetWidth + (this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint);\n        }\n\n        offsetLeft = offsetLeft < 0 ? 0 : offsetLeft;\n        this.actionObj.clone.style.left = formatUnit(offsetLeft);\n      }\n    }\n\n    return offsetLeft;\n  }\n\n  getWidthDiff(tr, index) {\n    const pages = this.scrollArgs.element.getBoundingClientRect();\n\n    if (pages.left <= this.actionObj.pageX && pages.right >= this.actionObj.pageX) {\n      const targetLeft = tr.children[index].offsetLeft;\n      const pageX = this.actionObj.pageX - pages.left;\n\n      if (this.parent.enableRtl) {\n        return targetLeft + this.actionObj.cellWidth - (this.scrollArgs.element.scrollLeft + pageX);\n      } else {\n        return this.scrollArgs.element.scrollLeft + pageX - targetLeft;\n      }\n    }\n\n    return 0;\n  }\n\n  getColumnIndex(offsetLeft) {\n    const index = Math.floor(offsetLeft / this.actionObj.cellWidth);\n\n    if (this.isHeaderRows) {\n      return index;\n    }\n\n    return this.getIndex(index);\n  }\n\n  getCursorCurrentIndex(colIndex, cloneIndex, tr) {\n    const index = colIndex + cloneIndex;\n\n    if (this.isHeaderRows) {\n      const dateLength = Math.floor(tr.offsetWidth / this.actionObj.cellWidth);\n      return index > dateLength - 1 ? dateLength - 1 : index;\n    }\n\n    return index > tr.children.length - 1 ? tr.children.length - 1 : index;\n  }\n\n  cursorIndex(e, event, left, index) {\n    const td = closest(e.target, '.e-work-cells');\n\n    if (!isNullOrUndefined(td) && !this.isMorePopupOpened) {\n      let targetDate = this.parent.getDateFromElement(td);\n\n      if (this.isHeaderRows) {\n        const currentIndex = Math.floor(left / this.actionObj.cellWidth);\n        targetDate = new Date(this.timelineEventModule.dateRender[currentIndex + index].getTime());\n      }\n\n      const timeDiff = targetDate.getTime() - event[this.parent.eventFields.startTime].getTime();\n\n      if (this.isTimelineDayProcess) {\n        this.cursorPointIndex = Math.abs(Math.ceil(timeDiff / MS_PER_DAY));\n      } else {\n        const widthDiff = Math.floor(timeDiff / MS_PER_MINUTE / (this.actionObj.slotInterval / this.actionObj.cellWidth));\n        this.cursorPointIndex = Math.floor(widthDiff / this.actionObj.cellWidth);\n        this.cursorPointIndex = this.cursorPointIndex < 0 ? 0 : this.cursorPointIndex;\n      }\n    } else {\n      this.cursorPointIndex = 0;\n    }\n  }\n\n  calculateResourceGroupingPosition(e, cloneElement) {\n    const dragArea = this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS);\n    const trCollection = [].slice.call(this.parent.element.querySelectorAll('.e-content-wrap .e-content-table tr:not(.e-hidden)'));\n    let translateY = getTranslateY(dragArea.querySelector('table'));\n    translateY = isNullOrUndefined(translateY) ? 0 : translateY;\n    const rowHeight = this.parent.rowAutoHeight ? ~~(dragArea.querySelector('table').offsetHeight / trCollection.length) : this.actionObj.cellHeight;\n    let rowIndex = Math.floor(Math.floor(this.actionObj.Y + (dragArea.scrollTop - translateY - (window.scrollY || window.pageYOffset)) - dragArea.getBoundingClientRect().top) / rowHeight);\n    rowIndex = rowIndex < 0 ? 0 : rowIndex > trCollection.length - 1 ? trCollection.length - 1 : rowIndex;\n    this.actionObj.index = rowIndex;\n    const eventContainer = this.parent.element.querySelectorAll('.e-appointment-container:not(.e-hidden)').item(rowIndex);\n    let eventWrapper = eventContainer.querySelector('.' + APPOINTMENT_WRAPPER_CLASS);\n\n    if (!eventWrapper) {\n      eventWrapper = createElement('div', {\n        className: APPOINTMENT_WRAPPER_CLASS\n      });\n      eventContainer.appendChild(eventWrapper);\n    }\n\n    this.appendCloneElement(eventWrapper, cloneElement);\n    const td = closest(this.actionObj.target, 'td');\n    this.actionObj.groupIndex = td && !isNaN(parseInt(td.getAttribute('data-group-index'), 10)) ? parseInt(td.getAttribute('data-group-index'), 10) : this.actionObj.groupIndex;\n    let top = trCollection[rowIndex].getBoundingClientRect().height * rowIndex;\n\n    if (this.parent.rowAutoHeight) {\n      const cursorElement = this.getCursorElement(e);\n\n      if (cursorElement) {\n        top = cursorElement.classList.contains(WORK_CELLS_CLASS) ? cursorElement.offsetTop : cursorElement.offsetParent && cursorElement.offsetParent.classList.contains(APPOINTMENT_CLASS) ? cursorElement.offsetParent.offsetTop : top;\n      }\n    }\n\n    cloneElement.style.top = formatUnit(top);\n  }\n\n  appendCloneElement(element, cloneElement = null) {\n    cloneElement = isNullOrUndefined(cloneElement) ? this.actionObj.clone : cloneElement;\n    const dragElement = document.querySelector(this.parent.eventDragArea);\n\n    if (this.parent.eventDragArea && dragElement) {\n      dragElement.appendChild(cloneElement);\n    } else {\n      element.appendChild(cloneElement);\n    }\n  }\n\n  getEventWrapper(index, isAllDayDrag) {\n    let eventWrapper;\n\n    if (isNullOrUndefined(isAllDayDrag)) {\n      isAllDayDrag = this.actionObj.clone.classList.contains(ALLDAY_APPOINTMENT_CLASS);\n    }\n\n    if (this.parent.activeViewOptions.timeScale.enable) {\n      const wrapperClass = isAllDayDrag ? '.' + ALLDAY_APPOINTMENT_WRAPPER_CLASS : '.' + APPOINTMENT_WRAPPER_CLASS;\n      eventWrapper = this.parent.element.querySelectorAll(wrapperClass).item(index);\n    } else {\n      const targetWrapper = this.parent.element.querySelectorAll('.' + WORK_CELLS_CLASS).item(index);\n      eventWrapper = targetWrapper.querySelector('.' + APPOINTMENT_WRAPPER_CLASS);\n\n      if (!eventWrapper) {\n        eventWrapper = createElement('div', {\n          className: APPOINTMENT_WRAPPER_CLASS\n        });\n        targetWrapper.appendChild(eventWrapper);\n      }\n    }\n\n    return eventWrapper;\n  }\n\n  getAllDayEventHeight() {\n    const eventWrapper = createElement('div', {\n      className: APPOINTMENT_CLASS\n    });\n    this.parent.element.querySelector('.' + ALLDAY_APPOINTMENT_WRAPPER_CLASS).appendChild(eventWrapper);\n    const eventHeight = eventWrapper.offsetHeight;\n    remove(eventWrapper);\n    return eventHeight;\n  }\n\n  isAllowDrop(e) {\n    if (!this.actionObj.excludeSelectors) {\n      return false;\n    }\n\n    const dropSelectors = this.actionObj.excludeSelectors.split(',');\n    let isAllowDrop = false;\n\n    for (const selector of dropSelectors) {\n      if (e.target.classList.contains(selector)) {\n        isAllowDrop = true;\n        break;\n      }\n    }\n\n    return isAllowDrop;\n  }\n  /**\n   * Get module name.\n   *\n   * @returns {string} Returns the module name\n   */\n\n\n  getModuleName() {\n    return 'dragAndDrop';\n  }\n\n}\n/**\n * view base\n */\n\n\nclass ViewBase {\n  /**\n   * Constructor\n   *\n   * @param {Schedule} parent Accepts the schedule instance\n   */\n  constructor(parent) {\n    this.parent = parent;\n  }\n\n  isTimelineView() {\n    return this.parent.currentView.indexOf('Timeline') !== -1;\n  }\n\n  getContentRows() {\n    return [];\n  }\n\n  refreshHeader() {// Method to refresh the date header\n  }\n\n  refreshResourceHeader() {\n    remove(this.element.querySelector('tbody').lastElementChild.firstElementChild);\n    const resTd = createElement('td');\n    resTd.appendChild(this.parent.resourceBase.createResourceColumn());\n    prepend([resTd], this.element.querySelector('tbody').lastElementChild);\n    this.parent.notify(contentReady, {});\n  }\n\n  getDayName(date) {\n    return this.parent.getDayNames('abbreviated')[date.getDay()];\n  }\n\n  getDate(date) {\n    return this.parent.globalize.formatDate(date, {\n      format: 'd',\n      calendar: this.parent.getCalendarMode()\n    });\n  }\n\n  getTime(date) {\n    if (this.parent.isAdaptive) {\n      if (this.parent.activeViewOptions.timeFormat === 'HH:mm' || this.parent.activeViewOptions.timeFormat === 'HH.mm') {\n        return this.parent.globalize.formatDate(date, {\n          format: 'H',\n          calendar: this.parent.getCalendarMode()\n        });\n      }\n\n      return this.parent.globalize.formatDate(date, {\n        skeleton: 'h',\n        calendar: this.parent.getCalendarMode()\n      });\n    }\n\n    return this.parent.getTimeString(date);\n  }\n\n  getTimelineDate(date) {\n    const text = this.parent.globalize.formatDate(date, {\n      skeleton: 'MMMd',\n      calendar: this.parent.getCalendarMode()\n    }) + ', ' + this.parent.getDayNames('wide')[date.getDay()];\n    return capitalizeFirstWord(text, 'multiple');\n  }\n\n  createEventTable(trCount) {\n    const eventTable = createElement('div', {\n      className: EVENT_TABLE_CLASS\n    });\n    append(this.getEventRows(trCount), eventTable);\n    return eventTable;\n  }\n\n  getEventRows(trCount) {\n    const eventRows = [];\n    let eventContainer;\n\n    for (let row = 0; row < trCount; row++) {\n      eventContainer = createElement('div', {\n        className: APPOINTMENT_CONTAINER_CLASS\n      });\n\n      if (this.parent.resourceBase && !this.parent.uiStateValues.isGroupAdaptive && this.parent.resourceBase.renderedResources) {\n        eventContainer.setAttribute('data-group-index', this.parent.resourceBase.renderedResources[row].groupIndex.toString());\n      }\n\n      eventRows.push(eventContainer);\n    }\n\n    return eventRows;\n  }\n\n  collapseRows(wrap) {\n    if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n      this.parent.resourceBase.hideResourceRows(wrap.querySelector('tbody'));\n      this.parent.resourceBase.hideResourceRows(wrap.querySelector('.' + EVENT_TABLE_CLASS));\n    }\n  }\n\n  createTableLayout(className) {\n    const clsName = className || '';\n    const table = createElement('table', {\n      className: SCHEDULE_TABLE_CLASS + ' ' + clsName,\n      attrs: {\n        role: 'table'\n      }\n    });\n    const tbody = createElement('tbody');\n    table.appendChild(tbody);\n    return table;\n  }\n\n  createColGroup(table, lastRow) {\n    let length = lastRow.length;\n\n    if (lastRow[0] && lastRow[0].colSpan) {\n      length = lastRow.map(value => value.colSpan).reduce((prev, next) => prev + next);\n    }\n\n    const colGroupEle = createElement('colgroup');\n\n    for (let i = 0; i < length; i++) {\n      colGroupEle.appendChild(createElement('col'));\n    }\n\n    prepend([colGroupEle], table);\n  }\n\n  getScrollXIndent(content) {\n    return content.offsetHeight - content.clientHeight > 0 ? getScrollBarWidth() : 0;\n  }\n\n  scrollTopPanel(target) {\n    this.getDatesHeaderElement().firstElementChild.scrollLeft = target.scrollLeft;\n  }\n\n  scrollHeaderLabels(target) {\n    const headerTable = this.element.querySelector('.e-date-header-wrap table');\n    const colWidth = headerTable.offsetWidth / headerTable.querySelectorAll('colgroup col').length;\n\n    const applyLeft = (headerCells, isRtl) => {\n      let currentCell;\n      let tdLeft = 0;\n      let colSpan = 0;\n      const hiddenLeft = isRtl ? -target.scrollLeft : target.scrollLeft;\n\n      for (const cell of headerCells) {\n        colSpan += parseInt(cell.getAttribute('colSpan'), 10);\n\n        if (colSpan > Math.floor(hiddenLeft / colWidth)) {\n          currentCell = cell;\n          break;\n        }\n\n        tdLeft += cell.offsetWidth;\n      }\n\n      if (!isNullOrUndefined(currentCell)) {\n        currentCell.children[0].style[isRtl ? 'right' : 'left'] = hiddenLeft - tdLeft + 'px';\n      }\n    };\n\n    const classNames = ['.e-header-year-cell', '.e-header-month-cell', '.e-header-week-cell', '.e-header-cells'];\n\n    for (const className of classNames) {\n      const headerCells = [].slice.call(this.element.querySelectorAll(className));\n\n      if (headerCells.length > 0) {\n        for (const element of headerCells) {\n          element.children[0].style[this.parent.enableRtl ? 'right' : 'left'] = '';\n        }\n\n        applyLeft(headerCells, this.parent.enableRtl);\n      }\n    }\n  }\n\n  addAttributes(td, element) {\n    if (td.template) {\n      append(td.template, element);\n    }\n\n    if (td.colSpan) {\n      element.setAttribute('colspan', td.colSpan.toString());\n    }\n\n    if (td.className) {\n      addClass([element], td.className);\n    }\n  }\n\n  getHeaderBarHeight() {\n    let headerBarHeight = 2;\n\n    if (this.parent.headerModule) {\n      headerBarHeight += getOuterHeight(this.parent.headerModule.getHeaderElement());\n    }\n\n    if (this.parent.uiStateValues.isGroupAdaptive) {\n      const resHeader = this.parent.element.querySelector('.' + RESOURCE_HEADER_TOOLBAR);\n\n      if (resHeader) {\n        headerBarHeight += resHeader.offsetHeight;\n      }\n    }\n\n    return headerBarHeight;\n  }\n\n  renderPanel(type) {\n    if (type === PREVIOUS_PANEL_CLASS) {\n      prepend([this.element], this.parent.element.querySelector('.' + TABLE_CONTAINER_CLASS));\n    } else {\n      this.parent.element.querySelector('.' + TABLE_CONTAINER_CLASS).appendChild(this.element);\n    }\n  }\n\n  setPanel(panel) {\n    this.element = panel;\n  }\n\n  getPanel() {\n    return this.element;\n  }\n\n  getDatesHeaderElement() {\n    return this.element.querySelector('.' + DATE_HEADER_CONTAINER_CLASS);\n  } // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  getDateSlots(renderDates, workDays) {\n    return []; // Here getDateSlots only need in vertical and month views\n  }\n\n  generateColumnLevels() {\n    return []; // Here generateColumnLevels only need in vertical and month views\n  }\n\n  getColumnLevels() {\n    return this.colLevels;\n  }\n\n  highlightCurrentTime() {// Here showTimeIndicator functionalities\n  }\n\n  startDate() {\n    return this.renderDates[0];\n  }\n\n  endDate() {\n    return addDays(this.renderDates[this.renderDates.length - 1], 1);\n  }\n\n  getStartHour() {\n    let startHour = this.parent.getStartEndTime(this.parent.activeViewOptions.startHour);\n\n    if (isNullOrUndefined(startHour)) {\n      startHour = new Date(2000, 0, 0, 0);\n    }\n\n    return startHour;\n  }\n\n  getEndHour() {\n    let endHour = this.parent.getStartEndTime(this.parent.activeViewOptions.endHour);\n\n    if (isNullOrUndefined(endHour)) {\n      endHour = new Date(2000, 0, 0, 0);\n    }\n\n    return endHour;\n  }\n\n  isCurrentDate(date) {\n    return date.setHours(0, 0, 0, 0) === this.parent.getCurrentTime().setHours(0, 0, 0, 0);\n  }\n\n  isCurrentMonth(date) {\n    if (this.parent.activeViewOptions.displayDate || this.parent.activeViewOptions.numberOfWeeks > 0) {\n      return this.parent.activeView.getStartDate().getTime() <= this.parent.getCurrentTime().getTime() && this.parent.activeView.getEndDate().getTime() >= this.parent.getCurrentTime().getTime();\n    }\n\n    return date.getFullYear() === this.parent.getCurrentTime().getFullYear() && date.getMonth() === this.parent.getCurrentTime().getMonth();\n  }\n\n  isWorkDay(date, workDays = this.parent.activeViewOptions.workDays) {\n    if (workDays.indexOf(date.getDay()) >= 0) {\n      return true;\n    }\n\n    return false;\n  }\n\n  isWorkHour(date, startHour, endHour, workDays) {\n    if (isNullOrUndefined(startHour) || isNullOrUndefined(endHour)) {\n      return false;\n    }\n\n    startHour.setMilliseconds(0);\n    endHour.setMilliseconds(0);\n    return !(getDateInMs(date) < getDateInMs(startHour) || getDateInMs(date) >= getDateInMs(endHour) || !this.isWorkDay(date, workDays));\n  }\n\n  getRenderDates(workDays) {\n    const renderDates = []; // Due to same code for vertical and time line, week & work week views, if condition has used\n\n    if (this.parent.currentView === 'Week' || this.parent.currentView === 'TimelineWeek') {\n      const selectedDate = resetTime(this.parent.selectedDate);\n      let start = getWeekFirstDate(selectedDate, this.parent.activeViewOptions.firstDayOfWeek);\n\n      for (let i = 0, length = WEEK_LENGTH * this.parent.activeViewOptions.interval; i < length; i++) {\n        if (this.parent.activeViewOptions.showWeekend) {\n          renderDates.push(start);\n        } else {\n          if (this.isWorkDay(start, workDays)) {\n            renderDates.push(start);\n          }\n        }\n\n        start = addDays(start, 1);\n      }\n    } else if (this.parent.currentView === 'WorkWeek' || this.parent.currentView === 'TimelineWorkWeek') {\n      let start = getWeekFirstDate(resetTime(this.parent.selectedDate), this.parent.activeViewOptions.firstDayOfWeek);\n\n      for (let i = 0, length = WEEK_LENGTH * this.parent.activeViewOptions.interval; i < length; i++) {\n        if (this.isWorkDay(start, workDays)) {\n          renderDates.push(start);\n        }\n\n        start = addDays(start, 1);\n      }\n    } else {\n      const dayCount = this.parent.currentView === 'Agenda' ? this.parent.agendaDaysCount : this.parent.activeViewOptions.interval;\n      let start = resetTime(this.parent.selectedDate);\n\n      do {\n        if (this.parent.activeViewOptions.showWeekend) {\n          renderDates.push(start);\n        } else {\n          if (this.isWorkDay(start, workDays)) {\n            renderDates.push(start);\n          }\n        }\n\n        start = addDays(start, 1);\n      } while (dayCount !== renderDates.length);\n    }\n\n    if (!workDays) {\n      this.renderDates = renderDates;\n    }\n\n    if (this.parent.headerModule) {\n      this.parent.headerModule.previousNextIconHandler();\n    }\n\n    return renderDates;\n  }\n\n  getNextPreviousDate(type) {\n    if (this.parent.currentView === 'Day' || this.parent.currentView === 'TimelineDay') {\n      if (this.parent.activeViewOptions.showWeekend) {\n        const daysCount = this.parent.activeViewOptions.interval;\n        return addDays(this.parent.selectedDate, type === 'next' ? daysCount : -daysCount);\n      } else {\n        let date;\n\n        if (type === 'next') {\n          date = addDays(this.renderDates.slice(-1)[0], 1);\n\n          while (!this.isWorkDay(date)) {\n            date = addDays(date, 1);\n          }\n        } else {\n          date = addDays(this.renderDates[0], -1);\n          let count = 0;\n\n          do {\n            if (this.isWorkDay(date)) {\n              count += 1;\n            }\n\n            if (this.parent.activeViewOptions.interval !== count) {\n              date = addDays(date, -1);\n            }\n          } while (this.parent.activeViewOptions.interval !== count);\n        }\n\n        return date;\n      }\n    }\n\n    const weekLength = type === 'next' ? WEEK_LENGTH : -WEEK_LENGTH;\n    return addDays(this.parent.selectedDate, weekLength * this.parent.activeViewOptions.interval);\n  }\n\n  getLabelText(view) {\n    const viewStr = view.charAt(0).toLowerCase() + view.substring(1);\n    return this.parent.localeObj.getConstant(viewStr) + ' of ' + capitalizeFirstWord(this.parent.globalize.formatDate(this.parent.selectedDate, {\n      skeleton: 'long',\n      calendar: this.parent.getCalendarMode()\n    }), 'single');\n  }\n\n  getDateRangeText() {\n    if (this.parent.isAdaptive) {\n      const formatDate = this.parent.activeViewOptions.dateFormat ? this.parent.activeViewOptions.dateFormat : 'MMMM y';\n      return capitalizeFirstWord(this.parent.globalize.formatDate(this.parent.selectedDate, {\n        format: formatDate,\n        calendar: this.parent.getCalendarMode()\n      }), 'single');\n    }\n\n    return this.formatDateRange(this.renderDates[0], this.renderDates[this.renderDates.length - 1]);\n  }\n\n  formatDateRange(startDate, endDate) {\n    const globalize = this.parent.globalize;\n    const mode = this.parent.getCalendarMode();\n\n    if (startDate === endDate) {\n      endDate = null;\n    }\n\n    if (!isNullOrUndefined(this.parent.activeViewOptions.dateFormat)) {\n      let text = '';\n\n      if (!endDate) {\n        text = globalize.formatDate(startDate, {\n          format: this.parent.activeViewOptions.dateFormat,\n          calendar: mode\n        });\n        return capitalizeFirstWord(text, 'multiple');\n      }\n\n      text = globalize.formatDate(startDate, {\n        format: this.parent.activeViewOptions.dateFormat,\n        calendar: mode\n      }) + ' - ' + globalize.formatDate(endDate, {\n        format: this.parent.activeViewOptions.dateFormat,\n        calendar: mode\n      });\n      return capitalizeFirstWord(text, 'multiple');\n    }\n\n    let formattedStr;\n    let longDateFormat;\n\n    if (this.parent.locale === 'en' || this.parent.locale === 'en-US') {\n      longDateFormat = getValue('dateFormats.long', getDefaultDateObject(mode));\n    } else {\n      longDateFormat = getValue('main.' + '' + this.parent.locale + '.dates.calendars.' + mode + '.dateFormats.long', cldrData);\n    }\n\n    if (!endDate) {\n      return capitalizeFirstWord(globalize.formatDate(startDate, {\n        format: longDateFormat,\n        calendar: mode\n      }), 'single');\n    }\n\n    const dateFormat = longDateFormat.trim().toLocaleLowerCase();\n\n    if (dateFormat.substr(0, 1) === 'd') {\n      if (startDate.getFullYear() === endDate.getFullYear()) {\n        if (startDate.getMonth() === endDate.getMonth()) {\n          formattedStr = globalize.formatDate(startDate, {\n            format: 'dd',\n            calendar: mode\n          }) + ' - ' + globalize.formatDate(endDate, {\n            format: 'dd MMMM yyyy',\n            calendar: mode\n          });\n        } else {\n          formattedStr = globalize.formatDate(startDate, {\n            format: 'dd MMM',\n            calendar: mode\n          }) + ' - ' + globalize.formatDate(endDate, {\n            format: 'dd MMM yyyy',\n            calendar: mode\n          });\n        }\n      } else {\n        formattedStr = globalize.formatDate(startDate, {\n          format: 'dd MMM yyyy',\n          calendar: mode\n        }) + ' - ' + globalize.formatDate(endDate, {\n          format: 'dd MMM yyyy',\n          calendar: mode\n        });\n      }\n    } else if (dateFormat.substr(0, 1) === 'm') {\n      if (startDate.getFullYear() === endDate.getFullYear()) {\n        if (startDate.getMonth() === endDate.getMonth()) {\n          formattedStr = globalize.formatDate(startDate, {\n            format: 'MMMM dd',\n            calendar: mode\n          }) + ' - ' + globalize.formatDate(endDate, {\n            format: 'dd, yyyy',\n            calendar: mode\n          });\n        } else {\n          formattedStr = globalize.formatDate(startDate, {\n            format: 'MMM dd',\n            calendar: mode\n          }) + ' - ' + globalize.formatDate(endDate, {\n            format: 'MMM dd, yyyy',\n            calendar: mode\n          });\n        }\n      } else {\n        formattedStr = globalize.formatDate(startDate, {\n          format: 'MMM dd, yyyy',\n          calendar: mode\n        }) + ' - ' + globalize.formatDate(endDate, {\n          format: 'MMM dd, yyyy',\n          calendar: mode\n        });\n      }\n    } else {\n      formattedStr = globalize.formatDate(startDate, {\n        format: longDateFormat,\n        calendar: mode\n      }) + ' - ' + globalize.formatDate(endDate, {\n        format: longDateFormat,\n        calendar: mode\n      });\n    }\n\n    return capitalizeFirstWord(formattedStr, 'multiple');\n  }\n\n  getMobileDateElement(date, className) {\n    const wrap = createElement('div', {\n      className: className,\n      innerHTML: '<div class=\"e-m-date\">' + this.parent.globalize.formatDate(date, {\n        format: 'd',\n        calendar: this.parent.getCalendarMode()\n      }) + '</div>' + '<div class=\"e-m-day\">' + capitalizeFirstWord(this.parent.globalize.formatDate(date, {\n        format: 'E',\n        calendar: this.parent.getCalendarMode()\n      }), 'single') + '</div>'\n    });\n    return wrap;\n  }\n\n  setResourceHeaderContent(tdElement, tdData, className = TEXT_ELLIPSIS) {\n    if (this.parent.activeViewOptions.resourceHeaderTemplate) {\n      const data = {\n        resource: tdData.resource,\n        resourceData: tdData.resourceData\n      };\n      const scheduleId = this.parent.element.id + '_';\n      const viewName = this.parent.activeViewOptions.resourceHeaderTemplateName;\n      const templateId = scheduleId + viewName + 'resourceHeaderTemplate';\n      const quickTemplate = [].slice.call(this.parent.getResourceHeaderTemplate()(data, this.parent, 'resourceHeaderTemplate', templateId, false));\n      append(quickTemplate, tdElement);\n    } else {\n      tdElement.appendChild(createElement('div', {\n        className: className,\n        innerHTML: tdData.resourceData[tdData.resource.textField]\n      }));\n    }\n  }\n\n  renderResourceMobileLayout() {\n    if (this.parent.resourceBase.lastResourceLevel && this.parent.resourceBase.lastResourceLevel.length <= 0) {\n      return;\n    }\n\n    this.parent.resourceBase.renderResourceHeader();\n    this.parent.resourceBase.renderResourceTree();\n  }\n\n  addAutoHeightClass(element) {\n    if (!this.parent.uiStateValues.isGroupAdaptive && this.parent.rowAutoHeight && this.isTimelineView() && this.parent.activeViewOptions.group.resources.length > 0) {\n      addClass([element], AUTO_HEIGHT);\n    }\n  }\n\n  getColElements() {\n    return [].slice.call(this.element.querySelectorAll('.' + CONTENT_WRAP_CLASS + ' col, .' + DATE_HEADER_WRAP_CLASS + ' col'));\n  }\n\n  setColWidth(content) {\n    if (this.isTimelineView()) {\n      const colElements = this.getColElements();\n      const contentBody = this.element.querySelector('.' + CONTENT_TABLE_CLASS + ' tbody');\n      const colWidth = contentBody.getBoundingClientRect().width / (colElements.length / 2);\n      colElements.forEach(col => setStyleAttribute(col, {\n        'width': formatUnit(colWidth)\n      }));\n\n      if (content.offsetHeight !== content.clientHeight) {\n        const resourceColumn = this.parent.element.querySelector('.' + RESOURCE_COLUMN_WRAP_CLASS);\n\n        if (!isNullOrUndefined(resourceColumn)) {\n          setStyleAttribute(resourceColumn, {\n            'height': formatUnit(content.clientHeight)\n          });\n        }\n      }\n\n      const cssClass = `.${HEADER_CELLS_CLASS},.${TIME_SLOT_CLASS},.${HEADER_WEEK_CELLS_CLASS},.${HEADER_MONTH_CELLS_CLASS},.${HEADER_YEAR_CELLS_CLASS}`;\n      const headerCellElements = [].slice.call(this.element.querySelectorAll(cssClass));\n      headerCellElements.forEach(ele => {\n        const colSpan = isNullOrUndefined(ele.getAttribute('colspan')) ? '1' : ele.getAttribute('colspan');\n        const headerCellColSpan = parseInt(colSpan, 10);\n        setStyleAttribute(ele, {\n          'width': formatUnit(colWidth * headerCellColSpan)\n        });\n      });\n    }\n  }\n\n  resetColWidth() {\n    const colElements = this.getColElements();\n\n    for (const col of colElements) {\n      col.style.width = '';\n    }\n  }\n\n  getContentAreaElement() {\n    return this.element.querySelector('.' + CONTENT_WRAP_CLASS);\n  }\n\n  wireExpandCollapseIconEvents() {\n    if (this.parent.resourceBase && this.parent.resourceBase.resourceCollection.length > 1) {\n      const treeIcons = [].slice.call(this.element.querySelectorAll('.' + RESOURCE_TREE_ICON_CLASS));\n\n      for (const icon of treeIcons) {\n        EventHandler.clearEvents(icon);\n        EventHandler.add(icon, 'click', this.parent.resourceBase.onTreeIconClick, this.parent.resourceBase);\n      }\n    }\n  }\n\n  scrollToDate(scrollDate) {\n    if (['Month', 'TimelineMonth'].indexOf(this.parent.currentView) === -1 || isNullOrUndefined(scrollDate)) {\n      return;\n    }\n\n    const scrollWrap = this.getContentAreaElement();\n    const tdDate = new Date(resetTime(new Date(+scrollDate)).getTime()).getTime();\n    const dateElement = scrollWrap.querySelector(`.${WORK_CELLS_CLASS}[data-date=\"${tdDate}\"]`);\n\n    if (this.parent.currentView === 'Month' && dateElement) {\n      if (scrollWrap.scrollWidth > scrollWrap.clientWidth) {\n        if (!this.parent.enableRtl) {\n          scrollWrap.scrollLeft = dateElement.offsetLeft;\n        } else {\n          scrollWrap.scrollLeft = -(this.parent.getContentTable().offsetWidth - dateElement.offsetLeft - dateElement.offsetWidth);\n        }\n      }\n\n      scrollWrap.scrollTop = dateElement.offsetTop;\n    }\n\n    if (this.parent.currentView === 'TimelineMonth' && dateElement) {\n      if (!this.parent.enableRtl) {\n        scrollWrap.scrollLeft = dateElement.offsetLeft;\n      } else {\n        scrollWrap.scrollLeft = -(this.parent.getContentTable().offsetWidth - dateElement.offsetLeft - dateElement.offsetWidth);\n      }\n    }\n  }\n\n  setPersistence() {\n    if (this.parent.enablePersistence) {\n      const contentWrap = this.element.querySelector('.e-content-wrap');\n\n      if (!isNullOrUndefined(contentWrap)) {\n        this.parent.scrollLeft = contentWrap.scrollLeft;\n        this.parent.scrollTop = contentWrap.scrollTop;\n      }\n    }\n  }\n\n  retainScrollPosition() {\n    if (this.parent.enablePersistence) {\n      const conWrap = this.parent.element.querySelector('.e-content-wrap');\n\n      if (!isNullOrUndefined(conWrap) && !isNullOrUndefined(this.parent.scrollLeft) && !isNullOrUndefined(this.parent.scrollTop)) {\n        conWrap.scrollTop = this.parent.scrollTop;\n        conWrap.scrollLeft = this.parent.scrollLeft;\n      }\n    }\n  }\n\n  getViewStartDate() {\n    let startDate = this.renderDates[0];\n\n    if (this.parent.activeViewOptions.group.resources.length > 0 && this.parent.resourceBase.lastResourceLevel.length > 0) {\n      startDate = this.parent.resourceBase.getResourceRenderDates()[0];\n    }\n\n    return startDate;\n  }\n\n  getViewEndDate() {\n    let endDate = addDays(this.renderDates[this.renderDates.length - 1], 1);\n\n    if (this.parent.activeViewOptions.group.resources.length > 0 && this.parent.resourceBase.lastResourceLevel.length > 0) {\n      endDate = addDays(this.parent.resourceBase.getResourceRenderDates().slice(-1)[0], 1);\n    }\n\n    return endDate;\n  }\n\n  getAdjustedDate(startTime) {\n    if (!this.parent.activeViewOptions.timeScale.enable || this.parent.currentView === 'Month' || this.parent.currentView === 'TimelineYear' && this.parent.activeViewOptions.group.resources.length === 0) {\n      return new Date(startTime.setHours(0, 0, 0, 0));\n    } else if (this.parent.currentView === 'TimelineYear' && this.parent.activeViewOptions.group.resources.length > 0) {\n      startTime.setHours(0, 0, 0, 0);\n      return new Date(startTime.setDate(1));\n    }\n\n    return null;\n  }\n\n  destroy() {\n    if (this.element && this.element.parentNode) {\n      remove(this.element);\n    }\n\n    this.element = null;\n    this.renderDates = null;\n    this.colLevels = null;\n  }\n\n}\n/**\n * vertical view\n */\n\n\nclass VerticalView extends ViewBase {\n  constructor(parent) {\n    super(parent);\n    this.viewClass = 'e-day-view';\n    this.isInverseTableSelect = true;\n    this.baseCssClass = 'e-vertical-view';\n    this.appointment = null;\n  }\n\n  getModuleName() {\n    return 'verticalView';\n  }\n\n  addEventListener() {\n    this.parent.on(scrollUiUpdate, this.scrollUiUpdate, this);\n    this.parent.on(dataReady, this.renderEvents, this);\n  }\n\n  removeEventListener() {\n    if (this.parent) {\n      this.parent.off(scrollUiUpdate, this.scrollUiUpdate);\n      this.parent.off(dataReady, this.renderEvents);\n    }\n  }\n\n  renderEvents() {\n    this.appointment = this.parent.activeViewOptions.timeScale.enable ? new VerticalEvent(this.parent) : new MonthEvent(this.parent);\n    this.appointment.renderAppointments();\n    this.parent.notify(eventsLoaded, {});\n  }\n\n  onContentScroll(e) {\n    this.parent.removeNewEventElement();\n    const target = e.target;\n    this.parent.notify(virtualScroll, e);\n    this.scrollLeftPanel(target);\n    this.scrollTopPanel(target);\n\n    if (!this.parent.isAdaptive) {\n      this.parent.uiStateValues.top = target.scrollTop;\n    }\n\n    this.parent.uiStateValues.left = target.scrollLeft;\n\n    if (!isNullOrUndefined(this.parent.quickPopup)) {\n      this.parent.quickPopup.quickPopupHide();\n    }\n\n    this.setPersistence();\n  }\n\n  onAdaptiveMove(e) {\n    if (this.parent.uiStateValues.action) {\n      e.preventDefault();\n    }\n  }\n\n  onAdaptiveScroll(e) {\n    if (this.parent && !this.parent.isDestroyed) {\n      this.parent.removeNewEventElement();\n      this.parent.uiStateValues.top = e.target.scrollTop;\n    }\n  }\n\n  scrollLeftPanel(target) {\n    const leftPanel = this.getLeftPanelElement();\n\n    if (!isNullOrUndefined(leftPanel)) {\n      leftPanel.scrollTop = target.scrollTop;\n    }\n  }\n\n  scrollUiUpdate(args) {\n    if (!this.parent) {\n      return;\n    }\n\n    const dateHeader = this.parent.element.querySelector('.' + DATE_HEADER_WRAP_CLASS);\n    const headerBarHeight = this.getHeaderBarHeight();\n    const timeCells = this.getLeftPanelElement();\n    const content = this.getScrollableElement();\n    const header = this.getDatesHeaderElement();\n    const scrollerHeight = this.parent.element.offsetHeight - headerBarHeight - header.offsetHeight;\n    this.setColWidth(content);\n    this.setContentHeight(content, timeCells, scrollerHeight);\n    const scrollBarWidth = getScrollBarWidth(); // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\n    header.firstElementChild.style[args.cssProperties.rtlBorder] = ''; // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\n    header.style[args.cssProperties.rtlPadding] = '';\n    const isDateHeaderScroll = this.parent.enableAllDayScroll ? !(content.offsetWidth - content.clientWidth <= dateHeader.offsetWidth - dateHeader.clientWidth && dateHeader.classList.contains('e-all-day-scroll')) : true;\n\n    if (content.offsetWidth - content.clientWidth > 0 && isDateHeaderScroll) {\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      header.firstElementChild.style[args.cssProperties.border] = scrollBarWidth > 0 ? '1px' : '0px'; // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\n      header.style[args.cssProperties.padding] = scrollBarWidth > 0 ? scrollBarWidth - 1 + 'px' : '0px';\n    } else {\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      header.firstElementChild.style[args.cssProperties.border] = ''; // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\n      header.style[args.cssProperties.padding] = '';\n    }\n\n    if (!args.isPreventScrollUpdate) {\n      if (this.parent.uiStateValues.isInitial) {\n        this.scrollToWorkHour();\n        this.parent.uiStateValues.isInitial = false;\n      } else {\n        if (timeCells) {\n          timeCells.scrollTop = this.parent.uiStateValues.top;\n        }\n\n        content.scrollTop = this.parent.uiStateValues.top;\n        content.scrollLeft = this.parent.uiStateValues.left;\n      }\n    }\n\n    if (this.parent.activeViewOptions.timeScale.enable) {\n      this.highlightCurrentTime();\n    }\n\n    this.retainScrollPosition();\n  }\n\n  setContentHeight(element, leftPanelElement, height) {\n    if (this.parent.isAdaptive && !this.isTimelineView()) {\n      element.style.height = this.parent.height === 'auto' ? 'auto' : formatUnit(height);\n    } else {\n      if (!isNullOrUndefined(leftPanelElement)) {\n        leftPanelElement.style.height = this.parent.height === 'auto' ? 'auto' : formatUnit(height - this.getScrollXIndent(element));\n      }\n\n      element.style.height = this.parent.height === 'auto' ? 'auto' : formatUnit(height);\n    }\n  }\n\n  scrollToWorkHour() {\n    if (this.parent.workHours.highlight) {\n      const firstWorkHourCell = this.element.querySelector('.' + WORK_HOURS_CLASS);\n\n      if (firstWorkHourCell) {\n        this.getScrollableElement().scrollTop = firstWorkHourCell.offsetTop;\n        this.parent.uiStateValues.top = firstWorkHourCell.offsetTop;\n        this.parent.uiStateValues.left = 0;\n      }\n    }\n  }\n\n  scrollToHour(hour, scrollDate) {\n    const date = this.parent.getStartEndTime(hour);\n\n    if (!isNullOrUndefined(scrollDate)) {\n      const headerElement = this.element.querySelector('.' + HEADER_CELLS_CLASS + '[data-date=\"' + new Date(resetTime(scrollDate)).getTime() + '\"]');\n\n      if (headerElement) {\n        if (this.parent.enableRtl) {\n          const conWrap = this.element.querySelector('.' + CONTENT_TABLE_CLASS);\n          this.getScrollableElement().scrollLeft = -(conWrap.offsetWidth - headerElement.offsetLeft - headerElement.offsetWidth);\n        } else {\n          this.getScrollableElement().scrollLeft = headerElement.offsetLeft;\n        }\n      }\n    }\n\n    if (isNullOrUndefined(date)) {\n      return;\n    }\n\n    this.getScrollableElement().scrollTop = this.getTopFromDateTime(date);\n  }\n\n  scrollToDate(scrollDate) {\n    this.scrollToHour(null, scrollDate);\n  }\n\n  generateColumnLevels() {\n    const level = this.getDateSlots(this.renderDates, this.parent.activeViewOptions.workDays);\n    let columnLevels = [];\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      columnLevels = this.parent.resourceBase.generateResourceLevels(level);\n\n      if (this.parent.uiStateValues.isGroupAdaptive && this.parent.resourceBase.lastResourceLevel.length > 0) {\n        const resourceLevel = this.parent.resourceBase.lastResourceLevel[this.parent.uiStateValues.groupIndex];\n        const resStartHour = resourceLevel.resourceData[resourceLevel.resource.startHourField];\n        const resEndHour = resourceLevel.resourceData[resourceLevel.resource.endHourField];\n        const dateSlots = this.getDateSlots(resourceLevel.renderDates, resourceLevel.workDays, resStartHour, resEndHour);\n        columnLevels = [dateSlots];\n      }\n    } else {\n      columnLevels.push(level);\n    }\n\n    this.colLevels = columnLevels;\n    return columnLevels;\n  } // eslint-disable-next-line max-len\n\n\n  getDateSlots(renderDates, workDays, workStartHour = this.parent.workHours.start, workEndHour = this.parent.workHours.end) {\n    const dateCol = [];\n    const start = this.parent.getStartEndTime(workStartHour);\n    const end = this.parent.getStartEndTime(workEndHour);\n\n    for (const col of renderDates) {\n      const classList$$1 = [HEADER_CELLS_CLASS];\n\n      if (this.isCurrentDate(col)) {\n        classList$$1.push(CURRENT_DAY_CLASS);\n      }\n\n      dateCol.push({\n        date: col,\n        type: 'dateHeader',\n        className: classList$$1,\n        colSpan: 1,\n        workDays: workDays,\n        startHour: new Date(+start),\n        endHour: new Date(+end)\n      });\n    }\n\n    return dateCol;\n  }\n\n  isWorkHourRange(date) {\n    return this.getStartHour().getTime() <= date.getTime() && this.getEndHour().getTime() >= date.getTime();\n  }\n\n  highlightCurrentTime() {\n    if (this.parent.activeViewOptions.headerRows.length > 0 && this.parent.activeViewOptions.headerRows.slice(-1)[0].option !== 'Hour') {\n      return;\n    }\n\n    if (this.parent.showTimeIndicator && this.isWorkHourRange(this.parent.getCurrentTime())) {\n      const currentDateIndex = this.getCurrentTimeIndicatorIndex();\n\n      if (currentDateIndex.length > 0) {\n        const workCells = [].slice.call(this.element.querySelectorAll('.' + WORK_CELLS_CLASS));\n\n        if (workCells.length > 0) {\n          this.changeCurrentTimePosition();\n        }\n\n        if (isNullOrUndefined(this.currentTimeIndicatorTimer)) {\n          const currentDate = this.parent.getCurrentTime();\n          const interval = MS_PER_MINUTE - (currentDate.getSeconds() * 1000 + currentDate.getMilliseconds());\n\n          if (interval <= MS_PER_MINUTE - 1000) {\n            window.setTimeout(() => {\n              if (!isNullOrUndefined(this.currentTimeIndicatorTimer)) {\n                this.clearCurrentTimeIndicatorTimer();\n                this.changeCurrentTimePosition();\n                this.updateCurrentTimeIndicatorTimer();\n              }\n            }, interval);\n          }\n\n          this.updateCurrentTimeIndicatorTimer();\n        }\n      } else {\n        this.clearCurrentTimeIndicatorTimer();\n      }\n    } else {\n      this.clearCurrentTimeIndicatorTimer();\n    }\n  }\n\n  getCurrentTimeIndicatorIndex() {\n    const currentDateIndex = [];\n\n    if (!isNullOrUndefined(this.parent.resourceBase) && this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n      let count = 0;\n\n      for (const resource of this.parent.resourceBase.lastResourceLevel) {\n        const index = this.parent.getIndexOfDate(resource.renderDates, resetTime(this.parent.getCurrentTime()));\n\n        if (index >= 0) {\n          const resIndex = this.parent.activeViewOptions.group.byDate ? this.parent.resourceBase.lastResourceLevel.length * index + count : count + index;\n          currentDateIndex.push(resIndex);\n        }\n\n        count += this.parent.activeViewOptions.group.byDate ? 1 : resource.renderDates.length;\n      }\n    } else {\n      const renderDates = this.parent.uiStateValues.isGroupAdaptive && this.parent.resourceBase.lastResourceLevel.length > 0 ? this.parent.resourceBase.lastResourceLevel[this.parent.uiStateValues.groupIndex].renderDates : this.renderDates;\n      const index = this.parent.getIndexOfDate(renderDates, resetTime(this.parent.getCurrentTime()));\n\n      if (index >= 0) {\n        currentDateIndex.push(index);\n      }\n    }\n\n    return currentDateIndex;\n  }\n\n  clearCurrentTimeIndicatorTimer() {\n    if (!isNullOrUndefined(this.currentTimeIndicatorTimer)) {\n      window.clearInterval(this.currentTimeIndicatorTimer);\n      this.currentTimeIndicatorTimer = null;\n      this.removeCurrentTimeIndicatorElements();\n    }\n  }\n\n  updateCurrentTimeIndicatorTimer() {\n    this.currentTimeIndicatorTimer = window.setInterval(() => {\n      this.changeCurrentTimePosition();\n    }, MS_PER_MINUTE);\n  }\n\n  removeCurrentTimeIndicatorElements() {\n    const queryString = '.' + PREVIOUS_TIMELINE_CLASS + ',.' + CURRENT_TIMELINE_CLASS + ',.' + CURRENT_TIME_CLASS;\n    const timeIndicator = [].slice.call(this.element.querySelectorAll(queryString));\n\n    for (const indicator of timeIndicator) {\n      remove(indicator);\n    }\n  }\n\n  changeCurrentTimePosition() {\n    if (!this.parent || this.parent && this.parent.isDestroyed) {\n      return;\n    }\n\n    this.removeCurrentTimeIndicatorElements();\n    const currentDateIndex = this.getCurrentTimeIndicatorIndex();\n    const firstRow = this.parent.getContentTable().rows[0];\n    const top = this.getTopFromDateTime(this.parent.getCurrentTime());\n    const topInPx = formatUnit(top);\n    const rowIndex = Math.floor(top / firstRow.cells[0].offsetHeight);\n    const timeCellsWrap = this.getLeftPanelElement();\n    const timeTrs = [].slice.call(timeCellsWrap.querySelectorAll('tr'));\n\n    if (isNullOrUndefined(rowIndex) || isNaN(rowIndex) || rowIndex === timeTrs.length) {\n      return;\n    }\n\n    const curTimeWrap = [].slice.call(this.element.querySelectorAll('.' + TIMELINE_WRAPPER_CLASS));\n\n    for (let i = 0, length = currentDateIndex[0]; i < length; i++) {\n      curTimeWrap[i].appendChild(createElement('div', {\n        className: PREVIOUS_TIMELINE_CLASS,\n        styles: 'top:' + topInPx\n      }));\n    }\n\n    for (const day of currentDateIndex) {\n      curTimeWrap[day].appendChild(createElement('div', {\n        className: CURRENT_TIMELINE_CLASS,\n        styles: 'top:' + topInPx\n      }));\n    }\n\n    const currentTimeEle = createElement('div', {\n      innerHTML: this.parent.getTimeString(this.parent.getCurrentTime()),\n      className: CURRENT_TIME_CLASS,\n      styles: 'top:' + topInPx\n    });\n\n    if (rowIndex <= timeTrs.length) {\n      removeClass(timeCellsWrap.querySelectorAll('.' + HIDE_CHILDS_CLASS), HIDE_CHILDS_CLASS);\n\n      if (timeTrs[rowIndex]) {\n        addClass([timeTrs[rowIndex].lastElementChild], HIDE_CHILDS_CLASS);\n      }\n\n      prepend([currentTimeEle], timeCellsWrap);\n      currentTimeEle.style.top = formatUnit(currentTimeEle.offsetTop - currentTimeEle.offsetHeight / 2);\n    }\n  }\n\n  getTopFromDateTime(date) {\n    const startHour = this.getStartHour();\n    const diffInMinutes = (date.getHours() - startHour.getHours()) * 60 + (date.getMinutes() - startHour.getMinutes());\n    return diffInMinutes * this.getWorkCellHeight() * this.parent.activeViewOptions.timeScale.slotCount / this.parent.activeViewOptions.timeScale.interval;\n  }\n\n  getWorkCellHeight() {\n    return parseFloat(this.element.querySelector('.' + WORK_CELLS_CLASS).getBoundingClientRect().height.toFixed(2));\n  }\n\n  getTdContent(date, type, groupIndex) {\n    let cntEle;\n    const wrapper = createElement('div');\n    let templateName = '';\n    const templateId = this.parent.element.id + '_';\n\n    switch (type) {\n      case 'dateHeader':\n        if (this.parent.activeViewOptions.dateHeaderTemplate) {\n          templateName = 'dateHeaderTemplate';\n          const args = {\n            date: date,\n            type: type\n          };\n          const viewName = this.parent.activeViewOptions.dateHeaderTemplateName;\n          cntEle = [].slice.call(this.parent.getDateHeaderTemplate()(args, this.parent, templateName, templateId + viewName + templateName, false));\n        } else {\n          wrapper.innerHTML = this.parent.activeView.isTimelineView() ? `<span class=\"e-header-date e-navigate\">${this.getTimelineDate(date)}</span>` : `<div class=\"e-header-day\">${capitalizeFirstWord(this.getDayName(date), 'single')}</div>` + `<div class=\"e-header-date e-navigate\" role=\"link\">${this.getDate(date)}</div>`;\n          cntEle = [].slice.call(wrapper.childNodes);\n        }\n\n        break;\n\n      case 'majorSlot':\n        if (this.parent.activeViewOptions.timeScale.majorSlotTemplate) {\n          templateName = 'majorSlotTemplate';\n          const args = {\n            date: date,\n            type: type\n          };\n          cntEle = [].slice.call(this.parent.getMajorSlotTemplate()(args, this.parent, templateName, templateId + templateName, false));\n        } else {\n          wrapper.innerHTML = `<span>${this.getTime(date)}</span>`;\n          cntEle = [].slice.call(wrapper.childNodes);\n        }\n\n        break;\n\n      case 'minorSlot':\n        if (this.parent.activeViewOptions.timeScale.minorSlotTemplate) {\n          templateName = 'minorSlotTemplate';\n          const args = {\n            date: date,\n            type: type\n          };\n          cntEle = [].slice.call(this.parent.getMinorSlotTemplate()(args, this.parent, templateName, templateId + templateName, false));\n        } else {\n          cntEle = [].slice.call(wrapper.childNodes);\n        }\n\n        break;\n\n      case 'alldayCells':\n        if (this.parent.activeViewOptions.cellTemplate) {\n          const viewName = this.parent.activeViewOptions.cellTemplateName;\n          templateName = 'cellTemplate';\n          const args = {\n            date: date,\n            type: type,\n            groupIndex: groupIndex\n          };\n          cntEle = [].slice.call(this.parent.getCellTemplate()(args, this.parent, templateName, templateId + viewName + templateName, false));\n        }\n\n        break;\n    }\n\n    return cntEle;\n  }\n\n  refreshHeader() {\n    remove(this.element.querySelector('tbody tr'));\n    this.renderHeader();\n    this.parent.notify(contentReady, {});\n  }\n\n  renderLayout(type) {\n    this.setPanel(createElement('div', {\n      className: TABLE_WRAP_CLASS\n    }));\n    const clsList = [this.baseCssClass, this.viewClass];\n    clsList.push(type);\n\n    if (this.parent.activeViewOptions.group.byDate) {\n      clsList.push('e-by-date');\n    }\n\n    if (!this.parent.activeViewOptions.timeScale.enable) {\n      addClass([this.element], [TIMESCALE_DISABLE, this.viewClass]);\n    }\n\n    if (this.parent.activeViewOptions.allowVirtualScrolling) {\n      clsList.push(VIRTUAL_SCROLL_CLASS);\n    }\n\n    if (this.parent.rowAutoHeight && this.parent.eventSettings.ignoreWhitespace) {\n      clsList.push(IGNORE_WHITESPACE);\n    }\n\n    this.renderPanel(type);\n    addClass([this.element], clsList);\n    this.element.appendChild(this.createTableLayout(OUTER_TABLE_CLASS));\n    this.element.querySelector('table').setAttribute('role', 'presentation');\n    this.colLevels = this.generateColumnLevels();\n    this.renderHeader();\n    this.renderContent();\n\n    if (this.parent.uiStateValues.isGroupAdaptive && !this.parent.element.querySelector('.' + RESOURCE_TOOLBAR_CONTAINER)) {\n      this.renderResourceMobileLayout();\n    }\n\n    this.parent.notify(contentReady, {});\n  }\n\n  renderHeader() {\n    const tr = createElement('tr');\n    const dateTd = createElement('td');\n    dateTd.appendChild(this.renderDatesHeader());\n\n    if (this.parent.activeViewOptions.timeScale.enable) {\n      const indentTd = createElement('td', {\n        className: LEFT_INDENT_CLASS\n      });\n      indentTd.appendChild(this.renderLeftIndent());\n      tr.appendChild(indentTd);\n    }\n\n    tr.appendChild(dateTd);\n    prepend([tr], this.element.querySelector('tbody'));\n  }\n\n  renderContent() {\n    const tr = createElement('tr');\n    const workTd = createElement('td');\n\n    if (this.parent.isAdaptive) {\n      workTd.setAttribute('colspan', this.parent.activeViewOptions.timeScale.enable ? '2' : '1');\n      const scrollContainer = createElement('div', {\n        className: SCROLL_CONTAINER_CLASS\n      });\n\n      if (this.parent.activeViewOptions.timeScale.enable) {\n        scrollContainer.appendChild(this.renderTimeCells());\n      }\n\n      scrollContainer.appendChild(this.renderContentArea());\n      workTd.appendChild(scrollContainer);\n      EventHandler.add(scrollContainer, 'scroll', this.onAdaptiveScroll, this);\n      EventHandler.add(scrollContainer, Browser.touchMoveEvent, this.onAdaptiveMove, this);\n      tr.appendChild(workTd);\n    } else {\n      workTd.appendChild(this.renderContentArea());\n\n      if (this.parent.activeViewOptions.timeScale.enable) {\n        const timesTd = createElement('td');\n        timesTd.appendChild(this.renderTimeCells());\n        tr.appendChild(timesTd);\n      }\n\n      tr.appendChild(workTd);\n    }\n\n    this.element.querySelector('tbody').appendChild(tr);\n  }\n\n  renderLeftIndent() {\n    const wrap = createElement('div', {\n      className: LEFT_INDENT_WRAP_CLASS\n    });\n    const tbl = this.createTableLayout();\n    const trEle = createElement('tr');\n    const rowCount = this.colLevels.length;\n    let nth;\n\n    for (let i = 0; i < rowCount; i++) {\n      const ntr = trEle.cloneNode();\n      const data = {\n        className: [this.colLevels[i][0] && this.colLevels[i][0].className[0]],\n        type: 'emptyCells'\n      };\n\n      if (this.parent.activeViewOptions.showWeekNumber && data.className.indexOf(HEADER_CELLS_CLASS) !== -1) {\n        data.className.push(WEEK_NUMBER_CLASS);\n        const weekNo = this.parent.getWeekNumberContent(this.renderDates);\n        data.template = [createElement('span', {\n          innerHTML: '' + weekNo,\n          attrs: {\n            title: this.parent.localeObj.getConstant('week') + ' ' + weekNo\n          }\n        })];\n      }\n\n      nth = this.createTd(data);\n      this.parent.renderHeaderIndentTemplate(data, nth);\n      ntr.appendChild(nth);\n      tbl.querySelector('tbody').appendChild(ntr);\n    }\n\n    const ntr = trEle.cloneNode();\n    const appointmentExpandCollapse = createElement('div', {\n      attrs: {\n        'tabindex': '0',\n        'role': 'list',\n        title: this.parent.localeObj.getConstant('expandAllDaySection'),\n        'aria-disabled': 'false',\n        'aria-label': 'Expand section'\n      },\n      className: ALLDAY_APPOINTMENT_SECTION_CLASS + ' ' + APPOINTMENT_ROW_EXPAND_CLASS + ' ' + ICON + ' ' + DISABLE_CLASS\n    });\n    const data = {\n      className: [ALLDAY_CELLS_CLASS],\n      type: 'emptyCells'\n    };\n    nth = this.createTd(data);\n    nth.appendChild(appointmentExpandCollapse);\n    this.parent.renderHeaderIndentTemplate(data, nth);\n    ntr.appendChild(nth);\n    tbl.querySelector('tbody').appendChild(ntr);\n    wrap.appendChild(tbl);\n    return wrap;\n  }\n\n  renderDatesHeader() {\n    const container = createElement('div', {\n      className: DATE_HEADER_CONTAINER_CLASS\n    });\n    const wrap = createElement('div', {\n      className: DATE_HEADER_WRAP_CLASS\n    });\n    container.appendChild(wrap);\n    const tbl = this.createTableLayout();\n    const trEle = createElement('tr', {\n      className: HEADER_ROW_CLASS\n    });\n    const rowCount = this.colLevels.length;\n    const lastLevel = this.colLevels[rowCount - 1];\n\n    for (let i = 0; i < rowCount; i++) {\n      const ntr = trEle.cloneNode();\n      const level = this.colLevels[i];\n\n      for (let j = 0; j < level.length; j++) {\n        ntr.appendChild(this.createTd(level[j]));\n      }\n\n      tbl.querySelector('tbody').appendChild(ntr);\n    }\n\n    this.createAllDayRow(tbl, lastLevel);\n    this.createColGroup(tbl, lastLevel);\n    wrap.appendChild(tbl);\n    return container;\n  }\n\n  createAllDayRow(table, tdData) {\n    const ntr = createElement('tr', {\n      className: ALLDAY_ROW_CLASS\n    });\n\n    for (let j = 0; j < tdData.length; j++) {\n      const td = extend({}, tdData[j]);\n      td.className = [ALLDAY_CELLS_CLASS];\n      td.type = 'alldayCells';\n      const ntd = this.createTd(td);\n      ntd.setAttribute('role', 'gridcell');\n      ntd.setAttribute('data-date', td.date.getTime().toString());\n\n      if (!isNullOrUndefined(td.groupIndex)) {\n        ntd.setAttribute('data-group-index', '' + td.groupIndex);\n      } else if (this.parent.uiStateValues.isGroupAdaptive) {\n        ntd.setAttribute('data-group-index', '' + this.parent.uiStateValues.groupIndex);\n      }\n\n      this.wireCellEvents(ntd);\n      ntr.appendChild(ntd);\n    }\n\n    table.querySelector('tbody').appendChild(ntr);\n    const thead = createElement('thead');\n    thead.appendChild(this.createEventWrapper('allDay'));\n    prepend([thead], table);\n  }\n\n  createTd(td) {\n    const tdEle = createElement('td');\n    this.addAttributes(td, tdEle);\n\n    if (td.date && td.type) {\n      const ele = this.getTdContent(td.date, td.type, td.groupIndex);\n\n      if (ele && ele.length) {\n        append(ele, tdEle);\n      }\n    }\n\n    if (!this.parent.isMinMaxDate(resetTime(new Date('' + td.date)))) {\n      addClass([tdEle], DISABLE_DATES);\n    }\n\n    if (td.type === 'resourceHeader') {\n      this.setResourceHeaderContent(tdEle, td);\n    }\n\n    if (td.type === 'dateHeader' && td.className.indexOf(HEADER_CELLS_CLASS) >= 0) {\n      tdEle.setAttribute('data-date', td.date.getTime().toString());\n      tdEle.setAttribute('role', 'gridcell');\n\n      if (!isNullOrUndefined(td.groupIndex)) {\n        tdEle.setAttribute('data-group-index', '' + td.groupIndex);\n      }\n\n      this.wireMouseEvents(tdEle);\n    }\n\n    const args = {\n      elementType: td.type,\n      element: tdEle,\n      date: td.date,\n      groupIndex: td.groupIndex\n    };\n    this.parent.trigger(renderCell, args);\n    return tdEle;\n  }\n\n  wireCellEvents(element) {\n    EventHandler.add(element, 'mousedown', this.parent.workCellAction.cellMouseDown, this.parent.workCellAction);\n    this.wireMouseEvents(element);\n  }\n\n  wireMouseEvents(element) {\n    EventHandler.add(element, 'click', this.parent.workCellAction.cellClick, this.parent.workCellAction);\n\n    if (!this.parent.isAdaptive) {\n      EventHandler.add(element, 'dblclick', this.parent.workCellAction.cellDblClick, this.parent.workCellAction);\n    }\n  }\n\n  renderTimeCells() {\n    const wrap = createElement('div', {\n      className: TIME_CELLS_WRAP_CLASS\n    });\n    const tbl = this.createTableLayout();\n    const trEle = createElement('tr');\n\n    const handler = r => {\n      r.type = r.first ? 'majorSlot' : 'minorSlot';\n      r.className = r.last ? [TIME_CELLS_CLASS, TIME_SLOT_CLASS] : [TIME_SLOT_CLASS];\n      const ntr = trEle.cloneNode();\n      const data = {\n        date: r.date,\n        type: r.type,\n        className: r.className\n      };\n      ntr.appendChild(this.createTd(data));\n      tbl.querySelector('tbody').appendChild(ntr);\n      return r;\n    };\n\n    this.getTimeSlotRows(handler);\n    wrap.appendChild(tbl);\n    return wrap;\n  }\n\n  renderContentArea() {\n    const wrap = createElement('div', {\n      className: CONTENT_WRAP_CLASS\n    });\n    const tbl = this.createTableLayout(CONTENT_TABLE_CLASS);\n    this.addAutoHeightClass(tbl);\n    this.renderContentTable(tbl);\n    this.createColGroup(tbl, this.colLevels.slice(-1)[0]);\n    wrap.appendChild(tbl);\n    this.wireCellEvents(tbl.querySelector('tbody'));\n    EventHandler.add(wrap, 'scroll', this.onContentScroll, this);\n    EventHandler.add(wrap, Browser.touchMoveEvent, this.onAdaptiveMove, this);\n    return wrap;\n  }\n\n  renderContentTable(table) {\n    const tr = createElement('tr', {\n      attrs: {\n        role: 'row'\n      }\n    });\n    const td = createElement('td', {\n      attrs: {\n        role: 'gridcell',\n        'aria-selected': 'false'\n      }\n    });\n    const tbody = table.querySelector('tbody');\n\n    const handler = r => {\n      const ntr = tr.cloneNode();\n\n      for (const tdData of this.colLevels[this.colLevels.length - 1]) {\n        const ntd = this.createContentTd(tdData, r, td);\n        ntr.appendChild(ntd);\n      }\n\n      tbody.appendChild(ntr);\n      return r;\n    };\n\n    this.getTimeSlotRows(handler);\n    this.renderContentTableHeader(table);\n  }\n\n  createContentTd(tdData, r, td) {\n    const ntd = td.cloneNode();\n\n    if (tdData.colSpan) {\n      ntd.setAttribute('colspan', tdData.colSpan.toString());\n    }\n\n    const clsName = this.getContentTdClass(r);\n    const cellDate = resetTime(tdData.date);\n\n    if (!this.parent.isMinMaxDate(cellDate)) {\n      clsName.push(DISABLE_DATES);\n    }\n\n    setTime(cellDate, getDateInMs(r.date));\n    let type = 'workCells';\n\n    if (tdData.className.indexOf(RESOURCE_PARENT_CLASS) !== -1) {\n      clsName.push(RESOURCE_GROUP_CELLS_CLASS);\n      type = 'resourceGroupCells';\n    }\n\n    if (this.parent.workHours.highlight && (this.parent.activeViewOptions.timeScale.enable && this.isWorkHour(cellDate, tdData.startHour, tdData.endHour, tdData.workDays) || !this.parent.activeViewOptions.timeScale.enable && this.isWorkDay(cellDate, tdData.workDays))) {\n      clsName.push(WORK_HOURS_CLASS);\n    }\n\n    addClass([ntd], clsName);\n\n    if (this.parent.activeViewOptions.cellTemplate) {\n      const args = {\n        date: cellDate,\n        type: type,\n        groupIndex: tdData.groupIndex\n      };\n      const scheduleId = this.parent.element.id + '_';\n      const viewName = this.parent.activeViewOptions.cellTemplateName;\n      const templateId = scheduleId + viewName + 'cellTemplate';\n      const tooltipTemplate = [].slice.call(this.parent.getCellTemplate()(args, this.parent, 'cellTemplate', templateId, false));\n      append(tooltipTemplate, ntd);\n    }\n\n    ntd.setAttribute('data-date', cellDate.getTime().toString());\n\n    if (!isNullOrUndefined(tdData.groupIndex) || this.parent.uiStateValues.isGroupAdaptive) {\n      const groupIndex = this.parent.uiStateValues.isGroupAdaptive ? this.parent.uiStateValues.groupIndex : tdData.groupIndex;\n      ntd.setAttribute('data-group-index', '' + groupIndex);\n    }\n\n    const args = {\n      elementType: type,\n      element: ntd,\n      date: cellDate,\n      groupIndex: tdData.groupIndex\n    };\n    this.parent.trigger(renderCell, args);\n    return ntd;\n  }\n\n  getContentTdClass(r) {\n    return r.last ? [WORK_CELLS_CLASS] : [WORK_CELLS_CLASS, ALTERNATE_CELLS_CLASS];\n  }\n\n  renderContentTableHeader(table) {\n    const thead = createElement('thead');\n    thead.appendChild(this.createEventWrapper());\n\n    if (this.parent.activeViewOptions.timeScale.enable) {\n      thead.appendChild(this.createEventWrapper('timeIndicator'));\n    }\n\n    prepend([thead], table);\n  }\n\n  createEventWrapper(type = '') {\n    const tr = createElement('tr');\n    const levels = this.colLevels.slice(-1)[0];\n\n    for (let i = 0, len = levels.length; i < len; i++) {\n      const col = levels[i];\n      const appointmentWrap = createElement('td', {\n        className: type === 'allDay' ? ALLDAY_APPOINTMENT_WRAPPER_CLASS : type === 'timeIndicator' ? TIMELINE_WRAPPER_CLASS : DAY_WRAPPER_CLASS,\n        attrs: {\n          'data-date': col.date.getTime().toString()\n        }\n      });\n\n      if (!isNullOrUndefined(col.groupIndex)) {\n        appointmentWrap.setAttribute('data-group-index', col.groupIndex.toString());\n      }\n\n      if (type === '') {\n        const innerWrapper = createElement('div', {\n          id: APPOINTMENT_WRAPPER_CLASS + '-' + i.toString(),\n          className: APPOINTMENT_WRAPPER_CLASS\n        });\n        appointmentWrap.appendChild(innerWrapper);\n      }\n\n      tr.appendChild(appointmentWrap);\n    }\n\n    return tr;\n  }\n\n  getScrollableElement() {\n    if (this.parent.isAdaptive && !this.isTimelineView()) {\n      return this.element.querySelector('.' + SCROLL_CONTAINER_CLASS);\n    } else {\n      return this.getContentAreaElement();\n    }\n  }\n\n  getLeftPanelElement() {\n    return this.element.querySelector('.' + TIME_CELLS_WRAP_CLASS);\n  }\n\n  getEndDateFromStartDate(start) {\n    const msMajorInterval = this.parent.activeViewOptions.timeScale.interval * MS_PER_MINUTE;\n    const msInterval = msMajorInterval / this.parent.activeViewOptions.timeScale.slotCount;\n    const end = new Date(start.getTime());\n    end.setMilliseconds(end.getMilliseconds() + msInterval);\n    return end;\n  }\n\n  getTimeSlotRows(handler) {\n    const rows = [];\n    const startHour = this.getStartHour();\n    const endHour = this.getEndHour();\n    const msMajorInterval = this.parent.activeViewOptions.timeScale.interval * MS_PER_MINUTE;\n    const msInterval = msMajorInterval / this.parent.activeViewOptions.timeScale.slotCount;\n    let length = Math.round(MS_PER_DAY / msInterval);\n    const msStartHour = startHour.getTime();\n    const msEndHour = endHour.getTime();\n\n    if (msStartHour !== msEndHour) {\n      const duration = this.parent.activeViewOptions.timeScale.interval / this.parent.activeViewOptions.timeScale.slotCount;\n      length = Math.abs(msEndHour - msStartHour) / msInterval - (new Date(msEndHour).getTimezoneOffset() - new Date(msStartHour).getTimezoneOffset()) / duration;\n    }\n\n    if (!this.parent.activeViewOptions.timeScale.enable) {\n      length = 1;\n    }\n\n    const start = this.parent.getStartEndTime(this.parent.workHours.start);\n    const end = this.parent.getStartEndTime(this.parent.workHours.end);\n\n    for (let i = 0; i < length; i++) {\n      let dt = new Date(msStartHour + msInterval * i);\n\n      if (isDaylightSavingTime(dt) || new Date(msStartHour).getTimezoneOffset() !== dt.getTimezoneOffset()) {\n        const timeOffset = new Date(msStartHour).getTimezoneOffset() - dt.getTimezoneOffset();\n        dt = new Date(dt.getTime() - 1000 * 60 * timeOffset);\n      }\n\n      const majorTickDivider = i % (msMajorInterval / msInterval);\n      const row = {\n        date: new Date('' + dt),\n        startHour: start,\n        endHour: end,\n        first: majorTickDivider === 0,\n        middle: majorTickDivider < this.parent.activeViewOptions.timeScale.slotCount - 1,\n        last: majorTickDivider === this.parent.activeViewOptions.timeScale.slotCount - 1,\n        type: ''\n      };\n\n      if (handler) {\n        handler(row);\n      }\n\n      rows.push(row);\n    }\n\n    return rows;\n  }\n\n  getAdjustedDate(startTime) {\n    if (!this.parent.activeViewOptions.timeScale.enable) {\n      return new Date(startTime.setHours(0, 0, 0, 0));\n    } else {\n      const timeSlots = this.getTimeSlotRows();\n      const startDate = new Date(new Date(timeSlots[0].date.getTime()).setHours(startTime.getHours(), startTime.getMinutes(), startTime.getMilliseconds()));\n\n      for (let i = 0; i < timeSlots.length; i++) {\n        if (timeSlots[i].date.getTime() > startDate.getTime()) {\n          startTime.setHours(timeSlots[i - 1].date.getHours(), timeSlots[i - 1].date.getMinutes(), timeSlots[i - 1].date.getMilliseconds());\n          return new Date(startTime);\n        }\n      }\n    }\n\n    return null;\n  }\n\n  destroy() {\n    if (!this.parent || this.parent && this.parent.isDestroyed) {\n      return;\n    }\n\n    this.clearCurrentTimeIndicatorTimer();\n\n    if (this.element) {\n      if (this.appointment) {\n        this.appointment.destroy();\n        this.appointment = null;\n      }\n\n      const contentScrollableEle = this.getContentAreaElement();\n\n      if (contentScrollableEle) {\n        EventHandler.remove(contentScrollableEle, 'scroll', this.onContentScroll);\n        EventHandler.remove(contentScrollableEle, Browser.touchMoveEvent, this.onAdaptiveMove);\n      }\n\n      if (this.parent.resourceBase) {\n        this.parent.resourceBase.destroy();\n      }\n\n      if (this.parent.scheduleTouchModule) {\n        this.parent.scheduleTouchModule.resetValues();\n      }\n\n      super.destroy();\n    }\n  }\n\n}\n/**\n * day view\n */\n\n\nclass Day extends VerticalView {\n  /**\n   * Constructor for day view\n   *\n   * @param {Schedule} parent Accepts the schedule instance\n   */\n  constructor(parent) {\n    super(parent);\n    this.viewClass = 'e-day-view';\n  }\n  /**\n   * Get module name.\n   *\n   * @returns {string} Returns the module name.\n   */\n\n\n  getModuleName() {\n    return 'day';\n  }\n\n}\n/**\n * week view\n */\n\n\nclass Week extends VerticalView {\n  /**\n   * Constructor for week view\n   *\n   * @param {Schedule} parent Accepts the schedule instance\n   */\n  constructor(parent) {\n    super(parent);\n    this.viewClass = 'e-week-view';\n  }\n\n  startDate() {\n    return this.getViewStartDate();\n  }\n\n  endDate() {\n    return this.getViewEndDate();\n  }\n  /**\n   * Get module name.\n   *\n   * @returns {string} Returns the module name.\n   */\n\n\n  getModuleName() {\n    return 'week';\n  }\n\n}\n/**\n * work week view\n */\n\n\nclass WorkWeek extends VerticalView {\n  /**\n   * Constructor for work week view\n   *\n   * @param {Schedule} parent Accepts the schedule instance\n   */\n  constructor(parent) {\n    super(parent);\n    this.viewClass = 'e-work-week-view';\n  }\n\n  startDate() {\n    return this.getViewStartDate();\n  }\n\n  endDate() {\n    return this.getViewEndDate();\n  }\n  /**\n   * Get module name.\n   *\n   * @returns {string} Returns the module name.\n   */\n\n\n  getModuleName() {\n    return 'workWeek';\n  }\n\n}\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\n/**\n * month view\n */\n\n\nclass Month extends ViewBase {\n  constructor(parent) {\n    super(parent);\n    this.dayNameFormat = 'wide';\n    this.viewClass = 'e-month-view';\n    this.isInverseTableSelect = false;\n    this.monthEvent = null;\n    this.monthDates = {};\n  }\n\n  addEventListener() {\n    this.parent.on(scrollUiUpdate, this.onScrollUIUpdate, this);\n    this.parent.on(dataReady, this.onDataReady, this);\n    this.parent.on(cellClick, this.onCellClick, this);\n  }\n\n  removeEventListener() {\n    if (this.parent) {\n      this.parent.off(scrollUiUpdate, this.onScrollUIUpdate);\n      this.parent.off(dataReady, this.onDataReady);\n      this.parent.off(cellClick, this.onCellClick);\n    }\n  } // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  onDataReady(args) {\n    this.monthEvent = new MonthEvent(this.parent);\n    this.monthEvent.renderAppointments();\n    this.parent.notify(eventsLoaded, {});\n  } // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  onCellClick(event) {}\n\n  onContentScroll(e) {\n    this.parent.removeNewEventElement();\n    this.parent.notify(virtualScroll, e);\n    this.scrollTopPanel(e.target);\n    this.scrollLeftPanel(e.target);\n    this.parent.uiStateValues.top = e.target.scrollTop;\n    this.parent.uiStateValues.left = e.target.scrollLeft;\n    this.setPersistence();\n  }\n\n  scrollLeftPanel(target) {\n    const leftPanel = this.getLeftPanelElement();\n\n    if (leftPanel) {\n      leftPanel.scrollTop = target.scrollTop;\n    }\n  }\n\n  getLeftPanelElement() {\n    return this.element.querySelector('.' + WEEK_NUMBER_WRAPPER_CLASS);\n  }\n\n  onScrollUIUpdate(args) {\n    const headerHeight = this.getHeaderBarHeight();\n    const header = this.getDatesHeaderElement();\n    const content = this.getContentAreaElement();\n    const height = this.parent.element.offsetHeight - headerHeight - header.offsetHeight;\n    const leftPanel = this.getLeftPanelElement();\n\n    if (this.parent.height !== 'auto') {\n      this.setContentHeight(content, leftPanel, height);\n    }\n\n    const scrollBarWidth = getScrollBarWidth();\n    header.firstElementChild.style[args.cssProperties.rtlBorder] = '';\n    header.style[args.cssProperties.rtlPadding] = '';\n\n    if (content.offsetWidth - content.clientWidth > 0) {\n      header.firstElementChild.style[args.cssProperties.border] = scrollBarWidth > 0 ? '1px' : '0px';\n      header.style[args.cssProperties.padding] = scrollBarWidth > 0 ? scrollBarWidth - 1 + 'px' : '0px';\n    } else {\n      header.firstElementChild.style[args.cssProperties.border] = '';\n      header.style[args.cssProperties.padding] = '';\n    }\n\n    this.setColWidth(content);\n\n    if (args.scrollPosition || !args.isPreventScrollUpdate && this.parent.currentView === 'TimelineMonth') {\n      const top = this.parent.currentView === 'TimelineMonth' ? this.parent.uiStateValues.top : args.scrollPosition.top;\n\n      if (leftPanel) {\n        leftPanel.scrollTop = top;\n      }\n\n      content.scrollTop = top;\n\n      if (this.parent.uiStateValues.isInitial) {\n        this.scrollToSelectedDate();\n        this.parent.uiStateValues.isInitial = false;\n      } else {\n        content.scrollLeft = this.parent.currentView === 'TimelineMonth' ? this.parent.uiStateValues.left : args.scrollPosition.left;\n      }\n    } else {\n      this.scrollToSelectedDate();\n    }\n\n    this.retainScrollPosition();\n  }\n\n  scrollToSelectedDate() {\n    const headerCell = this.element.querySelector('.' + HEADER_CELLS_CLASS + '[data-date=\"' + this.parent.selectedDate.getTime().toString() + '\"]');\n    const content = this.getContentAreaElement();\n\n    if (!isNullOrUndefined(headerCell)) {\n      content.scrollLeft = !this.parent.enableRtl ? headerCell.offsetLeft : -(this.parent.getContentTable().offsetWidth - headerCell.offsetLeft - headerCell.offsetWidth);\n    } else {\n      content.scrollLeft = 0;\n    }\n\n    if (content.scrollLeft === 0 && this.parent.uiStateValues.isInitial) {\n      this.parent.uiStateValues.left = 0;\n    }\n  }\n\n  setContentHeight(content, leftPanelElement, height) {\n    content.style.height = 'auto';\n\n    if (this.parent.currentView === 'Month') {\n      content.style.height = formatUnit(height);\n    }\n\n    if (leftPanelElement) {\n      if (this.parent.currentView === 'MonthAgenda') {\n        height = this.element.querySelector('.' + CONTENT_TABLE_CLASS).offsetHeight;\n      }\n\n      leftPanelElement.style.height = 'auto';\n      leftPanelElement.style.height = formatUnit(height - this.getScrollXIndent(content));\n    }\n  }\n\n  generateColumnLevels() {\n    let colLevels = [];\n    const level = this.getDateSlots(this.renderDates, this.parent.activeViewOptions.workDays);\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      colLevels = this.parent.resourceBase.generateResourceLevels(level);\n\n      if (this.parent.currentView === 'MonthAgenda') {\n        colLevels = [level];\n      }\n\n      if (this.parent.uiStateValues.isGroupAdaptive && this.parent.resourceBase.lastResourceLevel.length > 0) {\n        const resourceLevel = this.parent.resourceBase.lastResourceLevel[this.parent.uiStateValues.groupIndex];\n        colLevels = [this.getDateSlots(resourceLevel.renderDates, resourceLevel.workDays)];\n      }\n    } else {\n      colLevels.push(level);\n    }\n\n    this.colLevels = colLevels;\n    return colLevels;\n  }\n\n  getDateSlots(renderDates, workDays) {\n    const count = this.parent.activeViewOptions.showWeekend ? WEEK_LENGTH : workDays.length;\n    const dateSlots = [];\n    const isCurrentMonth = this.isCurrentMonth(this.parent.selectedDate);\n\n    for (let col = 0; col < count; col++) {\n      const classList$$1 = [HEADER_CELLS_CLASS];\n      const currentDateIndex = renderDates.slice(0, count).map(date => date.getDay());\n\n      if (isCurrentMonth && currentDateIndex.indexOf(this.parent.getCurrentTime().getDay()) === col) {\n        classList$$1.push(CURRENT_DAY_CLASS);\n      }\n\n      dateSlots.push({\n        date: renderDates[col],\n        type: 'monthDay',\n        className: classList$$1,\n        colSpan: 1,\n        workDays: workDays\n      });\n    }\n\n    return dateSlots;\n  }\n\n  getDayNameFormat() {\n    if (this.parent.isAdaptive || this.parent.activeViewOptions.group.resources.length > 0) {\n      return 'abbreviated';\n    }\n\n    return 'wide';\n  }\n\n  renderLayout(type) {\n    this.dayNameFormat = this.getDayNameFormat();\n    this.setPanel(createElement('div', {\n      className: TABLE_WRAP_CLASS\n    }));\n    const clsList = [this.viewClass];\n    clsList.push(type);\n\n    if (this.parent.activeViewOptions.group.byDate) {\n      clsList.push('e-by-date');\n    }\n\n    if (this.parent.activeViewOptions.allowVirtualScrolling) {\n      clsList.push(VIRTUAL_SCROLL_CLASS);\n    }\n\n    if (this.parent.rowAutoHeight && this.parent.eventSettings.ignoreWhitespace) {\n      clsList.push(IGNORE_WHITESPACE);\n    }\n\n    addClass([this.element], clsList);\n    this.renderPanel(type);\n    this.element.appendChild(this.createTableLayout(OUTER_TABLE_CLASS));\n    this.element.querySelector('table').setAttribute('role', 'presentation');\n    this.colLevels = this.generateColumnLevels();\n    this.renderHeader();\n    this.renderContent();\n    const target = this.parent.currentView === 'MonthAgenda' ? this.parent.activeView.getPanel() : this.parent.element;\n\n    if (this.parent.uiStateValues.isGroupAdaptive && !target.querySelector('.' + RESOURCE_TOOLBAR_CONTAINER)) {\n      this.renderResourceMobileLayout();\n    }\n\n    this.parent.notify(contentReady, {});\n\n    if (this.parent.uiStateValues.isCustomMonth) {\n      this.parent.uiStateValues.isCustomMonth = false;\n    }\n  }\n\n  refreshHeader() {\n    remove(this.element.querySelector('tbody tr'));\n    this.renderHeader();\n    this.parent.notify(contentReady, {});\n  }\n\n  wireCellEvents(element) {\n    EventHandler.add(element, 'mousedown', this.parent.workCellAction.cellMouseDown, this.parent.workCellAction);\n    EventHandler.add(element, 'click', this.parent.workCellAction.cellClick, this.parent.workCellAction);\n\n    if (!this.parent.isAdaptive) {\n      EventHandler.add(element, 'dblclick', this.parent.workCellAction.cellDblClick, this.parent.workCellAction);\n    }\n  }\n\n  renderHeader() {\n    const tr = createElement('tr');\n    this.renderLeftIndent(tr);\n    const dateTd = createElement('td');\n    dateTd.appendChild(this.renderDatesHeader());\n    tr.appendChild(dateTd);\n    prepend([tr], this.element.querySelector('tbody'));\n  }\n\n  renderLeftIndent(tr) {\n    if (this.parent.activeViewOptions.showWeekNumber) {\n      tr.appendChild(createElement('td', {\n        className: 'e-left-indent'\n      }));\n    }\n  }\n\n  renderContent() {\n    const tr = createElement('tr');\n\n    if (this.parent.activeViewOptions.showWeekNumber) {\n      tr.appendChild(this.renderWeekNumberContent());\n    }\n\n    const workTd = createElement('td');\n    const wrap = createElement('div', {\n      className: CONTENT_WRAP_CLASS\n    });\n    const contentArea = this.renderContentArea();\n\n    if (this.parent.currentView === 'Month') {\n      wrap.appendChild(contentArea);\n    } else {\n      const monthAgendaWrapper = createElement('div', {\n        className: TABLE_CONTAINER_CLASS\n      });\n      monthAgendaWrapper.appendChild(contentArea);\n      wrap.appendChild(monthAgendaWrapper);\n    }\n\n    EventHandler.add(wrap, 'scroll', this.onContentScroll, this);\n    workTd.appendChild(wrap);\n    tr.appendChild(workTd);\n    this.element.querySelector('tbody').appendChild(tr);\n    this.renderAppointmentContainer();\n  }\n\n  renderWeekNumberContent() {\n    const dateCol = this.renderDates.map(date => new Date(+date));\n    const td = createElement('td');\n    const contentWrapper = createElement('div', {\n      className: WEEK_NUMBER_WRAPPER_CLASS\n    });\n    td.appendChild(contentWrapper);\n    const contentWrapTable = this.createTableLayout();\n    contentWrapper.appendChild(contentWrapTable);\n    const noOfDays = this.parent.activeViewOptions.showWeekend ? WEEK_LENGTH : this.parent.activeViewOptions.workDays.length;\n\n    for (let i = 0, length = this.renderDates.length / noOfDays; i < length; i++) {\n      const dates = dateCol.splice(0, noOfDays);\n      const weekNumber = this.parent.getWeekNumberContent(dates);\n      contentWrapTable.querySelector('tbody').appendChild(this.createWeekNumberElement(weekNumber));\n    }\n\n    return td;\n  }\n\n  renderAppointmentContainer() {//Here needs to render mobile view appointment details on selected date\n  }\n\n  renderDatesHeader() {\n    const container = createElement('div', {\n      className: DATE_HEADER_CONTAINER_CLASS\n    });\n    const wrap = createElement('div', {\n      className: DATE_HEADER_WRAP_CLASS\n    });\n    container.appendChild(wrap);\n    const table = this.createTableLayout();\n    this.createColGroup(table, this.colLevels[this.colLevels.length - 1]);\n    const trEle = createElement('tr');\n\n    for (let i = 0; i < this.colLevels.length; i++) {\n      const level = this.colLevels[i];\n      const ntr = trEle.cloneNode();\n\n      for (let j = 0; j < level.length; j++) {\n        const td = level[j];\n        ntr.appendChild(this.createHeaderCell(td));\n      }\n\n      table.querySelector('tbody').appendChild(ntr);\n    }\n\n    wrap.appendChild(table);\n    return container;\n  }\n\n  createHeaderCell(td) {\n    const tdEle = createElement('td');\n    this.addAttributes(td, tdEle);\n\n    if (td.type === 'monthDay') {\n      const ele = createElement('span', {\n        innerHTML: capitalizeFirstWord(this.parent.getDayNames(this.dayNameFormat)[td.date.getDay()], 'single')\n      });\n      tdEle.appendChild(ele);\n    }\n\n    if (td.type === 'resourceHeader') {\n      this.setResourceHeaderContent(tdEle, td);\n    }\n\n    if (td.type === 'dateHeader') {\n      addClass([tdEle], DATE_HEADER_CLASS);\n      tdEle.setAttribute('data-date', td.date.getTime().toString());\n\n      if (this.parent.activeViewOptions.dateHeaderTemplate) {\n        const cellArgs = {\n          date: td.date,\n          type: td.type\n        };\n        const elementId = this.parent.element.id + '_';\n        const viewName = this.parent.activeViewOptions.dateHeaderTemplateName;\n        const templateId = elementId + viewName + 'dateHeaderTemplate';\n        const dateTemplate = [].slice.call(this.parent.getDateHeaderTemplate()(cellArgs, this.parent, 'dateHeaderTemplate', templateId, false));\n\n        if (dateTemplate && dateTemplate.length) {\n          append(dateTemplate, tdEle);\n        }\n      } else {\n        const ele = createElement('span', {\n          className: NAVIGATE_CLASS\n        });\n        const skeleton = 'full';\n        const title = this.parent.globalize.formatDate(td.date, {\n          skeleton: skeleton,\n          calendar: this.parent.getCalendarMode()\n        });\n        ele.setAttribute('title', capitalizeFirstWord(title, 'multiple'));\n        const innerText = this.parent.calendarUtil.isMonthStart(td.date) && !this.isCurrentDate(td.date) && !this.parent.isAdaptive ? this.parent.globalize.formatDate(td.date, {\n          format: 'MMM d',\n          calendar: this.parent.getCalendarMode()\n        }) : this.parent.globalize.formatDate(td.date, {\n          skeleton: 'd',\n          calendar: this.parent.getCalendarMode()\n        });\n        ele.innerHTML = capitalizeFirstWord(innerText, 'single');\n        tdEle.appendChild(ele);\n      }\n\n      this.wireCellEvents(tdEle);\n    }\n\n    const args = {\n      elementType: td.type,\n      element: tdEle,\n      date: td.date,\n      groupIndex: td.groupIndex\n    };\n    this.parent.trigger(renderCell, args);\n    return tdEle;\n  }\n\n  getContentSlots() {\n    if (!(this.colLevels[this.colLevels.length - 1] && this.colLevels[this.colLevels.length - 1][0])) {\n      return [];\n    }\n\n    const slotDatas = [];\n\n    const prepareSlots = (rowIndex, renderDate, resData, classList$$1) => {\n      const data = {\n        date: new Date(+renderDate),\n        groupIndex: resData.groupIndex,\n        workDays: resData.workDays,\n        type: 'monthCells',\n        className: classList$$1 || [WORK_CELLS_CLASS]\n      };\n\n      if (!slotDatas[rowIndex]) {\n        slotDatas[rowIndex] = [];\n      }\n\n      slotDatas[rowIndex].push(data);\n    };\n\n    const includeResource = this.parent.currentView !== 'MonthAgenda' && this.parent.activeViewOptions.group.resources.length > 0;\n\n    if (includeResource && !this.parent.uiStateValues.isGroupAdaptive && !this.parent.activeViewOptions.group.byDate) {\n      for (const res of this.colLevels[this.colLevels.length - 2]) {\n        const dates = res.renderDates.map(date => new Date(+date));\n        const count = this.parent.activeViewOptions.showWeekend ? WEEK_LENGTH : res.workDays.length;\n\n        for (let i = 0; i < res.renderDates.length / count; i++) {\n          const colDates = dates.splice(0, count);\n\n          for (const colDate of colDates) {\n            prepareSlots(i, colDate, res);\n          }\n        }\n      }\n    } else {\n      const dates = this.renderDates.map(date => new Date(+date));\n      const count = this.parent.activeViewOptions.showWeekend ? WEEK_LENGTH : this.parent.activeViewOptions.workDays.length;\n\n      for (let i = 0; i < this.renderDates.length / count; i++) {\n        const colDates = dates.splice(0, count);\n\n        for (const colDate of colDates) {\n          if (includeResource) {\n            const lastRow = this.colLevels[this.colLevels.length - 1];\n            const resourcesTd = lastRow.slice(0, lastRow.length / count);\n\n            for (let resIndex = 0; resIndex < resourcesTd.length; resIndex++) {\n              let clsList;\n\n              if (resIndex !== 0) {\n                clsList = [WORK_CELLS_CLASS, DISABLE_DATE];\n              }\n\n              prepareSlots(i, colDate, resourcesTd[resIndex], clsList);\n            }\n          } else {\n            prepareSlots(i, colDate, this.colLevels[this.colLevels.length - 1][0]);\n          }\n        }\n      }\n    }\n\n    return slotDatas;\n  }\n\n  updateClassList(data) {\n    if (!this.isCustomMonth() && this.isOtherMonth(data.date)) {\n      data.className.push(OTHERMONTH_CLASS);\n    }\n\n    if (!this.parent.isMinMaxDate(data.date)) {\n      data.className.push(DISABLE_DATES);\n    }\n\n    if (this.parent.currentView === 'MonthAgenda' && this.parent.isSelectedDate(data.date)) {\n      data.className.push(SELECTED_CELL_CLASS);\n    }\n  }\n\n  isOtherMonth(date) {\n    return date.getTime() < this.monthDates.start.getTime() || date.getTime() > this.monthDates.end.getTime();\n  }\n\n  renderContentArea() {\n    const tbl = this.createTableLayout(CONTENT_TABLE_CLASS);\n    this.addAutoHeightClass(tbl);\n\n    if (this.parent.currentView === 'TimelineMonth') {\n      this.createColGroup(tbl, this.colLevels[this.colLevels.length - 1]);\n    }\n\n    const monthDate = new Date(this.parent.selectedDate.getTime());\n    this.monthDates = {\n      start: this.parent.calendarUtil.firstDateOfMonth(monthDate),\n      end: this.parent.calendarUtil.lastDateOfMonth(addMonths(monthDate, this.parent.activeViewOptions.interval - 1))\n    };\n    const tBody = tbl.querySelector('tbody');\n    append(this.getContentRows(), tBody);\n    this.wireCellEvents(tBody);\n    return tbl;\n  }\n\n  getContentRows() {\n    const trows = [];\n    const tr = createElement('tr', {\n      attrs: {\n        role: 'row'\n      }\n    });\n    const td = createElement('td', {\n      attrs: {\n        role: 'gridcell',\n        'aria-selected': 'false'\n      }\n    });\n    const slotDatas = this.getContentSlots();\n\n    for (let row = 0; row < slotDatas.length; row++) {\n      const ntr = tr.cloneNode();\n\n      for (let col = 0; col < slotDatas[row].length; col++) {\n        const ntd = this.createContentTd(slotDatas[row][col], td);\n        ntr.appendChild(ntd);\n      }\n\n      trows.push(ntr);\n    }\n\n    return trows;\n  }\n\n  createContentTd(data, td) {\n    const ntd = td.cloneNode();\n\n    if (data.colSpan) {\n      ntd.setAttribute('colspan', data.colSpan.toString());\n    }\n\n    this.updateClassList(data);\n    let type = data.type;\n\n    if (data.className.indexOf(RESOURCE_PARENT_CLASS) !== -1) {\n      data.className.push(RESOURCE_GROUP_CELLS_CLASS);\n      type = 'resourceGroupCells';\n    }\n\n    if (this.parent.workHours.highlight && this.isWorkDay(data.date, data.workDays)) {\n      data.className.push(WORKDAY_CLASS);\n    }\n\n    if (this.isCurrentDate(data.date)) {\n      data.className.push(CURRENTDATE_CLASS);\n    }\n\n    addClass([ntd], data.className);\n    ntd.setAttribute('data-date', data.date.getTime().toString());\n\n    if (!isNullOrUndefined(data.groupIndex) || this.parent.uiStateValues.isGroupAdaptive) {\n      const groupIndex = this.parent.uiStateValues.isGroupAdaptive ? this.parent.uiStateValues.groupIndex : data.groupIndex;\n      ntd.setAttribute('data-group-index', '' + groupIndex);\n    }\n\n    this.renderDateHeaderElement(data, ntd);\n\n    if (this.parent.activeViewOptions.cellTemplate) {\n      const args = {\n        date: data.date,\n        type: type,\n        groupIndex: data.groupIndex\n      };\n      const scheduleId = this.parent.element.id + '_';\n      const viewName = this.parent.activeViewOptions.cellTemplateName;\n      const templateId = scheduleId + viewName + 'cellTemplate';\n      const cellTemplate = [].slice.call(this.parent.getCellTemplate()(args, this.parent, 'cellTemplate', templateId, false));\n      append(cellTemplate, ntd);\n    }\n\n    const args = {\n      elementType: type,\n      element: ntd,\n      date: data.date,\n      groupIndex: data.groupIndex\n    };\n    this.parent.trigger(renderCell, args);\n    return ntd;\n  }\n\n  renderDateHeaderElement(data, ntd) {\n    if (this.parent.currentView === 'TimelineMonth') {\n      return;\n    }\n\n    const dateHeader = createElement('div', {\n      className: DATE_HEADER_CLASS\n    });\n\n    if (this.parent.activeViewOptions.cellHeaderTemplate) {\n      const args = {\n        date: data.date,\n        type: data.type,\n        groupIndex: data.groupIndex\n      };\n      const scheduleId = this.parent.element.id + '_';\n      const viewName = this.parent.activeViewOptions.cellHeaderTemplateName;\n      const templateId = scheduleId + viewName + 'cellHeaderTemplate';\n      const cellHeaderTemplate = [].slice.call(this.parent.getCellHeaderTemplate()(args, this.parent, 'cellHeaderTemplate', templateId, false));\n      append(cellHeaderTemplate, dateHeader);\n    } else {\n      const innerText = this.parent.calendarUtil.isMonthStart(data.date) && !this.isCurrentDate(data.date) && !this.parent.isAdaptive ? this.parent.globalize.formatDate(data.date, {\n        format: 'MMM d',\n        calendar: this.parent.getCalendarMode()\n      }) : this.parent.globalize.formatDate(data.date, {\n        skeleton: 'd',\n        calendar: this.parent.getCalendarMode()\n      });\n      dateHeader.innerHTML = capitalizeFirstWord(innerText, 'single');\n    }\n\n    ntd.appendChild(dateHeader);\n\n    if (this.getModuleName() === 'month') {\n      addClass([dateHeader], NAVIGATE_CLASS);\n      const skeleton = 'full';\n      const announcementText = this.parent.globalize.formatDate(data.date, {\n        skeleton: skeleton,\n        calendar: this.parent.getCalendarMode()\n      });\n      dateHeader.setAttribute('aria-label', announcementText);\n    }\n  }\n\n  getMonthStart(currentDate) {\n    const useDisplayDate = this.parent.currentView === 'Month' && !isNullOrUndefined(this.parent.activeViewOptions.displayDate) && (this.parent.uiStateValues.isCustomMonth || this.isCustomRange());\n    const date = useDisplayDate ? this.parent.activeViewOptions.displayDate : !(this.parent.uiStateValues.isCustomMonth || this.isCustomRange()) && this.isCustomMonth() ? currentDate : this.parent.calendarUtil.firstDateOfMonth(currentDate);\n    const monthStart = getWeekFirstDate(date, this.parent.activeViewOptions.firstDayOfWeek);\n    return new Date(monthStart.getFullYear(), monthStart.getMonth(), monthStart.getDate());\n  }\n\n  getMonthEnd(currentDate) {\n    if (this.isCustomMonth()) {\n      const start = this.getMonthStart(currentDate);\n      const numberOfDays = WEEK_LENGTH * (this.parent.activeViewOptions.numberOfWeeks > 0 ? this.parent.activeViewOptions.numberOfWeeks : DEFAULT_WEEKS);\n      return addDays(start, numberOfDays - 1);\n    } else {\n      const endDate = addMonths(currentDate, this.parent.activeViewOptions.interval - 1);\n      const lastWeekOfMonth = getWeekFirstDate(this.parent.calendarUtil.lastDateOfMonth(endDate), this.parent.activeViewOptions.firstDayOfWeek);\n      return addDays(lastWeekOfMonth, WEEK_LENGTH - 1);\n    }\n  }\n\n  isCustomRange() {\n    const dates = this.parent.getCurrentViewDates();\n\n    if (dates && dates.length > 0) {\n      const selectedTime = resetTime(this.parent.selectedDate).getTime();\n      const weekFirstDate = getWeekFirstDate(dates[dates.length - 1], this.parent.activeViewOptions.firstDayOfWeek);\n      return !(selectedTime >= getWeekFirstDate(dates[0], this.parent.activeViewOptions.firstDayOfWeek).getTime() && selectedTime <= addDays(weekFirstDate, 6).getTime());\n    }\n\n    return false;\n  }\n\n  getRenderDates(workDays) {\n    const renderDates = [];\n    const currentDate = resetTime(this.parent.selectedDate);\n    let start = this.getMonthStart(currentDate);\n    const monthEnd = this.getMonthEnd(currentDate);\n\n    do {\n      if (this.parent.activeViewOptions.showWeekend) {\n        renderDates.push(start);\n      } else {\n        if (this.isWorkDay(start, workDays)) {\n          renderDates.push(start);\n        }\n      }\n\n      start = addDays(start, 1);\n\n      if (start.getHours() > 0) {\n        start = resetTime(start);\n      }\n    } while (start.getTime() <= monthEnd.getTime());\n\n    if (!workDays) {\n      this.renderDates = renderDates;\n    }\n\n    if (this.parent.headerModule) {\n      this.parent.headerModule.previousNextIconHandler();\n    }\n\n    return renderDates;\n  }\n\n  getNextPreviousDate(type) {\n    if (this.isCustomMonth()) {\n      const dates = this.parent.getCurrentViewDates();\n      const date = getWeekFirstDate(type === 'next' ? dates[dates.length - 1] : dates[0], this.parent.activeViewOptions.firstDayOfWeek);\n      return addDays(date, type === 'next' ? WEEK_LENGTH : -(this.parent.activeViewOptions.numberOfWeeks > 0 ? this.parent.activeViewOptions.numberOfWeeks : DEFAULT_WEEKS) * WEEK_LENGTH);\n    } else {\n      return addMonths(this.parent.selectedDate, (type === 'next' ? 1 : -1) * this.parent.activeViewOptions.interval);\n    }\n  }\n\n  getStartDate() {\n    return this.getMonthStart(this.parent.selectedDate);\n  }\n\n  getEndDate() {\n    return this.getMonthEnd(this.parent.selectedDate);\n  }\n\n  getEndDateFromStartDate(start) {\n    return addDays(new Date(start.getTime()), 1);\n  }\n\n  getDateRangeText() {\n    if (this.parent.isAdaptive || isNullOrUndefined(this.parent.activeViewOptions.dateFormat)) {\n      let startDate = this.parent.selectedDate;\n      let endDate;\n      let updateCustomRange = false;\n\n      if (this.isCustomMonth()) {\n        const dates = this.parent.getCurrentViewDates();\n        updateCustomRange = dates[0].getMonth() !== dates[dates.length - 1].getMonth() || dates[0].getFullYear() !== dates[dates.length - 1].getFullYear();\n\n        if (updateCustomRange) {\n          startDate = dates[0];\n          endDate = dates[dates.length - 1];\n        }\n      }\n\n      const isUpdateDateRange = this.parent.currentView !== 'Month' || !this.isCustomMonth();\n\n      if (this.parent.activeViewOptions.interval > 1 && isUpdateDateRange || updateCustomRange) {\n        endDate = endDate ? endDate : addMonths(lastDateOfMonth(startDate), this.parent.activeViewOptions.interval - 1);\n\n        if (startDate.getFullYear() === endDate.getFullYear()) {\n          const monthNames = this.parent.globalize.formatDate(startDate, {\n            format: 'MMMM',\n            calendar: this.parent.getCalendarMode()\n          }) + ' - ' + this.parent.globalize.formatDate(endDate, {\n            format: 'MMMM ',\n            calendar: this.parent.getCalendarMode()\n          }) + this.parent.globalize.formatDate(endDate, {\n            skeleton: 'y',\n            calendar: this.parent.getCalendarMode()\n          });\n          return capitalizeFirstWord(monthNames, 'single');\n        }\n\n        const text = this.parent.globalize.formatDate(startDate, {\n          format: 'MMMM',\n          calendar: this.parent.getCalendarMode()\n        }) + ' ' + startDate.getFullYear() + ' - ' + this.parent.globalize.formatDate(endDate, {\n          format: 'MMMM ',\n          calendar: this.parent.getCalendarMode()\n        }) + this.parent.globalize.formatDate(endDate, {\n          skeleton: 'y',\n          calendar: this.parent.getCalendarMode()\n        });\n        return capitalizeFirstWord(text, 'single');\n      }\n\n      const format = this.parent.activeViewOptions.dateFormat ? this.parent.activeViewOptions.dateFormat : 'MMMM y';\n      return capitalizeFirstWord(this.parent.globalize.formatDate(startDate, {\n        format: format,\n        calendar: this.parent.getCalendarMode()\n      }), 'single');\n    }\n\n    return this.formatDateRange(this.parent.selectedDate);\n  }\n\n  getLabelText(view) {\n    return this.parent.localeObj.getConstant(view) + ' of ' + capitalizeFirstWord(this.parent.globalize.formatDate(this.parent.selectedDate, {\n      format: 'MMMM y',\n      calendar: this.parent.getCalendarMode()\n    }), 'single');\n  }\n\n  createWeekNumberElement(text) {\n    const tr = createElement('tr');\n    const td = createElement('td', {\n      className: WEEK_NUMBER_CLASS,\n      attrs: {\n        'title': text ? this.parent.localeObj.getConstant('week') + ' ' + text : ''\n      },\n      innerHTML: text || ''\n    });\n    tr.appendChild(td);\n    const args = {\n      elementType: 'weekNumberCell',\n      element: td\n    };\n    this.parent.trigger(renderCell, args);\n    return tr;\n  }\n\n  unWireEvents() {\n    const contentScrollableEle = this.element.querySelector('.' + CONTENT_WRAP_CLASS);\n\n    if (contentScrollableEle) {\n      EventHandler.remove(contentScrollableEle, 'scroll', this.onContentScroll);\n    }\n  }\n\n  isCustomMonth() {\n    return this.parent.currentView === 'Month' && (!isNullOrUndefined(this.parent.activeViewOptions.displayDate) || this.parent.activeViewOptions.numberOfWeeks > 0);\n  }\n\n  getModuleName() {\n    return 'month';\n  }\n\n  destroy() {\n    if (!this.parent || this.parent && this.parent.isDestroyed) {\n      return;\n    }\n\n    if (this.element) {\n      if (this.monthEvent) {\n        this.monthEvent.destroy();\n        this.monthEvent = null;\n      }\n\n      this.unWireEvents();\n\n      if (this.parent.resourceBase) {\n        this.parent.resourceBase.destroy();\n      }\n\n      if (this.parent.scheduleTouchModule) {\n        this.parent.scheduleTouchModule.resetValues();\n      }\n\n      super.destroy();\n    }\n  }\n\n}\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\n/**\n * year view\n */\n\n\nclass Year extends ViewBase {\n  constructor(parent) {\n    super(parent);\n    this.viewClass = 'e-year-view';\n    this.isInverseTableSelect = false;\n    this.yearEventModule = null;\n  }\n\n  getModuleName() {\n    return 'year';\n  }\n\n  renderLayout(className) {\n    if (this.parent.resourceBase) {\n      this.parent.resourceBase.generateResourceLevels([{\n        renderDates: this.parent.activeView.renderDates\n      }]);\n    }\n\n    this.setPanel(createElement('div', {\n      className: TABLE_WRAP_CLASS\n    }));\n    const viewTypeClass = this.parent.activeViewOptions.orientation === 'Horizontal' ? 'e-horizontal' : 'e-vertical';\n    addClass([this.element], [this.viewClass, viewTypeClass, className]);\n    this.renderPanel(className);\n\n    if (this.parent.activeViewOptions.allowVirtualScrolling) {\n      addClass([this.element], [VIRTUAL_SCROLL_CLASS]);\n    }\n\n    const calendarTable = this.createTableLayout(OUTER_TABLE_CLASS);\n    this.element.appendChild(calendarTable);\n    this.element.querySelector('table').setAttribute('role', 'presentation');\n    const calendarTBody = calendarTable.querySelector('tbody');\n    this.rowCount = this.getRowColumnCount('row');\n    this.columnCount = this.getRowColumnCount('column');\n    this.renderHeader(calendarTBody);\n    this.renderContent(calendarTBody);\n\n    if (this.parent.currentView !== 'Year' && this.parent.uiStateValues.isGroupAdaptive) {\n      this.generateColumnLevels();\n      this.renderResourceMobileLayout();\n    }\n\n    this.wireEvents(this.element.querySelector('.' + CONTENT_WRAP_CLASS), 'scroll');\n    this.parent.notify(contentReady, {});\n  } // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  renderHeader(headerWrapper) {}\n\n  renderContent(content) {\n    const tr = createElement('tr');\n    content.appendChild(tr);\n    const td = createElement('td');\n    tr.appendChild(td);\n    this.element.querySelector('tbody').appendChild(tr);\n    const contentWrapper = createElement('div', {\n      className: CONTENT_WRAP_CLASS\n    });\n    td.appendChild(contentWrapper);\n    const calendarTable = this.createTableLayout('e-calendar-table');\n    contentWrapper.appendChild(calendarTable);\n    const cTr = createElement('tr');\n    calendarTable.querySelector('tbody').appendChild(cTr);\n    const cTd = createElement('td');\n    cTr.appendChild(cTd);\n    const calendarWrapper = createElement('div', {\n      className: 'e-calendar-wrapper'\n    });\n    cTd.appendChild(calendarWrapper);\n    const months = this.getMonths();\n\n    for (const month of months) {\n      const currentMonth = new Date(this.parent.selectedDate.getFullYear(), month, 1);\n      const calendarElement = createElement('div', {\n        className: 'e-month-calendar e-calendar',\n        attrs: {\n          'data-role': 'calendar'\n        }\n      });\n      calendarElement.appendChild(this.renderCalendarHeader(currentMonth));\n      calendarElement.appendChild(this.renderCalendarContent(currentMonth));\n      calendarWrapper.appendChild(calendarElement);\n    }\n  }\n\n  renderCalendarHeader(currentDate) {\n    const headerWrapper = createElement('div', {\n      className: 'e-header e-month'\n    });\n    const headerContent = createElement('div', {\n      className: 'e-day e-title',\n      innerHTML: this.getMonthName(currentDate)\n    });\n    headerWrapper.appendChild(headerContent);\n    this.parent.trigger(renderCell, {\n      elementType: 'headerCells',\n      element: headerContent,\n      date: currentDate\n    });\n    return headerWrapper;\n  }\n\n  renderCalendarContent(currentDate) {\n    const dateCollection = this.getMonthDates(currentDate);\n    const contentWrapper = createElement('div', {\n      className: 'e-content e-month'\n    });\n    const contentTable = this.createTableLayout('e-calendar-table ' + CONTENT_TABLE_CLASS);\n    contentWrapper.appendChild(contentTable);\n    const thead = createElement('thead', {\n      className: 'e-week-header'\n    });\n    const tr = createElement('tr');\n    let currentWeek = getWeekFirstDate(firstDateOfMonth(currentDate), this.parent.firstDayOfWeek);\n\n    if (this.parent.activeViewOptions.showWeekNumber) {\n      tr.appendChild(createElement('th'));\n    }\n\n    for (let i = 0; i < WEEK_LENGTH; i++) {\n      tr.appendChild(createElement('th', {\n        innerHTML: this.parent.getDayNames('narrow')[currentWeek.getDay()]\n      }));\n      currentWeek = new Date(currentWeek.getTime() + MS_PER_DAY);\n    }\n\n    thead.appendChild(tr);\n    prepend([thead], contentTable);\n    const tbody = contentTable.querySelector('tbody');\n\n    while (dateCollection.length > 0) {\n      const weekDates = dateCollection.splice(0, WEEK_LENGTH);\n      const tr = createElement('tr', {\n        attrs: {\n          'role': 'row'\n        }\n      });\n\n      if (this.parent.activeViewOptions.showWeekNumber) {\n        const weekNumber = this.parent.getWeekNumberContent(weekDates);\n        const td = createElement('td', {\n          className: 'e-week-number',\n          attrs: {\n            'role': 'gridcell',\n            'title': this.parent.localeObj.getConstant('week') + ' ' + weekNumber\n          },\n          innerHTML: weekNumber\n        });\n        tr.appendChild(td);\n        this.parent.trigger(renderCell, {\n          elementType: 'weekNumberCells',\n          element: td\n        });\n      }\n\n      for (const date of weekDates) {\n        const td = createElement('td', {\n          className: 'e-cell ' + WORK_CELLS_CLASS,\n          attrs: {\n            'role': 'gridcell',\n            'aria-selected': 'false',\n            'data-date': date.getTime().toString()\n          }\n        });\n        const span = createElement('span', {\n          className: 'e-day',\n          innerHTML: this.parent.globalize.formatDate(date, {\n            skeleton: 'd',\n            calendar: this.parent.getCalendarMode()\n          }),\n          attrs: {\n            title: this.parent.globalize.formatDate(date, {\n              type: 'date',\n              skeleton: 'full'\n            })\n          }\n        });\n        td.appendChild(span);\n        let classList$$1 = [];\n\n        if (currentDate.getMonth() !== date.getMonth()) {\n          classList$$1.push(OTHERMONTH_CLASS);\n        }\n\n        if (this.isCurrentDate(date) && currentDate.getMonth() === date.getMonth()) {\n          classList$$1 = classList$$1.concat(['e-today', 'e-selected']);\n        }\n\n        if (classList$$1.length > 0) {\n          addClass([td], classList$$1);\n        }\n\n        tr.appendChild(td);\n        this.wireEvents(td, 'cell');\n        this.parent.trigger(renderCell, {\n          elementType: 'workCells',\n          element: td,\n          date: date\n        });\n      }\n\n      tbody.appendChild(tr);\n    }\n\n    return contentWrapper;\n  }\n\n  createTableColGroup(count) {\n    const colGroupEle = createElement('colgroup');\n\n    for (let i = 0; i < count; i++) {\n      colGroupEle.appendChild(createElement('col'));\n    }\n\n    return colGroupEle;\n  }\n\n  getMonthName(date) {\n    const month = this.parent.globalize.formatDate(date, {\n      format: this.parent.activeViewOptions.dateFormat || 'MMMM y',\n      calendar: this.parent.getCalendarMode()\n    });\n    return capitalizeFirstWord(month, 'multiple');\n  }\n\n  generateColumnLevels() {\n    let colLevels = [];\n    const level = this.getDateSlots([this.parent.selectedDate], this.parent.activeViewOptions.workDays);\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      colLevels = this.parent.resourceBase.generateResourceLevels(level);\n\n      if (this.parent.uiStateValues.isGroupAdaptive) {\n        const resourceLevel = this.parent.resourceBase.lastResourceLevel[this.parent.uiStateValues.groupIndex];\n        colLevels = [this.getDateSlots([this.parent.selectedDate], resourceLevel.workDays)];\n      }\n    } else {\n      colLevels.push(level);\n    }\n\n    colLevels.pop();\n    this.colLevels = colLevels;\n    return colLevels;\n  } // eslint-disable-next-line max-len\n\n\n  getDateSlots(renderDates, workDays, startHour = this.parent.workHours.start, endHour = this.parent.workHours.end) {\n    const dateCol = [{\n      date: renderDates[0],\n      type: 'dateHeader',\n      className: [HEADER_CELLS_CLASS],\n      colSpan: 1,\n      workDays: workDays,\n      startHour: new Date(+this.parent.globalize.parseDate(startHour, {\n        skeleton: 'Hm'\n      })),\n      endHour: new Date(+this.parent.globalize.parseDate(endHour, {\n        skeleton: 'Hm'\n      }))\n    }];\n    return dateCol;\n  }\n\n  getMonthDates(date) {\n    const startDate = getWeekFirstDate(firstDateOfMonth(date), this.parent.firstDayOfWeek);\n    const endDate = addDays(new Date(+startDate), 6 * WEEK_LENGTH);\n    const dateCollection = [];\n\n    for (let start = startDate; start.getTime() < endDate.getTime(); start = addDays(start, 1)) {\n      dateCollection.push(resetTime(new Date(start)));\n    }\n\n    return dateCollection;\n  }\n\n  getRowColumnCount(type) {\n    const months = this.getMonths();\n    const year = this.parent.selectedDate.getFullYear();\n    const monthDaysCount = [];\n\n    for (const month of months) {\n      monthDaysCount.push(new Date(year, month, 1).getDay() + new Date(year, month + 1, 0).getDate());\n    }\n\n    const maxCount = Math.max(...monthDaysCount);\n    let count;\n\n    if (type === 'row') {\n      count = this.parent.activeViewOptions.orientation === 'Horizontal' ? months.length : maxCount;\n    } else {\n      count = this.parent.activeViewOptions.orientation === 'Horizontal' ? maxCount : months.length;\n    }\n\n    return count;\n  }\n\n  isCurrentDate(date) {\n    return resetTime(new Date()).getTime() === resetTime(new Date(date.getTime())).getTime();\n  }\n\n  getMonths() {\n    // eslint-disable-next-line prefer-spread\n    return Array.apply(null, {\n      length: this.parent.activeViewOptions.monthsCount\n    }).map((value, index) => this.parent.firstMonthOfYear + index);\n  }\n\n  onCellClick(e) {\n    let target = closest(e.target, '.' + WORK_CELLS_CLASS);\n    const startDate = this.parent.getDateFromElement(target);\n    this.parent.activeCellsData = this.parent.getCellDetails(target);\n    const isPrevious = startDate.getTime() < this.getStartDate().getTime();\n\n    if (isPrevious || startDate.getTime() > this.getEndDate().getTime()) {\n      this.parent.changeDate(this.parent.activeView.getNextPreviousDate(isPrevious ? 'previous' : 'next'), e);\n      const activeDate = this.parent.activeCellsData.startTime.getTime();\n      const inRange = activeDate >= this.getStartDate().getTime() && activeDate <= this.getEndDate().getTime();\n      const dateAttr = inRange ? activeDate : (isPrevious ? this.getEndDate() : this.getStartDate()).getTime();\n      const selectedCell = this.parent.element.querySelector(':not(.' + OTHERMONTH_CLASS + ')[data-date=\"' + dateAttr + '\"]');\n      this.parent.selectCell(selectedCell);\n      this.parent.activeCellsData = this.parent.getCellDetails(selectedCell);\n    } else {\n      const endDate = addDays(new Date(startDate.getTime()), 1);\n      const filteredEvents = this.parent.eventBase.filterEvents(startDate, endDate);\n      const moreEventArgs = {\n        date: startDate,\n        event: filteredEvents,\n        element: e.target\n      };\n\n      if (target.classList.contains(OTHERMONTH_CLASS)) {\n        target = this.parent.element.querySelector(':not(.' + OTHERMONTH_CLASS + ')[data-date=\"' + target.getAttribute('data-date') + '\"]');\n      }\n\n      this.parent.activeCellsData = this.parent.getCellDetails(target);\n      this.parent.quickPopup.moreEventClick(moreEventArgs, endDate);\n    }\n  }\n\n  onContentScroll(e) {\n    const target = e.target;\n    const headerWrapper = this.getDatesHeaderElement();\n    this.parent.notify(virtualScroll, e);\n\n    if (headerWrapper) {\n      headerWrapper.firstElementChild.scrollLeft = target.scrollLeft;\n    }\n\n    const scrollTopSelector = `.${MONTH_HEADER_WRAPPER},.${RESOURCE_COLUMN_WRAP_CLASS}`;\n    const scrollTopElement = this.element.querySelector(scrollTopSelector);\n\n    if (scrollTopElement) {\n      scrollTopElement.scrollTop = target.scrollTop;\n    }\n\n    if (!this.parent.isAdaptive) {\n      this.parent.uiStateValues.top = e.target.scrollTop;\n    }\n\n    this.parent.uiStateValues.left = e.target.scrollLeft;\n    this.setPersistence();\n  }\n\n  onScrollUiUpdate(args) {\n    let height = this.parent.element.offsetHeight - this.getHeaderBarHeight();\n    const headerWrapper = this.element.querySelector('.' + DATE_HEADER_CONTAINER_CLASS);\n\n    if (headerWrapper) {\n      height -= headerWrapper.offsetHeight;\n    }\n\n    const contentWrapper = this.element.querySelector('.' + CONTENT_WRAP_CLASS);\n\n    if (contentWrapper) {\n      contentWrapper.style.height = formatUnit(height);\n    }\n\n    if (!this.parent.isAdaptive && headerWrapper) {\n      const scrollBarWidth = getScrollBarWidth();\n\n      if (contentWrapper.offsetWidth - contentWrapper.clientWidth > 0) {\n        headerWrapper.firstElementChild.style[args.cssProperties.border] = scrollBarWidth > 0 ? '1px' : '0px';\n        headerWrapper.style[args.cssProperties.padding] = scrollBarWidth > 0 ? scrollBarWidth - 1 + 'px' : '0px';\n      } else {\n        headerWrapper.firstElementChild.style[args.cssProperties.border] = '';\n        headerWrapper.style[args.cssProperties.padding] = '';\n      }\n    }\n\n    this.setColWidth(this.getContentAreaElement());\n    const leftPanelSelector = `.${MONTH_HEADER_WRAPPER},.${RESOURCE_COLUMN_WRAP_CLASS}`;\n    const leftPanelElement = this.element.querySelector(leftPanelSelector);\n\n    if (leftPanelElement) {\n      const isYScroll = contentWrapper.scrollWidth > contentWrapper.clientWidth;\n      leftPanelElement.style.height = formatUnit(height - (isYScroll ? 17 : 0));\n    }\n\n    if (!args.isPreventScrollUpdate) {\n      if (this.parent.uiStateValues.isInitial) {\n        this.parent.uiStateValues.isInitial = false;\n      } else {\n        if (leftPanelElement) {\n          leftPanelElement.scrollTop = this.parent.uiStateValues.top;\n        }\n\n        contentWrapper.scrollTop = this.parent.uiStateValues.top;\n        contentWrapper.scrollLeft = this.parent.uiStateValues.left;\n      }\n    }\n\n    this.retainScrollPosition();\n  }\n\n  getStartDate() {\n    return new Date(this.parent.selectedDate.getFullYear(), this.parent.firstMonthOfYear % 12, 1);\n  }\n\n  getEndDate() {\n    return addDays(addMonths(this.getStartDate(), this.parent.monthsCount), -1);\n  }\n\n  startDate() {\n    return this.parent.currentView === 'Year' ? getWeekFirstDate(this.getStartDate(), this.parent.firstDayOfWeek) : this.getStartDate();\n  }\n\n  endDate() {\n    return this.parent.currentView === 'Year' ? addDays(getWeekLastDate(this.getEndDate(), this.parent.firstDayOfWeek), 1) : addDays(this.getEndDate(), 1);\n  }\n\n  getEndDateFromStartDate(start) {\n    let date = new Date(start.getTime());\n\n    if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n      date = lastDateOfMonth(date);\n    }\n\n    return addDays(new Date(date.getTime()), 1);\n  }\n\n  getNextPreviousDate(type) {\n    return addYears(this.parent.selectedDate, type === 'next' ? 1 : -1);\n  }\n\n  getDateRangeText() {\n    const startDate = this.getStartDate();\n    const endDate = this.getEndDate();\n\n    if (startDate.getFullYear() !== endDate.getFullYear()) {\n      return this.parent.globalize.formatDate(startDate, {\n        skeleton: 'yMMM'\n      }) + ' - ' + this.parent.globalize.formatDate(endDate, {\n        skeleton: 'yMMM'\n      });\n    } else {\n      return this.parent.globalize.formatDate(this.parent.selectedDate, {\n        skeleton: 'y'\n      });\n    }\n  }\n\n  addEventListener() {\n    this.parent.on(scrollUiUpdate, this.onScrollUiUpdate, this);\n    this.parent.on(dataReady, this.onDataReady, this);\n  }\n\n  removeEventListener() {\n    if (this.parent) {\n      this.parent.off(scrollUiUpdate, this.onScrollUiUpdate);\n      this.parent.off(dataReady, this.onDataReady);\n    }\n  }\n\n  onDataReady(args) {\n    this.yearEventModule = new YearEvent(this.parent);\n    this.yearEventModule.renderAppointments();\n    this.parent.notify(eventsLoaded, args);\n  }\n\n  wireEvents(element, type) {\n    if (type === 'cell') {\n      if (this.parent.currentView !== 'TimelineYear') {\n        EventHandler.add(element, 'click', this.onCellClick, this);\n      } else {\n        EventHandler.add(element, 'mousedown', this.parent.workCellAction.cellMouseDown, this.parent.workCellAction);\n        EventHandler.add(element, 'click', this.parent.workCellAction.cellClick, this.parent.workCellAction);\n\n        if (!this.parent.isAdaptive) {\n          EventHandler.add(element, 'dblclick', this.parent.workCellAction.cellDblClick, this.parent.workCellAction);\n        }\n      }\n    } else {\n      EventHandler.add(element, 'scroll', this.onContentScroll, this);\n    }\n  }\n\n  destroy() {\n    if (!this.parent || this.parent && this.parent.isDestroyed) {\n      return;\n    }\n\n    if (this.element) {\n      const contentScroll = this.element.querySelector('.' + CONTENT_WRAP_CLASS);\n\n      if (contentScroll) {\n        EventHandler.remove(contentScroll, 'scroll', this.onContentScroll);\n      }\n\n      if (this.yearEventModule) {\n        this.yearEventModule.destroy();\n        this.yearEventModule = null;\n      }\n\n      if (this.parent.resourceBase) {\n        this.parent.resourceBase.destroy();\n      }\n\n      super.destroy();\n    }\n  }\n\n}\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\n\nclass AgendaBase extends ViewBase {\n  constructor(parent) {\n    super(parent);\n  } // eslint-disable-next-line max-len\n\n\n  createAgendaContentElement(type, listData, aTd, groupOrder, groupIndex) {\n    let listElement;\n    const fieldMapping = this.parent.eventFields;\n\n    if (type === 'noEvents') {\n      const noEvents = [{\n        'subject': this.parent.localeObj.getConstant('noEvents')\n      }];\n      listElement = ListBase.createList(this.parent.createElement, noEvents, {\n        moduleName: 'agenda',\n        listClass: this.parent.activeView.viewClass,\n        itemClass: this.parent.activeView.viewClass,\n        template: `<div class=\"${AGENDA_NO_EVENT_CLASS}\">${this.parent.localeObj.getConstant('noEvents')}</div>`\n      });\n\n      if (listElement.querySelector('.e-agenda-item').children.length === 0) {\n        listElement.firstElementChild.appendChild(createElement('div', {\n          className: AGENDA_NO_EVENT_CLASS,\n          innerHTML: this.parent.localeObj.getConstant('noEvents')\n        }));\n      }\n    } else {\n      listElement = ListBase.createList(this.parent.createElement, listData, {\n        moduleName: 'agenda',\n        listClass: this.parent.activeView.viewClass,\n        itemClass: this.parent.activeView.viewClass\n      });\n      const listElements = [].slice.call(listElement.children);\n      listElements.forEach((element, li) => {\n        const appWrapper = createElement('div', {\n          className: APPOINTMENT_CLASS,\n          attrs: {\n            'data-id': 'Appointment_' + listData[li][this.parent.eventFields.id],\n            'data-guid': listData[li].Guid,\n            'role': 'button',\n            'tabindex': '0',\n            'aria-disabled': this.parent.eventBase.getReadonlyAttribute(listData[li]),\n            'aria-pressed': 'false',\n            'aria-grabbed': 'true',\n            'aria-label': this.parent.getAnnouncementString(listData[li])\n          }\n        });\n\n        if (!isNullOrUndefined(groupIndex)) {\n          appWrapper.setAttribute('data-group-index', groupIndex.toString());\n        }\n\n        this.parent.eventBase.applyResourceColor(appWrapper, listData[li], 'borderColor', groupOrder);\n        let templateEle;\n\n        if (!isNullOrUndefined(this.parent.activeViewOptions.eventTemplate)) {\n          addClass([appWrapper], EVENT_TEMPLATE);\n          const scheduleId = this.parent.element.id + '_';\n          const viewName = this.parent.activeViewOptions.eventTemplateName;\n          const templateId = scheduleId + viewName + 'eventTemplate';\n          templateEle = this.parent.getAppointmentTemplate()(listData[li], this.parent, 'eventTemplate', templateId, false);\n\n          if (!isNullOrUndefined(listData[li][fieldMapping.recurrenceRule])) {\n            const iconClass = listData[li][fieldMapping.id] === listData[li][fieldMapping.recurrenceID] ? EVENT_RECURRENCE_ICON_CLASS : EVENT_RECURRENCE_EDIT_ICON_CLASS;\n            appWrapper.appendChild(createElement('div', {\n              className: ICON + ' ' + iconClass\n            }));\n          }\n        } else {\n          templateEle = this.createAppointment(listData[li]);\n        }\n\n        append([].slice.call(templateEle), appWrapper);\n        removeChildren(element);\n        element.appendChild(appWrapper);\n        const args = {\n          data: extend({}, listData[li], null, true),\n          element: element,\n          cancel: false\n        };\n        this.parent.trigger(eventRendered, args, eventArgs => {\n          if (eventArgs.cancel) {\n            remove(element);\n          }\n        });\n      });\n    }\n\n    aTd.appendChild(listElement);\n\n    if (this.parent.currentView === 'MonthAgenda' && this.parent.activeViewOptions.group.resources.length > 0 || this.parent.currentView === 'Agenda') {\n      addClass([aTd], AGENDA_DAY_BORDER_CLASS);\n    }\n\n    this.parent.renderTemplates();\n    return aTd;\n  }\n\n  createAppointment(event) {\n    const fieldMapping = this.parent.eventFields;\n    let eventSubject = event[fieldMapping.subject] || this.parent.eventSettings.fields.subject.default || this.parent.localeObj.getConstant('addTitle');\n    const eventLocation = event[fieldMapping.location] || this.parent.eventSettings.fields.location.default;\n    const appSubjectWrap = createElement('div', {\n      className: SUBJECT_WRAP\n    });\n\n    if (!isNullOrUndefined(eventLocation) && eventLocation !== '') {\n      eventSubject += ',';\n    }\n\n    appSubjectWrap.appendChild(createElement('div', {\n      className: SUBJECT_CLASS,\n      innerHTML: eventSubject\n    }));\n\n    if (!isNullOrUndefined(eventLocation) && eventLocation !== '') {\n      appSubjectWrap.appendChild(createElement('div', {\n        className: LOCATION_CLASS,\n        innerHTML: eventLocation\n      }));\n    }\n\n    if (!isNullOrUndefined(event[fieldMapping.recurrenceRule])) {\n      const iconClass = event[fieldMapping.id] === event[fieldMapping.recurrenceID] ? EVENT_RECURRENCE_ICON_CLASS : EVENT_RECURRENCE_EDIT_ICON_CLASS;\n      appSubjectWrap.appendChild(createElement('div', {\n        className: ICON + ' ' + iconClass\n      }));\n    }\n\n    const strDate = event[fieldMapping.startTime];\n    const endDate = event[fieldMapping.endTime];\n    const isAllDay = event[fieldMapping.isAllDay];\n    let allDayStr = this.parent.localeObj.getConstant('allDay');\n    const timeStr = this.parent.getTimeString(strDate) + ' - ' + this.parent.getTimeString(endDate);\n\n    if (!isNullOrUndefined(event.data)) {\n      const milliSeconds = endDate.getTimezoneOffset() !== strDate.getTimezoneOffset() ? endDate.getTime() - strDate.getTime() + 3600000 : endDate.getTime() - strDate.getTime();\n      const eventString = milliSeconds / MS_PER_DAY >= 1 ? allDayStr : timeStr;\n      allDayStr = eventString + ' (' + this.parent.localeObj.getConstant('day') + ' ' + event.data.index + '/' + event.data.count + ')';\n    }\n\n    const displayStr = !isNullOrUndefined(event.data) || isAllDay ? allDayStr : timeStr;\n    const appDateTime = createElement('div', {\n      className: DATE_TIME_CLASS,\n      innerHTML: displayStr\n    });\n    return [appSubjectWrap, appDateTime];\n  }\n\n  processAgendaEvents(events) {\n    let eventsProcessed = [];\n\n    if (isNullOrUndefined(events)) {\n      return eventsProcessed;\n    }\n\n    for (const event of events) {\n      const spanned = this.parent.eventBase.splitEventByDay(event);\n      eventsProcessed = eventsProcessed.concat(spanned.length > 1 ? spanned : event);\n    }\n\n    return eventsProcessed;\n  }\n\n  wireEventActions() {\n    const eventElement = [].slice.call(this.parent.element.querySelectorAll('.' + APPOINTMENT_CLASS));\n\n    for (const element of eventElement) {\n      this.parent.eventBase.wireAppointmentEvents(element, this.parent.getEventDetails(element), true);\n    }\n\n    const dateHeaderElement = [].slice.call(this.parent.element.querySelectorAll('.e-m-date'));\n\n    for (const element of dateHeaderElement) {\n      EventHandler.add(element, 'click', this.parent.agendaModule.dayNavigationClick, this);\n    }\n  }\n\n  calculateResourceTableElement(tBody, noOfDays, agendaDate) {\n    if (isNullOrUndefined(this.parent.resourceBase.lastResourceLevel)) {\n      const level = this.getDateSlots(this.renderDates, this.parent.activeViewOptions.workDays);\n      this.parent.resourceBase.generateResourceLevels(level);\n    }\n\n    const agendaLastDate = addDays(new Date(agendaDate.getTime()), noOfDays);\n    const days = this.parent.activeViewOptions.group.byDate || this.parent.currentView === 'MonthAgenda' ? noOfDays : 1;\n    const resColl = this.parent.resourceBase.resourceCollection;\n    const resData = this.parent.resourceBase.lastResourceLevel;\n    const initialDate = agendaDate;\n\n    for (let i = 0; i < days; i++) {\n      const lastLevelInfo = [];\n      const tempLastLevelInfo = [];\n      let tempIndex = 0;\n      let eventObj;\n      let dateObj;\n      const firstDate = addDays(initialDate, i);\n      const finalDate = this.parent.activeViewOptions.group.byDate || this.parent.currentView === 'MonthAgenda' ? addDays(firstDate, 1) : agendaLastDate;\n      const agendaCollection = this.parent.eventBase.filterEvents(firstDate, finalDate);\n\n      if (agendaCollection.length > 0 || !this.parent.hideEmptyAgendaDays || this.parent.currentView === 'MonthAgenda') {\n        for (let res = 0; res < resData.length; res++) {\n          noOfDays = !this.parent.activeViewOptions.group.byDate || this.parent.currentView === 'MonthAgenda' ? noOfDays : 1;\n          const data = [];\n          agendaDate = firstDate; // eslint-disable-next-line max-len\n\n          const resDataCollection = this.parent.eventBase.filterEvents(agendaDate, agendaLastDate, agendaCollection, resData[res]);\n\n          if (resDataCollection.length > 0 || !this.parent.hideEmptyAgendaDays || this.parent.currentView === 'MonthAgenda') {\n            for (let r = 0; r < noOfDays; r++) {\n              // eslint-disable-next-line max-len\n              const resDayCollection = this.parent.eventBase.filterEvents(agendaDate, addDays(agendaDate, 1), resDataCollection, undefined);\n\n              if (resDayCollection.length > 0 || !this.parent.hideEmptyAgendaDays || this.parent.currentView === 'MonthAgenda') {\n                data.push(resDayCollection[0]);\n                eventObj = {\n                  rowSpan: 1,\n                  type: 'eventColumn',\n                  resource: resColl[resColl.length - 1],\n                  groupIndex: resData[res].groupIndex,\n                  groupOrder: resData[res].groupOrder,\n                  resourceData: resData[res].resourceData,\n                  eventData: resDayCollection,\n                  date: agendaDate\n                };\n                dateObj = {\n                  rowSpan: 1,\n                  type: 'dateColumn',\n                  resource: resColl[resColl.length - 1],\n                  groupOrder: resData[res].groupOrder,\n                  resourceData: resData[res].resourceData,\n                  date: agendaDate\n                };\n\n                if (!lastLevelInfo[tempIndex]) {\n                  lastLevelInfo[tempIndex] = [];\n                }\n\n                lastLevelInfo[tempIndex].push(eventObj);\n                lastLevelInfo[tempIndex].push(dateObj);\n                tempIndex++;\n              }\n\n              agendaDate = addDays(agendaDate, 1);\n\n              if (agendaDate.getTime() >= agendaLastDate.getTime() || this.parent.activeViewOptions.group.byDate || this.parent.currentView === 'MonthAgenda') {\n                lastLevelInfo[lastLevelInfo.length - 1][1].cssClass = AGENDA_DAY_BORDER_CLASS;\n                const tempObj = {\n                  rowSpan: data.length,\n                  type: 'resourceColumn',\n                  resource: resColl[resColl.length - 1],\n                  groupOrder: resData[res].groupOrder.slice(0, -1),\n                  resourceData: resData[res].resourceData,\n                  groupIndex: lastLevelInfo.length - data.length,\n                  className: [RESOURCE_NAME],\n                  date: agendaDate\n                };\n                lastLevelInfo[lastLevelInfo.length - data.length].push(tempObj);\n                tempLastLevelInfo.push(extend({}, tempObj, null, true));\n                break;\n              }\n            }\n          }\n        }\n\n        const topResources = resColl.slice(0, -1);\n        let tempGroupedData = [];\n        let totalRowSpan = 0;\n\n        for (let y = 0; y < topResources.length; y++) {\n          const data = topResources[topResources.length - (y + 1)].dataSource;\n\n          for (let x = 0; x < data.length; x++) {\n            let z = 0;\n\n            for (let u = 0; u < tempLastLevelInfo.length; u++) {\n              // eslint-disable-next-line max-len\n              if (tempLastLevelInfo[u].groupOrder[topResources.length - (y + 1)] === data[x][topResources[topResources.length - (y + 1)].idField]) {\n                totalRowSpan = totalRowSpan + tempLastLevelInfo[u].rowSpan;\n                tempGroupedData.push(extend({}, tempLastLevelInfo[u], null, true));\n              }\n\n              if (++z === tempLastLevelInfo.length && tempGroupedData.length > 0) {\n                tempGroupedData[0].rowSpan = totalRowSpan;\n                tempGroupedData[0].type = 'parentColumnLevel_' + (y + 1);\n                tempGroupedData[0].resource = topResources[topResources.length - (y + 1)];\n                tempGroupedData[0].resourceData = data[x];\n                tempGroupedData[0].date = agendaDate;\n                lastLevelInfo[tempGroupedData[0].groupIndex].push(tempGroupedData[0]);\n                tempGroupedData = [];\n                totalRowSpan = 0;\n              }\n            }\n          }\n        }\n\n        this.createResourceTableRow(lastLevelInfo, tBody);\n      }\n    }\n\n    const totalCollection = this.parent.eventBase.filterEvents(initialDate, agendaLastDate);\n\n    if (totalCollection.length === 0 && !this.parent.activeViewOptions.allowVirtualScrolling && this.parent.hideEmptyAgendaDays) {\n      this.renderEmptyContent(tBody, initialDate);\n    }\n  }\n\n  createResourceTableRow(tContent, tBody) {\n    const tr = createElement('tr', {\n      attrs: {\n        role: 'row'\n      }\n    });\n    let ntr;\n    const td = createElement('td', {\n      attrs: {\n        role: 'gridcell',\n        'aria-selected': 'false'\n      }\n    });\n    let tempData;\n    let rowSpan = 0;\n    let level;\n\n    if (this.parent.activeViewOptions.group.byDate || this.parent.currentView === 'MonthAgenda') {\n      let tContentCollection = [];\n      const parentCollection = this.parent.resourceBase.resourceCollection.slice(0, -1);\n\n      for (let w = 0; w < tContent.length; w++) {\n        tContentCollection = tContentCollection.concat(tContent[w]);\n      }\n\n      level = parentCollection.length > 0 ? 'parentColumnLevel_' + parentCollection.length : 'resourceColumn';\n      const rowSpanCollection = tContentCollection.filter(data => data.type === level);\n\n      for (let x = 0; x < rowSpanCollection.length; x++) {\n        rowSpan = rowSpan + rowSpanCollection[x].rowSpan;\n      }\n    }\n\n    for (let row = 0; row < tContent.length; row++) {\n      ntr = tr.cloneNode();\n\n      for (let col = tContent[row].length - 1; col >= 0; col--) {\n        const data = tContent[row][col];\n        let ntd = td.cloneNode();\n\n        if (data.type === 'dateColumn') {\n          if (this.parent.activeViewOptions.group.byDate || this.parent.currentView === 'MonthAgenda') {\n            tempData = tContent[row][col];\n            continue;\n          }\n\n          ntd.setAttribute('data-date', data.date.getTime().toString());\n          ntd.appendChild(this.createDateHeaderElement(data.date));\n          const className = [AGENDA_CELLS_CLASS, AGENDA_DATE_CLASS];\n\n          if (data.cssClass) {\n            className.push(data.cssClass);\n          }\n\n          addClass([ntd], className);\n          ntr.appendChild(ntd);\n        } else if (data.type === 'eventColumn') {\n          const elementType = data.eventData.length === 0 ? 'noEvents' : 'data';\n          ntd = this.createAgendaContentElement(elementType, data.eventData, ntd, data.groupOrder, data.groupIndex);\n          ntd.setAttribute('data-date', data.date.getTime().toString());\n\n          if (this.parent.activeViewOptions.group.byDate || this.parent.currentView === 'MonthAgenda') {\n            addClass([ntd], [AGENDA_CELLS_CLASS, AGENDA_DAY_PADDING_CLASS]);\n          }\n\n          ntr.appendChild(ntd);\n        } else {\n          ntd.setAttribute('rowspan', data.rowSpan.toString());\n          addClass([ntd], AGENDA_RESOURCE_CLASS);\n          this.setResourceHeaderContent(ntd, data, data.className[0]);\n          ntr.appendChild(ntd);\n        }\n      }\n\n      if (this.parent.activeViewOptions.group.byDate && row === 0 && this.parent.currentView !== 'MonthAgenda') {\n        const ntd = td.cloneNode();\n        ntd.setAttribute('data-date', tempData.date.getTime().toString());\n        ntd.setAttribute('rowspan', rowSpan.toString());\n        ntd.appendChild(this.createDateHeaderElement(tempData.date));\n        addClass([ntd], [AGENDA_CELLS_CLASS, AGENDA_DATE_CLASS, DATE_BORDER_CLASS]);\n        const daysCount = getDaysCount(this.parent.selectedDate.getTime(), tempData.date.getTime());\n        ntr.setAttribute('data-row-index', daysCount.toString());\n\n        if (this.parent.element.querySelector(`.e-agenda-view tr[data-row-index=\"${daysCount}\"]`)) {\n          break;\n        }\n\n        ntr.insertBefore(ntd, ntr.childNodes[0]);\n      }\n\n      tBody.appendChild(ntr);\n    }\n  }\n\n  createDateHeaderElement(date) {\n    let dateHeader;\n\n    if (this.parent.activeViewOptions.dateHeaderTemplate) {\n      dateHeader = createElement('div', {\n        className: AGENDA_HEADER_CLASS\n      });\n      const args = {\n        date: date,\n        type: 'dateHeader'\n      };\n      const scheduleId = this.parent.element.id + '_';\n      const viewName = this.parent.activeViewOptions.dateHeaderTemplateName;\n      const templateId = scheduleId + viewName + 'dateHeaderTemplate';\n      const dateTemplate = [].slice.call(this.parent.getDateHeaderTemplate()(args, this.parent, 'dateHeaderTemplate', templateId, false));\n      append(dateTemplate, dateHeader);\n    } else {\n      dateHeader = this.getMobileDateElement(date, AGENDA_HEADER_CLASS);\n    }\n\n    return dateHeader;\n  }\n\n  renderEmptyContent(tBody, agendaDate) {\n    const eTr = this.createTableRowElement(agendaDate, 'noEvents');\n    const eTd = eTr.children[0];\n    const noEvents = createElement('div', {\n      className: AGENDA_EMPTY_EVENT_CLASS,\n      innerHTML: this.parent.localeObj.getConstant('noEvents')\n    });\n    eTd.appendChild(noEvents);\n    tBody.appendChild(eTr);\n  }\n\n  createTableRowElement(date, type) {\n    const daysCount = getDaysCount(this.parent.selectedDate.getTime(), date.getTime());\n    const tr = createElement('tr', {\n      attrs: {\n        'role': 'row',\n        'data-row-index': daysCount.toString()\n      }\n    });\n    const td = createElement('td', {\n      attrs: {\n        'class': type === 'monthHeader' ? MONTH_HEADER_CLASS : AGENDA_CELLS_CLASS,\n        'role': 'gridcell',\n        'aria-selected': 'false',\n        'data-column-index': daysCount.toString(),\n        'data-date': date.getTime().toString()\n      }\n    });\n    const dTd = td.cloneNode();\n    const aTd = td.cloneNode();\n    tr.appendChild(dTd);\n\n    if (type !== 'noEvents') {\n      tr.appendChild(aTd);\n    }\n\n    return tr;\n  }\n\n  destroy() {\n    super.destroy();\n  }\n\n}\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\n/**\n * agenda view\n */\n\n\nclass Agenda extends AgendaBase {\n  constructor(parent) {\n    super(parent);\n    this.viewClass = 'e-agenda-view';\n    this.isInverseTableSelect = false;\n    this.agendaDates = {};\n    this.virtualScrollTop = 1;\n  }\n\n  getModuleName() {\n    return 'agenda';\n  }\n\n  renderLayout() {\n    this.agendaDates = {};\n    this.element = createElement('div', {\n      className: TABLE_WRAP_CLASS\n    });\n    addClass([this.element], this.viewClass);\n    this.element.appendChild(this.createTableLayout(OUTER_TABLE_CLASS));\n    this.element.querySelector('table').setAttribute('role', 'presentation');\n    this.parent.element.querySelector('.' + TABLE_CONTAINER_CLASS).appendChild(this.element);\n    const eTr = createElement('tr');\n    this.element.querySelector('tbody').appendChild(eTr);\n    const workTd = createElement('td');\n    eTr.appendChild(workTd);\n    const wrap = createElement('div', {\n      className: CONTENT_WRAP_CLASS\n    });\n    workTd.appendChild(wrap);\n    const tbl = this.createTableLayout(CONTENT_TABLE_CLASS);\n    wrap.appendChild(tbl);\n    const tBody = tbl.querySelector('tbody');\n    const agendaDate = resetTime(this.parent.selectedDate);\n    this.renderEmptyContent(tBody, agendaDate);\n    this.wireEvents();\n\n    if (this.parent.resourceBase) {\n      this.parent.resourceBase.generateResourceLevels([{\n        renderDates: this.parent.activeView.renderDates\n      }]);\n    }\n\n    if (this.parent.uiStateValues.isGroupAdaptive && !this.parent.element.querySelector('.' + RESOURCE_TOOLBAR_CONTAINER)) {\n      this.renderResourceMobileLayout();\n    }\n\n    this.parent.notify(contentReady, {});\n  }\n\n  eventLoad(args) {\n    this.dataSource = extend([], this.parent.eventsData, null, true);\n\n    for (const event of this.parent.eventsData) {\n      delete event.generatedDates;\n    }\n\n    let eventCollection = this.parent.activeViewOptions.allowVirtualScrolling ? args.processedData : this.parent.eventsProcessed;\n\n    if (this.parent.uiStateValues.isGroupAdaptive) {\n      const resource = this.parent.resourceBase.lastResourceLevel[this.parent.uiStateValues.groupIndex];\n      this.dataSource = this.parent.eventBase.filterEventsByResource(resource, this.dataSource);\n      eventCollection = this.parent.eventBase.filterEventsByResource(resource, eventCollection);\n    }\n\n    this.parent.eventsProcessed = this.processAgendaEvents(eventCollection);\n    const agendaDate = resetTime(this.parent.selectedDate);\n    const tBody = this.element.querySelector('.' + CONTENT_TABLE_CLASS + ' tbody');\n    removeChildren(tBody);\n    this.renderInitialContent(tBody, agendaDate);\n    this.wireEventActions();\n    const contentArea = closest(tBody, '.' + CONTENT_WRAP_CLASS);\n    contentArea.scrollTop = 1;\n    this.parent.notify(eventsLoaded, {});\n\n    if (!this.parent.activeViewOptions.allowVirtualScrolling) {\n      this.retainScrollPosition();\n    }\n  }\n\n  refreshEvent(refreshDate) {\n    let processedData = [];\n    const fields = this.parent.eventFields;\n\n    for (const data of this.dataSource) {\n      if (isNullOrUndefined(data[fields.recurrenceID]) && !isNullOrUndefined(data[fields.recurrenceRule]) && !isNullOrUndefined(data.generatedDates) && refreshDate >= data.generatedDates.end) {\n        processedData = processedData.concat(this.parent.eventBase.generateOccurrence(data, refreshDate));\n      }\n    }\n\n    this.parent.eventsProcessed = this.parent.eventsProcessed.concat(this.processAgendaEvents(processedData));\n  }\n\n  refreshHeader() {\n    const tBody = this.element.querySelector('.' + CONTENT_TABLE_CLASS + ' tbody');\n\n    if (this.parent.activeViewOptions.group.byDate) {\n      removeChildren(tBody);\n    } else {\n      remove(tBody.firstElementChild);\n    }\n\n    const agendaDate = resetTime(this.parent.selectedDate);\n    const emptyTBody = createElement('tbody');\n    const firstDate = new Date(agendaDate.getTime());\n    const lastDate = this.parent.activeViewOptions.allowVirtualScrolling && this.parent.hideEmptyAgendaDays ? this.getEndDateFromStartDate(firstDate) : addDays(firstDate, this.parent.agendaDaysCount);\n    this.renderContent(emptyTBody, firstDate, lastDate);\n    append([].slice.call(emptyTBody.childNodes), tBody);\n  }\n\n  renderInitialContent(tBody, agendaDate) {\n    const emptyTBody = createElement('tbody');\n    let firstDate = new Date(agendaDate.getTime());\n    let lastDate = this.parent.activeViewOptions.allowVirtualScrolling && this.parent.hideEmptyAgendaDays ? this.getEndDateFromStartDate(firstDate) : addDays(firstDate, this.parent.agendaDaysCount);\n    this.renderContent(emptyTBody, firstDate, lastDate);\n    append([].slice.call(emptyTBody.childNodes), tBody); // Initial rendering, to load previous date events upto scroll bar enable\n\n    if (this.parent.activeViewOptions.allowVirtualScrolling && this.parent.hideEmptyAgendaDays && this.parent.eventsData.length > 0) {\n      const contentArea = this.getContentAreaElement();\n      const contentChild = contentArea.querySelector('.e-content-table');\n\n      while (contentArea.offsetWidth <= contentArea.clientWidth) {\n        if (this.parent.isAdaptive && contentChild.offsetHeight >= contentArea.clientHeight) {\n          break;\n        }\n\n        const emptyTBody = createElement('tbody');\n        lastDate = firstDate;\n        firstDate = addDays(lastDate, -this.parent.agendaDaysCount);\n        this.renderContent(emptyTBody, firstDate, lastDate);\n        prepend([].slice.call(emptyTBody.childNodes), tBody);\n\n        if (firstDate <= this.parent.minDate) {\n          break;\n        }\n      }\n    }\n\n    if (tBody.childNodes.length <= 0) {\n      this.renderEmptyContent(tBody, agendaDate);\n    }\n  }\n\n  renderContent(tBody, agendaDate, lastDate) {\n    const fieldMapping = this.parent.eventFields;\n    const firstDate = new Date(agendaDate.getTime());\n    const isObject = this.appointmentFiltering(firstDate, lastDate);\n\n    if (isObject.length > 0 && this.parent.activeViewOptions.allowVirtualScrolling && this.parent.hideEmptyAgendaDays) {\n      agendaDate = isObject[0][fieldMapping.startTime];\n      agendaDate = new Date(new Date(agendaDate.getTime()).setHours(0, 0, 0, 0));\n      this.updateHeaderText(isObject[0][fieldMapping.startTime]);\n    }\n\n    let endDate;\n\n    if (!this.parent.hideEmptyAgendaDays || this.parent.agendaDaysCount > 0 && isObject.length > 0) {\n      if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n        let date = agendaDate;\n\n        if (!this.parent.activeViewOptions.group.byDate) {\n          this.parent.activeViewOptions.allowVirtualScrolling = false;\n          date = firstDate;\n\n          if (this.parent.headerModule) {\n            this.parent.headerModule.updateDateRange(this.parent.activeView.getDateRangeText());\n            this.parent.headerModule.updateHeaderItems('remove');\n          }\n        }\n\n        this.calculateResourceTableElement(tBody, this.parent.agendaDaysCount, date);\n      } else {\n        for (let day = 0; day < this.parent.agendaDaysCount; day++) {\n          const filterData = this.appointmentFiltering(agendaDate);\n          const nTr = this.createTableRowElement(agendaDate, 'data');\n\n          if (this.element.querySelector('tr[data-row-index=\"' + parseInt(nTr.getAttribute('data-row-index'), 10) + '\"]')) {\n            agendaDate = addDays(agendaDate, 1);\n            continue;\n          }\n\n          const dTd = nTr.children[0];\n          const aTd = nTr.children[1];\n\n          if (filterData.length > 0 || !this.parent.hideEmptyAgendaDays && filterData.length === 0) {\n            const elementType = !this.parent.hideEmptyAgendaDays && filterData.length === 0 ? 'noEvents' : 'data';\n            dTd.appendChild(this.createDateHeaderElement(agendaDate));\n            nTr.appendChild(dTd);\n            const cTd = this.createAgendaContentElement(elementType, filterData, aTd);\n            nTr.appendChild(cTd);\n\n            if (cTd.querySelectorAll('li').length > 0) {\n              tBody.appendChild(nTr);\n            }\n          } else if (this.parent.activeViewOptions.allowVirtualScrolling) {\n            day--;\n          }\n\n          if (this.isCurrentDate(new Date(agendaDate.getTime()))) {\n            addClass(dTd.childNodes, AGENDA_CURRENT_DAY_CLASS);\n          }\n\n          agendaDate = addDays(agendaDate, 1);\n\n          if (agendaDate.getTime() > lastDate.getTime()) {\n            break;\n          }\n        }\n      }\n\n      endDate = new Date(agendaDate.getTime() - MS_PER_DAY);\n    }\n\n    this.agendaDates = {\n      start: firstDate,\n      end: endDate\n    };\n  }\n\n  agendaScrolling(event) {\n    if (this.parent.quickPopup) {\n      this.parent.quickPopup.quickPopupHide();\n    }\n\n    if (this.parent.activeViewOptions.allowVirtualScrolling) {\n      this.virtualScrolling(event);\n    }\n\n    if (!this.parent.activeViewOptions.allowVirtualScrolling) {\n      this.setPersistence();\n    }\n  }\n\n  virtualScrolling(event) {\n    const target = event.target;\n    const scrollTop = target.scrollTop;\n    const scrollHeight = target.scrollHeight;\n    const offsetHeight = target.clientHeight;\n    const totalHeight = scrollTop + offsetHeight;\n    const direction = this.virtualScrollTop < scrollTop ? 'next' : 'previous';\n    const tBody = target.querySelector('tbody');\n    const emptyTBody = createElement('tbody');\n    const topElement = this.getElementFromScrollerPosition(event);\n    const scrollDate = this.parent.getDateFromElement(topElement);\n    let filterDate;\n    let filterData;\n\n    if (scrollTop === 0) {\n      filterDate = this.getPreviousNextDate(addDays(scrollDate, -1), direction);\n      filterData = this.appointmentFiltering(filterDate.start, filterDate.end);\n\n      if (filterData.length > 0 || !this.parent.hideEmptyAgendaDays) {\n        this.renderContent(emptyTBody, filterDate.start, filterDate.end);\n        prepend([].slice.call(emptyTBody.childNodes), tBody);\n        this.wireEventActions();\n\n        for (let s = 0, element = tBody.children; s < element.length; s++) {\n          if (element[s].getAttribute('data-row-index') === topElement.getAttribute('data-column-index')) {\n            const scrollToValue = element[s].offsetTop - this.element.querySelector('.e-agenda-item').offsetHeight;\n            target.scrollTop = scrollToValue;\n            break;\n          }\n        }\n\n        this.updateHeaderText(scrollDate);\n      }\n    } else if (totalHeight >= scrollHeight - 5) {\n      filterDate = this.getPreviousNextDate(addDays(scrollDate, 1), direction);\n      filterData = this.appointmentFiltering(filterDate.start, filterDate.end);\n\n      if (filterData.length > 0 || !this.parent.hideEmptyAgendaDays) {\n        this.renderContent(emptyTBody, filterDate.start, filterDate.end);\n        append([].slice.call(emptyTBody.childNodes), tBody);\n        this.wireEventActions();\n        this.updateHeaderText(scrollDate);\n      }\n    } else {\n      this.updateHeaderText(scrollDate);\n    }\n\n    this.virtualScrollTop = scrollTop;\n    const selectedElements = this.parent.eventBase.getSelectedAppointments();\n\n    if (selectedElements.length > 0) {\n      selectedElements[selectedElements.length - 1].focus();\n    }\n  }\n\n  getElementFromScrollerPosition(event) {\n    let filterElement;\n    const target = event.target;\n    const scrollTop = target.scrollTop;\n    const scrollHeight = target.scrollHeight;\n    const offsetHeight = target.clientHeight;\n    const totalHeight = scrollTop + offsetHeight;\n    const liCollection = [].slice.call(target.querySelectorAll('.e-agenda-item'));\n    let li;\n    let liDetails;\n\n    if (liCollection.length > 0) {\n      if (scrollTop === 0) {\n        li = liCollection[0];\n        filterElement = closest(li, '.' + AGENDA_CELLS_CLASS);\n      } else if (totalHeight === scrollHeight) {\n        li = liCollection[liCollection.length - 1];\n        filterElement = closest(li, '.' + AGENDA_CELLS_CLASS);\n      } else {\n        for (let a = 0, length = liCollection.length; a < length; a++) {\n          li = liCollection[a];\n          liDetails = li.getBoundingClientRect();\n\n          if (liDetails.top >= 0) {\n            filterElement = closest(li, '.' + AGENDA_CELLS_CLASS);\n            break;\n          }\n        }\n      }\n    }\n\n    return filterElement;\n  }\n\n  updateHeaderText(date) {\n    if (this.parent.showHeaderBar) {\n      this.parent.headerModule.updateDateRange(this.getDateRangeText(date));\n    }\n  }\n\n  getPreviousNextDate(date, type) {\n    let currentDate = new Date(date.getTime());\n    const firstDate = this.getStartDateFromEndDate(date);\n    const lastDate = this.getEndDateFromStartDate(date);\n    let daysCount = 0;\n\n    do {\n      const filterData = this.appointmentFiltering(currentDate);\n\n      if (filterData.length > 0 || !this.parent.hideEmptyAgendaDays) {\n        daysCount++;\n      }\n\n      currentDate = addDays(currentDate, type === 'next' ? 1 : -1);\n\n      if (currentDate < firstDate || currentDate > lastDate) {\n        break;\n      }\n    } while (daysCount !== this.parent.agendaDaysCount);\n\n    const endDate = addDays(currentDate, type === 'next' ? -1 : 1);\n    return type === 'next' ? {\n      start: date,\n      end: addDays(endDate, 1)\n    } : {\n      start: endDate,\n      end: addDays(date, 1)\n    };\n  }\n\n  appointmentFiltering(startDate, endDate) {\n    let dateStart;\n    let dateEnd;\n\n    if (!isNullOrUndefined(startDate) && isNullOrUndefined(endDate)) {\n      dateStart = resetTime(new Date(startDate.getTime()));\n      dateEnd = setTime(new Date(dateStart.getTime()), MS_PER_DAY);\n    } else {\n      dateStart = new Date(startDate.getTime());\n      dateEnd = new Date(endDate.getTime());\n    }\n\n    let filterData = this.parent.eventBase.filterEvents(dateStart, dateEnd);\n\n    if (filterData.length === 0) {\n      this.refreshEvent(startDate);\n      filterData = this.parent.eventBase.filterEvents(dateStart, dateEnd);\n    }\n\n    return filterData;\n  }\n\n  getStartDateFromEndDate(endDate) {\n    let filterDate;\n    const fields = this.parent.eventFields;\n\n    if (this.parent.eventsProcessed.length > 0) {\n      const firstDate = Math.min(...this.parent.eventsProcessed.map(a => a[fields.startTime].getTime()));\n      filterDate = this.parent.hideEmptyAgendaDays ? new Date(firstDate) : this.parent.minDate;\n    } else {\n      filterDate = this.parent.hideEmptyAgendaDays ? addMonths(endDate, -1) : this.parent.minDate;\n    }\n\n    return resetTime(filterDate);\n  }\n\n  getEndDateFromStartDate(startDate) {\n    let filterDate;\n    const fieldMapping = this.parent.eventFields;\n\n    if (this.parent.eventsProcessed.length > 0) {\n      const lastDate = Math.max(...this.parent.eventsProcessed.map(a => a[fieldMapping.endTime].getTime()));\n      filterDate = this.parent.hideEmptyAgendaDays ? new Date(lastDate) : this.parent.maxDate;\n    } else {\n      filterDate = this.parent.hideEmptyAgendaDays ? addMonths(startDate, 1) : this.parent.maxDate;\n    }\n\n    return resetTime(addDays(filterDate, 1));\n  }\n\n  getNextPreviousDate(type) {\n    const noOfDays = type === 'next' ? 1 : -1;\n    return addDays(this.parent.selectedDate, noOfDays);\n  }\n\n  startDate() {\n    return resetTime(this.parent.selectedDate);\n  }\n\n  endDate() {\n    if (this.parent.activeViewOptions.allowVirtualScrolling) {\n      return this.getEndDateFromStartDate(this.startDate());\n    } else {\n      return addDays(this.startDate(), this.parent.agendaDaysCount);\n    }\n  }\n\n  getDateRangeText(date) {\n    const formatDate = this.parent.activeViewOptions.dateFormat ? this.parent.activeViewOptions.dateFormat : 'MMMM y';\n\n    if (this.parent.activeViewOptions.allowVirtualScrolling || this.parent.isAdaptive) {\n      const currentDate = isNullOrUndefined(date) ? this.parent.selectedDate : date;\n      return capitalizeFirstWord(this.parent.globalize.formatDate(currentDate, {\n        format: formatDate,\n        calendar: this.parent.getCalendarMode()\n      }), 'multiple');\n    } else {\n      const startDate = this.parent.selectedDate;\n      const endDate = addDays(startDate, this.parent.agendaDaysCount - 1);\n      return this.formatDateRange(startDate, endDate);\n    }\n  }\n\n  dayNavigationClick(e) {\n    const element = closest(e.currentTarget, '.' + AGENDA_CELLS_CLASS);\n    const date = this.parent.getDateFromElement(element);\n\n    if (!isNullOrUndefined(date) && !this.parent.isAdaptive && this.parent.isMinMaxDate(date)) {\n      this.parent.setProperties({\n        selectedDate: date\n      }, true);\n      this.parent.changeView('Day', e);\n    }\n  }\n\n  wireEvents() {\n    EventHandler.add(this.element.querySelector('.' + CONTENT_WRAP_CLASS), scroll, this.agendaScrolling, this);\n  }\n\n  unWireEvents() {\n    EventHandler.remove(this.element.querySelector('.' + CONTENT_WRAP_CLASS), scroll, this.agendaScrolling);\n    const dateHeaderElement = [].slice.call(this.element.querySelectorAll('.e-m-date'));\n\n    for (const element of dateHeaderElement) {\n      EventHandler.remove(element, 'click', this.dayNavigationClick);\n    }\n  }\n\n  addEventListener() {\n    this.parent.on(scrollUiUpdate, this.onAgendaScrollUiUpdate, this);\n    this.parent.on(dataReady, this.eventLoad, this);\n  }\n\n  removeEventListener() {\n    if (this.parent) {\n      this.parent.off(scrollUiUpdate, this.onAgendaScrollUiUpdate);\n      this.parent.off(dataReady, this.eventLoad);\n    }\n  }\n\n  onAgendaScrollUiUpdate() {\n    const headerHeight = this.getHeaderBarHeight();\n\n    if (this.parent.headerModule) {\n      if (this.parent.activeViewOptions.allowVirtualScrolling) {\n        this.parent.headerModule.updateHeaderItems('add');\n      } else {\n        this.parent.headerModule.updateHeaderItems('remove');\n      }\n    }\n\n    const contentArea = this.element.querySelector('.' + CONTENT_WRAP_CLASS);\n\n    if (this.parent.height !== 'auto') {\n      contentArea.style.height = formatUnit(this.parent.element.offsetHeight - headerHeight);\n    }\n  }\n\n  destroy() {\n    if (!this.parent || this.parent && this.parent.isDestroyed) {\n      return;\n    }\n\n    if (this.element) {\n      this.unWireEvents();\n\n      if (this.parent.resourceBase) {\n        this.parent.resourceBase.destroy();\n      }\n\n      if (this.parent.headerModule && this.parent.activeViewOptions.allowVirtualScrolling) {\n        this.parent.headerModule.updateHeaderItems('remove');\n      }\n\n      super.destroy();\n    }\n  }\n\n}\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\n/**\n * month agenda view\n */\n\n\nclass MonthAgenda extends Month {\n  constructor(parent) {\n    super(parent);\n    this.dayNameFormat = 'narrow';\n    this.viewClass = 'e-month-agenda-view';\n    this.monthAgendaDate = new Date('' + parent.selectedDate);\n  }\n\n  getModuleName() {\n    return 'monthAgenda';\n  }\n\n  renderAppointmentContainer() {\n    const contentArea = this.getContentAreaElement();\n    const wrapperContainer = createElement('div', {\n      className: WRAPPER_CONTAINER_CLASS\n    });\n    contentArea.appendChild(wrapperContainer);\n    const appWrap = createElement('div', {\n      className: APPOINTMENT_WRAP_CLASS\n    });\n    wrapperContainer.appendChild(appWrap);\n    this.appendAppContainer(appWrap);\n    this.setEventWrapperHeight();\n  }\n\n  getDayNameFormat() {\n    if (this.parent.isAdaptive) {\n      return 'narrow';\n    }\n\n    return 'abbreviated';\n  }\n\n  setEventWrapperHeight() {\n    let headerHeight = (this.parent.headerModule ? this.parent.headerModule.getHeaderElement().offsetHeight : 0) + 2;\n    const resourceWrapper = this.parent.element.querySelector('.' + RESOURCE_HEADER_TOOLBAR);\n\n    if (resourceWrapper) {\n      headerHeight += resourceWrapper.offsetHeight;\n    }\n\n    const contentArea = this.getContentAreaElement().firstElementChild;\n    const dateHeader = this.element.querySelector('.' + DATE_HEADER_WRAP_CLASS);\n    const availHeight = this.parent.element.offsetHeight - headerHeight - dateHeader.offsetHeight - contentArea.offsetHeight;\n    const wrapperContainer = this.element.querySelector('.' + WRAPPER_CONTAINER_CLASS);\n    const eventWrapper = this.element.querySelector('.' + APPOINTMENT_WRAP_CLASS);\n\n    if (this.parent.height !== 'auto') {\n      wrapperContainer.style.height = eventWrapper.style.height = formatUnit(availHeight);\n    }\n  }\n\n  onDataReady(args) {\n    this.setEventWrapperHeight();\n    this.clearElements();\n    let eventCollection = args.processedData;\n\n    if (this.parent.uiStateValues.isGroupAdaptive) {\n      const resource = this.parent.resourceBase.lastResourceLevel[this.parent.uiStateValues.groupIndex];\n      eventCollection = this.parent.eventBase.filterEventsByResource(resource, eventCollection);\n    }\n\n    this.agendaBase = this.getAgendaBase();\n    this.parent.eventsProcessed = this.agendaBase.processAgendaEvents(eventCollection);\n    let count = 0;\n\n    for (const date of this.renderDates) {\n      const filterData = this.appointmentFiltering(date);\n      const workCell = this.element.querySelectorAll('.' + WORK_CELLS_CLASS)[count];\n\n      if (filterData.length > 0) {\n        if (!workCell.querySelector('.' + APPOINTMENT_INDICATOR_CLASS)) {\n          workCell.appendChild(createElement('div', {\n            className: APPOINTMENT_INDICATOR_CLASS\n          }));\n        }\n\n        if (date.getTime() === resetTime(new Date(this.monthAgendaDate.getTime())).getTime()) {\n          this.onEventRender(filterData, date);\n        }\n      }\n\n      count++;\n    }\n\n    this.parent.notify(eventsLoaded, {});\n  }\n\n  onCellClick(event) {\n    if (this.parent.quickPopup) {\n      this.parent.quickPopup.quickPopupHide();\n    }\n\n    const filterData = this.appointmentFiltering(event.startTime);\n    this.onEventRender(filterData, event.startTime);\n    this.parent.notify(eventsLoaded, {});\n    this.monthAgendaDate = new Date('' + event.startTime);\n  }\n\n  onEventRender(events, date) {\n    this.agendaBase = this.getAgendaBase();\n    const appWrap = this.element.querySelector('.' + APPOINTMENT_WRAP_CLASS);\n    removeChildren(appWrap);\n\n    if (this.parent.activeViewOptions.group.resources.length === 0 || this.parent.uiStateValues.isGroupAdaptive) {\n      if (events.length > 0) {\n        const appContainer = createElement('div', {\n          className: APPOINTMENT_CONTAINER_CLASS\n        });\n        appWrap.appendChild(this.agendaBase.createAgendaContentElement('data', events, appContainer));\n      } else {\n        this.appendAppContainer(appWrap);\n      }\n    } else {\n      if (events.length > 0) {\n        const table = this.createTableLayout();\n        const tBody = table.querySelector('tbody');\n        this.agendaBase.calculateResourceTableElement(tBody, 1, date);\n        table.appendChild(tBody);\n        appWrap.appendChild(table);\n      } else {\n        this.appendAppContainer(appWrap);\n      }\n    }\n\n    this.agendaBase.wireEventActions();\n  }\n\n  appointmentFiltering(date) {\n    const dateStart = resetTime(new Date(date.getTime()));\n    const dateEnd = setTime(new Date(dateStart.getTime()), MS_PER_DAY);\n    return this.parent.eventBase.filterEvents(dateStart, dateEnd);\n  }\n\n  clearElements() {\n    const appointmentIndicators = [].slice.call(this.element.querySelectorAll('.' + APPOINTMENT_INDICATOR_CLASS));\n\n    for (const appointmentIndicator of appointmentIndicators) {\n      remove(appointmentIndicator);\n    }\n\n    this.appendAppContainer(this.element.querySelector('.' + APPOINTMENT_WRAP_CLASS));\n  }\n\n  appendAppContainer(appWrap) {\n    const app = createElement('div', {\n      className: APPOINTMENT_CONTAINER_CLASS\n    });\n    addClass([app], AGENDA_NO_EVENT_CLASS);\n    app.innerHTML = this.parent.localeObj.getConstant('noEvents');\n    removeChildren(appWrap);\n    appWrap.appendChild(app);\n  }\n\n  getNextPreviousDate(type) {\n    const selectedDate = this.parent.selectedDate;\n    const interval = type === 'next' ? this.parent.activeViewOptions.interval : -this.parent.activeViewOptions.interval;\n    const navigateDate = addMonths(this.parent.selectedDate, interval);\n    const month = type === 'next' ? 2 : 0;\n    const lastDate = new Date(selectedDate.getFullYear(), selectedDate.getMonth() + month, 0).getDate();\n    const date = lastDate >= this.monthAgendaDate.getDate() ? this.monthAgendaDate.getDate() : lastDate;\n    this.monthAgendaDate = new Date(navigateDate.getFullYear(), navigateDate.getMonth(), date);\n    return this.monthAgendaDate;\n  }\n\n  getAgendaBase() {\n    return this.agendaBase || new AgendaBase(this.parent);\n  }\n\n  destroy() {\n    if (this.agendaBase) {\n      this.agendaBase.destroy();\n      this.agendaBase = null;\n    }\n\n    super.destroy();\n  }\n\n}\n/**\n * timeline header rows\n */\n\n\nclass TimelineHeaderRow {\n  constructor(parent, renderDates) {\n    this.parent = parent;\n    this.renderDates = renderDates;\n  }\n\n  groupByYear(dates) {\n    const result = {};\n\n    for (const d of dates) {\n      const key = d.getFullYear();\n      result[key] = result[key] || [];\n      result[key].push(d);\n    }\n\n    return result;\n  }\n\n  groupByMonth(dates) {\n    const result = {};\n\n    for (const d of dates) {\n      const key = (d.getFullYear() - 1970) * 12 + d.getMonth();\n      result[key] = result[key] || [];\n      result[key].push(d);\n    }\n\n    return result;\n  }\n\n  groupByWeek(dates) {\n    const result = {};\n\n    for (const d of dates) {\n      const jsDate = +new Date(1970, 0, 1);\n      const tzOffsetDiff = d.getTimezoneOffset() - new Date(1970, 0, 1).getTimezoneOffset();\n      let key = Math.ceil(((+d - jsDate - tzOffsetDiff * 60 * 1000) / MS_PER_DAY + new Date(jsDate).getDay() + 1) / 7);\n\n      if (this.parent.firstDayOfWeek && this.parent.firstDayOfWeek > new Date(+d).getDay()) {\n        key = key - 1;\n      }\n\n      result[key] = result[key] || [];\n      result[key].push(d);\n    }\n\n    return result;\n  }\n\n  generateSlots(data, colspan, row, cls, type) {\n    const dateParser = (date, format) => this.parent.globalize.formatDate(date, {\n      format: format,\n      calendar: this.parent.getCalendarMode()\n    });\n\n    const tdDatas = [];\n    const keys = Object.keys(data);\n\n    for (let i = 0; i < keys.length; i++) {\n      const dates = data[keys[i]];\n      let htmlCol;\n\n      if (row.template) {\n        const args = {\n          date: dates[0],\n          type: type\n        };\n        const templateId = this.parent.element.id + '_headerRowTemplate';\n        htmlCol = [].slice.call(this.parent.templateParser(row.template)(args, this.parent, 'template', templateId, false));\n      } else {\n        let viewTemplate;\n\n        switch (row.option) {\n          case 'Year':\n            viewTemplate = `<span class=\"e-header-year\">${dateParser(dates[0], 'y')}</span>`;\n            break;\n\n          case 'Month':\n            viewTemplate = `<span class=\"e-header-month\">${capitalizeFirstWord(dateParser(dates[0], 'MMMM'), 'single')}</span>`;\n            break;\n\n          case 'Week':\n            viewTemplate = `<span class=\"e-header-week\">${this.parent.getWeekNumberContent(dates)}</span>`;\n        }\n\n        const headerWrapper = createElement('div', {\n          innerHTML: viewTemplate\n        });\n        htmlCol = [].slice.call(headerWrapper.childNodes);\n      }\n\n      tdDatas.push({\n        date: dates[0],\n        type: type,\n        className: [cls],\n        colSpan: dates.length * colspan,\n        template: htmlCol\n      });\n    }\n\n    return tdDatas;\n  }\n\n  generateColumnLevels(dateSlots, hourSlots) {\n    const levels = [];\n    const rows = this.parent.activeViewOptions.headerRows;\n    let lastLevelColspan = 1;\n\n    if (rows[rows.length - 1].option === 'Hour' && hourSlots.length > 0) {\n      lastLevelColspan = hourSlots.length / dateSlots.length;\n    }\n\n    let tdDatas = [];\n    let byYear;\n    let byMonth;\n    let byWeek;\n\n    for (const row of rows) {\n      switch (row.option) {\n        case 'Year':\n          byYear = this.groupByYear(this.renderDates);\n          tdDatas = this.generateSlots(byYear, lastLevelColspan, row, 'e-header-year-cell', 'yearHeader');\n          levels.push(tdDatas);\n          break;\n\n        case 'Month':\n          byMonth = this.groupByMonth(this.renderDates);\n          tdDatas = this.generateSlots(byMonth, lastLevelColspan, row, 'e-header-month-cell', 'monthHeader');\n          levels.push(tdDatas);\n          break;\n\n        case 'Week':\n          byWeek = this.groupByWeek(this.renderDates);\n          tdDatas = this.generateSlots(byWeek, lastLevelColspan, row, 'e-header-week-cell', 'weekHeader');\n          levels.push(tdDatas);\n          break;\n\n        case 'Date':\n          tdDatas = dateSlots;\n          tdDatas = tdDatas.map(value => {\n            value.colSpan = lastLevelColspan;\n            return value;\n          });\n          levels.push(tdDatas);\n          break;\n\n        case 'Hour':\n          if (hourSlots.length > 0) {\n            levels.push(hourSlots);\n          }\n\n          break;\n      }\n    }\n\n    return levels;\n  }\n\n}\n/**\n * timeline views\n */\n\n\nclass TimelineViews extends VerticalView {\n  constructor(parent) {\n    super(parent);\n    this.timelineAppointment = null;\n    this.baseCssClass = 'e-timeline-view';\n  }\n\n  getModuleName() {\n    return 'timelineViews';\n  }\n\n  getLeftPanelElement() {\n    return this.element.querySelector('.' + RESOURCE_COLUMN_WRAP_CLASS);\n  }\n\n  scrollTopPanel(target) {\n    super.scrollTopPanel(target);\n    this.scrollHeaderLabels(target);\n  }\n\n  scrollToWorkHour() {\n    const start = this.parent.getStartEndTime(this.parent.workHours.start);\n    const currDateTime = this.isWorkDay(this.parent.selectedDate) && this.parent.workHours.highlight && !isNullOrUndefined(start) ? new Date(+this.parent.selectedDate).setHours(start.getHours(), start.getMinutes(), 0, 0) : new Date(+this.parent.selectedDate).setHours(0, 0, 0, 0);\n    const queryString = '[data-date=\"' + new Date(currDateTime).getTime().toString() + '\"]';\n    const firstWorkHourCell = this.element.querySelector(queryString);\n\n    if (firstWorkHourCell) {\n      this.getContentAreaElement().scrollLeft = !this.parent.enableRtl ? firstWorkHourCell.offsetLeft : -(this.parent.getContentTable().offsetWidth - firstWorkHourCell.offsetLeft - firstWorkHourCell.offsetWidth);\n    }\n  }\n\n  scrollToHour(hour, scrollDate) {\n    let date;\n    let index;\n\n    if (scrollDate) {\n      index = this.parent.getIndexOfDate(this.renderDates, resetTime(scrollDate));\n\n      if (index >= 0) {\n        const timeString = hour.split(':');\n\n        if (timeString.length === 2) {\n          date = new Date(scrollDate.setHours(parseInt(timeString[0], 10), parseInt(timeString[1], 10), 0));\n        }\n      }\n    }\n\n    date = isNullOrUndefined(scrollDate) ? this.parent.getStartEndTime(hour) : date;\n\n    if (isNullOrUndefined(date)) {\n      return;\n    }\n\n    const scrollLeft = isNullOrUndefined(scrollDate) ? this.getLeftFromDateTime(null, date) : this.getLeftFromDateTime([index], date);\n    this.getScrollableElement().scrollLeft = !this.parent.enableRtl ? scrollLeft : -scrollLeft;\n  }\n\n  generateColumnLevels() {\n    let levels = [];\n    const dateSlots = this.getDateSlots(this.renderDates, this.parent.activeViewOptions.workDays);\n    levels.push(dateSlots);\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      this.parent.resourceBase.generateResourceLevels(dateSlots, !this.parent.uiStateValues.isGroupAdaptive);\n    }\n\n    let hourSlots = [];\n\n    if (this.parent.activeViewOptions.timeScale.enable) {\n      hourSlots = this.generateTimeSlots(levels[levels.length - 1]);\n      levels.push(hourSlots);\n    }\n\n    if (this.parent.activeViewOptions.headerRows.length > 0) {\n      const renderGn = new TimelineHeaderRow(this.parent, this.renderDates);\n      levels = renderGn.generateColumnLevels(dateSlots, hourSlots);\n    }\n\n    return levels;\n  }\n\n  generateTimeSlots(dateSlots) {\n    const handler = r => {\n      r.type = r.first ? 'majorSlot' : 'minorSlot';\n      r.className = r.first ? [TIME_SLOT_CLASS] : [TIME_SLOT_CLASS, TIME_CELLS_CLASS];\n      r.workDays = this.parent.activeViewOptions.workDays;\n      return r;\n    };\n\n    const timeSlotData = this.getTimeSlotRows(handler);\n    const slots = [];\n\n    for (const data of dateSlots) {\n      data.colSpan = timeSlotData.length;\n      const tempTimeSlots = extend([], timeSlotData, null, true);\n\n      for (const slot of tempTimeSlots) {\n        const cellDate = resetTime(new Date('' + data.date));\n        slot.date = setTime(cellDate, getDateInMs(slot.date));\n        slots.push(slot);\n      }\n    }\n\n    return slots;\n  }\n\n  changeCurrentTimePosition() {\n    if (!this.parent || this.parent && this.parent.isDestroyed) {\n      return;\n    }\n\n    this.removeCurrentTimeIndicatorElements();\n    const currentDateIndex = this.getCurrentTimeIndicatorIndex();\n    const left = this.getLeftFromDateTime(currentDateIndex, this.parent.getCurrentTime());\n    const height = this.element.querySelector('.' + CONTENT_TABLE_CLASS).offsetHeight;\n    const headerWrap = this.element.querySelector('.' + DATE_HEADER_WRAP_CLASS);\n    const contentWrap = this.element.querySelector('.' + CONTENT_WRAP_CLASS);\n    contentWrap.appendChild(createElement('div', {\n      className: CURRENT_TIMELINE_CLASS,\n      styles: (this.parent.enableRtl ? 'right' : 'left') + ':' + formatUnit(left) + '; height:' + formatUnit(height)\n    }));\n\n    if (this.parent.virtualScrollModule) {\n      const timeIndicator = this.parent.element.querySelector('.' + CURRENT_TIMELINE_CLASS);\n      const element = this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS + ' table');\n      setStyleAttribute(timeIndicator, {\n        transform: element.style.transform\n      });\n    }\n\n    const currentTimeEle = createElement('div', {\n      innerHTML: this.parent.getTimeString(this.parent.getCurrentTime()),\n      className: CURRENT_TIME_CLASS\n    });\n    headerWrap.appendChild(currentTimeEle);\n    currentTimeEle.style[this.parent.enableRtl ? 'right' : 'left'] = formatUnit(left - currentTimeEle.offsetWidth / 2);\n  }\n\n  getLeftFromDateTime(currentDateIndex, date) {\n    const startHour = this.getStartHour();\n    const endHour = this.getEndHour();\n    let diffInDates = 0;\n    let diffInMinutes = (date.getHours() - startHour.getHours()) * 60 + (date.getMinutes() - startHour.getMinutes());\n\n    if (!isNullOrUndefined(currentDateIndex)) {\n      const end = endHour.getHours() === 0 ? 24 : endHour.getHours();\n\n      if (currentDateIndex[0] !== 0) {\n        diffInDates = currentDateIndex[0] * ((end - startHour.getHours()) * 60) + (endHour.getMinutes() - startHour.getMinutes());\n      }\n\n      diffInMinutes = diffInDates + diffInMinutes;\n    }\n\n    return diffInMinutes * this.getWorkCellWidth() * this.parent.activeViewOptions.timeScale.slotCount / this.parent.activeViewOptions.timeScale.interval;\n  }\n\n  getWorkCellWidth() {\n    return this.element.querySelector('.e-work-cells').getBoundingClientRect().width;\n  }\n\n  renderHeader() {\n    const tr = createElement('tr');\n\n    if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n      this.parent.resourceBase.renderResourceHeaderIndent(tr);\n    }\n\n    const dateTd = createElement('td');\n    dateTd.appendChild(this.renderDatesHeader());\n    tr.appendChild(dateTd);\n    prepend([tr], this.element.querySelector('tbody'));\n  } // eslint-disable-next-line @typescript-eslint/no-unused-vars\n\n\n  createAllDayRow(table, tdData) {}\n\n  getCurrentTimeIndicatorIndex() {\n    const currentDateIndex = [];\n    const index = this.parent.getIndexOfDate(this.renderDates, resetTime(this.parent.getCurrentTime()));\n\n    if (index >= 0) {\n      currentDateIndex.push(index);\n    }\n\n    return currentDateIndex;\n  }\n\n  renderContent() {\n    const tr = createElement('tr');\n\n    if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n      const resTd = createElement('td');\n      resTd.appendChild(this.parent.resourceBase.createResourceColumn());\n      tr.appendChild(resTd);\n    }\n\n    const workTd = createElement('td');\n    const wrap = this.renderContentArea();\n    wrap.appendChild(this.createEventTable(this.getRowCount()));\n    this.collapseRows(wrap);\n    workTd.appendChild(wrap);\n    tr.appendChild(workTd);\n\n    if (this.parent.virtualScrollModule) {\n      this.parent.virtualScrollModule.renderVirtualTrack(wrap);\n    }\n\n    this.element.querySelector('tbody').appendChild(tr);\n  }\n\n  getRowCount() {\n    if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n      return this.parent.resourceBase.renderedResources.length;\n    }\n\n    return 1;\n  }\n\n  getResourceTdData(i, tdData) {\n    const resLevel = this.parent.resourceBase.renderedResources[i];\n    const resSHr = resLevel.resourceData[resLevel.resource.startHourField] || this.parent.workHours.start;\n    const resEHr = resLevel.resourceData[resLevel.resource.endHourField] || this.parent.workHours.end;\n    tdData.startHour = this.parent.getStartEndTime(resSHr);\n    tdData.endHour = this.parent.getStartEndTime(resEHr);\n    tdData.workDays = resLevel.resourceData[resLevel.resource.workDaysField] || this.parent.workDays;\n    tdData.className = resLevel.className;\n    tdData.groupIndex = resLevel.groupIndex;\n    tdData.groupOrder = resLevel.groupOrder;\n    return tdData;\n  }\n\n  renderContentTable(table) {\n    const tBody = table.querySelector('tbody');\n    append(this.getContentRows(), tBody);\n  }\n\n  getContentRows() {\n    const rows = [];\n    const tr = createElement('tr', {\n      attrs: {\n        role: 'row'\n      }\n    });\n    const td = createElement('td', {\n      attrs: {\n        role: 'gridcell',\n        'aria-selected': 'false'\n      }\n    });\n    const trCount = this.getRowCount();\n\n    for (let i = 0; i < trCount; i++) {\n      const ntr = tr.cloneNode();\n\n      for (let tdData of this.colLevels[this.colLevels.length - 1]) {\n        if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n          tdData = this.getResourceTdData(i, tdData);\n        }\n\n        const ntd = this.createContentTd(tdData, tdData, td);\n        ntr.appendChild(ntd);\n      }\n\n      rows.push(ntr);\n    }\n\n    return rows;\n  }\n\n  getContentTdClass(r) {\n    return r.first || !this.parent.activeViewOptions.timeScale.enable ? [WORK_CELLS_CLASS] : [WORK_CELLS_CLASS, ALTERNATE_CELLS_CLASS];\n  }\n\n  renderEvents() {\n    this.timelineAppointment = new TimelineEvent(this.parent, this.parent.activeViewOptions.timeScale.enable ? 'hour' : 'day');\n    this.timelineAppointment.renderAppointments();\n    this.parent.notify(eventsLoaded, {});\n  }\n\n  getAdjustedDate(date) {\n    if (!this.parent.activeViewOptions.timeScale.enable) {\n      return new Date(date.setHours(0, 0, 0, 0));\n    } else {\n      const timeSlots = this.colLevels[this.colLevels.length - 1];\n\n      for (let i = 0; i < timeSlots.length; i++) {\n        if (timeSlots[i].date.getTime() > date.getTime()) {\n          return timeSlots[i - 1].date;\n        }\n      }\n    }\n\n    return null;\n  }\n\n  destroy() {\n    if (!this.parent || this.parent && this.parent.isDestroyed) {\n      return;\n    }\n\n    if (this.timelineAppointment) {\n      this.timelineAppointment.destroy();\n      this.timelineAppointment = null;\n    }\n\n    super.destroy();\n  }\n\n}\n/**\n * timeline month view\n */\n\n\nclass TimelineMonth extends Month {\n  constructor(parent) {\n    super(parent);\n    this.viewClass = 'e-timeline-month-view';\n    this.isInverseTableSelect = true;\n    this.appointment = null;\n  }\n\n  getModuleName() {\n    return 'timelineMonth';\n  }\n\n  onDataReady() {\n    this.appointment = new TimelineEvent(this.parent, 'day');\n    this.appointment.renderAppointments();\n    this.parent.notify(eventsLoaded, {});\n  }\n\n  getLeftPanelElement() {\n    return this.element.querySelector('.' + RESOURCE_COLUMN_WRAP_CLASS);\n  }\n\n  scrollTopPanel(target) {\n    super.scrollTopPanel(target);\n    this.scrollHeaderLabels(target);\n  }\n\n  setContentHeight(content, leftPanelElement, height) {\n    if (leftPanelElement) {\n      leftPanelElement.style.height = formatUnit(height - this.getScrollXIndent(content));\n    }\n\n    content.style.height = formatUnit(height);\n  }\n\n  getDateSlots(renderDates, workDays) {\n    const dateSlots = [];\n\n    for (const col of renderDates) {\n      const classList$$1 = [HEADER_CELLS_CLASS];\n\n      if (this.isCurrentDate(col)) {\n        classList$$1.push(CURRENT_DAY_CLASS);\n      }\n\n      dateSlots.push({\n        date: col,\n        type: 'dateHeader',\n        className: classList$$1,\n        colSpan: 1,\n        workDays: workDays\n      });\n    }\n\n    return dateSlots;\n  }\n\n  renderLeftIndent(tr) {\n    if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n      this.parent.resourceBase.renderResourceHeaderIndent(tr);\n    }\n  }\n\n  renderContent() {\n    const contentTr = createElement('tr');\n\n    if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n      const resTd = createElement('td');\n      resTd.appendChild(this.parent.resourceBase.createResourceColumn());\n      contentTr.appendChild(resTd);\n    }\n\n    const contentTd = createElement('td');\n    this.element.querySelector('tbody').appendChild(contentTr);\n    const wrap = createElement('div', {\n      className: CONTENT_WRAP_CLASS\n    });\n    wrap.appendChild(this.renderContentArea());\n    wrap.appendChild(this.createEventTable(this.getRowCount()));\n    this.collapseRows(wrap);\n    EventHandler.add(wrap, 'scroll', this.onContentScroll, this);\n    contentTd.appendChild(wrap);\n\n    if (this.parent.virtualScrollModule) {\n      this.parent.virtualScrollModule.renderVirtualTrack(wrap);\n    }\n\n    contentTr.appendChild(contentTd);\n  }\n\n  getRowCount() {\n    if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n      return this.parent.resourceBase.renderedResources.length;\n    }\n\n    return 1;\n  }\n\n  getContentSlots() {\n    const slotDatas = [];\n\n    for (let row = 0; row < this.getRowCount(); row++) {\n      for (const data of this.colLevels[this.colLevels.length - 1]) {\n        data.className = [WORK_CELLS_CLASS];\n\n        if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n          const resLevel = this.parent.resourceBase.renderedResources[row];\n          data.workDays = resLevel.resourceData[resLevel.resource.workDaysField] || this.parent.workDays;\n          data.className = data.className.concat(resLevel.className);\n          data.groupIndex = resLevel.groupIndex;\n          data.groupOrder = resLevel.groupOrder;\n        }\n\n        const slotData = {\n          date: new Date(+data.date),\n          colSpan: data.colSpan,\n          groupIndex: data.groupIndex,\n          workDays: data.workDays,\n          type: 'monthCells',\n          className: data.className\n        };\n\n        if (!slotDatas[row]) {\n          slotDatas[row] = [];\n        }\n\n        slotDatas[row].push(slotData);\n      }\n    }\n\n    return slotDatas;\n  }\n\n  updateClassList(data) {\n    if (!this.parent.isMinMaxDate(data.date)) {\n      data.className.push(DISABLE_DATES);\n    }\n  }\n\n  unWireEvents() {\n    EventHandler.remove(this.getContentAreaElement(), 'scroll', this.onContentScroll);\n  }\n\n  getMonthStart(currentDate) {\n    const monthStart = this.parent.calendarUtil.firstDateOfMonth(resetTime(currentDate));\n    return new Date(monthStart.getFullYear(), monthStart.getMonth(), monthStart.getDate());\n  }\n\n  getMonthEnd(currentDate) {\n    const monthStart = this.parent.calendarUtil.firstDateOfMonth(resetTime(currentDate));\n    return this.parent.calendarUtil.lastDateOfMonth(addMonths(new Date(+monthStart), this.parent.activeViewOptions.interval - 1));\n  }\n\n  generateColumnLevels() {\n    let colLevels = [];\n    const level = this.getDateSlots(this.renderDates, this.parent.activeViewOptions.workDays);\n    colLevels.push(level);\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      this.parent.resourceBase.generateResourceLevels(level, !this.parent.uiStateValues.isGroupAdaptive);\n    }\n\n    const hourSlots = [];\n\n    if (this.parent.activeViewOptions.headerRows.length > 0) {\n      const renderGn = new TimelineHeaderRow(this.parent, this.renderDates);\n      colLevels = renderGn.generateColumnLevels(level, hourSlots);\n    }\n\n    this.colLevels = colLevels;\n    return colLevels;\n  }\n\n  getAdjustedDate(startTime) {\n    const timeSlots = this.colLevels[this.colLevels.length - 1];\n\n    for (let i = 0; i < timeSlots.length; i++) {\n      if (timeSlots[i].date.getTime() > startTime.getTime()) {\n        return timeSlots[i - 1].date;\n      }\n    }\n\n    return null;\n  }\n\n  destroy() {\n    if (!this.parent || this.parent && this.parent.isDestroyed) {\n      return;\n    }\n\n    if (this.element) {\n      const contentScrollableEle = this.element.querySelector('.' + CONTENT_WRAP_CLASS);\n\n      if (contentScrollableEle) {\n        EventHandler.remove(contentScrollableEle, 'scroll', this.onContentScroll);\n      }\n    }\n\n    if (this.appointment) {\n      this.appointment.destroy();\n      this.appointment = null;\n    }\n\n    super.destroy();\n  }\n\n}\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\n/**\n * timeline year view\n */\n\n\nclass TimelineYear extends Year {\n  constructor(parent) {\n    super(parent);\n    this.viewClass = 'e-timeline-year-view';\n    this.isInverseTableSelect = true;\n  }\n\n  getModuleName() {\n    return 'timelineYear';\n  }\n\n  renderHeader(headerWrapper) {\n    const tr = createElement('tr');\n    headerWrapper.appendChild(tr);\n\n    if (this.parent.activeViewOptions.orientation === 'Vertical' && this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n      this.parent.resourceBase.renderResourceHeaderIndent(tr);\n    } else {\n      const leftHeaderCells = createElement('td', {\n        className: LEFT_INDENT_CLASS\n      });\n      tr.appendChild(leftHeaderCells);\n      leftHeaderCells.appendChild(this.renderResourceHeader(LEFT_INDENT_WRAP_CLASS));\n    }\n\n    const isHorizontal = this.parent.activeViewOptions.orientation === 'Horizontal';\n    const isGroup = this.parent.activeViewOptions.group.resources.length > 0;\n    this.isInverseTableSelect = isHorizontal && !isGroup ? false : true;\n    const td = createElement('td');\n    tr.appendChild(td);\n    const container = createElement('div', {\n      className: DATE_HEADER_CONTAINER_CLASS\n    });\n    td.appendChild(container);\n\n    if (this.parent.activeViewOptions.orientation === 'Horizontal' && this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n      container.appendChild(this.renderResourceHeader(DATE_HEADER_WRAP_CLASS));\n      this.columnCount = this.colLevels.slice(-1)[0].length;\n    } else {\n      const wrapper = createElement('div', {\n        className: DATE_HEADER_WRAP_CLASS\n      });\n      container.appendChild(wrapper);\n      const table = this.createTableLayout();\n      wrapper.appendChild(table);\n      table.appendChild(this.createTableColGroup(this.columnCount));\n      const innerTr = createElement('tr');\n      table.querySelector('tbody').appendChild(innerTr);\n      const months = this.getMonths();\n      const dayHeaderDates = this.getMonthDates(new Date(this.parent.selectedDate.getFullYear(), months[0], 1));\n\n      for (let column = 0; column < this.columnCount; column++) {\n        const date = new Date(this.parent.selectedDate.getFullYear(), months[column], 1);\n        const innerTd = createElement('td', {\n          className: HEADER_CELLS_CLASS\n        });\n\n        if (this.parent.activeViewOptions.orientation === 'Horizontal') {\n          if (this.parent.dayHeaderTemplate) {\n            append(this.renderDayMonthHeaderTemplate(dayHeaderDates[column], column, 'dayHeaderTemplate'), innerTd);\n          } else {\n            innerTd.innerHTML = `<span>${this.parent.getDayNames('abbreviated')[column % 7]}</span>`;\n          }\n        } else {\n          if (this.parent.monthHeaderTemplate) {\n            append(this.renderDayMonthHeaderTemplate(date, months[column], 'monthHeaderTemplate'), innerTd);\n          } else {\n            innerTd.innerHTML = `<span>${this.getMonthName(date)}</span>`;\n          }\n\n          innerTd.setAttribute('data-date', date.getTime().toString());\n        }\n\n        innerTr.appendChild(innerTd);\n        this.parent.trigger(renderCell, {\n          elementType: 'headerCells',\n          element: innerTd\n        });\n      }\n    }\n  }\n\n  renderResourceHeader(className) {\n    const wrap = createElement('div', {\n      className: className\n    });\n    const tbl = this.createTableLayout();\n    wrap.appendChild(tbl);\n    const trEle = createElement('tr');\n\n    if (this.parent.activeViewOptions.group.resources.length > 0) {\n      this.colLevels = this.generateColumnLevels();\n    } else {\n      const colData = [{\n        className: [HEADER_CELLS_CLASS],\n        type: 'headerCell'\n      }];\n      this.colLevels = [colData];\n    }\n\n    for (const col of this.colLevels) {\n      const ntr = trEle.cloneNode();\n      const count = className === DATE_HEADER_WRAP_CLASS ? col : [col[0]];\n\n      for (const c of count) {\n        const tdEle = createElement('td');\n\n        if (c.className) {\n          addClass([tdEle], c.className);\n        }\n\n        if (className === DATE_HEADER_WRAP_CLASS) {\n          if (c.template) {\n            append(c.template, tdEle);\n          }\n\n          if (c.colSpan) {\n            tdEle.setAttribute('colspan', c.colSpan.toString());\n          }\n\n          if (c.groupIndex > -1) {\n            tdEle.setAttribute('data-group-index', c.groupIndex.toString());\n          }\n\n          this.setResourceHeaderContent(tdEle, c);\n        }\n\n        if (className === LEFT_INDENT_WRAP_CLASS) {\n          this.parent.renderHeaderIndentTemplate(c, tdEle);\n        }\n\n        const args = {\n          elementType: c.type,\n          element: tdEle,\n          date: c.date,\n          groupIndex: c.groupIndex\n        };\n        this.parent.trigger(renderCell, args);\n        ntr.appendChild(tdEle);\n      }\n\n      tbl.querySelector('tbody').appendChild(ntr);\n    }\n\n    if (className === DATE_HEADER_WRAP_CLASS) {\n      tbl.appendChild(this.createTableColGroup(this.colLevels.slice(-1)[0].length));\n    }\n\n    return wrap;\n  }\n\n  renderContent(contentWrapper) {\n    const tr = createElement('tr');\n    contentWrapper.appendChild(tr);\n    const firstTd = createElement('td');\n    const lastTd = createElement('td');\n    const tdCollection = [];\n    let monthTBody;\n\n    if (this.parent.activeViewOptions.orientation === 'Vertical' && this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n      tdCollection.push(firstTd);\n      firstTd.appendChild(this.parent.resourceBase.createResourceColumn());\n      this.rowCount = this.parent.resourceBase.renderedResources.length;\n    } else {\n      tdCollection.push(firstTd);\n      const monthWrapper = createElement('div', {\n        className: MONTH_HEADER_WRAPPER\n      });\n      firstTd.appendChild(monthWrapper);\n      monthWrapper.appendChild(this.createTableLayout());\n      monthTBody = monthWrapper.querySelector('tbody');\n    }\n\n    tdCollection.push(lastTd);\n    append(tdCollection, tr);\n    const content = createElement('div', {\n      className: CONTENT_WRAP_CLASS\n    });\n    lastTd.appendChild(content);\n    const contentTable = this.createTableLayout(CONTENT_TABLE_CLASS);\n    content.appendChild(contentTable);\n    const eventWrapper = createElement('div', {\n      className: EVENT_TABLE_CLASS\n    });\n    content.appendChild(eventWrapper);\n\n    if (this.parent.virtualScrollModule) {\n      this.parent.virtualScrollModule.renderVirtualTrack(content);\n    }\n\n    const contentTBody = contentTable.querySelector('tbody');\n\n    if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n      if (this.parent.rowAutoHeight) {\n        const addClassTable = [contentTable];\n        const monthHeader = this.parent.element.querySelector('.' + MONTH_HEADER_WRAPPER + ' .' + SCHEDULE_TABLE_CLASS);\n\n        if (monthHeader) {\n          addClassTable.push(monthHeader);\n        }\n\n        addClass(addClassTable, AUTO_HEIGHT);\n      }\n\n      const colCount = this.parent.activeViewOptions.orientation === 'Horizontal' ? this.colLevels.slice(-1)[0].length : this.columnCount;\n      contentTable.appendChild(this.createTableColGroup(colCount));\n      this.renderResourceContent(eventWrapper, monthTBody, contentTBody);\n    } else {\n      contentTable.appendChild(this.createTableColGroup(this.columnCount));\n      this.renderDefaultContent(eventWrapper, monthTBody, contentTBody);\n    }\n  }\n\n  renderDefaultContent(wrapper, monthBody, contentBody) {\n    const months = this.getMonths();\n    const dayHeaderDates = this.getMonthDates(new Date(this.parent.selectedDate.getFullYear(), months[0], 1));\n\n    for (let month = 0; month < this.rowCount; month++) {\n      wrapper.appendChild(createElement('div', {\n        className: APPOINTMENT_CONTAINER_CLASS\n      }));\n      let monthDate = new Date(this.parent.selectedDate.getFullYear(), months[month], 1);\n      let monthStart = this.parent.calendarUtil.getMonthStartDate(new Date(monthDate.getTime()));\n      let monthEnd = this.parent.calendarUtil.getMonthEndDate(new Date(monthDate.getTime()));\n      const tr = createElement('tr', {\n        attrs: {\n          'role': 'row'\n        }\n      });\n      const monthTr = tr.cloneNode();\n      monthBody.appendChild(monthTr);\n      const contentTr = tr.cloneNode();\n      contentBody.appendChild(contentTr);\n      const monthTd = createElement('td', {\n        className: MONTH_HEADER_CLASS,\n        attrs: {\n          'role': 'gridcell'\n        }\n      });\n\n      if (this.parent.activeViewOptions.orientation === 'Horizontal') {\n        if (this.parent.monthHeaderTemplate) {\n          append(this.renderDayMonthHeaderTemplate(monthStart, month, 'monthHeaderTemplate'), monthTd);\n        } else {\n          monthTd.innerHTML = `<span>${this.getMonthName(monthDate)}</span>`;\n        }\n\n        monthTd.setAttribute('data-date', monthDate.getTime().toString());\n      } else {\n        if (this.parent.dayHeaderTemplate) {\n          append(this.renderDayMonthHeaderTemplate(dayHeaderDates[month], month, 'dayHeaderTemplate'), monthTd);\n        } else {\n          monthTd.innerHTML = `<span>${this.parent.getDayNames('abbreviated')[month % 7]}</span>`;\n        }\n      }\n\n      monthTr.appendChild(monthTd);\n      this.parent.trigger(renderCell, {\n        elementType: 'leftHeaderCells',\n        element: monthTd\n      });\n      let date = new Date(monthStart.getTime());\n\n      for (let column = 0; column < this.columnCount; column++) {\n        let isDateAvail;\n\n        if (this.parent.activeViewOptions.orientation === 'Vertical') {\n          monthDate = new Date(this.parent.selectedDate.getFullYear(), months[column], 1);\n          monthStart = this.parent.calendarUtil.getMonthStartDate(new Date(monthDate.getTime()));\n          monthEnd = this.parent.calendarUtil.getMonthEndDate(new Date(monthDate.getTime()));\n          const dayDate = month - monthStart.getDay() + 1;\n          date = new Date(this.parent.selectedDate.getFullYear(), months[column], dayDate);\n          isDateAvail = dayDate > 0 && date.getTime() < monthEnd.getTime();\n        } else {\n          isDateAvail = column >= monthStart.getDay() && date.getTime() < monthEnd.getTime();\n        }\n\n        const td = createElement('td', {\n          className: WORK_CELLS_CLASS,\n          attrs: {\n            'role': 'gridcell',\n            'aria-selected': 'false'\n          }\n        });\n        contentTr.appendChild(td);\n        const dateHeader = createElement('div', {\n          className: DATE_HEADER_CLASS + ' ' + NAVIGATE_CLASS,\n          innerHTML: isDateAvail ? this.parent.globalize.formatDate(date, {\n            skeleton: 'd',\n            calendar: this.parent.getCalendarMode()\n          }) : ''\n        });\n        const skeleton = 'full';\n        const announcementText = this.parent.globalize.formatDate(date, {\n          skeleton: skeleton,\n          calendar: this.parent.getCalendarMode()\n        });\n        dateHeader.setAttribute('aria-label', announcementText);\n\n        if (isDateAvail) {\n          const tds = [td];\n          const classList$$1 = [];\n\n          if (this.parent.activeViewOptions.workDays.indexOf(date.getDay()) > -1) {\n            classList$$1.push(WORKDAY_CLASS);\n          }\n\n          if (this.isCurrentDate(date)) {\n            classList$$1.push(CURRENT_DAY_CLASS);\n\n            if (this.parent.activeViewOptions.orientation === 'Horizontal') {\n              tds.push(this.element.querySelector('.' + HEADER_CELLS_CLASS + `:nth-child(${column + 1})`));\n            } else {\n              tds.push(this.element.querySelectorAll('.' + MONTH_HEADER_CLASS).item(month));\n            }\n          }\n\n          if (classList$$1.length > 0) {\n            addClass(tds, classList$$1);\n          }\n        } else {\n          addClass([td], OTHERMONTH_CLASS);\n        }\n\n        if (td.classList.contains(OTHERMONTH_CLASS)) {\n          continue;\n        }\n\n        td.appendChild(dateHeader);\n\n        if (isDateAvail) {\n          td.setAttribute('data-date', date.getTime().toString());\n          this.wireEvents(td, 'cell');\n        }\n\n        this.renderCellTemplate({\n          date: date,\n          type: 'workCells'\n        }, td);\n        this.parent.trigger(renderCell, {\n          elementType: 'workCells',\n          element: td,\n          date: date\n        });\n\n        if (isDateAvail) {\n          if (this.parent.activeViewOptions.orientation === 'Horizontal') {\n            date = addDays(new Date(date.getTime()), 1);\n          }\n        }\n      }\n    }\n  }\n\n  getContentRows() {\n    const tRow = [];\n    const monthCells = this.getMonths();\n\n    for (let row = 0; row < this.parent.resourceBase.renderedResources.length; row++) {\n      const tr = createElement('tr', {\n        attrs: {\n          'role': 'row'\n        }\n      });\n      tRow.push(tr);\n      let resData;\n\n      if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n        resData = this.parent.resourceBase.renderedResources[row];\n      }\n\n      let monthDate = new Date(this.parent.selectedDate.getFullYear(), monthCells[row], 1);\n      let date = this.parent.calendarUtil.getMonthStartDate(new Date(monthDate.getTime()));\n\n      for (let month = 0; month < this.columnCount; month++) {\n        let classList$$1 = [];\n        const groupIndex = resData.groupIndex;\n        classList$$1 = classList$$1.concat(resData.className);\n\n        if (classList$$1.indexOf(RESOURCE_PARENT_CLASS) > -1) {\n          classList$$1.push(RESOURCE_GROUP_CELLS_CLASS);\n        } else {\n          classList$$1.push(WORKDAY_CLASS);\n        }\n\n        monthDate = new Date(this.parent.selectedDate.getFullYear(), monthCells[month], 1);\n        date = this.parent.calendarUtil.getMonthStartDate(new Date(monthDate.getTime()));\n        const tdELe = createElement('td', {\n          className: WORK_CELLS_CLASS,\n          attrs: {\n            'role': 'gridcell',\n            'aria-selected': 'false',\n            'data-date': date.getTime().toString()\n          }\n        });\n        addClass([tdELe], classList$$1);\n        tdELe.setAttribute('data-group-index', groupIndex.toString());\n        this.renderCellTemplate({\n          date: date,\n          type: 'resourceGroupCells',\n          groupIndex: groupIndex\n        }, tdELe);\n        this.wireEvents(tdELe, 'cell');\n        this.parent.trigger(renderCell, {\n          elementType: 'resourceGroupCells',\n          element: tdELe,\n          date: date\n        });\n        tr.appendChild(tdELe);\n      }\n    }\n\n    return tRow;\n  }\n\n  renderResourceContent(wrapper, monthBody, contentBody) {\n    const months = this.getMonths();\n\n    for (let row = 0; row < this.rowCount; row++) {\n      wrapper.appendChild(createElement('div', {\n        className: APPOINTMENT_CONTAINER_CLASS\n      }));\n      const tr = createElement('tr', {\n        attrs: {\n          'role': 'row'\n        }\n      });\n      contentBody.appendChild(tr);\n      let resData;\n\n      if (this.parent.activeViewOptions.orientation === 'Vertical' && this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n        resData = this.parent.resourceBase.renderedResources[row];\n      }\n\n      let monthDate = new Date(this.parent.selectedDate.getFullYear(), months[row], 1);\n      let date = this.parent.calendarUtil.getMonthStartDate(new Date(monthDate.getTime()));\n\n      if (this.parent.activeViewOptions.orientation === 'Horizontal') {\n        const monthTr = tr.cloneNode();\n        monthBody.appendChild(monthTr);\n        const monthTd = createElement('td', {\n          className: MONTH_HEADER_CLASS,\n          attrs: {\n            'role': 'gridcell',\n            'data-date': date.getTime().toString()\n          }\n        });\n\n        if (this.parent.monthHeaderTemplate) {\n          append(this.renderDayMonthHeaderTemplate(monthDate, row, 'monthHeaderTemplate'), monthTd);\n        } else {\n          monthTd.innerHTML = `<span>${this.getMonthName(monthDate)}</span>`;\n        }\n\n        monthTr.appendChild(monthTd);\n      }\n\n      for (let month = 0; month < this.columnCount; month++) {\n        let classList$$1 = [];\n        let groupIndex;\n\n        if (this.parent.activeViewOptions.orientation === 'Vertical') {\n          groupIndex = resData.groupIndex;\n          classList$$1 = classList$$1.concat(resData.className);\n\n          if (classList$$1.indexOf(RESOURCE_PARENT_CLASS) > -1) {\n            classList$$1.push(RESOURCE_GROUP_CELLS_CLASS);\n          } else {\n            classList$$1.push(WORKDAY_CLASS);\n          }\n\n          monthDate = new Date(this.parent.selectedDate.getFullYear(), months[month], 1);\n          date = this.parent.calendarUtil.getMonthStartDate(new Date(monthDate.getTime()));\n        } else {\n          groupIndex = this.colLevels.slice(-1)[0][month].groupIndex;\n          classList$$1.push(WORKDAY_CLASS);\n        }\n\n        const td = createElement('td', {\n          className: WORK_CELLS_CLASS,\n          attrs: {\n            'role': 'gridcell',\n            'aria-selected': 'false',\n            'data-date': date.getTime().toString()\n          }\n        });\n        addClass([td], classList$$1);\n        td.setAttribute('data-group-index', groupIndex.toString());\n        this.renderCellTemplate({\n          date: date,\n          type: 'resourceGroupCells',\n          groupIndex: groupIndex\n        }, td);\n        this.wireEvents(td, 'cell');\n        tr.appendChild(td);\n        this.parent.trigger(renderCell, {\n          elementType: 'resourceGroupCells',\n          element: td,\n          date: date\n        });\n      }\n    }\n\n    if (this.parent.activeViewOptions.orientation === 'Vertical') {\n      this.collapseRows(this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS));\n    }\n  }\n\n  renderDayMonthHeaderTemplate(date, column, type) {\n    const args = {\n      date: date,\n      type: type === 'dayHeaderTemplate' ? 'dayHeader' : 'monthHeader'\n    };\n    const dayId = `schedule_${this.parent.activeViewOptions.dayHeaderTemplateName}dayHeaderTemplate`;\n    const monthId = `schedule_${this.parent.activeViewOptions.dayHeaderTemplateName}monthHeaderTemplate`;\n\n    if (type === 'dayHeaderTemplate') {\n      args.day = this.parent.getDayNames('wide')[column % 7];\n      return [].slice.call(this.parent.getDayHeaderTemplate()(args, this.parent, 'dayHeaderTemplate', dayId, false));\n    } else {\n      return [].slice.call(this.parent.getMonthHeaderTemplate()(args, this.parent, 'monthHeaderTemplate', monthId, false));\n    }\n  }\n\n  renderCellTemplate(data, td) {\n    if (!this.parent.activeViewOptions.cellTemplate || td.classList.contains(OTHERMONTH_CLASS)) {\n      return;\n    }\n\n    const args = {\n      date: data.date,\n      type: data.type\n    };\n\n    if (data.groupIndex) {\n      args.groupIndex = data.groupIndex;\n    }\n\n    const scheduleId = this.parent.element.id + '_';\n    const viewName = this.parent.activeViewOptions.cellTemplateName;\n    const templateId = scheduleId + viewName + 'cellTemplate';\n    const cellTemplate = [].slice.call(this.parent.getCellTemplate()(args, this.parent, 'cellTemplate', templateId, false));\n    append(cellTemplate, td);\n  }\n\n  scrollToDate(scrollDate) {\n    if (this.parent.activeViewOptions.group.resources.length === 0) {\n      const date = +new Date(resetTime(scrollDate));\n      const element = this.element.querySelector('[data-date=\"' + date + '\"]');\n\n      if (element) {\n        this.getScrollableElement().scrollLeft = element.offsetLeft;\n        this.getScrollableElement().scrollTop = element.offsetTop;\n      }\n    }\n  }\n\n  getScrollableElement() {\n    if (this.parent.isAdaptive && !this.isTimelineView()) {\n      return this.element.querySelector('.' + SCROLL_CONTAINER_CLASS);\n    } else {\n      return this.getContentAreaElement();\n    }\n  }\n\n}\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\n/**\n * ICalendar Export Module\n */\n\n\nclass ICalendarExport {\n  constructor(parent) {\n    this.parent = parent;\n  }\n\n  initializeCalendarExport(fileName, customData) {\n    let eventsData = customData ? customData : extend([], this.parent.eventsData, null, true);\n    eventsData = this.parent.eventBase.sortByTime(eventsData);\n    const SEPARATOR = navigator.appVersion.indexOf('Win') !== -1 ? '\\r\\n' : '\\n';\n    const iCalendarEvents = [];\n    const filterCollection = [];\n    const timeZone = this.parent.timezone || this.parent.tzModule.getLocalTimezoneName();\n    const fields = this.parent.eventFields;\n    eventsData.forEach(eventObj => {\n      let uId = eventObj[fields.id] || eventObj.Guid || this.parent.eventBase.generateGuid();\n      const editedExDate = [];\n\n      if (eventObj[fields.recurrenceID]) {\n        const filter = this.filterEvents(filterCollection, fields.id, eventObj[fields.recurrenceID]);\n        uId = filter.length > 0 ? filter[0].UID : uId;\n      }\n\n      if (!eventObj[fields.recurrenceID] && eventObj[fields.recurrenceRule] && eventObj[fields.recurrenceException]) {\n        const exDate = eventObj[fields.recurrenceException].split(',');\n        const editedObj = this.filterEvents(eventsData, fields.recurrenceID, eventObj[fields.id]);\n        editedObj.forEach(edited => {\n          editedExDate.push(getRecurrenceStringFromDate(edited[fields.startTime]));\n        });\n        const exceptionDateList = exDate.filter(value => editedExDate.indexOf(value) === -1);\n        eventObj[fields.recurrenceException] = exceptionDateList.length > 0 ? exceptionDateList.join(',') + ',' : '';\n      }\n\n      const startZone = eventObj[fields.startTimezone] || timeZone;\n      const endZone = eventObj[fields.endTimezone] || timeZone;\n      const readonly = eventObj[fields.isReadonly] ? eventObj[fields.isReadonly] : false;\n      const calendarEvent = ['BEGIN:VEVENT', 'LOCATION:' + (eventObj[fields.location] || ''), 'SUMMARY:' + (eventObj[fields.subject] || ''), 'UID:' + uId, 'DESCRIPTION:' + (eventObj[fields.description] || ''), 'ISREADONLY:' + readonly, 'END:VEVENT'];\n\n      if (eventObj[fields.isAllDay]) {\n        calendarEvent.splice(4, 0, 'DTEND;VALUE=DATE:' + this.convertDateToString(eventObj[fields.endTime], true));\n        calendarEvent.splice(4, 0, 'DTSTART;VALUE=DATE:' + this.convertDateToString(eventObj[fields.startTime], true));\n      } else if (!eventObj[fields.isAllDay] && !eventObj[fields.recurrenceRule]) {\n        calendarEvent.splice(4, 0, 'DTEND:' + this.convertDateToString(eventObj[fields.endTime]));\n        calendarEvent.splice(4, 0, 'DTSTART:' + this.convertDateToString(eventObj[fields.startTime]));\n      } else {\n        calendarEvent.splice(4, 0, 'DTEND;TZID=\"' + endZone + '\":' + this.convertDateToString(eventObj[fields.endTime]));\n        calendarEvent.splice(4, 0, 'DTSTART;TZID=\"' + startZone + '\":' + this.convertDateToString(eventObj[fields.startTime]));\n      }\n\n      if (eventObj[fields.recurrenceRule]) {\n        calendarEvent.splice(4, 0, 'RRULE:' + eventObj[fields.recurrenceRule]);\n      }\n\n      if (eventObj[fields.recurrenceException]) {\n        const exDate = eventObj[fields.recurrenceException].split(',');\n\n        for (let i = 0; i < exDate.length - 1; i++) {\n          calendarEvent.splice(5, 0, 'EXDATE:' + this.convertDateToString(getDateFromRecurrenceDateString(exDate[i]), eventObj[fields.isAllDay]));\n        }\n      }\n\n      if (eventObj[fields.recurrenceID]) {\n        calendarEvent.splice(4, 0, 'RECURRENCE-ID;TZID=\"' + startZone + '\":' + this.convertDateToString(eventObj[fields.startTime], eventObj[fields.isAllDay]));\n      }\n\n      const customFields = this.customFieldFilter(eventObj, fields);\n\n      if (customFields.length > 0) {\n        customFields.forEach(customField => calendarEvent.splice(4, 0, customField + ':' + (eventObj[customField] || '')));\n      }\n\n      const app = extend({}, eventObj);\n      app.UID = uId;\n      filterCollection.push(app);\n      iCalendarEvents.push(calendarEvent.join(SEPARATOR));\n    });\n    const iCalendar = ['BEGIN:VCALENDAR', 'PRODID:-//Syncfusion Inc//Scheduler//EN', 'VERSION:2.0', 'CALSCALE:GREGORIAN', 'METHOD:PUBLISH', 'X-WR-CALNAME:' + (fileName || 'Calendar'), 'X-WR-TIMEZONE:' + timeZone].join(SEPARATOR);\n    const icsString = iCalendar + SEPARATOR + iCalendarEvents.join(SEPARATOR) + SEPARATOR + 'END:VCALENDAR';\n    this.download(icsString, fileName);\n  }\n\n  customFieldFilter(eventObj, fields) {\n    const defaultFields = Object.keys(fields).map(key => fields[key]);\n    const eventFields = Object.keys(eventObj);\n    return eventFields.filter(value => defaultFields.indexOf(value) === -1 && value !== 'Guid');\n  }\n\n  convertDateToString(eventDate, allDay) {\n    const year = ('0000' + eventDate.getFullYear().toString()).slice(-4);\n    const month = ('00' + (eventDate.getMonth() + 1).toString()).slice(-2);\n    const date = ('00' + eventDate.getDate().toString()).slice(-2);\n    const hours = ('00' + eventDate.getHours().toString()).slice(-2);\n    const minutes = ('00' + eventDate.getMinutes().toString()).slice(-2);\n    const seconds = ('00' + eventDate.getSeconds().toString()).slice(-2);\n    const timeString = allDay ? year + month + date : year + month + date + 'T' + hours + minutes + seconds;\n    return timeString;\n  }\n\n  download(icsString, fileName) {\n    const buffer = new Blob([icsString], {\n      type: 'data:text/calendar;charset=utf8'\n    });\n    fileName = (fileName || 'Calendar') + '.ics';\n\n    if (navigator.msSaveBlob) {\n      navigator.msSaveBlob(buffer, fileName);\n    } else {\n      const downloadLink = document.createElementNS('http://www.w3.org/1999/xhtml', 'a');\n      downloadLink.download = fileName;\n      downloadLink.href = URL.createObjectURL(buffer);\n      const event = document.createEvent('MouseEvent');\n      event.initEvent('click', true, true);\n      downloadLink.dispatchEvent(event);\n      setTimeout(() => {\n        URL.revokeObjectURL(downloadLink.href);\n        downloadLink.href = undefined;\n      });\n    }\n  }\n\n  filterEvents(data, field, value) {\n    return data.filter(e => e[field] === value);\n  }\n\n  getModuleName() {\n    return 'iCalendarExport';\n  }\n\n  destroy() {\n    if (!this.parent || this.parent && this.parent.isDestroyed) {\n      return;\n    }\n\n    this.parent = null;\n  }\n\n}\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\n/**\n * ICalendar Import Module\n */\n\n\nclass ICalendarImport {\n  constructor(parent) {\n    this.allDay = false;\n    this.parent = parent;\n  }\n\n  initializeCalendarImport(fileContent) {\n    if (fileContent && fileContent instanceof Blob) {\n      const fileReader = new FileReader();\n\n      fileReader.onload = () => {\n        const iCalString = fileReader.result;\n        this.iCalendarParser(iCalString);\n      };\n\n      fileReader.readAsText(fileContent, 'UTF-8');\n    } else if (fileContent && typeof fileContent === 'string') {\n      this.iCalendarParser(fileContent);\n    }\n  }\n\n  iCalendarParser(iCalString) {\n    const fields = this.parent.eventFields;\n    const events = [];\n    const uId = 'UID';\n    const calArray = iCalString.replace(new RegExp('\\\\r', 'g'), '').split('\\n');\n    let isEvent = false;\n    let curEvent; // eslint-disable-next-line prefer-const\n\n    let id = this.parent.eventBase.getEventMaxID();\n    let count = 0;\n    calArray.forEach(element => {\n      let index;\n      let type;\n      let value;\n\n      if (!isEvent && element === 'BEGIN:VEVENT') {\n        isEvent = true;\n        curEvent = {};\n      }\n\n      if (isEvent && element === 'END:VEVENT') {\n        isEvent = false;\n        events.push(curEvent);\n        curEvent = null;\n      }\n\n      if (isEvent) {\n        index = element.indexOf(':');\n        type = element.substr(0, index).replace(/^\\s\\s*/, '').replace(/\\s\\s*$/, '');\n        value = element.substr(index + 1, element.length - (index + 1)).replace(/^\\s\\s*/, '').replace(/\\s\\s*$/, '');\n\n        if (element.indexOf('SUMMARY') !== -1) {\n          type = 'SUMMARY';\n        }\n\n        if (element.indexOf('DTSTART') !== -1) {\n          curEvent[fields.startTime] = this.dateParsing(element);\n          curEvent[fields.isAllDay] = this.allDay;\n          this.allDay = false;\n        } else if (element.indexOf('DTEND') !== -1) {\n          curEvent[fields.endTime] = this.dateParsing(element);\n        } else if (element.indexOf('EXDATE') !== -1) {\n          value = getRecurrenceStringFromDate(this.dateParsing(element));\n          curEvent[fields.recurrenceException] = isNullOrUndefined(curEvent[fields.recurrenceException]) ? value : curEvent[fields.recurrenceException] + ',' + value;\n        } else if (element.indexOf('RECURRENCE-ID') !== -1) {\n          value = getRecurrenceStringFromDate(this.dateParsing(element));\n          curEvent[fields.recurrenceException] = value;\n          curEvent[fields.recurrenceID] = value;\n        } else {\n          switch (type) {\n            case 'BEGIN':\n              break;\n\n            case 'UID':\n              curEvent[uId] = value;\n\n              if (typeof id == 'number') {\n                curEvent[fields.id] = parseInt(value, 10);\n\n                if (isNaN(curEvent[fields.id])) {\n                  curEvent[fields.id] = id + count;\n                  count++;\n                }\n              } else {\n                curEvent[fields.id] = value;\n              }\n\n              break;\n\n            case 'SUMMARY':\n              curEvent[fields.subject] = value;\n              break;\n\n            case 'LOCATION':\n              curEvent[fields.location] = value;\n              break;\n\n            case 'DESCRIPTION':\n              curEvent[fields.description] = value;\n              break;\n\n            case 'ISREADONLY':\n              curEvent[fields.isReadonly] = value.indexOf('true') > -1;\n              break;\n\n            case 'RRULE':\n              curEvent[fields.recurrenceRule] = value;\n              break;\n\n            default:\n              if (this.parent.resourceCollection.length > 0) {\n                const resData = this.parent.resourceCollection.filter(data => data.field === type);\n                curEvent[type] = resData.length > 0 && typeof resData[0].dataSource[0][resData[0].idField] == 'number' ? parseInt(value, 10) : value;\n              } else {\n                curEvent[type] = value;\n              }\n\n          }\n        }\n      }\n    });\n    const app = extend([], events, null, true);\n    this.parent.addEvent(this.processOccurrence(app));\n  }\n\n  processOccurrence(app) {\n    const appoint = [];\n    const uId = 'UID';\n    const fields = this.parent.eventFields;\n    let appointmentIds = [];\n    this.parent.eventsData.forEach(eventObj => {\n      appointmentIds.push(eventObj[fields.id]);\n    });\n    app.forEach(eventObj => {\n      let parentObj;\n      let id; // eslint-disable-next-line no-prototype-builtins\n\n      if (!eventObj.hasOwnProperty(fields.recurrenceID)) {\n        parentObj = eventObj;\n        id = eventObj[fields.id];\n      }\n\n      if (appointmentIds.indexOf(eventObj[fields.id]) < 0) {\n        const data = app.filter(data => data.UID === eventObj[uId]);\n\n        if (data.length > 1 && isNullOrUndefined(eventObj[fields.recurrenceID])) {\n          for (let i = 0; i < data.length; i++) {\n            // eslint-disable-next-line no-prototype-builtins\n            if (data[i].hasOwnProperty(fields.recurrenceID)) {\n              const exdate = data[i][fields.recurrenceID];\n              data[i][fields.recurrenceID] = id;\n              data[i][fields.recurrenceException] = null;\n              parentObj[fields.recurrenceException] = isNullOrUndefined(parentObj[fields.recurrenceException]) ? exdate : parentObj[fields.recurrenceException] + ',' + exdate;\n              appoint.push(data[i]);\n            }\n          }\n\n          appoint.push(parentObj); // eslint-disable-next-line no-prototype-builtins\n        } else if (!eventObj.hasOwnProperty(fields.recurrenceID)) {\n          appoint.push(eventObj);\n        }\n      }\n    });\n    return appoint;\n  }\n\n  getDateString(value) {\n    value = value || ''; // eslint-disable-next-line no-useless-escape\n\n    return value.replace(/\\\\\\,/g, ',').replace(/\\\\\\;/g, ';').replace(/\\\\[nN]/g, '\\n').replace(/\\\\\\\\/g, '\\\\');\n  }\n\n  dateParsing(element) {\n    const expression = /([^':;]+)((?:;(?:[^':;]+)(?:=(?:(?:'[^']*')|(?:[^':;]+))))*):(.*)/;\n    const split = element.match(expression).slice(1);\n    const value = split[split.length - 1];\n    let newDate = new Date(this.getDateString(value));\n\n    if (element && (element.indexOf('VALUE=DATE') > -1 || element.indexOf('RECURRENCE-ID;TZID') > -1)) {\n      const data = /^(\\d{4})(\\d{2})(\\d{2})$/.exec(value);\n\n      if (data !== null) {\n        newDate = new Date(parseInt(data[1], 10), parseInt(data[2], 10) - 1, parseInt(data[3], 10));\n      }\n\n      if (element.indexOf('DTSTART') > -1) {\n        this.allDay = true;\n      }\n    }\n\n    const data = /^(\\d{4})(\\d{2})(\\d{2})T(\\d{2})(\\d{2})(\\d{2})(Z)?$/.exec(value);\n\n    if (data !== null) {\n      if (data[7] === 'Z') {\n        newDate = new Date(Date.UTC(parseInt(data[1], 10), parseInt(data[2], 10) - 1, parseInt(data[3], 10), parseInt(data[4], 10), parseInt(data[5], 10), parseInt(data[6], 10)));\n      } else {\n        newDate = new Date(parseInt(data[1], 10), parseInt(data[2], 10) - 1, parseInt(data[3], 10), parseInt(data[4], 10), parseInt(data[5], 10), parseInt(data[6], 10));\n      }\n    }\n\n    return newDate;\n  }\n\n  getModuleName() {\n    return 'iCalendarImport';\n  }\n\n  destroy() {\n    if (!this.parent || this.parent && this.parent.isDestroyed) {\n      return;\n    }\n  }\n\n}\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\n/**\n * Excel Export Module\n */\n\n\nclass ExcelExport {\n  constructor(parent) {\n    this.parent = parent;\n  }\n\n  initializeExcelExport(excelExportOptions = {}) {\n    const exportColumns = this.getExportColumns(excelExportOptions);\n    const exportName = excelExportOptions.fileName || 'Schedule';\n    const exportType = excelExportOptions.exportType || 'xlsx';\n    const isIncludeOccurrences = excelExportOptions.includeOccurrences || false;\n    let separator;\n\n    if (!isNullOrUndefined(excelExportOptions.separator) && excelExportOptions.separator !== ',') {\n      separator = excelExportOptions.separator;\n    }\n\n    let eventCollection;\n\n    if (excelExportOptions.customData) {\n      eventCollection = !isIncludeOccurrences ? excelExportOptions.customData : this.parent.eventBase.getProcessedEvents(excelExportOptions.customData);\n    } else {\n      eventCollection = !isIncludeOccurrences ? this.parent.eventsData : this.parent.eventsProcessed;\n    }\n\n    this.processWorkbook(exportColumns, exportName, exportType, eventCollection, separator);\n  }\n\n  processWorkbook(fields, name, type, eventCollection, separator) {\n    const columns = [];\n    const rows = [];\n    const columnHeader = [];\n    fields.forEach((field, i) => {\n      columns.push({\n        index: i + 1,\n        width: field.name === 'Id' ? 50 : 150\n      });\n    });\n    const style = {\n      fontSize: 12,\n      borders: {\n        color: '#E0E0E0'\n      },\n      bold: true\n    };\n    fields.forEach((field, i) => {\n      columnHeader.push({\n        index: i + 1,\n        value: field.text,\n        style: style\n      });\n    });\n    rows.push({\n      index: 1,\n      cells: columnHeader\n    });\n    eventCollection.forEach((event, i) => {\n      const columnData = [];\n      fields.forEach((field, n) => {\n        let columnRule = {\n          index: n + 1,\n          value: event[field.name] || ''\n        };\n\n        if (field.name === this.parent.eventFields.startTime || field.name === this.parent.eventFields.endTime) {\n          const styleRule = {\n            fontSize: 12,\n            numberFormat: 'm/d/yyyy h:mm AM/PM'\n          };\n          columnRule = extend({}, columnRule, {\n            style: styleRule\n          }, true);\n        }\n\n        columnData.push(columnRule);\n      });\n      rows.push({\n        index: i + 2,\n        cells: columnData\n      });\n    });\n    const workSheet = [{\n      columns: columns,\n      rows: rows\n    }];\n    const book = new Workbook({\n      worksheets: workSheet\n    }, type, this.parent.locale, undefined, separator);\n    book.save(name + '.' + type);\n  }\n\n  getExportColumns(exportOptions) {\n    const exportColumns = exportOptions.fieldsInfo || [];\n\n    if (exportColumns.length === 0) {\n      const fields = exportOptions.fields || Object.keys(this.parent.eventFields).map(field => this.parent.eventFields[field]);\n      fields.forEach(field => {\n        exportColumns.push({\n          name: field,\n          text: field\n        });\n      });\n    }\n\n    return exportColumns;\n  }\n\n  getModuleName() {\n    return 'excelExport';\n  }\n\n  destroy() {\n    this.parent = null;\n  }\n\n}\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\n/**\n * Print Module\n */\n\n\nclass Print {\n  constructor(parent) {\n    this.parent = parent;\n  }\n\n  print(printOptions) {\n    if (isNullOrUndefined(printOptions)) {\n      this.printScheduler();\n    } else {\n      this.printSchedulerWithModel(printOptions);\n    }\n  }\n\n  printScheduler() {\n    const clone = this.parent.element.cloneNode(true);\n    clone.id = this.parent.element.id + '_print';\n    document.body.appendChild(clone);\n    const className = this.parent.currentView === 'MonthAgenda' ? '.e-appointment-wrap' : '.e-content-wrap';\n    const scrollableEle = this.parent.element.querySelector(className);\n    const links = [].slice.call(document.getElementsByTagName('head')[0].querySelectorAll('link, style'));\n    let reference = '';\n\n    for (const link of links) {\n      reference += link.outerHTML;\n    }\n\n    const div = createElement('div');\n    clone.style.width = this.parent.element.offsetWidth + 'px';\n    const elementWidth = Math.round(parseInt(clone.style.width, 10) / 100) * 100;\n    div.appendChild(clone);\n    const printWindow = window.open('', 'print', 'height=550,width=' + elementWidth + ',tabbar=no');\n    printWindow.document.write('<!DOCTYPE html><html><head>' + reference + '</head><body>' + div.innerHTML + '<script>(function() { window.ready = true; })();</script></body></html>');\n    printWindow.document.close();\n    printWindow.focus();\n    setTimeout(() => {\n      if (printWindow.ready && scrollableEle) {\n        // eslint-disable-next-line no-self-assign\n        scrollableEle.scrollLeft = scrollableEle.scrollLeft; // eslint-disable-next-line no-self-assign\n\n        scrollableEle.scrollTop = scrollableEle.scrollTop;\n        const headerTimeCellsScroll = printWindow.document.querySelector('.e-date-header-wrap');\n\n        if (headerTimeCellsScroll) {\n          headerTimeCellsScroll.scrollLeft = scrollableEle.scrollLeft;\n        }\n\n        const timeCellsScroll = printWindow.document.querySelector('.e-time-cells-wrap');\n\n        if (timeCellsScroll) {\n          timeCellsScroll.scrollTop = scrollableEle.scrollTop;\n        }\n\n        printWindow.print();\n        printWindow.close();\n      }\n    }, 500);\n  }\n\n  printSchedulerWithModel(printOptions) {\n    const element = createElement('div', {\n      id: this.parent.element.id + '_print',\n      className: 'e-print-schedule'\n    });\n    document.body.appendChild(element);\n    Schedule.Inject(Day, Week, WorkWeek, Month, Agenda, MonthAgenda, TimelineViews, TimelineMonth, Year, TimelineYear);\n    this.printInstance = new Schedule(this.getPrintScheduleModel(printOptions));\n    this.printInstance.isPrinting = true;\n    this.printInstance.appendTo(element);\n    this.printInstance.on(print$1, this.contentReady, this);\n    this.printWindow = window.open('', 'print', 'height=' + window.outerHeight + ',width=' + window.outerWidth + ',tabbar=no');\n    this.printWindow.moveTo(0, 0);\n    this.printWindow.resizeTo(screen.availWidth, screen.availHeight);\n  }\n\n  getPrintScheduleModel(printOptions) {\n    const printModel = {};\n    const scheduleProps = ['agendaDaysCount', 'calendarMode', 'cssClass', 'currentView', 'dateFormat', 'enableRtl', 'endHour', 'eventSettings', 'firstDayOfWeek', 'firstMonthOfYear', 'group', 'height', 'locale', 'maxDate', 'minDate', 'readonly', 'resources', 'rowAutoHeight', 'selectedDate', 'showHeaderBar', 'showTimeIndicator', 'showWeekNumber', 'showWeekend', 'startHour', 'timeFormat', 'timeScale', 'timezone', 'views', 'width', 'workDays', 'workHours'];\n    let eventSettings;\n    let group;\n\n    for (const key of scheduleProps) {\n      switch (key) {\n        case 'eventSettings':\n          eventSettings = Object.assign({}, this.parent.eventSettings.properties);\n          eventSettings.dataSource = this.parent.eventsData;\n          eventSettings.template = null;\n          printModel.eventSettings = eventSettings;\n          break;\n\n        case 'group':\n          group = isNullOrUndefined(printOptions.group) ? this.parent.group : printOptions.group;\n          group.headerTooltipTemplate = null;\n          printModel.group = group;\n          break;\n\n        default:\n          printModel[key] = isNullOrUndefined(printOptions[key]) ? this.parent[key] : printOptions[key];\n          break;\n      }\n    }\n\n    return printModel;\n  }\n\n  contentReady() {\n    this.printWindow = print(this.printInstance.element, this.printWindow);\n\n    this.printWindow.onbeforeunload = () => {\n      this.printInstance.off(print$1, this.contentReady);\n      this.printInstance.element.remove();\n      this.printInstance.destroy();\n      this.printInstance = null;\n      this.printWindow = null;\n    };\n  }\n\n  getModuleName() {\n    return 'print';\n  }\n\n  destroy() {\n    this.parent = null;\n  }\n\n}\n/**\n * Exporting modules\n */\n\n/**\n * Schedule component exported items\n */\n\n/**\n * Recurrence-Editor component exported items\n */\n\n/**\n * Calendar util exported items\n */\n\n/**\n * Export Schedule components\n */\n\n\nexport { Schedule, cellClick, cellDoubleClick, moreEventsClick, select, hover, actionBegin, actionComplete, actionFailure, navigating, renderCell, eventClick, eventRendered, dataBinding, dataBound, popupOpen, popupClose, dragStart, drag, dragStop, resizeStart, resizing, resizeStop, inlineClick, initialLoad, initialEnd, print$1 as print, dataReady, eventsLoaded, contentReady, scroll, virtualScroll, scrollUiUpdate, uiUpdate, documentClick, cellMouseDown, WEEK_LENGTH, DEFAULT_WEEKS, MS_PER_DAY, MS_PER_MINUTE, getElementHeightFromClass, getTranslateY, getWeekFirstDate, getWeekLastDate, firstDateOfMonth, lastDateOfMonth, getWeekNumber, getWeekMiddleDate, setTime, resetTime, getDateInMs, getDateCount, addDays, addMonths, addYears, getStartEndHours, getMaxDays, getDaysCount, getDateFromString, getScrollBarWidth, findIndexInData, getOuterHeight, removeChildren, isDaylightSavingTime, getUniversalTime, isMobile, isIPadDevice, capitalizeFirstWord, Resize, DragAndDrop, HeaderRenderer, ViewBase, Day, Week, WorkWeek, Month, Year, Agenda, MonthAgenda, TimelineViews, TimelineMonth, TimelineYear, Timezone, timezoneData, ICalendarExport, ICalendarImport, ExcelExport, Print, RecurrenceEditor, generateSummary, generate, getDateFromRecurrenceDateString, extractObjectFromRule, getCalendarUtil, getRecurrenceStringFromDate, Gregorian, Islamic };","map":{"version":3,"names":["Animation","Browser","ChildProperty","Collection","Complex","Component","Draggable","Event","EventHandler","HijriParser","Internationalization","KeyboardEvents","L10n","NotifyPropertyChanges","Property","SanitizeHtmlHelper","Touch","addClass","append","classList","cldrData","closest","compile","createElement","extend","formatUnit","getDefaultDateObject","getElement","getValue","isNullOrUndefined","prepend","print","remove","removeClass","setStyleAttribute","Dialog","Popup","Tooltip","createSpinner","hideSpinner","isCollide","showSpinner","Toolbar","TreeView","Calendar","DatePicker","DateTimePicker","DataManager","Deferred","Predicate","Query","Button","CheckBox","RadioButton","FormValidator","Input","NumericTextBox","DropDownList","MultiSelect","ListBase","Workbook","cellClick","cellDoubleClick","moreEventsClick","select","hover","actionBegin","actionComplete","actionFailure","navigating","renderCell","eventClick","eventRendered","dataBinding","dataBound","popupOpen","popupClose","dragStart","drag","dragStop","resizeStart","resizing","resizeStop","inlineClick","initialLoad","initialEnd","print$1","dataReady","eventsLoaded","contentReady","scroll","virtualScroll","scrollUiUpdate","uiUpdate","documentClick","cellMouseDown","WEEK_LENGTH","DEFAULT_WEEKS","MS_PER_DAY","MS_PER_MINUTE","getElementHeightFromClass","container","elementClass","height","el","className","cloneNode","style","visibility","position","appendChild","getBoundingClientRect","getTranslateY","element","getComputedStyle","window","WebKitCSSMatrix","webkitTransform","m42","getWeekFirstDate","date","firstDayOfWeek","date1","Date","getTime","getDay","setDate","getDate","getWeekLastDate","weekFirst","weekLast","getFullYear","getMonth","firstDateOfMonth","lastDateOfMonth","getWeekNumber","valueOf","currentDate","dayOfYear","Math","ceil","getWeekMiddleDate","setTime","time","tzOffsetBefore","getTimezoneOffset","d","tzOffsetDiff","resetTime","getDateInMs","localOffset","dateOffset","timezoneOffset","getDateCount","startDate","endDate","addDays","noOfDays","addMonths","noOfMonths","day","setMonth","min","getMaxDays","addYears","noOfYears","setFullYear","getStartEndHours","startHour","endHour","setHours","getHours","setMinutes","getMinutes","setSeconds","getSeconds","date2","getDaysCount","strTime","endTime","round","getDateFromString","indexOf","parseInt","match","toString","replace","scrollWidth","getScrollBarWidth","divNode","value","cssText","document","body","ratio","devicePixelRatio","toFixed","floor","offsetWidth","clientWidth","removeChild","findIndexInData","data","field","event","resourceCollection","i","length","slice","res","Array","resData","join","includes","groupIDField","getOuterHeight","offsetHeight","marginTop","marginBottom","removeChildren","elementChildren","call","children","elementChild","contains","isDaylightSavingTime","jan","jul","max","getUniversalTime","year","month","hours","minutes","seconds","milliseconds","getMilliseconds","UTC","isMobile","navigator","userAgent","toLowerCase","isIPadDevice","capitalizeFirstWord","inputString","type","split","map","e","charAt","toLocaleUpperCase","substring","array","index","ROOT","RTL","DEVICE_CLASS","MULTI_DRAG","ICON","ENABLE_CLASS","DISABLE_CLASS","TABLE_CONTAINER_CLASS","SCHEDULE_TABLE_CLASS","ALLDAY_CELLS_CLASS","HEADER_POPUP_CLASS","HEADER_CALENDAR_CLASS","ALLDAY_ROW_CLASS","CONTENT_TABLE_CLASS","WORK_CELLS_CLASS","WORK_HOURS_CLASS","POPUP_OPEN","DATE_HEADER_WRAP_CLASS","DATE_HEADER_CONTAINER_CLASS","HEADER_CELLS_CLASS","HEADER_WEEK_CELLS_CLASS","HEADER_MONTH_CELLS_CLASS","HEADER_YEAR_CELLS_CLASS","WORKDAY_CLASS","OTHERMONTH_CLASS","CURRENT_DAY_CLASS","CURRENTDATE_CLASS","CURRENT_PANEL_CLASS","PREVIOUS_PANEL_CLASS","NEXT_PANEL_CLASS","PREVIOUS_DATE_CLASS","NEXT_DATE_CLASS","TRANSLATE_CLASS","LEFT_INDENT_CLASS","LEFT_INDENT_WRAP_CLASS","EVENT_TABLE_CLASS","RESOURCE_LEFT_TD_CLASS","RESOURCE_GROUP_CELLS_CLASS","RESOURCE_TEXT_CLASS","RESOURCE_COLUMN_WRAP_CLASS","RESOURCE_COLUMN_TABLE_CLASS","RESOURCE_CHILD_CLASS","RESOURCE_PARENT_CLASS","RESOURCE_EXPAND_CLASS","RESOURCE_COLLAPSE_CLASS","RESOURCE_TREE_ICON_CLASS","RESOURCE_CELLS_CLASS","TIME_CELLS_WRAP_CLASS","TIME_CELLS_CLASS","TIME_SLOT_CLASS","ALTERNATE_CELLS_CLASS","CURRENT_TIME_CLASS","CURRENT_TIMELINE_CLASS","PREVIOUS_TIMELINE_CLASS","HIDE_CHILDS_CLASS","SCROLL_CONTAINER_CLASS","TIMELINE_WRAPPER_CLASS","APPOINTMENT_WRAPPER_CLASS","DAY_WRAPPER_CLASS","TOOLBAR_CONTAINER","RESOURCE_TOOLBAR_CONTAINER","HEADER_TOOLBAR","RESOURCE_HEADER_TOOLBAR","SELECTED_CELL_CLASS","WEEK_NUMBER_WRAPPER_CLASS","WEEK_NUMBER_CLASS","APPOINTMENT_WRAP_CLASS","WRAPPER_CONTAINER_CLASS","APPOINTMENT_CONTAINER_CLASS","APPOINTMENT_CLASS","BLOCK_APPOINTMENT_CLASS","BLOCK_INDICATOR_CLASS","APPOINTMENT_BORDER","APPOINTMENT_DETAILS","SUBJECT_WRAP","RESOURCE_NAME","APPOINTMENT_TIME","TABLE_WRAP_CLASS","OUTER_TABLE_CLASS","CONTENT_WRAP_CLASS","VIRTUAL_TRACK_CLASS","AGENDA_CELLS_CLASS","AGENDA_CURRENT_DAY_CLASS","AGENDA_SELECTED_CELL","MONTH_HEADER_CLASS","AGENDA_HEADER_CLASS","AGENDA_RESOURCE_CLASS","AGENDA_DATE_CLASS","NAVIGATE_CLASS","DATE_HEADER_CLASS","AGENDA_DAY_BORDER_CLASS","DATE_BORDER_CLASS","AGENDA_DAY_PADDING_CLASS","DATE_TIME_CLASS","DATE_TIME_WRAPPER_CLASS","AGENDA_EMPTY_EVENT_CLASS","AGENDA_NO_EVENT_CLASS","APPOINTMENT_INDICATOR_CLASS","EVENT_INDICATOR_CLASS","EVENT_ICON_UP_CLASS","EVENT_ICON_DOWN_CLASS","EVENT_ICON_LEFT_CLASS","EVENT_ICON_RIGHT_CLASS","EVENT_ACTION_CLASS","NEW_EVENT_CLASS","CLONE_ELEMENT_CLASS","MONTH_CLONE_ELEMENT_CLASS","CLONE_TIME_INDICATOR_CLASS","DRAG_CLONE_CLASS","EVENT_RESIZE_CLASS","RESIZE_CLONE_CLASS","LEFT_RESIZE_HANDLER","RIGHT_RESIZE_HANDLER","TOP_RESIZE_HANDLER","BOTTOM_RESIZE_HANDLER","EVENT_RECURRENCE_ICON_CLASS","EVENT_RECURRENCE_EDIT_ICON_CLASS","HEADER_ROW_CLASS","ALLDAY_APPOINTMENT_WRAPPER_CLASS","ALLDAY_APPOINTMENT_CLASS","EVENT_COUNT_CLASS","ROW_COUNT_WRAPPER_CLASS","ALLDAY_APPOINTMENT_SECTION_CLASS","APPOINTMENT_ROW_EXPAND_CLASS","APPOINTMENT_ROW_COLLAPSE_CLASS","MORE_INDICATOR_CLASS","CELL_POPUP_CLASS","EVENT_POPUP_CLASS","MULTIPLE_EVENT_POPUP_CLASS","POPUP_HEADER_CLASS","POPUP_HEADER_ICON_WRAPPER","POPUP_CONTENT_CLASS","POPUP_FOOTER_CLASS","DATE_TIME_DETAILS_CLASS","RECURRENCE_SUMMARY_CLASS","QUICK_POPUP_EVENT_DETAILS_CLASS","EVENT_CREATE_CLASS","EDIT_EVENT_CLASS","DELETE_EVENT_CLASS","TEXT_ELLIPSIS","MORE_POPUP_WRAPPER_CLASS","MORE_EVENT_POPUP_CLASS","MORE_EVENT_HEADER_CLASS","MORE_EVENT_DATE_HEADER_CLASS","MORE_EVENT_HEADER_DAY_CLASS","MORE_EVENT_HEADER_DATE_CLASS","MORE_EVENT_CLOSE_CLASS","MORE_EVENT_CONTENT_CLASS","MORE_EVENT_WRAPPER_CLASS","QUICK_DIALOG_CLASS","QUICK_DIALOG_OCCURRENCE_CLASS","QUICK_DIALOG_SERIES_CLASS","QUICK_DIALOG_FOLLOWING_EVENTS_CLASS","FOLLOWING_EVENTS_DIALOG","QUICK_DIALOG_DELETE_CLASS","QUICK_DIALOG_CANCEL_CLASS","QUICK_DIALOG_ALERT_OK","QUICK_DIALOG_ALERT_CANCEL","QUICK_DIALOG_ALERT_FOLLOWING","QUICK_DIALOG_ALERT_BTN_CLASS","EVENT_WINDOW_DIALOG_CLASS","FORM_CONTAINER_CLASS","FORM_CLASS","EVENT_WINDOW_ALLDAY_TZ_DIV_CLASS","EVENT_WINDOW_ALL_DAY_CLASS","TIME_ZONE_CLASS","TIME_ZONE_ICON_CLASS","TIME_ZONE_DETAILS_CLASS","EVENT_WINDOW_REPEAT_DIV_CLASS","EVENT_WINDOW_REPEAT_CLASS","EVENT_WINDOW_TITLE_LOCATION_DIV_CLASS","SUBJECT_CLASS","LOCATION_CLASS","LOCATION_ICON_CLASS","LOCATION_DETAILS_CLASS","EVENT_WINDOW_START_END_DIV_CLASS","EVENT_WINDOW_START_CLASS","EVENT_WINDOW_END_CLASS","EVENT_WINDOW_RESOURCES_DIV_CLASS","DESCRIPTION_CLASS","DESCRIPTION_ICON_CLASS","DESCRIPTION_DETAILS_CLASS","EVENT_WINDOW_TIME_ZONE_DIV_CLASS","EVENT_WINDOW_START_TZ_CLASS","EVENT_WINDOW_END_TZ_CLASS","EVENT_WINDOW_BACK_ICON_CLASS","EVENT_WINDOW_SAVE_ICON_CLASS","EVENT_WINDOW_CANCEL_BUTTON_CLASS","EVENT_WINDOW_SAVE_BUTTON_CLASS","EVENT_WINDOW_DIALOG_PARENT_CLASS","EVENT_WINDOW_TITLE_TEXT_CLASS","EVENT_WINDOW_ICON_DISABLE_CLASS","EDIT_CLASS","EDIT_ICON_CLASS","DELETE_CLASS","DELETE_ICON_CLASS","CLOSE_CLASS","CLOSE_ICON_CLASS","ERROR_VALIDATION_CLASS","EVENT_TOOLTIP_ROOT_CLASS","ALLDAY_ROW_ANIMATE_CLASS","TIMESCALE_DISABLE","DISABLE_DATE","HIDDEN_CLASS","DISABLE_DATES","POPUP_WRAPPER_CLASS","POPUP_TABLE_CLASS","RESOURCE_MENU","RESOURCE_MENU_ICON","RESOURCE_LEVEL_TITLE","RESOURCE_TREE","RESOURCE_TREE_POPUP_OVERLAY","RESOURCE_TREE_POPUP","RESOURCE_CLASS","RESOURCE_ICON_CLASS","RESOURCE_DETAILS_CLASS","DATE_TIME_ICON_CLASS","VIRTUAL_SCROLL_CLASS","ICON_DISABLE_CLASS","AUTO_HEIGHT","IGNORE_WHITESPACE","EVENT_TEMPLATE","READ_ONLY","MONTH_HEADER_WRAPPER","INLINE_SUBJECT_CLASS","INLINE_APPOINTMENT_CLASS","SCROLL_HIDDEN","ALLDAY_APPOINTMENT_SCROLL","ALLDAY_APPOINTMENT_AUTO","HeaderRenderer","constructor","parent","l10n","localeObj","renderHeader","addEventListener","on","closeHeaderPopup","removeEventListener","off","closestEle","target","closestPop","contentWrap","querySelector","isAdaptive","popupEle","popupObj","ej2_instances","hide","hideHeaderPopup","headerPopup","toolbarEle","insertBefore","firstElementChild","renderToolbar","items","getItems","trigger","requestType","args","toolbarObj","overflowMode","clicked","toolbarClickHandler","bind","enableRtl","locale","appendTo","prevNavEle","setAttribute","getConstant","nextNavEle","updateAddIcon","updateActiveView","updateItems","dataBind","getPopUpRelativeElement","setDayOfWeek","headerCalendar","setCalendarDate","setCalendarMinMaxDate","minDate","maxDate","getCalendarView","currentView","setCalendarView","calendarView","depth","start","refresh","selEle","querySelectorAll","viewIndex","updateDateRange","text","innerHTML","refreshOverflow","addEle","eventSettings","allowAdding","getDateRangeText","dateString","globalize","formatDate","selectedDate","format","calendar","getCalendarMode","push","align","prefixIcon","tooltipText","overflow","cssClass","htmlAttributes","suffixIcon","enableAdaptiveUI","showAlwaysInPopup","views","item","getItemObject","viewName","displayName","option","view","orientationClass","isItemInsidePopup","orientation","renderHeaderPopup","headerPopupEle","headerCalendarEle","actionOnScroll","targetType","relateTo","X","Y","isDisplayDate","activeViewOptions","displayDate","hasSelectedDate","calendarMode","change","calendarChange","setCalendarTimezone","calendarDate","changeDate","timezone","tzModule","getLocalTimezoneName","calculateViewIndex","originalEvent","strClass","isSameTime","currentTime","show","changeView","undefined","getCurrentTime","isSelectedDate","numberOfWeeks","activeView","getNextPreviousDate","activeCellsData","startTime","interval","timeScale","slotCount","msInterval","setMilliseconds","isAllDay","eventWindow","openEditor","cancel","toolbarPopUp","name","duration","selectedTime","getStartDate","getEndDate","getHeaderElement","updateHeaderItems","classType","dateRangeEle","previousNextIconHandler","dates","getCurrentViewDates","firstDate","lastDate","isCustomMonth","enableItems","getModuleName","destroy","isDestroyed","Scroll","setWidth","width","setHeight","setDimensions","onPropertyChanged","cssProperties","getCssProperties","module","notify","ScheduleTouch","touchObj","scrollHandler","swipe","swipeHandler","tapHold","tapHoldHandler","swipeSettings","swipeThresholdDistance","add","onTransitionEnd","touchLeftDirection","touchRightDirection","uiStateValues","action","timeStampStart","now","scrollDirection","scrollDiv","isScrollTriggered","preventDefault","stopPropagation","nextPanel","renderPanel","getPanel","x","distanceX","transform","getTranslateX","prevWidth","previousPanel","swipeDate","swipeDirection","renderDates","offsetDist","isDevice","swapPanels","transitionDuration","confirmSwipe","cancelSwipe","quickPopup","tapHoldEventPopup","clsName","nextPrevType","currentPanel","setProperties","headerModule","getRenderDates","renderLayout","direction","temp","previousDate","navArgs","setPanel","translateX","offsetLeft","renderTemplates","crudModule","refreshDataManager","generateColumnLevels","m41","resetValues","KeyboardInteraction","selectedCells","keyConfigs","downArrow","upArrow","rightArrow","leftArrow","shiftDownArrow","shiftUpArrow","shiftRightArrow","shiftLeftArrow","ctrlLeftArrow","ctrlRightArrow","altOne","altTwo","altThree","altFour","altFive","altSix","altSeven","altEight","altNine","enter","escape","delete","home","pageUp","pageDown","tab","shiftTab","ctrlShiftUpArrow","ctrlShiftDownArrow","ctrlShiftLeftArrow","ctrlShiftRightArrow","tabIndex","keyboardModule","keyAction","keyActionHandler","eventName","processDown","shiftKey","processUp","processLeft","processRight","focus","processViewNavigation","processEnter","focusFirstCell","processTab","processDelete","processCtrlShiftNavigationArrows","processEscape","allowInline","inlineModule","processFTwelve","getSelectedElements","inlineArgs","groupIndex","click","onCellMouseDown","initialTarget","getClosestCell","readonly","which","removeSelectedClass","getContentTable","onMouseSelection","onMoveUp","allDayRow","getAllDayRow","appointments","selectionEdges","boundaryValidation","pageY","pageX","bottom","top","left","right","yInBounds","scrollHeight","scrollTop","xInBounds","scrollLeft","selectCells","isPreventAction","queryStr","cellData","convertToEventData","showQuickPopup","selectArgs","isPopupShow","quickInfoOnSelectionEnd","cellArgs","resourceIcon","inlineCrudActions","getDateFromElement","getNavigateView","cellDetails","getCellDetails","end","getCells","isInverseTable","tableEle","isTimelineYear","query","cells","maxRow","rows","maxColumn","startIndex","endIndex","inverseCells","j","cell","sCells","focusCell","eventBase","removeSelectedAppointmentClass","isTimelineView","isVerticalYear","getWorkCellElements","isInverseTableSelect","isMultiple","targetCell","initialId","allowMultipleRow","removeInlineAppointmentElement","allowMultiRowSelection","isGroupYear","group","resources","parentElement","cellIndex","getAttribute","resourceSelectedCells","allowMultiCellSelection","allDayCells","getAllDayCells","resourceAllDayCells","concat","addSelectedClass","selectAppointment","isReverse","getAppointmentElements","nextAppEle","targetIndex","addSelectedAppointments","selectAppointmentElementFromWorkCell","appointmentElements","getUniqueAppointmentElements","filteredElements","selectedSeriesEvents","eventsProcessed","filter","eventObject","eventFields","JSON","stringify","Guid","selectedElement","focusElements","getAppointmentElementsByGuid","startCell","endCell","guid","self","getWorkCellFromAppointmentElement","selectedObject","getEventByGuid","selectWorkCellByTime","key","viewCollections","cancelUpDownAction","isGroup","selectedElements","selectedEventElements","getSelectedAppointments","moreEventWrapper","quickPopupWrapper","getQuickPopupElement","tableRows","getTableRows","curRowIndex","getVerticalUpDownCell","getHorizontalUpDownCell","getYearUpDownCell","rowIndex","isUp","row","workCell","hasRow","column","dateAttr","processLeftRight","parentNode","sectionRowIndex","columnIndex","maxIndex","isCancelLeftRightAction","prevent","selectedAppointments","targetDate","isMonthEnd","calculateNextPrevDate","getTimelineYearTargetCell","changeTargetCell","getHorizontalLeftRightCell","curColIndex","maxColIndex","isMonthStart","otherMonthCell","tbody","isRight","getVerticalLeftRightCell","currentCell","nextPrevDate","getFocusableElements","queryString","processTabOnPopup","popupElement","focusableElements","footerEle","offsetParent","firstEle","lastEle","activeElement","popupWrapper","appSelector","appElements","focusAppointment","resourceBase","lastResourceLevel","virtualScrollModule","virtual","averageRowHeight","expandedResources","virtualScrolling","setScrollPosition","isTimeline","resCellSelector","resourceCell","preventScroll","processTabOnResourceCells","activeEle","selectedEle","getSelectedEvents","activeEventData","allowDeleting","deleteClick","eventEle","renderedResources","onClosePopup","morePopup","tabElements","currentTabIndex","nextTabElement","resColWrap","resCells","forEach","offsetTop","Data","dataSource","initDataManager","dataManager","generateQuery","clone","addParams","toISOString","getData","executeQuery","Gregorian","dt","getLeapYearDaysCount","getYearDaysCount","getYearLastDate","getMonthDaysCount","getMonthStartDate","getMonthEndDate","getExpectedDays","days","dateObj","setValidDate","monthValue","beginDate","isSameMonth","checkMonth","months","compareMonth","isSameYear","isLastMonth","isLeapYear","Islamic","hDate","getHijriDate","gDate","toGregorian","daysInMonth","getDaysInMonth","finalGDate","finalHDate","hijriDate","updateDateObj","currentHijri","tempHijri","hDate1","Timezone","timezoneData","getTimezoneData","offset","convertedDate","toLocaleString","timeZone","isNaN","error","convert","fromOffset","toOffset","fromLocalOffset","toLocalOffset","removeLocalOffset","Intl","DateTimeFormat","resolvedOptions","Value","Text","generateSummary","rule","localeObject","calendarType","ruleObject","extractObjectFromRule","summary","EVERY","cldrObj","cldrObj1","nameSpace1","nameSpace","freq","DAYS","WEEKS","ON","DAYINDEXOBJECT","MONTHS","getMonthSummary","YEARS","count","TIMES","until","tempDate","UNTIL","monthDay","pos","setPosition","WEEKPOS","generate","excludeDate","startDayOfWeek","maximumCount","MAXOCCURRENCE","viewDate","oldTimezone","newTimezone","cacheDate","calendarUtil","getCalendarUtil","modifiedDate","tempExcludeDate","tz","content","parsedDate","getDateFromRecurrenceDateString","recExceptionCount","tempViewDate","maxOccurrence","setFirstDayOfWeek","DAYINDEX","dailyType","weeklyType","monthlyType","yearlyType","recDateString","substr","excludeDateHandler","zeroIndex","getDateCount$1","expectedCount","state","expectedDays","compareDates","validateRules","weekState","wkstIndex","weekCollection","wkst","dayIndex","startDateDiff","weekstartDate","weekendDate","compareTempDate","insertDataCollection","getStartDateForWeek","ruleType","validateMonthlyRuleType","monthlyDayTypeProcessforMonthFreq","monthlyDayTypeProcess","monthlyDateTypeProcessforMonthFreq","monthlyDateTypeProcess","typeValue","checkYearlyType","processWeekNo","processYearDay","stDate","startDay","firstWeekSpan","weekNos","weekNo","insertDateCollection","insertDatasIntoExistingCollection","dateCollection","yearDay","initializeRecRuleVariables","ruleData","monthCollection","mainDate","monthInit","currentMonthDate","processDateCollectionForByMonthDay","setNextValidDate","recRuleVariables","isByMonth","validateProperDate","monthData","getMonthCollection","isHavingNumber","HASNUMBER","test","expectedDaysArray","SPLITNUMBERANDSTRING","filterDateCollectionByIndex","insertDateCollectionBasedonBySetPos","dayCycleData","processWeekDays","initialDate","datas","week","insertDateCollectionBasedonIndex","processDateCollectionforByDayWithInteger","newstr","getDayString","getRecurrenceCollection","recurrenceCollectionObject","expectedDaysArrays","arrPosition","getDateCollectionforBySetPosNull","recurrenceCollections","dayData","chDate","weekCount","firstOfMonth","lastOfMonth","numberOfDaysInMonth","firstWeekDay","used","sort","weekIndex","validRules","REMOVENUMBERINSTRING","checkDayIndex","sortedExpectedDays","expectedDaysNumberSplit","expectedDaysArr","rules","rulesList","splitData","Number","splice","dayCycle","checkDate","expectedDate","shift","checkYear","expectedyearDay","getYearDay","startDateCollection","diff","rotate","expectedMonth","SU","MO","TU","WE","TH","FR","SA","getRecurrenceStringFromDate","getUTCFullYear","roundDateValues","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","EventBase","slots","isDoubleTapped","processData","events","timeZonePropChanged","fields","processed","generateID","id","updateEventDateTime","processTimezoneChange","isPrinting","isResize","processTimezone","level","recurrenceRule","recurrenceID","crudObj","isCrudAction","generateOccurrence","recurrenceEvent","occurrence","app","generateGuid","eventData","isBlock","filterEvents","blockData","eventObj","isDifferentDate","blockProcessed","getProcessedEvents","eventCollection","eventsData","timezonePropertyChange","processedData","timezoneConvert","startTimezone","endTimezone","startTz","endTz","filterBlockEvents","eStart","eEnd","resourceData","getGroupIndexFromEvent","blockEvents","isDifferentTime","resourceTdData","fieldMapping","predicate","and","or","json","executeLocal","where","filterEventsByResource","sortByTime","filterEventsByRange","filteredEvents","groupOrder","keys","Object","filteredCollection","every","appointmentsCollection","sortComparer","fieldMappings","a","b","d1","d2","sortByDateTime","object1","object2","d3","d4","d5","d6","getSmallestMissingNumber","large","splitEventByDay","eventStartTime","eventEndTime","eventLength","isSpanned","splitEvent","dateRender","orgStart","orgEnd","ranges","cStart","slot","byDate","showWeekend","slotDates","s","renderedDates","getRenderedDates","firstSlot","hasBreak","isLeft","cloneEventObject","dateInRange","availSlot","getSelectedEventElements","isAlreadySelected","elementSelector","eventSelect","elementSelect","selectAppointments","isAlreadyAdded","appointment","focusElement","isFocused","dialogObject","visible","selectedCell","keyboardInteractionModule","nearestTime","isAllDayAppointment","targetArea","levelIndex","resource","levelName","idField","parentField","getIndexFromResourceId","isFullDay","spannedEventPlacement","appointmentBorderRemove","wireAppointmentEvents","isPreventCrud","isReadOnly","isReadonly","eventTouchClick","eventDoubleClick","resizeModule","wireResizeEvent","dragAndDropModule","wireDragEvent","setTimeout","renderResizeHandler","spanEvent","allowResizing","resizeEdge","resizeHandler","isTop","isBottom","ctrlKey","metaKey","selectEventArgs","eventClickArgs","quickPopupHide","currentAction","openRecurrenceAlert","getEventById","c","r","random","v","getEventIDType","getEventMaxID","resourceId","eventId","idType","maxId","obj","isMaxCount","eventRule","exception","recurrenceException","maxCount","firstDay","generatedDates","occurrenceCollection","clonedObject","getDSTAdjustedTime","followingID","occurDate","eventOffset","getDSTDiff","schOffset","startOffset","occurOffset","getParentEvent","isParent","parentEvent","getFollowingEvent","collection","getEventCollections","followObj","follow","parentObj","childObj","followingCollection","followingEvent","getOccurrenceEvent","collections","fieldValue","parentApp","isFollowingEvent","parentStart","childStart","isGuid","isFollowing","fieldKey","getOccurrencesByID","parentObject","getOccurrencesByRange","getDeletedOccurrences","recurrenceData","deletedOccurrences","exDateString","len","edited","exDate","childObject","applyResourceColor","alpha","alphaColor","color","g","getResourceColor","createBlockAppointmentElement","record","resIndex","eventSubject","subject","default","appointmentWrapper","attrs","templateElement","eventTemplate","scheduleId","eventTemplateName","templateId","templateName","getAppointmentTemplate","appointmentSubject","setWrapperAttributes","getReadonlyAttribute","isBlockRange","isBlockAlert","dataCol","getFilterEventsList","getSeriesEvents","deleteFutureEditEvents","futureEvents","deleteFutureEditEventList","delId","followingId","deleteFutureEvent","startTimeQuery","getEditedOccurrences","deleteRecurrenceEventList","delEditedEvents","delEventQuery","filteredDates","isValidEvent","schedule","isHourRange","isSameRange","allDayExpandScroll","dateHeader","indentHeight","headerRows","tdEle","ele","expand","updateEventMinimumDuration","startEndHours","eventDuration","minimumEventDuration","tempEnd","tempStart","unWireEvents","clearEvents","VerticalEvent","renderedEvents","renderedAllDayEvents","overlapEvents","moreEvents","overlapList","allDayEvents","allDayLevel","getStartHour","getEndHour","animation","progress","animationUiUpdate","renderAppointments","setDragArea","wrapperElements","isDragging","wrapper","sourceEvent","targetEvent","allDayElement","setAllDayRowHeight","expandCollapse","rowExpandCollapse","initializeValues","processBlockEvents","renderEvents","arr","isGroupAdaptive","cellHeight","parseFloat","getHeight","appHeight","appendEvent","appointmentElement","appLeft","appointmentWrap","eventType","eventArgs","getResourceList","dateCount","setValues","renderBlockEvents","dayCount","spannedData","isSpannedEvent","blockTop","blockHeight","getTopValue","isRender","renderedDate","renderAllDayEvents","enableMaxHeight","getOverlapIndex","renderNormalEvents","resourceIndex","getCssClass","apply","createAppointmentElement","recordSubject","getAnnouncementString","appointmentDetails","elementId","appointmentStartTime","getTimeString","appointmentEndTime","timeStr","appointmentTime","appointmentLocation","location","iconClass","recurrenceIcon","renderSpannedIcon","createMoreIndicator","currentDay","countWrapper","childElementCount","innerCountWrap","moreIndicatorElement","countCell","moreCount","formatNumber","iconElement","iconLeft","iconRight","iconTop","iconBottom","eventDates","inline","currentDates","allDayRowCell","cellTop","appWidth","topValue","isDateRange","isAlreadyRendered","allDayDifference","allDayIndex","Index","widthAdjustment","wIndex","eventWrapper","createInlineAppointmentElement","allDayRowHeight","addOrRemoveClass","appIndex","getEventWidth","argsData","tempData","adjustOverlapElements","iconHeight","maxHeight","subjectElement","resizeHandlers","tempWidth","getEventLeft","tempLeft","diffInMinutes","enable","eventsList","appointmentList","recordStart","recordEnd","filterList","val","appLevel","length1","length2","eleGuid","apps","enableAllDayScroll","animate","moreEventCount","getEventHeight","eventElement","styles","rowHeight","EVENT_GAP","MonthEvent","monthHeaderHeight","moreIndicatorHeight","renderType","enableIndicator","rowAutoHeight","withIndicator","maxOrIndicator","ignoreWhitespace","removeEventWrapper","appElement","wrap","conWrap","removeHeightProperty","cellTd","eventHeight","renderResourceEvents","updateFocusedWorkCell","renderEventsHandler","workDays","updateBlockElements","isPreventScrollUpdate","scrollPosition","updateVirtualScrollHeight","enablePersistence","showWeekNumber","totalCells","weekNumberCells","blockList","workCells","clientHeight","cellDetail","cellWidth","getSlotDates","spannedEvents","sDate","getStartTime","getIndex","updateIndicatorIcon","blockSpannedList","isSameDate","isBlockIcon","blockEvent","isIcon","getEndTime","getIndexOfDate","getCellTd","getPosition","diffInDays","appRight","appTop","getRowTop","blockElement","renderEventElement","renderBlockIndicator","blockIndicator","cloneData","actualStartTime","actualEndTime","actualStartHour","actualEndHour","sourceRes","slotData","isCloneElement","newRecord","getEventData","eventLocation","innerElement","allDayString","timeString","appTime","appLocation","appendEventIcons","overlapCount","enableAppRender","inlineValue","firstChild","updateCellHeight","indicator","getMoreIndicatorText","getMoreIndicatorElement","renderElement","moreIndicatorClick","getFilteredEvents","getOverlapEvents","appointmentsList","dateTime","moreArgs","isPopupOpen","clickArgs","moreEventClick","isAppointment","pop","setMaxEventHeight","wrapperEle","selector","headerHeight","EVENT_GAP$1","BLOCK_INDICATOR_WIDTH","BLOCK_INDICATOR_HEIGHT","TimelineEvent","cellTops","eventContainers","tr","dayLength","slotsPerDay","trimStartTime","trimEndTime","getSortComparerIndex","getOverlapSortComparerEvents","source","renderApp","getFirstChild","moreIndicator","appPos","renderTimelineMoreIndicator","k","isAlreadyAvail","startDateTime","slotStartTime","slotEndTime","getFilterEvents","appArea","renderedAppCount","monthHeader","td","getNextDay","getPreviousDay","isSameDay","getSameDayEventsWidth","getSpannedEventsWidth","endWidth","startWidth","spannedWidth","endDay","getAppointmentLeft","slotTd","daySlot","gIndex","indicatorPos","wrapIndex","InlineEdit","inlineEdit","moreWrapper","cellEdit","eventEdit","saveObj","generateEventData","getEventDaysCount","createVerticalViewInline","createMonthViewInline","createTimelineViewInline","inlineSubject","subEle","timeEle","innerText","subjectWrap","setSelectionRange","daysCount","verticalEvent","allDayElements","saveObject","monthEvent","monthCellSelector","monthModule","timelineView","abs","inlineElement","setDefaultValueToObject","setResourceValues","addEvent","eventTarget","eventDetails","getEventDetails","saveEvent","inlineData","inlineAppointmentElement","inlineDetails","inlineAppointment","node","FieldValidator","renderFormValidator","form","formObj","customPlacement","inputElement","errorPlacement","validationComplete","focusout","focusOut","relatedTarget","ignoreError","elem","inputName","display","status","createTooltip","dlgContent","client","inputClient","div","arrow","destroyToolTip","elements","reset","EVENT_FIELD","QuickPopups","isMultipleEventSelect","fieldValidator","render","renderQuickPopup","renderMorePopup","renderQuickDialog","open","quickPopupOpen","close","quickPopupClose","hideAnimation","showAnimation","collision","viewPortElement","zIndex","moreEventPopup","morePopupOpen","morePopupClose","closeButton","renderButton","closeClick","navigationClick","buttonModel","isPrimary","dialogButtonClick","editFollowingEvents","followingSeriesButton","quickDialog","animationSettings","effect","buttons","closeOnEscape","beforeClose","beforeQuickDialogClose","isModal","showCloseIcon","dialogElement","okButton","cancelButton","iconName","isDisabled","clickEvent","buttonObj","disabled","iconCss","quickDialogClass","classList$$1","followingEventButton","applyFormValidation","validation","editDeleteOnly","editFollowingEventsOnly","editDeleteSeries","header","activeEvent","showQuickDialog","openRecurrenceValidationAlert","dialogCancel","enableRecurrenceValidation","openDeleteAlert","openValidationError","popupType","eventProp","popupArgs","createMoreEventList","moreEventContentEle","moreEventWrapperEle","eventText","tempId","eventTitle","closeIcon","editAction","allowEditing","deleteAction","editIcon","editClick","deleteIcon","beforeQuickPopupOpen","isCellBlocked","tempObj","showQuickInfo","isMinMaxDate","targetEle","newEventClone","isSameTarget","quickCellPopup","getPopupHeader","getPopupContent","getPopupFooter","createInput","properties","placeholder","moreButton","detailsClick","saveButton","saveClick","isSameEventClick","editButton","isQuickTemplate","quickInfoTemplates","templateType","eventTooltip","updateTapHoldEventPopup","quickEventPopup","buttonClass","deleteButton","headerType","headerData","headerTemplate","headerArgs","elementType","headerTemp","getQuickInfoTemplatesHeader","getFormattedString","replaceAll","templateWrapper","childNodes","contentTemplate","contentArgs","contentTemp","getQuickInfoTemplatesContent","resourceText","getResourceText","details","getRecurrenceSummary","getTimezone","description","footerType","footerData","footerTemplate","footer","footerArgs","footerTemp","getQuickInfoTemplatesFooter","resourceValue","textField","lastResource","isArray","resNames","lastResourceData","resourceDetails","startDateDetails","getDateFormat","endDateDetails","startTimeDetail","endTimeDetail","spanLength","dateElement","moreEventElements","tdDate","dialogEvent","subjectEle","updateMoreEventContent","moreElement","selectCell","cancelBtn","deleteEvent","isIgnoreOccurrence","eventSave","titleContent","zoneDetails","recurrenceEditor","getRecurrenceEditorInstance","ruleSummary","getRuleSummary","toUpperCase","skeletonString","skeleton","getDataFromTarget","cellsData","popupCloseArgs","isEventPopup","destroyPopupButtons","removeAttribute","innerHeight","offsetX","refreshPosition","collide","leftCollide","translateY","offsetY","applyEventColor","colorField","colorEle","borderLeftColor","backgroundColor","editElement","isCellPopup","popupData","formvalidator","validate","getObjectFromFormData","navigateEle","currentTarget","classNames","popupWrap","removeNewEventElement","tar","popupName","popup","buttonCollections","button","instance","refreshQuickDialog","destroyQuickDialog","refreshQuickPopup","destroyQuickPopup","refreshMorePopup","destroyMorePopup","EventTooltip","tooltipObj","mouseTrail","showTipPointer","getTargets","beforeRender","onBeforeRender","onBeforeClose","targets","headerTooltipTemplate","enableTooltip","resCollection","getColumnLevels","contentContainer","tooltipTemplate","getHeaderTooltipTemplate","setContent","getEventTooltipTemplate","eventStart","eventEnd","tooltipSubject","tooltipLocation","startMonthDate","startMonthYearDate","endMonthYearDate","tooltipDetails","tooltipTime","resetTemplates","__decorate$1","__decorate","decorators","desc","arguments","getOwnPropertyDescriptor","Reflect","decorate","defineProperty","HEADER","INPUTWARAPPER","INPUTWARAPPERSIDE","REPEATELEMENT","REPEATINTERVAL","INTERVALCLASS","DAYWRAPPER","WEEKWRAPPER","WEEKPOSITION","DAYPOSITION","YEAREXPANDERWRAPPER","YEAREXPANDERELEMENT","MONETHEXPANDERWRAPPER","MONETHEXPANDWRAPPER","MONTHEXPANDERELEMENT","MONTHEXPANDERCHECKBOXWRAPPER","FORMLEFT","FORMRIGHT","MONTHDAYWRAPPER","MONTHEXPANNDERELEM","MONTHPOS","MONTHWEEK","ENDON","MONTHEXPANDERLABEL","WEEKEXPANDERLABEL","ENDONLABEL","ENDONLEFT","MONTHDAYELEMENT","ENDONELEMENT","ENDONDATE","UNTILDATE","ENDONCOUNTWRAPPER","ENDONCOUNT","HIDEWRAPPER","RTLCLASS","PRIMARY","ACTIVE","RECURRENCETABLE","REPEATCONTENT","REPEATCONTENTWRAPPER","NONE","DAILY","WEEKLY","MONTHLY","YEARLY","NEVER","UNTIL$1","COUNT","TEXTFIELD","VALUEFIELD","LAST","REPEAT","REPEATEVERY","ON$1","END","RADIOLABEL","RULEUNTIL","RULEBYDAY","RULEBYMONTHDAY","RULEBYMONTH","RULEINTERVAL","RULECOUNT","RULESETPOS","RULEFREQ","RULEDAILY","RULEWEEKLY","RULEMONTHLY","RULEYEARLY","RULESUNDAY","RULEMONDAY","RULETUESDAY","RULEWEDNESDAY","RULETHURSDAY","RULEFRIDAY","RULESATURDAY","KEYSUNDAY","KEYMONDAY","KEYTUESDAY","KEYWEDNESDAY","KEYTHURSDAY","KEYFRIDAY","KEYSATURDAY","EQUAL","SEMICOLON","COMMA","FIRST","SECOND","THIRD","FOURTH","contentType","none","daily","weekly","monthly","yearly","valueData","neverClassList","weekClassList","monthClassList","yearClassList","dailyClassList","noEndClassList","endOnCountClassList","endOnDateClassList","RecurrenceEditor","options","defaultLocale","never","first","second","third","fourth","last","repeat","repeatEvery","onDay","weeks","years","summaryTimes","summaryOn","summaryUntil","summaryRepeat","summaryDay","summaryWeek","summaryMonth","summaryYear","monthWeek","monthPosition","monthExpander","yearExpander","repeatInterval","renderStatus","dayButtons","monthButtons","startState","endOn","showFormElement","updateForm","freshOnEndForm","updateEndOnForm","selectMonthDay","updateUntilDate","onMonthDay","checked","preRender","applyCustomClass","initialize","renderComponent","setRecurrenceRule","repeatType","selectedType","getRecurrenceRule","triggerChangeEvent","resetDayButton","daySelection","rotateArray","rtlClass","untilDateObj","weekday","monthDate","monthWeekDays","monthWeekPos","getDayPosition","endType","hideElement","renderDropdowns","getRepeatData","floatLabelType","role","frequencies","resetFormValues","getEndData","popupWidth","getPopupWidth","renderDropDownList","dropDownData","onWeekDay","getMonthPosData","getDayData","getMonthData","setDefaultValue","formelement","recurreneElement","renderDatePickers","dateFormat","getFormat","formatType","dayButtonRender","btns","btn","isToggle","radioButtonRender","label","numericTextboxRender","recurrenceCount","setTemplate","endData","positionCollection","textValue","monthpos","monthposValue","nameSpaceString","fullDay","getSelectedDaysData","getSelectedMonthData","getIntervalData","getEndOnCount","getYearMonthRuleData","updateWeekButton","updateMonthUI","updateUI","getUntilData","tempStr","destroyComponents","resetFields","updateRuleUntilDate","untilDate","newUntilDate","getRecurrenceDates","endon","removeClasses","getPersistData","addOnPersist","renderComplete","newProp","oldProp","prop","prototype","EVENT_FIELD$1","REPEAT_CONTAINER_CLASS","REPEAT_BUTTON_ICON_CLASS","REPEAT_BUTTON_CLASS","REPEAT_DIALOG_CLASS","HIDE_STYLE_CLASS","EventWindow","eventWindowTime","renderEventWindow","dialogModel","getEventWindowContent","minHeight","beforeOpen","onBeforeOpen","eventDelete","dialogClose","preventEventSave","refreshRecurrenceEditor","createRecurrenceEditor","setRecurrenceEditor","editorTemplate","isEventData","cellClickAction","renderFormElements","onCellDetailsUpdate","onEventDetailsUpdate","setDialogContent","allowKeyboardInteraction","code","isEnterKey","getSlotDuration","getInstance","deleteObj","callBackPromise","refreshDateTimePicker","startObj","endObj","resolve","isInteracted","eventCrudData","processCrudActions","resetForm","onsubmit","formElements","tempEle","getEditorTemplate","getDefaultEventWindowContent","parentDiv","createDivElement","titleLocationDiv","renderTextBox","editorTitles","startEndDateTimeDiv","renderDateTimePicker","onTimeChange","allDayTimezoneDiv","renderCheckBox","timezoneParentDiv","renderDropDown","repeatParentDiv","repeatDiv","repeatEditContainer","loadRecurrenceEditor","resourceParentDiv","renderResourceDetails","submit","title","renderRecurrenceEditor","updateMinMaxDateToEditor","createInputElement","fieldName","changeEvent","dateTimeDiv","getFieldName","dateTimeInput","dateTimePicker","timeFormat","getFieldLabel","step","startEndElement","labelValue","resourceDiv","resourceInput","resourceTemplate","allowMultiple","listObj","onMultiselectResourceChange","itemTemplate","popupHeight","mode","dropDownList","onDropdownResourceChange","timezoneDiv","timezoneInput","allowFiltering","onTimezoneChange","timezoneDataSource","filterBarPlaceholder","noRecordsTemplate","filtering","updateData","byGroupID","getColumnName","resObject","createInstance","datasource","resourceModel","groupId","filterRes","filterDatasource","resObj","itemData","resValue","startTimezoneObj","endTimezoneObj","checkBoxDiv","checkBoxInput","checkBox","onChange","repeatStatus","textBoxDiv","textBoxInput","labelText","targetSelector","onAllDayChange","timezoneChangeStyle","onRepeatChange","renderRepeatDialog","repeatDialogObject","repeatSaveDialog","repeatCancelDialog","repeatOpenDialog","repeatRule","repeatStartDate","updateRepeatLabel","closeRepeatDialog","repeatTempRule","showDetails","disableButton","RecurrenceRule","getValidationRule","trimAllDay","getFormElements","keyNames","curElement","columnName","setValueToElement","setDefaultValueToElement","timezoneObj","attrName","isDropDowns","fieldSelector","classSelector","control","attrEle","allDayStatus","updateDateTime","getStartEndTime","workHours","timezoneValue","isDisable","saveIcon","untilObj","resetFormFields","localTimezoneName","found","some","formElement","currentElement","alert","dataCollection","getEventDataFromEditor","processEventValidation","Repeat","alertType","recurrenceValidation","isShowAlert","getResourceData","isResourceEventExpand","allowGroupEdit","getEventIdFromForm","eveId","editedData","editOccurrenceValidation","resourceSaveEvent","getValueFromElement","alertMessage","recEditor","excludedEvents","seriesEvents","types","tempDiff","tempValue","getRecurrenceIndex","recColl","recIndex","currentData","editData","recurColl","excludedDatas","lastLevel","eventList","addValues","resCol","l","sanitize","dateValue","isIgnore","VirtualScroll","itemSize","bufferCount","renderedLength","isScrollHeightNull","getRenderedCount","setItemSize","setTranslateValue","resWrap","eventWrap","timeIndicator","renderVirtualTrackHeight","setTranslate","resourceWrap","setExpandedResources","renderVirtualTrack","lastResourceIndex","lastRenderIndex","conTable","updateVirtualTrackHeight","resourceCount","lastCollIndex","renderedResCount","setTabIndex","refreshEvents","firstTDIndex","upScroll","downScroll","focusedEle","updateContent","actionObj","navigationWrapper","clearTimeout","timeValue","prevSetCollection","getBufferCollection","nextSetResIndex","lastIndex","nextSetCollection","isResourceCell","resourceRows","getContentRows","contentRows","eventRows","getEventRows","focusResCell","Render","isDataRefresh","initializeLayout","templates","dayModule","weekModule","workWeekModule","yearModule","agendaModule","monthAgendaModule","timelineViewsModule","viewClass","timelineMonthModule","timelineYearModule","firstView","Error","updateLabelText","enableCompactView","allowVirtualScrolling","updateHeader","getLabelText","__decorate$2","WorkHours","__decorate$3","TimeScale","__decorate$4","QuickInfoTemplates","__decorate$5","HeaderRows","Crud","getQuery","dataModule","getTable","fromTable","then","dataManagerSuccess","catch","dataManagerFailure","resultData","result","refreshData","actionArgs","addedRecords","editParams","changedRecords","deletedRecords","crudData","tdData","offline","offlineArgs","promise","onlineArgs","isBlockEvent","addEvents","addArgs","saveChanges","insert","crudArgs","processSave","processOccurrences","processFollowSeries","processEntireSeries","updateEvents","saveArgs","update","deleteEvents","deleteArgs","occurrenceData","isDeletedRecords","occurrenceArgs","occurrenceEvents","childEvent","parentException","exceptionDate","excludeDateCheck","followData","updateFollowEvents","followArgs","followEvents","processRecurrenceRule","seriesData","updateSeriesEvents","seriesArgs","eventCollections","deletedEvents","originalParent","deleteData","isDelete","isEdited","editedDate","editArgs","exceptionString","parentEle","exceptionDateList","followEvent","newRecurrenceRule","ruleException","getUpdatedRecurrenceRule","splitRule","updatedRule","ruleKey","ruleValue","WorkCellInteraction","onHover","navigateView","sameView","viewOptions","isWorkCell","cellDblClick","hoverTarget","hoverArgs","__decorate$8","FieldOptions","__decorate$7","Field","__decorate$6","EventSettings","__decorate$9","Group","__decorate$10","Resources","ResourceBase","leftPixel","renderResourceHeaderIndent","resColTd","resColDiv","headerIndentTemplate","renderHeaderIndentTemplate","hideResourceRows","tBody","trCount","ClassName","expandedField","trCollection","slicedCollection","Count","createResourceColumn","resColl","resDiv","tbl","createTableLayout","generateTreeData","countCalculation","setRenderedResources","isExpanded","isVirtualScroll","resRows","rIndex","tabindex","ntd","iconDiv","setMargin","onTreeIconClick","setResourceHeaderContent","resourceHeaderTemplate","classCollection","ntr","marginLeft","marginRight","parentCollection","wholeCollection","y","totalCount","z","trElement","eventElements","updateVirtualContent","rowCollection","workCellCollection","headerRowCollection","pNode","clickedRes","clonedCollection","expanded","trElem","sIndex","virtualTrack","resTable","contentTable","eventTable","renderResourceHeader","resourceWrapper","renderResourceHeaderText","menuClick","renderResourceTree","popupOverlay","treeWrapper","resourceTree","treeViewObj","child","nodeTemplate","nodeClicked","resourceClick","expandAll","treePopup","isTimeLine","treeCollection","resTreeColl","resourceTreeLevel","treeHandler","treeLevel","levelId","treeArgs","resourceName","resourceChild","tree","headerCollection","resourceLevel","levelIcon","headerWrapper","treeNodes","selectResourceByIndex","triggerEvents","renderModule","bindResourcesData","isSetModel","promises","Promise","all","resourceObj","getResourceModel","refreshLayout","startHourField","endHourField","workDaysField","cssClassField","renderElements","setResourceCollection","requiredResources","colorIndex","resourceColorField","generateResourceLevels","innerDates","resTreeGroup","lastColumnDates","prevResource","prevResourceData","prevOrder","resTree","dateCol","resWorkDays","resStartHour","resEndHour","getDateSlots","dateSlots","generateCustomHours","resCssClass","resourceLevelIndex","colSpan","generateHeaderLevels","dateSlot","headerDates","headerLevels","currentLevelChilds","currentLevelChild","nextLevelChilds","nextLevelChild","lastLevelResource","dateHeaderLevels","levels","dateColSpan","firstRowTd","datesColumn","headerDate","resGroup","resTd","unshift","colorFieldIndex","filterData","getResourceRenderDates","resourceDates","removeDuplicateDates","dateColl","groupEditIndex","addResource","addObj","removeResource","removeObj","resourceExpand","resourceScroll","scrollElement","offsetTarget","resToolBarEle","Schedule","addClasses","allowMultiDrag","cls","validateDate","scrollModule","workCellAction","initializeDataModule","renderTableContainer","getActiveViewOptions","initializeResources","wireEvents","isReact","renderReactTemplates","isAngular","clearTemplate","isLayoutOnly","initializeView","destroyHeaderModule","showHeaderBar","isTouch","scheduleTouchModule","destroyPopups","initializePopups","getViewIndex","checkIndex","setViewOptions","isModuleLoad","selectedView","prevIndex","isOptions","isSelected","fieldViewName","cellHeaderTemplateName","cellHeaderTemplate","dateHeaderTemplateName","dateHeaderTemplate","cellTemplateName","cellTemplate","dayHeaderTemplateName","dayHeaderTemplate","monthHeaderTemplateName","monthHeaderTemplate","resourceHeaderTemplateName","headerIndentTemplateName","currentIndex","majorSlotTemplate","minorSlotTemplate","isYearView","scheduleOptions","template","firstMonthOfYear","monthsCount","internalTimeFormat","viewsData","setEditorTitles","initializeTemplates","cellHeaderTemplateFn","templateParser","dayHeaderTemplateFn","monthHeaderTemplateFn","cellTemplateFn","dateHeaderTemplateFn","majorSlotTemplateFn","minorSlotTemplateFn","appointmentTemplateFn","resourceHeaderTemplateFn","headerIndentTemplateFn","headerTooltipTemplateFn","eventTooltipTemplateFn","editorTemplateFn","quickInfoTemplatesHeaderFn","quickInfoTemplatesContentFn","quickInfoTemplatesFooterFn","getDayNames","culShortNames","setCldrTimeFormat","getDateTime","setCalendarMode","muteOnChange","previousView","navigationArgs","isInitial","animateLayout","timingFunction","requiredModules","modules","member","allowDragAndDrop","getDefaultLocale","workWeek","agenda","weekAgenda","workWeekAgenda","monthAgenda","today","noEvents","emptyContainer","allDay","more","noTitle","deleteMultipleEvent","selectedItems","deleteSeries","edit","editSeries","editEvent","createEvent","addTitle","moreDetails","save","editContent","deleteContent","deleteMultipleContent","newEvent","recurrence","wrongPattern","seriesChangeAlert","createError","sameDayAlert","occurenceAlert","editRecurrence","repeats","startEndError","invalidDateError","blockAlert","ok","yes","no","series","previous","next","timelineDay","timelineWeek","timelineWorkWeek","timelineMonth","timelineYear","editFollowingEvent","deleteTitle","editTitle","beginFrom","endAt","expandAllDaySection","collapseAllDaySection","searchTimezone","noRecords","onScheduleResize","touchStartEvent","onDocumentClick","isPreventScroll","isAllDayCell","dateInMS","getTargetElement","elementFromPoint","targetElement","getCellHeaderTemplate","getDayHeaderTemplate","getMonthHeaderTemplate","getCellTemplate","getDateHeaderTemplate","getMajorSlotTemplate","getMinorSlotTemplate","getResourceHeaderTemplate","getHeaderIndentTemplate","cssProps","border","padding","rtlBorder","rtlPadding","eventClone","startEndTime","startEndDate","highlightCurrentTime","resetColWidth","trim","constantText","startDateText","endDateText","announcementString","autoScrollDistance","scrollEdges","viewBoundaries","pageYOffset","pageXOffset","getWeekNumberContent","weekNumber","weekRule","weekNumberDate","weekFirstDate","weekLastDate","weekMidDate","indentTemplate","isRefresh","isResource","isDate","isView","isLayout","isDataManager","setRtlClass","extendedPropertyChange","propertyChangeAction","allDayRowScrollUpdate","onEventSettingsPropertyChanged","onGroupSettingsPropertyChanged","setWorkHours","getWorkHourCells","resetWorkHours","workHourCells","viewStartHour","viewEndHour","msMajorInterval","tempStartIndex","tempEndIndex","colIndex","tds","tdCol","firstTd","lastTd","endDateFromColSpan","getEndDateFromStartDate","getResourceCollections","setResourceCollections","resourceCol","changeCurrentView","getCurrentViewIndex","getResourcesByIndex","groupData","expandResource","collapseResource","scrollTo","hour","scrollDate","scrollToDate","scrollToHour","scrollToResource","groupName","exportToICalendar","fileName","customData","iCalendarExportModule","initializeCalendarExport","importICalendar","fileContent","iCalendarImportModule","initializeCalendarImport","exportToExcel","excelExportOptions","excelExportModule","initializeExcelExport","printOptions","printModule","getEvents","includeOccurrences","getBlockEvents","eventID","getCurrentViewEvents","isRemoteRefresh","templateNames","refreshTemplates","refreshHeader","refreshResourceHeader","isSlotAvailable","closeEditor","openQuickInfoPopup","getAdjustedDate","selectEvent","occurence","closeQuickInfoPopup","ActionBase","daysVariation","slotInterval","actionIndex","cloneElement","originalElement","excludeSelectors","navigationInterval","scrollInterval","scrollArgs","resizeEdges","getChangedData","multiData","getOriginalElement","indexCol","cloneIndex","saveChangedData","isMultiSelect","eventsCollection","selectedData","isSameResource","calculateIntervalTime","intervalTime","getContentAreaDimension","viewElement","getResourceElements","leftOffset","rightOffset","viewDimension","getPageCoordinates","changedTouches","contentElements","indexes","minIndex","groupElements","updateTimePosition","timeElement","wrapperClass","offsetValue","rightValue","leftValue","table","isMorePopup","createCloneElement","cloneWrapper","outerHTML","cloneClassLists","dragElement","eventDragArea","removeCloneElementClasses","removeCloneElement","dynamicEle","cloneEle","getCursorElement","pages","clientX","clientY","autoScroll","yIsScrollable","xIsScrollable","tdCollections","scrollBy","autoScrollValidation","actionClass","updateScrollPosition","scrollEventArgs","setInterval","updateDraggingDateTime","updateResizingDirection","timeDelay","updateOriginalElement","eventWrappers","getUpdatedEvent","parse","dynamicYearlyEventsRendering","yearEvent","renderDynamicElement","dynamicEventsRendering","Resize","resizeElement","resizeHelper","resizeTarget","resizeArgs","resizeEventArgs","hRows","trRect","touchMoveEvent","touchEndEvent","monthResizing","resizeValidation","leftStyles","getLeftRightStyles","horizontalResizing","rightStyles","topStyles","getTopBottomStyles","verticalResizing","bottomStyles","resizeTime","isSameCell","yearEventsRendering","monthDiff","getMonthDiff","getEventCount","monthStart","monthEnd","clearInterval","isDateHeader","headerName","isTimeViews","isTimelineMonth","isWithoutScale","isLastCell","pixelsPerMinute","cellOffsetWidth","resizeDate","spanMinutes","originalWidth","isTimeScaleViews","resizeEnd","clnHeight","clnTop","pageWidth","targetWidth","cloneWidth","isTimeScale","EVENT_GAP$2","YearEvent","yearViewEvents","removeCellHeight","timelineResourceEvents","timelineYearViewEvents","getMonths","cellHeader","wrapperCollection","isSpannedCollection","rowTd","dayStart","dayEnd","dayEvents","updateSpannedEvents","overlapIndex","availedHeight","moreIndicatorCount","isRendered","MoreIndicator","moreIndex","renderMoreIndicator","isRowAutoHeight","renderEvent","isLeftRightResize","renderResourceEvent","eventDatas","createEventElement","rowTr","locationEle","startTimeEle","endTimeEle","dateStart","dateEnd","appStart","appEnd","timeCondition","MINUTES_PER_DAY","DragAndDrop","widthUptoCursorPoint","heightUptoCursorPoint","cursorPointIndex","isHeaderRows","isTimelineDayProcess","widthPerMinute","heightPerMinute","minDiff","isStepDragging","isMorePopupOpened","isAllDayDrag","updatedData","swagData","isAllDayTarget","targetTd","isCursorAhead","abort","isDragScroll","enableTapHold","enableTailMode","cursorAt","dragArea","enableAutoScroll","helper","dragHelper","queryPositionInfo","dragPosition","setDragActionDefaultValues","cursor","cloneRight","contentWrapRight","pointerEvents","cloneBottom","eventGuid","dragArgs","getSelectedData","navigation","dragEventArgs","dragObj","intDestroy","timelineEventModule","splitEvents","appWrap","appEle","calculateMinutesDiff","updateNavigatingPosition","isAllowDrop","currentGroupIndex","crtDate","viewNavigation","morePopupEventDragging","calculateTimelineTime","calculateVerticalDate","calculateVerticalTime","outerWrapperCls","targetWrapper","elementHeight","getAllDayEventHeight","outWrapper","tarWrapper","navigationType","dragStart$$1","dragEnd","eventContainer","appendCloneElement","swapDragging","trCollections","getEventWrapper","updateAllDayEvents","dynamicWrappers","targetCellTime","startTimeDiff","updateMultipleData","getDayIndex","updateEventHeight","startReferenceDate","endReferenceDate","timeDifference","endTimeDiff","differInDays","datesCount","indexGroup","dynamicIndex","filterQuery","renderSpannedEvents","timeDiff","tagName","updateMultipleVerticalDate","getOffsetValue","getColumnIndex","cursorDrag","leftVal","cursorIndex","getCursorCurrentIndex","widthDiff","getWidthDiff","eventSrt","dataIndex","calculateResourceGroupingPosition","viewEle","targetLeft","dateLength","scrollY","cursorElement","dropSelectors","ViewBase","lastElementChild","getDayName","getTimelineDate","createEventTable","collapseRows","createColGroup","lastRow","reduce","prev","colGroupEle","getScrollXIndent","scrollTopPanel","getDatesHeaderElement","scrollHeaderLabels","headerTable","colWidth","applyLeft","headerCells","isRtl","tdLeft","hiddenLeft","addAttributes","getHeaderBarHeight","headerBarHeight","resHeader","panel","colLevels","isCurrentDate","isCurrentMonth","isWorkDay","isWorkHour","agendaDaysCount","weekLength","viewStr","formatDateRange","formattedStr","longDateFormat","toLocaleLowerCase","getMobileDateElement","tdElement","quickTemplate","renderResourceMobileLayout","addAutoHeightClass","getColElements","setColWidth","colElements","contentBody","col","resourceColumn","headerCellElements","headerCellColSpan","getContentAreaElement","wireExpandCollapseIconEvents","treeIcons","icon","scrollWrap","setPersistence","retainScrollPosition","getViewStartDate","getViewEndDate","VerticalView","baseCssClass","onContentScroll","scrollLeftPanel","onAdaptiveMove","onAdaptiveScroll","leftPanel","getLeftPanelElement","timeCells","getScrollableElement","scrollerHeight","setContentHeight","scrollBarWidth","isDateHeaderScroll","scrollToWorkHour","leftPanelElement","highlight","firstWorkHourCell","headerElement","getTopFromDateTime","columnLevels","workStartHour","workEndHour","isWorkHourRange","showTimeIndicator","currentDateIndex","getCurrentTimeIndicatorIndex","changeCurrentTimePosition","currentTimeIndicatorTimer","clearCurrentTimeIndicatorTimer","updateCurrentTimeIndicatorTimer","removeCurrentTimeIndicatorElements","firstRow","topInPx","timeCellsWrap","timeTrs","curTimeWrap","currentTimeEle","getWorkCellHeight","getTdContent","cntEle","clsList","renderContent","dateTd","renderDatesHeader","indentTd","renderLeftIndent","workTd","scrollContainer","renderTimeCells","renderContentArea","timesTd","trEle","rowCount","nth","createTd","appointmentExpandCollapse","createAllDayRow","wireCellEvents","thead","createEventWrapper","wireMouseEvents","handler","getTimeSlotRows","renderContentTable","createContentTd","renderContentTableHeader","getContentTdClass","cellDate","innerWrapper","msStartHour","msEndHour","timeOffset","majorTickDivider","middle","timeSlots","contentScrollableEle","Day","Week","WorkWeek","Month","dayNameFormat","monthDates","onScrollUIUpdate","onDataReady","onCellClick","scrollToSelectedDate","headerCell","getDayNameFormat","renderWeekNumberContent","contentArea","monthAgendaWrapper","renderAppointmentContainer","contentWrapper","contentWrapTable","createWeekNumberElement","createHeaderCell","dateTemplate","getContentSlots","slotDatas","prepareSlots","renderDate","includeResource","colDates","colDate","resourcesTd","updateClassList","isOtherMonth","trows","renderDateHeaderElement","announcementText","getMonthStart","useDisplayDate","isCustomRange","getMonthEnd","numberOfDays","lastWeekOfMonth","updateCustomRange","isUpdateDateRange","monthNames","Year","yearEventModule","viewTypeClass","calendarTable","calendarTBody","getRowColumnCount","columnCount","cTr","cTd","calendarWrapper","currentMonth","calendarElement","renderCalendarHeader","renderCalendarContent","headerContent","getMonthName","getMonthDates","currentWeek","weekDates","span","createTableColGroup","parseDate","monthDaysCount","isPrevious","activeDate","inRange","moreEventArgs","scrollTopSelector","scrollTopElement","onScrollUiUpdate","leftPanelSelector","isYScroll","contentScroll","AgendaBase","createAgendaContentElement","listData","aTd","listElement","createList","moduleName","listClass","itemClass","listElements","li","appWrapper","templateEle","createAppointment","appSubjectWrap","strDate","allDayStr","milliSeconds","eventString","displayStr","appDateTime","processAgendaEvents","spanned","wireEventActions","dateHeaderElement","dayNavigationClick","calculateResourceTableElement","agendaDate","agendaLastDate","lastLevelInfo","tempLastLevelInfo","tempIndex","finalDate","agendaCollection","hideEmptyAgendaDays","resDataCollection","resDayCollection","rowSpan","topResources","tempGroupedData","totalRowSpan","u","createResourceTableRow","totalCollection","renderEmptyContent","tContent","tContentCollection","w","rowSpanCollection","createDateHeaderElement","eTr","createTableRowElement","eTd","dTd","Agenda","agendaDates","virtualScrollTop","eventLoad","renderInitialContent","refreshEvent","refreshDate","emptyTBody","contentChild","isObject","appointmentFiltering","updateHeaderText","nTr","agendaScrolling","totalHeight","topElement","getElementFromScrollerPosition","filterDate","getPreviousNextDate","scrollToValue","filterElement","liCollection","liDetails","getStartDateFromEndDate","onAgendaScrollUiUpdate","MonthAgenda","monthAgendaDate","wrapperContainer","appendAppContainer","setEventWrapperHeight","availHeight","clearElements","agendaBase","getAgendaBase","onEventRender","appContainer","appointmentIndicators","appointmentIndicator","navigateDate","TimelineHeaderRow","groupByYear","groupByMonth","groupByWeek","jsDate","generateSlots","colspan","dateParser","tdDatas","htmlCol","viewTemplate","hourSlots","lastLevelColspan","byYear","byMonth","byWeek","TimelineViews","timelineAppointment","currDateTime","getLeftFromDateTime","generateTimeSlots","renderGn","timeSlotData","tempTimeSlots","headerWrap","diffInDates","getWorkCellWidth","getRowCount","getResourceTdData","resLevel","resSHr","resEHr","TimelineMonth","contentTr","contentTd","TimelineYear","leftHeaderCells","isHorizontal","innerTr","dayHeaderDates","innerTd","renderDayMonthHeaderTemplate","colData","tdCollection","monthTBody","monthWrapper","contentTBody","addClassTable","colCount","renderResourceContent","renderDefaultContent","monthBody","monthTr","monthTd","isDateAvail","dayDate","renderCellTemplate","tRow","monthCells","tdELe","dayId","monthId","ICalendarExport","SEPARATOR","appVersion","iCalendarEvents","filterCollection","uId","editedExDate","UID","editedObj","startZone","endZone","calendarEvent","convertDateToString","customFields","customFieldFilter","customField","iCalendar","icsString","download","defaultFields","eventDate","buffer","Blob","msSaveBlob","downloadLink","createElementNS","href","URL","createObjectURL","initEvent","dispatchEvent","revokeObjectURL","ICalendarImport","fileReader","FileReader","onload","iCalString","iCalendarParser","readAsText","calArray","RegExp","isEvent","curEvent","dateParsing","processOccurrence","appoint","appointmentIds","hasOwnProperty","exdate","getDateString","expression","newDate","exec","ExcelExport","exportColumns","getExportColumns","exportName","exportType","isIncludeOccurrences","separator","processWorkbook","columns","columnHeader","fontSize","borders","bold","columnData","n","columnRule","styleRule","numberFormat","workSheet","book","worksheets","exportOptions","fieldsInfo","Print","printScheduler","printSchedulerWithModel","scrollableEle","links","getElementsByTagName","reference","link","elementWidth","printWindow","write","ready","headerTimeCellsScroll","timeCellsScroll","Inject","printInstance","getPrintScheduleModel","outerHeight","outerWidth","moveTo","resizeTo","screen","availWidth","printModel","scheduleProps","assign","onbeforeunload"],"sources":["D:/StageCap2022/e-learningProject__frontend/frontend/node_modules/@syncfusion/ej2-schedule/dist/es6/ej2-schedule.es2015.js"],"sourcesContent":["import { Animation, Browser, ChildProperty, Collection, Complex, Component, Draggable, Event, EventHandler, HijriParser, Internationalization, KeyboardEvents, L10n, NotifyPropertyChanges, Property, SanitizeHtmlHelper, Touch, addClass, append, classList, cldrData, closest, compile, createElement, extend, formatUnit, getDefaultDateObject, getElement, getValue, isNullOrUndefined, prepend, print, remove, removeClass, setStyleAttribute } from '@syncfusion/ej2-base';\nimport { Dialog, Popup, Tooltip, createSpinner, hideSpinner, isCollide, showSpinner } from '@syncfusion/ej2-popups';\nimport { Toolbar, TreeView } from '@syncfusion/ej2-navigations';\nimport { Calendar, DatePicker, DateTimePicker } from '@syncfusion/ej2-calendars';\nimport { DataManager, Deferred, Predicate, Query } from '@syncfusion/ej2-data';\nimport { Button, CheckBox, RadioButton } from '@syncfusion/ej2-buttons';\nimport { FormValidator, Input, NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { DropDownList, MultiSelect } from '@syncfusion/ej2-dropdowns';\nimport { ListBase } from '@syncfusion/ej2-lists';\nimport { Workbook } from '@syncfusion/ej2-excel-export';\n\n/**\n * Constants\n */\n/** @private */\nconst cellClick = 'cellClick';\n/** @private */\nconst cellDoubleClick = 'cellDoubleClick';\n/** @private */\nconst moreEventsClick = 'moreEventsClick';\n/** @private */\nconst select = 'select';\n/** @private */\nconst hover = 'hover';\n/** @private */\nconst actionBegin = 'actionBegin';\n/** @private */\nconst actionComplete = 'actionComplete';\n/** @private */\nconst actionFailure = 'actionFailure';\n/** @private */\nconst navigating = 'navigating';\n/** @private */\nconst renderCell = 'renderCell';\n/** @private */\nconst eventClick = 'eventClick';\n/** @private */\nconst eventRendered = 'eventRendered';\n/** @private */\nconst dataBinding = 'dataBinding';\n/** @private */\nconst dataBound = 'dataBound';\n/** @private */\nconst popupOpen = 'popupOpen';\n/** @private */\nconst popupClose = 'popupClose';\n/** @private */\nconst dragStart = 'dragStart';\n/** @private */\nconst drag = 'drag';\n/** @private */\nconst dragStop = 'dragStop';\n/** @private */\nconst resizeStart = 'resizeStart';\n/** @private */\nconst resizing = 'resizing';\n/** @private */\nconst resizeStop = 'resizeStop';\n/** @private */\nconst inlineClick = 'inlineClick';\n/**\n * Specifies schedule internal events\n */\n/** @private */\nconst initialLoad = 'initial-load';\n/** @private */\nconst initialEnd = 'initial-end';\n/** @private */\nconst print$1 = 'print';\n/** @private */\nconst dataReady = 'data-ready';\n/** @private */\nconst eventsLoaded = 'events-loaded';\n/** @private */\nconst contentReady = 'content-ready';\n/** @private */\nconst scroll = 'scroll';\n/** @private */\nconst virtualScroll = 'virtual-scroll';\n/** @private */\nconst scrollUiUpdate = 'scroll-ui-update';\n/** @private */\nconst uiUpdate = 'ui-update';\n/** @private */\nconst documentClick = 'document-click';\n/** @private */\nconst cellMouseDown = 'cell-mouse-down';\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\n/**\n * Schedule common utilities\n */\nconst WEEK_LENGTH = 7;\nconst DEFAULT_WEEKS = 6;\nconst MS_PER_DAY = 86400000;\nconst MS_PER_MINUTE = 60000;\n/**\n * Method to get height from element\n *\n * @param {Element} container Accepts the DOM element\n * @param {string} elementClass Accepts the element class\n * @returns {number} Returns the height of the element\n */\nfunction getElementHeightFromClass(container, elementClass) {\n    let height = 0;\n    const el = createElement('div', { className: elementClass }).cloneNode();\n    el.style.visibility = 'hidden';\n    el.style.position = 'absolute';\n    container.appendChild(el);\n    height = el.getBoundingClientRect().height;\n    remove(el);\n    return height;\n}\n/**\n * Method to get translateY value\n *\n * @param {HTMLElement | Element} element Accepts the DOM element\n * @returns {number} Returns the translateY value of given element\n */\nfunction getTranslateY(element) {\n    const style = getComputedStyle(element);\n    return window.WebKitCSSMatrix ?\n        new WebKitCSSMatrix(style.webkitTransform).m42 : 0;\n}\n/**\n * Method to get week first date\n *\n * @param {Date} date Accepts the date object\n * @param {number} firstDayOfWeek Accepts the first day of week number\n * @returns {Date} Returns the date object\n */\nfunction getWeekFirstDate(date, firstDayOfWeek) {\n    const date1 = new Date(date.getTime());\n    firstDayOfWeek = (firstDayOfWeek - date1.getDay() + 7 * (-1)) % 7;\n    return new Date(date1.setDate(date1.getDate() + firstDayOfWeek));\n}\n/**\n * Method to get week last date\n *\n * @param {Date} date Accepts the date object\n * @param {number} firstDayOfWeek Accepts the first day of week number\n * @returns {Date} Returns the date object\n */\nfunction getWeekLastDate(date, firstDayOfWeek) {\n    const weekFirst = getWeekFirstDate(date, firstDayOfWeek);\n    const weekLast = new Date(weekFirst.getFullYear(), weekFirst.getMonth(), weekFirst.getDate() + 6);\n    return new Date(weekLast.getTime());\n}\n/**\n * Method to get first date of month\n *\n * @param {Date} date Accepts the date object\n * @returns {Date} Returns the date object\n */\nfunction firstDateOfMonth(date) {\n    return new Date(date.getFullYear(), date.getMonth(), 1);\n}\n/**\n * Method to get last date of month\n *\n * @param {Date} date Accepts the date object\n * @returns {Date} Returns the date object\n */\nfunction lastDateOfMonth(date) {\n    return new Date(date.getFullYear(), date.getMonth() + 1, 0);\n}\n/**\n * Method to get week number\n *\n * @param {Date} date Accepts the date object\n * @returns {number} Returns the week number\n */\nfunction getWeekNumber(date) {\n    const date1 = new Date(date.getFullYear(), 0, 1).valueOf();\n    const currentDate = new Date(date.getFullYear(), date.getMonth(), date.getDate()).valueOf();\n    const dayOfYear = ((currentDate - date1 + MS_PER_DAY) / MS_PER_DAY);\n    return Math.ceil(dayOfYear / 7);\n}\n/**\n * Method to get week middle date\n *\n * @param {Date} weekFirst Accepts the week first date object\n * @param {Date} weekLast Accepts the week last date object\n * @returns {Date} Returns the date object\n */\nfunction getWeekMiddleDate(weekFirst, weekLast) {\n    return new Date(weekLast.valueOf() - ((weekLast.valueOf() - weekFirst.valueOf()) / 2));\n}\n/**\n * Method to set time to date object\n *\n * @param {Date} date Accepts the date object\n * @param {number} time Accepts the milliseconds\n * @returns {Date} Returns the date object\n */\nfunction setTime(date, time) {\n    const tzOffsetBefore = date.getTimezoneOffset();\n    const d = new Date(date.getTime() + time);\n    const tzOffsetDiff = d.getTimezoneOffset() - tzOffsetBefore;\n    date.setTime(d.getTime() + tzOffsetDiff * MS_PER_MINUTE);\n    return date;\n}\n/**\n * Method the reset hours in date object\n *\n * @param {Date} date Accepts the date object\n * @returns {Date} Returns the date object\n */\nfunction resetTime(date) {\n    return new Date(date.getFullYear(), date.getMonth(), date.getDate());\n}\n/**\n * Method to get milliseconds from date object\n *\n * @param {Date} date Accepts the date object\n * @returns {number} Returns the milliseconds from date object\n */\nfunction getDateInMs(date) {\n    const localOffset = new Date(date.getFullYear(), date.getMonth(), date.getDate(), 0, 0, 0).getTimezoneOffset();\n    const dateOffset = date.getTimezoneOffset();\n    const timezoneOffset = dateOffset - localOffset;\n    return ((date.getTime() - new Date(date.getFullYear(), date.getMonth(), date.getDate(), 0, 0, 0).getTime())\n        - (timezoneOffset * 60 * 1000));\n}\n/**\n * Method to get date count between two dates\n *\n * @param {Date} startDate Accepts the date object\n * @param {Date} endDate Accepts the date object\n * @returns {number} Returns the date count\n */\nfunction getDateCount(startDate, endDate) {\n    return Math.ceil((endDate.getTime() - startDate.getTime()) / MS_PER_DAY);\n}\n/**\n * Method to add no of days in date object\n *\n * @param {Date} date Accepts the date object\n * @param {number} noOfDays Accepts the number of days count\n * @returns {Date} Returns the date object\n */\nfunction addDays(date, noOfDays) {\n    date = new Date('' + date);\n    return new Date(date.setDate(date.getDate() + noOfDays));\n}\n/**\n * Method to add no of months in date object\n *\n * @param {Date} date Accepts the date object\n * @param {number} noOfMonths Accepts the number of month count\n * @returns {Date} Returns the date object\n */\nfunction addMonths(date, noOfMonths) {\n    date = new Date('' + date);\n    const day = date.getDate();\n    date.setDate(1);\n    date.setMonth(date.getMonth() + noOfMonths);\n    date.setDate(Math.min(day, getMaxDays(date)));\n    return date;\n}\n/**\n * Method to add no of years in date object\n *\n * @param {Date} date Accepts the date object\n * @param {number} noOfYears Accepts the number of month count\n * @returns {Date} Returns the date object\n */\nfunction addYears(date, noOfYears) {\n    date = new Date('' + date);\n    const day = date.getDate();\n    date.setDate(1);\n    date.setFullYear(date.getFullYear() + noOfYears);\n    date.setDate(Math.min(day, getMaxDays(date)));\n    return date;\n}\n/**\n * Method to get start and end hours\n *\n * @param {Date} date Accepts the date object\n * @param {Date} startHour Accepts the start hour date object\n * @param {Date} endHour Accepts the end hour date object\n * @returns {Object} Returns the start and end hour date objects\n */\nfunction getStartEndHours(date, startHour, endHour) {\n    const date1 = new Date(date.getTime());\n    date1.setHours(startHour.getHours());\n    date1.setMinutes(startHour.getMinutes());\n    date1.setSeconds(startHour.getSeconds());\n    let date2 = new Date(date.getTime());\n    if (endHour.getHours() === 0) {\n        date2 = addDays(date2, 1);\n    }\n    else {\n        date2.setHours(endHour.getHours());\n        date2.setMinutes(endHour.getMinutes());\n        date2.setSeconds(endHour.getSeconds());\n    }\n    return { startHour: date1, endHour: date2 };\n}\n/**\n * Method to get month last date\n *\n * @param {Date} date Accepts the date object\n * @returns {number} Returns the month last date\n */\nfunction getMaxDays(date) {\n    return lastDateOfMonth(date).getDate();\n}\n/**\n * Method to get days count between two dates\n *\n * @param {Date} startDate Accepts the date object\n * @param {Date} endDate Accepts the date object\n * @returns {number} Returns the days count\n */\nfunction getDaysCount(startDate, endDate) {\n    const strTime = resetTime(new Date(startDate));\n    const endTime = resetTime(new Date(endDate));\n    return Math.round((endTime.getTime() - strTime.getTime()) / MS_PER_DAY);\n}\n/**\n * Method to get date object from date string\n *\n * @param {string} date Accepts the date string\n * @returns {Date} Returns the date object\n */\nfunction getDateFromString(date) {\n    return date.indexOf('Date') !== -1 ? new Date(parseInt(date.match(/\\d+/g).toString(), 10)) :\n        date.indexOf('T') !== -1 ? new Date(date) : new Date(date.replace(/-/g, '/'));\n}\n/** @private */\nlet scrollWidth = null;\n/**\n * Method to get scrollbar width\n *\n * @returns {number} Returns the scrollbar width\n * @private\n */\nfunction getScrollBarWidth() {\n    if (scrollWidth !== null) {\n        return scrollWidth;\n    }\n    const divNode = createElement('div');\n    let value = 0;\n    divNode.style.cssText = 'width:100px;height: 100px;overflow: scroll;position: absolute;top: -9999px;';\n    document.body.appendChild(divNode);\n    const ratio = (devicePixelRatio) ? (devicePixelRatio.toFixed(2) === '1.10' || devicePixelRatio <= 1) ?\n        Math.ceil(devicePixelRatio % 1) : Math.floor(devicePixelRatio % 1) : 0;\n    value = (divNode.offsetWidth - divNode.clientWidth - ratio) | 0;\n    document.body.removeChild(divNode);\n    return scrollWidth = value;\n}\n/**\n * Method to find the index from data collection\n *\n * @param {Object} data Accepts the data as object\n * @param {string} field Accepts the field name\n * @param {string} value Accepts the value name\n * @param {Object} event Accepts the data as object\n * @param {Object[]} resourceCollection Accepts the data collections\n * @returns {number} Returns the index number\n */\n// eslint-disable-next-line max-len\nfunction findIndexInData(data, field, value, event, resourceCollection) {\n    for (let i = 0, length = data.length; i < length; i++) {\n        if (data[i][field] === value) {\n            if (event) {\n                const field = resourceCollection.slice(-2)[0].field;\n                const res = (event[field] instanceof Array ? event[field] : [event[field]]);\n                const resData = res.join(',');\n                if (resData.includes(data[i][resourceCollection.slice(-1)[0].groupIDField])) {\n                    return i;\n                }\n            }\n            else {\n                return i;\n            }\n        }\n    }\n    return -1;\n}\n/**\n * Method to get element outer height\n *\n * @param {HTMLElement} element Accepts the DOM element\n * @returns {number} Returns the outer height of the given element\n */\nfunction getOuterHeight(element) {\n    const style = getComputedStyle(element);\n    return element.offsetHeight + (parseInt(style.marginTop, 10) || 0) + (parseInt(style.marginBottom, 10) || 0);\n}\n/**\n * Method to remove child elements\n *\n * @param {HTMLElement | Element} element Accepts the DOM element\n * @returns {void}\n */\nfunction removeChildren(element) {\n    const elementChildren = [].slice.call(element.children);\n    for (const elementChild of elementChildren) {\n        if (!elementChild.classList.contains('blazor-template')) {\n            element.removeChild(elementChild);\n        }\n    }\n}\n/**\n * Method to check DST is present or not in date object\n *\n * @param {Date} date Accepts the date object\n * @returns {boolean} Returns the boolean value for either DST is present or not\n */\nfunction isDaylightSavingTime(date) {\n    const jan = new Date(date.getFullYear(), 0, 1);\n    const jul = new Date(date.getFullYear(), 6, 1);\n    return date.getTimezoneOffset() < Math.max(jan.getTimezoneOffset(), jul.getTimezoneOffset());\n}\n/**\n * Method to get UTC time value from date\n *\n * @param {Date} date Accepts the date\n * @returns {number} Returns the UTC time value\n */\nfunction getUniversalTime(date) {\n    const year = date.getFullYear();\n    const month = date.getMonth();\n    const day = date.getDate();\n    const hours = date.getHours();\n    const minutes = date.getMinutes();\n    const seconds = date.getSeconds();\n    const milliseconds = date.getMilliseconds();\n    return Date.UTC(year, month, day, hours, minutes, seconds, milliseconds);\n}\n/**\n * Method to check the device\n *\n * @returns {boolean} Returns the boolean value for either device is present or not.\n */\nfunction isMobile() {\n    return window.navigator.userAgent.toLowerCase().indexOf('mobi') > -1;\n}\n/**\n * Method to check the IPad device\n *\n * @returns {boolean} Returns the boolean value for either IPad device is present or not.\n */\nfunction isIPadDevice() {\n    return window.navigator.userAgent.toLowerCase().indexOf('ipad') > -1;\n}\n/**\n * Method to capitalize the first word in string\n *\n * @param {string} inputString Accepts the string value\n * @param {string} type Accepts the string type\n * @returns {string} Returns the output string\n */\nfunction capitalizeFirstWord(inputString, type) {\n    if (type === 'multiple') {\n        inputString = inputString.split(' ').map((e) => e.charAt(0).toLocaleUpperCase() + e.substring(1)).join(' ');\n    }\n    else if (type === 'single') {\n        if (inputString[0] >= '0' && inputString[0] <= '9') {\n            const array = inputString.match(/[a-zA-Z]/);\n            inputString = isNullOrUndefined(array) ? inputString :\n                inputString.slice(0, array.index) + inputString[array.index].toLocaleUpperCase() + inputString.slice(array.index + 1);\n        }\n        inputString = inputString[0].toLocaleUpperCase() + inputString.slice(1);\n    }\n    return inputString;\n}\n\n/**\n * CSS Constants\n */\n/** @private */\nconst ROOT = 'e-schedule';\n/** @private */\nconst RTL = 'e-rtl';\n/** @private */\nconst DEVICE_CLASS = 'e-device';\n/** @private */\nconst MULTI_DRAG = 'e-multi-drag';\n/** @private */\nconst ICON = 'e-icons';\n/** @private */\nconst ENABLE_CLASS = 'e-enable';\n/** @private */\nconst DISABLE_CLASS = 'e-disable';\n/** @private */\nconst TABLE_CONTAINER_CLASS = 'e-table-container';\n/** @private */\nconst SCHEDULE_TABLE_CLASS = 'e-schedule-table';\n/** @private */\nconst ALLDAY_CELLS_CLASS = 'e-all-day-cells';\n/** @private */\nconst HEADER_POPUP_CLASS = 'e-header-popup';\n/** @private */\nconst HEADER_CALENDAR_CLASS = 'e-header-calendar';\n/** @private */\nconst ALLDAY_ROW_CLASS = 'e-all-day-row';\n/** @private */\nconst CONTENT_TABLE_CLASS = 'e-content-table';\n/** @private */\nconst WORK_CELLS_CLASS = 'e-work-cells';\n/** @private */\nconst WORK_HOURS_CLASS = 'e-work-hours';\n/** @private */\nconst POPUP_OPEN = 'e-popup-open';\n/** @private */\n\n/** @private */\nconst DATE_HEADER_WRAP_CLASS = 'e-date-header-wrap';\n/** @private */\nconst DATE_HEADER_CONTAINER_CLASS = 'e-date-header-container';\n/** @private */\nconst HEADER_CELLS_CLASS = 'e-header-cells';\n/** @private */\nconst HEADER_WEEK_CELLS_CLASS = 'e-header-week-cell';\n/** @private */\nconst HEADER_MONTH_CELLS_CLASS = 'e-header-month-cell';\n/** @private */\nconst HEADER_YEAR_CELLS_CLASS = 'e-header-year-cell';\n/** @private */\nconst WORKDAY_CLASS = 'e-work-days';\n/** @private */\nconst OTHERMONTH_CLASS = 'e-other-month';\n/** @private */\nconst CURRENT_DAY_CLASS = 'e-current-day';\n/** @private */\nconst CURRENTDATE_CLASS = 'e-current-date';\n/** @private */\nconst CURRENT_PANEL_CLASS = 'e-current-panel';\n/** @private */\nconst PREVIOUS_PANEL_CLASS = 'e-previous-panel';\n/** @private */\nconst NEXT_PANEL_CLASS = 'e-next-panel';\n/** @private */\nconst PREVIOUS_DATE_CLASS = 'e-prev';\n/** @private */\nconst NEXT_DATE_CLASS = 'e-next';\n/** @private */\nconst TRANSLATE_CLASS = 'e-translate';\n/** @private */\nconst LEFT_INDENT_CLASS = 'e-left-indent';\n/** @private */\nconst LEFT_INDENT_WRAP_CLASS = 'e-left-indent-wrap';\n/** @private */\nconst EVENT_TABLE_CLASS = 'e-event-table';\n/** @private */\nconst RESOURCE_LEFT_TD_CLASS = 'e-resource-left-td';\n/** @private */\nconst RESOURCE_GROUP_CELLS_CLASS = 'e-resource-group-cells';\n/** @private */\nconst RESOURCE_TEXT_CLASS = 'e-resource-text';\n/** @private */\nconst RESOURCE_COLUMN_WRAP_CLASS = 'e-resource-column-wrap';\n/** @private */\nconst RESOURCE_COLUMN_TABLE_CLASS = 'e-resource-column-table';\n/** @private */\nconst RESOURCE_CHILD_CLASS = 'e-child-node';\n/** @private */\nconst RESOURCE_PARENT_CLASS = 'e-parent-node';\n/** @private */\nconst RESOURCE_EXPAND_CLASS = 'e-resource-expand';\n/** @private */\nconst RESOURCE_COLLAPSE_CLASS = 'e-resource-collapse';\n/** @private */\nconst RESOURCE_TREE_ICON_CLASS = 'e-resource-tree-icon';\n/** @private */\nconst RESOURCE_CELLS_CLASS = 'e-resource-cells';\n/** @private */\nconst TIME_CELLS_WRAP_CLASS = 'e-time-cells-wrap';\n/** @private */\nconst TIME_CELLS_CLASS = 'e-time-cells';\n/** @private */\nconst TIME_SLOT_CLASS = 'e-time-slots';\n/** @private */\nconst ALTERNATE_CELLS_CLASS = 'e-alternate-cells';\n/** @private */\nconst CURRENT_TIME_CLASS = 'e-current-time';\n/** @private */\nconst CURRENT_TIMELINE_CLASS = 'e-current-timeline';\n/** @private */\nconst PREVIOUS_TIMELINE_CLASS = 'e-previous-timeline';\n/** @private */\nconst HIDE_CHILDS_CLASS = 'e-hide-childs';\n/** @private */\nconst SCROLL_CONTAINER_CLASS = 'e-scroll-container';\n/** @private */\n\n/** @private */\nconst TIMELINE_WRAPPER_CLASS = 'e-timeline-wrapper';\n/** @private */\nconst APPOINTMENT_WRAPPER_CLASS = 'e-appointment-wrapper';\n/** @private */\nconst DAY_WRAPPER_CLASS = 'e-day-wrapper';\n/** @private */\nconst TOOLBAR_CONTAINER = 'e-schedule-toolbar-container';\n/** @private */\nconst RESOURCE_TOOLBAR_CONTAINER = 'e-schedule-resource-toolbar-container';\n/** @private */\nconst HEADER_TOOLBAR = 'e-schedule-toolbar';\n/** @private */\nconst RESOURCE_HEADER_TOOLBAR = 'e-schedule-resource-toolbar';\n/** @private */\nconst SELECTED_CELL_CLASS = 'e-selected-cell';\n/** @private */\nconst WEEK_NUMBER_WRAPPER_CLASS = 'e-week-number-wrapper';\n/** @private */\nconst WEEK_NUMBER_CLASS = 'e-week-number';\n/** @private */\nconst APPOINTMENT_WRAP_CLASS = 'e-appointment-wrap';\n/** @private */\nconst WRAPPER_CONTAINER_CLASS = 'e-wrapper-container';\n/** @private */\nconst APPOINTMENT_CONTAINER_CLASS = 'e-appointment-container';\n/** @private */\nconst APPOINTMENT_CLASS = 'e-appointment';\n/** @private */\nconst BLOCK_APPOINTMENT_CLASS = 'e-block-appointment';\n/** @private */\nconst BLOCK_INDICATOR_CLASS = 'e-block-indicator';\n/** @private */\nconst APPOINTMENT_BORDER = 'e-appointment-border';\n/** @private */\nconst APPOINTMENT_DETAILS = 'e-appointment-details';\n/** @private */\nconst SUBJECT_WRAP = 'e-subject-wrap';\n/** @private */\nconst RESOURCE_NAME = 'e-resource-name';\n/** @private */\nconst APPOINTMENT_TIME = 'e-time';\n/** @private */\nconst TABLE_WRAP_CLASS = 'e-table-wrap';\n/** @private */\nconst OUTER_TABLE_CLASS = 'e-outer-table';\n/** @private */\nconst CONTENT_WRAP_CLASS = 'e-content-wrap';\n/** @private */\nconst VIRTUAL_TRACK_CLASS = 'e-virtual-track';\n/** @private */\nconst AGENDA_CELLS_CLASS = 'e-agenda-cells';\n/** @private */\nconst AGENDA_CURRENT_DAY_CLASS = 'e-current-day';\n/** @private */\nconst AGENDA_SELECTED_CELL = 'e-active-appointment-agenda';\n/** @private */\nconst MONTH_HEADER_CLASS = 'e-month-header';\n/** @private */\nconst AGENDA_HEADER_CLASS = 'e-day-date-header';\n/** @private */\nconst AGENDA_RESOURCE_CLASS = 'e-resource-column';\n/** @private */\nconst AGENDA_DATE_CLASS = 'e-date-column';\n/** @private */\nconst NAVIGATE_CLASS = 'e-navigate';\n/** @private */\nconst DATE_HEADER_CLASS = 'e-date-header';\n/** @private */\nconst AGENDA_DAY_BORDER_CLASS = 'e-day-border';\n/** @private */\nconst DATE_BORDER_CLASS = 'e-date-border';\n/** @private */\nconst AGENDA_DAY_PADDING_CLASS = 'e-day-padding';\n/** @private */\nconst DATE_TIME_CLASS = 'e-date-time';\n/** @private */\nconst DATE_TIME_WRAPPER_CLASS = 'e-date-time-wrapper';\n/** @private */\nconst AGENDA_EMPTY_EVENT_CLASS = 'e-empty-event';\n/** @private */\nconst AGENDA_NO_EVENT_CLASS = 'e-no-event';\n/** @private */\nconst APPOINTMENT_INDICATOR_CLASS = 'e-appointment-indicator';\n/** @private */\nconst EVENT_INDICATOR_CLASS = 'e-indicator';\n/** @private */\nconst EVENT_ICON_UP_CLASS = 'e-up-icon';\n/** @private */\nconst EVENT_ICON_DOWN_CLASS = 'e-down-icon';\n/** @private */\nconst EVENT_ICON_LEFT_CLASS = 'e-left-icon';\n/** @private */\nconst EVENT_ICON_RIGHT_CLASS = 'e-right-icon';\n/** @private */\nconst EVENT_ACTION_CLASS = 'e-event-action';\n/** @private */\nconst NEW_EVENT_CLASS = 'e-new-event';\n/** @private */\nconst CLONE_ELEMENT_CLASS = 'e-schedule-event-clone';\n/** @private */\nconst MONTH_CLONE_ELEMENT_CLASS = 'e-month-event';\n/** @private */\nconst CLONE_TIME_INDICATOR_CLASS = 'e-clone-time-indicator';\n/** @private */\nconst DRAG_CLONE_CLASS = 'e-drag-clone';\n/** @private */\nconst EVENT_RESIZE_CLASS = 'e-event-resize';\n/** @private */\nconst RESIZE_CLONE_CLASS = 'e-resize-clone';\n/** @private */\nconst LEFT_RESIZE_HANDLER = 'e-left-handler';\n/** @private */\nconst RIGHT_RESIZE_HANDLER = 'e-right-handler';\n/** @private */\nconst TOP_RESIZE_HANDLER = 'e-top-handler';\n/** @private */\nconst BOTTOM_RESIZE_HANDLER = 'e-bottom-handler';\n/** @private */\nconst EVENT_RECURRENCE_ICON_CLASS = 'e-recurrence-icon';\n/** @private */\nconst EVENT_RECURRENCE_EDIT_ICON_CLASS = 'e-recurrence-edit-icon';\n/** @private */\nconst HEADER_ROW_CLASS = 'e-header-row';\n/** @private */\nconst ALLDAY_APPOINTMENT_WRAPPER_CLASS = 'e-all-day-appointment-wrapper';\n/** @private */\nconst ALLDAY_APPOINTMENT_CLASS = 'e-all-day-appointment';\n/** @private */\nconst EVENT_COUNT_CLASS = 'e-appointment-hide';\n/** @private */\nconst ROW_COUNT_WRAPPER_CLASS = 'e-row-count-wrapper';\n/** @private */\nconst ALLDAY_APPOINTMENT_SECTION_CLASS = 'e-all-day-appointment-section';\n/** @private */\nconst APPOINTMENT_ROW_EXPAND_CLASS = 'e-appointment-expand';\n/** @private */\nconst APPOINTMENT_ROW_COLLAPSE_CLASS = 'e-appointment-collapse';\n/** @private */\nconst MORE_INDICATOR_CLASS = 'e-more-indicator';\n/** @private */\nconst CELL_POPUP_CLASS = 'e-cell-popup';\n/** @private */\nconst EVENT_POPUP_CLASS = 'e-event-popup';\n/** @private */\nconst MULTIPLE_EVENT_POPUP_CLASS = 'e-multiple-event-popup';\n/** @private */\nconst POPUP_HEADER_CLASS = 'e-popup-header';\n/** @private */\nconst POPUP_HEADER_ICON_WRAPPER = 'e-header-icon-wrapper';\n/** @private */\nconst POPUP_CONTENT_CLASS = 'e-popup-content';\n/** @private */\nconst POPUP_FOOTER_CLASS = 'e-popup-footer';\n/** @private */\nconst DATE_TIME_DETAILS_CLASS = 'e-date-time-details';\n/** @private */\nconst RECURRENCE_SUMMARY_CLASS = 'e-recurrence-summary';\n/** @private */\nconst QUICK_POPUP_EVENT_DETAILS_CLASS = 'e-event-details';\n/** @private */\nconst EVENT_CREATE_CLASS = 'e-event-create';\n/** @private */\nconst EDIT_EVENT_CLASS = 'e-event-edit';\n/** @private */\nconst DELETE_EVENT_CLASS = 'e-event-delete';\n/** @private */\nconst TEXT_ELLIPSIS = 'e-text-ellipsis';\n/** @private */\nconst MORE_POPUP_WRAPPER_CLASS = 'e-more-popup-wrapper';\n/** @private */\nconst MORE_EVENT_POPUP_CLASS = 'e-more-event-popup';\n/** @private */\nconst MORE_EVENT_HEADER_CLASS = 'e-more-event-header';\n/** @private */\nconst MORE_EVENT_DATE_HEADER_CLASS = 'e-more-event-date-header';\n/** @private */\nconst MORE_EVENT_HEADER_DAY_CLASS = 'e-header-day';\n/** @private */\nconst MORE_EVENT_HEADER_DATE_CLASS = 'e-header-date';\n/** @private */\nconst MORE_EVENT_CLOSE_CLASS = 'e-more-event-close';\n/** @private */\nconst MORE_EVENT_CONTENT_CLASS = 'e-more-event-content';\n/** @private */\nconst MORE_EVENT_WRAPPER_CLASS = 'e-more-appointment-wrapper';\n/** @private */\nconst QUICK_DIALOG_CLASS = 'e-quick-dialog';\n/** @private */\nconst QUICK_DIALOG_OCCURRENCE_CLASS = 'e-quick-dialog-occurrence-event';\n/** @private */\nconst QUICK_DIALOG_SERIES_CLASS = 'e-quick-dialog-series-event';\n/** @private */\nconst QUICK_DIALOG_FOLLOWING_EVENTS_CLASS = 'e-quick-dialog-following-events';\n/** @private */\nconst FOLLOWING_EVENTS_DIALOG = 'e-following-events-dialog';\n/** @private */\nconst QUICK_DIALOG_DELETE_CLASS = 'e-quick-dialog-delete';\n/** @private */\nconst QUICK_DIALOG_CANCEL_CLASS = 'e-quick-dialog-cancel';\n/** @private */\nconst QUICK_DIALOG_ALERT_OK = 'e-quick-alertok';\n/** @private */\nconst QUICK_DIALOG_ALERT_CANCEL = 'e-quick-alertcancel';\n/** @private */\nconst QUICK_DIALOG_ALERT_FOLLOWING = 'e-quick-alertfollowing';\n/** @private */\nconst QUICK_DIALOG_ALERT_BTN_CLASS = 'e-quick-dialog-alert-btn';\n/** @private */\nconst EVENT_WINDOW_DIALOG_CLASS = 'e-schedule-dialog';\n/** @private */\nconst FORM_CONTAINER_CLASS = 'e-form-container';\n/** @private */\nconst FORM_CLASS = 'e-schedule-form';\n/** @private */\nconst EVENT_WINDOW_ALLDAY_TZ_DIV_CLASS = 'e-all-day-time-zone-row';\n/** @private */\nconst EVENT_WINDOW_ALL_DAY_CLASS = 'e-all-day';\n/** @private */\nconst TIME_ZONE_CLASS = 'e-time-zone';\n/** @private */\nconst TIME_ZONE_ICON_CLASS = 'e-time-zone-icon';\n/** @private */\nconst TIME_ZONE_DETAILS_CLASS = 'e-time-zone-details';\n/** @private */\nconst EVENT_WINDOW_REPEAT_DIV_CLASS = 'e-repeat-parent-row';\n/** @private */\nconst EVENT_WINDOW_REPEAT_CLASS = 'e-repeat';\n/** @private */\nconst EVENT_WINDOW_TITLE_LOCATION_DIV_CLASS = 'e-title-location-row';\n/** @private */\nconst SUBJECT_CLASS = 'e-subject';\n/** @private */\nconst LOCATION_CLASS = 'e-location';\n/** @private */\nconst LOCATION_ICON_CLASS = 'e-location-icon';\n/** @private */\nconst LOCATION_DETAILS_CLASS = 'e-location-details';\n/** @private */\nconst EVENT_WINDOW_START_END_DIV_CLASS = 'e-start-end-row';\n/** @private */\nconst EVENT_WINDOW_START_CLASS = 'e-start';\n/** @private */\nconst EVENT_WINDOW_END_CLASS = 'e-end';\n/** @private */\nconst EVENT_WINDOW_RESOURCES_DIV_CLASS = 'e-resources-row';\n/** @private */\nconst DESCRIPTION_CLASS = 'e-description';\n/** @private */\nconst DESCRIPTION_ICON_CLASS = 'e-description-icon';\n/** @private */\nconst DESCRIPTION_DETAILS_CLASS = 'e-description-details';\n/** @private */\nconst EVENT_WINDOW_TIME_ZONE_DIV_CLASS = 'e-time-zone-row';\n/** @private */\nconst EVENT_WINDOW_START_TZ_CLASS = 'e-start-time-zone';\n/** @private */\nconst EVENT_WINDOW_END_TZ_CLASS = 'e-end-time-zone';\n/** @private */\nconst EVENT_WINDOW_BACK_ICON_CLASS = 'e-back-icon';\n/** @private */\nconst EVENT_WINDOW_SAVE_ICON_CLASS = 'e-save-icon';\n/** @private */\nconst EVENT_WINDOW_CANCEL_BUTTON_CLASS = 'e-event-cancel';\n/** @private */\nconst EVENT_WINDOW_SAVE_BUTTON_CLASS = 'e-event-save';\n/** @private */\nconst EVENT_WINDOW_DIALOG_PARENT_CLASS = 'e-dialog-parent';\n/** @private */\nconst EVENT_WINDOW_TITLE_TEXT_CLASS = 'e-title-text';\n/** @private */\nconst EVENT_WINDOW_ICON_DISABLE_CLASS = 'e-icon-disable';\n/** @private */\nconst EDIT_CLASS = 'e-edit';\n/** @private */\nconst EDIT_ICON_CLASS = 'e-edit-icon';\n/** @private */\nconst DELETE_CLASS = 'e-delete';\n/** @private */\nconst DELETE_ICON_CLASS = 'e-delete-icon';\n/** @private */\nconst CLOSE_CLASS = 'e-close';\n/** @private */\nconst CLOSE_ICON_CLASS = 'e-close-icon';\n/** @private */\nconst ERROR_VALIDATION_CLASS = 'e-schedule-error';\n/** @private */\nconst EVENT_TOOLTIP_ROOT_CLASS = 'e-schedule-event-tooltip';\n/** @private */\nconst ALLDAY_ROW_ANIMATE_CLASS = 'e-animate';\n/** @private */\nconst TIMESCALE_DISABLE = 'e-timescale-disable';\n/** @private */\nconst DISABLE_DATE = 'e-disable-date';\n/** @private */\nconst HIDDEN_CLASS = 'e-hidden';\n/** @private */\nconst DISABLE_DATES = 'e-disable-dates';\n/** @private */\nconst POPUP_WRAPPER_CLASS = 'e-quick-popup-wrapper';\n/** @private */\nconst POPUP_TABLE_CLASS = 'e-popup-table';\n/** @private */\nconst RESOURCE_MENU = 'e-resource-menu';\n/** @private */\nconst RESOURCE_MENU_ICON = 'e-icon-menu';\n/** @private */\nconst RESOURCE_LEVEL_TITLE = 'e-resource-level-title';\n/** @private */\nconst RESOURCE_TREE = 'e-resource-tree';\n/** @private */\nconst RESOURCE_TREE_POPUP_OVERLAY = 'e-resource-tree-popup-overlay';\n/** @private */\nconst RESOURCE_TREE_POPUP = 'e-resource-tree-popup';\n/** @private */\nconst RESOURCE_CLASS = 'e-resource';\n/** @private */\nconst RESOURCE_ICON_CLASS = 'e-resource-icon';\n/** @private */\nconst RESOURCE_DETAILS_CLASS = 'e-resource-details';\n/** @private */\nconst DATE_TIME_ICON_CLASS = 'e-date-time-icon';\n/** @private */\nconst VIRTUAL_SCROLL_CLASS = 'e-virtual-scroll';\n/** @private */\nconst ICON_DISABLE_CLASS = 'e-icon-disable';\n/** @private */\nconst AUTO_HEIGHT = 'e-auto-height';\n/** @private */\nconst IGNORE_WHITESPACE = 'e-ignore-whitespace';\n/** @private */\nconst EVENT_TEMPLATE = 'e-template';\n/** @private */\nconst READ_ONLY = 'e-read-only';\n/** @private */\nconst MONTH_HEADER_WRAPPER = 'e-month-header-wrapper';\n/** @private */\nconst INLINE_SUBJECT_CLASS = 'e-inline-subject';\n/** @private */\nconst INLINE_APPOINTMENT_CLASS = 'e-inline-appointment';\n/** @hidden */\nconst SCROLL_HIDDEN = 'e-scroll-hidden';\n/** @private */\nconst ALLDAY_APPOINTMENT_SCROLL = 'e-all-day-scroll';\n/** @private */\nconst ALLDAY_APPOINTMENT_AUTO = 'e-all-day-auto';\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\n/**\n * Header module\n */\nclass HeaderRenderer {\n    constructor(parent) {\n        this.parent = parent;\n        this.l10n = this.parent.localeObj;\n        this.renderHeader();\n        this.addEventListener();\n    }\n    addEventListener() {\n        this.parent.on(documentClick, this.closeHeaderPopup, this);\n    }\n    removeEventListener() {\n        this.parent.off(documentClick, this.closeHeaderPopup);\n    }\n    closeHeaderPopup(e) {\n        const closestEle = closest(e.event.target, '.e-date-range,.e-header-popup,.e-day,.e-selected');\n        const closestPop = closest(e.event.target, '.e-hor-nav,.e-toolbar-pop');\n        const contentWrap = this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS);\n        if (this.parent.isAdaptive) {\n            if (!isNullOrUndefined(closestPop) && (closestPop.classList.contains('e-toolbar-pop') ||\n                closestPop.classList.contains('e-hor-nav')) && !(closestPop.classList.contains('e-hor-nav') &&\n                this.element.querySelector('.e-toolbar-pop').classList.contains(POPUP_OPEN))) {\n                addClass([contentWrap], SCROLL_HIDDEN);\n            }\n            else {\n                removeClass([contentWrap], SCROLL_HIDDEN);\n                const popupEle = this.element.querySelector('.e-toolbar-pop');\n                if (!isNullOrUndefined(popupEle)) {\n                    const popupObj = popupEle.ej2_instances[0];\n                    if (popupObj && !(!isNullOrUndefined(closestPop) && closestPop.classList.contains('e-hor-nav') &&\n                        popupEle.classList.contains(POPUP_OPEN))) {\n                        popupObj.hide();\n                    }\n                }\n            }\n        }\n        if (!isNullOrUndefined(closestEle)) {\n            return;\n        }\n        this.hideHeaderPopup();\n    }\n    hideHeaderPopup() {\n        if (this.headerPopup) {\n            this.headerPopup.hide();\n        }\n    }\n    renderHeader() {\n        this.element = createElement('div', { className: TOOLBAR_CONTAINER });\n        const toolbarEle = createElement('div', { className: HEADER_TOOLBAR });\n        this.element.appendChild(toolbarEle);\n        this.parent.element.insertBefore(this.element, this.parent.element.firstElementChild);\n        this.renderToolbar();\n    }\n    renderToolbar() {\n        const items = this.getItems();\n        this.parent.trigger(actionBegin, { requestType: 'toolbarItemRendering', items: items }, (args) => {\n            this.toolbarObj = new Toolbar({\n                items: args.items,\n                overflowMode: 'Popup',\n                clicked: this.toolbarClickHandler.bind(this),\n                enableRtl: this.parent.enableRtl,\n                locale: this.parent.locale\n            });\n            this.toolbarObj.appendTo(this.parent.element.querySelector('.' + HEADER_TOOLBAR));\n            const prevNavEle = this.toolbarObj.element.querySelector('.e-prev');\n            if (prevNavEle) {\n                prevNavEle.firstElementChild.setAttribute('title', this.l10n.getConstant('previous'));\n            }\n            const nextNavEle = this.toolbarObj.element.querySelector('.e-next');\n            if (nextNavEle) {\n                nextNavEle.firstElementChild.setAttribute('title', this.l10n.getConstant('next'));\n            }\n            this.updateAddIcon();\n            this.updateActiveView();\n            this.parent.trigger(actionComplete, { requestType: 'toolBarItemRendered', items: this.toolbarObj.items });\n        });\n    }\n    updateItems() {\n        if (this.toolbarObj) {\n            const items = this.getItems();\n            this.parent.trigger(actionBegin, { requestType: 'toolbarItemRendering', items: items }, (args) => {\n                this.toolbarObj.items = args.items;\n                this.toolbarObj.dataBind();\n                this.parent.trigger(actionComplete, { requestType: 'toolBarItemRendered', items: this.toolbarObj.items });\n            });\n        }\n    }\n    getPopUpRelativeElement() {\n        if (this.parent.isAdaptive) {\n            return this.toolbarObj.element;\n        }\n        return this.element.querySelector('.e-date-range');\n    }\n    setDayOfWeek(index) {\n        if (this.headerCalendar) {\n            this.headerCalendar.firstDayOfWeek = index;\n            this.headerCalendar.dataBind();\n        }\n    }\n    setCalendarDate(date) {\n        if (this.headerCalendar) {\n            this.headerCalendar.value = date;\n            this.headerCalendar.dataBind();\n        }\n    }\n    setCalendarMinMaxDate() {\n        if (this.headerCalendar) {\n            this.headerCalendar.min = this.parent.minDate;\n            this.headerCalendar.max = this.parent.maxDate;\n            this.headerCalendar.dataBind();\n        }\n    }\n    getCalendarView() {\n        if (['Month', 'MonthAgenda', 'TimelineMonth'].indexOf(this.parent.currentView) > -1) {\n            return 'Year';\n        }\n        else if (['Year', 'TimelineYear'].indexOf(this.parent.currentView) > -1) {\n            return 'Decade';\n        }\n        else {\n            return 'Month';\n        }\n    }\n    setCalendarView() {\n        if (this.headerCalendar) {\n            const calendarView = this.getCalendarView();\n            this.headerCalendar.depth = calendarView;\n            this.headerCalendar.start = calendarView;\n            this.headerCalendar.refresh();\n        }\n    }\n    updateActiveView() {\n        const selEle = [].slice.call(this.toolbarObj.element.querySelectorAll('.e-views'));\n        removeClass(selEle, ['e-active-view']);\n        if (selEle.length > 0 && selEle[this.parent.viewIndex]) {\n            addClass([selEle[this.parent.viewIndex]], ['e-active-view']);\n        }\n    }\n    updateDateRange(text) {\n        const selEle = this.toolbarObj.element.querySelector('.e-date-range');\n        if (selEle) {\n            selEle.setAttribute('aria-label', text);\n            selEle.querySelector('.e-tbar-btn-text').innerHTML = text;\n            this.refresh();\n        }\n    }\n    refresh() {\n        if (this.toolbarObj) {\n            this.toolbarObj.refreshOverflow();\n        }\n    }\n    updateAddIcon() {\n        const addEle = this.toolbarObj.element.querySelector('.e-add');\n        if (addEle) {\n            if (!this.parent.eventSettings.allowAdding) {\n                addClass([addEle], HIDDEN_CLASS);\n            }\n            else {\n                removeClass([addEle], HIDDEN_CLASS);\n            }\n        }\n    }\n    getDateRangeText() {\n        const dateString = this.parent.globalize.formatDate(this.parent.selectedDate, {\n            format: 'MMMM y', calendar: this.parent.getCalendarMode()\n        });\n        return capitalizeFirstWord(dateString, 'single');\n    }\n    getItems() {\n        const items = [];\n        items.push({\n            align: 'Left', prefixIcon: 'e-icon-prev', tooltipText: 'Previous', overflow: 'Show',\n            cssClass: 'e-prev', htmlAttributes: { 'aria-label': 'previous period', 'role': 'navigation' }\n        });\n        items.push({\n            align: 'Left', prefixIcon: 'e-icon-next', tooltipText: 'Next', overflow: 'Show',\n            cssClass: 'e-next', htmlAttributes: { 'aria-label': 'next period', 'role': 'navigation' }\n        });\n        items.push({\n            align: 'Left', text: this.getDateRangeText(), suffixIcon: 'e-icon-down-arrow', cssClass: 'e-date-range',\n            overflow: 'Show',\n            htmlAttributes: { 'aria-atomic': 'true', 'aria-live': 'assertive', 'aria-label': 'title', 'role': 'navigation' }\n        });\n        if (this.parent.isAdaptive || this.parent.enableAdaptiveUI) {\n            items.push({\n                align: 'Right', showAlwaysInPopup: (this.parent.isAdaptive || this.parent.enableAdaptiveUI), prefixIcon: 'e-icon-add',\n                text: this.l10n.getConstant('newEvent'), cssClass: 'e-add', overflow: 'Show'\n            });\n            items.push({\n                align: 'Right', showAlwaysInPopup: (this.parent.isAdaptive || this.parent.enableAdaptiveUI), prefixIcon: 'e-icon-today',\n                text: this.l10n.getConstant('today'), cssClass: 'e-today', overflow: 'Show'\n            });\n        }\n        else {\n            items.push({\n                align: 'Right', showAlwaysInPopup: (this.parent.isAdaptive || this.parent.enableAdaptiveUI), prefixIcon: 'e-icon-day',\n                text: this.l10n.getConstant('today'), cssClass: 'e-today', overflow: 'Show'\n            });\n            if (this.parent.views.length > 1) {\n                items.push({ align: 'Right', type: 'Separator', cssClass: 'e-schedule-seperator' });\n            }\n        }\n        if (this.parent.views.length > 1) {\n            for (const item of this.parent.views) {\n                items.push(this.getItemObject(item));\n            }\n        }\n        return items;\n    }\n    getItemObject(item) {\n        let viewName;\n        let displayName;\n        if (typeof (item) === 'string') {\n            viewName = item.toLowerCase();\n            displayName = null;\n        }\n        else {\n            viewName = item.option.toLowerCase();\n            displayName = item.displayName;\n        }\n        let view;\n        let orientationClass;\n        const isItemInsidePopup = this.parent.isAdaptive || this.parent.enableAdaptiveUI;\n        switch (viewName) {\n            case 'day':\n                view = {\n                    align: 'Right', showAlwaysInPopup: isItemInsidePopup, prefixIcon: 'e-icon-day',\n                    text: displayName || this.l10n.getConstant('day'), cssClass: 'e-views e-day'\n                };\n                break;\n            case 'week':\n                view = {\n                    align: 'Right', showAlwaysInPopup: isItemInsidePopup, prefixIcon: 'e-icon-week',\n                    text: displayName || this.l10n.getConstant('week'), cssClass: 'e-views e-week'\n                };\n                break;\n            case 'workweek':\n                view = {\n                    align: 'Right', showAlwaysInPopup: isItemInsidePopup, prefixIcon: 'e-icon-workweek',\n                    text: displayName || this.l10n.getConstant('workWeek'), cssClass: 'e-views e-work-week'\n                };\n                break;\n            case 'month':\n                view = {\n                    align: 'Right', showAlwaysInPopup: isItemInsidePopup, prefixIcon: 'e-icon-month',\n                    text: displayName || this.l10n.getConstant('month'), cssClass: 'e-views e-month'\n                };\n                break;\n            case 'year':\n                view = {\n                    align: 'Right', showAlwaysInPopup: isItemInsidePopup, prefixIcon: 'e-icon-year',\n                    text: displayName || this.l10n.getConstant('year'), cssClass: 'e-views e-year'\n                };\n                break;\n            case 'agenda':\n                view = {\n                    align: 'Right', showAlwaysInPopup: isItemInsidePopup, prefixIcon: 'e-icon-agenda',\n                    text: displayName || this.l10n.getConstant('agenda'), cssClass: 'e-views e-agenda'\n                };\n                break;\n            case 'monthagenda':\n                view = {\n                    align: 'Right', showAlwaysInPopup: isItemInsidePopup, prefixIcon: 'e-icon-month-agenda',\n                    text: displayName || this.l10n.getConstant('monthAgenda'), cssClass: 'e-views e-month-agenda'\n                };\n                break;\n            case 'timelineday':\n                view = {\n                    align: 'Right', showAlwaysInPopup: isItemInsidePopup, prefixIcon: 'e-icon-timeline-day',\n                    text: displayName || this.l10n.getConstant('timelineDay'), cssClass: 'e-views e-timeline-day'\n                };\n                break;\n            case 'timelineweek':\n                view = {\n                    align: 'Right', showAlwaysInPopup: isItemInsidePopup, prefixIcon: 'e-icon-timeline-week',\n                    text: displayName || this.l10n.getConstant('timelineWeek'), cssClass: 'e-views e-timeline-week'\n                };\n                break;\n            case 'timelineworkweek':\n                view = {\n                    align: 'Right', showAlwaysInPopup: isItemInsidePopup, prefixIcon: 'e-icon-timeline-workweek',\n                    text: displayName || this.l10n.getConstant('timelineWorkWeek'), cssClass: 'e-views e-timeline-work-week'\n                };\n                break;\n            case 'timelinemonth':\n                view = {\n                    align: 'Right', showAlwaysInPopup: isItemInsidePopup, prefixIcon: 'e-icon-timeline-month',\n                    text: displayName || this.l10n.getConstant('timelineMonth'), cssClass: 'e-views e-timeline-month'\n                };\n                break;\n            case 'timelineyear':\n                orientationClass = (item.orientation === 'Vertical') ? 'vertical' : 'horizontal';\n                view = {\n                    align: 'Right', showAlwaysInPopup: isItemInsidePopup, prefixIcon: 'e-icon-timeline-year-' + orientationClass,\n                    text: displayName || this.l10n.getConstant('timelineYear'), cssClass: 'e-views e-timeline-year'\n                };\n                break;\n        }\n        return view;\n    }\n    renderHeaderPopup() {\n        const headerPopupEle = createElement('div', { className: HEADER_POPUP_CLASS });\n        const headerCalendarEle = createElement('div', { className: HEADER_CALENDAR_CLASS });\n        headerPopupEle.appendChild(headerCalendarEle);\n        this.element.appendChild(headerPopupEle);\n        this.headerPopup = new Popup(headerPopupEle, {\n            actionOnScroll: 'hide',\n            targetType: 'relative',\n            relateTo: this.getPopUpRelativeElement(),\n            position: { X: 'left', Y: 'bottom' },\n            enableRtl: this.parent.enableRtl\n        });\n        const calendarView = this.getCalendarView();\n        const isDisplayDate = this.parent.currentView === 'Month' &&\n            !isNullOrUndefined(this.parent.activeViewOptions.displayDate) && !this.hasSelectedDate();\n        this.headerCalendar = new Calendar({\n            value: isDisplayDate ? this.parent.activeViewOptions.displayDate : this.parent.selectedDate,\n            min: this.parent.minDate,\n            max: this.parent.maxDate,\n            firstDayOfWeek: this.parent.activeViewOptions.firstDayOfWeek,\n            enableRtl: this.parent.enableRtl,\n            locale: this.parent.locale,\n            depth: calendarView,\n            start: calendarView,\n            calendarMode: this.parent.calendarMode,\n            change: this.calendarChange.bind(this)\n        });\n        this.setCalendarTimezone();\n        this.headerCalendar.appendTo(headerCalendarEle);\n        this.headerPopup.hide();\n    }\n    calendarChange(args) {\n        if (args.value.getTime() !== this.parent.selectedDate.getTime()) {\n            const calendarDate = resetTime(new Date(args.value));\n            this.parent.changeDate(calendarDate);\n        }\n        this.headerPopup.hide();\n    }\n    setCalendarTimezone() {\n        if (this.headerCalendar) {\n            this.headerCalendar.timezone = this.parent.timezone || this.parent.tzModule.getLocalTimezoneName();\n        }\n    }\n    calculateViewIndex(args) {\n        const target = closest(args.originalEvent.target, '.e-views');\n        const views = [].slice.call(this.element.querySelectorAll('.e-views'));\n        return views.indexOf(target);\n    }\n    toolbarClickHandler(args) {\n        if (!args.item) {\n            return;\n        }\n        const strClass = args.item.cssClass.replace('e-views ', '');\n        let data;\n        let isSameTime;\n        let currentTime;\n        switch (strClass) {\n            case 'e-date-range':\n                if (!this.headerPopup) {\n                    this.renderHeaderPopup();\n                }\n                if (this.headerPopup.element.classList.contains(POPUP_OPEN)) {\n                    this.headerPopup.hide();\n                }\n                else {\n                    this.headerPopup.show();\n                }\n                break;\n            case 'e-day':\n                this.parent.changeView('Day', args.originalEvent, undefined, this.calculateViewIndex(args));\n                break;\n            case 'e-week':\n                this.parent.changeView('Week', args.originalEvent, undefined, this.calculateViewIndex(args));\n                break;\n            case 'e-work-week':\n                this.parent.changeView('WorkWeek', args.originalEvent, undefined, this.calculateViewIndex(args));\n                break;\n            case 'e-month':\n                this.parent.changeView('Month', args.originalEvent, undefined, this.calculateViewIndex(args));\n                break;\n            case 'e-year':\n                this.parent.changeView('Year', args.originalEvent, undefined, this.calculateViewIndex(args));\n                break;\n            case 'e-agenda':\n                this.parent.changeView('Agenda', args.originalEvent, undefined, this.calculateViewIndex(args));\n                break;\n            case 'e-month-agenda':\n                this.parent.changeView('MonthAgenda', args.originalEvent, undefined, this.calculateViewIndex(args));\n                break;\n            case 'e-timeline-day':\n                this.parent.changeView('TimelineDay', args.originalEvent, undefined, this.calculateViewIndex(args));\n                break;\n            case 'e-timeline-week':\n                this.parent.changeView('TimelineWeek', args.originalEvent, undefined, this.calculateViewIndex(args));\n                break;\n            case 'e-timeline-work-week':\n                this.parent.changeView('TimelineWorkWeek', args.originalEvent, undefined, this.calculateViewIndex(args));\n                break;\n            case 'e-timeline-month':\n                this.parent.changeView('TimelineMonth', args.originalEvent, undefined, this.calculateViewIndex(args));\n                break;\n            case 'e-timeline-year':\n                this.parent.changeView('TimelineYear', args.originalEvent, undefined, this.calculateViewIndex(args));\n                break;\n            case 'e-today':\n                currentTime = resetTime(this.parent.getCurrentTime());\n                if (this.parent.currentView === 'Agenda' || this.parent.currentView === 'MonthAgenda' || !this.parent.isSelectedDate(currentTime) ||\n                    this.parent.currentView === 'Month' && this.parent.activeViewOptions.displayDate && !this.hasSelectedDate() &&\n                        resetTime(this.parent.activeViewOptions.displayDate) !== currentTime || this.parent.currentView === 'Month' &&\n                    this.parent.activeViewOptions.numberOfWeeks > 0 && !this.hasSelectedDate()\n                    && resetTime(firstDateOfMonth(this.parent.selectedDate)) !== currentTime) {\n                    this.parent.changeDate(currentTime, args.originalEvent);\n                }\n                break;\n            case 'e-prev':\n                this.parent.changeDate(this.parent.activeView.getNextPreviousDate('previous'), args.originalEvent);\n                break;\n            case 'e-next':\n                this.parent.changeDate(this.parent.activeView.getNextPreviousDate('next'), args.originalEvent);\n                break;\n            case 'e-add':\n                isSameTime = this.parent.activeCellsData.startTime.getTime() === this.parent.activeCellsData.endTime.getTime();\n                if (this.parent.activeCellsData && !isSameTime) {\n                    data = this.parent.activeCellsData;\n                }\n                else {\n                    const interval = this.parent.activeViewOptions.timeScale.interval;\n                    const slotCount = this.parent.activeViewOptions.timeScale.slotCount;\n                    const msInterval = (interval * MS_PER_MINUTE) / slotCount;\n                    const startTime = new Date(this.parent.selectedDate.getTime());\n                    const currentTime = this.parent.getCurrentTime();\n                    startTime.setHours(currentTime.getHours(), (Math.round(startTime.getMinutes() / msInterval) * msInterval), 0);\n                    const endTime = new Date(new Date(startTime.getTime()).setMilliseconds(startTime.getMilliseconds() + msInterval));\n                    data = { startTime: startTime, endTime: endTime, isAllDay: false };\n                }\n                this.parent.eventWindow.openEditor(extend(data, { cancel: false, event: args.originalEvent }), 'Add');\n                break;\n        }\n        if (isNullOrUndefined(this.toolbarObj)) {\n            return;\n        }\n        const toolbarPopUp = this.toolbarObj.element.querySelector('.e-toolbar-pop');\n        if (toolbarPopUp && args.item.type !== 'Input') {\n            toolbarPopUp.ej2_instances[0].hide({ name: 'SlideUp', duration: 100 });\n        }\n    }\n    hasSelectedDate() {\n        const selectedTime = resetTime(this.parent.selectedDate).getTime();\n        return selectedTime >= this.parent.activeView.getStartDate().getTime() &&\n            selectedTime <= this.parent.activeView.getEndDate().getTime();\n    }\n    getHeaderElement() {\n        return this.toolbarObj.element;\n    }\n    updateHeaderItems(classType) {\n        const prevNavEle = this.toolbarObj.element.querySelector('.e-prev');\n        const nextNavEle = this.toolbarObj.element.querySelector('.e-next');\n        const dateRangeEle = this.toolbarObj.element.querySelector('.e-date-range');\n        if (prevNavEle) {\n            if (classType === 'add') {\n                addClass([prevNavEle], HIDDEN_CLASS);\n            }\n            else {\n                removeClass([prevNavEle], HIDDEN_CLASS);\n            }\n        }\n        if (nextNavEle) {\n            if (classType === 'add') {\n                addClass([nextNavEle], HIDDEN_CLASS);\n            }\n            else {\n                removeClass([nextNavEle], HIDDEN_CLASS);\n            }\n        }\n        if (dateRangeEle) {\n            if (classType === 'add') {\n                addClass([dateRangeEle], TEXT_ELLIPSIS);\n            }\n            else {\n                removeClass([dateRangeEle], TEXT_ELLIPSIS);\n            }\n        }\n    }\n    previousNextIconHandler() {\n        const dates = (this.parent.currentView === 'Agenda' ?\n            [this.parent.getCurrentViewDates()[0]] : this.parent.getCurrentViewDates());\n        const prevNavEle = this.toolbarObj.element.querySelector('.' + PREVIOUS_DATE_CLASS);\n        const nextNavEle = this.toolbarObj.element.querySelector('.' + NEXT_DATE_CLASS);\n        let firstDate = new Date(dates[0].getTime());\n        let lastDate = new Date(dates[dates.length - 1].getTime());\n        if (this.parent.currentView === 'WorkWeek' || this.parent.currentView === 'TimelineWorkWeek') {\n            firstDate = getWeekFirstDate(resetTime(this.parent.selectedDate), this.parent.firstDayOfWeek);\n            lastDate = addDays(firstDate, 7 * this.parent.activeViewOptions.interval);\n        }\n        if (this.parent.currentView === 'Month') {\n            const isCustomMonth = !isNullOrUndefined(this.parent.activeViewOptions.displayDate) ||\n                this.parent.activeViewOptions.numberOfWeeks > 0;\n            firstDate = isCustomMonth ? this.parent.activeView.getStartDate() : firstDateOfMonth(this.parent.selectedDate);\n            lastDate = isCustomMonth ? this.parent.activeView.getEndDate() :\n                lastDateOfMonth(addMonths(firstDate, this.parent.activeViewOptions.interval - 1));\n        }\n        if (!isNullOrUndefined(prevNavEle)) {\n            this.toolbarObj.enableItems(prevNavEle, firstDate > this.parent.minDate);\n        }\n        if (!isNullOrUndefined(nextNavEle)) {\n            this.toolbarObj.enableItems(nextNavEle, lastDate < this.parent.maxDate);\n        }\n        this.setCalendarMinMaxDate();\n    }\n    getModuleName() {\n        return 'headerbar';\n    }\n    destroy() {\n        if (this.headerPopup && !this.headerPopup.isDestroyed) {\n            this.headerPopup.destroy();\n            this.headerPopup = null;\n        }\n        if (this.headerCalendar && !this.headerCalendar.isDestroyed) {\n            this.headerCalendar.destroy();\n            this.headerCalendar = null;\n        }\n        if (this.toolbarObj && !this.toolbarObj.isDestroyed) {\n            this.toolbarObj.destroy();\n            this.removeEventListener();\n            remove(this.element);\n            this.toolbarObj = null;\n        }\n        this.element = null;\n        this.parent = null;\n        this.l10n = null;\n    }\n}\n\n/**\n * `Scroll` module\n */\nclass Scroll {\n    /**\n     * Constructor for the scrolling.\n     *\n     * @param {Schedule} parent Accepts the Schedule instance\n     */\n    constructor(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    /**\n     * For internal use only - Get the module name.\n     *\n     * @returns {string} Returns the module name.\n     * @private\n     */\n    getModuleName() {\n        return 'scroll';\n    }\n    /**\n     * Internal method to set the element width\n     *\n     * @returns {void}\n     * @private\n     */\n    setWidth() {\n        this.parent.element.style.width = formatUnit(this.parent.width);\n    }\n    /**\n     * Internal method to set the element height\n     *\n     * @returns {void}\n     * @private\n     */\n    setHeight() {\n        this.parent.element.style.height = formatUnit(this.parent.height);\n    }\n    /**\n     * Internal method to bind events\n     *\n     * @returns {void}\n     * @private\n     */\n    addEventListener() {\n        this.parent.on(contentReady, this.setDimensions, this);\n        this.parent.on(uiUpdate, this.onPropertyChanged, this);\n    }\n    /**\n     * Internal method to unbind events\n     *\n     * @returns {void}\n     * @private\n     */\n    removeEventListener() {\n        this.parent.off(contentReady, this.setDimensions);\n        this.parent.off(uiUpdate, this.onPropertyChanged);\n    }\n    /**\n     * Internal method to set the dimensions\n     *\n     * @returns {void}\n     * @private\n     */\n    setDimensions() {\n        this.setWidth();\n        this.setHeight();\n        const data = { cssProperties: this.parent.getCssProperties(), module: this.getModuleName() };\n        this.parent.notify(scrollUiUpdate, data);\n    }\n    /**\n     * Internal method to set the dimensions dynamically\n     *\n     * @returns {void}\n     * @private\n     */\n    onPropertyChanged() {\n        this.setDimensions();\n    }\n    /**\n     * Destroy the scroll module\n     *\n     * @returns {void}\n     * @private\n     */\n    destroy() {\n        this.removeEventListener();\n    }\n}\n\n/**\n * `touch` module is used to handle touch interactions.\n */\nclass ScheduleTouch {\n    constructor(parent) {\n        this.parent = parent;\n        this.element = this.parent.element.querySelector('.' + TABLE_CONTAINER_CLASS);\n        this.touchObj = new Touch(this.element, {\n            scroll: this.scrollHandler.bind(this),\n            swipe: this.swipeHandler.bind(this),\n            tapHold: this.tapHoldHandler.bind(this),\n            swipeSettings: { swipeThresholdDistance: 1 }\n        });\n        EventHandler.add(this.element, 'transitionend', this.onTransitionEnd, this);\n        this.touchLeftDirection = this.parent.enableRtl ? 'Right' : 'Left';\n        this.touchRightDirection = this.parent.enableRtl ? 'Left' : 'Right';\n    }\n    scrollHandler(e) {\n        if (this.parent.currentView === 'Agenda' || this.parent.uiStateValues.action ||\n            (e.originalEvent && (e.originalEvent.target.classList.contains(APPOINTMENT_CLASS) ||\n                closest(e.originalEvent.target, '.' + APPOINTMENT_CLASS)))) {\n            return;\n        }\n        if (!this.timeStampStart) {\n            this.timeStampStart = Date.now();\n        }\n        if (this.element.classList.contains(TRANSLATE_CLASS)) {\n            this.onTransitionEnd();\n        }\n        if (e.scrollDirection === 'Left' || e.scrollDirection === 'Right') {\n            const args = { requestType: 'dateNavigate', cancel: false, event: e.originalEvent };\n            this.parent.trigger(actionBegin, args);\n            if (args.cancel) {\n                return;\n            }\n            const scrollDiv = this.element.querySelector('.' + CONTENT_WRAP_CLASS);\n            if (scrollDiv && scrollDiv.scrollWidth > scrollDiv.clientWidth) {\n                return;\n            }\n            else {\n                this.isScrollTriggered = true;\n                e.originalEvent.preventDefault();\n                e.originalEvent.stopPropagation();\n            }\n        }\n        if (e.scrollDirection === this.touchLeftDirection) {\n            if (!this.nextPanel) {\n                this.renderPanel(NEXT_PANEL_CLASS, 'next');\n                this.nextPanel = {\n                    element: this.parent.activeView.getPanel(),\n                    selectedDate: new Date(this.parent.selectedDate.getTime())\n                };\n                this.setDimensions(this.nextPanel.element);\n            }\n            const x = this.parent.enableRtl ? e.distanceX : -e.distanceX;\n            this.element.style.transform = 'translatex(' + (this.getTranslateX(this.element) + x) + 'px)';\n        }\n        else if (e.scrollDirection === this.touchRightDirection) {\n            let prevWidth = 0;\n            if (!this.previousPanel) {\n                this.renderPanel(PREVIOUS_PANEL_CLASS, 'previous');\n                this.previousPanel = {\n                    element: this.parent.activeView.getPanel(),\n                    selectedDate: new Date(this.parent.selectedDate.getTime())\n                };\n                this.setDimensions(this.previousPanel.element);\n                prevWidth = this.previousPanel.element.offsetWidth;\n            }\n            const x = this.parent.enableRtl ? prevWidth - e.distanceX : -prevWidth + e.distanceX;\n            this.element.style.transform = 'translatex(' + (this.getTranslateX(this.element) + x) + 'px)';\n        }\n    }\n    swipeHandler(e) {\n        if (!this.isScrollTriggered || this.parent.uiStateValues.action) {\n            return;\n        }\n        this.isScrollTriggered = false;\n        const swipeDate = e.swipeDirection === 'Left' ?\n            this.parent.activeView.renderDates[0] : this.parent.activeView.renderDates.slice(-1)[0];\n        if ((e.swipeDirection === 'Left' && swipeDate < this.parent.maxDate) ||\n            (e.swipeDirection === 'Right' && swipeDate >= this.parent.minDate)) {\n            const time = Date.now() - this.timeStampStart;\n            const offsetDist = (e.distanceX * (Browser.isDevice ? 6 : 1.66));\n            if (offsetDist > time || (e.distanceX > (this.parent.element.offsetWidth / 2))) {\n                this.swapPanels(e.swipeDirection);\n                if (offsetDist > time && (e.distanceX > (this.parent.element.offsetWidth / 2))) {\n                    this.element.style.transitionDuration = ((offsetDist / time) / 10) + 's';\n                }\n                this.confirmSwipe(e.swipeDirection);\n            }\n            else {\n                this.cancelSwipe();\n            }\n            const args = { requestType: 'dateNavigate', cancel: false, event: e.originalEvent };\n            this.parent.trigger(actionComplete, args);\n        }\n        else {\n            this.cancelSwipe();\n        }\n        this.timeStampStart = null;\n    }\n    tapHoldHandler(e) {\n        const target = closest(e.originalEvent.target, '.' + APPOINTMENT_CLASS);\n        if (!isNullOrUndefined(target) && this.parent.isAdaptive) {\n            this.parent.quickPopup.tapHoldEventPopup(e.originalEvent);\n            return;\n        }\n    }\n    renderPanel(clsName, nextPrevType) {\n        if (!this.currentPanel) {\n            this.currentPanel = {\n                element: this.parent.activeView.getPanel(),\n                selectedDate: new Date(this.parent.selectedDate.getTime())\n            };\n            this.setDimensions(this.currentPanel.element);\n        }\n        else {\n            this.parent.setProperties({ selectedDate: this.currentPanel.selectedDate }, true);\n        }\n        this.parent.setProperties({ selectedDate: this.parent.activeView.getNextPreviousDate(nextPrevType) }, true);\n        if (this.parent.headerModule) {\n            this.parent.headerModule.setCalendarDate(this.parent.selectedDate);\n        }\n        this.parent.activeView.getRenderDates();\n        this.parent.activeView.renderLayout(clsName);\n    }\n    swapPanels(direction) {\n        if (direction === this.touchLeftDirection) {\n            const temp = this.nextPanel;\n            this.nextPanel = this.currentPanel;\n            this.currentPanel = temp;\n        }\n        else {\n            const temp = this.previousPanel;\n            this.previousPanel = this.currentPanel;\n            this.currentPanel = temp;\n        }\n    }\n    confirmSwipe(swipeDirection) {\n        const previousDate = swipeDirection === this.touchLeftDirection ?\n            this.nextPanel.selectedDate : this.previousPanel.selectedDate;\n        const args = {\n            action: 'date', cancel: false, previousDate: previousDate, currentDate: this.currentPanel.selectedDate\n        };\n        this.parent.trigger(navigating, args, (navArgs) => {\n            if (navArgs.cancel) {\n                this.swapPanels(swipeDirection);\n                this.cancelSwipe();\n            }\n            else {\n                this.parent.activeView.setPanel(this.currentPanel.element);\n                this.parent.setProperties({ selectedDate: this.currentPanel.selectedDate }, true);\n                let translateX;\n                if (this.parent.enableRtl) {\n                    translateX = swipeDirection === this.touchLeftDirection ?\n                        (this.previousPanel ? this.previousPanel.element.offsetLeft : this.currentPanel.element.offsetWidth) : 0;\n                }\n                else {\n                    translateX = swipeDirection === this.touchLeftDirection ? -this.currentPanel.element.offsetLeft : 0;\n                }\n                addClass([this.element], TRANSLATE_CLASS);\n                this.element.style.transform = 'translatex(' + translateX + 'px)';\n                if (this.parent.headerModule) {\n                    this.parent.headerModule.updateDateRange(this.parent.activeView.getDateRangeText());\n                }\n                this.parent.renderTemplates();\n                this.parent.crudModule.refreshDataManager();\n            }\n        });\n    }\n    cancelSwipe() {\n        this.parent.activeView.setPanel(this.currentPanel.element);\n        this.parent.setProperties({ selectedDate: this.currentPanel.selectedDate }, true);\n        this.parent.activeView.getRenderDates();\n        this.parent.activeView.generateColumnLevels();\n        addClass([this.element], TRANSLATE_CLASS);\n        const prevWidth = this.previousPanel ? this.previousPanel.element.offsetWidth : 0;\n        this.element.style.transform = 'translatex(' + (this.parent.enableRtl ? prevWidth : -this.currentPanel.element.offsetLeft) + 'px)';\n    }\n    onTransitionEnd() {\n        removeClass([this.element], TRANSLATE_CLASS);\n        this.element.style.transitionDuration = '';\n        this.element.style.transform = '';\n        if (this.previousPanel) {\n            remove(this.previousPanel.element);\n            this.previousPanel = null;\n            removeClass([this.currentPanel.element], PREVIOUS_PANEL_CLASS);\n            addClass([this.currentPanel.element], CURRENT_PANEL_CLASS);\n        }\n        if (this.nextPanel) {\n            remove(this.nextPanel.element);\n            this.nextPanel = null;\n            removeClass([this.currentPanel.element], NEXT_PANEL_CLASS);\n            addClass([this.currentPanel.element], CURRENT_PANEL_CLASS);\n        }\n        this.currentPanel = null;\n        this.parent.activeView.getPanel().style.width = '';\n    }\n    getTranslateX(element) {\n        const style = window.getComputedStyle(element);\n        return new WebKitCSSMatrix(style.webkitTransform).m41;\n    }\n    setDimensions(element) {\n        element.style.width = (this.parent.element.clientWidth) + 'px';\n    }\n    resetValues() {\n        this.currentPanel = null;\n        this.previousPanel = null;\n        this.nextPanel = null;\n        this.timeStampStart = null;\n        this.element.style.transform = '';\n        removeChildren(this.element);\n        removeClass([this.element], TRANSLATE_CLASS);\n    }\n    destroy() {\n        if (this.touchObj) {\n            this.touchObj.destroy();\n            this.touchObj = null;\n        }\n        EventHandler.remove(this.element, 'transitionend', this.onTransitionEnd);\n        this.resetValues();\n    }\n}\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\n/**\n * Keyboard interaction\n */\nclass KeyboardInteraction {\n    constructor(parent) {\n        this.selectedCells = [];\n        this.keyConfigs = {\n            downArrow: 'downarrow',\n            upArrow: 'uparrow',\n            rightArrow: 'rightarrow',\n            leftArrow: 'leftarrow',\n            shiftDownArrow: 'shift+downarrow',\n            shiftUpArrow: 'shift+uparrow',\n            shiftRightArrow: 'shift+rightarrow',\n            shiftLeftArrow: 'shift+leftarrow',\n            ctrlLeftArrow: 'ctrl+leftarrow',\n            ctrlRightArrow: 'ctrl+rightarrow',\n            altOne: 'alt+1',\n            altTwo: 'alt+2',\n            altThree: 'alt+3',\n            altFour: 'alt+4',\n            altFive: 'alt+5',\n            altSix: 'alt+6',\n            altSeven: 'alt+7',\n            altEight: 'alt+8',\n            altNine: 'alt+9',\n            enter: 'enter',\n            escape: 'escape',\n            delete: 'delete',\n            home: 'home',\n            pageUp: 'pageup',\n            pageDown: 'pagedown',\n            tab: 'tab',\n            shiftTab: 'shift+tab',\n            ctrlShiftUpArrow: 'ctrl+shift+uparrow',\n            ctrlShiftDownArrow: 'ctrl+shift+downarrow',\n            ctrlShiftLeftArrow: 'ctrl+shift+leftarrow',\n            ctrlShiftRightArrow: 'ctrl+shift+rightarrow'\n        };\n        this.parent = parent;\n        this.parent.element.tabIndex = this.parent.element.tabIndex === -1 ? 0 : this.parent.element.tabIndex;\n        this.keyboardModule = new KeyboardEvents(this.parent.element, {\n            keyAction: this.keyActionHandler.bind(this),\n            keyConfigs: this.keyConfigs,\n            eventName: 'keydown'\n        });\n        this.addEventListener();\n    }\n    keyActionHandler(e) {\n        switch (e.action) {\n            case 'downArrow':\n            case 'shiftDownArrow':\n                this.processDown(e, e.shiftKey);\n                break;\n            case 'upArrow':\n            case 'shiftUpArrow':\n                this.processUp(e, e.shiftKey);\n                break;\n            case 'leftArrow':\n            case 'shiftLeftArrow':\n                this.processLeft(e, e.shiftKey);\n                break;\n            case 'rightArrow':\n            case 'shiftRightArrow':\n                this.processRight(e, e.shiftKey);\n                break;\n            case 'ctrlLeftArrow':\n                this.parent.changeDate(this.parent.activeView.getNextPreviousDate('previous'), e);\n                if (this.parent.headerModule) {\n                    this.parent.headerModule.element.querySelector('.e-prev button').focus();\n                }\n                break;\n            case 'ctrlRightArrow':\n                this.parent.changeDate(this.parent.activeView.getNextPreviousDate('next'), e);\n                if (this.parent.headerModule) {\n                    this.parent.headerModule.element.querySelector('.e-next button').focus();\n                }\n                break;\n            case 'altOne':\n            case 'altTwo':\n            case 'altThree':\n            case 'altFour':\n            case 'altFive':\n            case 'altSix':\n            case 'altSeven':\n            case 'altEight':\n            case 'altNine':\n                this.processViewNavigation(e);\n                break;\n            case 'enter':\n                this.processEnter(e);\n                break;\n            case 'home':\n                this.focusFirstCell();\n                break;\n            case 'tab':\n            case 'shiftTab':\n                this.processTab(e, e.shiftKey);\n                break;\n            case 'delete':\n                this.processDelete(e);\n                break;\n            case 'ctrlShiftUpArrow':\n            case 'ctrlShiftDownArrow':\n            case 'ctrlShiftLeftArrow':\n            case 'ctrlShiftRightArrow':\n                this.processCtrlShiftNavigationArrows(e);\n                break;\n            case 'escape':\n                this.processEscape(e);\n                break;\n            case 'fTwelve':\n                if (this.parent.allowInline && this.parent.inlineModule) {\n                    e.preventDefault();\n                    this.processFTwelve(e);\n                }\n                break;\n        }\n    }\n    processFTwelve(e) {\n        const target = e.target;\n        if (target.classList.contains(WORK_CELLS_CLASS) || target.classList.contains(ALLDAY_CELLS_CLASS)) {\n            this.parent.activeCellsData = this.getSelectedElements(target);\n            const args = extend(this.parent.activeCellsData, { cancel: false, event: e });\n            const inlineArgs = {\n                element: args.element,\n                groupIndex: args.groupIndex, type: 'Cell'\n            };\n            this.parent.notify(inlineClick, inlineArgs);\n        }\n        if (target.classList.contains(APPOINTMENT_CLASS)) {\n            target.click();\n            return;\n        }\n    }\n    addEventListener() {\n        this.parent.on(cellMouseDown, this.onCellMouseDown, this);\n    }\n    removeEventListener() {\n        this.parent.off(cellMouseDown, this.onCellMouseDown);\n    }\n    onCellMouseDown(e) {\n        if (e.event.shiftKey) {\n            return;\n        }\n        this.initialTarget = this.getClosestCell(e.event);\n        if (this.parent.activeViewOptions.readonly || this.parent.currentView === 'MonthAgenda' || !this.initialTarget) {\n            return;\n        }\n        if (e.event.target.classList.contains(WORK_CELLS_CLASS) && e.event.which !== 3) {\n            this.parent.removeSelectedClass();\n            EventHandler.add(this.parent.getContentTable(), 'mousemove', this.onMouseSelection, this);\n            EventHandler.add(this.parent.getContentTable(), 'mouseup', this.onMoveUp, this);\n        }\n        if (e.event.target.classList.contains(ALLDAY_CELLS_CLASS) && e.event.which !== 3) {\n            this.parent.removeSelectedClass();\n            const allDayRow = this.parent.getAllDayRow();\n            EventHandler.add(allDayRow, 'mousemove', this.onMouseSelection, this);\n            EventHandler.add(allDayRow, 'mouseup', this.onMoveUp, this);\n        }\n    }\n    onMouseSelection(e) {\n        const appointments = [].slice.call(this.parent.element.querySelectorAll('.' + APPOINTMENT_CLASS));\n        addClass(appointments, 'e-allow-select');\n        const selectionEdges = this.parent.boundaryValidation(e.pageY, e.pageX);\n        if (selectionEdges.bottom || selectionEdges.top || selectionEdges.left || selectionEdges.right) {\n            const parent = this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS);\n            const yInBounds = parent.offsetHeight <= parent.scrollHeight && parent.scrollTop >= 0 &&\n                parent.scrollTop + parent.offsetHeight <= parent.scrollHeight;\n            const xInBounds = parent.offsetWidth <= parent.scrollWidth && parent.scrollLeft >= 0 &&\n                parent.scrollLeft + parent.offsetWidth <= parent.scrollWidth;\n            if (yInBounds && (selectionEdges.top || selectionEdges.bottom)) {\n                parent.scrollTop += selectionEdges.top ? -e.target.offsetHeight : e.target.offsetHeight;\n            }\n            if (xInBounds && (selectionEdges.left || selectionEdges.right)) {\n                parent.scrollLeft += selectionEdges.left ? -e.target.offsetWidth : e.target.offsetWidth;\n            }\n        }\n        const target = this.getClosestCell(e);\n        if (target) {\n            this.selectCells(true, target);\n        }\n    }\n    getClosestCell(e) {\n        return closest(e.target, '.' + WORK_CELLS_CLASS + ',.' + ALLDAY_CELLS_CLASS);\n    }\n    onMoveUp(e) {\n        const appointments = [].slice.call(this.parent.element.querySelectorAll('.' + APPOINTMENT_CLASS));\n        removeClass(appointments, 'e-allow-select');\n        if (e.target.classList.contains(WORK_CELLS_CLASS)) {\n            EventHandler.remove(this.parent.getContentTable(), 'mousemove', this.onMouseSelection);\n            EventHandler.remove(this.parent.getContentTable(), 'mouseup', this.onMoveUp);\n        }\n        if (e.target.classList.contains(ALLDAY_CELLS_CLASS)) {\n            const allDayRow = this.parent.getAllDayRow();\n            EventHandler.remove(allDayRow, 'mousemove', this.onMouseSelection);\n            EventHandler.remove(allDayRow, 'mouseup', this.onMoveUp);\n        }\n        if (this.isPreventAction(e)) {\n            return;\n        }\n        const queryStr = '.' + WORK_CELLS_CLASS + ',.' + ALLDAY_CELLS_CLASS + ',.' + HEADER_CELLS_CLASS;\n        const target = closest(e.target, queryStr);\n        if (this.parent.currentView === 'TimelineYear' && target.classList.contains(OTHERMONTH_CLASS)) {\n            return;\n        }\n        this.parent.activeCellsData = this.getSelectedElements(target);\n        const cellData = {};\n        if (this.parent.eventWindow) {\n            this.parent.eventWindow.convertToEventData(this.parent.activeCellsData, cellData);\n        }\n        const selectedCells = this.parent.getSelectedElements();\n        const args = {\n            data: cellData, element: this.parent.activeCellsData.element, event: e,\n            requestType: 'cellSelect', showQuickPopup: false\n        };\n        this.parent.trigger(select, args, (selectArgs) => {\n            const isPopupShow = selectArgs.showQuickPopup || this.parent.quickInfoOnSelectionEnd;\n            if (isPopupShow && selectedCells.length > 1) {\n                const cellArgs = extend(this.parent.activeCellsData, { cancel: false, event: e, name: 'cellClick' });\n                this.parent.notify(cellClick, cellArgs);\n            }\n        });\n    }\n    processEnter(e) {\n        if ((this.parent.activeViewOptions.readonly && !e.target.classList.contains(APPOINTMENT_CLASS))\n            || this.isPreventAction(e)) {\n            return;\n        }\n        if (this.parent.currentView === 'TimelineYear' && e.target.classList.contains(OTHERMONTH_CLASS)) {\n            return;\n        }\n        const target = e.target;\n        if (closest(target, '.' + POPUP_WRAPPER_CLASS)) {\n            if (target.classList.contains(QUICK_POPUP_EVENT_DETAILS_CLASS) ||\n                target.classList.contains(EVENT_CREATE_CLASS) ||\n                target.classList.contains(EDIT_EVENT_CLASS) ||\n                target.classList.contains(DELETE_EVENT_CLASS) ||\n                target.classList.contains(CLOSE_CLASS)) {\n                target.click();\n                e.preventDefault();\n            }\n            else if (target.classList.contains(SUBJECT_CLASS)) {\n                this.parent.element.querySelector('.' + EVENT_CREATE_CLASS).click();\n                e.preventDefault();\n            }\n            return;\n        }\n        if (target.classList.contains(RESOURCE_CELLS_CLASS) && target.classList.contains(RESOURCE_PARENT_CLASS)) {\n            const resourceIcon = target.querySelector('.' + RESOURCE_TREE_ICON_CLASS);\n            if (resourceIcon) {\n                resourceIcon.click();\n            }\n            return;\n        }\n        if (target.classList.contains(WORK_CELLS_CLASS) || target.classList.contains(ALLDAY_CELLS_CLASS)) {\n            this.parent.activeCellsData = this.getSelectedElements(target);\n            const args = extend(this.parent.activeCellsData, { cancel: false, event: e });\n            if (this.parent.allowInline) {\n                const inlineArgs = {\n                    element: args.element,\n                    groupIndex: args.groupIndex, type: 'Cell'\n                };\n                this.parent.notify(inlineClick, inlineArgs);\n            }\n            else {\n                if (this.parent.currentView === 'Year') {\n                    target.click();\n                }\n                else {\n                    this.parent.notify(cellClick, args);\n                }\n            }\n            return;\n        }\n        if (target.classList.contains(INLINE_SUBJECT_CLASS) && this.parent.inlineModule) {\n            this.parent.inlineModule.inlineCrudActions(target);\n            return;\n        }\n        if (target.classList.contains(APPOINTMENT_CLASS) || target.classList.contains(MORE_EVENT_CLOSE_CLASS) ||\n            target.classList.contains(ALLDAY_APPOINTMENT_SECTION_CLASS) || target.classList.contains(MORE_INDICATOR_CLASS)) {\n            target.click();\n            return;\n        }\n        if (target.classList.contains(MORE_EVENT_HEADER_DATE_CLASS)) {\n            this.parent.setProperties({ selectedDate: this.parent.getDateFromElement(target) }, true);\n            this.parent.changeView(this.parent.getNavigateView(), e);\n            this.processEscape(e);\n            return;\n        }\n    }\n    getSelectedElements(target) {\n        let cellDetails;\n        if (this.selectedCells.length > 1 && target.classList.contains(SELECTED_CELL_CLASS)) {\n            const start = this.parent.getCellDetails(this.selectedCells[0]);\n            const end = this.parent.getCellDetails(this.selectedCells.slice(-1)[0]);\n            start.endTime = end.endTime;\n            start.element = target;\n            cellDetails = start;\n        }\n        else {\n            cellDetails = this.parent.getCellDetails(target);\n        }\n        return cellDetails;\n    }\n    getCells(isInverseTable, start, end) {\n        const tableEle = this.parent.getContentTable();\n        const isTimelineYear = this.parent.currentView === 'TimelineYear';\n        const query = isTimelineYear && !isInverseTable ? '.' + WORK_CELLS_CLASS + ':not(.' + OTHERMONTH_CLASS + ')' : 'td';\n        let cells = [].slice.call(tableEle.querySelectorAll(query));\n        let maxRow = tableEle.rows.length;\n        let maxColumn = tableEle.rows[0].cells.length;\n        if (start && start.classList.contains(ALLDAY_CELLS_CLASS)) {\n            const allDayRow = this.parent.getAllDayRow();\n            cells = [].slice.call(allDayRow.cells);\n            maxRow = 1;\n            maxColumn = allDayRow.cells.length;\n        }\n        let startIndex = cells.indexOf(start);\n        let endIndex = cells.indexOf(end);\n        const inverseCells = [];\n        if (isInverseTable) {\n            for (let i = 0; i < maxColumn; i++) {\n                for (let j = 0; j < maxRow; j++) {\n                    const cell = cells[maxColumn * j + i];\n                    if (isTimelineYear && cell.classList.contains(OTHERMONTH_CLASS)) {\n                        continue;\n                    }\n                    inverseCells.push(cell);\n                }\n            }\n            startIndex = inverseCells.indexOf(start);\n            endIndex = inverseCells.indexOf(end);\n        }\n        if (startIndex > endIndex) {\n            const temp = startIndex;\n            startIndex = endIndex;\n            endIndex = temp;\n        }\n        const sCells = isInverseTable ? inverseCells : cells;\n        return sCells.slice(startIndex, endIndex + 1);\n    }\n    focusFirstCell() {\n        if (this.parent.currentView === 'Agenda') {\n            const focusCell = this.parent.getContentTable().querySelector('.' + AGENDA_CELLS_CLASS);\n            focusCell.setAttribute('tabindex', '0');\n            focusCell.focus();\n            return;\n        }\n        this.parent.eventBase.removeSelectedAppointmentClass();\n        if (this.parent.activeView.isTimelineView() && this.parent.currentView !== 'TimelineYear') {\n            const cell = this.parent.element.querySelector('.' + CONTENT_TABLE_CLASS +\n                ' tr:not(.' + HIDDEN_CLASS + ') .' + WORK_CELLS_CLASS + ':not(.' + RESOURCE_GROUP_CELLS_CLASS + ')');\n            this.selectCells(false, cell);\n        }\n        else if (this.parent.currentView.indexOf('Year') > -1) {\n            let query = '.' + WORK_CELLS_CLASS + ':not(.' + OTHERMONTH_CLASS + ')' + ':not(.' + RESOURCE_GROUP_CELLS_CLASS + ')';\n            const isVerticalYear = this.parent.currentView === 'TimelineYear' && this.parent.activeViewOptions.orientation === 'Vertical';\n            query += isVerticalYear ? '[data-date=\"' + this.parent.activeView.startDate().getTime() + '\"]' : '';\n            this.selectCells(false, this.parent.element.querySelector(query));\n        }\n        else {\n            this.selectCells(false, this.parent.getWorkCellElements()[0]);\n        }\n    }\n    isInverseTableSelect() {\n        return this.parent.activeView.isInverseTableSelect;\n    }\n    /**\n     * Internal method to select cells\n     *\n     * @param {boolean} isMultiple Accepts to select multiple cells or not\n     * @param {HTMLTableCellElement} targetCell Accepts the target cells\n     * @returns {void}\n     * @private\n     */\n    selectCells(isMultiple, targetCell) {\n        this.parent.removeSelectedClass();\n        let target = (targetCell instanceof Array) ? targetCell.slice(-1)[0] : targetCell;\n        if (isMultiple) {\n            let initialId;\n            const views = ['Day', 'Week', 'WorkWeek', 'TimelineDay', 'TimelineWeek', 'TimelineWorkWeek', 'TimelineMonth', 'TimelineYear'];\n            const args = { element: targetCell, requestType: 'mousemove', allowMultipleRow: true };\n            this.parent.inlineModule.removeInlineAppointmentElement();\n            this.parent.trigger(select, args, (selectArgs) => {\n                const allowMultipleRow = (!selectArgs.allowMultipleRow) || (!this.parent.allowMultiRowSelection);\n                if (allowMultipleRow) {\n                    const isTimelineYear = this.parent.currentView === 'TimelineYear';\n                    if (isTimelineYear && this.parent.activeViewOptions.orientation === 'Horizontal' || this.parent.currentView === 'Month') {\n                        const isGroupYear = isTimelineYear && this.parent.activeViewOptions.group.resources.length > 0;\n                        target = isGroupYear ? this.initialTarget :\n                            this.initialTarget.parentElement.children[target.cellIndex];\n                    }\n                    else if (views.indexOf(this.parent.currentView) > -1) {\n                        target = target.parentElement.children[this.initialTarget.cellIndex];\n                    }\n                }\n                let selectedCells = this.getCells(this.isInverseTableSelect(), this.initialTarget, target);\n                if (this.parent.activeViewOptions.group.resources.length > 0) {\n                    initialId = this.initialTarget.getAttribute('data-group-index');\n                    const resourceSelectedCells = [];\n                    for (const cell of selectedCells) {\n                        if (cell.getAttribute('data-group-index') === initialId) {\n                            resourceSelectedCells.push(cell);\n                        }\n                    }\n                    selectedCells = resourceSelectedCells;\n                }\n                if (!this.parent.allowMultiCellSelection) {\n                    selectedCells = [this.initialTarget];\n                }\n                this.selectedCells = selectedCells;\n                if (selectedCells.length > 2 && !target.classList.contains(ALLDAY_CELLS_CLASS)) {\n                    let allDayCells = this.getAllDayCells(selectedCells);\n                    if (this.parent.activeViewOptions.group.resources.length > 0) {\n                        const resourceAllDayCells = [];\n                        for (const cell of allDayCells) {\n                            if (cell.getAttribute('data-group-index') === initialId) {\n                                resourceAllDayCells.push(cell);\n                            }\n                        }\n                        allDayCells = resourceAllDayCells;\n                    }\n                    selectedCells = selectedCells.concat(allDayCells);\n                }\n                if ((target.getAttribute('data-group-index') !== initialId) && this.parent.activeViewOptions.group.resources.length > 0) {\n                    target = this.selectedCells[this.selectedCells.length - 1];\n                }\n                this.parent.addSelectedClass(selectedCells, target);\n            });\n        }\n        else {\n            this.initialTarget = target;\n            this.selectedCells = [target];\n            this.parent.addSelectedClass([target], target);\n        }\n    }\n    selectAppointment(isReverse, target) {\n        const appointments = this.getAppointmentElements();\n        if (appointments.length < 0) {\n            return;\n        }\n        this.parent.eventBase.removeSelectedAppointmentClass();\n        let nextAppEle;\n        if (target.classList.contains(APPOINTMENT_CLASS)) {\n            const targetIndex = appointments.indexOf(target);\n            nextAppEle = appointments[(isReverse ? targetIndex - 1 : targetIndex + 1)];\n        }\n        else {\n            nextAppEle = isReverse ? appointments[appointments.length - 1] : appointments[0];\n        }\n        if (nextAppEle) {\n            this.parent.eventBase.addSelectedAppointments([nextAppEle]);\n            nextAppEle.focus();\n            addClass([nextAppEle], AGENDA_SELECTED_CELL);\n        }\n    }\n    selectAppointmentElementFromWorkCell(isReverse, target) {\n        this.parent.eventBase.removeSelectedAppointmentClass();\n        this.parent.removeSelectedClass();\n        if (target.classList.contains(WORK_CELLS_CLASS) || target.classList.contains(ALLDAY_CELLS_CLASS)) {\n            const appointmentElements = this.getUniqueAppointmentElements();\n            const filteredElements = [];\n            const selectedDate = this.parent.getDateFromElement(target).getTime();\n            const selectedSeriesEvents = this.parent.eventsProcessed.filter((eventObject) => {\n                return (!isReverse ? (eventObject[this.parent.eventFields.startTime].getTime() >= selectedDate) :\n                    (eventObject[this.parent.eventFields.startTime].getTime() <= selectedDate));\n            });\n            selectedSeriesEvents.filter((event) => {\n                appointmentElements.filter((element) => {\n                    if (JSON.stringify(event.Guid) === JSON.stringify(element.getAttribute('data-guid'))) {\n                        filteredElements.push(element);\n                    }\n                });\n            });\n            if (filteredElements.length > 0) {\n                const selectedElement = isReverse ? filteredElements[filteredElements.length - 1] : filteredElements[0];\n                const focusElements = this.getAppointmentElementsByGuid(selectedElement.getAttribute('data-guid'));\n                this.parent.eventBase.addSelectedAppointments(focusElements);\n                (focusElements[focusElements.length - 1]).focus();\n            }\n        }\n    }\n    getAllDayCells(cells) {\n        const allDayRow = this.parent.getAllDayRow();\n        if (!allDayRow) {\n            return [];\n        }\n        const startCell = cells[0];\n        const endCell = cells[cells.length - 1];\n        const start = this.parent.getCellDetails(startCell);\n        const end = this.parent.getCellDetails(endCell);\n        if (end.endTime.getTime() - start.startTime.getTime() >= MS_PER_DAY) {\n            const allDayCells = [].slice.call(allDayRow.cells);\n            return allDayCells.slice(startCell.cellIndex, endCell.cellIndex + 1);\n        }\n        return [];\n    }\n    getAppointmentElements() {\n        return [].slice.call(this.parent.element.querySelectorAll('.' + APPOINTMENT_CLASS));\n    }\n    getAppointmentElementsByGuid(guid) {\n        return [].slice.call(this.parent.element.querySelectorAll('div[data-guid=\"' + guid + '\"]'));\n    }\n    getUniqueAppointmentElements() {\n        const appointments = this.getAppointmentElements();\n        const appointmentElements = [];\n        appointments.map((value) => value.getAttribute('data-guid')).filter((value, index, self) => {\n            if (self.indexOf(value) === index) {\n                appointmentElements.push(appointments[index]);\n            }\n        });\n        return appointmentElements;\n    }\n    getWorkCellFromAppointmentElement(target) {\n        const selectedObject = this.parent.eventBase.getEventByGuid(target.getAttribute('data-guid'));\n        return this.parent.eventBase.selectWorkCellByTime([selectedObject]);\n    }\n    processViewNavigation(e) {\n        const index = parseInt(e.key, 10) - 1;\n        if (index < this.parent.views.length) {\n            const view = this.parent.viewCollections[index].option;\n            this.parent.changeView(view, e, undefined, index);\n            if (this.parent.headerModule) {\n                this.parent.headerModule.element.querySelector('.e-active-view button').focus();\n            }\n        }\n    }\n    cancelUpDownAction(isTimelineYear) {\n        const isVerticalYear = isTimelineYear && this.parent.activeViewOptions.orientation === 'Vertical';\n        const isGroup = this.parent.activeViewOptions.group.resources.length > 0;\n        if (isVerticalYear && isGroup || isTimelineYear && this.initialTarget.classList.contains(OTHERMONTH_CLASS)) {\n            return true;\n        }\n        if (this.parent.activeView.isTimelineView() && !isTimelineYear || this.parent.currentView === 'MonthAgenda') {\n            return true;\n        }\n        return false;\n    }\n    processUp(e, isMultiple) {\n        const isTimelineYear = this.parent.currentView === 'TimelineYear';\n        if (isMultiple && this.cancelUpDownAction(isTimelineYear)) {\n            return;\n        }\n        let target = (e.target);\n        const selectedElements = this.parent.getSelectedElements();\n        const selectedEventElements = this.parent.eventBase.getSelectedAppointments();\n        const moreEventWrapper = this.parent.element.querySelector('.' + MORE_POPUP_WRAPPER_CLASS);\n        const quickPopupWrapper = this.getQuickPopupElement();\n        if (selectedElements.length > 0 && !e.target.classList.contains(WORK_CELLS_CLASS)) {\n            target = selectedElements[selectedElements.length - 1];\n        }\n        if (selectedEventElements.length > 0 && !moreEventWrapper.classList.contains(POPUP_OPEN) &&\n            !quickPopupWrapper.classList.contains(POPUP_OPEN) &&\n            ['Day', 'Week', 'WorkWeek', 'Month'].indexOf(this.parent.currentView) !== -1) {\n            target = this.getWorkCellFromAppointmentElement(selectedEventElements[selectedEventElements.length - 1]);\n            this.parent.eventBase.removeSelectedAppointmentClass();\n        }\n        if (!target) {\n            return;\n        }\n        if (target.classList.contains(WORK_CELLS_CLASS) && !this.parent.element.querySelector('.' + POPUP_OPEN)) {\n            const tableRows = this.parent.getTableRows();\n            const curRowIndex = tableRows.indexOf(target.parentElement);\n            let targetCell;\n            if (isTimelineYear && isMultiple && this.parent.activeViewOptions.group.resources.length === 0) {\n                targetCell = this.isInverseTableSelect() ? this.getVerticalUpDownCell(tableRows, target, curRowIndex, true) :\n                    this.getHorizontalUpDownCell(tableRows, target, curRowIndex, true);\n            }\n            if ((curRowIndex > 0 || targetCell) && curRowIndex < tableRows.length) {\n                targetCell = targetCell ? targetCell : (tableRows[curRowIndex - 1]).cells[target.cellIndex];\n                if (this.parent.currentView === 'Year' && targetCell.classList.contains(OTHERMONTH_CLASS)) {\n                    if (this.parent.activeView.getStartDate().getTime() < +targetCell.getAttribute('data-date')) {\n                        targetCell = this.getYearUpDownCell(tableRows, curRowIndex - 1, target.cellIndex, true);\n                    }\n                    else {\n                        return;\n                    }\n                }\n                this.selectCells(isMultiple, targetCell);\n            }\n        }\n        else if (this.parent.currentView === 'Agenda' || this.parent.currentView === 'MonthAgenda') {\n            this.selectAppointment(true, target);\n        }\n    }\n    processDown(e, isMultiple) {\n        const isTimelineYear = this.parent.currentView === 'TimelineYear';\n        if (isMultiple && this.cancelUpDownAction(isTimelineYear)) {\n            return;\n        }\n        let target = (e.target);\n        const selectedCells = this.parent.getSelectedElements();\n        const selectedElements = this.parent.eventBase.getSelectedAppointments();\n        const moreEventWrapper = this.parent.element.querySelector('.' + MORE_POPUP_WRAPPER_CLASS);\n        const quickPopupWrapper = this.getQuickPopupElement();\n        if (selectedCells.length > 0 && !e.target.classList.contains(WORK_CELLS_CLASS)) {\n            target = selectedCells[selectedCells.length - 1];\n        }\n        if (selectedElements.length > 0 && !moreEventWrapper.classList.contains(POPUP_OPEN) &&\n            !quickPopupWrapper.classList.contains(POPUP_OPEN) &&\n            ['Day', 'Week', 'WorkWeek', 'Month'].indexOf(this.parent.currentView) !== -1) {\n            target = this.getWorkCellFromAppointmentElement(selectedElements[selectedElements.length - 1]);\n            this.parent.eventBase.removeSelectedAppointmentClass();\n        }\n        const tableRows = this.parent.getTableRows();\n        if (!target) {\n            return;\n        }\n        if (target.classList.contains(WORK_CELLS_CLASS) && !this.parent.element.querySelector('.' + POPUP_OPEN)) {\n            const curRowIndex = tableRows.indexOf(target.parentElement);\n            let targetCell;\n            if (isTimelineYear && isMultiple && this.parent.activeViewOptions.group.resources.length === 0) {\n                targetCell = this.isInverseTableSelect() ? this.getVerticalUpDownCell(tableRows, target, curRowIndex, false)\n                    : this.getHorizontalUpDownCell(tableRows, target, curRowIndex, false);\n            }\n            if (curRowIndex >= 0 && ((curRowIndex < tableRows.length - 1) || targetCell)) {\n                targetCell = targetCell ? targetCell : (tableRows[curRowIndex + 1]).cells[target.cellIndex];\n                if (this.parent.currentView === 'Year' && targetCell.classList.contains(OTHERMONTH_CLASS)) {\n                    if (this.parent.activeView.getEndDate().getTime() > +targetCell.getAttribute('data-date')) {\n                        targetCell = this.getYearUpDownCell(tableRows, curRowIndex + 1, target.cellIndex, false);\n                    }\n                    else {\n                        return;\n                    }\n                }\n                this.selectCells(isMultiple, targetCell);\n            }\n        }\n        else if (this.parent.currentView === 'Agenda' || this.parent.currentView === 'MonthAgenda') {\n            this.selectAppointment(false, target);\n        }\n    }\n    getYearUpDownCell(tableRows, rowIndex, cellIndex, isUp) {\n        while (tableRows[rowIndex] && tableRows[rowIndex].cells[cellIndex].classList.contains(OTHERMONTH_CLASS)) {\n            rowIndex = rowIndex + (isUp ? -1 : 1);\n        }\n        return tableRows[rowIndex].cells[cellIndex];\n    }\n    // eslint-disable-next-line max-len\n    getHorizontalUpDownCell(tableRows, target, curRowIndex, isUp) {\n        const row = tableRows[curRowIndex + (isUp ? -1 : 1)];\n        let cell = row ? row.cells[target.cellIndex] : target;\n        if (cell.classList.contains(OTHERMONTH_CLASS)) {\n            const workCell = row.querySelector('.' + WORK_CELLS_CLASS + ':not(.' + OTHERMONTH_CLASS + ')');\n            const date = new Date(+workCell.getAttribute('data-date'));\n            const query = '[data-date=\"' + new Date(date.getFullYear(), date.getMonth() + 1, 0).getTime() + '\"]';\n            cell = cell.cellIndex < workCell.cellIndex ? workCell : row.querySelector(query);\n        }\n        return cell;\n    }\n    // eslint-disable-next-line max-len\n    getVerticalUpDownCell(tableRows, target, curRowIndex, isUp) {\n        const hasRow = isUp && curRowIndex > 0 || !isUp && curRowIndex < tableRows.length - 1;\n        let targetCell = hasRow ? tableRows[curRowIndex + (isUp ? -1 : 1)].cells[target.cellIndex] : undefined;\n        if (!targetCell || targetCell.classList.contains(OTHERMONTH_CLASS)) {\n            const column = tableRows[curRowIndex].cells[target.cellIndex - (isUp ? 1 : -1)];\n            if (column) {\n                const dateAttr = +target.getAttribute('data-date') - (isUp ? MS_PER_DAY : -MS_PER_DAY);\n                return this.parent.getContentTable().querySelector('.' + WORK_CELLS_CLASS + '[data-date=\"' + dateAttr + '\"]');\n            }\n            targetCell = target;\n        }\n        return targetCell;\n    }\n    processLeftRight(target) {\n        const tableEle = (this.parent.currentView === 'Year' ? target.closest('tbody') : this.parent.getContentTable());\n        const curRowIndex = target.parentNode.sectionRowIndex;\n        const key = {\n            element: tableEle,\n            rowIndex: curRowIndex,\n            columnIndex: target.cellIndex,\n            maxIndex: tableEle.rows[curRowIndex].cells.length\n        };\n        return key;\n    }\n    getQuickPopupElement() {\n        return (this.parent.isAdaptive ? document.body : this.parent.element).querySelector('.' + POPUP_WRAPPER_CLASS);\n    }\n    isCancelLeftRightAction(e, isMultiple, isTimelineYear) {\n        const prevent = this.parent.currentView === 'MonthAgenda' || isTimelineYear && this.initialTarget.classList.contains(OTHERMONTH_CLASS);\n        if (this.parent.currentView === 'Agenda' || (isMultiple && prevent)) {\n            return true;\n        }\n        if (this.isPreventAction(e) && isMultiple) {\n            return true;\n        }\n        const moreEventWrapper = this.parent.element.querySelector('.' + MORE_POPUP_WRAPPER_CLASS);\n        const quickPopupWrapper = this.getQuickPopupElement();\n        if (moreEventWrapper.classList.contains(POPUP_OPEN) || quickPopupWrapper.classList.contains(POPUP_OPEN)) {\n            return true;\n        }\n        return false;\n    }\n    processRight(e, isMultiple) {\n        const isTimelineYear = this.parent.currentView === 'TimelineYear';\n        if (this.isCancelLeftRightAction(e, isMultiple, isTimelineYear)) {\n            return;\n        }\n        const selectedCells = this.parent.getSelectedElements();\n        let targetCell;\n        const selectedAppointments = this.parent.eventBase.getSelectedAppointments();\n        let target = (e.target);\n        if (selectedCells.length > 0 && !target.classList.contains(WORK_CELLS_CLASS) &&\n            !target.classList.contains(ALLDAY_CELLS_CLASS)) {\n            target = selectedCells[selectedCells.length - 1];\n        }\n        if (selectedAppointments.length > 0) {\n            target = this.getWorkCellFromAppointmentElement(selectedAppointments[selectedAppointments.length - 1]);\n            this.parent.eventBase.removeSelectedAppointmentClass();\n            if (!target) {\n                return;\n            }\n        }\n        if (target.classList.contains(WORK_CELLS_CLASS) &&\n            (e.target).classList.contains(WORK_CELLS_CLASS)) {\n            const key = this.processLeftRight(target);\n            const targetDate = new Date(+target.getAttribute('data-date'));\n            const isMonthEnd = this.parent.currentView === 'Year' && targetDate.getTime() === lastDateOfMonth(targetDate).getTime();\n            if (key.columnIndex >= 0 && key.columnIndex < key.maxIndex - 1 && !isMonthEnd) {\n                targetCell = this.calculateNextPrevDate(target, key.element.rows[key.rowIndex].cells[target.cellIndex + 1], 'right');\n                if (isTimelineYear && isMultiple && targetCell.classList.contains(OTHERMONTH_CLASS)) {\n                    targetCell = this.getTimelineYearTargetCell(key, target, true);\n                }\n                if (!isNullOrUndefined(targetCell)) {\n                    this.selectCells(isMultiple, targetCell);\n                }\n            }\n            else if (key.columnIndex === key.maxIndex - 1 || isMonthEnd) {\n                if (!this.isInverseTableSelect() && key.rowIndex < key.element.rows.length - 1 && !isMonthEnd) {\n                    targetCell = this.calculateNextPrevDate(target, key.element.rows[key.rowIndex + 1].cells[0], 'right');\n                    const changeTargetCell = isTimelineYear && isMultiple && targetCell.classList.contains(OTHERMONTH_CLASS);\n                    targetCell = changeTargetCell ? this.getHorizontalLeftRightCell(key, target, true) : targetCell;\n                    if (!isNullOrUndefined(targetCell)) {\n                        this.selectCells(isMultiple, targetCell);\n                    }\n                }\n                else if (!isMultiple) {\n                    if (isMonthEnd && targetDate.getTime() !== this.parent.activeView.getEndDate().getTime()) {\n                        this.selectCells(isMultiple, this.parent.element.querySelector(':not(.' + OTHERMONTH_CLASS + ')[data-date=\"' + (targetDate.getTime() + MS_PER_DAY) + '\"]'));\n                        return;\n                    }\n                    const rowIndex = this.isInverseTableSelect() ? key.rowIndex : 0;\n                    this.parent.changeDate(this.parent.activeView.getNextPreviousDate('next'), e);\n                    const tableEle = this.parent.getContentTable();\n                    const cell = isMonthEnd ? tableEle.rows[rowIndex].querySelector('.' + WORK_CELLS_CLASS + ':not(.' + OTHERMONTH_CLASS + ')') : tableEle.rows[rowIndex].cells[0];\n                    this.selectCells(false, cell);\n                }\n            }\n        }\n        else if (target.classList.contains(ALLDAY_CELLS_CLASS)) {\n            const curColIndex = target.cellIndex;\n            const allDayRow = this.parent.getAllDayRow();\n            const maxColIndex = allDayRow.cells.length;\n            if (curColIndex >= 0 && curColIndex < maxColIndex - 1) {\n                this.selectCells(isMultiple, allDayRow.cells[curColIndex + 1]);\n            }\n            else if (curColIndex === maxColIndex - 1 && !isMultiple) {\n                this.parent.changeDate(this.parent.activeView.getNextPreviousDate('next'), e);\n                const allDayRow = this.parent.getAllDayRow();\n                this.selectCells(false, allDayRow.cells[0]);\n            }\n        }\n    }\n    processLeft(e, isMultiple) {\n        const isTimelineYear = this.parent.currentView === 'TimelineYear';\n        if (this.isCancelLeftRightAction(e, isMultiple, isTimelineYear)) {\n            return;\n        }\n        let target = (e.target);\n        const selectedCells = this.parent.getSelectedElements();\n        let targetCell;\n        if (selectedCells.length > 0 && !target.classList.contains(WORK_CELLS_CLASS) &&\n            !target.classList.contains(ALLDAY_CELLS_CLASS)) {\n            target = selectedCells[selectedCells.length - 1];\n        }\n        const selectedElements = this.parent.eventBase.getSelectedAppointments();\n        if (selectedElements.length > 0) {\n            target = this.getWorkCellFromAppointmentElement(selectedElements[selectedElements.length - 1]);\n            this.parent.eventBase.removeSelectedAppointmentClass();\n            if (!target) {\n                return;\n            }\n        }\n        if ((e.target).classList.contains(WORK_CELLS_CLASS) &&\n            target.classList.contains(WORK_CELLS_CLASS)) {\n            const key = this.processLeftRight(target);\n            const targetDate = new Date(+target.getAttribute('data-date'));\n            const isMonthStart = this.parent.currentView === 'Year' && targetDate.getTime() === firstDateOfMonth(targetDate).getTime();\n            if (key.columnIndex > 0 && key.columnIndex < key.maxIndex && !isMonthStart) {\n                targetCell = this.calculateNextPrevDate(target, key.element.rows[key.rowIndex].cells[target.cellIndex - 1], 'left');\n                if (isTimelineYear && isMultiple && targetCell.classList.contains(OTHERMONTH_CLASS)) {\n                    targetCell = this.getTimelineYearTargetCell(key, target, false);\n                }\n                if (!isNullOrUndefined(targetCell)) {\n                    this.selectCells(isMultiple, targetCell);\n                }\n            }\n            else if (key.columnIndex === 0 || isMonthStart) {\n                if (!this.isInverseTableSelect() && key.rowIndex > 0) {\n                    targetCell = this.calculateNextPrevDate(target, key.element.rows[key.rowIndex - 1].cells[key.maxIndex - 1], 'left');\n                    const otherMonthCell = isTimelineYear && isMultiple && targetCell.classList.contains(OTHERMONTH_CLASS);\n                    targetCell = otherMonthCell ? this.getHorizontalLeftRightCell(key, target, false) : targetCell;\n                    if (!isNullOrUndefined(targetCell)) {\n                        this.selectCells(isMultiple, targetCell);\n                    }\n                }\n                else if (!isMultiple) {\n                    if (isMonthStart && targetDate.getTime() !== this.parent.activeView.getStartDate().getTime()) {\n                        this.selectCells(isMultiple, this.parent.element.querySelector('[data-date=\"' + (targetDate.getTime() - MS_PER_DAY) + '\"]'));\n                        return;\n                    }\n                    this.parent.changeDate(this.parent.activeView.getNextPreviousDate('previous'), e);\n                    const tableEle = this.parent.getContentTable();\n                    const rowIndex = this.isInverseTableSelect() ? key.rowIndex : tableEle.rows.length - 1;\n                    let cell = tableEle.rows[rowIndex].cells[key.maxIndex - 1];\n                    if (isMonthStart) {\n                        const tbody = this.parent.element.querySelectorAll('.' + CONTENT_TABLE_CLASS + ' tbody');\n                        cell = tbody.item(tbody.length - 1).querySelector(':not(.' + OTHERMONTH_CLASS + ')[data-date=\"' + this.parent.activeView.getEndDate().getTime() + '\"]');\n                    }\n                    this.selectCells(false, cell);\n                }\n            }\n        }\n        else if (target.classList.contains(ALLDAY_CELLS_CLASS)) {\n            const curColIndex = target.cellIndex;\n            const allDayRow = this.parent.getAllDayRow();\n            const maxColIndex = allDayRow.cells.length;\n            if (curColIndex > 0 && curColIndex < maxColIndex) {\n                this.selectCells(isMultiple, allDayRow.cells[curColIndex - 1]);\n            }\n            else if (curColIndex === 0 && !isMultiple) {\n                this.parent.changeDate(this.parent.activeView.getNextPreviousDate('previous'), e);\n                const allDayRow = this.parent.getAllDayRow();\n                this.selectCells(false, allDayRow.cells[maxColIndex - 1]);\n            }\n        }\n    }\n    getTimelineYearTargetCell(key, target, isRight) {\n        return this.isInverseTableSelect() ? this.getVerticalLeftRightCell(target, isRight) :\n            this.getHorizontalLeftRightCell(key, target, isRight);\n    }\n    getHorizontalLeftRightCell(key, target, isRight) {\n        const row = key.element.rows[target.parentNode.sectionRowIndex + (isRight ? 1 : -1)];\n        if (row) {\n            const query = isRight ? '.' + WORK_CELLS_CLASS + ':not(.' + OTHERMONTH_CLASS + ')'\n                : '[data-date=\"' + ((+target.getAttribute('data-date')) - MS_PER_DAY) + '\"]';\n            return row.querySelector(query);\n        }\n        return target;\n    }\n    getVerticalLeftRightCell(target, isRight) {\n        const date = new Date(+target.getAttribute('data-date'));\n        const start = new Date(date.getFullYear(), date.getMonth() + (isRight ? 1 : -1), 1);\n        const tableEle = this.parent.getContentTable();\n        const targetCell = tableEle.querySelector('[data-date=\"' + start.getTime() + '\"]');\n        if (targetCell.parentNode.sectionRowIndex > target.parentNode.sectionRowIndex) {\n            return targetCell;\n        }\n        return tableEle.querySelector('[data-date=\"' + new Date(start.getFullYear(), start.getMonth() + 1, 0).getTime() + '\"]');\n    }\n    calculateNextPrevDate(currentCell, target, type) {\n        const initialId = this.initialTarget.getAttribute('data-group-index');\n        if (this.parent.activeViewOptions.group.resources.length > 0 && this.parent.currentView === 'Month') {\n            if (currentCell && target && target.getAttribute('data-group-index') !== initialId) {\n                const currentDate = this.parent.getDateFromElement(currentCell);\n                const nextPrevDate = (type === 'right') ? new Date(currentDate.setDate(currentDate.getDate() + 1))\n                    : new Date(currentDate.setDate(currentDate.getDate() - 1));\n                target = [].slice.call(this.parent.element.querySelectorAll('td[data-date=\"'\n                    + nextPrevDate.getTime().toString() + '\"]' + '[data-group-index=\"' + initialId + '\"]'))[0];\n            }\n        }\n        return target;\n    }\n    getFocusableElements(container) {\n        const queryString = 'a[href]:not([tabindex=\"-1\"]),input:not([disabled]):not([tabindex=\"-1\"]),' +\n            'textarea:not([disabled]):not([tabindex=\"-1\"]),button:not([disabled]):not([tabindex=\"-1\"]),' +\n            'select:not([disabled]):not([tabindex=\"-1\"]),[tabindex]:not([tabindex=\"-1\"]),[contentEditable=true]:not([tabindex=\"-1\"])';\n        return [].slice.call(container.querySelectorAll(queryString));\n    }\n    processTabOnPopup(e, popupElement) {\n        let focusableElements = this.getFocusableElements(popupElement);\n        focusableElements = focusableElements.filter((element) => {\n            const footerEle = this.parent.element.querySelector('.' + POPUP_FOOTER_CLASS);\n            if (footerEle && footerEle.offsetParent) {\n                return !(element.classList.contains(EDIT_CLASS) || element.classList.contains(DELETE_CLASS));\n            }\n            else {\n                return !(element.classList.contains(EDIT_EVENT_CLASS) || element.classList.contains(DELETE_EVENT_CLASS));\n            }\n        });\n        const firstEle = focusableElements[0];\n        const lastEle = focusableElements[focusableElements.length - 1];\n        if (!isNullOrUndefined(lastEle) && document.activeElement === lastEle && !e.shiftKey) {\n            e.preventDefault();\n            firstEle.focus();\n        }\n        if (!isNullOrUndefined(firstEle) && document.activeElement === firstEle && e.shiftKey) {\n            e.preventDefault();\n            lastEle.focus();\n        }\n    }\n    processTab(e, isReverse) {\n        let target = e.target;\n        if (target.classList.contains(INLINE_SUBJECT_CLASS) && this.parent.inlineModule) {\n            target = target.closest('.e-appointment');\n            this.parent.inlineModule.inlineCrudActions(e.target);\n        }\n        if (this.parent.currentView === 'TimelineYear' && target.classList.contains(OTHERMONTH_CLASS)) {\n            if (target.classList.contains(SELECTED_CELL_CLASS)) {\n                this.parent.removeSelectedClass();\n            }\n            return;\n        }\n        const popupWrapper = closest(target, '.' + POPUP_WRAPPER_CLASS + ',.' + MORE_POPUP_WRAPPER_CLASS);\n        if (popupWrapper && popupWrapper.classList.contains(POPUP_OPEN)) {\n            if (popupWrapper.classList.contains(MORE_POPUP_WRAPPER_CLASS)) {\n                this.parent.eventBase.removeSelectedAppointmentClass();\n            }\n            this.processTabOnPopup(e, popupWrapper);\n            return;\n        }\n        if (target.classList.contains(ROOT)) {\n            this.parent.eventBase.removeSelectedAppointmentClass();\n            return;\n        }\n        if (target.classList.contains(RESOURCE_CELLS_CLASS) && this.parent.activeView.isTimelineView()\n            && this.parent.activeViewOptions.group.resources.length > 0) {\n            const index = parseInt(target.getAttribute('data-group-index'), 10);\n            const appSelector = `.${APPOINTMENT_CLASS}[data-group-index=\"${isReverse ? index - 1 : index}\"]`;\n            const appElements = [].slice.call(this.parent.element.querySelectorAll(appSelector));\n            if (appElements.length > 0) {\n                this.parent.eventBase.removeSelectedAppointmentClass();\n                const focusAppointment = isReverse ? appElements.slice(-1)[0] : appElements[0];\n                this.parent.eventBase.addSelectedAppointments([focusAppointment]);\n                focusAppointment.focus();\n                e.preventDefault();\n            }\n            else if (index + 1 === this.parent.resourceBase.lastResourceLevel.length) {\n                this.parent.element.focus();\n                e.preventDefault();\n            }\n            else if (this.parent.virtualScrollModule) {\n                const virtual = this.parent.element.querySelector('.' + VIRTUAL_TRACK_CLASS);\n                const averageRowHeight = Math.round(virtual.offsetHeight / this.parent.resourceBase.expandedResources.length);\n                this.parent.element.querySelector('.e-content-wrap').scrollTop = ((isReverse ? index - 1 : index + 1) * averageRowHeight);\n                this.parent.virtualScrollModule.virtualScrolling();\n            }\n            else {\n                this.setScrollPosition(index);\n            }\n            return;\n        }\n        if (target.classList.contains(APPOINTMENT_CLASS)) {\n            let appElements = [].slice.call(this.parent.element.querySelectorAll('.' + APPOINTMENT_CLASS));\n            const isTimelineYear = this.parent.currentView === 'TimelineYear';\n            const isTimeline = this.parent.activeView.isTimelineView() && !isTimelineYear;\n            if ((isTimeline || isTimelineYear && this.parent.activeViewOptions.orientation === 'Vertical') && this.parent.activeViewOptions.group.resources.length > 0) {\n                const index = parseInt(target.getAttribute('data-group-index'), 10);\n                appElements = [].slice.call(this.parent.element.querySelectorAll(`.${APPOINTMENT_CLASS}[data-group-index=\"${index}\"]`));\n                const resCellSelector = `.${RESOURCE_CELLS_CLASS}[data-group-index=\"${isReverse ? index : index + 1}\"]`;\n                const resourceCell = this.parent.element.querySelector(resCellSelector);\n                if (resourceCell && (isReverse && target.getAttribute('data-guid') === appElements[0].getAttribute('data-guid') ||\n                    !isReverse && target.getAttribute('data-guid') === appElements.slice(-1)[0].getAttribute('data-guid'))) {\n                    this.parent.eventBase.removeSelectedAppointmentClass();\n                    if (this.parent.virtualScrollModule) {\n                        resourceCell.focus({ preventScroll: true });\n                    }\n                    else {\n                        resourceCell.focus();\n                    }\n                    if (this.parent.activeView.isTimelineView() && this.parent.activeViewOptions.group.resources.length > 0 &&\n                        isNullOrUndefined(this.parent.virtualScrollModule)) {\n                        this.setScrollPosition(index);\n                    }\n                    e.preventDefault();\n                    return;\n                }\n            }\n            const selectedAppointments = this.parent.eventBase.getSelectedAppointments();\n            if (selectedAppointments.length > 0) {\n                target = selectedAppointments[selectedAppointments.length - 1];\n            }\n            this.parent.eventBase.removeSelectedAppointmentClass();\n            if (!isReverse && target.getAttribute('data-guid') === appElements[appElements.length - 1].getAttribute('data-guid') ||\n                isReverse && target.getAttribute('data-guid') === appElements[0].getAttribute('data-guid')) {\n                return;\n            }\n            if (this.parent.currentView === 'Agenda' || this.parent.currentView === 'MonthAgenda') {\n                this.selectAppointment(isReverse, target);\n                e.preventDefault();\n            }\n            return;\n        }\n        const selectedCells = this.parent.getSelectedElements();\n        if (selectedCells.length > 0 && !target.classList.contains(APPOINTMENT_CLASS)) {\n            target = selectedCells[selectedCells.length - 1];\n            this.selectAppointmentElementFromWorkCell(isReverse, target);\n            e.preventDefault();\n            return;\n        }\n        if (target && !target.classList.contains(RESOURCE_CELLS_CLASS) && this.parent.activeView.isTimelineView()\n            && this.parent.activeViewOptions.group.resources.length > 0) {\n            this.processTabOnResourceCells(target, isReverse);\n        }\n    }\n    processDelete(e) {\n        let activeEle = document.activeElement;\n        if (this.parent.currentView === 'MonthAgenda') {\n            const selectedEle = this.parent.eventBase.getSelectedEvents().element;\n            activeEle = ((selectedEle && isNullOrUndefined(selectedEle.length)) ? selectedEle : selectedEle[0]);\n        }\n        if (activeEle && activeEle.classList.contains(APPOINTMENT_CLASS)) {\n            addClass([activeEle], APPOINTMENT_BORDER);\n            this.parent.activeEventData = this.parent.eventBase.getSelectedEvents();\n            if (this.parent.activeViewOptions.readonly || activeEle.classList.contains(READ_ONLY) ||\n                !this.parent.eventSettings.allowDeleting) {\n                return;\n            }\n            this.parent.quickPopup.deleteClick(e);\n        }\n    }\n    processCtrlShiftNavigationArrows(e) {\n        if (this.parent.activeViewOptions.group.resources.length > 0 && document.activeElement.classList.contains(APPOINTMENT_CLASS)) {\n            const groupIndex = parseInt(document.activeElement.getAttribute('data-group-index'), 10);\n            let index = (e.action === 'ctrlShiftLeftArrow' || e.action === 'ctrlShiftUpArrow') ? groupIndex - 1 : groupIndex + 1;\n            index = index < 0 ? 0 : index > this.parent.resourceBase.lastResourceLevel.length ?\n                this.parent.resourceBase.lastResourceLevel.length : index;\n            let eventEle = [];\n            while (eventEle.length === 0 && index >= 0 && index <= this.parent.resourceBase.lastResourceLevel.length) {\n                eventEle = [].slice.call(this.parent.element.querySelectorAll(`.${APPOINTMENT_CLASS}[data-group-index=\"${index}\"]`));\n                index = (e.action === 'ctrlShiftLeftArrow' || e.action === 'ctrlShiftUpArrow') ? index - 1 : index + 1;\n            }\n            const nextAppEle = eventEle[0];\n            if (nextAppEle) {\n                this.parent.eventBase.removeSelectedAppointmentClass();\n                this.parent.eventBase.addSelectedAppointments([nextAppEle]);\n                nextAppEle.focus();\n            }\n        }\n        else if (this.parent.activeViewOptions.group.resources.length > 0 &&\n            !document.activeElement.classList.contains(APPOINTMENT_CLASS)) {\n            const index = this.parent.resourceBase.renderedResources[0].groupIndex;\n            const appSelector = `.${APPOINTMENT_CLASS}[data-group-index=\"${index}\"]`;\n            const appElements = [].slice.call(this.parent.element.querySelectorAll(appSelector));\n            if (appElements.length > 0) {\n                this.parent.eventBase.removeSelectedAppointmentClass();\n                const focusAppointment = appElements[0];\n                this.parent.eventBase.addSelectedAppointments([focusAppointment]);\n                focusAppointment.focus();\n                e.preventDefault();\n            }\n        }\n    }\n    processEscape(event) {\n        this.parent.quickPopup.onClosePopup(event);\n        this.parent.quickPopup.morePopup.hide();\n        if (this.parent.headerModule) {\n            this.parent.headerModule.hideHeaderPopup();\n        }\n        if (this.parent.inlineModule) {\n            this.parent.inlineModule.removeInlineAppointmentElement();\n        }\n    }\n    isPreventAction(e) {\n        const target = closest(e.target, '.' + RESOURCE_GROUP_CELLS_CLASS);\n        if (this.parent.activeView.isTimelineView() && !isNullOrUndefined(target)) {\n            return true;\n        }\n        return false;\n    }\n    processTabOnResourceCells(target, isReverse) {\n        const tabElements = [].slice.call(this.parent.element.querySelectorAll('[tabIndex=\"0\"]'));\n        const currentTabIndex = tabElements.indexOf(target);\n        const nextTabElement = !isReverse ? tabElements[currentTabIndex + 1] : tabElements[currentTabIndex - 1];\n        if (nextTabElement && nextTabElement.classList.contains(RESOURCE_CELLS_CLASS)) {\n            const groupIndex = parseInt(nextTabElement.getAttribute('data-group-index'), 10);\n            if (this.parent.virtualScrollModule) {\n                const resColWrap = this.parent.element.querySelector('.' + RESOURCE_COLUMN_WRAP_CLASS);\n                const resCells = [].slice.call(this.parent.element.querySelectorAll('.' + RESOURCE_CELLS_CLASS));\n                resCells.forEach((element) => {\n                    if (element.getBoundingClientRect().top < resColWrap.getBoundingClientRect().top) {\n                        element.setAttribute('tabindex', '-1');\n                    }\n                });\n            }\n            else {\n                this.setScrollPosition(groupIndex);\n            }\n        }\n    }\n    setScrollPosition(index) {\n        const workCell = this.parent.element.querySelector(`.${WORK_CELLS_CLASS}[data-group-index=\"${index}\"]`);\n        if (workCell) {\n            this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS).scrollTop = workCell.offsetTop;\n        }\n    }\n    /**\n     * Get module name.\n     *\n     * @returns {string} Returns the module name.\n     */\n    getModuleName() {\n        return 'keyboard';\n    }\n    /**\n     * To destroy the keyboard module.\n     *\n     * @returns {void}\n     * @private\n     */\n    destroy() {\n        this.removeEventListener();\n        this.keyboardModule.destroy();\n    }\n}\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\n/**\n * data module is used to generate query and data source.\n *\n * @private\n */\nclass Data {\n    /**\n     * Constructor for data module\n     *\n     * @param {Object | DataManager} dataSource Accepts the datasource as JSON objects or DataManager\n     * @param {Query} query Accepts the query to process the data\n     * @private\n     */\n    constructor(dataSource, query) {\n        this.initDataManager(dataSource, query);\n    }\n    /**\n     * The function used to initialize dataManager and query\n     *\n     * @param {Object | DataManager} dataSource Accepts the datasource as JSON objects or DataManager\n     * @param {Query} query Accepts the query to process the data\n     * @returns {void}\n     * @private\n     */\n    initDataManager(dataSource, query) {\n        this.dataManager = dataSource instanceof DataManager ? dataSource : new DataManager(dataSource);\n        this.query = query instanceof Query ? query : new Query();\n    }\n    /**\n     * The function used to generate updated Query from schedule model\n     *\n     * @param {Date} startDate Accepts the start date\n     * @param {Date} endDate Accepts the end date\n     * @returns {void}\n     * @private\n     */\n    generateQuery(startDate, endDate) {\n        const query = this.query.clone();\n        if (startDate) {\n            query.addParams('StartDate', startDate.toISOString());\n        }\n        if (endDate) {\n            query.addParams('EndDate', endDate.toISOString());\n        }\n        return query;\n    }\n    /**\n     * The function used to get dataSource by executing given Query\n     *\n     * @param  {Query} query - A Query that specifies to generate dataSource\n     * @returns {void}\n     * @private\n     */\n    getData(query) {\n        return this.dataManager.executeQuery(query);\n    }\n    /**\n     * To destroy the crud module.\n     *\n     * @returns {void}\n     * @private\n     */\n    destroy() {\n        this.dataManager = null;\n        this.query = null;\n    }\n}\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\n/** @private */\nclass Gregorian {\n    firstDateOfMonth(date) {\n        return new Date(date.getFullYear(), date.getMonth());\n    }\n    lastDateOfMonth(dt) {\n        return new Date(dt.getFullYear(), dt.getMonth() + 1, 0);\n    }\n    isMonthStart(date) {\n        return (date.getDate() === 1);\n    }\n    getLeapYearDaysCount() {\n        return 366;\n    }\n    getYearDaysCount(date, interval) {\n        return ((date.getFullYear() + interval) % 4 === 0) ? 366 : 365;\n    }\n    getDate(date) {\n        return date.getDate();\n    }\n    getMonth(date) {\n        return (date.getMonth() + 1);\n    }\n    getFullYear(date) {\n        return date.getFullYear();\n    }\n    getYearLastDate(date, interval) {\n        return new Date(date.getFullYear() + interval, 0, 0);\n    }\n    getMonthDaysCount(date) {\n        return this.lastDateOfMonth(date).getDate();\n    }\n    getMonthStartDate(date) {\n        return new Date(date.getFullYear(), date.getMonth(), 1, date.getHours(), date.getMinutes());\n    }\n    getMonthEndDate(date) {\n        date.setDate(1);\n        return new Date(date.setMonth(date.getMonth() + 1));\n    }\n    getExpectedDays(date, days) {\n        return days;\n    }\n    setDate(dateObj, date) {\n        dateObj.setDate(date);\n    }\n    setValidDate(date, interval, startDate, monthValue, beginDate) {\n        if (!isNullOrUndefined(beginDate)) {\n            date.setMonth((beginDate ? monthValue : date.getMonth()) + interval);\n        }\n        else {\n            date.setMonth(date.getMonth() + interval, startDate);\n        }\n    }\n    setMonth(date, interval, startDate) {\n        date.setFullYear(date.getFullYear());\n        date.setMonth(interval - 1);\n        date.setDate(startDate);\n    }\n    addYears(date, interval) {\n        date.setFullYear(date.getFullYear() + interval);\n    }\n    isSameMonth(date1, date2) {\n        return (date1.getMonth() === date2.getMonth());\n    }\n    checkMonth(date, months) {\n        return (months.indexOf(date.getMonth() + 1) === -1);\n    }\n    compareMonth(date1, date2) {\n        return (date1.getMonth() > date2.getMonth());\n    }\n    isSameYear(date1, date2) {\n        return (date1.getFullYear() === date2.getFullYear());\n    }\n    isLastMonth(date) {\n        return (date.getMonth() === 11);\n    }\n    isLeapYear(year, interval) {\n        return ((year + interval) % 4 === 0);\n    }\n}\n/** @private */\nclass Islamic {\n    firstDateOfMonth(date) {\n        const hDate = this.getHijriDate(date);\n        const gDate = HijriParser.toGregorian(hDate.year, hDate.month, 1);\n        return gDate;\n    }\n    lastDateOfMonth(date) {\n        const hDate = this.getHijriDate(date);\n        const daysInMonth = this.getDaysInMonth(hDate.month, hDate.year);\n        const gDate = HijriParser.toGregorian(hDate.year, hDate.month, daysInMonth);\n        let finalGDate = new Date(gDate.getTime());\n        finalGDate = new Date(finalGDate.setDate(finalGDate.getDate() + 1));\n        let finalHDate = this.getHijriDate(finalGDate);\n        if (hDate.month === finalHDate.month) {\n            return finalGDate;\n        }\n        finalHDate = this.getHijriDate(gDate);\n        if (hDate.month === finalHDate.month) {\n            return gDate;\n        }\n        return new Date(gDate.setDate(gDate.getDate() - 1));\n    }\n    isMonthStart(date) {\n        const hijriDate = this.getHijriDate(date);\n        return (hijriDate.date === 1);\n    }\n    getLeapYearDaysCount() {\n        return 355;\n    }\n    getYearDaysCount(date, interval) {\n        const hDate = this.getHijriDate(date);\n        return this.isLeapYear(hDate.year, interval) ? 355 : 354;\n    }\n    getDate(date) {\n        const hijriDate = this.getHijriDate(date);\n        return hijriDate.date;\n    }\n    getMonth(date) {\n        const hDate = this.getHijriDate(date);\n        return hDate.month;\n    }\n    getFullYear(date) {\n        const hDate = this.getHijriDate(date);\n        return hDate.year;\n    }\n    getYearLastDate(date, interval) {\n        const hDate = this.getHijriDate(date);\n        const gDate = HijriParser.toGregorian(hDate.year + interval, 1, 0);\n        return gDate;\n    }\n    getMonthDaysCount(date) {\n        const maxDate = this.lastDateOfMonth(date);\n        const hijriDate = this.getHijriDate(maxDate);\n        return hijriDate.date;\n    }\n    getMonthStartDate(date) {\n        const firstDate = this.firstDateOfMonth(date);\n        return new Date(firstDate.getFullYear(), firstDate.getMonth(), firstDate.getDate(), date.getHours(), date.getMinutes());\n    }\n    getMonthEndDate(date) {\n        const lastDate = this.lastDateOfMonth(date);\n        lastDate.setDate(lastDate.getDate() + 1);\n        return new Date(lastDate.setMonth(lastDate.getMonth()));\n    }\n    getExpectedDays(date, days) {\n        const hDate = this.getHijriDate(date);\n        const day = [];\n        for (let i = 0; i < days.length; i++) {\n            const gDate = HijriParser.toGregorian(hDate.year, hDate.month, days[i]);\n            day.push(gDate.getDate());\n        }\n        return day;\n    }\n    setDate(dateObj, date) {\n        const hDate = this.getHijriDate(dateObj);\n        const gDate = HijriParser.toGregorian(hDate.year, hDate.month, date);\n        this.updateDateObj(dateObj, gDate);\n    }\n    setValidDate(date, interval, startDate, monthValue, beginDate) {\n        const firstDate = (!isNullOrUndefined(beginDate)) ? this.firstDateOfMonth(beginDate) : date;\n        const hDate = this.getHijriDate(firstDate);\n        const gDate = HijriParser.toGregorian(hDate.year, hDate.month + interval, startDate);\n        this.updateDateObj(date, gDate);\n    }\n    setMonth(date, interval, startDate) {\n        const hDate = this.getHijriDate(date);\n        const gDate = HijriParser.toGregorian(hDate.year, interval, startDate);\n        this.updateDateObj(date, gDate);\n    }\n    addYears(date, interval, monthValue) {\n        const hDate = this.getHijriDate(date);\n        const gDate = HijriParser.toGregorian(hDate.year + interval, monthValue, 1);\n        this.updateDateObj(date, gDate);\n    }\n    isSameMonth(date1, date2) {\n        const currentHijri = this.getHijriDate(date1);\n        const tempHijri = this.getHijriDate(date2);\n        return (currentHijri.month === tempHijri.month);\n    }\n    checkMonth(date, months) {\n        const hDate = this.getHijriDate(date);\n        return (months.indexOf(hDate.month) === -1);\n    }\n    compareMonth(date1, date2) {\n        const hDate = this.getHijriDate(date1);\n        const hDate1 = this.getHijriDate(date2);\n        return (hDate.month > hDate1.month);\n    }\n    isSameYear(date1, date2) {\n        const hDate = this.getHijriDate(date1);\n        const hDate1 = this.getHijriDate(date2);\n        return (hDate.year === hDate1.year);\n    }\n    isLastMonth(date) {\n        const hDate = this.getHijriDate(date);\n        return (hDate.month === 12);\n    }\n    updateDateObj(date, gDate) {\n        date.setFullYear(gDate.getFullYear(), gDate.getMonth(), gDate.getDate());\n    }\n    isLeapYear(year, interval) {\n        return (14 + 11 * (year + interval)) % 30 < 11;\n    }\n    getDaysInMonth(month, year) {\n        let length = 0;\n        length = 29 + ((month + 1) % 2);\n        if (month === 11 && this.isLeapYear(year, 0)) {\n            length++;\n        }\n        return length;\n    }\n    getHijriDate(date) {\n        return HijriParser.getHijriDate(date);\n    }\n}\n\n/**\n * Time zone\n */\nclass Timezone {\n    constructor() {\n        this.timezoneData = [];\n        this.timezoneData = this.getTimezoneData();\n    }\n    offset(date, timezone) {\n        const localOffset = date.getTimezoneOffset();\n        try {\n            const convertedDate = new Date(date.toLocaleString('en-US', { timeZone: timezone }));\n            if (!isNaN(convertedDate.getTime())) {\n                return ((date.getTime() - convertedDate.getTime()) / 60000) + localOffset;\n            }\n            return 0;\n        }\n        catch (error) {\n            return 0;\n        }\n    }\n    convert(date, fromOffset, toOffset) {\n        if (typeof fromOffset === 'string') {\n            fromOffset = this.offset(date, fromOffset);\n        }\n        if (typeof toOffset === 'string') {\n            toOffset = this.offset(date, toOffset);\n        }\n        const fromLocalOffset = date.getTimezoneOffset();\n        date = new Date(date.getTime() + (fromOffset - toOffset) * 60000);\n        const toLocalOffset = date.getTimezoneOffset();\n        return new Date(date.getTime() + (toLocalOffset - fromLocalOffset) * 60000);\n    }\n    add(date, timezone) {\n        return this.convert(date, date.getTimezoneOffset(), timezone);\n    }\n    remove(date, timezone) {\n        return this.convert(date, timezone, date.getTimezoneOffset());\n    }\n    removeLocalOffset(date) {\n        return new Date(date.getTime() - (date.getTimezoneOffset() * 60000));\n    }\n    getLocalTimezoneName() {\n        return window.Intl ? Intl.DateTimeFormat().resolvedOptions().timeZone || 'UTC' : 'UTC';\n    }\n    getTimezoneData() {\n        return timezoneData;\n    }\n}\nconst timezoneData = [\n    { Value: 'Pacific/Niue', Text: '(UTC-11:00) Niue' },\n    { Value: 'Pacific/Pago_Pago', Text: '(UTC-11:00) Pago Pago' },\n    { Value: 'Pacific/Honolulu', Text: '(UTC-10:00) Hawaii Time' },\n    { Value: 'Pacific/Rarotonga', Text: '(UTC-10:00) Rarotonga' },\n    { Value: 'Pacific/Tahiti', Text: '(UTC-10:00) Tahiti' },\n    { Value: 'Pacific/Marquesas', Text: '(UTC-09:30) Marquesas' },\n    { Value: 'America/Anchorage', Text: '(UTC-09:00) Alaska Time' },\n    { Value: 'Pacific/Gambier', Text: '(UTC-09:00) Gambier' },\n    { Value: 'America/Los_Angeles', Text: '(UTC-08:00) Pacific Time' },\n    { Value: 'America/Tijuana', Text: '(UTC-08:00) Pacific Time - Tijuana' },\n    { Value: 'America/Vancouver', Text: '(UTC-08:00) Pacific Time - Vancouver' },\n    { Value: 'America/Whitehorse', Text: '(UTC-08:00) Pacific Time - Whitehorse' },\n    { Value: 'Pacific/Pitcairn', Text: '(UTC-08:00) Pitcairn' },\n    { Value: 'America/Denver', Text: '(UTC-07:00) Mountain Time' },\n    { Value: 'America/Phoenix', Text: '(UTC-07:00) Mountain Time - Arizona' },\n    { Value: 'America/Mazatlan', Text: '(UTC-07:00) Mountain Time - Chihuahua, Mazatlan' },\n    { Value: 'America/Dawson_Creek', Text: '(UTC-07:00) Mountain Time - Dawson Creek' },\n    { Value: 'America/Edmonton', Text: '(UTC-07:00) Mountain Time - Edmonton' },\n    { Value: 'America/Hermosillo', Text: '(UTC-07:00) Mountain Time - Hermosillo' },\n    { Value: 'America/Yellowknife', Text: '(UTC-07:00) Mountain Time - Yellowknife' },\n    { Value: 'America/Belize', Text: '(UTC-06:00) Belize' },\n    { Value: 'America/Chicago', Text: '(UTC-06:00) Central Time' },\n    { Value: 'America/Mexico_City', Text: '(UTC-06:00) Central Time - Mexico City' },\n    { Value: 'America/Regina', Text: '(UTC-06:00) Central Time - Regina' },\n    { Value: 'America/Tegucigalpa', Text: '(UTC-06:00) Central Time - Tegucigalpa' },\n    { Value: 'America/Winnipeg', Text: '(UTC-06:00) Central Time - Winnipeg' },\n    { Value: 'America/Costa_Rica', Text: '(UTC-06:00) Costa Rica' },\n    { Value: 'America/El_Salvador', Text: '(UTC-06:00) El Salvador' },\n    { Value: 'Pacific/Galapagos', Text: '(UTC-06:00) Galapagos' },\n    { Value: 'America/Guatemala', Text: '(UTC-06:00) Guatemala' },\n    { Value: 'America/Managua', Text: '(UTC-06:00) Managua' },\n    { Value: 'America/Cancun', Text: '(UTC-05:00) America Cancun' },\n    { Value: 'America/Bogota', Text: '(UTC-05:00) Bogota' },\n    { Value: 'Pacific/Easter', Text: '(UTC-05:00) Easter Island' },\n    { Value: 'America/New_York', Text: '(UTC-05:00) Eastern Time' },\n    { Value: 'America/Iqaluit', Text: '(UTC-05:00) Eastern Time - Iqaluit' },\n    { Value: 'America/Toronto', Text: '(UTC-05:00) Eastern Time - Toronto' },\n    { Value: 'America/Guayaquil', Text: '(UTC-05:00) Guayaquil' },\n    { Value: 'America/Havana', Text: '(UTC-05:00) Havana' },\n    { Value: 'America/Jamaica', Text: '(UTC-05:00) Jamaica' },\n    { Value: 'America/Lima', Text: '(UTC-05:00) Lima' },\n    { Value: 'America/Nassau', Text: '(UTC-05:00) Nassau' },\n    { Value: 'America/Panama', Text: '(UTC-05:00) Panama' },\n    { Value: 'America/Port-au-Prince', Text: '(UTC-05:00) Port-au-Prince' },\n    { Value: 'America/Rio_Branco', Text: '(UTC-05:00) Rio Branco' },\n    { Value: 'America/Halifax', Text: '(UTC-04:00) Atlantic Time - Halifax' },\n    { Value: 'America/Barbados', Text: '(UTC-04:00) Barbados' },\n    { Value: 'Atlantic/Bermuda', Text: '(UTC-04:00) Bermuda' },\n    { Value: 'America/Boa_Vista', Text: '(UTC-04:00) Boa Vista' },\n    { Value: 'America/Caracas', Text: '(UTC-04:00) Caracas' },\n    { Value: 'America/Curacao', Text: '(UTC-04:00) Curacao' },\n    { Value: 'America/Grand_Turk', Text: '(UTC-04:00) Grand Turk' },\n    { Value: 'America/Guyana', Text: '(UTC-04:00) Guyana' },\n    { Value: 'America/La_Paz', Text: '(UTC-04:00) La Paz' },\n    { Value: 'America/Manaus', Text: '(UTC-04:00) Manaus' },\n    { Value: 'America/Martinique', Text: '(UTC-04:00) Martinique' },\n    { Value: 'America/Port_of_Spain', Text: '(UTC-04:00) Port of Spain' },\n    { Value: 'America/Porto_Velho', Text: '(UTC-04:00) Porto Velho' },\n    { Value: 'America/Puerto_Rico', Text: '(UTC-04:00) Puerto Rico' },\n    { Value: 'America/Santo_Domingo', Text: '(UTC-04:00) Santo Domingo' },\n    { Value: 'America/Thule', Text: '(UTC-04:00) Thule' },\n    { Value: 'America/St_Johns', Text: '(UTC-03:30) Newfoundland Time - St. Johns' },\n    { Value: 'America/Araguaina', Text: '(UTC-03:00) Araguaina' },\n    { Value: 'America/Asuncion', Text: '(UTC-03:00) Asuncion' },\n    { Value: 'America/Belem', Text: '(UTC-03:00) Belem' },\n    { Value: 'America/Argentina/Buenos_Aires', Text: '(UTC-03:00) Buenos Aires' },\n    { Value: 'America/Campo_Grande', Text: '(UTC-03:00) Campo Grande' },\n    { Value: 'America/Cayenne', Text: '(UTC-03:00) Cayenne' },\n    { Value: 'America/Cuiaba', Text: '(UTC-03:00) Cuiaba' },\n    { Value: 'America/Fortaleza', Text: '(UTC-03:00) Fortaleza' },\n    { Value: 'America/Godthab', Text: '(UTC-03:00) Godthab' },\n    { Value: 'America/Maceio', Text: '(UTC-03:00) Maceio' },\n    { Value: 'America/Miquelon', Text: '(UTC-03:00) Miquelon' },\n    { Value: 'America/Montevideo', Text: '(UTC-03:00) Montevideo' },\n    { Value: 'Antarctica/Palmer', Text: '(UTC-03:00) Palmer' },\n    { Value: 'America/Paramaribo', Text: '(UTC-03:00) Paramaribo' },\n    { Value: 'America/Punta_Arenas', Text: '(UTC-03:00) Punta Arenas' },\n    { Value: 'America/Recife', Text: '(UTC-03:00) Recife' },\n    { Value: 'Antarctica/Rothera', Text: '(UTC-03:00) Rothera' },\n    { Value: 'America/Bahia', Text: '(UTC-03:00) Salvador' },\n    { Value: 'America/Santiago', Text: '(UTC-03:00) Santiago' },\n    { Value: 'Atlantic/Stanley', Text: '(UTC-03:00) Stanley' },\n    { Value: 'America/Noronha', Text: '(UTC-02:00) Noronha' },\n    { Value: 'America/Sao_Paulo', Text: '(UTC-02:00) Sao Paulo' },\n    { Value: 'Atlantic/South_Georgia', Text: '(UTC-02:00) South Georgia' },\n    { Value: 'Atlantic/Azores', Text: '(UTC-01:00) Azores' },\n    { Value: 'Atlantic/Cape_Verde', Text: '(UTC-01:00) Cape Verde' },\n    { Value: 'America/Scoresbysund', Text: '(UTC-01:00) Scoresbysund' },\n    { Value: 'Africa/Abidjan', Text: '(UTC+00:00) Abidjan' },\n    { Value: 'Africa/Accra', Text: '(UTC+00:00) Accra' },\n    { Value: 'Africa/Bissau', Text: '(UTC+00:00) Bissau' },\n    { Value: 'Atlantic/Canary', Text: '(UTC+00:00) Canary Islands' },\n    { Value: 'Africa/Casablanca', Text: '(UTC+00:00) Casablanca' },\n    { Value: 'America/Danmarkshavn', Text: '(UTC+00:00) Danmarkshavn' },\n    { Value: 'Europe/Dublin', Text: '(UTC+00:00) Dublin' },\n    { Value: 'Africa/El_Aaiun', Text: '(UTC+00:00) El Aaiun' },\n    { Value: 'Atlantic/Faroe', Text: '(UTC+00:00) Faeroe' },\n    { Value: 'Etc/UTC', Text: '(UTC+00:00) UTC (no daylight saving)' },\n    { Value: 'Europe/Lisbon', Text: '(UTC+00:00) Lisbon' },\n    { Value: 'Europe/London', Text: '(UTC+00:00) London' },\n    { Value: 'Africa/Monrovia', Text: '(UTC+00:00) Monrovia' },\n    { Value: 'Atlantic/Reykjavik', Text: '(UTC+00:00) Reykjavik' },\n    { Value: 'UTC', Text: 'UTC' },\n    { Value: 'Africa/Algiers', Text: '(UTC+01:00) Algiers' },\n    { Value: 'Europe/Amsterdam', Text: '(UTC+01:00) Amsterdam' },\n    { Value: 'Europe/Andorra', Text: '(UTC+01:00) Andorra' },\n    { Value: 'Europe/Berlin', Text: '(UTC+01:00) Berlin' },\n    { Value: 'Europe/Brussels', Text: '(UTC+01:00) Brussels' },\n    { Value: 'Europe/Budapest', Text: '(UTC+01:00) Budapest' },\n    { Value: 'Europe/Belgrade', Text: '(UTC+01:00) Central European Time - Belgrade' },\n    { Value: 'Europe/Prague', Text: '(UTC+01:00) Central European Time - Prague' },\n    { Value: 'Africa/Ceuta', Text: '(UTC+01:00) Ceuta' },\n    { Value: 'Europe/Copenhagen', Text: '(UTC+01:00) Copenhagen' },\n    { Value: 'Europe/Gibraltar', Text: '(UTC+01:00) Gibraltar' },\n    { Value: 'Africa/Lagos', Text: '(UTC+01:00) Lagos' },\n    { Value: 'Europe/Luxembourg', Text: '(UTC+01:00) Luxembourg' },\n    { Value: 'Europe/Madrid', Text: '(UTC+01:00) Madrid' },\n    { Value: 'Europe/Malta', Text: '(UTC+01:00) Malta' },\n    { Value: 'Europe/Monaco', Text: '(UTC+01:00) Monaco' },\n    { Value: 'Africa/Ndjamena', Text: '(UTC+01:00) Ndjamena' },\n    { Value: 'Europe/Oslo', Text: '(UTC+01:00) Oslo' },\n    { Value: 'Europe/Paris', Text: '(UTC+01:00) Paris' },\n    { Value: 'Europe/Rome', Text: '(UTC+01:00) Rome' },\n    { Value: 'Europe/Stockholm', Text: '(UTC+01:00) Stockholm' },\n    { Value: 'Europe/Tirane', Text: '(UTC+01:00) Tirane' },\n    { Value: 'Africa/Tunis', Text: '(UTC+01:00) Tunis' },\n    { Value: 'Europe/Vienna', Text: '(UTC+01:00) Vienna' },\n    { Value: 'Europe/Warsaw', Text: '(UTC+01:00) Warsaw' },\n    { Value: 'Europe/Zurich', Text: '(UTC+01:00) Zurich' },\n    { Value: 'Asia/Amman', Text: '(UTC+02:00) Amman' },\n    { Value: 'Europe/Athens', Text: '(UTC+02:00) Athens' },\n    { Value: 'Asia/Beirut', Text: '(UTC+02:00) Beirut' },\n    { Value: 'Europe/Bucharest', Text: '(UTC+02:00) Bucharest' },\n    { Value: 'Africa/Cairo', Text: '(UTC+02:00) Cairo' },\n    { Value: 'Europe/Chisinau', Text: '(UTC+02:00) Chisinau' },\n    { Value: 'Asia/Damascus', Text: '(UTC+02:00) Damascus' },\n    { Value: 'Asia/Gaza', Text: '(UTC+02:00) Gaza' },\n    { Value: 'Europe/Helsinki', Text: '(UTC+02:00) Helsinki' },\n    { Value: 'Asia/Jerusalem', Text: '(UTC+02:00) Jerusalem' },\n    { Value: 'Africa/Johannesburg', Text: '(UTC+02:00) Johannesburg' },\n    { Value: 'Africa/Khartoum', Text: '(UTC+02:00) Khartoum' },\n    { Value: 'Europe/Kiev', Text: '(UTC+02:00) Kiev' },\n    { Value: 'Africa/Maputo', Text: '(UTC+02:00) Maputo' },\n    { Value: 'Europe/Kaliningrad', Text: '(UTC+02:00) Moscow-01 - Kaliningrad' },\n    { Value: 'Asia/Nicosia', Text: '(UTC+02:00) Nicosia' },\n    { Value: 'Europe/Riga', Text: '(UTC+02:00) Riga' },\n    { Value: 'Europe/Sofia', Text: '(UTC+02:00) Sofia' },\n    { Value: 'Europe/Tallinn', Text: '(UTC+02:00) Tallinn' },\n    { Value: 'Africa/Tripoli', Text: '(UTC+02:00) Tripoli' },\n    { Value: 'Europe/Vilnius', Text: '(UTC+02:00) Vilnius' },\n    { Value: 'Africa/Windhoek', Text: '(UTC+02:00) Windhoek' },\n    { Value: 'Asia/Baghdad', Text: '(UTC+03:00) Baghdad' },\n    { Value: 'Europe/Istanbul', Text: '(UTC+03:00) Istanbul' },\n    { Value: 'Europe/Minsk', Text: '(UTC+03:00) Minsk' },\n    { Value: 'Europe/Moscow', Text: '(UTC+03:00) Moscow+00 - Moscow' },\n    { Value: 'Africa/Nairobi', Text: '(UTC+03:00) Nairobi' },\n    { Value: 'Asia/Qatar', Text: '(UTC+03:00) Qatar' },\n    { Value: 'Asia/Riyadh', Text: '(UTC+03:00) Riyadh' },\n    { Value: 'Antarctica/Syowa', Text: '(UTC+03:00) Syowa' },\n    { Value: 'Asia/Tehran', Text: '(UTC+03:30) Tehran' },\n    { Value: 'Asia/Baku', Text: '(UTC+04:00) Baku' },\n    { Value: 'Asia/Dubai', Text: '(UTC+04:00) Dubai' },\n    { Value: 'Indian/Mahe', Text: '(UTC+04:00) Mahe' },\n    { Value: 'Indian/Mauritius', Text: '(UTC+04:00) Mauritius' },\n    { Value: 'Europe/Samara', Text: '(UTC+04:00) Moscow+01 - Samara' },\n    { Value: 'Indian/Reunion', Text: '(UTC+04:00) Reunion' },\n    { Value: 'Asia/Tbilisi', Text: '(UTC+04:00) Tbilisi' },\n    { Value: 'Asia/Yerevan', Text: '(UTC+04:00) Yerevan' },\n    { Value: 'Asia/Kabul', Text: '(UTC+04:30) Kabul' },\n    { Value: 'Asia/Aqtau', Text: '(UTC+05:00) Aqtau' },\n    { Value: 'Asia/Aqtobe', Text: '(UTC+05:00) Aqtobe' },\n    { Value: 'Asia/Ashgabat', Text: '(UTC+05:00) Ashgabat' },\n    { Value: 'Asia/Dushanbe', Text: '(UTC+05:00) Dushanbe' },\n    { Value: 'Asia/Karachi', Text: '(UTC+05:00) Karachi' },\n    { Value: 'Indian/Kerguelen', Text: '(UTC+05:00) Kerguelen' },\n    { Value: 'Indian/Maldives', Text: '(UTC+05:00) Maldives' },\n    { Value: 'Antarctica/Mawson', Text: '(UTC+05:00) Mawson' },\n    { Value: 'Asia/Yekaterinburg', Text: '(UTC+05:00) Moscow+02 - Yekaterinburg' },\n    { Value: 'Asia/Tashkent', Text: '(UTC+05:00) Tashkent' },\n    { Value: 'Asia/Colombo', Text: '(UTC+05:30) Colombo' },\n    { Value: 'Asia/Kolkata', Text: '(UTC+05:30) India Standard Time' },\n    { Value: 'Asia/Katmandu', Text: '(UTC+05:45) Katmandu' },\n    { Value: 'Asia/Almaty', Text: '(UTC+06:00) Almaty' },\n    { Value: 'Asia/Bishkek', Text: '(UTC+06:00) Bishkek' },\n    { Value: 'Indian/Chagos', Text: '(UTC+06:00) Chagos' },\n    { Value: 'Asia/Dhaka', Text: '(UTC+06:00) Dhaka' },\n    { Value: 'Asia/Omsk', Text: '(UTC+06:00) Moscow+03 - Omsk' },\n    { Value: 'Asia/Thimphu', Text: '(UTC+06:00) Thimphu' },\n    { Value: 'Antarctica/Vostok', Text: '(UTC+06:00) Vostok' },\n    { Value: 'Indian/Cocos', Text: '(UTC+06:30) Cocos' },\n    { Value: 'Asia/Yangon', Text: '(UTC+06:30) Rangoon' },\n    { Value: 'Asia/Bangkok', Text: '(UTC+07:00) Bangkok' },\n    { Value: 'Indian/Christmas', Text: '(UTC+07:00) Christmas' },\n    { Value: 'Antarctica/Davis', Text: '(UTC+07:00) Davis' },\n    { Value: 'Asia/Saigon', Text: '(UTC+07:00) Hanoi' },\n    { Value: 'Asia/Hovd', Text: '(UTC+07:00) Hovd' },\n    { Value: 'Asia/Jakarta', Text: '(UTC+07:00) Jakarta' },\n    { Value: 'Asia/Krasnoyarsk', Text: '(UTC+07:00) Moscow+04 - Krasnoyarsk' },\n    { Value: 'Asia/Brunei', Text: '(UTC+08:00) Brunei' },\n    { Value: 'Asia/Shanghai', Text: '(UTC+08:00) China Time - Beijing' },\n    { Value: 'Asia/Choibalsan', Text: '(UTC+08:00) Choibalsan' },\n    { Value: 'Asia/Hong_Kong', Text: '(UTC+08:00) Hong Kong' },\n    { Value: 'Asia/Kuala_Lumpur', Text: '(UTC+08:00) Kuala Lumpur' },\n    { Value: 'Asia/Macau', Text: '(UTC+08:00) Macau' },\n    { Value: 'Asia/Makassar', Text: '(UTC+08:00) Makassar' },\n    { Value: 'Asia/Manila', Text: '(UTC+08:00) Manila' },\n    { Value: 'Asia/Irkutsk', Text: '(UTC+08:00) Moscow+05 - Irkutsk' },\n    { Value: 'Asia/Singapore', Text: '(UTC+08:00) Singapore' },\n    { Value: 'Asia/Taipei', Text: '(UTC+08:00) Taipei' },\n    { Value: 'Asia/Ulaanbaatar', Text: '(UTC+08:00) Ulaanbaatar' },\n    { Value: 'Australia/Perth', Text: '(UTC+08:00) Western Time - Perth' },\n    { Value: 'Asia/Pyongyang', Text: '(UTC+08:30) Pyongyang' },\n    { Value: 'Asia/Dili', Text: '(UTC+09:00) Dili' },\n    { Value: 'Asia/Jayapura', Text: '(UTC+09:00) Jayapura' },\n    { Value: 'Asia/Yakutsk', Text: '(UTC+09:00) Moscow+06 - Yakutsk' },\n    { Value: 'Pacific/Palau', Text: '(UTC+09:00) Palau' },\n    { Value: 'Asia/Seoul', Text: '(UTC+09:00) Seoul' },\n    { Value: 'Asia/Tokyo', Text: '(UTC+09:00) Tokyo' },\n    { Value: 'Australia/Darwin', Text: '(UTC+09:30) Central Time - Darwin' },\n    { Value: 'Antarctica/DumontDUrville', Text: '(UTC+10:00) Dumont D\"Urville' },\n    { Value: 'Australia/Brisbane', Text: '(UTC+10:00) Eastern Time - Brisbane' },\n    { Value: 'Pacific/Guam', Text: '(UTC+10:00) Guam' },\n    { Value: 'Asia/Vladivostok', Text: '(UTC+10:00) Moscow+07 - Vladivostok' },\n    { Value: 'Pacific/Port_Moresby', Text: '(UTC+10:00) Port Moresby' },\n    { Value: 'Pacific / Chuuk', Text: '(UTC+10:00) Truk' },\n    { Value: 'Australia/Adelaide', Text: '(UTC+10:30) Central Time - Adelaide' },\n    { Value: 'Antarctica/Casey', Text: '(UTC+11:00) Casey' },\n    { Value: 'Australia/Hobart', Text: '(UTC+11:00) Eastern Time - Hobart' },\n    { Value: 'Australia/Sydney', Text: '(UTC+11:00) Eastern Time - Melbourne, Sydney' },\n    { Value: 'Pacific/Efate', Text: '(UTC+11:00) Efate' },\n    { Value: 'Pacific/Guadalcanal', Text: '(UTC+11:00) Guadalcanal' },\n    { Value: 'Pacific/Kosrae', Text: '(UTC+11:00) Kosrae' },\n    { Value: 'Asia/Magadan', Text: '(UTC+11:00) Moscow+08 - Magadan' },\n    { Value: 'Pacific / Norfolk', Text: '(UTC+11:00) Norfolk' },\n    { Value: 'Pacific/Noumea', Text: '(UTC+11:00) Noumea' },\n    { Value: 'Pacific/Pohnpei', Text: '(UTC+11:00) Ponape' },\n    { Value: 'Pacific/Funafuti', Text: '(UTC+12:00) Funafuti' },\n    { Value: 'Pacific/Kwajalein', Text: '(UTC+12:00) Kwajalein' },\n    { Value: 'Pacific/Majuro', Text: '(UTC+12:00) Majuro' },\n    { Value: 'Asia/Kamchatka', Text: '(UTC+12:00) Moscow+09 - Petropavlovsk - Kamchatskiy' },\n    { Value: 'Pacific / Nauru', Text: '(UTC+12:00) Nauru' },\n    { Value: 'Pacific/Tarawa', Text: '(UTC+12:00) Tarawa' },\n    { Value: 'Pacific/Wake', Text: '(UTC+12:00) Wake' },\n    { Value: 'Pacific/Wallis', Text: '(UTC+12:00) Wallis' },\n    { Value: 'Pacific/Auckland', Text: '(UTC+13:00) Auckland' },\n    { Value: 'Pacific/Enderbury', Text: '(UTC+13:00) Enderbury' },\n    { Value: 'Pacific/Fakaofo', Text: '(UTC+13:00) Fakaofo' },\n    { Value: 'Pacific/Fiji', Text: '(UTC+13:00) Fiji' },\n    { Value: 'Pacific/Tongatapu', Text: '(UTC+13:00) Tongatapu' },\n    { Value: 'Pacific/Apia', Text: '(UTC+14:00) Apia' },\n    { Value: 'Pacific/Kiritimati', Text: '(UTC+14:00) Kiritimati' }\n];\n\n/* eslint-disable max-len */\n/**\n * Date Generator from Recurrence Rule\n */\n/**\n * Generate Summary from Recurrence Rule\n *\n * @param {string} rule Accepts the Recurrence rule\n * @param {L10n} localeObject Accepts the locale object\n * @param {string} locale Accepts the locale name\n * @param {CalendarType} calendarType Accepts the calendar type\n * @returns {string} Returns the summary string from given recurrence rule\n */\nfunction generateSummary(rule, localeObject, locale, calendarType = 'Gregorian') {\n    const ruleObject = extractObjectFromRule(rule);\n    let summary = localeObject.getConstant(EVERY) + ' ';\n    let cldrObj;\n    let cldrObj1;\n    const calendarMode = calendarType.toLowerCase();\n    if (locale === 'en' || locale === 'en-US') {\n        const nameSpace1 = 'months.stand-alone.abbreviated';\n        const nameSpace = 'days.stand-alone.abbreviated';\n        cldrObj1 = (getValue(nameSpace1, getDefaultDateObject(calendarMode)));\n        cldrObj = (getValue(nameSpace, getDefaultDateObject(calendarMode)));\n    }\n    else {\n        const nameSpace1 = 'main.' + locale + '.dates.calendars.' + calendarMode + '.months.stand-alone.abbreviated';\n        const nameSpace = 'main.' + locale + '.dates.calendars.' + calendarMode + '.days.stand-alone.abbreviated';\n        cldrObj1 =\n            (getValue(nameSpace1, cldrData));\n        cldrObj =\n            (getValue(nameSpace, cldrData));\n    }\n    if (ruleObject.interval > 1) {\n        summary += ruleObject.interval + ' ';\n    }\n    switch (ruleObject.freq) {\n        case 'DAILY':\n            summary += localeObject.getConstant(DAYS);\n            break;\n        case 'WEEKLY':\n            summary += localeObject.getConstant(WEEKS) + ' ' + localeObject.getConstant(ON) + ' ';\n            ruleObject.day.forEach((day, index) => {\n                summary += capitalizeFirstWord(getValue(DAYINDEXOBJECT[day], cldrObj), 'single');\n                summary += (((ruleObject.day.length - 1) === index) ? '' : ', ');\n            });\n            break;\n        case 'MONTHLY':\n            summary += localeObject.getConstant(MONTHS) + ' ' + localeObject.getConstant(ON) + ' ';\n            summary += getMonthSummary(ruleObject, cldrObj, localeObject);\n            break;\n        case 'YEARLY':\n            summary += localeObject.getConstant(YEARS) + ' ' + localeObject.getConstant(ON) + ' ';\n            summary += capitalizeFirstWord(getValue((ruleObject.month[0]).toString(), cldrObj1), 'single') + ' ';\n            summary += getMonthSummary(ruleObject, cldrObj, localeObject);\n            break;\n    }\n    if (ruleObject.count) {\n        summary += ', ' + (ruleObject.count) + ' ' + localeObject.getConstant(TIMES);\n    }\n    else if (ruleObject.until) {\n        const tempDate = ruleObject.until;\n        summary += ', ' + localeObject.getConstant(UNTIL)\n            + ' ' + tempDate.getDate()\n            + ' ' + capitalizeFirstWord(getValue((tempDate.getMonth() + 1).toString(), cldrObj1), 'single')\n            + ' ' + tempDate.getFullYear();\n    }\n    return summary;\n}\n/**\n * Generates Month summary\n *\n * @param {RecRule} ruleObject Accepts the recurrence rule object\n * @param {string[]} cldrObj Accepts the collections of month name from calendar\n * @param {L10n} localeObj Accepts the locale object\n * @returns {string} Returns the month summary string from given recurrence rule object\n * @private\n */\nfunction getMonthSummary(ruleObject, cldrObj, localeObj) {\n    let summary = '';\n    if (ruleObject.monthDay.length) {\n        summary += ruleObject.monthDay[0];\n    }\n    else if (ruleObject.day) {\n        const pos = ruleObject.setPosition - 1;\n        summary += localeObj.getConstant(WEEKPOS[pos > -1 ? pos : (WEEKPOS.length - 1)])\n            + ' ' + capitalizeFirstWord(getValue(DAYINDEXOBJECT[ruleObject.day[0]], cldrObj), 'single');\n    }\n    return summary;\n}\n/**\n * Generates the date collections from the given recurrence rule\n *\n * @param {Date} startDate Accepts the rule start date\n * @param {string} rule Accepts the recurrence rule\n * @param {string} excludeDate Accepts the exception dates in string format\n * @param {number} startDayOfWeek Accepts the start day index of week\n * @param {number} maximumCount Accepts the maximum number count to generate date collections\n * @param {Date} viewDate Accepts the current date instead of start date\n * @param {CalendarType} calendarMode Accepts the calendar type\n * @param {string} oldTimezone Accepts the timezone name\n * @param {string} newTimezone Accepts the timezone name\n * @returns {number[]} Returns the collection of dates\n */\nfunction generate(startDate, rule, excludeDate, startDayOfWeek, maximumCount = MAXOCCURRENCE, viewDate = null, calendarMode = 'Gregorian', oldTimezone = null, newTimezone = null) {\n    const ruleObject = extractObjectFromRule(rule);\n    let cacheDate;\n    calendarUtil = getCalendarUtil(calendarMode);\n    const data = [];\n    const modifiedDate = new Date(startDate.getTime());\n    tempExcludeDate = [];\n    const tempDate = isNullOrUndefined(excludeDate) ? [] : excludeDate.split(',');\n    const tz = new Timezone();\n    tempDate.forEach((content) => {\n        let parsedDate = getDateFromRecurrenceDateString(content);\n        if (oldTimezone && newTimezone) {\n            parsedDate = tz.convert(new Date(parsedDate.getTime()), oldTimezone, newTimezone);\n        }\n        tempExcludeDate.push(new Date(parsedDate.getTime()).setHours(0, 0, 0, 0));\n    });\n    ruleObject.recExceptionCount = !isNullOrUndefined(ruleObject.count) ? tempExcludeDate.length : 0;\n    if (viewDate && viewDate > startDate && !ruleObject.count) {\n        tempViewDate = new Date(new Date(viewDate.getTime()).setHours(0, 0, 0));\n    }\n    else {\n        tempViewDate = null;\n    }\n    if (!ruleObject.until && tempViewDate) {\n        cacheDate = new Date(tempViewDate.getTime());\n        cacheDate.setDate(tempViewDate.getDate() + maximumCount * (ruleObject.interval));\n        ruleObject.until = cacheDate;\n    }\n    if (ruleObject.until && startDate > ruleObject.until) {\n        return data;\n    }\n    maxOccurrence = maximumCount;\n    setFirstDayOfWeek(DAYINDEX[startDayOfWeek]);\n    if (ruleObject.until) {\n        const end = resetTime(ruleObject.until);\n        ruleObject.until = new Date(end.getFullYear(), end.getMonth(), end.getDate(), 23, 59, 59);\n    }\n    switch (ruleObject.freq) {\n        case 'DAILY':\n            dailyType(modifiedDate, ruleObject.until, data, ruleObject);\n            break;\n        case 'WEEKLY':\n            weeklyType(modifiedDate, ruleObject.until, data, ruleObject);\n            break;\n        case 'MONTHLY':\n            monthlyType(modifiedDate, ruleObject.until, data, ruleObject);\n            break;\n        case 'YEARLY':\n            yearlyType(modifiedDate, ruleObject.until, data, ruleObject);\n    }\n    return data;\n}\n/**\n * Generate date object from given date string\n *\n * @param {string} recDateString Accepts the exception date as string\n * @returns {Date} Returns the date from exception date string\n */\nfunction getDateFromRecurrenceDateString(recDateString) {\n    return new Date(recDateString.substr(0, 4) +\n        '-' + recDateString.substr(4, 2) +\n        '-' + recDateString.substr(6, 5) +\n        ':' + recDateString.substr(11, 2) +\n        ':' + recDateString.substr(13));\n}\n/**\n * Internal method to handle exclude date\n *\n * @param {number[]} data Accepts the exception date collections\n * @param {number} date Accepts the new exclude date\n * @returns {void}\n * @private\n */\nfunction excludeDateHandler(data, date) {\n    const zeroIndex = new Date(date).setHours(0, 0, 0, 0);\n    if (tempExcludeDate.indexOf(zeroIndex) === -1 && (!tempViewDate || zeroIndex >= tempViewDate.getTime())) {\n        data.push(date);\n    }\n}\n/**\n * Internal method for get date count\n *\n * @param {Date} startDate Accepts the date\n * @param {RecRule} ruleObject Accepts the recurrence rule object\n * @returns {number} Returns the number of date count\n * @private\n */\nfunction getDateCount$1(startDate, ruleObject) {\n    let count = maxOccurrence;\n    if (ruleObject.count) {\n        count = ruleObject.count;\n    }\n    else if (ruleObject.until) {\n        if (ruleObject.freq === 'DAILY' || ruleObject.freq === 'WEEKLY') {\n            count = Math.floor((ruleObject.until.getTime() - startDate.getTime()) / MS_PER_DAY) + 1;\n        }\n        else if (ruleObject.freq === 'MONTHLY' || ruleObject.freq === 'YEARLY') {\n            count = Math.floor(((ruleObject.until.getMonth() + 12 * ruleObject.until.getFullYear()) -\n                (startDate.getMonth() + 12 * startDate.getFullYear())) / ruleObject.interval) +\n                (ruleObject.day.length > 1 ? (Math.floor((ruleObject.until.getTime() - startDate.getTime()) / MS_PER_DAY) + 1) : 1);\n            if (ruleObject.freq === 'YEARLY') {\n                count = ruleObject.month.length > 1 ? (count * ruleObject.month.length) : count;\n            }\n        }\n    }\n    return count;\n}\n/**\n *  Internal method for daily type recurrence rule\n *\n * @param {Date} startDate Accepts the strat date\n * @param {Date} endDate Accepts the end date\n * @param {number[]} data Accepts the collection of dates\n * @param {RecRule} ruleObject Accepts the recurrence rule object\n * @returns {void}\n * @private\n */\nfunction dailyType(startDate, endDate, data, ruleObject) {\n    const tempDate = new Date(startDate.getTime());\n    const interval = ruleObject.interval;\n    const expectedCount = getDateCount$1(startDate, ruleObject);\n    let state;\n    const expectedDays = ruleObject.day;\n    while (compareDates(tempDate, endDate)) {\n        state = true;\n        state = validateRules(tempDate, ruleObject);\n        if (state && (expectedDays.indexOf(DAYINDEX[tempDate.getDay()]) > -1 || expectedDays.length === 0)) {\n            excludeDateHandler(data, tempDate.getTime());\n            if (expectedCount && (data.length + ruleObject.recExceptionCount) >= expectedCount) {\n                break;\n            }\n        }\n        tempDate.setDate(tempDate.getDate() + interval);\n        if (tempDate.getHours() !== startDate.getHours()) {\n            tempDate.setHours(startDate.getHours());\n        }\n    }\n}\n/**\n * Internal method for weekly type recurrence rule\n *\n * @param {Date} startDate Accepts the strat date\n * @param {Date} endDate Accepts the end date\n * @param {number[]} data Accepts the collection of dates\n * @param {RecRule} ruleObject Accepts the recurrence rule object\n * @returns {void}\n * @private\n */\nfunction weeklyType(startDate, endDate, data, ruleObject) {\n    let tempDate = new Date(startDate.getTime());\n    if (!ruleObject.day.length) {\n        ruleObject.day.push(DAYINDEX[startDate.getDay()]);\n    }\n    const interval = ruleObject.interval;\n    const expectedDays = ruleObject.day;\n    const expectedCount = getDateCount$1(startDate, ruleObject);\n    let weekState = true;\n    let wkstIndex;\n    let weekCollection = [];\n    if (expectedDays.length > 1) {\n        if (isNullOrUndefined(ruleObject.wkst) || ruleObject.wkst === '') {\n            ruleObject.wkst = dayIndex[0];\n        }\n        wkstIndex = DAYINDEX.indexOf(ruleObject.wkst);\n        while (compareDates(tempDate, endDate)) {\n            let startDateDiff = DAYINDEX.indexOf(DAYINDEX[tempDate.getDay()]) - wkstIndex;\n            startDateDiff = startDateDiff === -1 ? 6 : startDateDiff;\n            const weekstartDate = addDays(tempDate, -startDateDiff);\n            let weekendDate = addDays(weekstartDate, 6);\n            let compareTempDate = new Date(tempDate.getTime());\n            weekendDate = resetTime(weekendDate);\n            compareTempDate = resetTime(compareTempDate);\n            while (weekendDate >= compareTempDate) {\n                if (expectedDays.indexOf(DAYINDEX[tempDate.getDay()]) > -1) {\n                    weekCollection.push([tempDate.getTime()]);\n                }\n                if (expectedCount && (data.length + ruleObject.recExceptionCount) >= expectedCount) {\n                    break;\n                }\n                tempDate.setDate(tempDate.getDate() + 1);\n                if (tempDate.getHours() !== startDate.getHours()) {\n                    tempDate.setHours(startDate.getHours());\n                }\n                compareTempDate = new Date(tempDate.getTime());\n                compareTempDate = resetTime(compareTempDate);\n            }\n            tempDate.setDate(tempDate.getDate() - 1);\n            if (expectedCount && (data.length + ruleObject.recExceptionCount) >= expectedCount) {\n                break;\n            }\n            tempDate.setDate((tempDate.getDate()) + 1 + ((interval - 1) * 7));\n            insertDataCollection(weekCollection, weekState, startDate, endDate, data, ruleObject);\n            weekCollection = [];\n        }\n    }\n    else {\n        tempDate = getStartDateForWeek(startDate, ruleObject.day);\n        while (compareDates(tempDate, endDate)) {\n            weekState = validateRules(tempDate, ruleObject);\n            if (weekState && (expectedDays.indexOf(DAYINDEX[tempDate.getDay()]) > -1)) {\n                excludeDateHandler(data, tempDate.getTime());\n            }\n            if (expectedCount && (data.length + ruleObject.recExceptionCount) >= expectedCount) {\n                break;\n            }\n            tempDate.setDate(tempDate.getDate() + (interval * 7));\n        }\n        insertDataCollection(weekCollection, weekState, startDate, endDate, data, ruleObject);\n        weekCollection = [];\n    }\n}\n/**\n *  Internal method for monthly type recurrence rule\n *\n * @param {Date} startDate Accepts the strat date\n * @param {Date} endDate Accepts the end date\n * @param {number[]} data Accepts the collection of dates\n * @param {RecRule} ruleObject Accepts the recurrence rule object\n * @returns {void}\n * @private\n */\nfunction monthlyType(startDate, endDate, data, ruleObject) {\n    // Set monthday value if BYDAY, BYMONTH and Month day property is not set based on start date\n    if (!ruleObject.month.length && !ruleObject.day.length && !ruleObject.monthDay.length) {\n        ruleObject.monthDay.push(startDate.getDate());\n        if (ruleObject.freq === 'YEARLY') {\n            ruleObject.month.push(startDate.getMonth() + 1);\n        }\n    }\n    else if (ruleObject.month.length > 0 && !ruleObject.day.length && !ruleObject.monthDay.length) {\n        ruleObject.monthDay.push(startDate.getDate());\n    }\n    const ruleType = validateMonthlyRuleType(ruleObject);\n    switch (ruleType) {\n        case 'day':\n            switch (ruleObject.freq) {\n                case 'MONTHLY':\n                    monthlyDayTypeProcessforMonthFreq(startDate, endDate, data, ruleObject);\n                    break;\n                case 'YEARLY':\n                    monthlyDayTypeProcess(startDate, endDate, data, ruleObject);\n                    break;\n            }\n            break;\n        case 'both':\n        case 'date':\n            switch (ruleObject.freq) {\n                case 'MONTHLY':\n                    monthlyDateTypeProcessforMonthFreq(startDate, endDate, data, ruleObject);\n                    break;\n                case 'YEARLY':\n                    monthlyDateTypeProcess(startDate, endDate, data, ruleObject);\n                    break;\n            }\n            break;\n    }\n}\n/**\n * Internal method for yearly type recurrence rule\n *\n * @param {Date} startDate Accepts the strat date\n * @param {Date} endDate Accepts the end date\n * @param {number[]} data Accepts the collection of dates\n * @param {RecRule} ruleObject Accepts the recurrence rule object\n * @returns {void}\n * @private\n */\nfunction yearlyType(startDate, endDate, data, ruleObject) {\n    const typeValue = checkYearlyType(ruleObject);\n    switch (typeValue) {\n        case 'MONTH':\n            monthlyType(startDate, endDate, data, ruleObject);\n            break;\n        case 'WEEKNO':\n            processWeekNo(startDate, endDate, data, ruleObject);\n            break;\n        case 'YEARDAY':\n            processYearDay(startDate, endDate, data, ruleObject);\n            break;\n    }\n}\n/**\n * Internal method for process week no\n *\n * @param {Date} startDate Accepts the strat date\n * @param {Date} endDate Accepts the end date\n * @param {number[]} data Accepts the collection of dates\n * @param {RecRule} ruleObject Accepts the recurrence rule object\n * @returns {void}\n * @private\n */\nfunction processWeekNo(startDate, endDate, data, ruleObject) {\n    let stDate = calendarUtil.getYearLastDate(startDate, 0);\n    let tempDate;\n    const expectedCount = getDateCount$1(startDate, ruleObject);\n    let state;\n    let startDay;\n    let firstWeekSpan;\n    const weekNos = ruleObject.weekNo;\n    let weekNo;\n    let maxDate;\n    let minDate;\n    let weekCollection = [];\n    const expectedDays = ruleObject.day;\n    while (compareDates(stDate, endDate)) {\n        startDay = dayIndex.indexOf(DAYINDEX[stDate.getDay()]);\n        firstWeekSpan = (6 - startDay) + 1;\n        for (let index = 0; index < weekNos.length; index++) {\n            weekNo = weekNos[index];\n            weekNo = (weekNo > 0) ? weekNo : 53 + weekNo + 1;\n            maxDate = (weekNo === 1) ? firstWeekSpan : firstWeekSpan + ((weekNo - 1) * 7);\n            minDate = (weekNo === 1) ? firstWeekSpan - 7 : firstWeekSpan + ((weekNo - 2) * 7);\n            while (minDate < maxDate) {\n                tempDate = new Date(stDate.getTime() + (MS_PER_DAY * minDate));\n                if (expectedDays.length === 0 || expectedDays.indexOf(DAYINDEX[tempDate.getDay()]) > -1) {\n                    if (isNullOrUndefined(ruleObject.setPosition)) {\n                        insertDateCollection(state, startDate, endDate, data, ruleObject, tempDate.getTime());\n                    }\n                    else {\n                        weekCollection.push([tempDate.getTime()]);\n                    }\n                }\n                minDate++;\n            }\n        }\n        if (!isNullOrUndefined(ruleObject.setPosition)) {\n            insertDatasIntoExistingCollection(weekCollection, state, startDate, endDate, data, ruleObject);\n        }\n        if (expectedCount && (data.length + ruleObject.recExceptionCount) >= expectedCount) {\n            return;\n        }\n        stDate = calendarUtil.getYearLastDate(tempDate, ruleObject.interval);\n        weekCollection = [];\n    }\n}\n/**\n * Internal method for process year day\n *\n * @param {Date} startDate Accepts the strat date\n * @param {Date} endDate Accepts the end date\n * @param {number[]} data Accepts the collection of dates\n * @param {RecRule} ruleObject Accepts the recurrence rule object\n * @returns {void}\n * @private\n */\nfunction processYearDay(startDate, endDate, data, ruleObject) {\n    let stDate = calendarUtil.getYearLastDate(startDate, 0);\n    let tempDate;\n    const expectedCount = getDateCount$1(startDate, ruleObject);\n    let state;\n    let dateCollection = [];\n    let date;\n    const expectedDays = ruleObject.day;\n    while (compareDates(stDate, endDate)) {\n        for (let index = 0; index < ruleObject.yearDay.length; index++) {\n            date = ruleObject.yearDay[index];\n            tempDate = new Date(stDate.getTime());\n            if ((date === calendarUtil.getLeapYearDaysCount() || date === -calendarUtil.getLeapYearDaysCount()) &&\n                (!calendarUtil.isLeapYear(calendarUtil.getFullYear(tempDate), 1))) {\n                tempDate.setDate(tempDate.getDate() + 1);\n                continue;\n            }\n            tempDate.setDate(tempDate.getDate() + ((date < 0) ?\n                calendarUtil.getYearDaysCount(tempDate, 1) + 1 + date : date));\n            if (expectedDays.length === 0 || expectedDays.indexOf(DAYINDEX[tempDate.getDay()]) > -1) {\n                if (ruleObject.setPosition == null) {\n                    insertDateCollection(state, startDate, endDate, data, ruleObject, tempDate.getTime());\n                }\n                else {\n                    dateCollection.push([tempDate.getTime()]);\n                }\n            }\n        }\n        if (!isNullOrUndefined(ruleObject.setPosition)) {\n            insertDatasIntoExistingCollection(dateCollection, state, startDate, endDate, data, ruleObject);\n        }\n        if (expectedCount && (data.length + ruleObject.recExceptionCount) >= expectedCount) {\n            return;\n        }\n        stDate = calendarUtil.getYearLastDate(tempDate, ruleObject.interval);\n        dateCollection = [];\n    }\n}\n/**\n * Internal method to check yearly type\n *\n * @param {RecRule} ruleObject Accepts the recurrence rule object\n * @returns {YearRuleType} Returns the Yearly rule type object\n * @private\n */\nfunction checkYearlyType(ruleObject) {\n    if (ruleObject.yearDay.length) {\n        return 'YEARDAY';\n    }\n    else if (ruleObject.weekNo.length) {\n        return 'WEEKNO';\n    }\n    return 'MONTH';\n}\n/**\n * Internal method to initialize recurrence rule variables\n *\n * @param {Date} startDate Accepts the start date\n * @param {RecRule} ruleObject Accepts the recurrence rule object\n * @returns {RuleData} Return the rule data object\n * @private\n */\nfunction initializeRecRuleVariables(startDate, ruleObject) {\n    const ruleData = {\n        monthCollection: [],\n        index: 0,\n        tempDate: new Date(startDate.getTime()),\n        mainDate: new Date(startDate.getTime()),\n        expectedCount: getDateCount$1(startDate, ruleObject),\n        monthInit: 0,\n        dateCollection: []\n    };\n    if (ruleObject.month.length) {\n        calendarUtil.setMonth(ruleData.tempDate, ruleObject.month[0], ruleData.tempDate.getDate());\n    }\n    return ruleData;\n}\n/**\n * Internal method for process monthly date type recurrence rule\n *\n * @param {Date} startDate Accepts the strat date\n * @param {Date} endDate Accepts the end date\n * @param {number[]} data Accepts the collection of dates\n * @param {RecRule} ruleObject Accepts the recurrence rule object\n * @returns {void}\n * @private\n */\nfunction monthlyDateTypeProcess(startDate, endDate, data, ruleObject) {\n    if (ruleObject.month.length) {\n        monthlyDateTypeProcessforMonthFreq(startDate, endDate, data, ruleObject);\n        return;\n    }\n    const ruleData = initializeRecRuleVariables(startDate, ruleObject);\n    let currentMonthDate;\n    ruleData.tempDate = ruleData.mainDate = calendarUtil.getMonthStartDate(ruleData.tempDate);\n    while (compareDates(ruleData.tempDate, endDate)) {\n        currentMonthDate = new Date(ruleData.tempDate.getTime());\n        while (calendarUtil.isSameYear(currentMonthDate, ruleData.tempDate) &&\n            (ruleData.expectedCount && (data.length + ruleObject.recExceptionCount) <= ruleData.expectedCount)) {\n            if (ruleObject.month.length === 0 || (ruleObject.month.length > 0\n                && !calendarUtil.checkMonth(ruleData.tempDate, ruleObject.month))) {\n                processDateCollectionForByMonthDay(ruleObject, ruleData, endDate, false);\n                ruleData.beginDate = new Date(ruleData.tempDate.getTime());\n                ruleData.monthInit = setNextValidDate(ruleData.tempDate, ruleObject, ruleData.monthInit, ruleData.beginDate);\n            }\n            else {\n                calendarUtil.setValidDate(ruleData.tempDate, 1, 1);\n                ruleData.tempDate = getStartDateForWeek(ruleData.tempDate, ruleObject.day);\n                break;\n            }\n        }\n        ruleData.tempDate.setFullYear(currentMonthDate.getFullYear(), currentMonthDate.getMonth(), currentMonthDate.getDate());\n        insertDataCollection(ruleData.dateCollection, ruleData.state, startDate, endDate, data, ruleObject);\n        if (calendarUtil.isLastMonth(ruleData.tempDate)) {\n            calendarUtil.setValidDate(ruleData.tempDate, 1, 1);\n            ruleData.tempDate = getStartDateForWeek(ruleData.tempDate, ruleObject.day);\n        }\n        if (ruleData.expectedCount && (data.length + ruleObject.recExceptionCount) >= ruleData.expectedCount) {\n            return;\n        }\n        ruleData.tempDate.setFullYear(ruleData.tempDate.getFullYear() + ruleObject.interval - 1);\n        ruleData.tempDate = getStartDateForWeek(ruleData.tempDate, ruleObject.day);\n        ruleData.monthInit = setNextValidDate(ruleData.tempDate, ruleObject, ruleData.monthInit, ruleData.beginDate);\n        ruleData.dateCollection = [];\n    }\n}\n/**\n * Internal method for process monthly date type with month frequency from recurrence rule\n *\n * @param {Date} startDate Accepts the strat date\n * @param {Date} endDate Accepts the end date\n * @param {number[]} data Accepts the collection of dates\n * @param {RecRule} ruleObject Accepts the recurrence rule object\n * @returns {void}\n * @private\n */\nfunction monthlyDateTypeProcessforMonthFreq(startDate, endDate, data, ruleObject) {\n    const ruleData = initializeRecRuleVariables(startDate, ruleObject);\n    ruleData.tempDate = ruleData.mainDate = calendarUtil.getMonthStartDate(ruleData.tempDate);\n    if (((ruleObject.freq === 'MONTHLY' && ruleObject.interval === 12) || (ruleObject.freq === 'YEARLY')) &&\n        calendarUtil.getMonthDaysCount(startDate) < ruleObject.monthDay[0]) {\n        return;\n    }\n    while (compareDates(ruleData.tempDate, endDate)) {\n        ruleData.beginDate = new Date(ruleData.tempDate.getTime());\n        processDateCollectionForByMonthDay(ruleObject, ruleData, endDate, true, startDate, data);\n        if (!isNullOrUndefined(ruleObject.setPosition)) {\n            insertDatasIntoExistingCollection(ruleData.dateCollection, ruleData.state, startDate, endDate, data, ruleObject);\n        }\n        if (ruleData.expectedCount && (data.length + ruleObject.recExceptionCount) >= ruleData.expectedCount) {\n            return;\n        }\n        ruleData.monthInit = setNextValidDate(ruleData.tempDate, ruleObject, ruleData.monthInit, ruleData.beginDate);\n        ruleData.dateCollection = [];\n    }\n}\n/**\n * To process date collection for Monthly & Yearly based on BYMONTH Day property\n *\n * @param {RecRule} ruleObject Accepts the recurrence rule object\n * @param {RuleData} recRuleVariables Accepts the rule data\n * @param {Date} endDate Accepts the end date\n * @param {boolean} isByMonth Accepts the boolean to validate either month or not\n * @param {Date} startDate Accepts the start date\n * @param {number[]} data Accepts the collection of dates\n * @returns {void}\n * @private\n */\nfunction processDateCollectionForByMonthDay(ruleObject, recRuleVariables, endDate, isByMonth, startDate, data) {\n    for (let index = 0; index < ruleObject.monthDay.length; index++) {\n        recRuleVariables.date = ruleObject.monthDay[index];\n        recRuleVariables.tempDate = calendarUtil.getMonthStartDate(recRuleVariables.tempDate);\n        const maxDate = calendarUtil.getMonthDaysCount(recRuleVariables.tempDate);\n        recRuleVariables.date = recRuleVariables.date > 0 ? recRuleVariables.date : (maxDate + recRuleVariables.date + 1);\n        if (validateProperDate(recRuleVariables.tempDate, recRuleVariables.date, recRuleVariables.mainDate)\n            && (recRuleVariables.date > 0)) {\n            calendarUtil.setDate(recRuleVariables.tempDate, recRuleVariables.date);\n            if (endDate && recRuleVariables.tempDate > endDate) {\n                return;\n            }\n            if (ruleObject.day.length === 0 || ruleObject.day.indexOf(DAYINDEX[recRuleVariables.tempDate.getDay()]) > -1) {\n                if (isByMonth && isNullOrUndefined(ruleObject.setPosition) && (recRuleVariables.expectedCount\n                    && (data.length + ruleObject.recExceptionCount) < recRuleVariables.expectedCount)) {\n                    insertDateCollection(recRuleVariables.state, startDate, endDate, data, ruleObject, recRuleVariables.tempDate.getTime());\n                }\n                else {\n                    recRuleVariables.dateCollection.push([recRuleVariables.tempDate.getTime()]);\n                }\n            }\n        }\n    }\n}\n/**\n * Internal method to set next valid date\n *\n * @param {Date} tempDate Accepts the date\n * @param {RecRule} ruleObject Accepts the recurrence rule object\n * @param {number} monthInit Accepts the initial month\n * @param {Date} beginDate Accepts the initial date\n * @param {number} interval Accepts the interval duration\n * @returns {number} Returnx the next valid date\n * @private\n */\nfunction setNextValidDate(tempDate, ruleObject, monthInit, beginDate = null, interval) {\n    let monthData = beginDate ? beginDate.getMonth() : 0;\n    const startDate = calendarUtil.getMonthStartDate(tempDate);\n    interval = isNullOrUndefined(interval) ? ruleObject.interval : interval;\n    tempDate.setFullYear(startDate.getFullYear());\n    tempDate.setMonth(startDate.getMonth());\n    tempDate.setDate(startDate.getDate());\n    if (ruleObject.month.length) {\n        monthInit++;\n        monthInit = monthInit % ruleObject.month.length;\n        calendarUtil.setMonth(tempDate, ruleObject.month[monthInit], 1);\n        if (monthInit === 0) {\n            calendarUtil.addYears(tempDate, interval, ruleObject.month[0]);\n        }\n    }\n    else {\n        if (beginDate && (beginDate.getFullYear() < tempDate.getFullYear())) {\n            monthData = tempDate.getMonth() - 1;\n        }\n        calendarUtil.setValidDate(tempDate, interval, 1, monthData, beginDate);\n    }\n    return monthInit;\n}\n/**\n * To get month collection when BYDAY property having more than one value in list.\n *\n * @param {Date} startDate Accepts the strat date\n * @param {Date} endDate Accepts the end date\n * @param {number[]} data Accepts the collection of dates\n * @param {RecRule} ruleObject Accepts the recurrence rule object\n * @returns {void}\n * @private\n */\nfunction getMonthCollection(startDate, endDate, data, ruleObject) {\n    const expectedDays = ruleObject.day;\n    let tempDate = new Date(startDate.getTime());\n    tempDate = calendarUtil.getMonthStartDate(tempDate);\n    let monthCollection = [];\n    let dateCollection = [];\n    let dates = [];\n    let index;\n    let state;\n    const expectedCount = getDateCount$1(startDate, ruleObject);\n    let monthInit = 0;\n    let beginDate;\n    if (ruleObject.month.length) {\n        calendarUtil.setMonth(tempDate, ruleObject.month[0], 1);\n    }\n    tempDate = getStartDateForWeek(tempDate, ruleObject.day);\n    while (compareDates(tempDate, endDate)\n        && (expectedCount && (data.length + ruleObject.recExceptionCount) < expectedCount)) {\n        const currentMonthDate = new Date(tempDate.getTime());\n        const isHavingNumber = expectedDays.map((item) => HASNUMBER.test(item));\n        if (isHavingNumber.indexOf(true) > -1) {\n            for (let j = 0; j <= expectedDays.length - 1; j++) {\n                const expectedDaysArray = expectedDays[j].match(SPLITNUMBERANDSTRING);\n                const position = parseInt(expectedDaysArray[0], 10);\n                tempDate = new Date(tempDate.getTime());\n                tempDate = calendarUtil.getMonthStartDate(tempDate);\n                tempDate = getStartDateForWeek(tempDate, expectedDays);\n                currentMonthDate.setFullYear(tempDate.getFullYear(), tempDate.getMonth(), tempDate.getDate());\n                while (calendarUtil.isSameYear(currentMonthDate, tempDate) && calendarUtil.isSameMonth(currentMonthDate, tempDate)) {\n                    if (expectedDaysArray[expectedDaysArray.length - 1] === DAYINDEX[currentMonthDate.getDay()]) {\n                        monthCollection.push([currentMonthDate.getTime()]);\n                    }\n                    currentMonthDate.setDate(currentMonthDate.getDate() + (1));\n                }\n                currentMonthDate.setDate(currentMonthDate.getDate() - (1));\n                if (expectedDaysArray[0].indexOf('-') > -1) {\n                    index = monthCollection.length - (-1 * position);\n                }\n                else {\n                    index = position - 1;\n                }\n                index = isNaN(index) ? 0 : index;\n                if (monthCollection.length > 0) {\n                    if (isNullOrUndefined(ruleObject.setPosition)) {\n                        insertDatasIntoExistingCollection(monthCollection, state, startDate, endDate, data, ruleObject, index);\n                    }\n                    else {\n                        dateCollection = [(filterDateCollectionByIndex(monthCollection, index, dates))];\n                    }\n                }\n                if (expectedCount && (data.length + ruleObject.recExceptionCount) >= expectedCount) {\n                    return;\n                }\n                monthCollection = [];\n            }\n            if (!isNullOrUndefined(ruleObject.setPosition)) {\n                insertDateCollectionBasedonBySetPos(dateCollection, state, startDate, endDate, data, ruleObject);\n                dates = [];\n            }\n            monthInit = setNextValidDate(tempDate, ruleObject, monthInit, beginDate);\n            tempDate = getStartDateForWeek(tempDate, ruleObject.day);\n            monthCollection = [];\n        }\n        else {\n            let weekCollection = [];\n            const dayCycleData = processWeekDays(expectedDays);\n            currentMonthDate.setFullYear(tempDate.getFullYear(), tempDate.getMonth(), tempDate.getDate());\n            const initialDate = new Date(tempDate.getTime());\n            beginDate = new Date(tempDate.getTime());\n            while (calendarUtil.isSameMonth(initialDate, tempDate)) {\n                weekCollection.push(tempDate.getTime());\n                if (expectedDays.indexOf(DAYINDEX[tempDate.getDay()]) > -1) {\n                    monthCollection.push(weekCollection);\n                    weekCollection = [];\n                }\n                tempDate.setDate(tempDate.getDate()\n                    + dayCycleData[DAYINDEX[tempDate.getDay()]]);\n            }\n            index = ((ruleObject.setPosition < 1) ? (monthCollection.length + ruleObject.setPosition) : ruleObject.setPosition - 1);\n            if (isNullOrUndefined(ruleObject.setPosition)) {\n                index = 0;\n                const datas = [];\n                for (let week = 0; week < monthCollection.length; week++) {\n                    for (let row = 0; row < monthCollection[week].length; row++) {\n                        datas.push(monthCollection[week][row]);\n                    }\n                }\n                monthCollection = [datas];\n            }\n            if (monthCollection.length > 0) {\n                insertDatasIntoExistingCollection(monthCollection, state, startDate, endDate, data, ruleObject, index);\n            }\n            if (expectedCount && (data.length + ruleObject.recExceptionCount) >= expectedCount) {\n                return;\n            }\n            monthInit = setNextValidDate(tempDate, ruleObject, monthInit, beginDate);\n            tempDate = getStartDateForWeek(tempDate, ruleObject.day);\n            monthCollection = [];\n        }\n    }\n}\n/**\n * To process monday day type for FREQ=MONTHLY\n *\n * @param {Date} startDate Accepts the strat date\n * @param {Date} endDate Accepts the end date\n * @param {number[]} data Accepts the collection of dates\n * @param {RecRule} ruleObject Accepts the recurrence rule object\n * @returns {void}\n * @private\n */\nfunction monthlyDayTypeProcessforMonthFreq(startDate, endDate, data, ruleObject) {\n    const expectedDays = ruleObject.day;\n    // When BYDAY property having more than 1 value.\n    if (expectedDays.length > 1) {\n        getMonthCollection(startDate, endDate, data, ruleObject);\n        return;\n    }\n    let tempDate = new Date(startDate.getTime());\n    const expectedCount = getDateCount$1(startDate, ruleObject);\n    let monthCollection = [];\n    let beginDate;\n    let monthInit = 0;\n    tempDate = calendarUtil.getMonthStartDate(tempDate);\n    if (ruleObject.month.length) {\n        calendarUtil.setMonth(tempDate, ruleObject.month[0], 1);\n    }\n    tempDate = getStartDateForWeek(tempDate, ruleObject.day);\n    while (compareDates(tempDate, endDate) && (expectedCount && (data.length + ruleObject.recExceptionCount) < expectedCount)) {\n        beginDate = new Date(tempDate.getTime());\n        const currentMonthDate = new Date(tempDate.getTime());\n        while (calendarUtil.isSameMonth(tempDate, currentMonthDate)) {\n            monthCollection.push([currentMonthDate.getTime()]);\n            currentMonthDate.setDate(currentMonthDate.getDate() + (7));\n        }\n        // To filter date collection based on BYDAY Index, then BYSETPOS and to insert datas into existing collection\n        insertDateCollectionBasedonIndex(monthCollection, startDate, endDate, data, ruleObject);\n        monthInit = setNextValidDate(tempDate, ruleObject, monthInit, beginDate);\n        tempDate = getStartDateForWeek(tempDate, ruleObject.day);\n        monthCollection = [];\n    }\n}\n/**\n * To process monday day type for FREQ=YEARLY\n *\n * @param {Date} startDate Accepts the strat date\n * @param {Date} endDate Accepts the end date\n * @param {number[]} data Accepts the collection of dates\n * @param {RecRule} ruleObject Accepts the recurrence rule object\n * @returns {void}\n * @private\n */\nfunction monthlyDayTypeProcess(startDate, endDate, data, ruleObject) {\n    const expectedDays = ruleObject.day;\n    const isHavingNumber = expectedDays.map((item) => HASNUMBER.test(item));\n    // If BYDAY property having more than 1 value in list\n    if (expectedDays.length > 1 && isHavingNumber.indexOf(true) > -1) {\n        processDateCollectionforByDayWithInteger(startDate, endDate, data, ruleObject);\n        return;\n    }\n    else if (ruleObject.month.length && expectedDays.length === 1 && isHavingNumber.indexOf(true) > -1) {\n        monthlyDayTypeProcessforMonthFreq(startDate, endDate, data, ruleObject);\n        return;\n    }\n    let tempDate = new Date(startDate.getTime());\n    let currentMonthDate;\n    const expectedCount = getDateCount$1(startDate, ruleObject);\n    const interval = ruleObject.interval;\n    let monthCollection = [];\n    if (ruleObject.month.length) {\n        calendarUtil.setMonth(tempDate, ruleObject.month[0], tempDate.getDate());\n    }\n    // Set the date as start date of the yeear if yearly freq having ByDay property alone\n    if (isNullOrUndefined(ruleObject.setPosition) && ruleObject.month.length === 0 && ruleObject.weekNo.length === 0) {\n        tempDate.setFullYear(startDate.getFullYear(), 0, 1);\n    }\n    tempDate = calendarUtil.getMonthStartDate(tempDate);\n    tempDate = getStartDateForWeek(tempDate, ruleObject.day);\n    while (compareDates(tempDate, endDate)) {\n        currentMonthDate = new Date(tempDate.getTime());\n        while (calendarUtil.isSameYear(currentMonthDate, tempDate) &&\n            (expectedCount && (data.length + ruleObject.recExceptionCount) <= expectedCount)) {\n            currentMonthDate = new Date(tempDate.getTime());\n            while (calendarUtil.isSameYear(currentMonthDate, tempDate)) {\n                if (ruleObject.month.length === 0 || (ruleObject.month.length > 0\n                    && !calendarUtil.checkMonth(tempDate, ruleObject.month))) {\n                    if (expectedDays.length > 1) {\n                        if (calendarUtil.compareMonth(currentMonthDate, tempDate)) {\n                            calendarUtil.setValidDate(tempDate, 1, 1);\n                            tempDate = getStartDateForWeek(tempDate, ruleObject.day);\n                            break;\n                        }\n                        if (expectedDays.indexOf(DAYINDEX[currentMonthDate.getDay()]) > -1) {\n                            monthCollection.push([currentMonthDate.getTime()]);\n                        }\n                        currentMonthDate.setDate(currentMonthDate.getDate() + (1));\n                    }\n                    else {\n                        // If BYDAY property having 1 value in list\n                        if (currentMonthDate.getFullYear() > tempDate.getFullYear()) {\n                            calendarUtil.setValidDate(tempDate, 1, 1);\n                            tempDate = getStartDateForWeek(tempDate, ruleObject.day);\n                            break;\n                        }\n                        const newstr = getDayString(expectedDays[0]);\n                        if (DAYINDEX[currentMonthDate.getDay()] === newstr\n                            && new Date(currentMonthDate.getFullYear(), currentMonthDate.getMonth(), 0)\n                                > new Date(startDate.getFullYear())) {\n                            monthCollection.push([currentMonthDate.getTime()]);\n                        }\n                        currentMonthDate.setDate(currentMonthDate.getDate() + (7));\n                    }\n                }\n                else {\n                    calendarUtil.setValidDate(tempDate, 1, 1);\n                    tempDate = getStartDateForWeek(tempDate, ruleObject.day);\n                    break;\n                }\n            }\n        }\n        tempDate.setFullYear(currentMonthDate.getFullYear(), currentMonthDate.getMonth(), currentMonthDate.getDate());\n        // To filter date collection based on BYDAY Index, then BYSETPOS and to insert datas into existing collection\n        insertDateCollectionBasedonIndex(monthCollection, startDate, endDate, data, ruleObject);\n        if (calendarUtil.isLastMonth(tempDate)) {\n            calendarUtil.setValidDate(tempDate, 1, 1);\n            tempDate = getStartDateForWeek(tempDate, ruleObject.day);\n        }\n        tempDate.setFullYear(tempDate.getFullYear() + interval - 1);\n        if (expectedCount && (data.length + ruleObject.recExceptionCount) >= expectedCount) {\n            return;\n        }\n        tempDate = getStartDateForWeek(tempDate, ruleObject.day);\n        monthCollection = [];\n    }\n}\n/**\n * To process the recurrence rule when BYDAY property having values with integer\n *\n * @param {Date} startDate Accepts the strat date\n * @param {Date} endDate Accepts the end date\n * @param {number[]} data Accepts the collection of dates\n * @param {RecRule} ruleObject Accepts the recurrence rule object\n * @returns {void}\n * @private\n */\nfunction processDateCollectionforByDayWithInteger(startDate, endDate, data, ruleObject) {\n    const expectedDays = ruleObject.day;\n    const expectedCount = getDateCount$1(startDate, ruleObject);\n    let tempDate = new Date(startDate.getTime());\n    const interval = ruleObject.interval;\n    let monthCollection = [];\n    let dateCollection = [];\n    let index;\n    let state;\n    let monthInit = 0;\n    let currentMonthDate;\n    let currentDate;\n    let beginDate;\n    tempDate = calendarUtil.getMonthStartDate(tempDate);\n    let datas = [];\n    if (ruleObject.month.length) {\n        calendarUtil.setMonth(tempDate, ruleObject.month[0], 1);\n    }\n    tempDate = getStartDateForWeek(tempDate, ruleObject.day);\n    while (compareDates(tempDate, endDate)) {\n        currentMonthDate = new Date(tempDate.getTime());\n        for (let i = 0; i <= ruleObject.month.length; i++) {\n            for (let j = 0; j <= expectedDays.length - 1; j++) {\n                tempDate = calendarUtil.getMonthStartDate(tempDate);\n                tempDate = getStartDateForWeek(tempDate, ruleObject.day);\n                monthCollection = [];\n                while (calendarUtil.isSameYear(currentMonthDate, tempDate) &&\n                    (expectedCount && (data.length + ruleObject.recExceptionCount) <= expectedCount)) {\n                    while (calendarUtil.isSameYear(currentMonthDate, tempDate)) {\n                        currentMonthDate = new Date(tempDate.getTime());\n                        if (ruleObject.month.length === 0 ||\n                            (ruleObject.month.length > 0 && ruleObject.month[i] === calendarUtil.getMonth(currentMonthDate))) {\n                            const expectedDaysArray = expectedDays[j].match(SPLITNUMBERANDSTRING);\n                            const position = parseInt(expectedDaysArray[0], 10);\n                            currentDate = new Date(tempDate.getTime());\n                            while (calendarUtil.isSameYear(currentDate, tempDate)\n                                && calendarUtil.isSameMonth(currentDate, tempDate)) {\n                                if (expectedDaysArray[expectedDaysArray.length - 1] === DAYINDEX[currentDate.getDay()]) {\n                                    monthCollection.push([currentDate.getTime()]);\n                                }\n                                currentDate.setDate(currentDate.getDate() + (1));\n                            }\n                            currentDate.setDate(currentDate.getDate() - (1));\n                            if (expectedDaysArray[0].indexOf('-') > -1) {\n                                index = monthCollection.length - (-1 * position);\n                            }\n                            else {\n                                index = position - 1;\n                            }\n                            index = isNaN(index) ? 0 : index;\n                        }\n                        monthInit = setNextValidDate(tempDate, ruleObject, monthInit, beginDate, 1);\n                        tempDate = getStartDateForWeek(tempDate, ruleObject.day);\n                    }\n                }\n                tempDate = j === 0 && currentDate ? new Date(currentDate.getTime()) : new Date(currentMonthDate.getTime());\n                if (monthCollection.length > 0) {\n                    if (isNullOrUndefined(ruleObject.setPosition)) {\n                        insertDatasIntoExistingCollection(monthCollection, state, startDate, endDate, data, ruleObject, index);\n                    }\n                    else {\n                        dateCollection = [(filterDateCollectionByIndex(monthCollection, index, datas))];\n                    }\n                }\n                if (expectedCount && (data.length + ruleObject.recExceptionCount) >= expectedCount) {\n                    return;\n                }\n            }\n        }\n        if (!isNullOrUndefined(ruleObject.setPosition)) {\n            insertDateCollectionBasedonBySetPos(dateCollection, state, startDate, endDate, data, ruleObject);\n            datas = [];\n        }\n        if (calendarUtil.isLastMonth(tempDate)) {\n            calendarUtil.setValidDate(tempDate, 1, 1);\n            tempDate.setFullYear(tempDate.getFullYear() + interval - 1);\n        }\n        else {\n            tempDate.setFullYear(tempDate.getFullYear() + interval);\n        }\n        tempDate = getStartDateForWeek(tempDate, ruleObject.day);\n        if (ruleObject.month.length) {\n            calendarUtil.setMonth(tempDate, ruleObject.month[0], tempDate.getDate());\n        }\n    }\n}\n/**\n * To get recurrence collection if BYSETPOS is null\n *\n * @param {number[]} monthCollection Accepts the month collection dates\n * @param {string[]} expectedDays Accepts the exception dates\n * @returns {RuleData} Returns the rule data object\n * @private\n */\nfunction getRecurrenceCollection(monthCollection, expectedDays) {\n    let index;\n    const recurrenceCollectionObject = { monthCollection: [], index: 0 };\n    if (expectedDays.length === 1) {\n        // To split numeric value from BYDAY property value\n        const expectedDaysArrays = expectedDays[0].match(SPLITNUMBERANDSTRING);\n        let arrPosition;\n        if (expectedDaysArrays.length > 1) {\n            arrPosition = parseInt(expectedDaysArrays[0], 10);\n            index = ((arrPosition < 1) ? (monthCollection.length + arrPosition) : arrPosition - 1);\n        }\n        else {\n            index = 0;\n            monthCollection = getDateCollectionforBySetPosNull(monthCollection);\n        }\n    }\n    else {\n        index = 0;\n        monthCollection = getDateCollectionforBySetPosNull(monthCollection);\n    }\n    recurrenceCollectionObject.monthCollection = monthCollection;\n    recurrenceCollectionObject.index = index;\n    return recurrenceCollectionObject;\n}\n/**\n * Internal method to process the data collections\n *\n * @param {number[]} dateCollection Accepts the date collections\n * @param {boolean} state Accepts the state\n * @param {Date} startDate Accepts the start date\n * @param {Date} endDate Accepts the end date\n * @param {number[]} data Accepts the collection of numbers\n * @param {RecRule} ruleObject Accepts the recurrence rule object\n * @returns {void}\n * @private\n */\nfunction insertDataCollection(dateCollection, state, startDate, endDate, data, ruleObject) {\n    let index = ((ruleObject.setPosition < 1) ?\n        (dateCollection.length + ruleObject.setPosition) : ruleObject.setPosition - 1);\n    if (isNullOrUndefined(ruleObject.setPosition)) {\n        index = 0;\n        dateCollection = getDateCollectionforBySetPosNull(dateCollection);\n    }\n    if (dateCollection.length > 0) {\n        insertDatasIntoExistingCollection(dateCollection, state, startDate, endDate, data, ruleObject, index);\n    }\n}\n/**\n * To process month collection if BYSETPOS is null\n *\n * @param {number[]} monthCollection Accepts the month date collections\n * @returns {number[]} Returns the month date collections\n * @private\n */\nfunction getDateCollectionforBySetPosNull(monthCollection) {\n    const datas = [];\n    for (let week = 0; week < monthCollection.length; week++) {\n        for (let row = 0; row < monthCollection[week].length; row++) {\n            datas.push(new Date(monthCollection[week][row]).getTime());\n        }\n    }\n    monthCollection = datas.length > 0 ? [datas] : [];\n    return monthCollection;\n}\n/**\n * To filter date collection based on BYDAY Index, then BYSETPOS and to insert datas into existing collection\n *\n * @param {number[]} monthCollection Accepts the month date collections\n * @param {Date} startDate Accepts the start date\n * @param {Date} endDate Accepts the end date\n * @param {number[]} data Accepts the date collections\n * @param {RecRule} ruleObject Accepts the recurrence rule object\n * @returns {void}\n * @private\n */\nfunction insertDateCollectionBasedonIndex(monthCollection, startDate, endDate, data, ruleObject) {\n    const expectedDays = ruleObject.day;\n    let state;\n    let datas = [];\n    let dateCollection = [];\n    const recurrenceCollections = getRecurrenceCollection(monthCollection, expectedDays);\n    monthCollection = recurrenceCollections.monthCollection;\n    const index = recurrenceCollections.index;\n    if (ruleObject.setPosition != null) {\n        dateCollection = [(filterDateCollectionByIndex(monthCollection, index, datas))];\n        insertDateCollectionBasedonBySetPos(dateCollection, state, startDate, endDate, data, ruleObject);\n    }\n    else {\n        if (monthCollection.length > 0) {\n            insertDatasIntoExistingCollection(monthCollection, state, startDate, endDate, data, ruleObject, index);\n        }\n    }\n    datas = [];\n}\n/**\n * To filter date collection when BYDAY property having values with number\n *\n * @param {number[]} monthCollection Accepts the date collections\n * @param {number} index Accepts the index of date collections\n * @param {number[]} datas Accepts the collection of dates\n * @returns {number[]} Returns the collection of dates\n * @private\n */\nfunction filterDateCollectionByIndex(monthCollection, index, datas) {\n    for (let week = 0; week < monthCollection[index].length; week++) {\n        datas.push(monthCollection[index][week]);\n    }\n    return datas;\n}\n/**\n * To insert processed date collection in final array element\n *\n * @param {boolean} state Accepts the state of the recurrence rule\n * @param {Date} startDate Accepts the start date\n * @param {Date} endDate Accepts the end date\n * @param {number[]} data Accepts the collection of date\n * @param {RecRule} ruleObject Accepts the recurrence rule object\n * @param {number} dayData Accepts the date index\n * @returns {void}\n * @private\n */\nfunction insertDateCollection(state, startDate, endDate, data, ruleObject, dayData) {\n    const expectedCount = getDateCount$1(startDate, ruleObject);\n    const chDate = new Date(dayData);\n    state = validateRules(chDate, ruleObject);\n    if ((chDate >= startDate) && compareDates(chDate, endDate) && state\n        && expectedCount && (data.length + ruleObject.recExceptionCount) < expectedCount) {\n        excludeDateHandler(data, dayData);\n    }\n}\n/**\n * Return the last week number of given month and year.\n *\n * @param {number} year Accepts the Year in number format\n * @param {number} startDayOfWeek Accepts the start date\n * @param {number[]} monthCollection Accepts the collection of dates\n * @param {number} week Accepts the week in number format\n * @param {RecRule} ruleObject Accepts the recurrence rule object\n * @returns {number} returns week number\n * @private\n */\nfunction weekCount(year, startDayOfWeek, monthCollection, week, ruleObject) {\n    const firstDayOfWeek = startDayOfWeek || 0;\n    const firstOfMonth = new Date(year, ruleObject.month[0] - 1, 1);\n    const lastOfMonth = new Date(year, ruleObject.month[0], 0);\n    const numberOfDaysInMonth = lastOfMonth.getDate();\n    const firstWeekDay = (firstOfMonth.getDay() - firstDayOfWeek + 7) % 7;\n    const used = firstWeekDay + numberOfDaysInMonth;\n    const count = Math.ceil(used / 7) - 1;\n    const dayData = monthCollection[week][count];\n    const chDate = new Date(dayData);\n    const state = validateRules(chDate, ruleObject);\n    return (state) ? count : count - 1;\n}\n/**\n * To process date collection based on Byset position after process the collection based on BYDAY property value index: EX:BYDAY=1SUm-1SU\n *\n * @param {number[]} monthCollection Accepts the collection of dates\n * @param {boolean} state Accepts the state of the recurrence rule\n * @param {Date} startDate Accepts the start date\n * @param {Date} endDate Accepts the end date\n * @param {number[]} data Accepts the collection of date\n * @param {RecRule} ruleObject Accepts the recurrence rule object\n * @returns {void}\n * @private\n */\nfunction insertDateCollectionBasedonBySetPos(monthCollection, state, startDate, endDate, data, ruleObject) {\n    if (monthCollection.length > 0) {\n        for (let week = 0; week < monthCollection.length; week++) {\n            monthCollection[week].sort();\n            const expectedDays = ruleObject.day;\n            const isHavingNumber = expectedDays.map((item) => HASNUMBER.test(item));\n            const weekIndex = (ruleObject.freq === 'YEARLY' && (ruleObject.validRules.indexOf('BYMONTH') > -1) &&\n                !(isHavingNumber.indexOf(true) > -1)) ?\n                weekCount(new Date(monthCollection[0][0]).getFullYear(), 0, monthCollection, week, ruleObject)\n                : (monthCollection[week].length + ruleObject.setPosition);\n            const index = ((ruleObject.setPosition < 1) ? weekIndex : ruleObject.setPosition - 1);\n            const dayData = monthCollection[week][index];\n            insertDateCollection(state, startDate, endDate, data, ruleObject, dayData);\n        }\n    }\n}\n/**\n * To insert datas into existing collection which is processed from previous loop.\n *\n * @param {number[]} monthCollection Accepts the collection of dates\n * @param {boolean} state Accepts the state of the recurrence rule\n * @param {Date} startDate Accepts the start date\n * @param {Date} endDate Accepts the end date\n * @param {number[]} data Accepts the collection of date\n * @param {RecRule} ruleObject Accepts the recurrence rule object\n * @param {number} index Accepts the index value\n * @returns {void}\n * @private\n */\nfunction insertDatasIntoExistingCollection(monthCollection, state, startDate, endDate, data, ruleObject, index) {\n    if (monthCollection.length > 0) {\n        index = !isNullOrUndefined(index) ? index :\n            ((ruleObject.setPosition < 1)\n                ? (monthCollection.length + ruleObject.setPosition) : ruleObject.setPosition - 1);\n        monthCollection[index].sort();\n        for (let week = 0; week < monthCollection[index].length; week++) {\n            const dayData = monthCollection[index][week];\n            insertDateCollection(state, startDate, endDate, data, ruleObject, dayData);\n        }\n    }\n}\n/**\n * Internal method to compare dates\n *\n * @param {Date} startDate Accepts the start date\n * @param {Date} endDate Accepts the end date\n * @returns {boolean} Returns the result of checking start and end dates\n * @private\n */\nfunction compareDates(startDate, endDate) {\n    return endDate ? (startDate <= endDate) : true;\n}\n/**\n * Internal method to get day string\n *\n * @param {string} expectedDays Accepts the exception date string\n * @returns {string} Returns the valid string\n * @private\n */\nfunction getDayString(expectedDays) {\n    // To get BYDAY value without numeric value\n    const newstr = expectedDays.replace(REMOVENUMBERINSTRING, '');\n    return newstr;\n}\n/**\n * Internal method to check day index\n *\n * @param {number} day Accepts the day index\n * @param {string[]} expectedDays Accepts the exception dates\n * @returns {boolean} Returns the index date\n * @private\n */\nfunction checkDayIndex(day, expectedDays) {\n    const sortedExpectedDays = [];\n    expectedDays.forEach((element) => {\n        const expectedDaysNumberSplit = element.match(SPLITNUMBERANDSTRING);\n        if (expectedDaysNumberSplit.length === 2) {\n            sortedExpectedDays.push(expectedDaysNumberSplit[1]);\n        }\n        else {\n            sortedExpectedDays.push(expectedDaysNumberSplit[0]);\n        }\n    });\n    return (sortedExpectedDays.indexOf(DAYINDEX[day]) === -1);\n}\n/**\n * Internal method to get start date of week\n *\n * @param {Date} startDate Accepts the start date\n * @param {string[]} expectedDays Accepts the exception dates\n * @returns {Date} Return the week start date\n * @private\n */\nfunction getStartDateForWeek(startDate, expectedDays) {\n    const tempDate = new Date(startDate.getTime());\n    let newstr;\n    if (expectedDays.length > 0) {\n        const expectedDaysArr = [];\n        for (let i = 0; i <= expectedDays.length - 1; i++) {\n            newstr = getDayString(expectedDays[i]);\n            expectedDaysArr.push(newstr);\n        }\n        if (expectedDaysArr.indexOf(DAYINDEX[tempDate.getDay()]) === -1) {\n            do {\n                tempDate.setDate(tempDate.getDate() + 1);\n            } while (expectedDaysArr.indexOf(DAYINDEX[tempDate.getDay()]) === -1);\n        }\n    }\n    return tempDate;\n}\n/**\n * Method to generate recurrence rule object from given rule\n *\n * @param {string} rules Accepts the recurrence rule\n * @returns {RecRule} Returns the recurrence rule object\n */\nfunction extractObjectFromRule(rules) {\n    const ruleObject = {\n        freq: null,\n        interval: 1,\n        count: null,\n        until: null,\n        day: [],\n        wkst: null,\n        month: [],\n        weekNo: [],\n        monthDay: [],\n        yearDay: [],\n        setPosition: null,\n        validRules: []\n    };\n    const rulesList = rules.split(';');\n    let splitData = [];\n    let temp;\n    rulesList.forEach((data) => {\n        splitData = data.split('=');\n        switch (splitData[0]) {\n            case 'UNTIL':\n                temp = splitData[1];\n                ruleObject.until = getDateFromRecurrenceDateString(temp);\n                break;\n            case 'BYDAY':\n                ruleObject.day = splitData[1].split(',');\n                ruleObject.validRules.push(splitData[0]);\n                break;\n            case 'BYMONTHDAY':\n                ruleObject.monthDay = splitData[1].split(',').map(Number);\n                ruleObject.validRules.push(splitData[0]);\n                break;\n            case 'BYMONTH':\n                ruleObject.month = splitData[1].split(',').map(Number);\n                ruleObject.validRules.push(splitData[0]);\n                break;\n            case 'BYYEARDAY':\n                ruleObject.yearDay = splitData[1].split(',').map(Number);\n                ruleObject.validRules.push(splitData[0]);\n                break;\n            case 'BYWEEKNO':\n                ruleObject.weekNo = splitData[1].split(',').map(Number);\n                ruleObject.validRules.push(splitData[0]);\n                break;\n            case 'INTERVAL':\n                ruleObject.interval = parseInt(splitData[1], 10);\n                break;\n            case 'COUNT':\n                ruleObject.count = parseInt(splitData[1], 10);\n                break;\n            case 'BYSETPOS':\n                ruleObject.setPosition = parseInt(splitData[1], 10) > 4 ? -1 : parseInt(splitData[1], 10);\n                break;\n            case 'FREQ':\n                ruleObject.freq = splitData[1];\n                break;\n            case 'WKST':\n                ruleObject.wkst = splitData[1];\n                break;\n        }\n    });\n    if ((ruleObject.freq === 'MONTHLY') && (ruleObject.monthDay.length === 0)) {\n        const index = ruleObject.validRules.indexOf('BYDAY');\n        ruleObject.validRules.splice(index, 1);\n    }\n    return ruleObject;\n}\n/**\n * Internal method to validate proper date\n *\n * @param {Date} tempDate Accepts the date value\n * @param {number} data Accepts the data value\n * @param {Date} startDate Accepts the start date\n * @returns {boolean} Returns the result of date validate\n * @private\n */\nfunction validateProperDate(tempDate, data, startDate) {\n    const maxDate = calendarUtil.getMonthDaysCount(tempDate);\n    return (data <= maxDate) && (tempDate >= startDate);\n}\n/**\n * Internal method to process week days\n *\n * @param {string[]} expectedDays Accepts the expection dates\n * @returns {Object} Returns the weekdays object\n * @private\n */\nfunction processWeekDays(expectedDays) {\n    const dayCycle = {};\n    expectedDays.forEach((element, index) => {\n        if (index === expectedDays.length - 1) {\n            const startIndex = dayIndex.indexOf(element);\n            let temp = startIndex;\n            while (temp % 7 !== dayIndex.indexOf(expectedDays[0])) {\n                temp++;\n            }\n            dayCycle[element] = temp - startIndex;\n        }\n        else {\n            dayCycle[element] = dayIndex.indexOf(expectedDays[(index + 1)]) - dayIndex.indexOf(element);\n        }\n    });\n    return dayCycle;\n}\n/**\n * Internal method to check date\n *\n * @param {Date} tempDate Accepts the date value\n * @param {number[]} expectedDate Accepts the exception dates\n * @returns {boolean} Returns the boolean value\n * @private\n */\nfunction checkDate(tempDate, expectedDate) {\n    const temp = expectedDate.slice(0);\n    let data;\n    const maxDate = calendarUtil.getMonthDaysCount(tempDate);\n    data = temp.shift();\n    while (data) {\n        if (data < 0) {\n            data = data + maxDate + 1;\n        }\n        if (data === tempDate.getDate()) {\n            return false;\n        }\n        data = temp.shift();\n    }\n    return true;\n}\n/**\n * Internal method to check the year value\n *\n * @param {Date} tempDate Accepts the date value\n * @param {number[]} expectedyearDay Accepts the exception dates in year\n * @returns {boolean} Returns the boolean value\n * @private\n */\nfunction checkYear(tempDate, expectedyearDay) {\n    const temp = expectedyearDay.slice(0);\n    let data;\n    const yearDay = getYearDay(tempDate);\n    data = temp.shift();\n    while (data) {\n        if (data < 0) {\n            data = data + calendarUtil.getYearDaysCount(tempDate, 0) + 1;\n        }\n        if (data === yearDay) {\n            return false;\n        }\n        data = temp.shift();\n    }\n    return true;\n}\n/**\n * Internal method to get the year day\n *\n * @param {Date} currentDate Accepts the date value\n * @returns {number} Returns the boolean value\n * @private\n */\nfunction getYearDay(currentDate) {\n    if (!startDateCollection[calendarUtil.getFullYear(currentDate)]) {\n        startDateCollection[calendarUtil.getFullYear(currentDate)] = calendarUtil.getYearLastDate(currentDate, 0);\n    }\n    const tempDate = startDateCollection[calendarUtil.getFullYear(currentDate)];\n    const diff = currentDate.getTime() - tempDate.getTime();\n    return Math.ceil(diff / MS_PER_DAY);\n}\n/**\n * Internal method to validate monthly rule type\n *\n * @param {RecRule} ruleObject Accepts the recurrence rule object\n * @returns {MonthlyType} Returns the monthly type object\n * @private\n */\nfunction validateMonthlyRuleType(ruleObject) {\n    if (ruleObject.monthDay.length && !ruleObject.day.length) {\n        return 'date';\n    }\n    else if (!ruleObject.monthDay.length && ruleObject.day.length) {\n        return 'day';\n    }\n    return 'both';\n}\n/**\n * Internal method to re-order the week days based on first day of week\n *\n * @param {string[]} days Accepts the week days value\n * @returns {void}\n * @private\n */\nfunction rotate(days) {\n    const data = days.shift();\n    days.push(data);\n}\n/**\n * Internal method to set first day of week\n *\n * @param {string} day Accepts the first day string\n * @returns {void}\n * @private\n */\nfunction setFirstDayOfWeek(day) {\n    while (dayIndex[0] !== day) {\n        rotate(dayIndex);\n    }\n}\n/**\n * Internal method to validate recurrence rule\n *\n * @param {Date} tempDate Accepts the date value\n * @param {RecRule} ruleObject Accepts the recurrence rule object\n * @returns {boolean} Returns the boolean value\n * @private\n */\nfunction validateRules(tempDate, ruleObject) {\n    let state = true;\n    const expectedDays = ruleObject.day;\n    const expectedMonth = ruleObject.month;\n    const expectedDate = calendarUtil.getExpectedDays(tempDate, ruleObject.monthDay);\n    const expectedyearDay = ruleObject.yearDay;\n    ruleObject.validRules.forEach((rule) => {\n        switch (rule) {\n            case 'BYDAY':\n                if (checkDayIndex(tempDate.getDay(), expectedDays)) {\n                    state = false;\n                }\n                break;\n            case 'BYMONTH':\n                if (calendarUtil.checkMonth(tempDate, expectedMonth)) {\n                    state = false;\n                }\n                break;\n            case 'BYMONTHDAY':\n                if (checkDate(tempDate, expectedDate)) {\n                    state = false;\n                }\n                break;\n            case 'BYYEARDAY':\n                if (checkYear(tempDate, expectedyearDay)) {\n                    state = false;\n                }\n                break;\n        }\n    });\n    return state;\n}\n/**\n * Internal method to get calendar util\n *\n * @param {CalendarType} calendarMode Accepts the calendar type object\n * @returns {CalendarUtil} Returns the calendar util object\n * @private\n */\nfunction getCalendarUtil(calendarMode) {\n    if (calendarMode === 'Islamic') {\n        return new Islamic();\n    }\n    return new Gregorian();\n}\nconst startDateCollection = {};\nlet tempExcludeDate;\nconst dayIndex = ['SU', 'MO', 'TU', 'WE', 'TH', 'FR', 'SA'];\nlet maxOccurrence;\nlet tempViewDate;\nlet calendarUtil;\nconst DAYINDEX = ['SU', 'MO', 'TU', 'WE', 'TH', 'FR', 'SA'];\nconst MAXOCCURRENCE = 43;\nconst WEEKPOS = ['first', 'second', 'third', 'fourth', 'last'];\nconst TIMES = 'summaryTimes';\nconst ON = 'summaryOn';\nconst EVERY = 'every';\nconst UNTIL = 'summaryUntil';\nconst DAYS = 'summaryDay';\nconst WEEKS = 'summaryWeek';\nconst MONTHS = 'summaryMonth';\nconst YEARS = 'summaryYear';\nconst DAYINDEXOBJECT = {\n    SU: 'sun',\n    MO: 'mon',\n    TU: 'tue',\n    WE: 'wed',\n    TH: 'thu',\n    FR: 'fri',\n    SA: 'sat'\n};\n// To check string has number\nconst HASNUMBER = /\\d/;\n// To find the numbers in string\nconst REMOVENUMBERINSTRING = /[^A-Z]+/;\n// To split number and string\nconst SPLITNUMBERANDSTRING = /[a-z]+|[^a-z]+/gi;\n/**\n * Method to generate string from date\n *\n * @param {Date} date Accepts the date value\n * @returns {string} Returns the string value\n */\nfunction getRecurrenceStringFromDate(date) {\n    return [date.getUTCFullYear(),\n        roundDateValues(date.getUTCMonth() + 1),\n        roundDateValues(date.getUTCDate()),\n        'T',\n        roundDateValues(date.getUTCHours()),\n        roundDateValues(date.getUTCMinutes()),\n        roundDateValues(date.getUTCSeconds()),\n        'Z'].join('');\n}\n/**\n * Internal method to round the date values\n *\n * @param {string | number} date Accepts the date value in either string or number format\n * @returns {string} Returns the date value in string format\n * @private\n */\nfunction roundDateValues(date) {\n    return ('0' + date).slice(-2);\n}\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\n/* eslint-disable max-len */\n/**\n * EventBase for appointment rendering\n */\nclass EventBase {\n    /**\n     * Constructor for EventBase\n     *\n     * @param {Schedule} parent Accepts the schedule instance\n     */\n    constructor(parent) {\n        this.slots = [];\n        this.isDoubleTapped = false;\n        this.parent = parent;\n    }\n    processData(events, timeZonePropChanged, oldTimezone) {\n        const start = this.parent.activeView.startDate();\n        const end = this.parent.activeView.endDate();\n        const fields = this.parent.eventFields;\n        let processed = [];\n        let temp = 1;\n        let generateID = false;\n        const resourceCollection = this.parent.resourceBase ? this.parent.resourceBase.resourceCollection : [];\n        if (events.length > 0 && isNullOrUndefined(events[0][fields.id])) {\n            generateID = true;\n        }\n        for (let event of events) {\n            if (generateID) {\n                event[fields.id] = temp++;\n            }\n            event = this.updateEventDateTime(event);\n            if (timeZonePropChanged) {\n                this.processTimezoneChange(event, oldTimezone);\n            }\n            else if (!this.parent.isPrinting && !this.parent.uiStateValues.isResize) {\n                event = this.processTimezone(event);\n            }\n            for (let level = 0; level < resourceCollection.length; level++) {\n                if (event[resourceCollection[level].field] === null || event[resourceCollection[level].field] === 0) {\n                    event[resourceCollection[level].field] = undefined;\n                }\n            }\n            if (!isNullOrUndefined(event[fields.recurrenceRule]) && event[fields.recurrenceRule] === '') {\n                event[fields.recurrenceRule] = null;\n            }\n            if (!isNullOrUndefined(event[fields.recurrenceRule]) && isNullOrUndefined(event[fields.recurrenceID]) &&\n                !(this.parent.crudModule && this.parent.crudModule.crudObj.isCrudAction)) {\n                processed = processed.concat(this.generateOccurrence(event, null, oldTimezone, true));\n            }\n            else {\n                if (this.parent.crudModule && this.parent.crudModule.crudObj.isCrudAction) {\n                    if (!isNullOrUndefined(event[fields.recurrenceRule]) && isNullOrUndefined(event[fields.recurrenceID])) {\n                        const recurrenceEvent = this.generateOccurrence(event, null, oldTimezone, true);\n                        for (const occurrence of recurrenceEvent) {\n                            const app = this.parent.eventsProcessed.filter((data) => data[fields.startTime].getTime() - occurrence[fields.startTime].getTime() === 0 &&\n                                data[fields.id] === occurrence[fields.id]);\n                            occurrence.Guid = (app.length > 0) ? app[0].Guid : this.generateGuid();\n                            processed.push(occurrence);\n                        }\n                    }\n                    else {\n                        const app = this.parent.eventsProcessed.filter((data) => data[this.parent.eventFields.id] === event[this.parent.eventFields.id]);\n                        event.Guid = (app.length > 0) ? app[0].Guid : this.generateGuid();\n                        processed.push(event);\n                    }\n                }\n                else {\n                    event.Guid = this.generateGuid();\n                    processed.push(event);\n                }\n            }\n        }\n        this.parent.eventsProcessed = [];\n        const eventData = processed.filter((data) => !data[this.parent.eventFields.isBlock]);\n        this.parent.eventsProcessed = this.filterEvents(start, end, eventData);\n        const blockData = processed.filter((data) => data[this.parent.eventFields.isBlock]);\n        for (const eventObj of blockData) {\n            if (eventObj[fields.isAllDay]) {\n                const isDifferentDate = resetTime(new Date(eventObj[fields.startTime].getTime())) <\n                    resetTime(new Date(eventObj[fields.endTime].getTime()));\n                if (!isDifferentDate) {\n                    eventObj[fields.startTime] = resetTime(eventObj[fields.startTime]);\n                    eventObj[fields.endTime] = addDays(resetTime(eventObj[fields.endTime]), 1);\n                }\n            }\n        }\n        this.parent.blockProcessed = blockData;\n        return eventData;\n    }\n    updateEventDateTime(eventData) {\n        if (typeof eventData[this.parent.eventFields.startTime] === 'string') {\n            eventData[this.parent.eventFields.startTime] = getDateFromString(eventData[this.parent.eventFields.startTime]);\n        }\n        if (typeof eventData[this.parent.eventFields.endTime] === 'string') {\n            eventData[this.parent.eventFields.endTime] = getDateFromString(eventData[this.parent.eventFields.endTime]);\n        }\n        return eventData;\n    }\n    getProcessedEvents(eventCollection = this.parent.eventsData) {\n        let processed = [];\n        for (const event of eventCollection) {\n            if (!isNullOrUndefined(event[this.parent.eventFields.recurrenceRule]) &&\n                isNullOrUndefined(event[this.parent.eventFields.recurrenceID])) {\n                processed = processed.concat(this.generateOccurrence(event));\n            }\n            else {\n                processed.push(event);\n            }\n        }\n        return processed;\n    }\n    timezonePropertyChange(oldTimezone) {\n        const data = this.parent.eventsData.concat(this.parent.blockData);\n        const processed = this.processData(data, true, oldTimezone);\n        this.parent.notify(dataReady, { processedData: processed });\n    }\n    timezoneConvert(eventData) {\n        const fields = this.parent.eventFields;\n        eventData[fields.startTimezone] = eventData[fields.startTimezone] || eventData[fields.endTimezone];\n        eventData[fields.endTimezone] = eventData[fields.endTimezone] || eventData[fields.startTimezone];\n        if (this.parent.timezone) {\n            const startTz = eventData[fields.startTimezone];\n            const endTz = eventData[fields.endTimezone];\n            eventData[fields.startTime] = this.parent.tzModule.convert(eventData[fields.startTime], this.parent.timezone, startTz);\n            eventData[fields.endTime] = this.parent.tzModule.convert(eventData[fields.endTime], this.parent.timezone, endTz);\n        }\n    }\n    processTimezoneChange(event, oldTimezone) {\n        const fields = this.parent.eventFields;\n        if (event[fields.isAllDay]) {\n            return;\n        }\n        if (oldTimezone && this.parent.timezone) {\n            event[fields.startTime] = this.parent.tzModule.convert(event[fields.startTime], oldTimezone, this.parent.timezone);\n            event[fields.endTime] = this.parent.tzModule.convert(event[fields.endTime], oldTimezone, this.parent.timezone);\n        }\n        else if (!oldTimezone && this.parent.timezone) {\n            event[fields.startTime] = this.parent.tzModule.add(event[fields.startTime], this.parent.timezone);\n            event[fields.endTime] = this.parent.tzModule.add(event[fields.endTime], this.parent.timezone);\n        }\n        else if (oldTimezone && !this.parent.timezone) {\n            event[fields.startTime] = this.parent.tzModule.remove(event[fields.startTime], oldTimezone);\n            event[fields.endTime] = this.parent.tzModule.remove(event[fields.endTime], oldTimezone);\n        }\n    }\n    processTimezone(event, isReverse = false) {\n        const fields = this.parent.eventFields;\n        if (event[fields.startTimezone] || event[fields.endTimezone]) {\n            const startTimezone = event[fields.startTimezone] || event[fields.endTimezone];\n            const endTimezone = event[fields.endTimezone] || event[fields.startTimezone];\n            if (isReverse) {\n                if (this.parent.timezone) {\n                    event[fields.startTime] = this.parent.tzModule.convert(event[fields.startTime], startTimezone, this.parent.timezone);\n                    event[fields.endTime] = this.parent.tzModule.convert(event[fields.endTime], endTimezone, this.parent.timezone);\n                    event[fields.startTime] = this.parent.tzModule.remove(event[fields.startTime], this.parent.timezone);\n                    event[fields.endTime] = this.parent.tzModule.remove(event[fields.endTime], this.parent.timezone);\n                }\n                else {\n                    event[fields.startTime] = this.parent.tzModule.remove(event[fields.startTime], startTimezone);\n                    event[fields.endTime] = this.parent.tzModule.remove(event[fields.endTime], endTimezone);\n                }\n            }\n            else {\n                event[fields.startTime] = this.parent.tzModule.add(event[fields.startTime], startTimezone);\n                event[fields.endTime] = this.parent.tzModule.add(event[fields.endTime], endTimezone);\n                if (this.parent.timezone) {\n                    event[fields.startTime] = this.parent.tzModule.convert(event[fields.startTime], startTimezone, this.parent.timezone);\n                    event[fields.endTime] = this.parent.tzModule.convert(event[fields.endTime], endTimezone, this.parent.timezone);\n                }\n            }\n        }\n        else if (this.parent.timezone) {\n            if (isReverse) {\n                event[fields.startTime] = this.parent.tzModule.remove(event[fields.startTime], this.parent.timezone);\n                event[fields.endTime] = this.parent.tzModule.remove(event[fields.endTime], this.parent.timezone);\n            }\n            else {\n                event[fields.startTime] = this.parent.tzModule.add(event[fields.startTime], this.parent.timezone);\n                event[fields.endTime] = this.parent.tzModule.add(event[fields.endTime], this.parent.timezone);\n            }\n        }\n        return event;\n    }\n    filterBlockEvents(eventObj) {\n        const fields = this.parent.eventFields;\n        const eStart = eventObj[fields.startTime];\n        const eEnd = eventObj[fields.endTime];\n        let resourceData;\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            const data = this.getGroupIndexFromEvent(eventObj);\n            resourceData = this.parent.resourceBase.lastResourceLevel[data];\n        }\n        const blockEvents = extend([], this.parent.blockProcessed, null, true);\n        for (const eventObj of blockEvents) {\n            if (eventObj[fields.isAllDay]) {\n                const isDifferentTime = eventObj[fields.endTime].getTime() >\n                    resetTime(new Date(eventObj[fields.endTime].getTime())).getTime();\n                if (isDifferentTime) {\n                    eventObj[fields.startTime] = resetTime(eventObj[fields.startTime]);\n                    eventObj[fields.endTime] = addDays(resetTime(eventObj[fields.endTime]), 1);\n                }\n            }\n        }\n        return this.filterEvents(eStart, eEnd, blockEvents, resourceData);\n    }\n    filterEvents(startDate, endDate, appointments = this.parent.eventsProcessed, resourceTdData) {\n        const fieldMapping = this.parent.eventFields;\n        const predicate = new Predicate(fieldMapping.startTime, 'greaterthanorequal', startDate).\n            and(new Predicate(fieldMapping.endTime, 'greaterthanorequal', startDate)).\n            and(new Predicate(fieldMapping.startTime, 'lessthan', endDate)).\n            or(new Predicate(fieldMapping.startTime, 'lessthanorequal', startDate).\n            and(new Predicate(fieldMapping.endTime, 'greaterthan', startDate)));\n        let filter = new DataManager({ json: appointments }).executeLocal(new Query().where(predicate));\n        if (resourceTdData) {\n            filter = this.filterEventsByResource(resourceTdData, filter);\n        }\n        return this.sortByTime(filter);\n    }\n    filterEventsByRange(eventCollection, startDate, endDate) {\n        let filteredEvents = [];\n        if (startDate && endDate) {\n            filteredEvents = this.filterEvents(startDate, endDate, eventCollection);\n        }\n        else if (startDate && !endDate) {\n            filteredEvents = eventCollection.filter((e) => e[this.parent.eventFields.startTime] >= startDate);\n        }\n        else if (!startDate && endDate) {\n            filteredEvents = eventCollection.filter((e) => e[this.parent.eventFields.endTime] <= endDate);\n        }\n        else {\n            filteredEvents = eventCollection;\n        }\n        return this.sortByTime(filteredEvents);\n    }\n    filterEventsByResource(resourceTdData, appointments = this.parent.eventsProcessed) {\n        const predicate = {};\n        const resourceCollection = this.parent.resourceBase.resourceCollection;\n        for (let level = 0; level < resourceCollection.length; level++) {\n            predicate[resourceCollection[level].field] = resourceTdData.groupOrder[level];\n        }\n        const keys = Object.keys(predicate);\n        const filteredCollection = appointments.filter((eventObj) => keys.every((key) => {\n            if (eventObj[key] instanceof Array) {\n                return eventObj[key].indexOf(predicate[key]) > -1;\n            }\n            else {\n                return eventObj[key] === predicate[key];\n            }\n        }));\n        return filteredCollection;\n    }\n    sortByTime(appointmentsCollection) {\n        if (this.parent.eventSettings.sortComparer) {\n            appointmentsCollection = this.parent.eventSettings.sortComparer.call(this.parent, appointmentsCollection);\n        }\n        else {\n            const fieldMappings = this.parent.eventFields;\n            appointmentsCollection.sort((a, b) => {\n                const d1 = a[fieldMappings.startTime];\n                const d2 = b[fieldMappings.startTime];\n                return d1.getTime() - d2.getTime();\n            });\n        }\n        return appointmentsCollection;\n    }\n    sortByDateTime(appointments) {\n        if (this.parent.eventSettings.sortComparer) {\n            appointments = this.parent.eventSettings.sortComparer.call(this.parent, appointments);\n        }\n        else {\n            const fieldMapping = this.parent.eventFields;\n            appointments.sort((object1, object2) => {\n                const d3 = object1[fieldMapping.startTime];\n                const d4 = object2[fieldMapping.startTime];\n                const d5 = object1[fieldMapping.endTime];\n                const d6 = object2[fieldMapping.endTime];\n                const d1 = d5.getTime() - d3.getTime();\n                const d2 = d6.getTime() - d4.getTime();\n                return (d3.getTime() - d4.getTime() || d2 - d1);\n            });\n        }\n        return appointments;\n    }\n    getSmallestMissingNumber(array) {\n        const large = Math.max(...array);\n        for (let i = 0; i < large; i++) {\n            if (array.indexOf(i) === -1) {\n                return i;\n            }\n        }\n        return large + 1;\n    }\n    splitEventByDay(event) {\n        const eventFields = this.parent.eventFields;\n        const data = [];\n        const eventStartTime = event[eventFields.startTime];\n        const eventEndTime = event[eventFields.endTime];\n        const isDifferentDate = resetTime(new Date(eventStartTime.getTime())) <\n            resetTime(new Date(eventEndTime.getTime()));\n        if (isDifferentDate) {\n            let start = new Date(eventStartTime.getTime());\n            let end = addDays(resetTime(new Date(eventStartTime.getTime())), 1);\n            const endDate = (eventEndTime.getHours() === 0 && eventEndTime.getMinutes() === 0) ?\n                eventEndTime : addDays(eventEndTime, 1);\n            let index = 1;\n            const eventLength = getDaysCount(eventStartTime.getTime(), endDate.getTime());\n            while (end <= eventEndTime && start.getTime() !== end.getTime()) {\n                const app = extend({}, event);\n                app[eventFields.startTime] = start;\n                app[eventFields.endTime] = end;\n                app.data = { index: index, count: eventLength };\n                app.Guid = this.generateGuid();\n                app.isSpanned = true;\n                data.push(app);\n                start = end;\n                if ((resetTime(new Date(start.getTime())).getTime() === resetTime(new Date(eventEndTime.getTime())).getTime())\n                    && !(end.getTime() === eventEndTime.getTime())) {\n                    end = new Date(start.getTime());\n                    end = new Date(end.setHours(eventEndTime.getHours(), eventEndTime.getMinutes(), eventEndTime.getSeconds()));\n                }\n                else {\n                    end = addDays(resetTime(new Date(start.getTime())), 1);\n                }\n                index++;\n            }\n        }\n        else {\n            data.push(event);\n        }\n        return data;\n    }\n    splitEvent(event, dateRender) {\n        const fields = this.parent.eventFields;\n        let start = resetTime(event[fields.startTime]).getTime();\n        let end = resetTime(event[fields.endTime]).getTime();\n        if (getDateInMs(event[fields.endTime]) <= 0) {\n            const temp = addDays(resetTime(event[fields.endTime]), -1).getTime();\n            end = start > temp ? start : temp;\n        }\n        const orgStart = start;\n        const orgEnd = end;\n        const ranges = [];\n        if (start !== end) {\n            if (start < dateRender[0].getTime()) {\n                start = dateRender[0].getTime();\n            }\n            if (end > dateRender[dateRender.length - 1].getTime()) {\n                end = dateRender[dateRender.length - 1].getTime();\n            }\n            let cStart = start;\n            for (let level = 0; level < this.slots.length; level++) {\n                let slot = this.slots[level];\n                if (this.parent.currentView === 'WorkWeek' || this.parent.currentView === 'TimelineWorkWeek'\n                    || this.parent.activeViewOptions.group.byDate || this.parent.activeViewOptions.showWeekend) {\n                    const slotDates = [];\n                    for (const s of slot) {\n                        slotDates.push(new Date(s));\n                    }\n                    const renderedDates = this.getRenderedDates(slotDates);\n                    if (!isNullOrUndefined(renderedDates) && renderedDates.length > 0) {\n                        slot = [];\n                        for (const date of renderedDates) {\n                            slot.push(date.getTime());\n                        }\n                    }\n                }\n                if (typeof (slot) === 'number') {\n                    const temp = slot;\n                    slot = [];\n                    slot.push(temp);\n                }\n                const firstSlot = slot[0];\n                cStart = (cStart <= firstSlot && end >= firstSlot) ? firstSlot : cStart;\n                if (cStart > end || firstSlot > end) {\n                    break;\n                }\n                if (!this.parent.activeViewOptions.group.byDate && this.parent.activeViewOptions.showWeekend &&\n                    this.parent.currentView !== 'WorkWeek' && this.parent.currentView !== 'TimelineWorkWeek') {\n                    const startIndex = slot.indexOf(cStart);\n                    if (startIndex !== -1) {\n                        let endIndex = slot.indexOf(end);\n                        const hasBreak = endIndex !== -1;\n                        endIndex = hasBreak ? endIndex : slot.length - 1;\n                        const count = ((endIndex - startIndex) + 1);\n                        const isLeft = (slot[startIndex] !== orgStart);\n                        const isRight = (slot[endIndex] !== orgEnd);\n                        ranges.push(this.cloneEventObject(event, slot[startIndex], slot[endIndex], count, isLeft, isRight));\n                        if (hasBreak) {\n                            break;\n                        }\n                    }\n                }\n                else {\n                    if (this.dateInRange(cStart, slot[0], slot[slot.length - 1])) {\n                        const availSlot = [];\n                        for (let i = 0; i < slot.length; i++) {\n                            if (this.dateInRange(slot[i], orgStart, orgEnd)) {\n                                availSlot.push(slot[i]);\n                            }\n                        }\n                        if (availSlot.length > 0) {\n                            if (!this.parent.activeViewOptions.group.byDate) {\n                                const isLeft = (availSlot[0] !== orgStart);\n                                const isRight = (availSlot[availSlot.length - 1] !== orgEnd);\n                                ranges.push(this.cloneEventObject(event, availSlot[0], availSlot[availSlot.length - 1], availSlot.length, isLeft, isRight));\n                            }\n                            else {\n                                for (const slot of availSlot) {\n                                    ranges.push(this.cloneEventObject(event, slot, slot, 1, (slot !== orgStart), (slot !== orgEnd)));\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        else {\n            ranges.push(this.cloneEventObject(event, start, end, 1, false, false));\n        }\n        return ranges;\n    }\n    cloneEventObject(event, start, end, count, isLeft, isRight) {\n        const fields = this.parent.eventFields;\n        const e = extend({}, event, null, true);\n        const data = { count: count, isLeft: isLeft, isRight: isRight };\n        data[fields.startTime] = event[fields.startTime];\n        data[fields.endTime] = event[fields.endTime];\n        e.data = data;\n        e[fields.startTime] = new Date(start);\n        e[fields.endTime] = new Date(end);\n        return e;\n    }\n    dateInRange(date, start, end) {\n        return start <= date && date <= end;\n    }\n    getSelectedEventElements(target) {\n        this.removeSelectedAppointmentClass();\n        if (this.parent.selectedElements.length <= 0) {\n            this.parent.selectedElements.push(target);\n        }\n        else {\n            const isAlreadySelected = this.parent.selectedElements.filter((element) => element.getAttribute('data-guid') === target.getAttribute('data-guid'));\n            if (isAlreadySelected.length <= 0) {\n                const elementSelector = 'div[data-guid=\"' + target.getAttribute('data-guid') + '\"]';\n                const focusElements = [].slice.call(this.parent.element.querySelectorAll(elementSelector));\n                for (const element of focusElements) {\n                    this.parent.selectedElements.push(element);\n                }\n            }\n            else {\n                const selectedElements = this.parent.selectedElements.filter((element) => element.getAttribute('data-guid') !== target.getAttribute('data-guid'));\n                this.parent.selectedElements = selectedElements;\n            }\n        }\n        if (target && this.parent.selectedElements.length > 0) {\n            this.addSelectedAppointments(this.parent.selectedElements);\n        }\n        return this.parent.selectedElements;\n    }\n    getSelectedEvents() {\n        const eventSelect = [];\n        const elementSelect = [];\n        const selectAppointments = [].slice.call(this.parent.element.querySelectorAll('.' + APPOINTMENT_BORDER));\n        selectAppointments.filter((element) => {\n            const isAlreadyAdded = eventSelect.filter((event) => {\n                return event.Guid === element.getAttribute('data-guid');\n            });\n            if (isAlreadyAdded.length === 0) {\n                eventSelect.push(this.getEventByGuid(element.getAttribute('data-guid')));\n            }\n            elementSelect.push(element);\n        });\n        return {\n            event: eventSelect.length > 1 ? eventSelect : eventSelect[0],\n            element: elementSelect.length > 1 ? elementSelect : elementSelect[0]\n        };\n    }\n    removeSelectedAppointmentClass() {\n        const selectedAppointments = this.getSelectedAppointments();\n        for (const appointment of selectedAppointments) {\n            appointment.setAttribute('aria-pressed', 'false');\n        }\n        removeClass(selectedAppointments, APPOINTMENT_BORDER);\n        if (this.parent.currentView === 'Agenda' || this.parent.currentView === 'MonthAgenda') {\n            removeClass(selectedAppointments, AGENDA_SELECTED_CELL);\n        }\n    }\n    addSelectedAppointments(cells) {\n        for (const cell of cells) {\n            cell.setAttribute('aria-pressed', 'true');\n        }\n        if (this.parent.currentView !== 'MonthAgenda') {\n            this.parent.removeSelectedClass();\n        }\n        addClass(cells, APPOINTMENT_BORDER);\n        if (cells.length > 0) {\n            cells[cells.length - 1].focus();\n        }\n    }\n    getSelectedAppointments() {\n        return [].slice.call(this.parent.element.querySelectorAll('.' + APPOINTMENT_BORDER + ',.' + APPOINTMENT_CLASS + ':focus'));\n    }\n    focusElement(isFocused) {\n        if (this.parent.eventWindow.dialogObject && this.parent.eventWindow.dialogObject.visible) {\n            return;\n        }\n        const activeEle = document.activeElement;\n        const selectedCell = this.parent.getSelectedElements();\n        if (selectedCell.length > 0 && ((activeEle && (this.parent.element.contains(activeEle) ||\n            selectedCell.indexOf(activeEle) !== -1)) || isFocused)) {\n            if (this.parent.keyboardInteractionModule) {\n                const target = ((!isNullOrUndefined(this.parent.activeCellsData) &&\n                    this.parent.activeCellsData.element) || selectedCell[selectedCell.length - 1]);\n                this.parent.keyboardInteractionModule.selectCells(target instanceof Array, target);\n            }\n            return;\n        }\n        const selectedAppointments = this.getSelectedAppointments();\n        if (selectedAppointments.length > 0) {\n            selectedAppointments[selectedAppointments.length - 1].focus();\n            return;\n        }\n    }\n    selectWorkCellByTime(eventsData) {\n        let target;\n        if (this.parent.currentView === 'Agenda' || this.parent.currentView === 'MonthAgenda') {\n            return target;\n        }\n        if (eventsData.length > 0) {\n            const selectedObject = eventsData[eventsData.length - 1];\n            const eventStartTime = selectedObject[this.parent.eventFields.startTime];\n            let nearestTime = new Date(+eventStartTime).setMinutes(0, 0, 0);\n            const isAllDay = this.isAllDayAppointment(selectedObject);\n            if (this.parent.currentView === 'Month' || isAllDay) {\n                nearestTime = new Date(+eventStartTime).setHours(0, 0, 0, 0);\n            }\n            let targetArea;\n            if (isAllDay && ['Day', 'Week', 'WorkWeek'].indexOf(this.parent.currentView) !== -1) {\n                targetArea = this.parent.getAllDayRow();\n            }\n            else {\n                targetArea = this.parent.getContentTable();\n            }\n            let queryString = '[data-date=\"' + new Date(nearestTime).getTime() + '\"]';\n            if (this.parent.activeViewOptions.group.resources.length > 0) {\n                queryString += '[data-group-index=\"' + this.getGroupIndexFromEvent(selectedObject) + '\"]';\n            }\n            target = targetArea.querySelector(queryString);\n            if (target) {\n                this.parent.activeCellsData = this.parent.getCellDetails(target);\n                if (this.parent.keyboardInteractionModule) {\n                    this.parent.keyboardInteractionModule.selectCells(false, target);\n                }\n                return target;\n            }\n        }\n        return target;\n    }\n    getGroupIndexFromEvent(eventData) {\n        let levelIndex;\n        let resource;\n        let levelName;\n        let idField;\n        for (let i = this.parent.resourceBase.resourceCollection.length - 1; i >= 0; i--) {\n            const resourceData = eventData[this.parent.resourceBase.resourceCollection[i].field];\n            if (!isNullOrUndefined(resourceData)) {\n                resource = this.parent.resourceBase.resourceCollection[i];\n                levelIndex = i;\n                levelName = resource.name;\n                idField = resource.field;\n                break;\n            }\n        }\n        if (isNullOrUndefined(levelName) && isNullOrUndefined(levelIndex)) {\n            levelName = this.parent.resourceCollection.slice(-1)[0].name;\n            levelIndex = this.parent.resourceCollection.length - 1;\n            idField = this.parent.resourceCollection.slice(-1)[0].field;\n            resource = this.parent.resourceCollection.filter((e, index) => {\n                if (e.name === levelName) {\n                    levelIndex = index;\n                    return e;\n                }\n                return null;\n            })[0];\n        }\n        const id = ((eventData[idField] instanceof Array) ?\n            eventData[idField][0] : eventData[idField]);\n        if (levelIndex > 0) {\n            const parentField = this.parent.resourceCollection[levelIndex - 1].field;\n            return this.parent.resourceBase.getIndexFromResourceId(id, levelName, resource, eventData, parentField);\n        }\n        else {\n            return this.parent.resourceBase.getIndexFromResourceId(id, levelName, resource);\n        }\n    }\n    isAllDayAppointment(event) {\n        const fieldMapping = this.parent.eventFields;\n        const isAllDay = event[fieldMapping.isAllDay];\n        const isFullDay = ((getUniversalTime(event[fieldMapping.endTime]) - getUniversalTime(event[fieldMapping.startTime]))\n            / MS_PER_DAY) >= 1;\n        return (isAllDay || (this.parent.eventSettings.spannedEventPlacement !== 'TimeSlot' && isFullDay)) ? true : false;\n    }\n    addEventListener() {\n        this.parent.on(documentClick, this.appointmentBorderRemove, this);\n    }\n    removeEventListener() {\n        this.parent.off(documentClick, this.appointmentBorderRemove);\n    }\n    appointmentBorderRemove(event) {\n        const element = event.event.target;\n        if (closest(element, '.' + APPOINTMENT_CLASS)) {\n            if (this.parent.currentView !== 'MonthAgenda') {\n                this.parent.removeSelectedClass();\n            }\n        }\n        else if (!closest(element, '.' + POPUP_OPEN)) {\n            this.removeSelectedAppointmentClass();\n            this.parent.selectedElements = [];\n        }\n    }\n    wireAppointmentEvents(element, event, isPreventCrud = false) {\n        const isReadOnly = (!isNullOrUndefined(event)) ? event[this.parent.eventFields.isReadonly] : false;\n        EventHandler.add(element, 'click', this.eventClick, this);\n        if (!this.parent.isAdaptive && !this.parent.activeViewOptions.readonly && !isReadOnly) {\n            EventHandler.add(element, 'touchstart', this.eventTouchClick, this);\n            EventHandler.add(element, 'dblclick', this.eventDoubleClick, this);\n        }\n        if (!this.parent.activeViewOptions.readonly && !isReadOnly && !isPreventCrud) {\n            if (this.parent.resizeModule) {\n                this.parent.resizeModule.wireResizeEvent(element);\n            }\n            if (this.parent.dragAndDropModule) {\n                this.parent.dragAndDropModule.wireDragEvent(element);\n            }\n        }\n    }\n    eventTouchClick(e) {\n        setTimeout(() => this.isDoubleTapped = false, 250);\n        e.preventDefault();\n        if (this.isDoubleTapped) {\n            this.eventDoubleClick(e);\n        }\n        else if (!this.isDoubleTapped) {\n            this.isDoubleTapped = true;\n            this.eventClick(e);\n        }\n    }\n    renderResizeHandler(element, spanEvent, isReadOnly) {\n        if (!this.parent.resizeModule || !this.parent.allowResizing || this.parent.activeViewOptions.readonly || isReadOnly) {\n            return;\n        }\n        for (const resizeEdge of Object.keys(spanEvent)) {\n            const resizeHandler = createElement('div', { className: EVENT_RESIZE_CLASS });\n            switch (resizeEdge) {\n                case 'isLeft':\n                    if (!spanEvent.isLeft) {\n                        resizeHandler.appendChild(createElement('div', { className: 'e-left-right-resize' }));\n                        addClass([resizeHandler], this.parent.enableRtl ? RIGHT_RESIZE_HANDLER : LEFT_RESIZE_HANDLER);\n                        prepend([resizeHandler], element);\n                    }\n                    break;\n                case 'isRight':\n                    if (!spanEvent.isRight) {\n                        resizeHandler.appendChild(createElement('div', { className: 'e-left-right-resize' }));\n                        addClass([resizeHandler], this.parent.enableRtl ? LEFT_RESIZE_HANDLER : RIGHT_RESIZE_HANDLER);\n                        append([resizeHandler], element);\n                    }\n                    break;\n                case 'isTop':\n                    if (!spanEvent.isTop) {\n                        resizeHandler.appendChild(createElement('div', { className: 'e-top-bottom-resize' }));\n                        addClass([resizeHandler], TOP_RESIZE_HANDLER);\n                        prepend([resizeHandler], element);\n                    }\n                    break;\n                case 'isBottom':\n                    if (!spanEvent.isBottom) {\n                        resizeHandler.appendChild(createElement('div', { className: 'e-top-bottom-resize' }));\n                        addClass([resizeHandler], BOTTOM_RESIZE_HANDLER);\n                        append([resizeHandler], element);\n                    }\n                    break;\n            }\n        }\n    }\n    eventClick(eventData) {\n        const target = eventData.target;\n        if (target.classList.contains(DRAG_CLONE_CLASS) || target.classList.contains(RESIZE_CLONE_CLASS) ||\n            target.classList.contains(INLINE_SUBJECT_CLASS)) {\n            return;\n        }\n        if ((eventData.ctrlKey || eventData.metaKey) && eventData.which === 1 && this.parent.keyboardInteractionModule) {\n            this.parent.quickPopup.quickPopup.hide();\n            this.parent.selectedElements = [].slice.call(this.parent.element.querySelectorAll('.' + APPOINTMENT_BORDER));\n            const target = closest(eventData.target, '.' + APPOINTMENT_CLASS);\n            this.getSelectedEventElements(target);\n            this.activeEventData(eventData, false);\n            const selectArgs = {\n                data: this.parent.activeEventData.event,\n                element: this.parent.activeEventData.element,\n                event: eventData, requestType: 'eventSelect'\n            };\n            this.parent.trigger(select, selectArgs);\n            const args = extend(this.parent.activeEventData, { cancel: false, originalEvent: eventData });\n            this.parent.trigger(eventClick, args);\n        }\n        else {\n            this.removeSelectedAppointmentClass();\n            this.activeEventData(eventData, true);\n            const selectEventArgs = {\n                data: this.parent.activeEventData.event,\n                element: this.parent.activeEventData.element,\n                event: eventData, requestType: 'eventSelect'\n            };\n            this.parent.trigger(select, selectEventArgs);\n            const args = extend(this.parent.activeEventData, { cancel: false, originalEvent: eventData });\n            this.parent.trigger(eventClick, args, (eventClickArgs) => {\n                if (eventClickArgs.cancel) {\n                    this.removeSelectedAppointmentClass();\n                    this.parent.selectedElements = [];\n                    if (this.parent.quickPopup) {\n                        this.parent.quickPopup.quickPopupHide();\n                    }\n                }\n                else {\n                    if (this.parent.currentView === 'Agenda' || this.parent.currentView === 'MonthAgenda') {\n                        addClass([this.parent.activeEventData.element], AGENDA_SELECTED_CELL);\n                    }\n                    if (this.parent.allowInline) {\n                        const inlineArgs = {\n                            data: eventClickArgs.event,\n                            element: eventClickArgs.element,\n                            type: 'Event'\n                        };\n                        this.parent.notify(inlineClick, inlineArgs);\n                    }\n                    else {\n                        this.parent.notify(eventClick, eventClickArgs);\n                    }\n                }\n            });\n        }\n    }\n    eventDoubleClick(e) {\n        if (this.parent.quickPopup) {\n            this.parent.quickPopup.quickPopupHide(true);\n        }\n        if (e.type === 'touchstart') {\n            this.activeEventData(e, true);\n        }\n        this.removeSelectedAppointmentClass();\n        this.parent.selectedElements = [];\n        if (this.parent.activeEventData.element.classList.contains(INLINE_APPOINTMENT_CLASS) ||\n            this.parent.activeEventData.element.querySelector('.' + INLINE_SUBJECT_CLASS)) {\n            return;\n        }\n        if (!isNullOrUndefined(this.parent.activeEventData.event) &&\n            isNullOrUndefined(this.parent.activeEventData.event[this.parent.eventFields.recurrenceID])) {\n            this.parent.eventWindow.openEditor(this.parent.activeEventData.event, 'Save');\n        }\n        else {\n            this.parent.currentAction = 'EditOccurrence';\n            this.parent.quickPopup.openRecurrenceAlert();\n        }\n    }\n    getEventByGuid(guid) {\n        return this.parent.eventsProcessed.filter((data) => data.Guid === guid)[0];\n    }\n    getEventById(id) {\n        return this.parent.eventsData.filter((data) => data[this.parent.eventFields.id] === id)[0];\n    }\n    generateGuid() {\n        return 'xyxxxxyx-xxxy-yxxx-xyxx-xxyxxxxyyxxx'.replace(/[xy]/g, (c) => {\n            const r = Math.random() * 16 | 0;\n            const v = (c === 'x') ? r : (r & 0x3 | 0x8);\n            return v.toString(16);\n        });\n    }\n    getEventIDType() {\n        if (this.parent.eventsData.length !== 0) {\n            return typeof (this.parent.eventsData[0][this.parent.eventFields.id]);\n        }\n        if (this.parent.blockData.length !== 0) {\n            return typeof (this.parent.blockData[0][this.parent.eventFields.id]);\n        }\n        return 'string';\n    }\n    getEventMaxID(resourceId) {\n        if (this.parent.eventsData.length < 1 && this.parent.blockData.length < 1) {\n            return 1;\n        }\n        let eventId;\n        const idType = this.getEventIDType();\n        if (idType === 'string') {\n            eventId = this.generateGuid();\n        }\n        if (idType === 'number') {\n            const datas = this.parent.eventsData.concat(this.parent.blockData);\n            let maxId = Math.max(...datas.map((event) => event[this.parent.eventFields.id]));\n            maxId = isNullOrUndefined(resourceId) ? maxId : maxId + resourceId;\n            eventId = maxId + 1;\n        }\n        return eventId;\n    }\n    activeEventData(eventData, isMultiple) {\n        const target = closest(eventData.target, '.' + APPOINTMENT_CLASS);\n        const guid = target.getAttribute('data-guid');\n        if (isMultiple) {\n            this.addSelectedAppointments([].slice.call(this.parent.element.querySelectorAll('div[data-guid=\"' + guid + '\"]')));\n            target.focus();\n        }\n        let eventObject = this.getEventByGuid(guid);\n        if (eventObject && eventObject.isSpanned) {\n            eventObject = this.parent.eventsData.filter((obj) => obj[this.parent.eventFields.id] === eventObject[this.parent.eventFields.id])[0];\n        }\n        this.parent.activeEventData = { event: eventObject, element: target };\n    }\n    generateOccurrence(event, viewDate, oldTimezone, isMaxCount) {\n        const startDate = event[this.parent.eventFields.startTime];\n        const endDate = event[this.parent.eventFields.endTime];\n        const eventRule = event[this.parent.eventFields.recurrenceRule];\n        const duration = endDate.getTime() - startDate.getTime();\n        viewDate = new Date((viewDate || this.parent.activeView.startDate()).getTime() - duration);\n        const exception = event[this.parent.eventFields.recurrenceException];\n        let maxCount;\n        if (this.parent.currentView !== 'Agenda' && isMaxCount) {\n            maxCount = getDateCount(viewDate, this.parent.activeView.endDate()) + 1;\n        }\n        const newTimezone = this.parent.timezone || this.parent.tzModule.getLocalTimezoneName();\n        const firstDay = this.parent.activeViewOptions.firstDayOfWeek;\n        const calendarMode = this.parent.calendarMode;\n        const dates = generate(startDate, eventRule, exception, firstDay, maxCount, viewDate, calendarMode, oldTimezone, newTimezone);\n        if (this.parent.currentView === 'Agenda' && eventRule.indexOf('COUNT') === -1 && eventRule.indexOf('UNTIL') === -1) {\n            if (isNullOrUndefined(event.generatedDates)) {\n                event.generatedDates = { start: new Date(dates[0]), end: new Date(dates[dates.length - 1]) };\n            }\n            else {\n                if (dates[0] < event.generatedDates.start.getTime()) {\n                    event.generatedDates.start = new Date(dates[0]);\n                }\n                if (dates[dates.length - 1] > event.generatedDates.end.getTime()) {\n                    event.generatedDates.end = new Date(dates[dates.length - 1]);\n                }\n            }\n        }\n        const occurrenceCollection = [];\n        for (let date of dates) {\n            const clonedObject = extend({}, event, null, true);\n            date = this.getDSTAdjustedTime(date, clonedObject);\n            clonedObject[this.parent.eventFields.startTime] = new Date(date);\n            clonedObject[this.parent.eventFields.endTime] = new Date(new Date(date).setMilliseconds(duration));\n            clonedObject[this.parent.eventFields.recurrenceID] = clonedObject[this.parent.eventFields.id];\n            delete clonedObject[this.parent.eventFields.recurrenceException];\n            delete clonedObject[this.parent.eventFields.followingID];\n            clonedObject.Guid = this.generateGuid();\n            occurrenceCollection.push(clonedObject);\n        }\n        return occurrenceCollection;\n    }\n    getDSTAdjustedTime(date, event) {\n        let occurDate = date;\n        if (this.parent.timezone &&\n            (event[this.parent.eventFields.startTimezone] || event[this.parent.eventFields.endTimezone])) {\n            const eventOffset = this.getDSTDiff(event[this.parent.eventFields.startTime], new Date(date), event[this.parent.eventFields.startTimezone]);\n            const schOffset = this.getDSTDiff(event[this.parent.eventFields.startTime], new Date(date), this.parent.timezone);\n            occurDate = (new Date(date).getTime() - (eventOffset - schOffset) * 60000);\n        }\n        return occurDate;\n    }\n    getDSTDiff(startDate, occurDate, timezone) {\n        const startOffset = this.parent.tzModule.offset(new Date(startDate), timezone);\n        const occurOffset = this.parent.tzModule.offset(new Date(occurDate), timezone);\n        return startOffset - occurOffset;\n    }\n    getParentEvent(eventObj, isParent = false) {\n        let parentEvent;\n        do {\n            eventObj = this.getFollowingEvent(eventObj);\n            if (eventObj) {\n                parentEvent = extend({}, eventObj, null, true);\n            }\n        } while (eventObj && isParent);\n        if (isParent && parentEvent) {\n            const collection = this.getEventCollections(parentEvent);\n            let followObj = collection.follow.slice(-1)[0];\n            if (collection.occurrence.length > 0 && !parentEvent[this.parent.eventFields.recurrenceException]) {\n                followObj = collection.occurrence.slice(-1)[0];\n            }\n            if (followObj) {\n                parentEvent[this.parent.eventFields.recurrenceRule] = followObj[this.parent.eventFields.recurrenceRule];\n            }\n        }\n        return parentEvent;\n    }\n    getEventCollections(parentObj, childObj) {\n        const followingCollection = [];\n        let occurrenceCollection = [];\n        let followingEvent = parentObj;\n        do {\n            followingEvent = this.getFollowingEvent(followingEvent, true);\n            if (followingEvent) {\n                followingCollection.push(followingEvent);\n            }\n            occurrenceCollection = occurrenceCollection.concat(this.getOccurrenceEvent(followingEvent || parentObj));\n        } while (followingEvent);\n        let collections = {};\n        if (childObj) {\n            const fields = this.parent.eventFields;\n            collections = {\n                follow: followingCollection.filter((eventData) => eventData[fields.startTime] >= childObj[fields.startTime]),\n                occurrence: occurrenceCollection.filter((eventData) => eventData[fields.startTime] >= childObj[fields.startTime])\n            };\n        }\n        else {\n            collections = { follow: followingCollection, occurrence: occurrenceCollection };\n        }\n        return collections;\n    }\n    getFollowingEvent(parentObj, isReverse) {\n        const fields = this.parent.eventFields;\n        let fieldValue;\n        if (isReverse) {\n            fieldValue = parentObj[fields.id];\n        }\n        else {\n            fieldValue = (parentObj[fields.recurrenceID] || parentObj[fields.followingID]);\n        }\n        const parentApp = this.parent.eventsData.filter((data) => data[isReverse ? fields.followingID : fields.id] === fieldValue);\n        return parentApp.shift();\n    }\n    isFollowingEvent(parentObj, childObj) {\n        const parentStart = parentObj[this.parent.eventFields.startTime];\n        const childStart = childObj[this.parent.eventFields.startTime];\n        return parentStart.getHours() === childStart.getHours() && parentStart.getMinutes() === childStart.getMinutes() &&\n            parentStart.getSeconds() === childStart.getSeconds();\n    }\n    getOccurrenceEvent(eventObj, isGuid = false, isFollowing = false) {\n        const idField = isGuid ? 'Guid' : (isFollowing) ? this.parent.eventFields.followingID : this.parent.eventFields.recurrenceID;\n        const fieldKey = isGuid ? 'Guid' : this.parent.eventFields.id;\n        const dataSource = isGuid ? this.parent.eventsProcessed : this.parent.eventsData;\n        return dataSource.filter((data) => data[idField] === eventObj[fieldKey]);\n    }\n    getOccurrencesByID(id) {\n        const fields = this.parent.eventFields;\n        let occurrenceCollection = [];\n        const parentObject = this.parent.eventsData.filter((obj) => obj[fields.id] === id);\n        for (const event of parentObject) {\n            if (!isNullOrUndefined(event[fields.recurrenceRule])) {\n                occurrenceCollection = occurrenceCollection.concat(this.generateOccurrence(event));\n            }\n        }\n        return occurrenceCollection;\n    }\n    getOccurrencesByRange(startTime, endTime) {\n        const fields = this.parent.eventFields;\n        let occurrenceCollection = [];\n        for (const event of this.parent.eventsData) {\n            if (!isNullOrUndefined(event[fields.recurrenceRule])) {\n                occurrenceCollection = occurrenceCollection.concat(this.generateOccurrence(event));\n            }\n        }\n        const filter = occurrenceCollection.filter((obj) => obj[fields.startTime] >= startTime && obj[fields.endTime] <= endTime && !isNullOrUndefined(obj[fields.recurrenceID]));\n        return filter;\n    }\n    getDeletedOccurrences(recurrenceData) {\n        const fields = this.parent.eventFields;\n        let parentObject;\n        const deletedOccurrences = [];\n        if (typeof recurrenceData === 'string' || typeof recurrenceData === 'number') {\n            parentObject = this.parent.eventsData.filter((obj) => obj[fields.id] === recurrenceData)[0];\n        }\n        else {\n            parentObject = extend({}, recurrenceData, null, true);\n        }\n        if (parentObject[fields.recurrenceException]) {\n            const exDateString = parentObject[fields.recurrenceException].split(',');\n            for (let i = 0, len = exDateString.length; i < len; i++) {\n                const edited = this.parent.eventsData.filter((eventObj) => eventObj[fields.recurrenceID] === parentObject[fields.id] && eventObj[fields.recurrenceException] === exDateString[i]);\n                if (edited.length === 0) {\n                    const exDate = getDateFromRecurrenceDateString(exDateString[i]);\n                    const childObject = extend({}, recurrenceData, null, true);\n                    childObject[fields.recurrenceID] = parentObject[fields.id];\n                    delete childObject[fields.followingID];\n                    childObject[fields.recurrenceException] = exDateString[i];\n                    const startDate = new Date(exDate.getTime());\n                    const time = parentObject[fields.endTime].getTime() - parentObject[fields.startTime].getTime();\n                    const endDate = new Date(startDate.getTime());\n                    endDate.setMilliseconds(time);\n                    childObject[fields.startTime] = new Date(startDate.getTime());\n                    childObject[fields.endTime] = new Date(endDate.getTime());\n                    deletedOccurrences.push(childObject);\n                }\n            }\n        }\n        return deletedOccurrences;\n    }\n    applyResourceColor(element, data, type, index, alpha) {\n        if (!this.parent.resourceBase) {\n            return;\n        }\n        const alphaColor = (color, alpha) => {\n            color = color.replace('#', '');\n            const r = parseInt(color.substring(0, color.length / 3), 16);\n            const g = parseInt(color.substring(color.length / 3, 2 * color.length / 3), 16);\n            const b = parseInt(color.substring(2 * color.length / 3, 3 * color.length / 3), 16);\n            return `rgba(${r}, ${g}, ${b}, ${alpha})`;\n        };\n        // index refers groupOrder\n        const color = this.parent.resourceBase.getResourceColor(data, index);\n        if (color) {\n            element.style[type] = !isNullOrUndefined(alpha) ? alphaColor(color, alpha) : color;\n        }\n    }\n    createBlockAppointmentElement(record, resIndex) {\n        const eventSubject = (record[this.parent.eventFields.subject] || this.parent.eventSettings.fields.subject.default);\n        const appointmentWrapper = createElement('div', {\n            className: BLOCK_APPOINTMENT_CLASS,\n            attrs: {\n                'data-id': 'Appointment_' + record[this.parent.eventFields.id],\n                'aria-disabled': 'true', 'aria-pressed': 'false'\n            }\n        });\n        let templateElement;\n        if (!isNullOrUndefined(this.parent.activeViewOptions.eventTemplate)) {\n            const scheduleId = this.parent.element.id + '_';\n            const viewName = this.parent.activeViewOptions.eventTemplateName;\n            const templateId = scheduleId + viewName + 'eventTemplate';\n            const templateName = 'eventTemplate' + (this.parent.activeViewOptions.group.resources.length > 0 &&\n                this.parent.currentView.indexOf('Year') === -1 ? '_' + resIndex : '');\n            templateElement = this.parent.getAppointmentTemplate()(record, this.parent, templateName, templateId, false);\n        }\n        else {\n            const appointmentSubject = createElement('div', {\n                className: SUBJECT_CLASS, innerHTML: eventSubject\n            });\n            templateElement = [appointmentSubject];\n        }\n        append(templateElement, appointmentWrapper);\n        this.setWrapperAttributes(appointmentWrapper, resIndex);\n        return appointmentWrapper;\n    }\n    setWrapperAttributes(appointmentWrapper, resIndex) {\n        if (!isNullOrUndefined(this.cssClass)) {\n            addClass([appointmentWrapper], this.cssClass);\n        }\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            appointmentWrapper.setAttribute('data-group-index', resIndex.toString());\n        }\n    }\n    getReadonlyAttribute(event) {\n        return (event[this.parent.eventFields.isReadonly] || this.parent.readonly).toString();\n    }\n    isBlockRange(eventData) {\n        const eventCollection = (eventData instanceof Array) ? eventData : [eventData];\n        let isBlockAlert = false;\n        const fields = this.parent.eventFields;\n        for (const event of eventCollection) {\n            let dataCol = [];\n            if (!isNullOrUndefined(event[fields.recurrenceRule]) &&\n                (isNullOrUndefined(event[fields.recurrenceID]) || event[fields.id] === event[fields.recurrenceID])) {\n                dataCol = this.generateOccurrence(event);\n            }\n            else {\n                dataCol.push(event);\n            }\n            for (const data of dataCol) {\n                const filterBlockEvents = this.filterBlockEvents(data);\n                if (filterBlockEvents.length > 0) {\n                    isBlockAlert = true;\n                    break;\n                }\n            }\n        }\n        this.parent.uiStateValues.isBlock = isBlockAlert;\n        return isBlockAlert;\n    }\n    getFilterEventsList(dataSource, query) {\n        return new DataManager(dataSource).executeLocal(new Query().where(query));\n    }\n    getSeriesEvents(parentEvent, startTime) {\n        const fields = this.parent.eventFields;\n        startTime = isNullOrUndefined(startTime) ? parentEvent[fields.startTime] : startTime;\n        let deleteFutureEditEvents;\n        let futureEvents;\n        const deleteFutureEditEventList = [];\n        let delId = parentEvent[fields.id];\n        let followingId = parentEvent[fields.followingID];\n        let deleteFutureEvent;\n        const startTimeQuery = this.parent.currentAction === 'EditSeries' ? 'greaterthan' : 'greaterthanorequal';\n        do {\n            deleteFutureEvent = ((new Predicate(fields.followingID, 'equal', delId))).\n                and(new Predicate(fields.startTime, startTimeQuery, startTime));\n            futureEvents = this.getFilterEventsList(this.parent.eventsData, deleteFutureEvent);\n            deleteFutureEditEvents = futureEvents.slice(-1)[0];\n            if (!isNullOrUndefined(deleteFutureEditEvents) && deleteFutureEditEvents[fields.id] !== followingId) {\n                deleteFutureEditEventList.push(deleteFutureEditEvents);\n                delId = deleteFutureEditEvents[fields.id];\n                followingId = deleteFutureEditEvents[fields.followingID];\n            }\n            else {\n                followingId = null;\n            }\n        } while (futureEvents.length === 1 && !isNullOrUndefined(deleteFutureEditEvents[fields.followingID]));\n        return deleteFutureEditEventList;\n    }\n    getEditedOccurrences(deleteFutureEditEventList, startTime) {\n        const fields = this.parent.eventFields;\n        let deleteRecurrenceEventList = [];\n        let delEditedEvents;\n        for (const event of deleteFutureEditEventList) {\n            let delEventQuery = new Predicate(fields.recurrenceID, 'equal', event[fields.id]).\n                or(new Predicate(fields.recurrenceID, 'equal', event[fields.followingID]).\n                and(new Predicate(fields.recurrenceID, 'notequal', undefined)).\n                and(new Predicate(fields.recurrenceID, 'notequal', null)));\n            if (this.parent.currentAction === 'EditFollowingEvents' || this.parent.currentAction === 'DeleteFollowingEvents') {\n                delEventQuery = delEventQuery.and(new Predicate(fields.startTime, 'greaterthanorequal', startTime));\n            }\n            delEditedEvents = this.getFilterEventsList(this.parent.eventsData, delEventQuery);\n            deleteRecurrenceEventList = deleteRecurrenceEventList.concat(delEditedEvents);\n        }\n        return deleteRecurrenceEventList;\n    }\n    getRenderedDates(dateRender) {\n        let firstDate = 0;\n        let lastDate = dateRender.length;\n        let filteredDates;\n        if (dateRender[0] < this.parent.minDate && dateRender[dateRender.length - 1] > this.parent.maxDate) {\n            for (let i = 0; i < dateRender.length; i++) {\n                if (resetTime(dateRender[i]).getTime() === resetTime(new Date(this.parent.minDate)).getTime()) {\n                    firstDate = i;\n                }\n                if (resetTime(dateRender[i]).getTime() === resetTime(new Date(this.parent.maxDate)).getTime()) {\n                    lastDate = i;\n                }\n            }\n            filteredDates = dateRender.filter((date) => date >= dateRender[firstDate] && date <= dateRender[lastDate]);\n        }\n        return filteredDates;\n    }\n    isValidEvent(eventObj, start, end, schedule) {\n        const isHourRange = end.getTime() > schedule.startHour.getTime() && start.getTime() < schedule.endHour.getTime();\n        const isSameRange = schedule.startHour.getTime() <= start.getTime() &&\n            eventObj[this.parent.eventFields.startTime].getTime() >= schedule.startHour.getTime() &&\n            eventObj[this.parent.eventFields.endTime].getTime() < schedule.endHour.getTime() && start.getTime() === end.getTime();\n        return isHourRange || isSameRange;\n    }\n    allDayExpandScroll(dateHeader) {\n        let indentHeight = 0;\n        const headerRows = [].slice.call(this.parent.element.querySelectorAll('.' + HEADER_ROW_CLASS));\n        headerRows.forEach((element) => {\n            const tdEle = [].slice.call(element.children);\n            tdEle.forEach((ele) => { ele.style.top = indentHeight + 'px'; });\n            indentHeight += element.offsetHeight;\n        });\n        indentHeight = dateHeader.offsetHeight - indentHeight;\n        this.parent.element.querySelector('.' + ALLDAY_CELLS_CLASS).style.height = (indentHeight / 12) + 'em';\n        if (this.parent.uiStateValues.expand) {\n            addClass([dateHeader], ALLDAY_APPOINTMENT_SCROLL);\n        }\n        else {\n            removeClass([dateHeader], ALLDAY_APPOINTMENT_SCROLL);\n        }\n    }\n    updateEventMinimumDuration(startEndHours, startTime, endTime) {\n        if (startTime.getTime() < endTime.getTime()) {\n            const eventDuration = (getUniversalTime(endTime) - getUniversalTime(startTime)) / MS_PER_MINUTE;\n            if (eventDuration < this.parent.eventSettings.minimumEventDuration) {\n                const tempEnd = new Date(startTime);\n                tempEnd.setMinutes(tempEnd.getMinutes() + this.parent.eventSettings.minimumEventDuration);\n                endTime = tempEnd;\n                if (endTime.getTime() > startEndHours.endHour.getTime()) {\n                    const tempStart = new Date(startEndHours.endHour.getTime());\n                    tempStart.setMinutes(tempStart.getMinutes() - this.parent.eventSettings.minimumEventDuration);\n                    startTime = tempStart;\n                    endTime = startEndHours.endHour;\n                }\n            }\n        }\n        return { startDate: startTime, endDate: endTime };\n    }\n    unWireEvents() {\n        const appElements = [].slice.call(this.parent.element.querySelectorAll('.' + APPOINTMENT_CLASS));\n        for (const element of appElements) {\n            EventHandler.clearEvents(element);\n        }\n    }\n    destroy() {\n        this.unWireEvents();\n        this.parent = null;\n    }\n}\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\n/**\n * Vertical view appointment rendering\n */\nclass VerticalEvent extends EventBase {\n    constructor(parent) {\n        super(parent);\n        this.dateRender = [];\n        this.renderedEvents = [];\n        this.renderedAllDayEvents = [];\n        this.overlapEvents = [];\n        this.moreEvents = [];\n        this.overlapList = [];\n        this.allDayEvents = [];\n        this.slotCount = this.parent.activeViewOptions.timeScale.slotCount;\n        this.interval = this.parent.activeViewOptions.timeScale.interval;\n        this.allDayLevel = 0;\n        this.startHour = this.parent.activeView.getStartHour();\n        this.endHour = this.parent.activeView.getEndHour();\n        this.element = this.parent.activeView.getPanel();\n        this.fields = this.parent.eventFields;\n        this.animation = new Animation({ progress: this.animationUiUpdate.bind(this) });\n        this.addEventListener();\n    }\n    renderAppointments() {\n        if (isNullOrUndefined(this.parent)) {\n            return;\n        }\n        if (this.parent.dragAndDropModule) {\n            this.parent.dragAndDropModule.setDragArea();\n        }\n        const wrapperElements = [].slice.call(this.parent.element.querySelectorAll('.' + BLOCK_APPOINTMENT_CLASS +\n            ',.' + APPOINTMENT_CLASS + ',.' + ROW_COUNT_WRAPPER_CLASS));\n        const isDragging = (this.parent.crudModule && this.parent.crudModule.crudObj.isCrudAction) ? true : false;\n        for (const wrapper of wrapperElements) {\n            if (isDragging && !(wrapper.classList.contains(ALLDAY_APPOINTMENT_CLASS) ||\n                wrapper.classList.contains(ROW_COUNT_WRAPPER_CLASS))) {\n                const groupIndex = parseInt(wrapper.getAttribute('data-group-index'), 10);\n                for (let j = 0, len = this.parent.crudModule.crudObj.sourceEvent.length; j < len; j++) {\n                    if (groupIndex === this.parent.crudModule.crudObj.sourceEvent[j].groupIndex ||\n                        groupIndex === this.parent.crudModule.crudObj.targetEvent[j].groupIndex) {\n                        remove(wrapper);\n                    }\n                }\n            }\n            else {\n                remove(wrapper);\n            }\n        }\n        if (!this.element.querySelector('.' + WORK_CELLS_CLASS)) {\n            return;\n        }\n        this.allDayElement = [].slice.call(this.element.querySelectorAll('.' + ALLDAY_CELLS_CLASS));\n        this.setAllDayRowHeight(0);\n        if (this.parent.eventsProcessed.length === 0 && this.parent.blockProcessed.length === 0) {\n            return;\n        }\n        const expandCollapse = this.element.querySelector('.' + ALLDAY_APPOINTMENT_SECTION_CLASS);\n        EventHandler.remove(expandCollapse, 'click', this.rowExpandCollapse);\n        EventHandler.add(expandCollapse, 'click', this.rowExpandCollapse, this);\n        this.renderedEvents = [];\n        this.renderedAllDayEvents = [];\n        this.initializeValues();\n        this.processBlockEvents();\n        this.renderEvents('normalEvents');\n        if (this.allDayEvents.length > 0) {\n            this.allDayEvents = this.allDayEvents.filter((item, index, arr) => index === arr.map((item) => item.Guid).indexOf(item.Guid));\n            removeClass(this.allDayElement, ALLDAY_ROW_ANIMATE_CLASS);\n            this.slots.push(this.parent.activeView.renderDates.map((date) => +date));\n            this.renderEvents('allDayEvents');\n        }\n        this.parent.notify(contentReady, {});\n        addClass(this.allDayElement, ALLDAY_ROW_ANIMATE_CLASS);\n        if (isDragging) {\n            this.parent.crudModule.crudObj.isCrudAction = false;\n        }\n        this.parent.renderTemplates();\n    }\n    initializeValues() {\n        this.resources = (this.parent.activeViewOptions.group.resources.length > 0) ? this.parent.uiStateValues.isGroupAdaptive ?\n            [this.parent.resourceBase.lastResourceLevel[this.parent.uiStateValues.groupIndex]] :\n            this.parent.resourceBase.lastResourceLevel : [];\n        this.cellHeight =\n            parseFloat(this.parent.element.querySelector('.e-content-wrap tbody tr').getBoundingClientRect().height.toFixed(2));\n        this.dateRender[0] = this.parent.activeView.renderDates;\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            for (let i = 0, len = this.resources.length; i < len; i++) {\n                this.dateRender[i] = this.resources[i].renderDates;\n            }\n        }\n    }\n    getHeight(start, end) {\n        let appHeight = (getUniversalTime(end) - getUniversalTime(start)) /\n            MS_PER_MINUTE * (this.cellHeight * this.slotCount) / this.interval;\n        appHeight = (appHeight <= 0) ? this.cellHeight : appHeight;\n        return appHeight;\n    }\n    appendEvent(eventObj, appointmentElement, index, appLeft) {\n        const appointmentWrap = [].slice.call(this.element.querySelectorAll('.' + APPOINTMENT_WRAPPER_CLASS));\n        if (this.parent.enableRtl) {\n            setStyleAttribute(appointmentElement, { 'right': appLeft });\n        }\n        else {\n            setStyleAttribute(appointmentElement, { 'left': appLeft });\n        }\n        const eventType = appointmentElement.classList.contains(BLOCK_APPOINTMENT_CLASS) ? 'blockEvent' : 'event';\n        const args = {\n            data: extend({}, eventObj, null, true),\n            element: appointmentElement, cancel: false, type: eventType\n        };\n        this.parent.trigger(eventRendered, args, (eventArgs) => {\n            if (!eventArgs.cancel) {\n                appointmentWrap[index].appendChild(appointmentElement);\n            }\n        });\n    }\n    processBlockEvents() {\n        const resources = this.getResourceList();\n        let dateCount = 0;\n        for (const resource of resources) {\n            const renderDates = this.dateRender[resource];\n            for (let day = 0, length = renderDates.length; day < length; day++) {\n                const startDate = new Date(renderDates[day].getTime());\n                const endDate = addDays(renderDates[day], 1);\n                const filterEvents = this.filterEvents(startDate, endDate, this.parent.blockProcessed, this.resources[resource]);\n                for (const event of filterEvents) {\n                    if (this.parent.resourceBase) {\n                        this.setValues(event, resource);\n                    }\n                    this.renderBlockEvents(event, day, resource, dateCount);\n                    this.cssClass = null;\n                    this.groupOrder = null;\n                }\n                dateCount += 1;\n            }\n        }\n    }\n    renderBlockEvents(eventObj, dayIndex, resource, dayCount) {\n        const spannedData = this.isSpannedEvent(eventObj, dayIndex, resource);\n        const eStart = spannedData[this.fields.startTime];\n        const eEnd = spannedData[this.fields.endTime];\n        const currentDate = resetTime(new Date(this.dateRender[resource][dayIndex].getTime()));\n        const schedule = getStartEndHours(currentDate, this.startHour, this.endHour);\n        if (eStart <= eEnd && this.isValidEvent(eventObj, eStart, eEnd, schedule)) {\n            let blockTop;\n            let blockHeight;\n            if (spannedData[this.fields.isAllDay]) {\n                const contentWrap = this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS + ' table');\n                blockHeight = formatUnit(contentWrap.offsetHeight);\n                blockTop = formatUnit(0);\n            }\n            else {\n                blockHeight = formatUnit(this.getHeight(eStart, eEnd));\n                blockTop = formatUnit(this.getTopValue(eStart, dayIndex, resource));\n            }\n            const appointmentElement = this.createBlockAppointmentElement(eventObj, resource);\n            setStyleAttribute(appointmentElement, { 'width': '100%', 'height': blockHeight, 'top': blockTop });\n            const index = this.parent.activeViewOptions.group.byDate ? (this.resources.length * dayIndex) + resource : dayCount;\n            this.appendEvent(eventObj, appointmentElement, index, '0px');\n        }\n    }\n    renderEvents(eventType) {\n        removeClass(this.allDayElement, ALLDAY_ROW_ANIMATE_CLASS);\n        const eventCollection = (eventType === 'allDayEvents') ? this.sortByDateTime(this.allDayEvents) : undefined;\n        const resources = this.getResourceList();\n        let dateCount = 0;\n        let isRender;\n        for (const resource of resources) {\n            isRender = true;\n            if (this.parent.crudModule && this.parent.crudModule.crudObj.isCrudAction && eventType !== 'allDayEvents'\n                && !this.parent.uiStateValues.isGroupAdaptive) {\n                if (this.parent.crudModule.crudObj.sourceEvent.filter((data) => data.groupIndex === resource).length === 0 &&\n                    this.parent.crudModule.crudObj.targetEvent.filter((data) => data.groupIndex === resource).length === 0) {\n                    isRender = false;\n                }\n            }\n            this.slots = [];\n            const renderDates = this.dateRender[resource];\n            const renderedDate = this.getRenderedDates(renderDates) || renderDates;\n            this.slots.push(renderDates.map((date) => { return +date; }));\n            for (let day = 0, length = renderDates.length; day < length &&\n                renderDates[day] <= renderedDate[renderedDate.length - 1]; day++) {\n                this.renderedEvents = [];\n                const startDate = new Date(renderDates[day].getTime());\n                const endDate = addDays(renderDates[day], 1);\n                const filterEvents = this.filterEvents(startDate, endDate, eventCollection, this.resources[resource]);\n                if (isRender) {\n                    for (const event of filterEvents) {\n                        if (this.parent.resourceBase) {\n                            this.setValues(event, resource);\n                        }\n                        if (eventType === 'allDayEvents') {\n                            this.renderAllDayEvents(event, day, resource, dateCount);\n                        }\n                        else {\n                            if (this.isAllDayAppointment(event)) {\n                                this.allDayEvents.push(extend({}, event, null, true));\n                            }\n                            else {\n                                if (this.parent.eventSettings.enableMaxHeight) {\n                                    if (this.getOverlapIndex(event, day, false, resource) > 0) {\n                                        continue;\n                                    }\n                                }\n                                this.renderNormalEvents(event, day, resource, dateCount);\n                            }\n                        }\n                        this.cssClass = null;\n                        this.groupOrder = null;\n                    }\n                }\n                else {\n                    for (const event of filterEvents) {\n                        if (this.isAllDayAppointment(event)) {\n                            this.allDayEvents.push(extend({}, event, null, true));\n                        }\n                    }\n                }\n                dateCount += 1;\n            }\n        }\n    }\n    setValues(event, resourceIndex) {\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            this.cssClass = this.resources[resourceIndex].cssClass;\n            this.groupOrder = this.resources[resourceIndex].groupOrder;\n        }\n        else {\n            this.cssClass = this.parent.resourceBase.getCssClass(event);\n        }\n    }\n    getResourceList() {\n        // eslint-disable-next-line prefer-spread\n        const resources = Array.apply(null, {\n            length: (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) ?\n                this.resources.length : 1\n        }).map((value, index) => { return index; });\n        return resources;\n    }\n    // eslint-disable-next-line max-len\n    createAppointmentElement(record, isAllDay, data, resource) {\n        const fieldMapping = this.parent.eventFields;\n        const recordSubject = (record[fieldMapping.subject] || this.parent.eventSettings.fields.subject.default\n            || this.parent.localeObj.getConstant('addTitle'));\n        const appointmentWrapper = createElement('div', {\n            className: APPOINTMENT_CLASS,\n            attrs: {\n                'data-id': 'Appointment_' + record[fieldMapping.id],\n                'data-guid': record.Guid,\n                'role': 'button',\n                'tabindex': '0',\n                'aria-disabled': this.parent.eventBase.getReadonlyAttribute(record),\n                'aria-pressed': 'false',\n                'aria-grabbed': 'true',\n                'aria-label': this.parent.getAnnouncementString(record)\n            }\n        });\n        if (record[this.fields.isReadonly]) {\n            addClass([appointmentWrapper], 'e-read-only');\n        }\n        const appointmentDetails = createElement('div', { className: APPOINTMENT_DETAILS });\n        appointmentWrapper.appendChild(appointmentDetails);\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            const resourceIndex = this.parent.uiStateValues.isGroupAdaptive ? this.parent.uiStateValues.groupIndex : resource;\n            appointmentWrapper.setAttribute('data-group-index', resourceIndex.toString());\n        }\n        let templateElement;\n        const eventData = data;\n        if (!isNullOrUndefined(this.parent.activeViewOptions.eventTemplate)) {\n            const elementId = this.parent.element.id + '_';\n            const viewName = this.parent.activeViewOptions.eventTemplateName;\n            const templateId = elementId + viewName + 'eventTemplate';\n            const resIndex = this.parent.uiStateValues.isGroupAdaptive ? this.parent.uiStateValues.groupIndex : resource;\n            const templateName = 'eventTemplate' + (this.parent.activeViewOptions.group.resources.length > 0 ? '_' + resIndex : '');\n            templateElement = this.parent.getAppointmentTemplate()(record, this.parent, templateName, templateId, false);\n        }\n        else {\n            const appointmentSubject = createElement('div', { className: SUBJECT_CLASS, innerHTML: recordSubject });\n            if (isAllDay) {\n                if (record[fieldMapping.isAllDay]) {\n                    templateElement = [appointmentSubject];\n                }\n                else {\n                    templateElement = [];\n                    const appointmentStartTime = createElement('div', {\n                        className: APPOINTMENT_TIME + (this.parent.isAdaptive ? ' ' + DISABLE_CLASS : ''),\n                        innerHTML: this.parent.getTimeString(record[fieldMapping.startTime])\n                    });\n                    const appointmentEndTime = createElement('div', {\n                        className: APPOINTMENT_TIME + (this.parent.isAdaptive ? ' ' + DISABLE_CLASS : ''),\n                        innerHTML: this.parent.getTimeString(record[fieldMapping.endTime])\n                    });\n                    addClass([appointmentSubject], 'e-text-center');\n                    if (!eventData.isLeft) {\n                        templateElement.push(appointmentStartTime);\n                    }\n                    templateElement.push(appointmentSubject);\n                    if (!eventData.isRight) {\n                        templateElement.push(appointmentEndTime);\n                    }\n                }\n            }\n            else {\n                const timeStr = this.parent.getTimeString(record[fieldMapping.startTime]) + ' - ' +\n                    this.parent.getTimeString(record[fieldMapping.endTime]);\n                const appointmentTime = createElement('div', {\n                    className: APPOINTMENT_TIME + (this.parent.isAdaptive ? ' ' + DISABLE_CLASS : ''),\n                    innerHTML: timeStr\n                });\n                const appointmentLocation = createElement('div', {\n                    className: LOCATION_CLASS,\n                    innerHTML: (record[fieldMapping.location] || this.parent.eventSettings.fields.location.default || '')\n                });\n                templateElement = [appointmentSubject, appointmentTime, appointmentLocation];\n            }\n        }\n        append(templateElement, appointmentDetails);\n        if (!this.parent.isAdaptive &&\n            (!isNullOrUndefined(record[fieldMapping.recurrenceRule]) || !isNullOrUndefined(record[fieldMapping.recurrenceID]))) {\n            const iconClass = (record[fieldMapping.id] === record[fieldMapping.recurrenceID]) ?\n                EVENT_RECURRENCE_ICON_CLASS : EVENT_RECURRENCE_EDIT_ICON_CLASS;\n            const recurrenceIcon = createElement('div', { className: ICON + ' ' + iconClass });\n            if (isAllDay) {\n                appointmentDetails.appendChild(recurrenceIcon);\n            }\n            else {\n                appointmentWrapper.appendChild(recurrenceIcon);\n            }\n        }\n        this.renderSpannedIcon(isAllDay ? appointmentDetails : appointmentWrapper, eventData);\n        if (!isNullOrUndefined(this.cssClass)) {\n            addClass([appointmentWrapper], this.cssClass);\n        }\n        this.applyResourceColor(appointmentWrapper, record, 'backgroundColor', this.groupOrder);\n        this.renderResizeHandler(appointmentWrapper, eventData, record[this.fields.isReadonly]);\n        return appointmentWrapper;\n    }\n    createMoreIndicator(allDayRow, count, currentDay) {\n        const index = currentDay + count;\n        const countWrapper = allDayRow[index];\n        if (countWrapper.childElementCount <= 0) {\n            const innerCountWrap = createElement('div', {\n                className: ROW_COUNT_WRAPPER_CLASS,\n                id: ROW_COUNT_WRAPPER_CLASS + '-' + index.toString()\n            });\n            const moreIndicatorElement = createElement('div', {\n                className: MORE_INDICATOR_CLASS,\n                attrs: { 'tabindex': '0', 'data-index': index.toString(), 'data-count': '1' },\n                innerHTML: '+1&nbsp;' + (this.parent.isAdaptive ? '' : this.parent.localeObj.getConstant('more'))\n            });\n            innerCountWrap.appendChild(moreIndicatorElement);\n            countWrapper.appendChild(innerCountWrap);\n            EventHandler.add(moreIndicatorElement, 'click', this.rowExpandCollapse, this);\n        }\n        else {\n            const countCell = countWrapper.querySelector('.' + MORE_INDICATOR_CLASS);\n            const moreCount = parseInt(countCell.getAttribute('data-count'), 10) + 1;\n            countCell.setAttribute('data-count', moreCount.toString());\n            countCell.innerHTML = '+' + this.parent.globalize.formatNumber(moreCount) + '&nbsp;' + (this.parent.isAdaptive ? '' : this.parent.localeObj.getConstant('more'));\n        }\n    }\n    renderSpannedIcon(element, spanEvent) {\n        const iconElement = createElement('div', { className: EVENT_INDICATOR_CLASS + ' ' + ICON });\n        if (spanEvent.isLeft) {\n            const iconLeft = iconElement.cloneNode();\n            addClass([iconLeft], EVENT_ICON_LEFT_CLASS);\n            prepend([iconLeft], element);\n        }\n        if (spanEvent.isRight) {\n            const iconRight = iconElement.cloneNode();\n            addClass([iconRight], EVENT_ICON_RIGHT_CLASS);\n            append([iconRight], element);\n        }\n        if (spanEvent.isTop) {\n            const iconTop = iconElement.cloneNode();\n            addClass([iconTop], EVENT_ICON_UP_CLASS);\n            prepend([iconTop], element);\n        }\n        if (spanEvent.isBottom) {\n            const iconBottom = iconElement.cloneNode();\n            addClass([iconBottom], EVENT_ICON_DOWN_CLASS);\n            append([iconBottom], element);\n        }\n    }\n    isSpannedEvent(record, day, resource) {\n        let currentDate = resetTime(this.dateRender[resource][day]);\n        const renderedDate = this.getRenderedDates(this.dateRender[resource]) || [currentDate];\n        const currentDay = renderedDate.filter((date) => date.getDay() === day);\n        if (currentDay.length === 0) {\n            currentDate = resetTime(renderedDate[0]);\n        }\n        const field = this.parent.eventFields;\n        const schedule = getStartEndHours(currentDate, this.startHour, this.endHour);\n        const event = extend({}, record, null, true);\n        event.isSpanned = { isBottom: false, isTop: false };\n        if (record[field.startTime].getTime() < schedule.startHour.getTime()) {\n            event[field.startTime] = schedule.startHour;\n            event.isSpanned.isTop = true;\n        }\n        if (record[field.endTime].getTime() > schedule.endHour.getTime()) {\n            event[field.endTime] = schedule.endHour;\n            event.isSpanned.isBottom = true;\n        }\n        const eventDates = this.updateEventMinimumDuration(schedule, event[field.startTime], event[field.endTime]);\n        event[field.startTime] = eventDates.startDate;\n        event[field.endTime] = eventDates.endDate;\n        return event;\n    }\n    renderAllDayEvents(eventObj, dayIndex, resource, dayCount, inline) {\n        let currentDates = this.getRenderedDates(this.dateRender[resource]) || this.dateRender[resource];\n        if (this.parent.activeViewOptions.group.byDate) {\n            this.slots[0] = [this.dateRender[resource][dayIndex].getTime()];\n            currentDates = [this.dateRender[resource][dayIndex]];\n        }\n        const record = this.splitEvent(eventObj, currentDates)[0];\n        const allDayRowCell = this.element.querySelector('.' + ALLDAY_CELLS_CLASS + ':first-child');\n        const cellTop = allDayRowCell.offsetTop;\n        const eStart = new Date(record[this.parent.eventFields.startTime].getTime());\n        const eEnd = new Date(record[this.parent.eventFields.endTime].getTime());\n        let appWidth = 0;\n        let topValue = 1;\n        const isDateRange = currentDates[0].getTime() <= eStart.getTime() &&\n            addDays(currentDates.slice(-1)[0], 1).getTime() >= eStart.getTime();\n        if (eStart <= eEnd && isDateRange) {\n            let isAlreadyRendered = [];\n            if (this.renderedAllDayEvents[resource]) {\n                isAlreadyRendered = this.renderedAllDayEvents[resource].filter((event) => event.Guid === eventObj.Guid);\n                if (this.parent.activeViewOptions.group.byDate) {\n                    isAlreadyRendered = isAlreadyRendered.filter((event) => event[this.parent.eventFields.startTime] >= currentDates[dayIndex] &&\n                        event[this.parent.eventFields.endTime] <= addDays(new Date(+currentDates[dayIndex]), 1));\n                }\n            }\n            if (isAlreadyRendered.length === 0) {\n                const allDayDifference = record.data.count;\n                const allDayIndex = this.getOverlapIndex(record, dayIndex, true, resource);\n                record.Index = allDayIndex;\n                this.allDayLevel = (this.allDayLevel < allDayIndex) ? allDayIndex : this.allDayLevel;\n                const widthAdjustment = record.data.isRight ? 0 :\n                    this.parent.currentView === 'Day' ? 4 : 7;\n                if (allDayDifference >= 0) {\n                    appWidth = (allDayDifference * 100) - widthAdjustment;\n                }\n                if (isNullOrUndefined(this.renderedAllDayEvents[resource])) {\n                    this.renderedAllDayEvents[resource] = [];\n                }\n                this.renderedAllDayEvents[resource].push(extend({}, record, null, true));\n                const allDayRow = [].slice.call(this.element.querySelector('.' + ALLDAY_ROW_CLASS).children);\n                const wIndex = this.parent.activeViewOptions.group.byDate ?\n                    (this.resources.length * dayIndex) + resource : dayCount;\n                const eventWrapper = this.element.querySelector('.' + ALLDAY_APPOINTMENT_WRAPPER_CLASS +\n                    ':nth-child(' + (wIndex + 1) + ')');\n                let appointmentElement;\n                if (inline) {\n                    appointmentElement = this.parent.inlineModule.createInlineAppointmentElement(eventObj);\n                }\n                else {\n                    appointmentElement = this.createAppointmentElement(eventObj, true, record.data, resource);\n                }\n                addClass([appointmentElement], ALLDAY_APPOINTMENT_CLASS);\n                const eventData = extend({}, record.data, null, true);\n                eventObj.data = eventData;\n                const args = { data: eventObj, element: appointmentElement, cancel: false };\n                this.parent.trigger(eventRendered, args, (eventArgs) => {\n                    if (!eventArgs.cancel) {\n                        eventWrapper.appendChild(appointmentElement);\n                        const appHeight = appointmentElement.offsetHeight;\n                        topValue += (allDayIndex === 0 ? cellTop : (cellTop + (allDayIndex * appHeight))) + 1;\n                        setStyleAttribute(appointmentElement, { 'width': appWidth + '%', 'top': formatUnit(topValue) });\n                        if (allDayIndex > 1) {\n                            this.moreEvents.push(appointmentElement);\n                            for (let count = 0, length = allDayDifference; count < length; count++) {\n                                this.createMoreIndicator(allDayRow, count, wIndex);\n                            }\n                        }\n                        allDayRowCell.setAttribute('data-count', this.allDayLevel.toString());\n                        const allDayRowHeight = ((!this.parent.uiStateValues.expand && this.allDayLevel > 2) ?\n                            (3 * appHeight) : ((this.allDayLevel + 1) * appHeight)) + 4;\n                        this.setAllDayRowHeight(allDayRowHeight);\n                        this.addOrRemoveClass();\n                        this.wireAppointmentEvents(appointmentElement, eventObj);\n                    }\n                });\n            }\n        }\n    }\n    renderNormalEvents(eventObj, dayIndex, resource, dayCount, inline) {\n        const record = this.isSpannedEvent(eventObj, dayIndex, resource);\n        const eStart = record[this.fields.startTime];\n        const eEnd = record[this.fields.endTime];\n        let appWidth = '0%';\n        const appLeft = '0%';\n        let topValue = 0;\n        const currentDate = resetTime(new Date(this.dateRender[resource][dayIndex].getTime()));\n        const schedule = getStartEndHours(currentDate, this.startHour, this.endHour);\n        const isValidEvent = this.isValidEvent(eventObj, eStart, eEnd, schedule);\n        if ((eStart.getTime() < this.parent.minDate.getTime()) || (eEnd.getTime() > this.parent.maxDate.getTime())) {\n            return;\n        }\n        if (eStart <= eEnd && isValidEvent) {\n            const appHeight = this.getHeight(eStart, eEnd);\n            if (eStart.getTime() > schedule.startHour.getTime()) {\n                topValue = this.getTopValue(eStart, dayIndex, resource);\n            }\n            const appIndex = this.getOverlapIndex(record, dayIndex, false, resource);\n            record.Index = appIndex;\n            this.overlapList.push(record);\n            if (this.overlapList.length > 1) {\n                if (isNullOrUndefined(this.overlapEvents[appIndex])) {\n                    this.overlapEvents[appIndex] = [];\n                }\n                this.overlapEvents[appIndex].push(record);\n            }\n            else {\n                this.overlapEvents = [];\n                this.overlapEvents.push([record]);\n            }\n            appWidth = this.getEventWidth();\n            const argsData = {\n                index: appIndex, left: appLeft, width: appWidth,\n                day: dayIndex, dayIndex: dayCount, record: record, resource: resource\n            };\n            const tempData = this.adjustOverlapElements(argsData);\n            appWidth = (tempData.appWidth);\n            if (isNullOrUndefined(this.renderedEvents[resource])) {\n                this.renderedEvents[resource] = [];\n            }\n            this.renderedEvents[resource].push(extend({}, record, null, true));\n            let appointmentElement;\n            if (inline) {\n                appointmentElement = this.parent.inlineModule.createInlineAppointmentElement(eventObj);\n            }\n            else {\n                appointmentElement = this.createAppointmentElement(eventObj, false, record.isSpanned, resource);\n            }\n            setStyleAttribute(appointmentElement, {\n                'width': (this.parent.eventSettings.enableMaxHeight ? '100%' : tempData.appWidth),\n                'height': appHeight + 'px', 'top': topValue + 'px'\n            });\n            const iconHeight = appointmentElement.querySelectorAll('.' + EVENT_INDICATOR_CLASS).length * 15;\n            const maxHeight = appHeight - 40 - iconHeight;\n            const subjectElement = appointmentElement.querySelector('.' + SUBJECT_CLASS);\n            if (!this.parent.isAdaptive && subjectElement) {\n                subjectElement.style.maxHeight = formatUnit(maxHeight);\n            }\n            const index = this.parent.activeViewOptions.group.byDate ? (this.resources.length * dayIndex) + resource : dayCount;\n            const eventData = {};\n            eventData[this.fields.startTime] = eventObj[this.fields.startTime];\n            eventData[this.fields.endTime] = eventObj[this.fields.endTime];\n            record.data = eventData;\n            this.appendEvent(record, appointmentElement, index, tempData.appLeft);\n            this.wireAppointmentEvents(appointmentElement, eventObj);\n            if (appHeight < this.cellHeight) {\n                const resizeHandlers = [].slice.call(appointmentElement.querySelectorAll('.' + EVENT_RESIZE_CLASS));\n                resizeHandlers.forEach((resizeHandler) => {\n                    resizeHandler.style.height = Math.ceil(appHeight / resizeHandler.offsetHeight) + 'px';\n                });\n            }\n        }\n    }\n    getEventWidth() {\n        const width = this.parent.currentView === 'Day' ? 97 : 94;\n        const tempWidth = ((width - this.overlapEvents.length) / this.overlapEvents.length);\n        return (tempWidth < 0 ? 0 : tempWidth) + '%';\n    }\n    getEventLeft(appWidth, index) {\n        const tempLeft = (parseFloat(appWidth) + 1) * index;\n        return (tempLeft > 99 ? 99 : tempLeft) + '%';\n    }\n    getTopValue(date, day, resource) {\n        const startEndHours = getStartEndHours(resetTime(this.dateRender[resource][day]), this.startHour, this.endHour);\n        const startHour = startEndHours.startHour;\n        const diffInMinutes = ((date.getHours() - startHour.getHours()) * 60) + (date.getMinutes() - startHour.getMinutes());\n        return (this.parent.activeViewOptions.timeScale.enable) ? ((diffInMinutes * this.cellHeight * this.slotCount) / this.interval) : 0;\n    }\n    getOverlapIndex(record, day, isAllDay, resource) {\n        const fieldMapping = this.parent.eventFields;\n        let eventsList = [];\n        let appIndex = -1;\n        this.overlapEvents = [];\n        if (isAllDay) {\n            if (!isNullOrUndefined(this.renderedAllDayEvents[resource])) {\n                const date = resetTime(new Date(this.dateRender[resource][day].getTime()));\n                eventsList = this.renderedAllDayEvents[resource].filter((app) => resetTime(app[fieldMapping.startTime]).getTime() <= date.getTime() &&\n                    resetTime(app[fieldMapping.endTime]).getTime() >= date.getTime());\n                if (this.parent.activeViewOptions.group.resources.length > 0) {\n                    eventsList = this.filterEventsByResource(this.resources[resource], eventsList);\n                }\n            }\n        }\n        else {\n            const appointmentList = !isNullOrUndefined(this.renderedEvents[resource]) ?\n                this.renderedEvents[resource] : [];\n            let appointment = [];\n            const recordStart = record[fieldMapping.startTime];\n            const recordEnd = record[fieldMapping.endTime];\n            this.overlapList = appointmentList.filter((data) => (data[fieldMapping.endTime] > recordStart && data[fieldMapping.startTime] <= recordEnd) ||\n                (data[fieldMapping.startTime] >= recordEnd && data[fieldMapping.endTime] <= recordStart) ||\n                (data[fieldMapping.endTime].getTime() === data[fieldMapping.startTime].getTime() &&\n                    data[fieldMapping.startTime].getTime() === recordStart.getTime() && data[fieldMapping.endTime] < recordEnd));\n            if (this.parent.activeViewOptions.group.resources.length > 0) {\n                this.overlapList = this.filterEventsByResource(this.resources[resource], this.overlapList);\n            }\n            this.overlapList.forEach((obj) => {\n                let filterList = appointmentList.filter((data) => data[fieldMapping.endTime] > obj[fieldMapping.startTime] && data[fieldMapping.startTime] <= obj[fieldMapping.endTime]);\n                if (this.parent.activeViewOptions.group.resources.length > 0) {\n                    filterList = this.filterEventsByResource(this.resources[resource], filterList);\n                }\n                const collection = filterList.filter((val) => this.overlapList.indexOf(val) === -1);\n                if (collection.length > 0) {\n                    appointment = appointment.concat(collection);\n                }\n            });\n            for (let i = 0; i < appointment.length - 1; i++) {\n                for (let j = i + 1; j < appointment.length; j++) {\n                    if (appointment[i][fieldMapping.id] === appointment[j][fieldMapping.id]) {\n                        appointment.splice(j, 1);\n                        j--;\n                    }\n                }\n            }\n            this.overlapList = this.overlapList.concat(appointment);\n            eventsList = this.overlapList;\n            for (const event of eventsList) {\n                const record = event;\n                const index = record.Index;\n                if (isNullOrUndefined(this.overlapEvents[index])) {\n                    this.overlapEvents[index] = [event];\n                }\n                else {\n                    this.overlapEvents[index].push(event);\n                }\n            }\n        }\n        if (!isAllDay) {\n            eventsList = eventsList.filter((obj) => (obj[fieldMapping.startTime] === record[fieldMapping.startTime] &&\n                obj[fieldMapping.endTime] > record[fieldMapping.endTime] || obj[fieldMapping.endTime] > record[fieldMapping.startTime] &&\n                obj[fieldMapping.startTime] < record[fieldMapping.endTime] || obj[fieldMapping.endTime] === record[fieldMapping.startTime]\n                && obj[fieldMapping.startTime] === record[fieldMapping.endTime]) ||\n                ((obj[fieldMapping.startTime].getTime() === record[fieldMapping.startTime].getTime() &&\n                    obj[fieldMapping.endTime].getTime() === record[fieldMapping.endTime].getTime())\n                    || (obj[fieldMapping.startTime].getTime() === record[fieldMapping.startTime].getTime() &&\n                        obj[fieldMapping.endTime].getTime() < record[fieldMapping.endTime].getTime() ||\n                        obj[fieldMapping.endTime].getTime() > record[fieldMapping.endTime].getTime())));\n        }\n        if (eventsList.length > 0) {\n            const appLevel = eventsList.map((obj) => obj.Index);\n            appIndex = (appLevel.length > 0) ? this.getSmallestMissingNumber(appLevel) : 0;\n        }\n        return (appIndex === -1) ? 0 : appIndex;\n    }\n    adjustOverlapElements(args) {\n        const data = { appWidth: args.width, appLeft: args.left };\n        for (let i = 0, length1 = this.overlapEvents.length; i < length1; i++) {\n            if (!isNullOrUndefined(this.overlapEvents[i])) {\n                for (let j = 0, length2 = this.overlapEvents[i].length; j < length2; j++) {\n                    const dayCount = this.parent.activeViewOptions.group.byDate ?\n                        (this.resources.length * args.day) + args.resource : args.dayIndex;\n                    const element = this.element.querySelector('#e-appointment-wrapper-' + dayCount);\n                    if (element.childElementCount > 0) {\n                        const eleGuid = this.overlapEvents[i][j].Guid;\n                        if (element.querySelectorAll('div[data-guid=\"' + eleGuid + '\"]').length > 0 && eleGuid !== args.record.Guid) {\n                            const apps = element.querySelector('div[data-guid=\"' + eleGuid + '\"]');\n                            if (parseFloat(args.width) <= parseFloat(apps.style.width)) {\n                                if (this.parent.enableRtl) {\n                                    apps.style.right = this.getEventLeft(args.width, i);\n                                }\n                                else {\n                                    apps.style.left = this.getEventLeft(args.width, i);\n                                }\n                                apps.style.width = ((parseFloat(args.width))) + '%';\n                                data.appWidth = apps.style.width;\n                            }\n                            else {\n                                data.appWidth = apps.style.width;\n                            }\n                        }\n                        else {\n                            let appWidth = args.width;\n                            if (isNullOrUndefined(this.overlapEvents[i - 1])) {\n                                appWidth = this.getEventWidth();\n                            }\n                            data.appWidth = appWidth;\n                            data.appLeft = this.getEventLeft(appWidth, args.index);\n                        }\n                    }\n                }\n            }\n        }\n        return data;\n    }\n    setAllDayRowHeight(height) {\n        const dateHeader = this.parent.element.querySelector('.' + DATE_HEADER_WRAP_CLASS);\n        if (this.parent.height === 'auto' || !this.parent.enableAllDayScroll) {\n            addClass([dateHeader], ALLDAY_APPOINTMENT_AUTO);\n        }\n        const allDayRow = this.parent.element.querySelector('.' + ALLDAY_ROW_CLASS);\n        allDayRow.style.height = '';\n        if (this.parent.uiStateValues.expand && this.parent.height !== 'auto' && this.parent.enableAllDayScroll) {\n            allDayRow.style.height = (height / 12) + 'em';\n            this.parent.eventBase.allDayExpandScroll(dateHeader);\n        }\n        else {\n            dateHeader.scrollTop = 0;\n            for (const element of this.allDayElement) {\n                element.style.height = (height / 12) + 'em';\n            }\n            removeClass([dateHeader], ALLDAY_APPOINTMENT_SCROLL);\n        }\n        this.animation.animate(this.allDayElement[0]);\n    }\n    addOrRemoveClass() {\n        this.moreEvents.filter((element) => {\n            if (!this.parent.uiStateValues.expand && this.allDayLevel > 2) {\n                addClass([element], EVENT_COUNT_CLASS);\n                element.setAttribute('tabindex', '-1');\n            }\n            else {\n                removeClass([element], EVENT_COUNT_CLASS);\n                element.setAttribute('tabindex', '0');\n            }\n        });\n        const moreEventCount = this.element.querySelector('.' + ALLDAY_APPOINTMENT_SECTION_CLASS);\n        if (this.parent.uiStateValues.expand) {\n            removeClass([moreEventCount], APPOINTMENT_ROW_EXPAND_CLASS);\n            addClass([moreEventCount], APPOINTMENT_ROW_COLLAPSE_CLASS);\n        }\n        else {\n            removeClass([moreEventCount], APPOINTMENT_ROW_COLLAPSE_CLASS);\n            addClass([moreEventCount], APPOINTMENT_ROW_EXPAND_CLASS);\n        }\n        if (this.allDayLevel > 2) {\n            removeClass([moreEventCount], DISABLE_CLASS);\n        }\n        else {\n            addClass([moreEventCount], DISABLE_CLASS);\n        }\n        const countCell = [].slice.call(this.element.querySelectorAll('.' + ROW_COUNT_WRAPPER_CLASS));\n        countCell.forEach((element) => {\n            if (!this.parent.uiStateValues.expand && this.allDayLevel > 2) {\n                removeClass([element], DISABLE_CLASS);\n            }\n            else {\n                addClass([element], DISABLE_CLASS);\n            }\n        });\n    }\n    getEventHeight() {\n        const eventElement = createElement('div', { className: APPOINTMENT_CLASS, styles: 'visibility:hidden' });\n        const eventWrapper = this.element.querySelector('.' + ALLDAY_APPOINTMENT_WRAPPER_CLASS + ':first-child');\n        eventWrapper.appendChild(eventElement);\n        const height = eventElement.offsetHeight;\n        remove(eventElement);\n        return height;\n    }\n    rowExpandCollapse() {\n        const target = this.element.querySelector('.' + ALLDAY_APPOINTMENT_SECTION_CLASS);\n        this.parent.uiStateValues.expand = target.classList.contains(APPOINTMENT_ROW_EXPAND_CLASS);\n        let rowHeight;\n        if (this.parent.uiStateValues.expand) {\n            target.setAttribute('title', this.parent.localeObj.getConstant('collapseAllDaySection'));\n            target.setAttribute('aria-label', 'Collapse section');\n            rowHeight = ((this.allDayLevel + 1) * this.getEventHeight()) + 4;\n        }\n        else {\n            target.setAttribute('title', this.parent.localeObj.getConstant('expandAllDaySection'));\n            target.setAttribute('aria-label', 'Expand section');\n            rowHeight = (3 * this.getEventHeight()) + 4;\n        }\n        this.setAllDayRowHeight(rowHeight);\n        this.addOrRemoveClass();\n        this.animation.animate(target);\n    }\n    animationUiUpdate() {\n        this.parent.notify(contentReady, {});\n    }\n    destroy() {\n        if (!this.parent || this.parent && this.parent.isDestroyed) {\n            return;\n        }\n        this.removeEventListener();\n        this.allDayElement = null;\n        this.renderedAllDayEvents = null;\n        this.renderedEvents = null;\n        this.slotCount = null;\n        this.interval = null;\n        this.startHour = null;\n        this.endHour = null;\n        this.element = null;\n        this.fields = null;\n        this.animation = null;\n        super.destroy();\n    }\n}\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\nconst EVENT_GAP = 0;\n/**\n * Month view events render\n */\nclass MonthEvent extends EventBase {\n    constructor(parent) {\n        super(parent);\n        this.renderedEvents = [];\n        this.monthHeaderHeight = 0;\n        this.moreIndicatorHeight = 19;\n        this.renderType = 'day';\n        this.element = this.parent.activeView.getPanel();\n        this.fields = this.parent.eventFields;\n        this.maxHeight = this.parent.eventSettings.enableMaxHeight && !this.parent.eventSettings.enableIndicator\n            && !this.parent.rowAutoHeight;\n        this.withIndicator = this.parent.eventSettings.enableMaxHeight && this.parent.eventSettings.enableIndicator\n            && !this.parent.rowAutoHeight;\n        this.maxOrIndicator = (this.maxHeight || this.withIndicator);\n        this.moreIndicatorHeight =\n            (this.parent.rowAutoHeight && this.parent.eventSettings.ignoreWhitespace) ? 0 : this.moreIndicatorHeight;\n        this.addEventListener();\n    }\n    removeEventWrapper(appElement) {\n        if (appElement.length > 0) {\n            appElement = (this.parent.currentView === 'Month') ? appElement : [appElement[0]];\n            for (const wrap of appElement) {\n                if (wrap.parentElement && wrap.parentElement.parentNode) {\n                    remove(wrap.parentElement);\n                }\n            }\n        }\n    }\n    renderAppointments() {\n        if (this.parent.dragAndDropModule) {\n            this.parent.dragAndDropModule.setDragArea();\n        }\n        const conWrap = this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS);\n        if (this.parent.rowAutoHeight) {\n            this.parent.uiStateValues.top = conWrap.scrollTop;\n            this.parent.uiStateValues.left = conWrap.scrollLeft;\n        }\n        const appointmentWrapper = [].slice.call(this.element.querySelectorAll('.' + APPOINTMENT_WRAPPER_CLASS));\n        if (this.parent.crudModule && this.parent.crudModule.crudObj.isCrudAction) {\n            for (let i = 0, len = this.parent.crudModule.crudObj.sourceEvent.length; i < len; i++) {\n                const appElement = [].slice.call(this.element.querySelectorAll('.e-appointment-wrapper ' + '[data-group-index=\"' +\n                    this.parent.crudModule.crudObj.sourceEvent[i].groupIndex + '\"]'));\n                this.removeEventWrapper(appElement);\n                if (this.parent.crudModule.crudObj.targetEvent[i] && this.parent.crudModule.crudObj.sourceEvent[i].groupIndex !==\n                    this.parent.crudModule.crudObj.targetEvent[i].groupIndex) {\n                    const ele = [].slice.call(this.element.querySelectorAll('.e-appointment-wrapper ' + '[data-group-index=\"' +\n                        this.parent.crudModule.crudObj.targetEvent[i].groupIndex + '\"]'));\n                    this.removeEventWrapper(ele);\n                }\n            }\n        }\n        else {\n            for (const wrap of appointmentWrapper) {\n                remove(wrap);\n            }\n        }\n        this.removeHeightProperty(CONTENT_TABLE_CLASS);\n        if (!this.element.querySelector('.' + WORK_CELLS_CLASS)) {\n            return;\n        }\n        if (this.parent.currentView === 'Month') {\n            const wrapper = createElement('div', { className: APPOINTMENT_WRAPPER_CLASS });\n            const cellTd = this.parent.element.querySelector('.' + WORK_CELLS_CLASS);\n            cellTd.appendChild(wrapper);\n            this.monthHeaderHeight = wrapper.offsetTop - cellTd.offsetTop;\n            cellTd.removeChild(wrapper);\n        }\n        this.eventHeight = getElementHeightFromClass(this.element, APPOINTMENT_CLASS);\n        const scrollTop = conWrap.scrollTop;\n        if (this.parent.rowAutoHeight && this.parent.virtualScrollModule && !isNullOrUndefined(this.parent.currentAction)) {\n            conWrap.scrollTop = conWrap.scrollTop - 1;\n        }\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            this.renderResourceEvents();\n            if (this.parent.virtualScrollModule) {\n                this.parent.virtualScrollModule.updateFocusedWorkCell();\n            }\n        }\n        else {\n            this.renderEventsHandler(this.parent.activeView.renderDates, this.parent.activeViewOptions.workDays);\n        }\n        if (this.parent.rowAutoHeight) {\n            this.updateBlockElements();\n            const data = {\n                cssProperties: this.parent.getCssProperties(),\n                module: this.parent.getModuleName(),\n                isPreventScrollUpdate: true,\n                scrollPosition: { left: this.parent.uiStateValues.left, top: this.parent.uiStateValues.top }\n            };\n            if (this.parent.virtualScrollModule) {\n                if (this.parent.currentAction) {\n                    conWrap.scrollTop = scrollTop;\n                    this.parent.currentAction = null;\n                }\n                else {\n                    this.parent.virtualScrollModule.updateVirtualScrollHeight();\n                }\n            }\n            if (!this.parent.enablePersistence) {\n                this.parent.notify(contentReady, {});\n            }\n            this.parent.notify(scrollUiUpdate, data);\n            if (this.parent.currentView === 'Month' && this.parent.showWeekNumber) {\n                const totalCells = [].slice.call(this.parent.element.querySelectorAll('.e-content-wrap table tr td:first-child'));\n                const weekNumberCells = [].slice.call(this.parent.element.querySelectorAll('.' + WEEK_NUMBER_CLASS));\n                weekNumberCells.forEach((cell, i) => {\n                    const height = totalCells[i].offsetHeight;\n                    setStyleAttribute(cell, { 'height': height + 'px' });\n                });\n                this.parent.element.querySelector('.' + WEEK_NUMBER_WRAPPER_CLASS).scrollTop =\n                    this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS).scrollTop;\n            }\n        }\n        this.parent.renderTemplates();\n    }\n    renderEventsHandler(dateRender, workDays, resData) {\n        this.renderedEvents = [];\n        let eventsList;\n        let blockList;\n        let resIndex = 0;\n        if (resData) {\n            resIndex = resData.groupIndex;\n            this.cssClass = resData.cssClass;\n            this.groupOrder = resData.groupOrder;\n            eventsList = this.parent.eventBase.filterEventsByResource(resData, this.parent.eventsProcessed);\n            blockList = this.parent.eventBase.filterEventsByResource(resData, this.parent.blockProcessed);\n            this.workCells = [].slice.call(this.element.querySelectorAll('.' + WORK_CELLS_CLASS + '[data-group-index=\"' + resIndex + '\"]'));\n        }\n        else {\n            eventsList = this.parent.eventsProcessed;\n            blockList = this.parent.blockProcessed;\n            this.workCells = [].slice.call(this.element.querySelectorAll('.' + WORK_CELLS_CLASS));\n        }\n        this.sortByDateTime(eventsList);\n        this.sortByDateTime(blockList);\n        if (this.parent.currentView === 'Month' && this.parent.rowAutoHeight && this.parent.activeViewOptions.group.resources.length === 0) {\n            const totalCells = [].slice.call(this.parent.element.querySelectorAll('.e-content-wrap table tr td:first-child'));\n            const height = this.parent.element.querySelector('.' + CONTENT_TABLE_CLASS).clientHeight / totalCells.length;\n            totalCells.forEach((cell) => {\n                setStyleAttribute(cell, { 'height': height + 'px' });\n            });\n        }\n        const cellDetail = this.workCells[this.parent.activeView.isTimelineView() ?\n            0 : this.workCells.length - 1].getBoundingClientRect();\n        this.cellWidth = cellDetail.width;\n        this.cellHeight = cellDetail.height;\n        this.dateRender = dateRender;\n        const filteredDates = this.getRenderedDates(dateRender);\n        this.getSlotDates(workDays || this.parent.activeViewOptions.workDays);\n        this.processBlockEvents(blockList, resIndex, resData);\n        let events = [];\n        for (const event of eventsList) {\n            if (this.parent.resourceBase && !resData) {\n                this.cssClass = this.parent.resourceBase.getCssClass(event);\n            }\n            events = events.concat(this.splitEvent(event, filteredDates || this.dateRender));\n        }\n        for (let level = 0; level < this.slots.length; level++) {\n            this.renderedEvents = [];\n            const slot = this.slots[level];\n            const endDate = addDays(new Date(slot[slot.length - 1]), 1);\n            const spannedEvents = this.filterEvents(new Date(slot[0]), endDate, events);\n            for (const event of spannedEvents) {\n                if (this.maxHeight) {\n                    const sDate = this.parent.currentView === 'Month' ? event[this.fields.startTime] :\n                        this.getStartTime(event, event.data);\n                    if (this.getIndex(sDate) > 0) {\n                        continue;\n                    }\n                }\n                this.updateIndicatorIcon(event);\n                this.renderEvents(event, resIndex, eventsList);\n            }\n        }\n        this.cssClass = null;\n        this.groupOrder = null;\n    }\n    processBlockEvents(blockEvents, resIndex, resData) {\n        for (const event of blockEvents) {\n            if (this.parent.resourceBase && !resData) {\n                this.cssClass = this.parent.resourceBase.getCssClass(event);\n            }\n            const blockSpannedList = [];\n            if (this.renderType === 'day' && !event[this.fields.isAllDay]) {\n                const temp = extend({}, event, null, true);\n                let isSameDate = this.isSameDate(temp[this.fields.startTime], temp[this.fields.endTime]);\n                temp.isBlockIcon = isSameDate;\n                if (!isSameDate && getDateInMs(temp[this.fields.startTime]) > 0) {\n                    const e = extend({}, event, null, true);\n                    e[this.fields.endTime] = addDays(resetTime(new Date(event[this.fields.startTime] + '')), 1);\n                    e.isBlockIcon = true;\n                    temp[this.fields.startTime] = e[this.fields.endTime];\n                    blockSpannedList.push(e);\n                }\n                isSameDate = this.isSameDate(temp[this.fields.startTime], temp[this.fields.endTime]);\n                if (!isSameDate && getDateInMs(temp[this.fields.endTime]) > 0) {\n                    const e = extend({}, event, null, true);\n                    e[this.fields.startTime] = resetTime(new Date(event[this.fields.endTime] + ''));\n                    e.isBlockIcon = true;\n                    blockSpannedList.push(e);\n                    temp[this.fields.endTime] = e[this.fields.startTime];\n                }\n                blockSpannedList.push(temp);\n            }\n            else {\n                blockSpannedList.push(event);\n            }\n            for (const blockEvent of blockSpannedList) {\n                const spannedEvents = this.splitEvent(blockEvent, this.dateRender);\n                for (const event of spannedEvents) {\n                    this.renderBlockEvents(event, resIndex, !!blockEvent.isBlockIcon);\n                }\n            }\n        }\n    }\n    isSameDate(start, end) {\n        return new Date(+start).setHours(0, 0, 0, 0) === new Date(+end).setHours(0, 0, 0, 0);\n    }\n    renderBlockEvents(event, resIndex, isIcon) {\n        const eventData = event.data;\n        const startTime = this.getStartTime(event, eventData);\n        const endTime = this.getEndTime(event, eventData);\n        const day = this.parent.getIndexOfDate(this.dateRender, resetTime(new Date(startTime.getTime())));\n        if (day < 0 || startTime > endTime) {\n            return;\n        }\n        const cellTd = this.getCellTd(day);\n        const position = this.getPosition(startTime, endTime, event[this.fields.isAllDay], day);\n        if (!isIcon) {\n            const diffInDays = eventData.count;\n            let appWidth = this.getEventWidth(startTime, endTime, event[this.fields.isAllDay], diffInDays);\n            appWidth = (appWidth <= 0) ? this.cellWidth : appWidth;\n            const appLeft = (this.parent.enableRtl) ? 0 : position;\n            const appRight = (this.parent.enableRtl) ? position : 0;\n            const appHeight = this.cellHeight - this.monthHeaderHeight;\n            const appTop = this.getRowTop(resIndex);\n            const blockElement = this.createBlockAppointmentElement(event, resIndex);\n            setStyleAttribute(blockElement, {\n                'width': appWidth + 'px', 'height': appHeight + 'px', 'left': appLeft + 'px',\n                'right': appRight + 'px', 'top': appTop + 'px'\n            });\n            this.renderEventElement(event, blockElement, cellTd);\n        }\n        else {\n            this.renderBlockIndicator(cellTd, position, resIndex);\n        }\n    }\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    renderBlockIndicator(cellTd, position, resIndex) {\n        const blockIndicator = createElement('div', { className: 'e-icons ' + BLOCK_INDICATOR_CLASS });\n        if (isNullOrUndefined(cellTd.querySelector('.' + BLOCK_INDICATOR_CLASS))) {\n            cellTd.appendChild(blockIndicator);\n        }\n    }\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    getStartTime(event, eventData) {\n        return event[this.fields.startTime];\n    }\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    getEndTime(event, eventData) {\n        return event[this.fields.endTime];\n    }\n    getCellTd(day) {\n        return this.workCells[day];\n    }\n    getEventWidth(startDate, endDate, isAllDay, count) {\n        return count * this.cellWidth - 1;\n    }\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    getPosition(startTime, endTime, isAllDay, day) {\n        return 0;\n    }\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    getRowTop(resIndex) {\n        return 0;\n    }\n    updateIndicatorIcon(event) {\n        if (this.parent.currentView.indexOf('Timeline') === -1 || this.parent.currentView === 'TimelineMonth'\n            || event[this.fields.isAllDay]) {\n            return;\n        }\n        const cloneData = event.data;\n        const start = this.parent.activeView.getStartHour();\n        const end = this.parent.activeView.getEndHour();\n        const startHour = getStartEndHours(event[this.fields.startTime], start, end);\n        const endHour = getStartEndHours(event[this.fields.endTime], start, end);\n        const actualStartTime = cloneData[this.fields.startTime];\n        const actualEndTime = cloneData[this.fields.endTime];\n        cloneData.isLeft = cloneData.isLeft || actualStartTime.getTime() < startHour.startHour.getTime();\n        cloneData.isRight = cloneData.isRight || actualEndTime.getTime() > endHour.endHour.getTime();\n        if (resetTime(actualStartTime).getTime() !== resetTime(actualEndTime).getTime()) {\n            const actualStartHour = startHour.startHour;\n            const actualEndHour = endHour.endHour;\n            const startTime = new Date(resetTime(actualStartTime));\n            startTime.setHours(actualEndHour.getHours(), actualEndHour.getMinutes(), actualEndHour.getSeconds());\n            cloneData.isLeft = cloneData.isLeft || actualStartTime.getTime() >= (actualStartHour.getDate() === startHour.endHour.getDate() ?\n                startTime.getTime() : addDays(startTime, 1).getTime());\n            if (actualEndTime.getTime() !== resetTime(actualEndTime).getTime()) {\n                const endTime = new Date(resetTime(actualEndTime));\n                cloneData.isRight = cloneData.isRight || actualEndTime.getTime() <=\n                    endTime.setHours(actualStartHour.getHours(), actualStartHour.getMinutes(), actualStartHour.getSeconds());\n            }\n        }\n    }\n    renderResourceEvents() {\n        const resources = this.parent.uiStateValues.isGroupAdaptive ?\n            [this.parent.resourceBase.lastResourceLevel[this.parent.uiStateValues.groupIndex]] :\n            this.parent.resourceBase.lastResourceLevel;\n        if (this.parent.crudModule && this.parent.crudModule.crudObj.isCrudAction) {\n            for (let i = 0, len = this.parent.crudModule.crudObj.sourceEvent.length; i < len; i++) {\n                const sourceRes = this.parent.crudModule.crudObj.sourceEvent[i];\n                this.renderEventsHandler(sourceRes.renderDates, sourceRes.workDays, sourceRes);\n                if (this.parent.crudModule.crudObj.sourceEvent[i].groupIndex !==\n                    this.parent.crudModule.crudObj.targetEvent[i].groupIndex) {\n                    const target = this.parent.crudModule.crudObj.targetEvent[i];\n                    this.renderEventsHandler(target.renderDates, target.workDays, target);\n                }\n            }\n            this.parent.crudModule.crudObj.isCrudAction = false;\n        }\n        else {\n            for (const slotData of resources) {\n                this.renderEventsHandler(slotData.renderDates, slotData.workDays, slotData);\n            }\n        }\n    }\n    getSlotDates(workDays) {\n        this.slots = [];\n        const dates = this.dateRender.map((date) => { return +date; });\n        const noOfDays = this.parent.activeViewOptions.showWeekend ? WEEK_LENGTH : workDays.length;\n        while (dates.length > 0) {\n            this.slots.push(dates.splice(0, noOfDays));\n        }\n    }\n    createAppointmentElement(record, resIndex, isCloneElement = false) {\n        const eventSubject = (record[this.fields.subject] || this.parent.eventSettings.fields.subject.default ||\n            this.parent.localeObj.getConstant('addTitle'));\n        const newRecord = extend({}, record, record.data, true);\n        const attrs = {\n            'data-id': 'Appointment_' + record[this.fields.id],\n            'role': 'button', 'tabindex': '0',\n            'aria-disabled': this.parent.eventBase.getReadonlyAttribute(record), 'aria-pressed': 'false', 'aria-grabbed': 'true',\n            'aria-label': this.parent.getAnnouncementString(newRecord, eventSubject)\n        };\n        if (!isCloneElement) {\n            attrs['data-guid'] = record.Guid;\n        }\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            attrs['data-group-index'] = resIndex.toString();\n        }\n        const appointmentWrapper = createElement('div', { className: APPOINTMENT_CLASS, attrs: attrs });\n        if (!isNullOrUndefined(this.cssClass)) {\n            addClass([appointmentWrapper], this.cssClass);\n        }\n        if (record[this.fields.isReadonly]) {\n            addClass([appointmentWrapper], 'e-read-only');\n        }\n        const appointmentDetails = createElement('div', { className: APPOINTMENT_DETAILS });\n        appointmentWrapper.appendChild(appointmentDetails);\n        let templateElement;\n        const eventData = record.data;\n        const eventObj = this.getEventData(record);\n        if (!isNullOrUndefined(this.parent.activeViewOptions.eventTemplate)) {\n            const scheduleId = this.parent.element.id + '_';\n            const viewName = this.parent.activeViewOptions.eventTemplateName;\n            const templateId = scheduleId + viewName + 'eventTemplate';\n            const eventTemplate = 'eventTemplate' + (this.parent.activeViewOptions.group.resources.length > 0 ? '_' + resIndex : '');\n            templateElement = this.parent.getAppointmentTemplate()(eventObj, this.parent, eventTemplate, templateId, false);\n        }\n        else {\n            const eventLocation = (record[this.fields.location] || this.parent.eventSettings.fields.location.default || '');\n            const appointmentSubject = createElement('div', {\n                className: SUBJECT_CLASS,\n                innerHTML: (eventSubject + (eventLocation ? ';&nbsp' + eventLocation : ''))\n            });\n            const appointmentStartTime = createElement('div', {\n                className: APPOINTMENT_TIME + (this.parent.isAdaptive ? ' ' + DISABLE_CLASS : ''),\n                innerHTML: this.parent.getTimeString(eventData[this.fields.startTime])\n            });\n            const appointmentEndTime = createElement('div', {\n                className: APPOINTMENT_TIME + (this.parent.isAdaptive ? ' ' + DISABLE_CLASS : ''),\n                innerHTML: this.parent.getTimeString(eventData[this.fields.endTime])\n            });\n            if (this.parent.currentView === 'Month') {\n                if (record[this.fields.isAllDay]) {\n                    templateElement = [appointmentSubject];\n                    addClass([appointmentSubject], 'e-text-center');\n                }\n                else if (eventData.count <= 1 && !eventData.isLeft && !eventData.isRight) {\n                    templateElement = [appointmentStartTime, appointmentSubject];\n                }\n                else {\n                    templateElement = [];\n                    addClass([appointmentSubject], 'e-text-center');\n                    if (!eventData.isLeft) {\n                        templateElement.push(appointmentStartTime);\n                    }\n                    templateElement.push(appointmentSubject);\n                    if (!eventData.isRight) {\n                        templateElement.push(appointmentEndTime);\n                    }\n                }\n            }\n            else {\n                let innerElement;\n                if (record[this.fields.isAllDay]) {\n                    const allDayString = createElement('div', {\n                        className: APPOINTMENT_TIME, innerHTML: this.parent.localeObj.getConstant('allDay')\n                    });\n                    innerElement = [appointmentSubject, allDayString];\n                }\n                else {\n                    const timeString = this.parent.getTimeString(eventData[this.fields.startTime])\n                        + ' - ' + this.parent.getTimeString(eventData[this.fields.endTime]);\n                    const appTime = createElement('div', {\n                        className: APPOINTMENT_TIME + (this.parent.isAdaptive ? ' ' + DISABLE_CLASS : ''), innerHTML: timeString\n                    });\n                    const appLocation = createElement('div', { className: LOCATION_CLASS, innerHTML: eventLocation });\n                    innerElement = [appointmentSubject, appTime, appLocation];\n                }\n                const wrap = createElement('div', { className: 'e-inner-wrap' });\n                append(innerElement, wrap);\n                templateElement = [wrap];\n            }\n        }\n        append(templateElement, appointmentDetails);\n        this.appendEventIcons(record, appointmentDetails);\n        this.renderResizeHandler(appointmentWrapper, record.data, record[this.fields.isReadonly]);\n        return appointmentWrapper;\n    }\n    appendEventIcons(record, appointmentDetails) {\n        const eventData = record.data;\n        if (!isNullOrUndefined(record[this.fields.recurrenceRule]) || !isNullOrUndefined(record[this.fields.recurrenceID])) {\n            const iconClass = (record[this.fields.id] === record[this.fields.recurrenceID]) ?\n                EVENT_RECURRENCE_ICON_CLASS : EVENT_RECURRENCE_EDIT_ICON_CLASS;\n            appointmentDetails.appendChild(createElement('div', {\n                className: ICON + ' ' + iconClass + (this.parent.isAdaptive ? ' ' + DISABLE_CLASS : '')\n            }));\n        }\n        if (eventData.isLeft) {\n            const iconLeft = createElement('div', {\n                className: EVENT_INDICATOR_CLASS + ' ' + ICON + ' ' + EVENT_ICON_LEFT_CLASS\n            });\n            prepend([iconLeft], appointmentDetails);\n        }\n        if (eventData.isRight) {\n            const iconRight = createElement('div', {\n                className: EVENT_INDICATOR_CLASS + ' ' + ICON + ' ' + EVENT_ICON_RIGHT_CLASS\n            });\n            append([iconRight], appointmentDetails);\n        }\n    }\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    renderEvents(event, resIndex, eventsList) {\n        const startTime = event[this.fields.startTime];\n        const endTime = event[this.fields.endTime];\n        const day = this.parent.getIndexOfDate(this.dateRender, resetTime(startTime));\n        if ((day < 0) || (startTime.getTime() < this.parent.minDate.getTime()) || (endTime.getTime() > this.parent.maxDate.getTime())) {\n            return;\n        }\n        const overlapCount = this.getIndex(startTime);\n        event.Index = overlapCount;\n        const diffInDays = event.data.count;\n        if (startTime.getTime() <= endTime.getTime()) {\n            const appWidth = (diffInDays * this.cellWidth) - 5;\n            const cellTd = this.workCells[day];\n            const appTop = (overlapCount * (this.eventHeight + EVENT_GAP));\n            const height = this.monthHeaderHeight + ((overlapCount + 1) * (this.eventHeight + EVENT_GAP)) + this.moreIndicatorHeight;\n            const enableAppRender = this.maxOrIndicator ? overlapCount < 1 ? true : false : this.cellHeight > height;\n            if (this.parent.rowAutoHeight || enableAppRender) {\n                this.renderedEvents.push(extend({}, event, null, true));\n                let appointmentElement;\n                if (this.inlineValue) {\n                    appointmentElement = this.parent.inlineModule.createInlineAppointmentElement();\n                }\n                else {\n                    appointmentElement = this.createAppointmentElement(event, resIndex);\n                }\n                this.applyResourceColor(appointmentElement, event, 'backgroundColor', this.groupOrder);\n                this.wireAppointmentEvents(appointmentElement, event);\n                setStyleAttribute(appointmentElement, { 'width': appWidth + 'px', 'top': appTop + 'px' });\n                this.renderEventElement(event, appointmentElement, cellTd);\n                if (this.parent.rowAutoHeight) {\n                    const firstChild = cellTd.parentElement.firstElementChild;\n                    this.updateCellHeight(firstChild, height);\n                }\n            }\n            else {\n                for (let i = 0; i < diffInDays; i++) {\n                    if (this.workCells[day + i]) {\n                        const indicator = this.workCells[day + i].querySelector('.' + MORE_INDICATOR_CLASS);\n                        if (indicator) {\n                            const count = parseInt(indicator.getAttribute('data-count'), 10) + 1;\n                            indicator.setAttribute('data-count', count.toString());\n                            indicator.innerHTML = this.getMoreIndicatorText(count);\n                        }\n                        else {\n                            const startDate = new Date(this.dateRender[day + i].getTime());\n                            const endDate = addDays(this.dateRender[day + i], 1);\n                            const groupIndex = this.workCells[day + i].getAttribute('data-group-index');\n                            const moreIndicatorElement = this.getMoreIndicatorElement(1, startDate, endDate);\n                            if (!isNullOrUndefined(groupIndex)) {\n                                moreIndicatorElement.setAttribute('data-group-index', groupIndex);\n                            }\n                            moreIndicatorElement.style.top = (this.cellHeight - this.monthHeaderHeight - this.moreIndicatorHeight) + 'px';\n                            moreIndicatorElement.style.width = this.cellWidth - 2 + 'px';\n                            this.renderElement(this.workCells[day + i], moreIndicatorElement);\n                            EventHandler.add(moreIndicatorElement, 'click', this.moreIndicatorClick, this);\n                        }\n                    }\n                }\n            }\n        }\n    }\n    updateCellHeight(cell, height) {\n        if ((height > cell.offsetHeight)) {\n            setStyleAttribute(cell, { 'height': height + 'px' });\n        }\n    }\n    updateBlockElements() {\n        const blockElement = [].slice.call(this.element.querySelectorAll('.' + BLOCK_APPOINTMENT_CLASS));\n        for (const element of blockElement) {\n            const target = closest(element, 'tr');\n            this.monthHeaderHeight = element.offsetParent.offsetTop - target.offsetTop;\n            element.style.height = ((target.offsetHeight - 1) - this.monthHeaderHeight) + 'px';\n            const firstChild = target.firstElementChild;\n            const width = Math.round(element.offsetWidth / firstChild.offsetWidth);\n            element.style.width = (firstChild.offsetWidth * width) + 'px';\n        }\n    }\n    // eslint-disable-next-line max-len\n    getFilteredEvents(startDate, endDate, groupIndex, eventsList) {\n        let filteredEvents;\n        if (isNullOrUndefined(groupIndex)) {\n            filteredEvents = this.filterEvents(startDate, endDate);\n        }\n        else {\n            const data = this.parent.resourceBase.lastResourceLevel[parseInt(groupIndex, 10)];\n            filteredEvents = this.filterEvents(startDate, endDate, isNullOrUndefined(eventsList) ? undefined : eventsList, data);\n        }\n        return filteredEvents;\n    }\n    getOverlapEvents(date, appointments) {\n        const appointmentsList = [];\n        const dateTime = resetTime(date).getTime();\n        for (const app of appointments) {\n            if ((resetTime(app[this.fields.startTime]).getTime() <= dateTime) &&\n                (resetTime(app[this.fields.endTime]).getTime() >= dateTime)) {\n                appointmentsList.push(app);\n            }\n        }\n        return appointmentsList;\n    }\n    getIndex(date) {\n        let appIndex = -1;\n        const appointments = this.renderedEvents;\n        if (appointments.length > 0) {\n            const appointmentsList = this.getOverlapEvents(date, appointments);\n            const appLevel = appointmentsList.map((obj) => obj.Index);\n            appIndex = (appLevel.length > 0) ? this.getSmallestMissingNumber(appLevel) : 0;\n        }\n        return (appIndex === -1) ? 0 : appIndex;\n    }\n    moreIndicatorClick(event) {\n        const target = closest(event.target, '.' + MORE_INDICATOR_CLASS);\n        const startDate = new Date(parseInt(target.getAttribute('data-start-date'), 10));\n        const endDate = new Date(parseInt(target.getAttribute('data-end-date'), 10));\n        const groupIndex = target.getAttribute('data-group-index');\n        const moreArgs = {\n            cancel: false, event: event, element: target, isPopupOpen: true,\n            startTime: startDate, endTime: endDate, viewName: this.parent.getNavigateView()\n        };\n        if (groupIndex) {\n            moreArgs.groupIndex = parseInt(groupIndex, 10);\n        }\n        this.parent.trigger(moreEventsClick, moreArgs, (clickArgs) => {\n            if (!clickArgs.cancel) {\n                if (clickArgs.isPopupOpen) {\n                    const filteredEvents = this.getFilteredEvents(startDate, endDate, groupIndex);\n                    const moreArgs = { date: startDate, event: filteredEvents, element: event.target };\n                    this.parent.quickPopup.moreEventClick(moreArgs, endDate, groupIndex);\n                }\n                else {\n                    this.parent.setProperties({ selectedDate: startDate }, true);\n                    this.parent.changeView(clickArgs.viewName, event);\n                }\n            }\n        });\n    }\n    renderEventElement(event, appointmentElement, cellTd) {\n        const eventType = appointmentElement.classList.contains(BLOCK_APPOINTMENT_CLASS) ? 'blockEvent' : 'event';\n        const isAppointment = appointmentElement.classList.contains(APPOINTMENT_CLASS);\n        const eventObj = this.getEventData(event);\n        const args = { data: eventObj, element: appointmentElement, cancel: false, type: eventType };\n        this.parent.trigger(eventRendered, args, (eventArgs) => {\n            if (eventArgs.cancel) {\n                this.renderedEvents.pop();\n            }\n            else {\n                this.renderElement(cellTd, appointmentElement, isAppointment);\n            }\n        });\n    }\n    getEventData(event) {\n        const eventObj = extend({}, event, null, true);\n        eventObj[this.fields.startTime] = event.data[this.fields.startTime];\n        eventObj[this.fields.endTime] = event.data[this.fields.endTime];\n        return eventObj;\n    }\n    renderElement(cellTd, element, isAppointment = false) {\n        if (this.maxOrIndicator && isAppointment) {\n            this.setMaxEventHeight(element, cellTd);\n        }\n        const wrapperEle = cellTd.querySelector('.' + APPOINTMENT_WRAPPER_CLASS);\n        if (wrapperEle) {\n            wrapperEle.appendChild(element);\n        }\n        else {\n            const wrapper = createElement('div', { className: APPOINTMENT_WRAPPER_CLASS });\n            wrapper.appendChild(element);\n            cellTd.appendChild(wrapper);\n        }\n    }\n    getMoreIndicatorElement(count, startDate, endDate) {\n        const moreIndicatorElement = createElement('div', {\n            className: MORE_INDICATOR_CLASS,\n            innerHTML: this.getMoreIndicatorText(count),\n            attrs: {\n                'tabindex': '0',\n                'data-count': count.toString(),\n                'data-start-date': startDate.getTime().toString(),\n                'data-end-date': endDate.getTime().toString()\n            }\n        });\n        return moreIndicatorElement;\n    }\n    getMoreIndicatorText(count) {\n        return '+' + this.parent.globalize.formatNumber(count) + '&nbsp;' + (this.parent.isAdaptive ? '' : this.parent.localeObj.getConstant('more'));\n    }\n    removeHeightProperty(selector) {\n        const rows = [].slice.call(this.element.querySelectorAll('.' + selector + ' tbody tr'));\n        for (const row of rows) {\n            row.firstElementChild.style.height = '';\n        }\n    }\n    setMaxEventHeight(event, cell) {\n        const headerHeight = getOuterHeight(cell.querySelector('.' + DATE_HEADER_CLASS));\n        const height = (cell.offsetHeight - headerHeight) - (this.maxHeight ? 0 : this.moreIndicatorHeight);\n        setStyleAttribute(event, { 'height': height + 'px', 'align-items': 'center' });\n    }\n    destroy() {\n        this.element = null;\n        this.fields = null;\n        this.maxHeight = null;\n        this.withIndicator = null;\n        this.maxOrIndicator = null;\n        this.moreIndicatorHeight = null;\n        this.removeEventListener();\n        super.destroy();\n    }\n}\n\n/* eslint-disable max-len */\n/* eslint-disable @typescript-eslint/no-explicit-any */\nconst EVENT_GAP$1 = 2;\nconst BLOCK_INDICATOR_WIDTH = 22;\nconst BLOCK_INDICATOR_HEIGHT = 18;\n/**\n * Timeline view events render\n */\nclass TimelineEvent extends MonthEvent {\n    constructor(parent, type) {\n        super(parent);\n        this.startHour = this.parent.activeView.getStartHour();\n        this.endHour = this.parent.activeView.getEndHour();\n        this.slotCount = this.parent.activeViewOptions.timeScale.slotCount;\n        this.interval = this.parent.activeViewOptions.timeScale.interval;\n        this.day = 0;\n        this.rowIndex = 0;\n        this.cellTops = [];\n        this.renderType = type;\n        this.eventContainers = [].slice.call(this.element.querySelectorAll('.' + APPOINTMENT_CONTAINER_CLASS));\n        const tr = [].slice.call(this.element.querySelectorAll('.' + CONTENT_TABLE_CLASS + ' tbody tr'));\n        this.dayLength = tr.length === 0 ? 0 : tr[0].children.length;\n        this.content = this.parent.element.querySelector('.' + CONTENT_TABLE_CLASS);\n    }\n    getSlotDates() {\n        this.slots = [];\n        this.slots.push(this.parent.activeView.renderDates.map((date) => { return +date; }));\n        if (this.parent.activeViewOptions.headerRows.length > 0 &&\n            this.parent.activeViewOptions.headerRows.slice(-1)[0].option !== 'Hour') {\n            this.renderType = 'day';\n            this.cellWidth = this.content.offsetWidth / this.dateRender.length;\n            this.slotsPerDay = 1;\n        }\n        else {\n            this.slotsPerDay = (this.dayLength / this.dateRender.length);\n        }\n    }\n    getOverlapEvents(date, appointments) {\n        const appointmentsList = [];\n        if (this.renderType === 'day') {\n            for (const app of appointments) {\n                if ((resetTime(app[this.fields.startTime]).getTime() <= resetTime(new Date(date.getTime())).getTime()) &&\n                    (resetTime(app[this.fields.endTime]).getTime() >= resetTime(new Date(date.getTime())).getTime())) {\n                    appointmentsList.push(app);\n                }\n            }\n        }\n        else {\n            for (const app of appointments) {\n                const eventData = app.data;\n                if (eventData.trimStartTime.getTime() <= date.getTime() &&\n                    eventData.trimEndTime.getTime() > date.getTime()) {\n                    appointmentsList.push(app);\n                }\n            }\n        }\n        return appointmentsList;\n    }\n    getSortComparerIndex(startDate, endDate) {\n        let appIndex = -1;\n        const appointments = this.renderedEvents;\n        if (appointments.length > 0) {\n            const appointmentsList = this.getOverlapSortComparerEvents(startDate, endDate, appointments);\n            const appLevel = appointmentsList.map((obj) => obj.Index);\n            appIndex = (appLevel.length > 0) ? this.getSmallestMissingNumber(appLevel) : 0;\n        }\n        return (appIndex === -1) ? 0 : appIndex;\n    }\n    getOverlapSortComparerEvents(startDate, endDate, appointmentsCollection) {\n        const appointments = [];\n        for (const app of appointmentsCollection) {\n            if (this.renderType === 'day') {\n                if ((resetTime(app[this.fields.startTime]).getTime() <= resetTime(new Date(startDate.getTime())).getTime()) &&\n                    (resetTime(app[this.fields.endTime]).getTime() >= resetTime(new Date(startDate.getTime())).getTime())) {\n                    appointments.push(app);\n                }\n            }\n            else {\n                const eventData = app.data;\n                if (((eventData.trimStartTime.getTime() <= startDate.getTime()) && (startDate.getTime() < eventData.trimEndTime.getTime())) ||\n                    ((startDate.getTime() <= eventData.trimStartTime.getTime()) && (eventData.trimStartTime.getTime() < endDate.getTime()))) {\n                    appointments.push(app);\n                }\n            }\n        }\n        return appointments;\n    }\n    renderResourceEvents() {\n        this.removeHeightProperty(RESOURCE_COLUMN_TABLE_CLASS);\n        const resources = this.parent.uiStateValues.isGroupAdaptive ?\n            [this.parent.resourceBase.lastResourceLevel[this.parent.uiStateValues.groupIndex]] :\n            this.parent.resourceBase.renderedResources;\n        if (this.parent.crudModule && this.parent.crudModule.crudObj.isCrudAction) {\n            for (let i = 0, len = this.parent.crudModule.crudObj.sourceEvent.length; i < len; i++) {\n                const source = this.parent.crudModule.crudObj.sourceEvent[i];\n                this.rowIndex = source.groupIndex;\n                this.renderEventsHandler(this.parent.activeView.renderDates, this.parent.activeViewOptions.workDays, source);\n                if (this.parent.crudModule.crudObj.targetEvent[i] && this.parent.crudModule.crudObj.sourceEvent[i].groupIndex !==\n                    this.parent.crudModule.crudObj.targetEvent[i].groupIndex) {\n                    const target = this.parent.crudModule.crudObj.targetEvent[i];\n                    this.rowIndex = target.groupIndex;\n                    this.renderEventsHandler(this.parent.activeView.renderDates, this.parent.activeViewOptions.workDays, target);\n                }\n            }\n            this.parent.crudModule.crudObj.isCrudAction = false;\n        }\n        else {\n            for (let i = 0; i < resources.length; i++) {\n                this.rowIndex = i;\n                this.renderEventsHandler(this.parent.activeView.renderDates, this.parent.activeViewOptions.workDays, resources[i]);\n            }\n        }\n    }\n    renderEvents(event, resIndex, appointmentsList) {\n        let startTime = event[this.fields.startTime];\n        let endTime = event[this.fields.endTime];\n        if ((startTime.getTime() < this.parent.minDate.getTime()) || (endTime.getTime() > this.parent.maxDate.getTime())) {\n            return;\n        }\n        const eventData = event.data;\n        startTime = this.getStartTime(event, eventData);\n        endTime = this.getEndTime(event, eventData);\n        const startEndHours = getStartEndHours(event[this.fields.startTime], this.startHour, this.endHour);\n        const eventDates = this.updateEventMinimumDuration(startEndHours, startTime, endTime);\n        startTime = eventDates.startDate;\n        endTime = eventDates.endDate;\n        this.day = this.parent.getIndexOfDate(this.dateRender, resetTime(new Date(startTime.getTime())));\n        if (this.day < 0) {\n            return;\n        }\n        const cellTd = this.getCellTd();\n        const overlapCount = (isNullOrUndefined(this.parent.eventSettings.sortComparer)) ? this.getIndex(startTime) : this.getSortComparerIndex(startTime, endTime);\n        event.Index = overlapCount;\n        const appHeight = this.eventHeight;\n        const diffInDays = eventData.count;\n        const eventObj = extend({}, event, null, true);\n        eventObj[this.fields.startTime] = eventData[this.fields.startTime];\n        eventObj[this.fields.endTime] = eventData[this.fields.endTime];\n        const currentDate = resetTime(new Date(this.dateRender[this.day].getTime()));\n        const schedule = getStartEndHours(currentDate, this.startHour, this.endHour);\n        const isValidEvent = this.isValidEvent(eventObj, startTime, endTime, schedule);\n        if (startTime <= endTime && isValidEvent) {\n            let appWidth = this.getEventWidth(startTime, endTime, event[this.fields.isAllDay], diffInDays);\n            appWidth = this.renderType === 'day' ? appWidth - 2 : appWidth;\n            let appLeft = 0;\n            let appRight = 0;\n            const position = this.getPosition(startTime, endTime, event[this.fields.isAllDay], this.day);\n            appWidth = (appWidth <= 0) ? this.cellWidth : appWidth; // appWidth 0 when start and end time as same\n            this.renderedEvents.push(extend({}, event, null, true));\n            if (isNullOrUndefined(this.cellTops[resIndex])) {\n                this.cellTops[resIndex] = this.getRowTop(resIndex);\n            }\n            const top = this.cellTops[resIndex];\n            const appTop = (top + (this.maxHeight ? 0 : EVENT_GAP$1)) + (overlapCount * (appHeight + EVENT_GAP$1));\n            appLeft = (this.parent.enableRtl) ? 0 : position;\n            appRight = (this.parent.enableRtl) ? position : 0;\n            const height = ((overlapCount + 1) * (appHeight + EVENT_GAP$1)) + this.moreIndicatorHeight;\n            const renderApp = this.maxOrIndicator ? overlapCount < 1 ? true : false : this.cellHeight > height;\n            if (this.parent.rowAutoHeight || renderApp) {\n                let appointmentElement;\n                if (isNullOrUndefined(this.inlineValue)) {\n                    appointmentElement = this.createAppointmentElement(event, resIndex);\n                }\n                else {\n                    appointmentElement = this.parent.inlineModule.createInlineAppointmentElement();\n                }\n                this.applyResourceColor(appointmentElement, event, 'backgroundColor', this.groupOrder);\n                setStyleAttribute(appointmentElement, {\n                    'width': appWidth + 'px', 'left': appLeft + 'px', 'right': appRight + 'px', 'top': appTop + 'px'\n                });\n                this.wireAppointmentEvents(appointmentElement, event);\n                this.renderEventElement(event, appointmentElement, cellTd);\n                if (this.parent.rowAutoHeight) {\n                    const firstChild = this.getFirstChild(resIndex);\n                    this.updateCellHeight(firstChild, height);\n                }\n                if (this.parent.activeViewOptions.option !== 'TimelineMonth' && this.parent.activeViewOptions.timeScale.enable\n                    && appWidth < this.cellWidth) {\n                    const resizeHandlers = [].slice.call(appointmentElement.querySelectorAll('.' + EVENT_RESIZE_CLASS));\n                    resizeHandlers.forEach((resizeHandler) => {\n                        resizeHandler.style.width = Math.ceil(appWidth / resizeHandler.getBoundingClientRect().width) + 'px';\n                    });\n                }\n            }\n            else {\n                for (let i = 0; i < diffInDays; i++) {\n                    const moreIndicator = cellTd.querySelector('.' + MORE_INDICATOR_CLASS);\n                    let appPos = (this.parent.enableRtl) ? appRight : appLeft;\n                    appPos = (Math.floor(appPos / this.cellWidth) * this.cellWidth);\n                    const interval = this.interval / this.slotCount;\n                    let startDate = (this.parent.activeViewOptions.option === 'TimelineMonth' || this.renderType === 'day' || i !== 0) ?\n                        new Date(this.dateRender[this.day + i].getTime()) : new Date(startTime);\n                    let endDate = addDays(this.dateRender[this.day + i], 1);\n                    if (this.parent.activeViewOptions.option === 'TimelineMonth' || this.renderType === 'day') {\n                        const position = this.getPosition(startDate, endDate, event[this.fields.isAllDay], (this.day + i));\n                        this.renderTimelineMoreIndicator(startTime, startDate, endDate, appHeight, interval, resIndex, appointmentsList, top, appLeft, appRight, cellTd, moreIndicator, appPos, position);\n                    }\n                    else {\n                        const slotCount = (getUniversalTime(endTime) - getUniversalTime(startTime)) / MS_PER_MINUTE *\n                            this.slotCount / this.interval;\n                        for (let k = 0; k < slotCount; k++) {\n                            startDate = (k === 0) ? new Date(startDate.getTime()) : new Date(startDate.getTime() + (60000 * interval));\n                            endDate = new Date(startDate.getTime() + (60000 * interval));\n                            if (endDate.getTime() > endTime.getTime()) {\n                                break;\n                            }\n                            const position = this.getPosition(startDate, endDate, false, (this.day + i));\n                            if (appPos > position) {\n                                break;\n                            }\n                            appPos = position;\n                            this.renderTimelineMoreIndicator(startTime, startDate, endDate, appHeight, interval, resIndex, appointmentsList, top, appLeft, appRight, cellTd, moreIndicator, appPos, position);\n                        }\n                    }\n                }\n            }\n        }\n        this.parent.renderTemplates();\n    }\n    renderTimelineMoreIndicator(startTime, startDate, endDate, appHeight, interval, resIndex, appointmentsList, top, appLeft, appRight, cellTd, moreIndicator, appPos, position) {\n        appLeft = (this.parent.enableRtl) ? appRight = position : position;\n        appPos = (this.parent.enableRtl) ? appRight : appLeft;\n        appPos = (Math.floor(appPos / this.cellWidth) * this.cellWidth);\n        if ((cellTd && isNullOrUndefined(moreIndicator)) ||\n            (!this.isAlreadyAvail(appPos, cellTd))) {\n            const startDateTime = (this.parent.activeViewOptions.option === 'TimelineMonth' || this.renderType === 'day') ? new Date(+startTime) : startDate;\n            const slotStartTime = (new Date(startDateTime.setMinutes(Math.floor(startDateTime.getMinutes() / interval) * interval)));\n            const slotEndTime = new Date(slotStartTime.getTime() + (60000 * interval));\n            let groupIndex;\n            if (this.parent.activeViewOptions.group.resources.length > 0 && !isNullOrUndefined(resIndex)) {\n                groupIndex = resIndex.toString();\n            }\n            const filterEvents = this.getFilterEvents(startDate, endDate, slotStartTime, slotEndTime, groupIndex, appointmentsList);\n            const appArea = this.cellHeight - this.moreIndicatorHeight;\n            appHeight = this.withIndicator ? appArea - EVENT_GAP$1 : appHeight;\n            const renderedAppCount = Math.floor(appArea / (appHeight + EVENT_GAP$1));\n            const count = (filterEvents.length - renderedAppCount) <= 0 ? 1 : (filterEvents.length - renderedAppCount);\n            let moreIndicatorElement;\n            if (this.renderType === 'day') {\n                moreIndicatorElement = this.getMoreIndicatorElement(count, startDate, endDate);\n            }\n            else {\n                moreIndicatorElement = this.getMoreIndicatorElement(count, slotStartTime, slotEndTime);\n            }\n            if (!isNullOrUndefined(groupIndex)) {\n                moreIndicatorElement.setAttribute('data-group-index', groupIndex);\n            }\n            moreIndicatorElement.style.top = top + appArea + 'px';\n            moreIndicatorElement.style.width = this.cellWidth + 'px';\n            moreIndicatorElement.style.left = (Math.floor(appLeft / this.cellWidth) * this.cellWidth) + 'px';\n            moreIndicatorElement.style.right = (Math.floor(appRight / this.cellWidth) * this.cellWidth) + 'px';\n            this.renderElement(cellTd, moreIndicatorElement);\n            EventHandler.add(moreIndicatorElement, 'click', this.moreIndicatorClick, this);\n        }\n    }\n    updateCellHeight(cell, height) {\n        const cellHeight = cell.style.height === '' ? this.cellHeight : parseInt(cell.style.height, 10);\n        if (height > cellHeight) {\n            setStyleAttribute(cell, { 'height': height + 'px' });\n            if (this.parent.activeViewOptions.group.resources.length > 0) {\n                const resourceCell = this.parent.element.querySelector('.' + RESOURCE_COLUMN_TABLE_CLASS + ' ' + 'tbody td[data-group-index=\"' +\n                    cell.getAttribute('data-group-index') + '\"]');\n                if (resourceCell) {\n                    setStyleAttribute(resourceCell, { 'height': height + 'px' });\n                }\n            }\n            const monthHeader = this.parent.element.querySelector('.e-month-header-wrapper table tr:nth-child(' +\n                (cell.parentElement.rowIndex + 1) + ') td');\n            if (monthHeader) {\n                setStyleAttribute(monthHeader, { 'height': height + 'px' });\n            }\n        }\n    }\n    getFirstChild(index) {\n        const query = '.' + CONTENT_TABLE_CLASS + ' tbody td';\n        let groupIndex = '';\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            groupIndex = '[data-group-index=\"' + index.toString() + '\"]';\n        }\n        const td = this.parent.element.querySelector(query + groupIndex);\n        return td;\n    }\n    updateBlockElements() {\n        const blockElement = [].slice.call(this.element.querySelectorAll('.' + BLOCK_APPOINTMENT_CLASS));\n        for (const element of blockElement) {\n            const resIndex = parseInt(element.getAttribute('data-group-index'), 10);\n            const firstChild = this.getFirstChild(resIndex);\n            element.style.height = firstChild.offsetHeight + 'px';\n            const width = Math.round(element.offsetWidth / firstChild.offsetWidth);\n            element.style.width = (firstChild.offsetWidth * width) + 'px';\n        }\n        const blockIndicator = [].slice.call(this.element.querySelectorAll('.' + BLOCK_INDICATOR_CLASS));\n        for (const element of blockIndicator) {\n            const resIndex = parseInt(element.getAttribute('data-group-index'), 10);\n            element.style.top = this.getRowTop(resIndex) +\n                this.getFirstChild(resIndex).offsetHeight - BLOCK_INDICATOR_HEIGHT + 'px';\n        }\n    }\n    getStartTime(event, eventData) {\n        let startTime = event[this.fields.startTime];\n        const schedule = getStartEndHours(startTime, this.startHour, this.endHour);\n        if (schedule.startHour.getTime() >= eventData[this.fields.startTime]) {\n            startTime = schedule.startHour;\n        }\n        else if (schedule.endHour.getTime() <= eventData[this.fields.startTime]) {\n            startTime = this.getNextDay(schedule.startHour, eventData);\n        }\n        else {\n            startTime = eventData[this.fields.startTime];\n        }\n        // To overcome the overflow\n        eventData.trimStartTime = (event[this.fields.isAllDay]) ? schedule.startHour : eventData[this.fields.startTime];\n        return startTime;\n    }\n    getNextDay(startTime, eventData) {\n        let startDate;\n        for (let i = 1; i <= this.dateRender.length; i++) {\n            startDate = addDays(startTime, i);\n            if (this.parent.getIndexOfDate(this.dateRender, resetTime(new Date(startTime.getTime()))) !== -1) {\n                eventData.count = eventData.count - 1;\n                return startDate;\n            }\n        }\n        return startDate;\n    }\n    getEndTime(event, eventData) {\n        let endTime = event[this.fields.endTime];\n        const schedule = getStartEndHours(endTime, this.startHour, this.endHour);\n        if (this.parent.currentView === 'TimelineMonth' || !this.parent.activeViewOptions.timeScale.enable ||\n            (this.parent.activeViewOptions.headerRows.length > 0 &&\n                this.parent.activeViewOptions.headerRows.slice(-1)[0].option !== 'Hour')) {\n            endTime = eventData[this.fields.endTime];\n        }\n        else {\n            endTime = eventData[this.fields.endTime];\n            if (schedule.endHour.getTime() <= eventData[this.fields.endTime]) {\n                endTime = schedule.endHour;\n            }\n            if (schedule.startHour.getTime() >= eventData[this.fields.endTime].getTime() && !event.isAllDay) {\n                endTime = this.getPreviousDay(schedule.startHour, schedule.endHour, eventData);\n            }\n        }\n        // To overcome the overflow\n        eventData.trimEndTime = (event[this.fields.isAllDay]) ? schedule.endHour : eventData[this.fields.endTime];\n        return endTime;\n    }\n    getPreviousDay(startTime, endTime, eventData) {\n        for (let i = 1; i <= this.dateRender.length; i++) {\n            let endDate = addDays(endTime, -i);\n            if (this.parent.getIndexOfDate(this.dateRender, resetTime(new Date(startTime.getTime()))) !== -1) {\n                endDate = resetTime(new Date(endDate.getTime()));\n                endDate.setHours(endTime.getHours(), endTime.getMinutes(), endTime.getSeconds());\n                const count = eventData.count;\n                const actualEndTime = eventData[this.fields.endTime];\n                eventData.count = actualEndTime.getHours() !== 0 || actualEndTime.getMinutes() !== 0 ? count - 1 : count;\n                return endDate;\n            }\n        }\n        return eventData[this.fields.endTime];\n    }\n    getEventWidth(startDate, endDate, isAllDay, count) {\n        if (this.renderType === 'day' || isAllDay) {\n            return (count * this.slotsPerDay) * this.cellWidth;\n        }\n        if (this.isSameDay(startDate, endDate)) {\n            return this.getSameDayEventsWidth(startDate, endDate);\n        }\n        else {\n            return this.getSpannedEventsWidth(startDate, endDate, count);\n        }\n    }\n    getSameDayEventsWidth(startDate, endDate) {\n        return ((getUniversalTime(endDate) - getUniversalTime(startDate)) /\n            MS_PER_MINUTE * (this.cellWidth * this.slotCount) / this.interval);\n    }\n    getSpannedEventsWidth(startDate, endDate, diffInDays) {\n        const width = (diffInDays * this.slotsPerDay) * this.cellWidth;\n        let endWidth;\n        const start = getStartEndHours(resetTime(new Date(startDate.getTime())), this.startHour, this.endHour);\n        const startWidth = this.getSameDayEventsWidth(start.startHour, startDate);\n        if (this.parent.getIndexOfDate(this.dateRender, resetTime(new Date(endDate.getTime()))) === -1) {\n            endWidth = 0;\n        }\n        else {\n            const end = getStartEndHours(resetTime(new Date(endDate.getTime())), this.startHour, this.endHour);\n            endWidth = this.getSameDayEventsWidth(endDate, end.endHour);\n            endWidth = ((this.slotsPerDay * this.cellWidth) === endWidth) ? 0 : endWidth;\n        }\n        const spannedWidth = startWidth + endWidth;\n        return (width > spannedWidth) ? width - spannedWidth : width - startWidth;\n    }\n    isSameDay(startTime, endTime) {\n        const startDay = this.parent.getIndexOfDate(this.dateRender, resetTime(new Date(startTime.getTime())));\n        const endDay = this.parent.getIndexOfDate(this.dateRender, resetTime(new Date(endTime.getTime())));\n        return (startDay === endDay);\n    }\n    getAppointmentLeft(schedule, startTime, day) {\n        const slotTd = (this.isSameDay(startTime, schedule.startHour)) ?\n            ((getUniversalTime(startTime) - getUniversalTime(schedule.startHour)) /\n                (MS_PER_MINUTE * this.interval)) * this.slotCount : 0;\n        if (day === 0) {\n            return slotTd;\n        }\n        else {\n            const daySlot = Math.round((((getUniversalTime(schedule.endHour) - getUniversalTime(schedule.startHour)) /\n                MS_PER_MINUTE) / this.interval) * this.slotCount);\n            return (daySlot * day) + slotTd;\n        }\n    }\n    getPosition(startTime, endTime, isAllDay, day) {\n        if (this.renderType === 'day' || isAllDay) {\n            return (day * this.slotsPerDay) * this.cellWidth;\n        }\n        const currentDate = resetTime(new Date(this.dateRender[day].getTime()));\n        const schedule = getStartEndHours(currentDate, this.startHour, this.endHour);\n        let cellIndex;\n        if (schedule.endHour.getTime() <= endTime.getTime() && schedule.startHour.getTime() >= startTime.getTime()) {\n            cellIndex = this.getAppointmentLeft(schedule, schedule.startHour, day);\n        }\n        else if (schedule.endHour.getTime() <= endTime.getTime()) {\n            cellIndex = this.getAppointmentLeft(schedule, startTime, day);\n        }\n        else if (schedule.startHour.getTime() >= startTime.getTime()) {\n            cellIndex = this.getAppointmentLeft(schedule, schedule.startHour, day);\n        }\n        else {\n            cellIndex = this.getAppointmentLeft(schedule, startTime, day);\n        }\n        return cellIndex * this.cellWidth;\n    }\n    getFilterEvents(startDate, endDate, startTime, endTime, gIndex, eventsList) {\n        if (this.renderType === 'day') {\n            return this.getFilteredEvents(startDate, endDate, gIndex, eventsList);\n        }\n        else {\n            return this.getFilteredEvents(startTime, endTime, gIndex, eventsList);\n        }\n    }\n    isAlreadyAvail(appPos, cellTd) {\n        const moreIndicator = [].slice.call(cellTd.querySelectorAll('.' + MORE_INDICATOR_CLASS));\n        for (let i = 0; i < moreIndicator.length; i++) {\n            let indicatorPos;\n            if (moreIndicator) {\n                indicatorPos = (this.parent.enableRtl) ? moreIndicator[i].style.right : moreIndicator[i].style.left;\n            }\n            if (parseInt(indicatorPos, 10) === Math.floor(appPos)) {\n                return true;\n            }\n        }\n        return false;\n    }\n    getRowTop(resIndex) {\n        if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n            return this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS +\n                ' ' + 'tbody td[data-group-index=\"' + resIndex.toString() + '\"]').offsetTop;\n        }\n        return 0;\n    }\n    getCellTd() {\n        const wrapIndex = this.parent.uiStateValues.isGroupAdaptive ? 0 : this.rowIndex;\n        return this.eventContainers[wrapIndex];\n    }\n    renderBlockIndicator(cellTd, position, resIndex) {\n        // No need to render block icon for Year, Month and Week header rows\n        if (this.parent.headerRows.length > 0 &&\n            (this.parent.headerRows[this.parent.headerRows.length - 1].option !== 'Hour' ||\n                this.parent.headerRows[this.parent.headerRows.length - 1].option !== 'Date')) {\n            return;\n        }\n        position = (Math.floor(position / this.cellWidth) * this.cellWidth) + this.cellWidth - BLOCK_INDICATOR_WIDTH;\n        if (!this.isAlreadyAvail(position, cellTd)) {\n            const blockIndicator = createElement('div', { className: 'e-icons ' + BLOCK_INDICATOR_CLASS });\n            if (this.parent.activeViewOptions.group.resources.length > 0) {\n                blockIndicator.setAttribute('data-group-index', resIndex.toString());\n            }\n            if (this.parent.enableRtl) {\n                blockIndicator.style.right = position + 'px';\n            }\n            else {\n                blockIndicator.style.left = position + 'px';\n            }\n            blockIndicator.style.top = this.getRowTop(resIndex) + this.cellHeight - BLOCK_INDICATOR_HEIGHT + 'px';\n            this.renderElement(cellTd, blockIndicator);\n        }\n    }\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    setMaxEventHeight(event, cell) {\n        setStyleAttribute(event, {\n            'height': (this.cellHeight - (this.maxHeight ? 0 : EVENT_GAP$1) - (this.maxHeight ? 0 : this.moreIndicatorHeight)) + 'px'\n        });\n    }\n    destroy() {\n        this.renderType = null;\n        this.eventContainers = null;\n        this.dayLength = null;\n        this.content = null;\n        super.destroy();\n        this.parent = null;\n    }\n}\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\n/**\n * Inline Edit interactions\n */\nclass InlineEdit {\n    constructor(parent) {\n        this.parent = parent;\n        this.parent.on(inlineClick, this.inlineEdit, this);\n    }\n    inlineEdit(args) {\n        if (this.parent.quickPopup) {\n            this.parent.quickPopup.quickPopupHide();\n        }\n        if (args.type === 'Cell') {\n            const moreWrapper = this.parent.element.querySelector('.' + MORE_POPUP_WRAPPER_CLASS);\n            if (moreWrapper && moreWrapper.classList.contains(POPUP_OPEN)) {\n                this.parent.quickPopup.morePopup.hide();\n            }\n            this.removeInlineAppointmentElement();\n            this.cellEdit(args);\n        }\n        else {\n            if (this.parent.element.querySelector('.' + INLINE_SUBJECT_CLASS) !==\n                args.element.querySelector('.' + INLINE_SUBJECT_CLASS)) {\n                this.removeInlineAppointmentElement();\n            }\n            this.eventEdit(args);\n        }\n    }\n    cellEdit(args) {\n        const saveObj = this.generateEventData();\n        let cellIndex = args.element.cellIndex;\n        let count = this.getEventDaysCount(saveObj);\n        if (count > 1) {\n            count = Math.round(count);\n            count--;\n            cellIndex = cellIndex - count;\n        }\n        const start = resetTime(new Date('' + saveObj[this.parent.eventFields.startTime])).getTime();\n        const end = resetTime(new Date('' + saveObj[this.parent.eventFields.endTime])).getTime();\n        const resIndex = args.groupIndex || 0;\n        if (this.parent.currentView === 'Day' || this.parent.currentView === 'Week' || this.parent.currentView === 'WorkWeek') {\n            const dayIndex = saveObj[this.parent.eventFields.startTime].getDay();\n            this.createVerticalViewInline(saveObj, dayIndex, resIndex, cellIndex);\n        }\n        else if (this.parent.currentView === 'Month') {\n            this.createMonthViewInline(saveObj, resIndex, start, end);\n        }\n        else {\n            this.createTimelineViewInline(saveObj, start, end, resIndex);\n        }\n        const inlineSubject = this.parent.element.querySelector('.' + INLINE_SUBJECT_CLASS);\n        if (inlineSubject) {\n            inlineSubject.focus();\n        }\n    }\n    eventEdit(args) {\n        let inlineSubject = args.element.querySelector('.' + INLINE_SUBJECT_CLASS);\n        let subject;\n        if (inlineSubject) {\n            subject = inlineSubject.value;\n        }\n        else {\n            const subEle = args.element.querySelector('.' + SUBJECT_CLASS);\n            const timeEle = args.element.querySelector('.' + APPOINTMENT_TIME);\n            subject = subEle.innerText;\n            inlineSubject = createElement('input', { className: INLINE_SUBJECT_CLASS, attrs: { value: subject } });\n            addClass([subEle], DISABLE_CLASS);\n            if (closest(args.element, '.' + MORE_POPUP_WRAPPER_CLASS)) {\n                args.element.insertBefore(inlineSubject, subEle);\n            }\n            else if (['Agenda', 'MonthAgenda'].indexOf(this.parent.currentView) > -1) {\n                const subjectWrap = args.element.querySelector('.' + SUBJECT_WRAP);\n                subjectWrap.insertBefore(inlineSubject, subjectWrap.firstChild);\n            }\n            else {\n                const elementSelector = ['TimelineDay', 'TimelineWeek', 'TimelineWorkWeek', 'TimelineMonth'].indexOf(this.parent.currentView) > -1 ?\n                    '.e-inner-wrap' : '.e-appointment-details';\n                args.element.querySelector(elementSelector).insertBefore(inlineSubject, timeEle);\n            }\n            inlineSubject.focus();\n        }\n        inlineSubject.setSelectionRange(subject.length, subject.length);\n    }\n    createVerticalViewInline(saveObj, dayIndex, resIndex, daysCount) {\n        const count = this.getEventDaysCount(saveObj);\n        const verticalEvent = new VerticalEvent(this.parent);\n        verticalEvent.initializeValues();\n        const index = verticalEvent.dateRender[resIndex].map((date) => date.getDay()).indexOf(dayIndex);\n        if (count >= 1) {\n            verticalEvent.allDayElement = [].slice.call(this.parent.element.querySelectorAll('.' + ALLDAY_CELLS_CLASS));\n            verticalEvent.slots.push(...this.parent.activeView.renderDates.map((date) => +date));\n            const allDayElements = [].slice.call(this.parent.element.querySelectorAll('.' + ALLDAY_APPOINTMENT_CLASS));\n            let allDayLevel = 0;\n            if (allDayElements.length > 0) {\n                allDayLevel = Math.floor(this.parent.element.querySelector('.' + ALLDAY_ROW_CLASS).getBoundingClientRect().height /\n                    allDayElements[0].offsetHeight) - 1;\n            }\n            verticalEvent.allDayLevel = allDayLevel;\n            verticalEvent.renderAllDayEvents(saveObj, index, resIndex, daysCount, this.parent.allowInline);\n        }\n        else {\n            verticalEvent.renderNormalEvents(saveObj, index, resIndex, daysCount, this.parent.allowInline);\n        }\n    }\n    createMonthViewInline(saveObj, index, start, end) {\n        const count = this.getEventDaysCount(saveObj);\n        const saveObject = this.parent.eventBase.cloneEventObject(saveObj, start, end, count, false, false);\n        const monthEvent = new MonthEvent(this.parent);\n        monthEvent.dateRender = this.parent.activeView.renderDates;\n        monthEvent.inlineValue = this.parent.allowInline;\n        let renderDates = this.parent.activeView.renderDates;\n        let workDays = this.parent.activeViewOptions.workDays;\n        let monthCellSelector = '.' + WORK_CELLS_CLASS;\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            monthCellSelector += '[data-group-index=\"' + index + '\"]';\n            const resourceData = this.parent.resourceBase.lastResourceLevel[index];\n            renderDates = resourceData.renderDates;\n            workDays = resourceData.workDays;\n        }\n        monthEvent.workCells = [].slice.call(this.parent.element.querySelectorAll(monthCellSelector));\n        monthEvent.cellWidth = monthEvent.workCells[0].offsetWidth;\n        monthEvent.cellHeight = monthEvent.workCells[0].offsetHeight;\n        monthEvent.eventHeight = getElementHeightFromClass(this.parent.monthModule.element, APPOINTMENT_CLASS);\n        monthEvent.getSlotDates(workDays);\n        const filteredDates = monthEvent.getRenderedDates(renderDates);\n        const spannedEvents = monthEvent.splitEvent(saveObject, filteredDates || renderDates);\n        for (const eventData of spannedEvents) {\n            monthEvent.renderEvents(eventData, index);\n        }\n        const inlineSubject = this.parent.element.querySelector('.' + INLINE_SUBJECT_CLASS);\n        inlineSubject.focus();\n    }\n    createTimelineViewInline(saveObj, start, end, resIndex) {\n        const count = this.getEventDaysCount(saveObj);\n        const saveObject = this.parent.eventBase.cloneEventObject(saveObj, start, end, count, false, false);\n        const timelineView = new TimelineEvent(this.parent, this.parent.activeViewOptions.timeScale.enable ? 'hour' : 'day');\n        timelineView.dateRender = this.parent.activeView.renderDates;\n        timelineView.eventContainers = [].slice.call(this.parent.element.querySelectorAll('.' + APPOINTMENT_CONTAINER_CLASS));\n        const workCell = this.parent.element.querySelector('.' + WORK_CELLS_CLASS);\n        timelineView.inlineValue = this.parent.allowInline;\n        timelineView.cellWidth = workCell.offsetWidth;\n        timelineView.cellHeight = workCell.offsetHeight;\n        const dayLength = this.parent.element.querySelectorAll('.' + CONTENT_TABLE_CLASS + ' tbody tr').length === 0 ?\n            0 : this.parent.element.querySelectorAll('.' + CONTENT_TABLE_CLASS + ' tbody tr')[0].children.length;\n        timelineView.slotsPerDay = dayLength / timelineView.dateRender.length;\n        timelineView.eventHeight = getElementHeightFromClass(timelineView.element, APPOINTMENT_CLASS);\n        timelineView.renderEvents(saveObject, resIndex);\n    }\n    getEventDaysCount(saveObj) {\n        const startDate = saveObj[this.parent.eventFields.startTime];\n        const endDate = saveObj[this.parent.eventFields.endTime];\n        const daysCount = Math.abs(endDate.getTime() - startDate.getTime()) / MS_PER_DAY;\n        return daysCount;\n    }\n    generateEventData(target) {\n        const inlineElement = this.parent.element.querySelector('.' + INLINE_SUBJECT_CLASS);\n        const subject = inlineElement ? inlineElement.value : target ? target.innerHTML : '';\n        const saveObj = {};\n        saveObj[this.parent.eventFields.id] = this.parent.eventBase.getEventMaxID();\n        saveObj[this.parent.eventFields.subject] = subject;\n        saveObj[this.parent.eventFields.startTime] = this.parent.activeCellsData.startTime;\n        saveObj[this.parent.eventFields.endTime] = this.parent.activeCellsData.endTime;\n        saveObj[this.parent.eventFields.isAllDay] = this.parent.activeCellsData.isAllDay;\n        this.parent.eventWindow.setDefaultValueToObject(saveObj);\n        if (this.parent.resourceBase) {\n            this.parent.resourceBase.setResourceValues(saveObj, this.parent.activeCellsData.groupIndex);\n        }\n        return saveObj;\n    }\n    documentClick() {\n        const target = this.parent.element.querySelector('.' + INLINE_SUBJECT_CLASS);\n        if (target && target.value !== '') {\n            this.inlineCrudActions(target);\n        }\n        else {\n            this.removeInlineAppointmentElement();\n        }\n    }\n    inlineCrudActions(target) {\n        if (closest(target, '.' + INLINE_APPOINTMENT_CLASS)) {\n            const saveObj = this.generateEventData(target);\n            this.parent.addEvent(saveObj);\n        }\n        else {\n            const eventTarget = closest(target, '.' + APPOINTMENT_CLASS);\n            const eventDetails = this.parent.getEventDetails(eventTarget);\n            eventDetails[this.parent.eventFields.subject] = target.value;\n            let currentAction;\n            if (eventDetails[this.parent.eventFields.id] === eventDetails[this.parent.eventFields.recurrenceID]) {\n                currentAction = 'EditOccurrence';\n                eventDetails[this.parent.eventFields.id] = this.parent.eventBase.getEventMaxID();\n            }\n            this.parent.saveEvent(eventDetails, currentAction);\n        }\n        this.removeInlineAppointmentElement();\n    }\n    createInlineAppointmentElement(inlineData) {\n        const inlineAppointmentElement = createElement('div', {\n            className: APPOINTMENT_CLASS + ' ' + INLINE_APPOINTMENT_CLASS\n        });\n        const inlineDetails = createElement('div', { className: APPOINTMENT_DETAILS });\n        inlineAppointmentElement.appendChild(inlineDetails);\n        const inline = createElement('input', { className: INLINE_SUBJECT_CLASS });\n        inlineDetails.appendChild(inline);\n        if (inlineData) {\n            this.parent.eventBase.applyResourceColor(inlineAppointmentElement, inlineData, 'backgroundColor');\n        }\n        return inlineAppointmentElement;\n    }\n    removeInlineAppointmentElement() {\n        const inlineAppointment = [].slice.call(this.parent.element.querySelectorAll('.' + INLINE_APPOINTMENT_CLASS));\n        if (inlineAppointment.length > 0) {\n            inlineAppointment.forEach((node) => remove(node));\n        }\n        const inlineSubject = this.parent.element.querySelector('.' + INLINE_SUBJECT_CLASS);\n        if (inlineSubject) {\n            const appointmentSubject = closest(inlineSubject, '.' + APPOINTMENT_CLASS);\n            removeClass([appointmentSubject.querySelector('.' + SUBJECT_CLASS)], DISABLE_CLASS);\n            remove(inlineSubject);\n        }\n    }\n    destroy() {\n        this.parent.off(inlineClick, this.inlineEdit);\n    }\n}\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\n/**\n * Appointment window field validation\n */\nclass FieldValidator {\n    renderFormValidator(form, rules, element, locale) {\n        this.element = element;\n        this.formObj = new FormValidator(form, {\n            locale: locale,\n            customPlacement: (inputElement, error) => {\n                this.errorPlacement(inputElement, error);\n            },\n            rules: rules,\n            validationComplete: (args) => {\n                this.validationComplete(args);\n            },\n            focusout: (args) => {\n                this.focusOut(args);\n            }\n        });\n    }\n    focusOut(args) {\n        const target = args.relatedTarget;\n        if (target && (target.classList.contains('e-dlg-closeicon-btn') || target.classList.contains('e-close')\n            || target.classList.contains(ALLDAY_CELLS_CLASS) || target.classList.contains(HEADER_CELLS_CLASS)\n            || target.classList.contains(QUICK_POPUP_EVENT_DETAILS_CLASS) || target.classList.contains(WORK_CELLS_CLASS)\n            || target.classList.contains(EVENT_WINDOW_CANCEL_BUTTON_CLASS))) {\n            this.ignoreError = true;\n        }\n        else {\n            this.ignoreError = false;\n        }\n    }\n    validationComplete(args) {\n        const elem = this.element.querySelector('#' + args.inputName + '_Error');\n        if (elem) {\n            elem.style.display = (args.status === 'failure') ? '' : 'none';\n        }\n    }\n    errorPlacement(inputElement, error) {\n        const id = error.getAttribute('for');\n        const elem = this.element.querySelector('#' + id + '_Error');\n        if (!elem && !this.ignoreError) {\n            this.createTooltip(inputElement, error, id, '');\n        }\n        if (!isNullOrUndefined(elem)) {\n            elem.querySelector('.e-error').innerHTML = error.innerHTML;\n        }\n    }\n    createTooltip(element, error, name, display) {\n        let dlgContent;\n        let client;\n        const inputClient = element.getBoundingClientRect();\n        if (this.element.classList.contains(POPUP_WRAPPER_CLASS)) {\n            dlgContent = this.element;\n            client = this.element.getBoundingClientRect();\n        }\n        else {\n            dlgContent = this.element.querySelector('.e-schedule-dialog .e-dlg-content');\n            client = dlgContent.getBoundingClientRect();\n        }\n        const div = createElement('div', {\n            className: 'e-tooltip-wrap e-popup ' + ERROR_VALIDATION_CLASS,\n            id: name + '_Error',\n            styles: 'display:' + display + ';top:' +\n                (inputClient.bottom - client.top + dlgContent.scrollTop + 9) + 'px;left:' +\n                (inputClient.left - client.left + dlgContent.scrollLeft + inputClient.width / 2) + 'px;'\n        });\n        const content = createElement('div', { className: 'e-tip-content' });\n        content.appendChild(error);\n        const arrow = createElement('div', { className: 'e-arrow-tip e-tip-top' });\n        arrow.appendChild(createElement('div', { className: 'e-arrow-tip-outer e-tip-top' }));\n        arrow.appendChild(createElement('div', { className: 'e-arrow-tip-inner e-tip-top' }));\n        div.appendChild(content);\n        div.appendChild(arrow);\n        dlgContent.appendChild(div);\n        div.style.left = (parseInt(div.style.left, 10) - div.offsetWidth / 2) + 'px';\n    }\n    destroyToolTip() {\n        if (this.element) {\n            const elements = [].slice.call(this.element.querySelectorAll('.' + ERROR_VALIDATION_CLASS));\n            for (const elem of elements) {\n                remove(elem);\n            }\n        }\n        if (this.formObj && this.formObj.element) {\n            this.formObj.reset();\n        }\n    }\n    destroy() {\n        if (this.formObj && this.formObj.element && !this.formObj.isDestroyed) {\n            this.formObj.destroy();\n        }\n        this.formObj = null;\n        this.element = null;\n    }\n}\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\nconst EVENT_FIELD = 'e-field';\n/**\n * Quick Popups interactions\n */\nclass QuickPopups {\n    constructor(parent) {\n        this.isMultipleEventSelect = false;\n        this.isCrudAction = false;\n        this.parent = parent;\n        this.l10n = this.parent.localeObj;\n        this.fieldValidator = new FieldValidator();\n        this.render();\n        this.addEventListener();\n    }\n    render() {\n        this.renderQuickPopup();\n        this.renderMorePopup();\n        this.renderQuickDialog();\n    }\n    renderQuickPopup() {\n        const quickPopupWrapper = createElement('div', { className: POPUP_WRAPPER_CLASS + ' e-popup-close' });\n        if (this.parent.isAdaptive) {\n            document.body.appendChild(quickPopupWrapper);\n            addClass([quickPopupWrapper], DEVICE_CLASS);\n        }\n        else {\n            this.parent.element.appendChild(quickPopupWrapper);\n        }\n        this.quickPopup = new Popup(quickPopupWrapper, {\n            targetType: (this.parent.isAdaptive ? 'container' : 'relative'),\n            enableRtl: this.parent.enableRtl,\n            open: this.quickPopupOpen.bind(this),\n            close: this.quickPopupClose.bind(this),\n            hideAnimation: (this.parent.isAdaptive ? { name: 'ZoomOut' } : { name: 'FadeOut', duration: 150 }),\n            showAnimation: (this.parent.isAdaptive ? { name: 'ZoomIn' } : { name: 'FadeIn', duration: 150 }),\n            collision: (this.parent.isAdaptive ? { X: 'fit', Y: 'fit' } :\n                (this.parent.enableRtl ? { X: 'flip', Y: 'fit' } : { X: 'none', Y: 'fit' })),\n            position: (this.parent.isAdaptive || this.parent.enableRtl ? { X: 'left', Y: 'top' } : { X: 'right', Y: 'top' }),\n            viewPortElement: (this.parent.isAdaptive ? document.body : this.parent.element),\n            zIndex: (this.parent.isAdaptive ? 1004 : 3)\n        });\n    }\n    renderMorePopup() {\n        const moreEventPopup = `<div class=\"${MORE_EVENT_POPUP_CLASS}\"><div class=\"${MORE_EVENT_HEADER_CLASS}\">` +\n            `<div class=\"${MORE_EVENT_CLOSE_CLASS}\" title=\"${this.l10n.getConstant('close')}\" tabindex=\"0\"></div>` +\n            `<div class=\"${MORE_EVENT_DATE_HEADER_CLASS}\"><div class=\"${MORE_EVENT_HEADER_DAY_CLASS}\"></div>` +\n            `<div class=\"${MORE_EVENT_HEADER_DATE_CLASS} ${NAVIGATE_CLASS}\" tabindex=\"0\"></div></div></div></div>`;\n        const moreEventWrapper = createElement('div', {\n            className: MORE_POPUP_WRAPPER_CLASS + ' e-popup-close',\n            innerHTML: moreEventPopup\n        });\n        if (this.parent.isAdaptive) {\n            document.body.appendChild(moreEventWrapper);\n            addClass([moreEventWrapper], DEVICE_CLASS);\n        }\n        else {\n            this.parent.element.appendChild(moreEventWrapper);\n        }\n        this.morePopup = new Popup(moreEventWrapper, {\n            targetType: (this.parent.isAdaptive ? 'container' : 'relative'),\n            enableRtl: this.parent.enableRtl,\n            hideAnimation: { name: 'ZoomOut', duration: 300 },\n            showAnimation: { name: 'ZoomIn', duration: 300 },\n            open: this.morePopupOpen.bind(this),\n            close: this.morePopupClose.bind(this),\n            collision: (this.parent.isAdaptive ? { X: 'fit', Y: 'fit' } :\n                (this.parent.enableRtl ? { X: 'flip', Y: 'fit' } : { X: 'flip', Y: 'flip' })),\n            viewPortElement: (this.parent.isAdaptive ? document.body : this.parent.element),\n            zIndex: (this.parent.isAdaptive ? 1002 : 2)\n        });\n        const closeButton = this.morePopup.element.querySelector('.' + MORE_EVENT_CLOSE_CLASS);\n        this.renderButton('e-round', ICON + ' ' + CLOSE_ICON_CLASS, false, closeButton, this.closeClick);\n        EventHandler.add(this.morePopup.element.querySelector('.' + MORE_EVENT_HEADER_DATE_CLASS), 'click', this.navigationClick, this);\n    }\n    renderQuickDialog() {\n        const buttonModel = [\n            { buttonModel: { cssClass: 'e-quick-alertok e-flat', isPrimary: true }, click: this.dialogButtonClick.bind(this) },\n            { buttonModel: { cssClass: 'e-quick-alertcancel e-flat', isPrimary: false }, click: this.dialogButtonClick.bind(this) },\n            {\n                buttonModel: { cssClass: 'e-quick-dialog-cancel e-disable e-flat', isPrimary: false },\n                click: this.dialogButtonClick.bind(this)\n            }\n        ];\n        if (this.parent.eventSettings.editFollowingEvents) {\n            const followingSeriesButton = {\n                buttonModel: { cssClass: 'e-quick-alertfollowing e-flat', isPrimary: false }, click: this.dialogButtonClick.bind(this)\n            };\n            buttonModel.splice(1, 0, followingSeriesButton);\n        }\n        this.quickDialog = new Dialog({\n            animationSettings: { effect: 'Zoom' },\n            buttons: buttonModel,\n            cssClass: QUICK_DIALOG_CLASS,\n            closeOnEscape: true,\n            enableRtl: this.parent.enableRtl,\n            beforeClose: this.beforeQuickDialogClose.bind(this),\n            isModal: true,\n            position: { X: 'center', Y: 'center' },\n            showCloseIcon: true,\n            target: document.body,\n            visible: false,\n            width: 'auto'\n        });\n        const dialogElement = createElement('div', { id: this.parent.element.id + 'QuickDialog' });\n        this.parent.element.appendChild(dialogElement);\n        this.quickDialog.appendTo(dialogElement);\n        const okButton = this.quickDialog.element.querySelector('.' + QUICK_DIALOG_ALERT_OK);\n        if (okButton) {\n            okButton.setAttribute('aria-label', this.l10n.getConstant('occurrence'));\n            okButton.setAttribute('aria-label', okButton.innerHTML);\n        }\n        const cancelButton = this.quickDialog.element.querySelector('.' + QUICK_DIALOG_ALERT_CANCEL);\n        if (cancelButton) {\n            cancelButton.setAttribute('aria-label', this.l10n.getConstant('series'));\n            cancelButton.setAttribute('aria-label', cancelButton.innerHTML);\n        }\n        if (this.quickDialog.element.querySelector('.e-dlg-closeicon-btn')) {\n            this.quickDialog.element.querySelector('.e-dlg-closeicon-btn').setAttribute('title', this.l10n.getConstant('close'));\n        }\n    }\n    // eslint-disable-next-line max-len\n    renderButton(className, iconName, isDisabled, element, clickEvent) {\n        const buttonObj = new Button({\n            cssClass: className,\n            disabled: isDisabled,\n            enableRtl: this.parent.enableRtl,\n            iconCss: iconName\n        });\n        buttonObj.appendTo(element);\n        EventHandler.add(element, 'click', clickEvent, this);\n        removeClass([element], ICON);\n    }\n    quickDialogClass(action) {\n        const classList$$1 = [\n            QUICK_DIALOG_OCCURRENCE_CLASS, QUICK_DIALOG_SERIES_CLASS, QUICK_DIALOG_DELETE_CLASS,\n            QUICK_DIALOG_CANCEL_CLASS, QUICK_DIALOG_ALERT_BTN_CLASS, DISABLE_CLASS\n        ];\n        const okButton = this.quickDialog.element.querySelector('.' + QUICK_DIALOG_ALERT_OK);\n        const cancelButton = this.quickDialog.element.querySelector('.' + QUICK_DIALOG_ALERT_CANCEL);\n        const followingEventButton = this.quickDialog.element.querySelector('.' + QUICK_DIALOG_ALERT_FOLLOWING);\n        removeClass([okButton, cancelButton], classList$$1);\n        addClass([this.quickDialog.element.querySelector('.' + QUICK_DIALOG_CANCEL_CLASS)], DISABLE_CLASS);\n        if (this.parent.eventSettings.editFollowingEvents) {\n            addClass([followingEventButton], DISABLE_CLASS);\n            removeClass([this.quickDialog.element], FOLLOWING_EVENTS_DIALOG);\n        }\n        switch (action) {\n            case 'Recurrence':\n                addClass([okButton], QUICK_DIALOG_OCCURRENCE_CLASS);\n                addClass([cancelButton], QUICK_DIALOG_SERIES_CLASS);\n                if (this.parent.eventSettings.editFollowingEvents) {\n                    removeClass([followingEventButton], DISABLE_CLASS);\n                    addClass([this.quickDialog.element], FOLLOWING_EVENTS_DIALOG);\n                    addClass([followingEventButton], QUICK_DIALOG_FOLLOWING_EVENTS_CLASS);\n                }\n                break;\n            case 'Delete':\n                addClass([okButton], QUICK_DIALOG_DELETE_CLASS);\n                addClass([cancelButton], QUICK_DIALOG_CANCEL_CLASS);\n                break;\n            case 'Alert':\n                addClass([okButton], [QUICK_DIALOG_ALERT_OK, QUICK_DIALOG_ALERT_BTN_CLASS]);\n                addClass([cancelButton], [QUICK_DIALOG_ALERT_CANCEL, DISABLE_CLASS]);\n                break;\n        }\n    }\n    applyFormValidation() {\n        const form = this.quickPopup.element.querySelector('.' + FORM_CLASS);\n        const rules = {};\n        rules[this.parent.eventSettings.fields.subject.name] = this.parent.eventSettings.fields.subject.validation;\n        this.fieldValidator.renderFormValidator(form, rules, this.quickPopup.element, this.parent.locale);\n    }\n    openRecurrenceAlert() {\n        const editDeleteOnly = this.quickDialog.element.querySelector('.' + QUICK_DIALOG_ALERT_OK);\n        if (editDeleteOnly) {\n            editDeleteOnly.innerHTML = this.l10n.getConstant(this.parent.currentAction === 'Delete' ? 'deleteEvent' : 'editEvent');\n            editDeleteOnly.setAttribute('aria-label', editDeleteOnly.innerHTML);\n        }\n        const editFollowingEventsOnly = this.quickDialog.element.querySelector('.' + QUICK_DIALOG_ALERT_FOLLOWING);\n        if (editFollowingEventsOnly) {\n            editFollowingEventsOnly.innerHTML = this.l10n.getConstant('editFollowingEvent');\n            editFollowingEventsOnly.setAttribute('aria-label', editFollowingEventsOnly.innerHTML);\n        }\n        const editDeleteSeries = this.quickDialog.element.querySelector('.' + QUICK_DIALOG_ALERT_CANCEL);\n        if (editDeleteSeries) {\n            editDeleteSeries.innerHTML = this.l10n.getConstant(this.parent.currentAction === 'Delete' ? 'deleteSeries' : 'editSeries');\n            editDeleteSeries.setAttribute('aria-label', editDeleteSeries.innerHTML);\n        }\n        this.quickDialog.content = this.l10n.getConstant('editContent');\n        this.quickDialog.header = this.l10n.getConstant(this.parent.currentAction === 'Delete' ? 'deleteTitle' : 'editTitle');\n        this.quickDialogClass('Recurrence');\n        const activeEvent = this.parent.activeEventData.event;\n        if (this.parent.eventSettings.editFollowingEvents && this.parent.currentAction === 'EditOccurrence'\n            && !isNullOrUndefined(activeEvent[this.parent.eventFields.recurrenceID]) && activeEvent[this.parent.eventFields.recurrenceID]\n            !== activeEvent[this.parent.eventFields.id]) {\n            const followingEventButton = this.quickDialog.element.querySelector('.' + QUICK_DIALOG_ALERT_FOLLOWING);\n            addClass([followingEventButton], DISABLE_CLASS);\n        }\n        this.showQuickDialog('RecurrenceAlert');\n    }\n    openRecurrenceValidationAlert(type) {\n        this.quickDialogClass('Alert');\n        const okButton = this.quickDialog.element.querySelector('.' + QUICK_DIALOG_ALERT_OK);\n        okButton.innerHTML = this.l10n.getConstant('ok');\n        okButton.setAttribute('aria-label', okButton.innerHTML);\n        const cancelButton = this.quickDialog.element.querySelector('.' + QUICK_DIALOG_ALERT_CANCEL);\n        cancelButton.innerHTML = this.l10n.getConstant('cancel');\n        cancelButton.setAttribute('aria-label', cancelButton.innerHTML);\n        this.quickDialog.header = this.l10n.getConstant('alert');\n        let dialogCancel;\n        switch (type) {\n            case 'wrongPattern':\n                addClass([cancelButton], DISABLE_CLASS);\n                this.quickDialog.content = this.l10n.getConstant('wrongPattern');\n                break;\n            case 'createError':\n                addClass([cancelButton], DISABLE_CLASS);\n                this.quickDialog.content = this.l10n.getConstant('createError');\n                break;\n            case 'sameDayAlert':\n                addClass([cancelButton], DISABLE_CLASS);\n                this.quickDialog.content = this.l10n.getConstant('sameDayAlert');\n                break;\n            case 'seriesChangeAlert':\n                dialogCancel = this.quickDialog.element.querySelector('.' + QUICK_DIALOG_CANCEL_CLASS);\n                removeClass([cancelButton, dialogCancel], DISABLE_CLASS);\n                this.quickDialog.content = this.l10n.getConstant('seriesChangeAlert');\n                okButton.innerHTML = this.l10n.getConstant('yes');\n                cancelButton.innerHTML = this.l10n.getConstant('no');\n                dialogCancel.innerHTML = this.l10n.getConstant('cancel');\n                break;\n            case 'occurrenceAlert':\n                addClass([cancelButton], DISABLE_CLASS);\n                this.quickDialog.content = this.l10n.getConstant('occurenceAlert');\n                break;\n        }\n        if ((!this.parent.enableRecurrenceValidation && type === 'wrongPattern') || this.parent.enableRecurrenceValidation) {\n            this.showQuickDialog('RecurrenceValidationAlert');\n        }\n    }\n    openDeleteAlert() {\n        if (this.parent.activeViewOptions.readonly) {\n            return;\n        }\n        const okButton = this.quickDialog.element.querySelector('.' + QUICK_DIALOG_ALERT_OK);\n        if (okButton) {\n            okButton.innerHTML = this.l10n.getConstant('delete');\n            okButton.setAttribute('aria-label', okButton.innerHTML);\n        }\n        const cancelButton = this.quickDialog.element.querySelector('.' + QUICK_DIALOG_ALERT_CANCEL);\n        if (cancelButton) {\n            cancelButton.innerHTML = this.l10n.getConstant('cancel');\n            cancelButton.setAttribute('aria-label', cancelButton.innerHTML);\n        }\n        this.quickDialog.content = (this.parent.activeEventData.event.length > 1) ?\n            this.l10n.getConstant('deleteMultipleContent') : this.l10n.getConstant('deleteContent');\n        this.quickDialog.header = (this.parent.activeEventData.event.length > 1) ?\n            this.l10n.getConstant('deleteMultipleEvent') : this.l10n.getConstant('deleteEvent');\n        this.quickDialogClass('Delete');\n        this.showQuickDialog('DeleteAlert');\n    }\n    openValidationError(type, eventData) {\n        this.quickDialog.header = this.l10n.getConstant('alert');\n        this.quickDialog.content = this.l10n.getConstant(type);\n        const okButton = this.quickDialog.element.querySelector('.' + QUICK_DIALOG_ALERT_OK);\n        if (okButton) {\n            okButton.innerHTML = this.l10n.getConstant('ok');\n            okButton.setAttribute('aria-label', okButton.innerHTML);\n        }\n        const cancelButton = this.quickDialog.element.querySelector('.' + QUICK_DIALOG_ALERT_CANCEL);\n        if (cancelButton) {\n            cancelButton.innerHTML = this.l10n.getConstant('cancel');\n            okButton.setAttribute('aria-label', cancelButton.innerHTML);\n        }\n        this.quickDialogClass('Alert');\n        this.showQuickDialog('ValidationAlert', eventData);\n    }\n    showQuickDialog(popupType, eventData) {\n        this.quickDialog.dataBind();\n        const eventProp = {\n            type: popupType, cancel: false, element: this.quickDialog.element,\n            data: extend({}, (eventData || this.parent.activeEventData.event), null, true)\n        };\n        this.parent.trigger(popupOpen, eventProp, (popupArgs) => {\n            if (!popupArgs.cancel) {\n                this.quickDialog.show();\n            }\n        });\n    }\n    createMoreEventList(eventCollection, groupOrder, groupIndex) {\n        const fields = this.parent.eventFields;\n        const moreEventContentEle = createElement('div', { className: MORE_EVENT_CONTENT_CLASS });\n        let moreEventWrapperEle = createElement('div', { className: MORE_EVENT_WRAPPER_CLASS });\n        if (eventCollection.length === 0) {\n            moreEventWrapperEle = createElement('div', {\n                className: MORE_EVENT_CONTENT_CLASS,\n                innerHTML: this.l10n.getConstant('emptyContainer')\n            });\n        }\n        else {\n            for (const eventData of eventCollection) {\n                const eventText = (eventData[fields.subject] || this.parent.eventSettings.fields.subject.default\n                    || this.parent.localeObj.getConstant('addTitle'));\n                const appointmentElement = createElement('div', {\n                    className: APPOINTMENT_CLASS,\n                    attrs: {\n                        'data-id': '' + eventData[fields.id],\n                        'data-guid': eventData.Guid, 'role': 'button', 'tabindex': '0',\n                        'aria-disabled': this.parent.eventBase.getReadonlyAttribute(eventData),\n                        'aria-pressed': 'false', 'aria-grabbed': 'true', 'aria-label': this.parent.getAnnouncementString(eventData)\n                    }\n                });\n                let templateElement;\n                if (!isNullOrUndefined(this.parent.activeViewOptions.eventTemplate)) {\n                    const tempId = this.parent.element.id + '_' + this.parent.activeViewOptions.eventTemplateName + 'eventTemplate';\n                    templateElement = this.parent.getAppointmentTemplate()(eventData, this.parent, 'eventTemplate', tempId, false);\n                    append(templateElement, appointmentElement);\n                }\n                else {\n                    appointmentElement.appendChild(createElement('div', { className: SUBJECT_CLASS, innerHTML: eventText }));\n                }\n                if (!isNullOrUndefined(groupIndex)) {\n                    appointmentElement.setAttribute('data-group-index', groupIndex);\n                }\n                if (!isNullOrUndefined(eventData[fields.recurrenceRule])) {\n                    const iconClass = (eventData[fields.id] === eventData[fields.recurrenceID]) ?\n                        EVENT_RECURRENCE_ICON_CLASS : EVENT_RECURRENCE_EDIT_ICON_CLASS;\n                    appointmentElement.appendChild(createElement('div', { className: ICON + ' ' + iconClass }));\n                }\n                const args = {\n                    data: extend({}, eventData, null, true),\n                    element: appointmentElement, cancel: false\n                };\n                this.parent.trigger(eventRendered, args, (eventArgs) => {\n                    if (!eventArgs.cancel) {\n                        moreEventWrapperEle.appendChild(appointmentElement);\n                        const isPreventCrud = this.parent.isAdaptive || this.parent.currentView === 'Year';\n                        this.parent.eventBase.wireAppointmentEvents(appointmentElement, eventData, isPreventCrud);\n                        this.parent.eventBase.applyResourceColor(appointmentElement, eventData, 'backgroundColor', groupOrder);\n                    }\n                });\n            }\n        }\n        moreEventContentEle.appendChild(moreEventWrapperEle);\n        return moreEventContentEle;\n    }\n    tapHoldEventPopup(e) {\n        const target = closest(e.target, '.' + APPOINTMENT_CLASS);\n        this.isMultipleEventSelect = false;\n        this.parent.selectedElements = [];\n        this.isMultipleEventSelect = true;\n        this.parent.eventBase.getSelectedEventElements(target);\n        this.parent.activeEventData = this.parent.eventBase.getSelectedEvents();\n        const guid = target.getAttribute('data-guid');\n        const eventObj = this.parent.eventBase.getEventByGuid(guid);\n        if (isNullOrUndefined(eventObj)) {\n            return;\n        }\n        const eventTitle = (eventObj[this.parent.eventFields.subject] || this.l10n.getConstant('noTitle'));\n        const eventTemplate = `<div class=\"${MULTIPLE_EVENT_POPUP_CLASS}\"><div class=\"${POPUP_HEADER_CLASS}\">` +\n            `<button class=\"${CLOSE_CLASS}\" title=\"${this.l10n.getConstant('close')}\"></button>` +\n            `<div class=\"${SUBJECT_CLASS}\">${eventTitle}</div>` +\n            `<button class=\"${EDIT_CLASS}\" title=\"${this.l10n.getConstant('edit')}\"></button>` +\n            `<button class=\"${DELETE_CLASS}\" title=\"${this.l10n.getConstant('delete')}\"></button></div></div>`;\n        this.quickPopup.element.innerHTML = eventTemplate;\n        const closeIcon = this.quickPopup.element.querySelector('.' + CLOSE_CLASS);\n        this.renderButton('e-flat e-round e-small', ICON + ' ' + CLOSE_ICON_CLASS, false, closeIcon, this.closeClick);\n        const readonly = this.parent.activeViewOptions.readonly || eventObj[this.parent.eventFields.isReadonly];\n        const editAction = !this.parent.eventSettings.allowEditing || readonly;\n        const deleteAction = !this.parent.eventSettings.allowDeleting || readonly;\n        const editIcon = this.quickPopup.element.querySelector('.' + EDIT_CLASS);\n        if (editIcon) {\n            this.renderButton('e-flat e-round e-small', ICON + ' ' + EDIT_ICON_CLASS, editAction, editIcon, this.editClick);\n        }\n        const deleteIcon = this.quickPopup.element.querySelector('.' + DELETE_CLASS);\n        if (deleteIcon) {\n            this.renderButton('e-flat e-round e-small', ICON + ' ' + DELETE_ICON_CLASS, deleteAction, deleteIcon, this.deleteClick);\n        }\n        this.beforeQuickPopupOpen(target);\n    }\n    isCellBlocked(args) {\n        const tempObj = {};\n        tempObj[this.parent.eventFields.startTime] = this.parent.activeCellsData.startTime;\n        tempObj[this.parent.eventFields.endTime] = this.parent.activeCellsData.endTime;\n        tempObj[this.parent.eventFields.isAllDay] = this.parent.activeCellsData.isAllDay;\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            const targetCell = args.element instanceof Array ? args.element[0] : args.element;\n            const groupIndex = parseInt(targetCell.getAttribute('data-group-index'), 10);\n            this.parent.resourceBase.setResourceValues(tempObj, isNaN(groupIndex) ? null : groupIndex);\n        }\n        return this.parent.eventBase.isBlockRange(tempObj);\n    }\n    cellClick(args) {\n        const date = new Date(args.startTime.getTime());\n        if (!this.parent.showQuickInfo || !this.parent.eventSettings.allowAdding ||\n            this.parent.currentView === 'MonthAgenda' || this.isCellBlocked(args) ||\n            !this.parent.isMinMaxDate(new Date(date.setHours(0, 0, 0, 0)))) {\n            this.quickPopupHide();\n            return;\n        }\n        const targetEle = !isNullOrUndefined(args.event) ? args.event.target : args.element;\n        if (this.parent.isAdaptive) {\n            this.quickPopupHide();\n            let newEventClone = this.parent.element.querySelector('.' + NEW_EVENT_CLASS);\n            if (isNullOrUndefined(newEventClone)) {\n                newEventClone = createElement('div', {\n                    className: NEW_EVENT_CLASS,\n                    innerHTML: `<div class=\"e-title\">+ ${this.l10n.getConstant('newEvent')}</div>`\n                });\n            }\n            const targetCell = closest(targetEle, '.' + WORK_CELLS_CLASS + ',.' + ALLDAY_CELLS_CLASS);\n            if (targetCell) {\n                targetCell.appendChild(newEventClone);\n            }\n            return;\n        }\n        const target = closest(targetEle, '.' + WORK_CELLS_CLASS + ',.' + ALLDAY_CELLS_CLASS + ',.' +\n            HEADER_CELLS_CLASS);\n        if (isNullOrUndefined(target) || targetEle.classList.contains(MORE_INDICATOR_CLASS)) {\n            return;\n        }\n        const isSameTarget = this.quickPopup.relateTo === target;\n        if (isSameTarget && this.quickPopup.element.classList.contains(POPUP_OPEN)) {\n            const subjectElement = this.quickPopup.element.querySelector('.' + SUBJECT_CLASS);\n            if (subjectElement) {\n                subjectElement.focus();\n            }\n            return;\n        }\n        const temp = {};\n        temp[this.parent.eventFields.startTime] = this.parent.activeCellsData.startTime;\n        temp[this.parent.eventFields.endTime] = this.parent.activeCellsData.endTime;\n        temp[this.parent.eventFields.isAllDay] = this.parent.activeCellsData.isAllDay;\n        const quickCellPopup = createElement('div', { className: CELL_POPUP_CLASS });\n        quickCellPopup.appendChild(this.getPopupHeader('Cell', temp));\n        quickCellPopup.appendChild(this.getPopupContent('Cell', args, temp));\n        quickCellPopup.appendChild(this.getPopupFooter('Cell', temp));\n        const subjectElement = quickCellPopup.querySelector('.' + SUBJECT_CLASS);\n        if (subjectElement) {\n            Input.createInput({ element: subjectElement, properties: { placeholder: this.l10n.getConstant('addTitle') } });\n        }\n        if (!isNullOrUndefined(this.parent.eventSettings.fields.subject.default)) {\n            subjectElement.value = this.parent.eventSettings.fields.subject.default;\n        }\n        const closeIcon = quickCellPopup.querySelector('.' + CLOSE_CLASS);\n        if (closeIcon) {\n            this.renderButton('e-flat e-round e-small', ICON + ' ' + CLOSE_ICON_CLASS, false, closeIcon, this.popupClose);\n        }\n        const moreButton = quickCellPopup.querySelector('.' + QUICK_POPUP_EVENT_DETAILS_CLASS);\n        if (moreButton) {\n            this.renderButton('e-flat', '', false, moreButton, this.detailsClick);\n        }\n        const saveButton = quickCellPopup.querySelector('.' + EVENT_CREATE_CLASS);\n        if (saveButton) {\n            this.renderButton('e-flat e-primary', '', this.parent.activeViewOptions.readonly, saveButton, this.saveClick);\n        }\n        if (this.morePopup) {\n            this.morePopup.hide();\n        }\n        this.quickPopup.content = quickCellPopup;\n        this.quickPopup.relateTo = target;\n        this.quickPopup.dataBind();\n        this.beforeQuickPopupOpen(target);\n    }\n    isSameEventClick(events) {\n        const isSameTarget = this.quickPopup.relateTo === closest(events.element, '.' + APPOINTMENT_CLASS);\n        if (isSameTarget && this.quickPopup.element.classList.contains(POPUP_OPEN)) {\n            const editIcon = this.quickPopup.element.querySelector('.' + EDIT_CLASS);\n            if (editIcon) {\n                editIcon.focus();\n            }\n            if (!this.parent.isAdaptive) {\n                const editButton = this.quickPopup.element.querySelector('.' + EDIT_EVENT_CLASS);\n                if (editButton) {\n                    editButton.focus();\n                }\n            }\n            return true;\n        }\n        return false;\n    }\n    isQuickTemplate(type) {\n        return this.parent.quickInfoTemplates.templateType === 'Both' || this.parent.quickInfoTemplates.templateType === type;\n    }\n    eventClick(events) {\n        if (this.parent.eventTooltip) {\n            this.parent.eventTooltip.close();\n        }\n        if (!this.parent.showQuickInfo) {\n            return;\n        }\n        if (this.parent.isAdaptive && this.isMultipleEventSelect) {\n            this.updateTapHoldEventPopup(closest(events.element, '.' + APPOINTMENT_CLASS));\n        }\n        else {\n            const isSameTarget = this.isSameEventClick(events);\n            this.parent.selectedElements = [];\n            if (isSameTarget) {\n                return;\n            }\n            const eventData = events.event;\n            const quickEventPopup = createElement('div', { className: EVENT_POPUP_CLASS });\n            quickEventPopup.appendChild(this.getPopupHeader('Event', eventData));\n            quickEventPopup.appendChild(this.getPopupContent('Event', events, eventData));\n            quickEventPopup.appendChild(this.getPopupFooter('Event', eventData));\n            const readonly = this.parent.activeViewOptions.readonly || eventData[this.parent.eventFields.isReadonly];\n            const editAction = !this.parent.eventSettings.allowEditing || readonly;\n            const deleteAction = !this.parent.eventSettings.allowDeleting || readonly;\n            const editIcon = quickEventPopup.querySelector('.' + EDIT_CLASS);\n            const buttonClass = 'e-flat e-round e-small';\n            if (editIcon) {\n                this.renderButton(buttonClass, ICON + ' ' + EDIT_ICON_CLASS, editAction, editIcon, this.editClick);\n            }\n            const deleteIcon = quickEventPopup.querySelector('.' + DELETE_CLASS);\n            if (deleteIcon) {\n                this.renderButton(buttonClass, ICON + ' ' + DELETE_ICON_CLASS, deleteAction, deleteIcon, this.deleteClick);\n            }\n            const closeIcon = quickEventPopup.querySelector('.' + CLOSE_CLASS);\n            if (closeIcon) {\n                this.renderButton(buttonClass, ICON + ' ' + CLOSE_ICON_CLASS, false, closeIcon, this.popupClose);\n            }\n            const editButton = quickEventPopup.querySelector('.' + EDIT_EVENT_CLASS);\n            if (editButton) {\n                this.renderButton('e-flat e-primary', '', editAction, editButton, this.editClick);\n            }\n            const deleteButton = quickEventPopup.querySelector('.' + DELETE_EVENT_CLASS);\n            if (deleteButton) {\n                this.renderButton('e-flat', '', deleteAction, deleteButton, this.deleteClick);\n            }\n            if (this.morePopup && !closest(events.element, '.' + MORE_EVENT_WRAPPER_CLASS)) {\n                this.morePopup.hide();\n            }\n            this.quickPopup.content = quickEventPopup;\n            this.quickPopup.relateTo = this.parent.isAdaptive ? document.body :\n                closest(events.element, '.' + APPOINTMENT_CLASS);\n            this.quickPopup.dataBind();\n            this.beforeQuickPopupOpen(events.element);\n        }\n    }\n    getPopupHeader(headerType, headerData) {\n        const headerTemplate = createElement('div', { className: POPUP_HEADER_CLASS });\n        if (this.isQuickTemplate(headerType) && this.parent.quickInfoTemplates.header) {\n            const headerArgs = extend({}, headerData, { elementType: headerType.toLowerCase() }, true);\n            const templateId = this.parent.element.id;\n            const headerTemp = [].slice.call(this.parent.getQuickInfoTemplatesHeader()(headerArgs, this.parent, 'header', templateId + '_headerTemplate', false));\n            append([].slice.call(headerTemp), headerTemplate);\n        }\n        else {\n            let header;\n            let args;\n            switch (headerType) {\n                case 'Cell':\n                    header = `<div class=\"${POPUP_HEADER_ICON_WRAPPER}\"><button class=\"${CLOSE_CLASS}\" title=` +\n                        `\"${this.l10n.getConstant('close')}\"></button></div>`;\n                    break;\n                case 'Event':\n                    args = this.getFormattedString(headerData);\n                    header = `<div class=\"${POPUP_HEADER_ICON_WRAPPER}\">` +\n                        `<button class=\"${EDIT_CLASS + ' ' + ICON}\" title=\"${this.l10n.getConstant('edit')}\"></button>` +\n                        `<button class=\"${DELETE_CLASS + ' ' + ICON}\" title=\"${this.l10n.getConstant('delete')}\"></button>` +\n                        `<button class=\"${CLOSE_CLASS}\" title=\"${this.l10n.getConstant('close')}\"></button></div>` +\n                        `<div class=\"${SUBJECT_WRAP}\"><div class=\"${SUBJECT_CLASS} ${TEXT_ELLIPSIS}\" ` +\n                        `title=\"${args.eventSubject ? args.eventSubject.replaceAll('\"', '\\'') : args.eventSubject}\">${args.eventSubject}</div></div >`;\n                    break;\n            }\n            const templateWrapper = createElement('div', { innerHTML: header });\n            append([].slice.call(templateWrapper.childNodes), headerTemplate);\n        }\n        return headerTemplate;\n    }\n    getPopupContent(type, args, data) {\n        const contentTemplate = createElement('div', { className: POPUP_CONTENT_CLASS });\n        if (this.isQuickTemplate(type) && this.parent.quickInfoTemplates.content) {\n            const contentArgs = extend({}, data, { elementType: type.toLowerCase() }, true);\n            const templateId = this.parent.element.id;\n            const contentTemp = [].slice.call(this.parent.getQuickInfoTemplatesContent()(contentArgs, this.parent, 'content', templateId + '_contentTemplate', false));\n            append([].slice.call(contentTemp), contentTemplate);\n        }\n        else {\n            let content;\n            let cellDetails;\n            let argsData;\n            const resourceText = this.getResourceText(args, type.toLowerCase());\n            switch (type) {\n                case 'Cell':\n                    cellDetails = this.getFormattedString(data);\n                    content = `<table class=\"${POPUP_TABLE_CLASS}\"><tbody><tr><td><form class=\"${FORM_CLASS}\" onsubmit=` +\n                        `\"return false;\"><input class=\"${SUBJECT_CLASS} ${EVENT_FIELD}\" type=\"text\" name=` +\n                        `\"${this.parent.eventFields.subject}\" /></form></td></tr><tr><td><div class=\"${DATE_TIME_CLASS}\">` +\n                        `<div class=\"${DATE_TIME_ICON_CLASS} ${ICON}\"></div><div class=\"${DATE_TIME_DETAILS_CLASS} ` +\n                        `${TEXT_ELLIPSIS}\">${cellDetails.details}</div></div>` +\n                        `${this.parent.activeViewOptions.group.resources.length > 0 ? `<div class=\"${RESOURCE_CLASS}\">` +\n                            `<div class=\"${RESOURCE_ICON_CLASS} ${ICON} \"></div><div class=\"${RESOURCE_DETAILS_CLASS} ` +\n                            `${TEXT_ELLIPSIS}\">${resourceText}</div></div>` : ''}</td></tr></tbody></table>`;\n                    break;\n                case 'Event':\n                    argsData = this.getFormattedString(data);\n                    content = '<div class=\"' + DATE_TIME_CLASS + '\"><div class=\"' + DATE_TIME_ICON_CLASS + ' ' + ICON +\n                        '\"></div><div class=\"' + DATE_TIME_WRAPPER_CLASS + ' ' + TEXT_ELLIPSIS + '\"><div class=\"' +\n                        DATE_TIME_DETAILS_CLASS + ' ' + TEXT_ELLIPSIS + '\">' + argsData.details + '</div>';\n                    if (data[this.parent.eventFields.recurrenceRule]) {\n                        content += '<div class=\"' + RECURRENCE_SUMMARY_CLASS + ' ' + TEXT_ELLIPSIS + '\">' +\n                            this.getRecurrenceSummary(data) + '</div>';\n                    }\n                    content += '</div></div>';\n                    if (data[this.parent.eventFields.location]) {\n                        content += '<div class=\"' + LOCATION_CLASS + '\"><div class=\"' + LOCATION_ICON_CLASS + ' ' +\n                            ICON + '\"></div><div class=\"' + LOCATION_DETAILS_CLASS + ' ' + TEXT_ELLIPSIS + '\">' +\n                            data[this.parent.eventFields.location] + '</div></div>';\n                    }\n                    if (data[this.parent.eventFields.startTimezone] || data[this.parent.eventFields.endTimezone]) {\n                        content += '<div class=\"' + TIME_ZONE_CLASS + '\"><div class=\"' + TIME_ZONE_ICON_CLASS + ' ' + ICON +\n                            '\"></div><div class=\"' + TIME_ZONE_DETAILS_CLASS + ' ' + TEXT_ELLIPSIS + '\">' +\n                            this.getTimezone(data) + '</div></div>';\n                    }\n                    if (data[this.parent.eventFields.description]) {\n                        content += '<div class=\"' + DESCRIPTION_CLASS + '\"><div class=\"' + DESCRIPTION_ICON_CLASS + ' ' + ICON +\n                            '\"></div><div class=\"' + DESCRIPTION_DETAILS_CLASS + ' ' + TEXT_ELLIPSIS + '\">' +\n                            data[this.parent.eventFields.description] + '</div></div>';\n                    }\n                    if (this.parent.resourceCollection.length > 0) {\n                        content += '<div class=\"' + RESOURCE_CLASS + '\"><div class=\"' + RESOURCE_ICON_CLASS + ' ' + ICON +\n                            '\"></div><div class=\"' + RESOURCE_DETAILS_CLASS + ' ' + TEXT_ELLIPSIS + '\">' +\n                            resourceText + '</div></div>';\n                    }\n                    break;\n            }\n            const templateWrapper = createElement('div', { innerHTML: content });\n            append([].slice.call(templateWrapper.childNodes), contentTemplate);\n        }\n        return contentTemplate;\n    }\n    getPopupFooter(footerType, footerData) {\n        const footerTemplate = createElement('div', { className: POPUP_FOOTER_CLASS });\n        if (this.isQuickTemplate(footerType) && this.parent.quickInfoTemplates.footer) {\n            const footerArgs = extend({}, footerData, { elementType: footerType.toLowerCase() }, true);\n            const templateId = this.parent.element.id;\n            const footerTemp = [].slice.call(this.parent.getQuickInfoTemplatesFooter()(footerArgs, this.parent, 'footer', templateId + '_footerTemplate', false));\n            append([].slice.call(footerTemp), footerTemplate);\n        }\n        else {\n            let footer;\n            switch (footerType) {\n                case 'Cell':\n                    footer = `<button class=\"${QUICK_POPUP_EVENT_DETAILS_CLASS + ' ' + TEXT_ELLIPSIS}\" title=` +\n                        `\"${this.l10n.getConstant('moreDetails')}\">${this.l10n.getConstant('moreDetails')}</button>` +\n                        `<button class=\"${EVENT_CREATE_CLASS} ${TEXT_ELLIPSIS}\" title=\"${this.l10n.getConstant('save')}\">` +\n                        `${this.l10n.getConstant('save')}</button>`;\n                    break;\n                case 'Event':\n                    footer = `${this.parent.isAdaptive ? '' : `<button class=\"${EDIT_EVENT_CLASS} ` +\n                        `${TEXT_ELLIPSIS}\" title=\"${this.l10n.getConstant('edit')}\">${this.l10n.getConstant('edit')}</button>` +\n                        `<button class=\"${DELETE_EVENT_CLASS} ${TEXT_ELLIPSIS}\" title=\"${this.l10n.getConstant('delete')}\">` +\n                        `${this.l10n.getConstant('delete')}</button>`}`;\n                    break;\n            }\n            const templateWrapper = createElement('div', { innerHTML: footer });\n            append([].slice.call(templateWrapper.childNodes), footerTemplate);\n        }\n        return footerTemplate;\n    }\n    getResourceText(args, type) {\n        if (this.parent.resourceCollection.length === 0) {\n            return null;\n        }\n        let resourceValue = '';\n        if (this.parent.activeViewOptions.group.resources.length === 0) {\n            const resourceCollection = this.parent.resourceBase.resourceCollection.slice(-1)[0];\n            const resourceData = resourceCollection.dataSource;\n            if (type === 'event') {\n                const eventData = args.event;\n                for (const data of resourceData) {\n                    const resourceId = eventData[resourceCollection.field];\n                    if (resourceId instanceof Array) {\n                        if (resourceId.indexOf(data[resourceCollection.idField]) > -1) {\n                            const id = resourceId[resourceId.indexOf(data[resourceCollection.idField])];\n                            const resource = resourceData.filter((e) => e[resourceCollection.idField] === id)[0];\n                            resourceValue += (resourceValue === '') ? resource[resourceCollection.textField] :\n                                ', ' + resource[resourceCollection.textField];\n                        }\n                    }\n                    else if (data[resourceCollection.idField] === resourceId) {\n                        resourceValue = data[resourceCollection.textField].toString();\n                    }\n                }\n            }\n            else {\n                resourceValue = resourceData[0][resourceCollection.textField].toString();\n            }\n        }\n        else {\n            if (type === 'event') {\n                const eventData = args.event;\n                let resourceData;\n                let lastResource;\n                for (let i = this.parent.resourceBase.resourceCollection.length - 1; i >= 0; i--) {\n                    resourceData = eventData[this.parent.resourceBase.resourceCollection[i].field];\n                    if (!isNullOrUndefined(resourceData)) {\n                        lastResource = this.parent.resourceBase.resourceCollection[i];\n                        break;\n                    }\n                }\n                if (!Array.isArray(resourceData)) {\n                    resourceData = [resourceData];\n                }\n                const resNames = [];\n                const lastResourceData = lastResource.dataSource;\n                resourceData.forEach((value) => {\n                    let text;\n                    const i = findIndexInData(lastResourceData, lastResource.idField, value);\n                    if (i > -1) {\n                        text = lastResourceData[i][lastResource.textField];\n                    }\n                    if (text) {\n                        resNames.push(text);\n                    }\n                });\n                resourceValue = resNames.join(', ');\n            }\n            else {\n                const argsData = args;\n                const groupIndex = !isNullOrUndefined(argsData.groupIndex) ? argsData.groupIndex : 0;\n                const resourceDetails = this.parent.resourceBase.lastResourceLevel[groupIndex];\n                resourceValue = resourceDetails.resourceData[resourceDetails.resource.textField];\n            }\n        }\n        return resourceValue;\n    }\n    getFormattedString(eventData) {\n        const fields = this.parent.eventFields;\n        const eventSubject = (eventData[fields.subject] || this.l10n.getConstant('noTitle'));\n        const startDate = eventData[fields.startTime];\n        const endDate = eventData[fields.endTime];\n        const startDateDetails = this.getDateFormat(startDate, 'long');\n        const endDateDetails = (eventData[fields.isAllDay] && endDate.getHours() === 0 && endDate.getMinutes() === 0) ?\n            this.getDateFormat(addDays(new Date(endDate.getTime()), -1), 'long') :\n            this.getDateFormat(endDate, 'long');\n        const startTimeDetail = this.parent.getTimeString(startDate);\n        const endTimeDetail = this.parent.getTimeString(endDate);\n        let details = '';\n        const spanLength = endDate.getDate() !== startDate.getDate() &&\n            (endDate.getTime() - startDate.getTime()) / (60 * 60 * 1000) < 24 ? 1 : 0;\n        if (eventData[fields.isAllDay]) {\n            details = startDateDetails + ' (' + this.l10n.getConstant('allDay') + ')';\n            if (((getUniversalTime(endDate) - getUniversalTime(startDate)) / MS_PER_DAY) > 1) {\n                details += '&nbsp;-&nbsp;' + endDateDetails + ' (' + this.l10n.getConstant('allDay') + ')';\n            }\n        }\n        else if ((((getUniversalTime(endDate) - getUniversalTime(startDate)) / MS_PER_DAY) >= 1) || spanLength > 0) {\n            details = startDateDetails + ' (' + startTimeDetail + ')' + '&nbsp;-&nbsp;' + endDateDetails + ' (' + endTimeDetail + ')';\n        }\n        else {\n            details = startDateDetails + ' (' + (startTimeDetail + '&nbsp;-&nbsp;' + endTimeDetail) + ')';\n        }\n        return { eventSubject: eventSubject, details: details };\n    }\n    moreEventClick(data, endDate, groupIndex) {\n        this.quickPopupHide(true);\n        const moreEventContentEle = this.morePopup.element.querySelector('.' + MORE_EVENT_CONTENT_CLASS);\n        if (moreEventContentEle) {\n            remove(moreEventContentEle);\n        }\n        const selectedDate = ((data.date).getTime()).toString();\n        const target = closest(data.element, '.' + MORE_INDICATOR_CLASS + ',.' + WORK_CELLS_CLASS);\n        const day = this.parent.globalize.formatDate(data.date, { format: 'E', calendar: this.parent.getCalendarMode() });\n        this.morePopup.element.querySelector('.' + MORE_EVENT_HEADER_DAY_CLASS).innerHTML = capitalizeFirstWord(day, 'single');\n        const dateElement = this.morePopup.element.querySelector('.' + MORE_EVENT_HEADER_DATE_CLASS);\n        dateElement.innerHTML = this.getDateFormat(data.date, 'd');\n        dateElement.setAttribute('data-date', selectedDate);\n        dateElement.setAttribute('data-end-date', endDate.getTime().toString());\n        let groupOrder;\n        if (!isNullOrUndefined(groupIndex)) {\n            dateElement.setAttribute('data-group-index', groupIndex);\n            groupOrder = this.parent.resourceBase.lastResourceLevel[parseInt(groupIndex, 10)].groupOrder;\n        }\n        const moreEventElements = this.createMoreEventList(data.event, groupOrder, groupIndex);\n        this.morePopup.element.querySelector('.' + MORE_EVENT_POPUP_CLASS).appendChild(moreEventElements);\n        removeClass(this.morePopup.element.querySelector('.' + MORE_EVENT_DATE_HEADER_CLASS).childNodes, CURRENTDATE_CLASS);\n        if (resetTime(data.date).getTime() === resetTime(this.parent.getCurrentTime()).getTime()) {\n            addClass(this.morePopup.element.querySelector('.' + MORE_EVENT_DATE_HEADER_CLASS).childNodes, CURRENTDATE_CLASS);\n        }\n        if (!this.parent.isAdaptive) {\n            if (this.parent.currentView.indexOf('Timeline') !== -1) {\n                const gIndex = target.getAttribute('data-group-index');\n                const startDate = new Date(parseInt(target.getAttribute('data-start-date'), 10));\n                startDate.setHours(startDate.getHours(), startDate.getMinutes(), 0);\n                const tdDate = startDate.getTime().toString();\n                if (isNullOrUndefined(gIndex)) {\n                    this.morePopup.relateTo = this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS +\n                        ' tbody tr td[data-date=\"' + tdDate + '\"]');\n                }\n                else {\n                    this.morePopup.relateTo = this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS +\n                        ' tbody tr td[data-group-index=\"' + gIndex + '\"][data-date=\"' + tdDate + '\"]');\n                    if (isNullOrUndefined(this.morePopup.relateTo)) {\n                        const workCells = [].slice.call(this.parent.element.querySelectorAll('.' + CONTENT_WRAP_CLASS +\n                            ' tbody tr td[data-group-index=\"' + gIndex + '\"]'));\n                        for (let i = 0; i < workCells.length; i++) {\n                            const date = workCells[i].getAttribute('data-date');\n                            if (date < tdDate) {\n                                this.morePopup.relateTo = workCells[i];\n                            }\n                        }\n                    }\n                }\n            }\n            else {\n                this.morePopup.relateTo = closest(target, '.' + WORK_CELLS_CLASS);\n            }\n        }\n        this.parent.renderTemplates();\n        const eventProp = {\n            type: 'EventContainer', cancel: false,\n            element: this.morePopup.element, data: data\n        };\n        this.parent.trigger(popupOpen, eventProp, (popupArgs) => {\n            if (!popupArgs.cancel) {\n                this.morePopup.show();\n            }\n        });\n    }\n    saveClick(event) {\n        this.applyFormValidation();\n        this.dialogEvent = event;\n        this.isCrudAction = true;\n        this.quickPopupHide();\n    }\n    detailsClick(event) {\n        const subjectEle = this.quickPopup.element.querySelector('.' + SUBJECT_CLASS);\n        if (subjectEle && subjectEle.value !== '') {\n            extend(this.parent.activeCellsData, { subject: subjectEle.value });\n        }\n        this.dialogEvent = event;\n        this.isCrudAction = false;\n        this.fieldValidator.destroyToolTip();\n        this.quickPopupHide();\n        this.parent.eventWindow.openEditor(this.parent.activeCellsData, 'Add');\n    }\n    editClick(event) {\n        this.dialogEvent = event;\n        this.quickPopupHide(true);\n        const data = this.parent.activeEventData.event;\n        this.parent.currentAction = 'EditSeries';\n        if (!isNullOrUndefined(data[this.parent.eventFields.recurrenceRule])) {\n            this.parent.currentAction = 'EditOccurrence';\n            this.openRecurrenceAlert();\n        }\n        else {\n            this.parent.eventWindow.openEditor(data, this.parent.currentAction);\n        }\n    }\n    deleteClick(event) {\n        this.dialogEvent = event;\n        this.quickPopupHide(true);\n        this.parent.currentAction = 'Delete';\n        if (this.parent.activeEventData.event[this.parent.eventFields.recurrenceRule]) {\n            this.openRecurrenceAlert();\n        }\n        else {\n            this.openDeleteAlert();\n        }\n    }\n    updateMoreEventContent() {\n        if (this.morePopup.element.classList.contains('e-popup-close')) {\n            return;\n        }\n        const moreEventContentEle = this.morePopup.element.querySelector('.' + MORE_EVENT_CONTENT_CLASS);\n        if (moreEventContentEle) {\n            remove(moreEventContentEle);\n        }\n        const dateElement = this.morePopup.element.querySelector('.' + MORE_EVENT_HEADER_DATE_CLASS);\n        const startDate = new Date(parseInt(dateElement.getAttribute('data-date'), 10));\n        const endDate = new Date(parseInt(dateElement.getAttribute('data-end-date'), 10));\n        const groupIndex = dateElement.getAttribute('data-group-index');\n        let data;\n        let groupOrder;\n        if (!isNullOrUndefined(groupIndex)) {\n            data = this.parent.resourceBase.lastResourceLevel[parseInt(groupIndex, 10)];\n            groupOrder = data.groupOrder;\n        }\n        const events = this.parent.eventBase.filterEvents(startDate, endDate, this.parent.eventsProcessed, data);\n        const moreElement = this.createMoreEventList(events, groupOrder, groupIndex);\n        this.morePopup.element.querySelector('.' + MORE_EVENT_POPUP_CLASS).appendChild(moreElement);\n    }\n    closeClick(event) {\n        this.dialogEvent = event;\n        if (this.parent.currentView === 'Year' && this.parent.activeCellsData && this.parent.activeCellsData.element) {\n            this.parent.selectCell(this.parent.activeCellsData.element);\n        }\n        this.quickPopupHide();\n        this.morePopup.hide();\n    }\n    dialogButtonClick(event) {\n        this.dialogEvent = event;\n        this.quickDialog.hide();\n        const target = event.target;\n        const cancelBtn = this.quickDialog.element.querySelector('.' + QUICK_DIALOG_ALERT_CANCEL);\n        const eventData = this.parent.activeEventData.event;\n        if (target.classList.contains(QUICK_DIALOG_OCCURRENCE_CLASS)) {\n            this.parent.currentAction = (this.parent.currentAction === 'Delete') ? 'DeleteOccurrence' : 'EditOccurrence';\n            switch (this.parent.currentAction) {\n                case 'EditOccurrence':\n                    this.parent.eventWindow.openEditor(eventData, this.parent.currentAction);\n                    break;\n                case 'DeleteOccurrence':\n                    this.parent.crudModule.deleteEvent(eventData, this.parent.currentAction);\n                    break;\n            }\n        }\n        else if (target.classList.contains(QUICK_DIALOG_FOLLOWING_EVENTS_CLASS)) {\n            this.parent.currentAction = (this.parent.currentAction === 'Delete') ? 'DeleteFollowingEvents' : 'EditFollowingEvents';\n            switch (this.parent.currentAction) {\n                case 'EditFollowingEvents':\n                    this.parent.eventWindow.openEditor(eventData, this.parent.currentAction);\n                    break;\n                case 'DeleteFollowingEvents':\n                    this.parent.crudModule.deleteEvent(eventData, this.parent.currentAction);\n                    break;\n            }\n        }\n        else if (target.classList.contains(QUICK_DIALOG_SERIES_CLASS)) {\n            this.parent.currentAction = (this.parent.currentAction === 'Delete') ? 'DeleteSeries' : 'EditSeries';\n            switch (this.parent.currentAction) {\n                case 'EditSeries':\n                    this.parent.eventWindow.openEditor(this.parent.eventBase.getParentEvent(eventData, true), this.parent.currentAction);\n                    break;\n                case 'DeleteSeries':\n                    this.parent.crudModule.deleteEvent(eventData, this.parent.currentAction);\n                    break;\n            }\n        }\n        else if (target.classList.contains(QUICK_DIALOG_DELETE_CLASS)) {\n            this.parent.crudModule.deleteEvent(eventData, this.parent.currentAction);\n        }\n        else if (!cancelBtn.classList.contains(DISABLE_CLASS) && (target.classList.contains(QUICK_DIALOG_ALERT_OK) ||\n            (target.classList.contains(QUICK_DIALOG_ALERT_CANCEL) && !cancelBtn.classList.contains(QUICK_DIALOG_CANCEL_CLASS)))) {\n            this.parent.uiStateValues.isIgnoreOccurrence = target.classList.contains(QUICK_DIALOG_ALERT_CANCEL);\n            this.parent.eventWindow.eventSave(event, this.l10n.getConstant('ok'));\n        }\n    }\n    updateTapHoldEventPopup(target) {\n        const selectedElements = this.parent.eventBase.getSelectedEventElements(target);\n        this.parent.activeEventData = this.parent.eventBase.getSelectedEvents();\n        if (selectedElements.length > 0) {\n            const eventObj = this.parent.eventBase.getEventByGuid(selectedElements[0].getAttribute('data-guid'));\n            const titleContent = (selectedElements.length === 1) ?\n                (eventObj[this.parent.eventFields.subject] || this.l10n.getConstant('noTitle')) :\n                '(' + selectedElements.length + ')' + '&nbsp;' + this.l10n.getConstant('selectedItems');\n            this.quickPopup.element.querySelector('.' + SUBJECT_CLASS).innerHTML = titleContent;\n            if (selectedElements.length > 1) {\n                addClass([this.quickPopup.element.querySelector('.' + EDIT_ICON_CLASS)], HIDDEN_CLASS);\n            }\n            else {\n                removeClass([this.quickPopup.element.querySelector('.' + EDIT_ICON_CLASS)], HIDDEN_CLASS);\n            }\n        }\n        else {\n            this.parent.selectedElements = [];\n            this.quickPopupHide();\n        }\n    }\n    getTimezone(event) {\n        let zoneDetails = '';\n        zoneDetails += event[this.parent.eventFields.startTimezone] || '';\n        zoneDetails += zoneDetails === '' ? '' : ' - ';\n        zoneDetails += event[this.parent.eventFields.endTimezone] || '';\n        return zoneDetails;\n    }\n    getRecurrenceSummary(event) {\n        const recurrenceEditor = this.parent.eventWindow.getRecurrenceEditorInstance();\n        if (recurrenceEditor) {\n            const ruleSummary = recurrenceEditor.getRuleSummary(event[this.parent.eventFields.recurrenceRule]);\n            return ruleSummary.charAt(0).toUpperCase() + ruleSummary.slice(1);\n        }\n        return '';\n    }\n    getDateFormat(date, skeletonString) {\n        return capitalizeFirstWord(this.parent.globalize.formatDate(date, { skeleton: skeletonString, calendar: this.parent.getCalendarMode() }), 'single');\n    }\n    getDataFromTarget(target) {\n        if (target.classList.contains(APPOINTMENT_CLASS)) {\n            return this.parent.activeEventData.event;\n        }\n        // Deprecated cells data in quick popups\n        const eventObj = {\n            startTime: this.parent.activeCellsData.startTime,\n            endTime: this.parent.activeCellsData.endTime,\n            isAllDay: this.parent.activeCellsData.isAllDay,\n            groupIndex: this.parent.activeCellsData.groupIndex\n        };\n        const cellsData = this.parent.activeCellsData;\n        this.parent.eventWindow.convertToEventData(cellsData, eventObj);\n        return eventObj;\n    }\n    beforeQuickDialogClose(e) {\n        const args = {\n            event: e.event || this.dialogEvent,\n            type: (isNullOrUndefined(this.parent.activeEventData.event)) ? 'ValidationAlert' :\n                !isNullOrUndefined(this.parent.activeEventData.event[this.parent.eventFields.recurrenceRule])\n                    ? 'RecurrenceAlert' : 'DeleteAlert', cancel: false, data: this.parent.activeEventData.event,\n            element: this.quickDialog.element\n        };\n        this.parent.trigger(popupClose, args, (popupCloseArgs) => {\n            if (!popupCloseArgs.cancel) {\n                this.parent.eventBase.focusElement(true);\n            }\n        });\n    }\n    beforeQuickPopupOpen(target) {\n        this.parent.renderTemplates();\n        const isEventPopup = this.quickPopup.element.querySelector('.' + EVENT_POPUP_CLASS);\n        const popupType = this.parent.isAdaptive ? isEventPopup ? 'ViewEventInfo' : 'EditEventInfo' : 'QuickInfo';\n        const eventProp = {\n            type: popupType, cancel: false, data: extend({}, this.getDataFromTarget(target), null, true),\n            target: target, element: this.quickPopup.element\n        };\n        this.parent.trigger(popupOpen, eventProp, (popupArgs) => {\n            if (popupArgs.cancel) {\n                this.quickPopupHide();\n                this.destroyPopupButtons('quickPopup');\n                if (popupArgs.element.classList.contains(POPUP_OPEN)) {\n                    this.quickPopupClose();\n                }\n                removeChildren(this.quickPopup.element);\n                this.isMultipleEventSelect = false;\n            }\n            else {\n                const display = this.quickPopup.element.style.display;\n                this.quickPopup.element.style.display = 'block';\n                if (this.parent.isAdaptive) {\n                    this.quickPopup.element.removeAttribute('style');\n                    this.quickPopup.element.style.display = 'block';\n                    this.quickPopup.element.style.height = formatUnit((popupType === 'EditEventInfo') ? 65 : window.innerHeight);\n                }\n                else {\n                    this.quickPopup.offsetX = 10;\n                    this.quickPopup.collision = { X: this.parent.enableRtl ? 'flip' : 'none', Y: 'fit' };\n                    this.quickPopup.position = { X: this.parent.enableRtl ? 'left' : 'right', Y: this.parent.enableRtl ? 'bottom' : 'top' };\n                    this.quickPopup.dataBind();\n                    this.quickPopup.refreshPosition(null, true);\n                    const collide = isCollide(this.quickPopup.element, this.parent.element);\n                    if (collide.indexOf(this.parent.enableRtl ? 'left' : 'right') > -1) {\n                        this.quickPopup.offsetX = -target.offsetWidth - 10 - this.quickPopup.element.offsetWidth;\n                        this.quickPopup.dataBind();\n                        const leftCollide = isCollide(this.quickPopup.element, this.parent.element);\n                        if (leftCollide.indexOf('left') > -1) {\n                            this.quickPopup.position = { X: 'center', Y: 'center' };\n                            this.quickPopup.collision = { X: 'fit', Y: 'fit' };\n                            this.quickPopup.offsetX = -(this.quickPopup.element.offsetWidth / 2);\n                            this.quickPopup.dataBind();\n                        }\n                    }\n                    if (this.parent.virtualScrollModule && (collide.indexOf('top') > -1 || collide.indexOf('bottom') > -1)) {\n                        const element = this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS + ' table');\n                        const translateY = getTranslateY(element);\n                        this.quickPopup.offsetY = translateY;\n                        this.quickPopup.dataBind();\n                    }\n                }\n                if (isEventPopup) {\n                    this.applyEventColor();\n                }\n                this.quickPopup.element.style.display = display;\n                this.quickPopup.dataBind();\n                this.quickPopup.show();\n            }\n        });\n    }\n    applyEventColor() {\n        let colorField = '';\n        if (this.parent.currentView === 'Agenda' || this.parent.currentView === 'MonthAgenda') {\n            colorField = this.parent.enableRtl ? 'border-right-color' : 'border-left-color';\n        }\n        else {\n            colorField = 'background-color';\n        }\n        let color = this.parent.activeEventData.element.style[colorField];\n        if (color === '') {\n            return;\n        }\n        let colorEle = this.quickPopup.element.querySelector('.' + POPUP_HEADER_CLASS);\n        const footerEle = this.quickPopup.element.querySelector('.' + POPUP_FOOTER_CLASS);\n        if (footerEle && footerEle.offsetParent) {\n            colorEle = this.quickPopup.element.querySelector('.' + SUBJECT_CLASS);\n            if (colorEle) {\n                colorEle.style.borderLeftColor = color;\n                color = `rgba(${color.match(/\\d+/g).join()},0.3)`;\n            }\n        }\n        if (colorEle) {\n            colorEle.style.backgroundColor = color;\n        }\n    }\n    quickPopupOpen() {\n        if (this.parent.isAdaptive) {\n            this.quickPopup.element.style.top = '0px';\n            return;\n        }\n        if (this.quickPopup.element.querySelector('.' + CELL_POPUP_CLASS)) {\n            const subjectElement = this.quickPopup.element.querySelector('.' + SUBJECT_CLASS);\n            if (subjectElement) {\n                subjectElement.focus();\n            }\n        }\n        else {\n            const editElement = this.quickPopup.element.querySelector('.' + EDIT_EVENT_CLASS);\n            if (editElement) {\n                editElement.focus();\n            }\n            const editIcon = this.quickPopup.element.querySelector('.' + EDIT_CLASS);\n            if (editIcon) {\n                editIcon.focus();\n            }\n        }\n    }\n    quickPopupClose() {\n        this.parent.eventBase.focusElement();\n        this.quickPopup.relateTo = WORK_CELLS_CLASS;\n        this.fieldValidator.destroyToolTip();\n        if (this.quickPopup.element.querySelectorAll('.e-formvalidator').length) {\n            this.fieldValidator.destroy();\n        }\n        this.destroyPopupButtons('quickPopup');\n        removeChildren(this.quickPopup.element);\n    }\n    morePopupOpen() {\n        if (this.parent.isAdaptive) {\n            this.morePopup.element.style.top = '0px';\n            this.morePopup.element.style.left = '0px';\n            this.morePopup.element.style.height = formatUnit(window.innerHeight);\n            return;\n        }\n        this.morePopup.element.querySelector('.' + MORE_EVENT_HEADER_DATE_CLASS).focus();\n        this.morePopup.refreshPosition();\n    }\n    morePopupClose() {\n        const moreWrapper = this.parent.element.querySelector('.' + MORE_EVENT_WRAPPER_CLASS);\n        if (moreWrapper) {\n            remove(moreWrapper);\n        }\n    }\n    popupClose(event) {\n        this.dialogEvent = event;\n        this.isCrudAction = false;\n        this.quickPopupHide(true);\n    }\n    quickPopupHide(hideAnimation) {\n        if (!this.quickPopup.element.classList.contains(POPUP_OPEN)) {\n            return;\n        }\n        const isCellPopup = this.quickPopup.element.querySelector('.' + CELL_POPUP_CLASS);\n        let popupData;\n        if (isCellPopup) {\n            const formvalidator = this.quickPopup.element.querySelector('.e-formvalidator');\n            if (this.isCrudAction && formvalidator &&\n                !formvalidator.ej2_instances[0].validate()) {\n                return;\n            }\n            const fields = this.parent.eventFields;\n            const saveObj = this.parent.eventWindow.getObjectFromFormData(POPUP_WRAPPER_CLASS);\n            this.parent.eventWindow.setDefaultValueToObject(saveObj);\n            saveObj[fields.id] = this.parent.eventBase.getEventMaxID();\n            saveObj[fields.startTime] = this.parent.activeCellsData.startTime;\n            saveObj[fields.endTime] = this.parent.activeCellsData.endTime;\n            saveObj[fields.isAllDay] = this.parent.activeCellsData.isAllDay;\n            if (this.parent.resourceBase) {\n                this.parent.resourceBase.setResourceValues(saveObj);\n            }\n            popupData = saveObj;\n        }\n        else {\n            popupData = this.parent.activeEventData.event;\n        }\n        const isEventPopup = this.quickPopup.element.querySelector('.' + EVENT_POPUP_CLASS);\n        const args = {\n            event: this.dialogEvent,\n            type: this.parent.isAdaptive ? isEventPopup ? 'ViewEventInfo' : 'EditEventInfo' : 'QuickInfo',\n            cancel: false, data: popupData, element: this.quickPopup.element,\n            target: (isCellPopup ? this.parent.activeCellsData.element : this.parent.activeEventData.element)\n        };\n        this.parent.trigger(popupClose, args, (popupCloseArgs) => {\n            if (!popupCloseArgs.cancel) {\n                if (this.quickPopup.element.classList.contains('e-popup-open')) {\n                    if (isCellPopup && this.isCrudAction) {\n                        this.parent.currentAction = 'Add';\n                        this.parent.crudModule.addEvent(popupCloseArgs.data);\n                    }\n                    if (hideAnimation) {\n                        const animation = this.quickPopup.hideAnimation;\n                        this.quickPopup.hideAnimation = null;\n                        this.quickPopup.hide();\n                        this.quickPopup.hideAnimation = animation;\n                    }\n                    else {\n                        this.quickPopup.hide();\n                    }\n                    this.isMultipleEventSelect = false;\n                    this.isCrudAction = false;\n                }\n            }\n        });\n    }\n    navigationClick(e) {\n        const navigateEle = closest(e.target, '.' + NAVIGATE_CLASS);\n        if (!isNullOrUndefined(navigateEle)) {\n            const date = this.parent.getDateFromElement(e.currentTarget);\n            if (!isNullOrUndefined(date)) {\n                this.closeClick(e);\n                this.parent.setProperties({ selectedDate: date }, true);\n                this.parent.changeView(this.parent.getNavigateView(), e);\n            }\n        }\n    }\n    documentClick(e) {\n        const target = e.event.target;\n        const classNames = '.' + POPUP_WRAPPER_CLASS + ',.' + HEADER_CELLS_CLASS + ',.' + ALLDAY_CELLS_CLASS +\n            ',.' + WORK_CELLS_CLASS + ',.' + APPOINTMENT_CLASS + ',.e-popup';\n        const popupWrap = this.parent.element.querySelector('.' + POPUP_WRAPPER_CLASS);\n        if ((popupWrap && popupWrap.childElementCount > 0 && !closest(target, classNames)) || !closest(target, classNames)) {\n            this.quickPopupHide();\n            this.parent.removeNewEventElement();\n        }\n        const tar = this.parent.element.querySelector('.' + INLINE_SUBJECT_CLASS);\n        if (tar && tar !== target && this.parent.allowInline) {\n            this.parent.inlineModule.documentClick();\n        }\n        if (closest(target, '.' + APPOINTMENT_CLASS + ',.' + HEADER_CELLS_CLASS)) {\n            this.parent.removeNewEventElement();\n        }\n        if (!closest(target, '.' + MORE_POPUP_WRAPPER_CLASS) && (target.classList &&\n            !target.classList.contains(MORE_INDICATOR_CLASS))\n            && (!closest(target, '.' + POPUP_OPEN)) && !closest(target, '.' + WORK_CELLS_CLASS)) {\n            this.morePopup.hide();\n        }\n    }\n    onClosePopup(event) {\n        if (!isNullOrUndefined(event)) {\n            this.dialogEvent = event;\n        }\n        this.quickPopupHide();\n        this.parent.eventBase.focusElement();\n    }\n    addEventListener() {\n        this.parent.on(cellClick, this.cellClick, this);\n        this.parent.on(eventClick, this.eventClick, this);\n        this.parent.on(documentClick, this.documentClick, this);\n        this.parent.on(dataReady, this.updateMoreEventContent, this);\n    }\n    removeEventListener() {\n        this.parent.off(cellClick, this.cellClick);\n        this.parent.off(eventClick, this.eventClick);\n        this.parent.off(documentClick, this.documentClick);\n        this.parent.off(dataReady, this.updateMoreEventContent);\n    }\n    destroyPopupButtons(popupName) {\n        const popup = popupName === 'quickPopup' ? this.quickPopup : this.morePopup;\n        const buttonCollections = [].slice.call(popup.element.querySelectorAll('.e-control.e-btn'));\n        for (const button of buttonCollections) {\n            const instance = button.ej2_instances[0];\n            if (instance) {\n                instance.destroy();\n            }\n        }\n    }\n    refreshQuickDialog() {\n        this.destroyQuickDialog();\n        this.renderQuickDialog();\n    }\n    refreshQuickPopup() {\n        this.destroyQuickPopup();\n        this.renderQuickPopup();\n    }\n    refreshMorePopup() {\n        this.destroyMorePopup();\n        this.renderMorePopup();\n    }\n    destroyQuickDialog() {\n        if (this.quickDialog.element) {\n            this.quickDialog.destroy();\n            remove(this.quickDialog.element);\n            this.quickDialog = null;\n        }\n    }\n    destroyQuickPopup() {\n        if (this.quickPopup.element) {\n            this.destroyPopupButtons('quickPopup');\n            this.quickPopup.destroy();\n            remove(this.quickPopup.element);\n            this.quickPopup = null;\n        }\n    }\n    destroyMorePopup() {\n        if (this.morePopup.element) {\n            this.destroyPopupButtons('morePopup');\n            this.morePopup.destroy();\n            remove(this.morePopup.element);\n            this.morePopup = null;\n        }\n    }\n    destroy() {\n        if (this.quickPopup.element.querySelectorAll('.e-formvalidator').length) {\n            this.fieldValidator.destroy();\n        }\n        this.removeEventListener();\n        this.destroyQuickPopup();\n        this.destroyMorePopup();\n        this.destroyQuickDialog();\n        this.parent = null;\n        this.l10n = null;\n        this.isCrudAction = null;\n        this.fieldValidator = null;\n        this.isMultipleEventSelect = null;\n    }\n}\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\n/**\n * Tooltip for Schedule\n */\nclass EventTooltip {\n    constructor(parent) {\n        this.parent = parent;\n        this.tooltipObj = new Tooltip({\n            animation: { close: { effect: 'FadeOut' } },\n            content: 'No title',\n            position: 'BottomRight',\n            offsetY: 10,\n            mouseTrail: this.parent.isAdaptive ? false : true,\n            showTipPointer: false,\n            cssClass: this.parent.cssClass + ' ' + EVENT_TOOLTIP_ROOT_CLASS,\n            target: this.getTargets(),\n            beforeRender: this.onBeforeRender.bind(this),\n            beforeClose: this.onBeforeClose.bind(this),\n            enableRtl: this.parent.enableRtl\n        });\n        this.tooltipObj.appendTo(this.parent.element);\n    }\n    getTargets() {\n        const targets = [];\n        if (this.parent.activeViewOptions.group.headerTooltipTemplate) {\n            targets.push('.' + RESOURCE_CELLS_CLASS);\n        }\n        if (this.parent.eventSettings.enableTooltip) {\n            targets.push('.' + APPOINTMENT_CLASS);\n        }\n        return targets.join(',');\n    }\n    onBeforeRender(args) {\n        if (!isNullOrUndefined(args.target.getAttribute('data-tooltip-id'))) {\n            return;\n        }\n        if (args.target.classList.contains(RESOURCE_CELLS_CLASS) && this.parent.activeViewOptions.group.resources.length > 0) {\n            let resCollection;\n            if (this.parent.activeView.isTimelineView()) {\n                const index = parseInt(args.target.getAttribute('data-group-index'), 10);\n                resCollection = this.parent.resourceBase.lastResourceLevel[index];\n            }\n            else {\n                const rowIndex = args.target.parentNode.sectionRowIndex;\n                const cellIndex = args.target.cellIndex;\n                resCollection = this.parent.activeView.getColumnLevels()[rowIndex][cellIndex];\n            }\n            const data = {\n                resource: resCollection.resource,\n                resourceData: resCollection.resourceData\n            };\n            const contentContainer = createElement('div');\n            const templateId = this.parent.element.id + '_headerTooltipTemplate';\n            const tooltipTemplate = [].slice.call(this.parent.getHeaderTooltipTemplate()(data, this.parent, 'headerTooltipTemplate', templateId, false));\n            append(tooltipTemplate, contentContainer);\n            this.setContent(contentContainer);\n            this.parent.renderTemplates();\n            return;\n        }\n        const record = this.parent.eventBase.getEventByGuid(args.target.getAttribute('data-guid'));\n        if (isNullOrUndefined(record)) {\n            return;\n        }\n        if (!isNullOrUndefined(this.parent.eventSettings.tooltipTemplate)) {\n            const contentContainer = createElement('div');\n            const templateId = this.parent.element.id + '_tooltipTemplate';\n            const tooltipTemplate = [].slice.call(this.parent.getEventTooltipTemplate()(record, this.parent, 'tooltipTemplate', templateId, false));\n            append(tooltipTemplate, contentContainer);\n            this.setContent(contentContainer);\n        }\n        else {\n            const globalize = this.parent.globalize;\n            const fields = this.parent.eventFields;\n            const eventStart = new Date('' + record[fields.startTime]);\n            let eventEnd = new Date('' + record[fields.endTime]);\n            eventEnd = (eventEnd.getHours() === 0 && eventEnd.getMinutes() === 0) ? new Date(eventEnd.setMilliseconds(-1000)) : eventEnd;\n            const startDate = resetTime(new Date('' + eventStart));\n            const endDate = resetTime(new Date('' + eventEnd));\n            const tooltipSubject = (record[fields.subject] || this.parent.eventSettings.fields.subject.default\n                || this.parent.localeObj.getConstant('addTitle'));\n            const tooltipLocation = !isNullOrUndefined(record[fields.location]) ? record[fields.location] : '';\n            let startMonthDate = '';\n            let startMonthYearDate = '';\n            let endMonthYearDate = '';\n            startMonthDate = globalize.formatDate(eventStart, {\n                type: 'date', skeleton: 'MMMd', calendar: this.parent.getCalendarMode()\n            });\n            startMonthYearDate = globalize.formatDate(eventStart, {\n                type: 'date', skeleton: 'medium', calendar: this.parent.getCalendarMode()\n            });\n            endMonthYearDate = globalize.formatDate(eventEnd, {\n                type: 'date', skeleton: 'medium', calendar: this.parent.getCalendarMode()\n            });\n            startMonthDate = capitalizeFirstWord(startMonthDate, 'single');\n            startMonthYearDate = capitalizeFirstWord(startMonthYearDate, 'single');\n            endMonthYearDate = capitalizeFirstWord(endMonthYearDate, 'single');\n            const skeleton = 'short';\n            const startTime = globalize.formatDate(eventStart, {\n                type: 'time', skeleton: skeleton, calendar: this.parent.getCalendarMode()\n            });\n            const endTime = globalize.formatDate(eventEnd, {\n                type: 'time', skeleton: skeleton, calendar: this.parent.getCalendarMode()\n            });\n            let tooltipDetails;\n            if (startDate.getTime() === endDate.getTime()) {\n                tooltipDetails =\n                    globalize.formatDate(eventStart, {\n                        type: 'date', skeleton: 'long', calendar: this.parent.getCalendarMode()\n                    });\n                tooltipDetails = capitalizeFirstWord(tooltipDetails, 'single');\n            }\n            else {\n                tooltipDetails = (startDate.getFullYear() === endDate.getFullYear()) ? (startMonthDate + ' - ' + endMonthYearDate) :\n                    (startMonthYearDate + ' - ' + endMonthYearDate);\n            }\n            const tooltipTime = (record[fields.isAllDay]) ? this.parent.localeObj.getConstant('allDay') :\n                (startTime + ' - ' + endTime);\n            const content = '<div><div class=\"e-subject\">' + tooltipSubject + '</div>' +\n                '<div class=\"e-location\">' + tooltipLocation + '</div>' +\n                '<div class=\"e-details\">' + tooltipDetails + '</div>' +\n                '<div class=\"e-all-day\">' + tooltipTime + '</div></div>';\n            this.setContent(content);\n        }\n        this.parent.renderTemplates();\n    }\n    onBeforeClose() {\n        this.parent.resetTemplates(['tooltipTemplate', 'headerTooltipTemplate']);\n    }\n    setContent(content) {\n        this.tooltipObj.setProperties({ content: content }, true);\n    }\n    close() {\n        this.tooltipObj.close();\n    }\n    destroy() {\n        this.tooltipObj.destroy();\n        addClass([this.parent.element], 'e-control');\n        this.tooltipObj = null;\n        this.parent = null;\n    }\n}\n\nvar __decorate$1 = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nconst HEADER = 'e-editor';\nconst INPUTWARAPPER = 'e-input-wrapper';\nconst INPUTWARAPPERSIDE = 'e-input-wrapper-side';\nconst REPEATELEMENT = 'e-repeat-element';\nconst REPEATINTERVAL = 'e-repeat-interval';\nconst INTERVALCLASS = 'e-interval';\nconst DAYWRAPPER = 'e-days';\nconst WEEKWRAPPER = 'e-non-week';\nconst WEEKPOSITION = 'e-week-position';\nconst DAYPOSITION = 'e-day-position';\nconst YEAREXPANDERWRAPPER = 'e-year-expander';\nconst YEAREXPANDERELEMENT = 'e-year-expander-element';\nconst MONETHEXPANDERWRAPPER = 'e-month-expander';\nconst MONETHEXPANDWRAPPER = 'e-month-expand-wrapper';\nconst MONTHEXPANDERELEMENT = 'e-month-expander-element';\nconst MONTHEXPANDERCHECKBOXWRAPPER = 'e-month-expander-checkbox-wrapper';\nconst FORMLEFT = 'e-form-left';\nconst FORMRIGHT = 'e-form-right';\nconst MONTHDAYWRAPPER = 'e-month-day';\nconst MONTHEXPANNDERELEM = 'e-month-expander-wrapper';\nconst MONTHPOS = 'e-month-pos';\nconst MONTHWEEK = 'e-month-week';\nconst ENDON = 'e-end-on';\nconst MONTHEXPANDERLABEL = 'e-month-expander-label';\nconst WEEKEXPANDERLABEL = 'e-week-expander-label';\nconst ENDONLABEL = 'e-end-on-label';\nconst ENDONLEFT = 'e-end-on-left';\nconst MONTHDAYELEMENT = 'e-monthday-element';\nconst ENDONELEMENT = 'e-end-on-element';\nconst ENDONDATE = 'e-end-on-date';\nconst UNTILDATE = 'e-until-date';\nconst ENDONCOUNTWRAPPER = 'e-end-on-count';\nconst ENDONCOUNT = 'e-recurrence-count';\nconst HIDEWRAPPER = 'e-hide-recurrence-element';\nconst RTLCLASS = 'e-rtl';\nconst PRIMARY = 'e-primary';\nconst ACTIVE = 'e-active';\nconst RECURRENCETABLE = 'e-recurrence-table';\nconst REPEATCONTENT = 'e-repeat-content';\nconst REPEATCONTENTWRAPPER = 'e-repeat-content-wrapper';\nconst NONE = 'none';\nconst DAILY = 'daily';\nconst WEEKLY = 'weekly';\nconst MONTHLY = 'monthly';\nconst YEARLY = 'yearly';\nconst NEVER = 'never';\nconst UNTIL$1 = 'until';\nconst COUNT = 'count';\nconst TEXTFIELD = 'text';\nconst VALUEFIELD = 'value';\nconst LAST = 'last';\nconst REPEAT = 'repeat';\nconst REPEATEVERY = 'repeatEvery';\nconst ON$1 = 'on';\nconst END = 'end';\nconst RADIOLABEL = 'onDay';\nconst RULEUNTIL = 'UNTIL';\nconst RULEBYDAY = 'BYDAY';\nconst RULEBYMONTHDAY = 'BYMONTHDAY';\nconst RULEBYMONTH = 'BYMONTH';\nconst RULEINTERVAL = 'INTERVAL';\nconst RULECOUNT = 'COUNT';\nconst RULESETPOS = 'BYSETPOS';\nconst RULEFREQ = 'FREQ';\nconst RULEDAILY = 'DAILY';\nconst RULEWEEKLY = 'WEEKLY';\nconst RULEMONTHLY = 'MONTHLY';\nconst RULEYEARLY = 'YEARLY';\nconst RULESUNDAY = 'SU';\nconst RULEMONDAY = 'MO';\nconst RULETUESDAY = 'TU';\nconst RULEWEDNESDAY = 'WE';\nconst RULETHURSDAY = 'TH';\nconst RULEFRIDAY = 'FR';\nconst RULESATURDAY = 'SA';\nconst KEYSUNDAY = 'sun';\nconst KEYMONDAY = 'mon';\nconst KEYTUESDAY = 'tue';\nconst KEYWEDNESDAY = 'wed';\nconst KEYTHURSDAY = 'thu';\nconst KEYFRIDAY = 'fri';\nconst KEYSATURDAY = 'sat';\nconst EQUAL = '=';\nconst SEMICOLON = ';';\nconst COMMA = ',';\nconst FIRST = 'first';\nconst SECOND = 'second';\nconst THIRD = 'third';\nconst FOURTH = 'fourth';\nconst contentType = {\n    none: '',\n    daily: 'days',\n    weekly: 'weeks',\n    monthly: 'months',\n    yearly: 'years'\n};\nconst valueData = {\n    'sun': RULESUNDAY,\n    'mon': RULEMONDAY,\n    'tue': RULETUESDAY,\n    'wed': RULEWEDNESDAY,\n    'thu': RULETHURSDAY,\n    'fri': RULEFRIDAY,\n    'sat': RULESATURDAY\n};\nconst neverClassList = [DAYWRAPPER, WEEKWRAPPER, ENDON, INTERVALCLASS, YEAREXPANDERWRAPPER, MONETHEXPANDERWRAPPER];\nconst weekClassList = [WEEKWRAPPER];\nconst monthClassList = [DAYWRAPPER, YEAREXPANDERWRAPPER];\nconst yearClassList = [DAYWRAPPER];\nconst dailyClassList = [DAYWRAPPER, WEEKWRAPPER, YEAREXPANDERWRAPPER, MONETHEXPANDERWRAPPER];\nconst noEndClassList = [ENDONDATE, ENDONCOUNTWRAPPER];\nconst endOnCountClassList = [ENDONDATE];\nconst endOnDateClassList = [ENDONCOUNTWRAPPER];\n/**\n * Represents the RecurrenceEditor component.\n * ```html\n * <div id=\"recurrence\"></div>\n * ```\n * ```typescript\n * <script>\n *   var recObj = new RecurrenceEditor();\n *   recObj.appendTo(\"#recurrence\");\n * </script>\n * ```\n */\nlet RecurrenceEditor = class RecurrenceEditor extends Component {\n    /**\n     * Constructor for creating the widget\n     *\n     * @param {RecurrenceEditorModel} options Accepts the recurrence editor model properties to initiate the rendering\n     * @param {string | HTMLElement} element Accepts the DOM element reference\n     */\n    constructor(options, element) {\n        super(options, element);\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        this.defaultLocale = {\n            none: 'None',\n            daily: 'Daily',\n            weekly: 'Weekly',\n            monthly: 'Monthly',\n            month: 'Month',\n            yearly: 'Yearly',\n            never: 'Never',\n            until: 'Until',\n            count: 'Count',\n            first: 'First',\n            second: 'Second',\n            third: 'Third',\n            fourth: 'Fourth',\n            last: 'Last',\n            repeat: 'Repeat',\n            repeatEvery: 'Repeat every',\n            on: 'Repeat On',\n            end: 'End',\n            onDay: 'Day',\n            days: 'Day(s)',\n            weeks: 'Week(s)',\n            months: 'Month(s)',\n            years: 'Year(s)',\n            every: 'every',\n            summaryTimes: 'time(s)',\n            summaryOn: 'on',\n            summaryUntil: 'until',\n            summaryRepeat: 'Repeats',\n            summaryDay: 'day(s)',\n            summaryWeek: 'week(s)',\n            summaryMonth: 'month(s)',\n            summaryYear: 'year(s)',\n            monthWeek: 'Month Week',\n            monthPosition: 'Month Position',\n            monthExpander: 'Month Expander',\n            yearExpander: 'Year Expander',\n            repeatInterval: 'Repeat Interval'\n        };\n        this.renderStatus = false;\n        this.dayButtons = [];\n        this.monthButtons = [];\n    }\n    startState(freq, endOn, startDate) {\n        this.showFormElement();\n        this.updateForm(freq);\n        this.freshOnEndForm();\n        this.updateEndOnForm(endOn);\n        this.selectMonthDay(startDate);\n        this.updateUntilDate(startDate);\n        this.onMonthDay.setProperties({ checked: true });\n    }\n    preRender() {\n        this.localeObj = new L10n(this.getModuleName(), this.defaultLocale, this.locale);\n        this.calendarUtil = getCalendarUtil(this.calendarMode);\n    }\n    applyCustomClass(cssClass) {\n        if (cssClass) {\n            addClass([this.element], cssClass.split(' '));\n        }\n    }\n    initialize() {\n        addClass([this.element], 'e-' + this.getModuleName());\n        this.renderComponent();\n        if (!isNullOrUndefined(this.value) && this.value !== '') {\n            this.setRecurrenceRule(this.value);\n        }\n        else {\n            if (!isNullOrUndefined(this.repeatType.value)) {\n                this.startState(this.repeatType.value.toString().toUpperCase(), NEVER, this.startDate);\n                this.updateForm(this.repeatType.value.toString());\n            }\n            if (this.selectedType > 0) {\n                this.setProperties({ value: this.getRecurrenceRule() }, false);\n            }\n        }\n        this.applyCustomClass(this.cssClass);\n    }\n    triggerChangeEvent() {\n        if (this.renderStatus) {\n            const value = this.getRecurrenceRule();\n            this.trigger('change', { value: value }, (args) => this.setProperties({ value: args.value }, false));\n        }\n    }\n    resetDayButton() {\n        const elements = [].slice.call(this.element.querySelectorAll('.' + DAYWRAPPER + ' button'));\n        elements.forEach((element) => removeClass([element], [ACTIVE, PRIMARY]));\n    }\n    daySelection(dayIndex) {\n        this.resetDayButton();\n        const days = [0, 1, 2, 3, 4, 5, 6];\n        this.rotateArray(days, this.firstDayOfWeek);\n        const element = this.element.querySelector('.' + DAYWRAPPER + ' button[data-index=\"' + days.indexOf(dayIndex) + '\"]');\n        if (element) {\n            addClass([element], [ACTIVE, PRIMARY]);\n        }\n    }\n    rtlClass(status) {\n        if (status) {\n            addClass([this.element], RTLCLASS);\n        }\n        else {\n            removeClass([this.element], RTLCLASS);\n        }\n    }\n    updateUntilDate(date) {\n        const tempDate = new Date(date.getTime());\n        tempDate.setDate(tempDate.getDate() + 60);\n        this.untilDateObj.setProperties({ value: tempDate });\n    }\n    selectMonthDay(date) {\n        const weekday = [KEYSUNDAY, KEYMONDAY, KEYTUESDAY, KEYWEDNESDAY, KEYTHURSDAY, KEYFRIDAY, KEYSATURDAY];\n        this.monthDate.setProperties({ value: this.calendarUtil.getDate(date) });\n        this.monthWeekDays.setProperties({ value: valueData[weekday[date.getDay()]] });\n        this.monthValue.setProperties({ value: '' + this.calendarUtil.getMonth(date) });\n        this.monthWeekPos.setProperties({ value: this.getDayPosition(date) });\n        this.daySelection(date.getDay());\n    }\n    updateForm(state) {\n        this.repeatType.setProperties({ value: state });\n        const end = this.element.querySelector('.' + ENDON);\n        if (state === DAILY) {\n            classList(end, [FORMLEFT], [FORMRIGHT]);\n        }\n        else {\n            classList(end, [FORMRIGHT], [FORMLEFT]);\n        }\n        switch (state) {\n            case NONE:\n                neverClassList.forEach((className) => addClass([this.element.querySelector('.' + className)], HIDEWRAPPER));\n                break;\n            case WEEKLY:\n                weekClassList.forEach((className) => addClass([this.element.querySelector('.' + className)], HIDEWRAPPER));\n                break;\n            case MONTHLY:\n                monthClassList.forEach((className) => addClass([this.element.querySelector('.' + className)], HIDEWRAPPER));\n                break;\n            case YEARLY:\n                yearClassList.forEach((className) => addClass([this.element.querySelector('.' + className)], HIDEWRAPPER));\n                break;\n            case DAILY:\n                dailyClassList.forEach((className) => addClass([this.element.querySelector('.' + className)], HIDEWRAPPER));\n                break;\n        }\n    }\n    updateEndOnForm(state) {\n        this.endType.setProperties({ value: state });\n        switch (state) {\n            case NEVER:\n                noEndClassList.forEach((className) => addClass([this.element.querySelector('.' + className)], HIDEWRAPPER));\n                break;\n            case UNTIL$1:\n                endOnDateClassList.forEach((className) => addClass([this.element.querySelector('.' + className)], HIDEWRAPPER));\n                break;\n            case COUNT:\n                endOnCountClassList.forEach((className) => addClass([this.element.querySelector('.' + className)], HIDEWRAPPER));\n                break;\n        }\n    }\n    freshOnEndForm() {\n        noEndClassList.forEach((className) => {\n            const element = this.element.querySelector('.' + className);\n            if (element) {\n                removeClass([element], HIDEWRAPPER);\n            }\n        });\n    }\n    showFormElement() {\n        neverClassList.forEach((className) => {\n            const hideElement = this.element.querySelector('.' + className);\n            if (hideElement) {\n                removeClass([hideElement], HIDEWRAPPER);\n            }\n        });\n    }\n    renderDropdowns() {\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        const self = this;\n        this.repeatType = new DropDownList({\n            //set the data to dataSource property\n            dataSource: this.getRepeatData(),\n            floatLabelType: 'Always',\n            enableRtl: this.enableRtl,\n            index: this.selectedType,\n            fields: {\n                text: TEXTFIELD,\n                value: VALUEFIELD\n            },\n            placeholder: this.localeObj.getConstant(REPEAT),\n            htmlAttributes: { 'title': this.localeObj.getConstant(REPEAT), role: 'option' },\n            change: (args) => {\n                self.setProperties({ selectedType: this.frequencies.indexOf(args.value) }, false);\n                self.element.querySelector('.' + REPEATCONTENT).innerHTML =\n                    self.localeObj.getConstant(contentType[args.value]);\n                self.showFormElement();\n                self.updateForm(args.value);\n                self.resetFormValues();\n                self.triggerChangeEvent();\n            }\n        });\n        // set placeholder to DropDownList input element\n        this.repeatType.appendTo(this.element.querySelector('.' + REPEATELEMENT));\n        this.endType = new DropDownList({\n            dataSource: this.getEndData(),\n            popupWidth: this.getPopupWidth(),\n            enableRtl: this.enableRtl,\n            index: 1,\n            fields: {\n                text: TEXTFIELD,\n                value: VALUEFIELD\n            },\n            htmlAttributes: { role: 'option' },\n            change: (args) => {\n                self.freshOnEndForm();\n                self.updateEndOnForm(args.value);\n                self.resetFormValues();\n                self.triggerChangeEvent();\n            }\n        });\n        this.endType.appendTo(this.element.querySelector('.' + ENDONELEMENT));\n        const renderDropDownList = (dropDownData) => {\n            return new DropDownList({\n                dataSource: dropDownData,\n                popupWidth: this.getPopupWidth(),\n                enableRtl: this.enableRtl,\n                fields: {\n                    text: TEXTFIELD,\n                    value: VALUEFIELD\n                },\n                htmlAttributes: { role: 'option' },\n                index: 1,\n                // eslint-disable-next-line @typescript-eslint/no-unused-vars\n                change: (args) => {\n                    self.onWeekDay.setProperties({ checked: true });\n                    self.resetFormValues();\n                    self.triggerChangeEvent();\n                }\n            });\n        };\n        this.monthWeekPos = renderDropDownList(this.getMonthPosData());\n        this.monthWeekPos.appendTo(this.element.querySelector('.' + MONTHPOS));\n        this.monthWeekDays = renderDropDownList(this.getDayData('wide'));\n        this.monthWeekDays.appendTo(this.element.querySelector('.' + MONTHWEEK));\n        this.monthValue = new DropDownList({\n            dataSource: this.getMonthData(),\n            fields: {\n                text: TEXTFIELD,\n                value: VALUEFIELD\n            },\n            htmlAttributes: { role: 'option' },\n            enableRtl: this.enableRtl,\n            index: 7,\n            // eslint-disable-next-line @typescript-eslint/no-unused-vars\n            change: (args) => {\n                self.resetFormValues();\n                self.triggerChangeEvent();\n            }\n        });\n        this.monthValue.appendTo(this.element.querySelector('.' + YEAREXPANDERELEMENT));\n    }\n    setDefaultValue() {\n        const formelement = [].slice.call(this.element.querySelectorAll('.e-control .e-numerictextbox'));\n        for (const element of formelement) {\n            const instance = element.ej2_instances[0];\n            if (instance.element.classList.contains(REPEATINTERVAL)) {\n                instance.value = 1;\n                instance.dataBind();\n            }\n            else if (instance.element.classList.contains(ENDONCOUNT)) {\n                instance.value = 10;\n                instance.dataBind();\n            }\n        }\n    }\n    resetFormValues() {\n        const recurreneElement = [].slice.call(this.element.querySelectorAll('.e-control [type=\"text\"]'));\n        for (const element of recurreneElement) {\n            let instance;\n            if (element.classList.contains('e-datepicker')) {\n                instance = element.ej2_instances[0];\n                if (instance.value) {\n                    // eslint-disable-next-line no-self-assign\n                    instance.value = instance.value;\n                    instance.dataBind();\n                }\n                else {\n                    this.updateUntilDate(this.startDate);\n                }\n            }\n            else if (element.classList.contains('e-dropdownlist')) {\n                instance = element.ej2_instances[0];\n                instance.index = instance.index || 0;\n                instance.dataBind();\n            }\n            else if (element.classList.contains('e-numerictextbox')) {\n                instance = element.ej2_instances[0];\n                let value;\n                if (instance.element.classList.contains(REPEATINTERVAL)) {\n                    value = 1;\n                }\n                else if (instance.element.classList.contains(ENDONCOUNT)) {\n                    value = 10;\n                }\n                else {\n                    value = this.startDate.getDate();\n                }\n                instance.value = instance.value || value;\n                instance.dataBind();\n            }\n        }\n    }\n    getPopupWidth() {\n        return Browser.isDevice ? '100%' : 'auto';\n    }\n    renderDatePickers() {\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        const self = this;\n        this.untilDateObj = new DatePicker({\n            firstDayOfWeek: this.firstDayOfWeek,\n            enableRtl: this.enableRtl,\n            locale: this.locale,\n            min: this.minDate,\n            max: this.maxDate,\n            format: (isNullOrUndefined(this.dateFormat) ? this.getFormat('dateFormats') : this.dateFormat),\n            change: (args) => {\n                if (args.value) {\n                    self.triggerChangeEvent();\n                }\n            }\n        });\n        this.untilDateObj.appendTo(this.element.querySelector('.' + UNTILDATE));\n    }\n    getFormat(formatType) {\n        let format;\n        if (this.locale === 'en' || this.locale === 'en-US') {\n            format = getValue(formatType + '.short', getDefaultDateObject(this.getCalendarMode()));\n        }\n        else {\n            format = getValue('main.' + '' + this.locale + '.dates.calendars.' + this.getCalendarMode() + '.' + formatType + '.short', cldrData);\n        }\n        return format;\n    }\n    dayButtonRender() {\n        const btns = [].slice.call(this.element.querySelectorAll('.' + DAYWRAPPER + ' button'));\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        const self = this;\n        for (const btn of btns) {\n            const button = new Button({ isToggle: true, enableRtl: this.enableRtl }, btn);\n            this.dayButtons.push(button);\n            EventHandler.add(btn, 'click', (args) => {\n                const btns = [].slice.call(this.element.querySelectorAll('.' + DAYWRAPPER + ' button.' + PRIMARY));\n                const element = args.target;\n                if (!element.classList.contains(PRIMARY)) {\n                    addClass([element], PRIMARY);\n                    self.triggerChangeEvent();\n                }\n                else if (btns.length > 1) {\n                    removeClass([element], PRIMARY);\n                    self.triggerChangeEvent();\n                }\n            });\n        }\n    }\n    radioButtonRender() {\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        const self = this;\n        this.onMonthDay = new RadioButton({\n            label: this.localeObj.getConstant(RADIOLABEL),\n            enableRtl: this.enableRtl,\n            name: 'monthType',\n            value: 'day',\n            change: () => {\n                self.resetFormValues();\n                self.triggerChangeEvent();\n            }\n        });\n        this.onMonthDay.appendTo(this.element.querySelector('.' + MONTHEXPANDERELEMENT));\n        this.monthButtons.push(this.onMonthDay);\n        this.onWeekDay = new RadioButton({\n            label: this.localeObj.getConstant('monthExpander'),\n            cssClass: 'e-month-type',\n            name: 'monthType',\n            enableRtl: this.enableRtl,\n            value: 'daypos',\n            change: () => {\n                self.resetFormValues();\n                self.triggerChangeEvent();\n            }\n        });\n        this.onWeekDay.appendTo(this.element.querySelector('.' + MONTHEXPANNDERELEM));\n        this.monthButtons.push(this.onWeekDay);\n    }\n    numericTextboxRender() {\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        const self = this;\n        this.recurrenceCount = new NumericTextBox({\n            value: 10,\n            format: '#',\n            enableRtl: this.enableRtl,\n            min: 1,\n            max: 999,\n            change: () => {\n                self.triggerChangeEvent();\n            }\n        });\n        this.recurrenceCount.appendTo(this.element.querySelector('.' + ENDONCOUNT));\n        this.monthDate = new NumericTextBox({\n            value: 1,\n            format: '#',\n            enableRtl: this.enableRtl,\n            min: 1,\n            max: 31,\n            change: () => {\n                self.onMonthDay.setProperties({ checked: true });\n                self.triggerChangeEvent();\n            }\n        });\n        this.monthDate.appendTo(this.element.querySelector('.' + MONTHDAYWRAPPER));\n        this.repeatInterval = new NumericTextBox({\n            value: 1,\n            format: '#',\n            min: 1,\n            max: 999,\n            enableRtl: this.enableRtl,\n            floatLabelType: 'Always',\n            placeholder: this.localeObj.getConstant(REPEATEVERY),\n            change: () => {\n                self.triggerChangeEvent();\n            }\n        });\n        this.repeatInterval.appendTo(this.element.querySelector('.' + REPEATINTERVAL));\n    }\n    renderComponent() {\n        this.setTemplate();\n        this.renderDropdowns();\n        this.renderDatePickers();\n        this.dayButtonRender();\n        this.radioButtonRender();\n        this.numericTextboxRender();\n    }\n    rotateArray(data, count) {\n        let temp;\n        for (let index = 0; index < count; index++) {\n            temp = data.shift();\n            data.push(temp);\n        }\n    }\n    getEndData() {\n        const endData = [NEVER, UNTIL$1, COUNT];\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        const self = this;\n        const dataSource = [];\n        endData.forEach((data) => {\n            dataSource.push({ text: self.localeObj.getConstant(data), value: data });\n        });\n        return dataSource;\n    }\n    getDayPosition(date) {\n        let temp = new Date(date.getTime());\n        let endDate = new Date(date.getTime());\n        const day = date.getDay();\n        const positionCollection = [];\n        temp = this.calendarUtil.getMonthStartDate(temp);\n        endDate = this.calendarUtil.getMonthEndDate(endDate);\n        while (temp < endDate) {\n            if (temp.getDay() === day) {\n                positionCollection.push(temp.getTime());\n            }\n            temp.setDate(temp.getDate() + 1);\n        }\n        if (positionCollection.indexOf(date.getTime()) === positionCollection.length - 1) {\n            return -1;\n        }\n        return (positionCollection.indexOf(date.getTime()) + 1);\n    }\n    getRepeatData() {\n        const data = [];\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        const self = this;\n        this.frequencies.forEach((element) => {\n            const textValue = (element === NONE) ? NEVER : element;\n            data.push({ text: self.localeObj.getConstant(textValue), value: element });\n        });\n        return data;\n    }\n    getMonthPosData() {\n        const monthpos = [FIRST, SECOND, THIRD, FOURTH, LAST];\n        const monthposValue = {\n            first: 1,\n            second: 2,\n            third: 3,\n            fourth: 4,\n            last: -1\n        };\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        const self = this;\n        const dataSource = [];\n        monthpos.forEach((data) => {\n            dataSource.push({ text: self.localeObj.getConstant(data), value: monthposValue[data] });\n        });\n        return dataSource;\n    }\n    getDayData(format) {\n        const weekday = [KEYSUNDAY, KEYMONDAY, KEYTUESDAY, KEYWEDNESDAY, KEYTHURSDAY, KEYFRIDAY, KEYSATURDAY];\n        const dayData = [];\n        let cldrObj;\n        this.rotateArray(weekday, this.firstDayOfWeek);\n        if (this.locale === 'en' || this.locale === 'en-US') {\n            const nameSpaceString = 'days.stand-alone.';\n            cldrObj = (getValue(nameSpaceString + format, getDefaultDateObject(this.getCalendarMode())));\n        }\n        else {\n            const nameSpaceString = 'main.' + '' + this.locale + '.dates.calendars.' + this.getCalendarMode() + '.days.stand-alone.' + format;\n            cldrObj = (getValue(nameSpaceString, cldrData));\n        }\n        for (const obj of weekday) {\n            const day = getValue(obj, cldrObj);\n            dayData.push({ text: format === 'narrow' ? day : capitalizeFirstWord(day, 'single'), value: valueData[obj] });\n        }\n        return dayData;\n    }\n    getMonthData() {\n        const monthData = [];\n        let cldrObj;\n        if (this.locale === 'en' || this.locale === 'en-US') {\n            const nameSpaceString = 'months.stand-alone.wide';\n            cldrObj = (getValue(nameSpaceString, getDefaultDateObject(this.getCalendarMode())));\n        }\n        else {\n            const nameSpaceString = 'main.' + '' + this.locale + '.dates.calendars.' + this.getCalendarMode() + '.months.stand-alone.wide';\n            cldrObj = (getValue(nameSpaceString, cldrData));\n        }\n        for (const obj of Object.keys(cldrObj)) {\n            monthData.push({\n                text: capitalizeFirstWord(getValue(obj, cldrObj), 'single'),\n                value: obj\n            });\n        }\n        return monthData;\n    }\n    setTemplate() {\n        const dayData = this.getDayData('narrow');\n        const fullDay = this.getDayData('wide');\n        this.element.innerHTML = '<div class=\"' + HEADER + '\">' +\n            '<div class=\"' + INPUTWARAPPER + ' ' + FORMLEFT + '\">' +\n            '<input type=\"text\" tabindex=\"0\" class=\"' + REPEATELEMENT +\n            '\"label=\"' + REPEATELEMENT.substr(2) + '\" />' +\n            '</div><div class=\"' + INPUTWARAPPER + ' ' +\n            INTERVALCLASS + ' ' + FORMRIGHT + '\"><table  class=\"' + RECURRENCETABLE + ' ' + REPEATCONTENTWRAPPER + '\"><tr>' +\n            '<td><input type=\"text\" tabindex=\"0\" class=\"' + REPEATINTERVAL +\n            '\"title=\"' + this.localeObj.getConstant('repeatEvery') + '\" /></td>' +\n            '<td><span class=\"' + REPEATCONTENT + '\"></span></td>' +\n            '</tr></table></div><div class=\"' + INPUTWARAPPERSIDE + ' ' + DAYWRAPPER + ' ' + FORMLEFT + '\">' +\n            '<div class=' + WEEKEXPANDERLABEL + '>' + this.localeObj.getConstant(ON$1) + '</div>' +\n            '<button type=\"button\" class=\"e-round\" data-index=\"0\" title=\"' + fullDay[0].text + '\">' + dayData[0].text + '</button>' +\n            '<button type=\"button\" class=\"e-round\" data-index=\"1\" title=\"' + fullDay[1].text + '\">' + dayData[1].text + '</button>' +\n            '<button type=\"button\" class=\"e-round\" data-index=\"2\" title=\"' + fullDay[2].text + '\">' + dayData[2].text + '</button>' +\n            '<button type=\"button\" class=\"e-round\" data-index=\"3\" title=\"' + fullDay[3].text + '\">' + dayData[3].text + '</button>' +\n            '<button type=\"button\" class=\"e-round\" data-index=\"4\" title=\"' + fullDay[4].text + '\">' + dayData[4].text + '</button>' +\n            '<button type=\"button\" class=\"e-round\" data-index=\"5\" title=\"' + fullDay[5].text + '\">' + dayData[5].text + '</button>' +\n            '<button type=\"button\" class=\"e-round\" data-index=\"6\" title=\"' + fullDay[6].text + '\">' + dayData[6].text + '</button></div>' +\n            '<div class=\"' + INPUTWARAPPERSIDE + ' ' + WEEKWRAPPER + ' ' + FORMLEFT + '\">' +\n            '<div class=' + MONTHEXPANDERLABEL + '>' + this.localeObj.getConstant(ON$1) + '</div>' +\n            '<div class=\"' + YEAREXPANDERWRAPPER + '\">' +\n            '<input class=\"' + YEAREXPANDERELEMENT + '\" type=\"text\" tabindex=\"0\" title=\"' +\n            this.localeObj.getConstant('yearExpander') + '\"/>' +\n            '</div>' +\n            '<div class=\"' + MONETHEXPANDERWRAPPER + '\">' +\n            '<table class=\"' + RECURRENCETABLE + ' ' + MONETHEXPANDWRAPPER + '\"><tr><td>' +\n            '<div class=\"' + INPUTWARAPPER + ' ' + MONTHEXPANDERCHECKBOXWRAPPER + '\">' +\n            '<input class=\"' + MONTHEXPANDERELEMENT + '\"title=\"' + this.localeObj.getConstant('monthExpander') + '\" type=\"radio\">' +\n            '</div></td>' +\n            '<td colspan=\"2\"><div class=\"' + INPUTWARAPPER + ' ' + MONTHDAYELEMENT + '\">' +\n            '<input type=\"text\" tabindex=\"0\" class=\"' + MONTHDAYWRAPPER + '\"title=\"' +\n            this.localeObj.getConstant('on') + '\" />' +\n            '</div></td></tr>' +\n            '<tr><td>' +\n            '<div class=\"' + INPUTWARAPPER + ' ' + MONTHEXPANDERCHECKBOXWRAPPER + '\" style=\"min-width: 30px;margin-bottom:18px;\">' +\n            '<input class=\"' + MONTHEXPANNDERELEM + '\"title=\"' + this.localeObj.getConstant('monthExpander') + '\" type=\"radio\">' +\n            '</div></td>' +\n            '<td><div class=\"' + INPUTWARAPPER + ' ' + WEEKPOSITION + '\" >' +\n            '<input type=\"text\" tabindex=\"0\" class=\"' + MONTHPOS + '\"title=\"' + this.localeObj.getConstant('monthPosition') + '\" />' +\n            '</div></td>' +\n            '<td><div class=\"' + INPUTWARAPPER + ' ' + DAYPOSITION + '\">' +\n            '<input type=\"text\" tabindex=\"0\" class=\"' + MONTHWEEK + '\"title=\"' + this.localeObj.getConstant('monthWeek') + '\" />' +\n            '</div></td></tr></table>' +\n            '</div></div>' +\n            '<div class=\"' + INPUTWARAPPERSIDE + ' ' + ENDON + ' ' + FORMRIGHT + '\">' +\n            '<div class=' + ENDONLABEL + '>' + this.localeObj.getConstant(END) + '</div>' +\n            '<div class=\"' + INPUTWARAPPER + ' ' + ENDONLEFT + '\">' +\n            '<input type=\"text\" tabindex=\"0\" class=\"' + ENDONELEMENT + '\"title=\"' + this.localeObj.getConstant(END) + '\" />' +\n            '</div>' +\n            '<div class=\"' + INPUTWARAPPER + ' ' + ENDONDATE + '\" >' +\n            '<input type=\"text\" tabindex=\"0\" class=\"' + UNTILDATE + '\"title=\"' + this.localeObj.getConstant(UNTIL$1) + '\" />' +\n            '</div>' +\n            '<div class=\"' + INPUTWARAPPER + ' ' + ENDONCOUNTWRAPPER + '\">' +\n            '<input type=\"text\" tabindex=\"0\" class=\"' + ENDONCOUNT + '\"title=\"' + this.localeObj.getConstant(COUNT) + '\" />' +\n            '</div></div>' +\n            '</div></div>';\n    }\n    getSelectedDaysData() {\n        let ruleData = RULEBYDAY + EQUAL;\n        const elements = [].slice.call(this.element.querySelectorAll('.' + DAYWRAPPER + ' button.' + PRIMARY));\n        const weekday = [RULESUNDAY, RULEMONDAY, RULETUESDAY, RULEWEDNESDAY, RULETHURSDAY, RULEFRIDAY, RULESATURDAY];\n        this.rotateArray(weekday, this.firstDayOfWeek);\n        for (let index = 0; index < elements.length; index++) {\n            ruleData += weekday[parseInt(elements[index].getAttribute('data-index'), 10)] + (index === (elements.length - 1) ? '' : COMMA);\n        }\n        return ruleData + SEMICOLON;\n    }\n    getSelectedMonthData() {\n        let ruleData;\n        if (this.onWeekDay.checked) {\n            ruleData = RULEBYDAY + EQUAL + this.monthWeekDays.value + SEMICOLON\n                + RULESETPOS + EQUAL + this.monthWeekPos.value + SEMICOLON;\n        }\n        else {\n            ruleData = RULEBYMONTHDAY + EQUAL + this.monthDate.value + SEMICOLON;\n        }\n        return ruleData;\n    }\n    getIntervalData() {\n        return RULEINTERVAL + EQUAL + this.repeatInterval.value + SEMICOLON;\n    }\n    getEndOnCount() {\n        return RULECOUNT + EQUAL + this.recurrenceCount.value + SEMICOLON;\n    }\n    getYearMonthRuleData() {\n        return RULEBYMONTH + EQUAL + this.monthValue.value + SEMICOLON;\n    }\n    updateWeekButton(keys) {\n        const weekday = [RULESUNDAY, RULEMONDAY, RULETUESDAY, RULEWEDNESDAY, RULETHURSDAY, RULEFRIDAY, RULESATURDAY];\n        this.rotateArray(weekday, this.firstDayOfWeek);\n        for (const obj of this.dayButtons) {\n            const index = parseInt(obj.element.getAttribute('data-index'), 10);\n            if (keys.indexOf(weekday[index]) !== -1) {\n                obj.setProperties({ isPrimary: true });\n            }\n            else {\n                obj.setProperties({ isPrimary: false });\n            }\n        }\n    }\n    updateMonthUI() {\n        if (this.ruleObject.monthDay.length) {\n            this.monthDate.setProperties({ value: this.ruleObject.monthDay[0] });\n            this.onMonthDay.setProperties({ checked: true });\n        }\n        else {\n            this.onWeekDay.setProperties({ checked: true });\n            this.monthWeekPos.setProperties({ value: this.ruleObject.setPosition });\n            for (const key of Object.keys(valueData)) {\n                if (valueData[key] === this.ruleObject.day[0]) {\n                    this.monthWeekDays.setProperties({ value: this.ruleObject.day[0] });\n                    break;\n                }\n            }\n        }\n    }\n    updateUI(repeat, state) {\n        this.repeatInterval.setProperties({ value: this.ruleObject.interval });\n        switch (state) {\n            case UNTIL$1:\n                this.untilDateObj.setProperties({ value: this.ruleObject.until });\n                break;\n            case COUNT:\n                this.recurrenceCount.setProperties({ value: this.ruleObject.count });\n                break;\n        }\n        switch (repeat) {\n            case WEEKLY:\n                this.updateWeekButton(this.ruleObject.day);\n                break;\n            case YEARLY:\n                this.monthValue.setProperties({ index: (this.ruleObject.month[0] - 1) });\n                this.updateMonthUI();\n                break;\n            case MONTHLY:\n                this.updateMonthUI();\n                break;\n        }\n    }\n    getUntilData() {\n        if (!this.untilDateObj.value) {\n            return '';\n        }\n        const tempStr = getRecurrenceStringFromDate(this.untilDateObj.value);\n        return RULEUNTIL + EQUAL + tempStr + SEMICOLON;\n    }\n    destroyComponents() {\n        if (!this.recurrenceCount.isDestroyed) {\n            this.recurrenceCount.destroy();\n        }\n        if (!this.monthDate.isDestroyed) {\n            this.monthDate.destroy();\n        }\n        if (!this.repeatInterval.isDestroyed) {\n            this.repeatInterval.destroy();\n        }\n        if (!this.untilDateObj.isDestroyed) {\n            this.untilDateObj.destroy();\n        }\n        if (!this.repeatType.isDestroyed) {\n            this.repeatType.destroy();\n        }\n        if (!this.endType.isDestroyed) {\n            this.endType.destroy();\n        }\n        if (!this.monthWeekPos.isDestroyed) {\n            this.monthWeekPos.destroy();\n        }\n        if (!this.monthWeekDays.isDestroyed) {\n            this.monthWeekDays.destroy();\n        }\n        if (!this.monthValue.isDestroyed) {\n            this.monthValue.destroy();\n        }\n        this.dayButtons.forEach((element) => {\n            if (!element.isDestroyed) {\n                element.destroy();\n            }\n        });\n        this.dayButtons = [];\n        this.monthButtons.forEach((element) => {\n            if (!element.isDestroyed) {\n                element.destroy();\n            }\n        });\n        this.monthButtons = [];\n    }\n    resetFields() {\n        this.startState(NONE, NEVER, this.startDate);\n        this.setDefaultValue();\n    }\n    updateRuleUntilDate(startDate) {\n        if (this.untilDateObj.value && startDate) {\n            const untilDate = this.untilDateObj.value;\n            const newUntilDate = new Date(untilDate.getFullYear(), untilDate.getMonth(), untilDate.getDate(), startDate.getHours(), startDate.getMinutes(), startDate.getMilliseconds());\n            this.untilDateObj.setProperties({ value: newUntilDate });\n        }\n    }\n    getCalendarMode() {\n        return this.calendarMode.toLowerCase();\n    }\n    getRuleSummary(rule = this.getRecurrenceRule()) {\n        return generateSummary(rule, this.localeObj, this.locale, this.calendarMode);\n    }\n    getRecurrenceDates(startDate, rule, excludeDate, maximumCount, viewDate) {\n        viewDate = isNullOrUndefined(viewDate) ? this.startDate : viewDate;\n        return generate(startDate, rule, excludeDate, this.firstDayOfWeek, maximumCount, viewDate, this.calendarMode);\n    }\n    getRecurrenceRule() {\n        let ruleData = RULEFREQ + EQUAL;\n        switch (this.repeatType.value) {\n            case DAILY:\n                ruleData += RULEDAILY + SEMICOLON;\n                break;\n            case WEEKLY:\n                ruleData += RULEWEEKLY + SEMICOLON + this.getSelectedDaysData();\n                break;\n            case MONTHLY:\n                ruleData += RULEMONTHLY + SEMICOLON + this.getSelectedMonthData();\n                break;\n            case YEARLY:\n                ruleData += RULEYEARLY + SEMICOLON + this.getSelectedMonthData() + this.getYearMonthRuleData();\n                break;\n            case NONE:\n                return '';\n        }\n        ruleData += this.getIntervalData();\n        switch (this.endType.value) {\n            case UNTIL$1:\n                ruleData += this.getUntilData();\n                break;\n            case COUNT:\n                ruleData += this.getEndOnCount();\n                break;\n        }\n        return ruleData;\n    }\n    setRecurrenceRule(rule, startDate = this.startDate) {\n        if (!rule) {\n            this.repeatType.setProperties({ value: NONE });\n            return;\n        }\n        this.renderStatus = false;\n        this.ruleObject = extractObjectFromRule(rule);\n        const endon = this.ruleObject.count ? COUNT : (this.ruleObject.until ? UNTIL$1 : NEVER);\n        switch (this.ruleObject.freq) {\n            case RULEDAILY:\n                this.startState(DAILY, endon, startDate);\n                this.updateUI(DAILY, endon);\n                break;\n            case RULEWEEKLY:\n                this.startState(WEEKLY, endon, startDate);\n                this.updateUI(WEEKLY, endon);\n                break;\n            case RULEMONTHLY:\n                this.startState(MONTHLY, endon, startDate);\n                this.updateUI(MONTHLY, endon);\n                break;\n            case RULEYEARLY:\n                this.startState(YEARLY, endon, startDate);\n                this.updateUI(YEARLY, endon);\n                break;\n        }\n        this.renderStatus = true;\n        this.triggerChangeEvent();\n    }\n    /**\n     * Destroys the widget.\n     *\n     * @returns {void}\n     */\n    destroy() {\n        this.destroyComponents();\n        super.destroy();\n        let removeClasses = ['e-' + this.getModuleName()];\n        if (this.cssClass) {\n            removeClasses = removeClasses.concat(this.cssClass.split(' '));\n        }\n        removeClass([this.element], removeClasses);\n        while (this.element.firstElementChild) {\n            this.element.removeChild(this.element.firstElementChild);\n        }\n    }\n    /**\n     * Get component name.\n     *\n     * @returns {string} Returns the module name\n     * @private\n     */\n    getModuleName() {\n        return 'recurrenceeditor';\n    }\n    /**\n     * Get the properties to be maintained in the persisted state.\n     *\n     * @returns {string} Returns the persisted state\n     */\n    getPersistData() {\n        return this.addOnPersist([]);\n    }\n    /**\n     * Initialize the control rendering\n     *\n     * @returns {void}\n     * @private\n     */\n    render() {\n        this.initialize();\n        this.rtlClass(this.enableRtl);\n        this.renderStatus = true;\n        this.renderComplete();\n    }\n    /**\n     * Called internally, if any of the property value changed.\n     *\n     * @param {RecurrenceEditorModel} newProp Accepts the changed properties new values\n     * @param {RecurrenceEditorModel} oldProp Accepts the changed properties old values\n     * @returns {void}\n     * @private\n     */\n    onPropertyChanged(newProp, oldProp) {\n        for (const prop of Object.keys(newProp)) {\n            switch (prop) {\n                case 'startDate':\n                    this.selectMonthDay(newProp.startDate);\n                    this.updateUntilDate(newProp.startDate);\n                    this.endType.setProperties({ index: 0 });\n                    break;\n                case 'enableRtl':\n                    this.rtlClass(newProp.enableRtl);\n                    break;\n                case 'cssClass':\n                    if (oldProp.cssClass) {\n                        removeClass([this.element], oldProp.cssClass.split(' '));\n                    }\n                    if (newProp.cssClass) {\n                        addClass([this.element], newProp.cssClass.split(' '));\n                    }\n                    break;\n                case 'selectedType':\n                    this.repeatType.setProperties({ index: this.selectedType });\n                    break;\n                case 'minDate':\n                    this.untilDateObj.setProperties({ minDate: this.minDate });\n                    break;\n                case 'maxDate':\n                    this.untilDateObj.setProperties({ maxDate: this.maxDate });\n                    break;\n                case 'value':\n                    if (this.getRecurrenceRule() !== this.value) {\n                        this.setRecurrenceRule(this.value);\n                    }\n                    break;\n                case 'calendarMode':\n                    this.calendarMode = newProp.calendarMode;\n                    this.calendarUtil = getCalendarUtil(newProp.calendarMode);\n                    break;\n                case 'locale':\n                case 'frequencies':\n                case 'firstDayOfWeek':\n                    this.refresh();\n                    break;\n                case 'dateFormat':\n                    this.untilDateObj.setProperties({ format: newProp.dateFormat });\n                    break;\n            }\n        }\n    }\n};\n__decorate$1([\n    Property(['none', 'daily', 'weekly', 'monthly', 'yearly'])\n], RecurrenceEditor.prototype, \"frequencies\", void 0);\n__decorate$1([\n    Property(0)\n], RecurrenceEditor.prototype, \"firstDayOfWeek\", void 0);\n__decorate$1([\n    Property(new Date())\n], RecurrenceEditor.prototype, \"startDate\", void 0);\n__decorate$1([\n    Property()\n], RecurrenceEditor.prototype, \"dateFormat\", void 0);\n__decorate$1([\n    Property('Gregorian')\n], RecurrenceEditor.prototype, \"calendarMode\", void 0);\n__decorate$1([\n    Property()\n], RecurrenceEditor.prototype, \"cssClass\", void 0);\n__decorate$1([\n    Property()\n], RecurrenceEditor.prototype, \"value\", void 0);\n__decorate$1([\n    Property(new Date(1900, 0, 1))\n], RecurrenceEditor.prototype, \"minDate\", void 0);\n__decorate$1([\n    Property(new Date(2099, 11, 31))\n], RecurrenceEditor.prototype, \"maxDate\", void 0);\n__decorate$1([\n    Property(0)\n], RecurrenceEditor.prototype, \"selectedType\", void 0);\n__decorate$1([\n    Event()\n], RecurrenceEditor.prototype, \"change\", void 0);\nRecurrenceEditor = __decorate$1([\n    NotifyPropertyChanges\n], RecurrenceEditor);\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\nconst EVENT_FIELD$1 = 'e-field';\nconst REPEAT_CONTAINER_CLASS = 'e-recurrence-container';\nconst REPEAT_BUTTON_ICON_CLASS = 'e-recurrence-edit';\nconst REPEAT_BUTTON_CLASS = 'e-recurrence-edit-button';\nconst REPEAT_DIALOG_CLASS = 'e-recurrence-dialog';\nconst HIDE_STYLE_CLASS = 'e-hide';\n/**\n * Event editor window\n */\nclass EventWindow {\n    constructor(parent) {\n        this.parent = parent;\n        this.l10n = this.parent.localeObj;\n        this.fields = this.parent.eventFields;\n        this.eventWindowTime = { startTime: new Date(), endTime: new Date() };\n        this.renderEventWindow();\n    }\n    renderEventWindow() {\n        this.element = createElement('div', { id: this.parent.element.id + '_dialog_wrapper' });\n        this.parent.element.appendChild(this.element);\n        const dialogModel = {\n            animationSettings: { effect: 'Zoom' },\n            content: this.getEventWindowContent(),\n            cssClass: EVENT_WINDOW_DIALOG_CLASS,\n            enableRtl: this.parent.enableRtl,\n            height: this.parent.isAdaptive ? '100%' : 'auto',\n            minHeight: '300px',\n            isModal: true,\n            showCloseIcon: this.parent.isAdaptive ? false : true,\n            target: document.body,\n            visible: false,\n            width: '500px',\n            beforeOpen: this.onBeforeOpen.bind(this),\n            beforeClose: this.onBeforeClose.bind(this)\n        };\n        if (this.parent.isAdaptive) {\n            dialogModel.cssClass = EVENT_WINDOW_DIALOG_CLASS + ' ' + DEVICE_CLASS;\n            dialogModel.header = '<div class=\"e-title-header\"><div class=\"e-back-icon e-icons\"></div><div class=\"e-title-text\">' +\n                this.l10n.getConstant('newEvent') + '</div><div class=\"e-save-icon e-icons\"></div></div>';\n        }\n        else {\n            dialogModel.buttons = [{\n                    buttonModel: {\n                        content: this.l10n.getConstant('deleteButton'), cssClass: DELETE_EVENT_CLASS,\n                        disabled: !this.parent.eventSettings.allowDeleting || this.parent.readonly\n                    },\n                    click: this.eventDelete.bind(this)\n                }, {\n                    buttonModel: {\n                        content: this.l10n.getConstant('saveButton'), cssClass: 'e-primary ' + EVENT_WINDOW_SAVE_BUTTON_CLASS,\n                        isPrimary: true, disabled: !this.parent.eventSettings.allowAdding || this.parent.readonly\n                    },\n                    click: this.eventSave.bind(this)\n                }, {\n                    buttonModel: { cssClass: EVENT_WINDOW_CANCEL_BUTTON_CLASS, content: this.l10n.getConstant('cancelButton') },\n                    click: this.dialogClose.bind(this)\n                }];\n            dialogModel.header = '<div class=\"e-title-text\">' + this.l10n.getConstant('newEvent') + '</div>';\n        }\n        this.dialogObject = new Dialog(dialogModel, this.element);\n        if (this.dialogObject.element.querySelector('.e-dlg-closeicon-btn')) {\n            this.dialogObject.element.querySelector('.e-dlg-closeicon-btn').setAttribute('title', this.l10n.getConstant('close'));\n        }\n        addClass([this.element.parentElement], EVENT_WINDOW_DIALOG_CLASS + '-container');\n        if (this.parent.isAdaptive) {\n            EventHandler.add(this.element.querySelector('.' + EVENT_WINDOW_BACK_ICON_CLASS), 'click', this.dialogClose, this);\n            EventHandler.add(this.element.querySelector('.' + EVENT_WINDOW_SAVE_ICON_CLASS), 'click', this.eventSave, this);\n        }\n        EventHandler.add(this.dialogObject.element, 'keydown', this.preventEventSave, this);\n        this.applyFormValidation();\n    }\n    refresh() {\n        this.destroy(true);\n        this.renderEventWindow();\n    }\n    refreshRecurrenceEditor() {\n        if (this.recurrenceEditor) {\n            const recurrenceEditor = this.recurrenceEditor.element;\n            this.recurrenceEditor.destroy();\n            this.createRecurrenceEditor(recurrenceEditor);\n        }\n    }\n    setRecurrenceEditor(recurrenceEditor) {\n        if (this.parent.editorTemplate) {\n            this.recurrenceEditor = recurrenceEditor;\n        }\n    }\n    openEditor(data, type, isEventData, repeatType) {\n        this.parent.currentAction = type;\n        this.parent.removeNewEventElement();\n        if (this.parent.quickPopup) {\n            this.parent.quickPopup.quickPopupHide(true);\n        }\n        this.parent.inlineModule.removeInlineAppointmentElement();\n        if (type === 'Add') {\n            let eventObj = {};\n            this.cellClickAction = !isEventData;\n            this.parent.activeCellsData = data;\n            const event = data;\n            if (this.cellClickAction) {\n                this.convertToEventData(event, eventObj);\n            }\n            else {\n                this.parent.activeCellsData = {\n                    startTime: (event.startTime || event[this.fields.startTime]),\n                    endTime: (event.endTime || event[this.fields.endTime]),\n                    isAllDay: (event.isAllDay || event[this.fields.isAllDay]),\n                    element: event.element,\n                    groupIndex: event.groupIndex\n                };\n                eventObj = event;\n            }\n            data = eventObj;\n        }\n        if (!isNullOrUndefined(this.parent.editorTemplate)) {\n            this.renderFormElements(this.element.querySelector('.e-schedule-form'), data);\n        }\n        if (!this.parent.isAdaptive && isNullOrUndefined(this.parent.editorTemplate)) {\n            removeClass([this.dialogObject.element.querySelector('.e-recurrenceeditor')], DISABLE_CLASS);\n        }\n        if (this.recurrenceEditor) {\n            this.recurrenceEditor.firstDayOfWeek = this.parent.activeViewOptions.firstDayOfWeek;\n        }\n        switch (type) {\n            case 'Add':\n                this.onCellDetailsUpdate(data, repeatType);\n                break;\n            case 'Save':\n            case 'EditOccurrence':\n            case 'EditSeries':\n            case 'EditFollowingEvents':\n                if (type === 'EditOccurrence' && !this.parent.isAdaptive && isNullOrUndefined(this.parent.editorTemplate)) {\n                    addClass([this.dialogObject.element.querySelector('.e-recurrenceeditor')], DISABLE_CLASS);\n                }\n                this.cellClickAction = false;\n                this.onEventDetailsUpdate(data);\n                break;\n        }\n    }\n    setDialogContent() {\n        this.dialogObject.content = this.getEventWindowContent();\n        this.dialogObject.dataBind();\n        this.applyFormValidation();\n    }\n    preventEventSave(e) {\n        if (this.parent && !this.parent.allowKeyboardInteraction && e.code === 'Enter') {\n            this.isEnterKey = true;\n        }\n    }\n    onBeforeOpen(args) {\n        const eventProp = {\n            type: 'Editor',\n            data: this.eventData,\n            cancel: false,\n            element: this.element,\n            target: (this.cellClickAction ? this.parent.activeCellsData.element : this.parent.activeEventData.element)\n        };\n        if (this.cellClickAction) {\n            eventProp.duration = this.getSlotDuration();\n        }\n        const saveObj = this.getInstance(EVENT_WINDOW_SAVE_BUTTON_CLASS);\n        if (saveObj) {\n            saveObj.disabled = !(this.cellClickAction ? this.parent.eventSettings.allowAdding : this.parent.eventSettings.allowEditing);\n            saveObj.dataBind();\n        }\n        const deleteObj = this.getInstance(DELETE_EVENT_CLASS);\n        if (deleteObj) {\n            deleteObj.disabled = !this.parent.eventSettings.allowDeleting;\n            deleteObj.dataBind();\n        }\n        const callBackPromise = new Deferred();\n        this.parent.trigger(popupOpen, eventProp, (popupArgs) => {\n            args.cancel = popupArgs.cancel;\n            this.duration = this.cellClickAction ? popupArgs.duration : null;\n            this.refreshDateTimePicker(this.duration);\n            if (this.cellClickAction && popupArgs.duration !== this.getSlotDuration() && isNullOrUndefined(this.parent.editorTemplate)) {\n                const startObj = this.getInstance(EVENT_WINDOW_START_CLASS);\n                const endObj = this.getInstance(EVENT_WINDOW_END_CLASS);\n                endObj.value = new Date(startObj.value.getTime() + (MS_PER_MINUTE * popupArgs.duration));\n                endObj.dataBind();\n            }\n            if (this.parent.editorTemplate && this.element.querySelector('.e-recurrenceeditor') && !this.recurrenceEditor) {\n                this.recurrenceEditor = this.getInstance('e-recurrenceeditor');\n            }\n            callBackPromise.resolve(args);\n        });\n        return callBackPromise;\n    }\n    onBeforeClose(args) {\n        if (args.isInteracted) {\n            this.isCrudAction = false;\n        }\n        const eventProp = {\n            type: 'Editor',\n            event: args.event || this.dialogEvent,\n            data: this.eventCrudData,\n            cancel: false,\n            element: this.element,\n            target: (this.cellClickAction ? this.parent.activeCellsData.element : this.parent.activeEventData.element)\n        };\n        const callBackPromise = new Deferred();\n        this.parent.trigger(popupClose, eventProp, (popupArgs) => {\n            args.cancel = popupArgs.cancel;\n            if (!popupArgs.cancel) {\n                if (this.isCrudAction) {\n                    args.cancel = this.processCrudActions(popupArgs.data);\n                    this.isCrudAction = args.cancel;\n                }\n                if (!this.isCrudAction) {\n                    this.resetForm();\n                    this.parent.eventBase.focusElement(true);\n                    this.eventCrudData = null;\n                }\n            }\n            callBackPromise.resolve(args);\n        });\n        return callBackPromise;\n    }\n    getEventWindowContent() {\n        const container = createElement('div', { className: FORM_CONTAINER_CLASS });\n        const form = createElement('form', {\n            id: this.parent.element.id + 'EditForm',\n            className: FORM_CLASS,\n            attrs: { onsubmit: 'return false;' }\n        });\n        this.renderFormElements(form);\n        container.appendChild(form);\n        return container;\n    }\n    renderFormElements(form, args) {\n        if (!isNullOrUndefined(this.parent.editorTemplate)) {\n            if (args) {\n                if (this.recurrenceEditor) {\n                    this.recurrenceEditor.destroy();\n                    this.recurrenceEditor = null;\n                }\n                this.destroyComponents();\n                const formElements = [].slice.call(form.children);\n                for (const element of formElements) {\n                    remove(element);\n                }\n            }\n            const templateId = this.parent.element.id + '_editorTemplate';\n            const tempEle = [].slice.call(this.parent.getEditorTemplate()(args || {}, this.parent, 'editorTemplate', templateId, false));\n            append(tempEle, form);\n            this.parent.renderTemplates();\n        }\n        else {\n            form.appendChild(this.getDefaultEventWindowContent());\n        }\n    }\n    getDefaultEventWindowContent() {\n        const parentDiv = this.createDivElement(EVENT_WINDOW_DIALOG_PARENT_CLASS);\n        const titleLocationDiv = this.createDivElement(EVENT_WINDOW_TITLE_LOCATION_DIV_CLASS);\n        parentDiv.appendChild(titleLocationDiv);\n        titleLocationDiv.appendChild(this.renderTextBox(SUBJECT_CLASS));\n        titleLocationDiv.querySelector('.' + SUBJECT_CLASS).setAttribute('title', this.parent.editorTitles.subject);\n        titleLocationDiv.appendChild(this.renderTextBox(LOCATION_CLASS));\n        titleLocationDiv.querySelector('.' + LOCATION_CLASS).setAttribute('title', this.parent.editorTitles.location);\n        const startEndDateTimeDiv = this.createDivElement(EVENT_WINDOW_START_END_DIV_CLASS);\n        parentDiv.appendChild(startEndDateTimeDiv);\n        startEndDateTimeDiv.appendChild(this.renderDateTimePicker(EVENT_WINDOW_START_CLASS, this.onTimeChange.bind(this)));\n        startEndDateTimeDiv.querySelector('.' + EVENT_WINDOW_START_CLASS).setAttribute('title', this.parent.editorTitles.startTime);\n        startEndDateTimeDiv.appendChild(this.renderDateTimePicker(EVENT_WINDOW_END_CLASS));\n        startEndDateTimeDiv.querySelector('.' + EVENT_WINDOW_END_CLASS).setAttribute('title', this.parent.editorTitles.endTime);\n        const allDayTimezoneDiv = this.createDivElement(EVENT_WINDOW_ALLDAY_TZ_DIV_CLASS);\n        parentDiv.appendChild(allDayTimezoneDiv);\n        allDayTimezoneDiv.appendChild(this.renderCheckBox(EVENT_WINDOW_ALL_DAY_CLASS));\n        allDayTimezoneDiv.appendChild(this.renderCheckBox(TIME_ZONE_CLASS));\n        const timezoneParentDiv = this.createDivElement(EVENT_WINDOW_TIME_ZONE_DIV_CLASS);\n        parentDiv.appendChild(timezoneParentDiv);\n        timezoneParentDiv.appendChild(this.renderDropDown(EVENT_WINDOW_START_TZ_CLASS));\n        timezoneParentDiv.appendChild(this.renderDropDown(EVENT_WINDOW_END_TZ_CLASS));\n        const repeatParentDiv = this.createDivElement(EVENT_WINDOW_REPEAT_DIV_CLASS);\n        parentDiv.appendChild(repeatParentDiv);\n        const repeatDiv = this.renderCheckBox(EVENT_WINDOW_REPEAT_CLASS);\n        const repeatEditContainer = createElement('span', { className: REPEAT_CONTAINER_CLASS });\n        const button = createElement('button', {\n            className: REPEAT_BUTTON_CLASS,\n            attrs: { type: 'button', 'title': this.l10n.getConstant('editRecurrence') }\n        });\n        this.buttonObj = new Button({ iconCss: REPEAT_BUTTON_ICON_CLASS + ' e-icons', cssClass: 'e-medium ' + this.parent.cssClass });\n        repeatEditContainer.appendChild(button);\n        this.buttonObj.appendTo(button);\n        repeatDiv.appendChild(repeatEditContainer);\n        repeatParentDiv.appendChild(repeatDiv);\n        if (this.parent.isAdaptive) {\n            EventHandler.add(button, 'click', this.loadRecurrenceEditor, this);\n        }\n        else {\n            this.createRecurrenceEditor(parentDiv);\n        }\n        if (this.parent.resourceCollection.length > 0) {\n            const resourceParentDiv = this.createDivElement(EVENT_WINDOW_RESOURCES_DIV_CLASS);\n            for (const resource of this.parent.resourceBase.resourceCollection) {\n                resourceParentDiv.appendChild(this.renderResourceDetails(resource));\n            }\n            parentDiv.appendChild(resourceParentDiv);\n        }\n        const description = this.createDivElement(DESCRIPTION_CLASS + '-row');\n        description.appendChild(this.renderTextBox(DESCRIPTION_CLASS));\n        description.querySelector('.' + DESCRIPTION_CLASS).setAttribute('title', this.parent.editorTitles.description);\n        parentDiv.appendChild(description);\n        const submit = createElement('button', { attrs: { type: 'hidden', title: 'submit', style: 'display:none' } });\n        parentDiv.appendChild(submit);\n        return parentDiv;\n    }\n    createRecurrenceEditor(parentDiv) {\n        const recurrenceEditor = this.createDivElement();\n        parentDiv.appendChild(recurrenceEditor);\n        this.recurrenceEditor = this.renderRecurrenceEditor();\n        this.recurrenceEditor.appendTo(recurrenceEditor);\n        this.updateMinMaxDateToEditor();\n    }\n    createDivElement(className) {\n        return createElement('div', { className: className });\n    }\n    createInputElement(className, fieldName, type) {\n        return createElement(type || 'input', {\n            className: className, attrs: {\n                type: 'text', name: fieldName, value: '', id: fieldName,\n                title: ((this.l10n.getConstant(fieldName.charAt(0).toLowerCase() + fieldName.slice(1))) === '') ?\n                    fieldName : this.l10n.getConstant(fieldName.charAt(0).toLowerCase() + fieldName.slice(1))\n            }\n        });\n    }\n    getSlotDuration() {\n        return this.parent.activeViewOptions.timeScale.interval / this.parent.activeViewOptions.timeScale.slotCount;\n    }\n    renderDateTimePicker(value, changeEvent) {\n        const dateTimeDiv = this.createDivElement(value + '-container');\n        const fieldName = this.getFieldName(value);\n        const dateTimeInput = this.createInputElement(value + ' ' + EVENT_FIELD$1, fieldName);\n        dateTimeDiv.appendChild(dateTimeInput);\n        const dateTimePicker = new DateTimePicker({\n            change: changeEvent,\n            firstDayOfWeek: this.parent.activeViewOptions.firstDayOfWeek,\n            calendarMode: this.parent.calendarMode,\n            min: this.parent.minDate,\n            max: new Date(new Date(+this.parent.maxDate).setHours(23, 59, 59)),\n            cssClass: this.parent.cssClass,\n            enableRtl: this.parent.enableRtl,\n            locale: this.parent.locale,\n            floatLabelType: 'Always',\n            timeFormat: this.parent.activeViewOptions.timeFormat,\n            format: (isNullOrUndefined(this.parent.dateFormat) ?\n                this.getFormat('dateFormats') : this.parent.dateFormat) + ' ' + this.parent.activeViewOptions.timeFormat,\n            placeholder: this.getFieldLabel(value),\n            step: this.getSlotDuration(),\n            width: '100%'\n        });\n        dateTimePicker.appendTo(dateTimeInput);\n        return dateTimeDiv;\n    }\n    refreshDateTimePicker(duration) {\n        const elementSelector = '.' + EVENT_WINDOW_START_CLASS + ',.' + EVENT_WINDOW_END_CLASS;\n        const startEndElement = [].slice.call(this.element.querySelectorAll(elementSelector));\n        for (const element of startEndElement) {\n            const instance = element.ej2_instances[0];\n            instance.firstDayOfWeek = this.parent.activeViewOptions.firstDayOfWeek;\n            instance.timeFormat = this.parent.activeViewOptions.timeFormat;\n            instance.step = duration || this.getSlotDuration();\n            instance.dataBind();\n        }\n    }\n    onTimeChange() {\n        const startObj = this.getInstance(EVENT_WINDOW_START_CLASS);\n        if (startObj.element.parentElement.classList.contains('e-input-focus')) {\n            const endObj = this.getInstance(EVENT_WINDOW_END_CLASS);\n            let duration = 0;\n            if (this.cellClickAction) {\n                duration = MS_PER_MINUTE * this.duration;\n                this.eventWindowTime.startTime = startObj.value;\n            }\n            else {\n                duration = this.eventData[this.fields.endTime].getTime() - this.eventData[this.fields.startTime].getTime();\n            }\n            const endDate = (isNullOrUndefined(startObj.value)) ? null : new Date(startObj.value.getTime() + duration);\n            if (this.cellClickAction) {\n                this.eventWindowTime.endTime = endDate;\n            }\n            endObj.value = endDate;\n            endObj.dataBind();\n        }\n        if (this.recurrenceEditor) {\n            this.recurrenceEditor.updateRuleUntilDate(this.eventWindowTime.startTime);\n        }\n    }\n    renderResourceDetails(resourceData) {\n        const fieldName = resourceData.field;\n        const value = 'e-' + fieldName;\n        const labelValue = resourceData.title;\n        const resourceDiv = this.createDivElement(value + '-container' + ' ' + 'e-resources');\n        const resourceInput = this.createInputElement(value + ' ' + EVENT_FIELD$1, fieldName);\n        resourceDiv.appendChild(resourceInput);\n        const resourceTemplate = '<div class=\"e-resource-template\"><div class=\"e-resource-color\" style=\"background-color:${' +\n            resourceData.colorField + '}\"></div><div class=\"e-resource-text\">${' + resourceData.textField + '}</div></div>';\n        if (resourceData.allowMultiple) {\n            const listObj = new MultiSelect({\n                enableRtl: this.parent.enableRtl,\n                cssClass: this.parent.cssClass || '',\n                dataSource: resourceData.dataSource,\n                change: this.onMultiselectResourceChange.bind(this),\n                itemTemplate: resourceTemplate,\n                fields: {\n                    text: resourceData.textField,\n                    value: resourceData.idField\n                },\n                htmlAttributes: { 'title': labelValue, 'name': fieldName },\n                floatLabelType: 'Always',\n                placeholder: labelValue,\n                popupHeight: '230px',\n                popupWidth: '447px',\n                mode: 'Box'\n            });\n            listObj.appendTo(resourceInput);\n        }\n        else {\n            const dropDownList = new DropDownList({\n                cssClass: this.parent.cssClass || '',\n                change: this.onDropdownResourceChange.bind(this),\n                dataSource: resourceData.dataSource,\n                enableRtl: this.parent.enableRtl,\n                fields: {\n                    text: resourceData.textField,\n                    value: resourceData.idField\n                },\n                htmlAttributes: { 'title': labelValue, 'name': fieldName },\n                floatLabelType: 'Always',\n                placeholder: labelValue,\n                popupHeight: '230px',\n                popupWidth: '447px',\n                itemTemplate: resourceTemplate\n            });\n            dropDownList.appendTo(resourceInput);\n        }\n        return resourceDiv;\n    }\n    renderDropDown(value) {\n        const fieldName = this.getFieldName(value);\n        const timezoneDiv = this.createDivElement(value + '-container');\n        const timezoneInput = this.createInputElement(value + ' ' + EVENT_FIELD$1, fieldName);\n        timezoneDiv.appendChild(timezoneInput);\n        const dropDownList = new DropDownList({\n            allowFiltering: true,\n            change: this.onTimezoneChange.bind(this),\n            cssClass: this.parent.cssClass || '',\n            dataSource: this.parent.timezoneDataSource,\n            enableRtl: this.parent.enableRtl,\n            fields: { text: 'Text', value: 'Value' },\n            filterBarPlaceholder: this.parent.localeObj.getConstant('searchTimezone'),\n            noRecordsTemplate: this.parent.localeObj.getConstant('noRecords'),\n            filtering: (e) => {\n                let query = new Query();\n                query = (e.text !== '') ? query.where('Text', 'contains', e.text, true) : query;\n                e.updateData(this.parent.timezoneDataSource, query);\n            },\n            htmlAttributes: { 'title': this.getFieldLabel(value), 'name': fieldName, role: 'option' },\n            floatLabelType: 'Always',\n            placeholder: this.getFieldLabel(value),\n            popupHeight: '230px'\n        });\n        dropDownList.appendTo(timezoneInput);\n        return timezoneDiv;\n    }\n    onMultiselectResourceChange(args) {\n        if (!args.value || !this.parent.activeViewOptions.group.byGroupID || this.parent.resourceCollection.length <= 1) {\n            return;\n        }\n        const resourceCollection = this.parent.resourceBase.resourceCollection;\n        const fieldName = args.element.getAttribute('name') || this.getColumnName(args.element);\n        for (let i = 0; i < resourceCollection.length; i++) {\n            if (resourceCollection[i].field === fieldName && i < resourceCollection.length - 1) {\n                const resObject = this.createInstance(i);\n                let datasource = [];\n                for (let j = 0; j < args.value.length; j++) {\n                    const resourceModel = resourceCollection[i + 1];\n                    // eslint-disable-next-line max-len\n                    const filter = resourceModel.dataSource.filter((data) => data[resourceModel.groupIDField] === args.value[j])[0];\n                    const groupId = filter[resourceCollection[i + 1].groupIDField];\n                    const filterRes = this.filterDatasource(i, groupId);\n                    datasource = datasource.concat(filterRes);\n                }\n                resObject.dataSource = datasource;\n                resObject.dataBind();\n            }\n        }\n    }\n    createInstance(index) {\n        const resourceData = this.parent.resourceBase.resourceCollection[index + 1];\n        const resObject = this.element.querySelector('.e-' + resourceData.field).\n            ej2_instances[0];\n        return resObject;\n    }\n    onDropdownResourceChange(args) {\n        if (!args.value || this.parent.resourceCollection.length <= 1 || !this.parent.activeViewOptions.group.byGroupID) {\n            return;\n        }\n        const fieldName = args.element.getAttribute('name') || this.getColumnName(args.element);\n        const resourceCollection = this.parent.resourceBase.resourceCollection;\n        for (let i = 0; i < resourceCollection.length; i++) {\n            if ((i < resourceCollection.length - 1) && resourceCollection[i].field === fieldName) {\n                const resObj = this.createInstance(i);\n                const groupId = args.itemData[resourceCollection[i].idField];\n                resObj.dataSource = this.filterDatasource(i, groupId);\n                resObj.dataBind();\n                const resValue = resObj.dataSource[0][resourceCollection[i + 1].idField];\n                resObj.value = (resourceCollection[i + 1].allowMultiple) ? [resValue] : resValue;\n                resObj.dataBind();\n            }\n        }\n    }\n    filterDatasource(index, groupId) {\n        const resourceData = this.parent.resourceBase.resourceCollection[index + 1];\n        return resourceData.dataSource.filter((data) => data[resourceData.groupIDField] === groupId);\n    }\n    onTimezoneChange(args) {\n        const fieldName = args.element.getAttribute('name') || this.getColumnName(args.element);\n        if (fieldName === this.parent.eventFields.startTimezone) {\n            const startTimezoneObj = this.getInstance(EVENT_WINDOW_START_TZ_CLASS);\n            const endTimezoneObj = this.getInstance(EVENT_WINDOW_END_TZ_CLASS);\n            endTimezoneObj.value = startTimezoneObj.value;\n            endTimezoneObj.dataBind();\n        }\n    }\n    renderCheckBox(value) {\n        const checkBoxDiv = this.createDivElement(value + '-container');\n        const fieldName = this.getFieldName(value);\n        const checkBoxInput = this.createInputElement(value + ' ' + EVENT_FIELD$1, fieldName);\n        checkBoxDiv.appendChild(checkBoxInput);\n        const checkBox = new CheckBox({\n            change: this.onChange.bind(this),\n            cssClass: value + ' ' + this.parent.cssClass,\n            enableRtl: this.parent.enableRtl,\n            label: this.getFieldLabel(value)\n        });\n        checkBox.appendTo(checkBoxInput);\n        checkBoxInput.setAttribute('name', fieldName);\n        if (fieldName === 'Repeat') {\n            this.repeatStatus = checkBox;\n        }\n        return checkBoxDiv;\n    }\n    renderTextBox(value) {\n        const textBoxDiv = this.createDivElement(value + '-container');\n        const fieldName = this.getFieldName(value);\n        const elementType = (value === DESCRIPTION_CLASS) ? 'textarea' : 'input';\n        const textBoxInput = this.createInputElement(value + ' ' + EVENT_FIELD$1, fieldName, elementType);\n        textBoxDiv.appendChild(textBoxInput);\n        Input.createInput({\n            element: textBoxInput,\n            floatLabelType: 'Always',\n            properties: {\n                enableRtl: this.parent.enableRtl,\n                placeholder: this.getFieldLabel(value)\n            }\n        });\n        return textBoxDiv;\n    }\n    getFieldName(name) {\n        let fieldName = '';\n        switch (name) {\n            case SUBJECT_CLASS:\n                fieldName = this.fields.subject;\n                break;\n            case LOCATION_CLASS:\n                fieldName = this.fields.location;\n                break;\n            case EVENT_WINDOW_START_CLASS:\n                fieldName = this.fields.startTime;\n                break;\n            case EVENT_WINDOW_END_CLASS:\n                fieldName = this.fields.endTime;\n                break;\n            case DESCRIPTION_CLASS:\n                fieldName = this.fields.description;\n                break;\n            case EVENT_WINDOW_ALL_DAY_CLASS:\n                fieldName = this.fields.isAllDay;\n                break;\n            case EVENT_WINDOW_START_TZ_CLASS:\n                fieldName = this.fields.startTimezone;\n                break;\n            case EVENT_WINDOW_END_TZ_CLASS:\n                fieldName = this.fields.endTimezone;\n                break;\n            case TIME_ZONE_CLASS:\n                fieldName = 'Timezone';\n                break;\n            case EVENT_WINDOW_REPEAT_CLASS:\n                fieldName = 'Repeat';\n                break;\n        }\n        return fieldName;\n    }\n    getFieldLabel(fieldName) {\n        let labelText = '';\n        switch (fieldName) {\n            case SUBJECT_CLASS:\n                labelText = this.parent.editorTitles.subject;\n                break;\n            case LOCATION_CLASS:\n                labelText = this.parent.editorTitles.location;\n                break;\n            case DESCRIPTION_CLASS:\n                labelText = this.parent.editorTitles.description;\n                break;\n            case EVENT_WINDOW_START_CLASS:\n                labelText = this.parent.editorTitles.startTime;\n                break;\n            case EVENT_WINDOW_END_CLASS:\n                labelText = this.parent.editorTitles.endTime;\n                break;\n            case EVENT_WINDOW_START_TZ_CLASS:\n                labelText = this.parent.editorTitles.startTimezone;\n                break;\n            case EVENT_WINDOW_END_TZ_CLASS:\n                labelText = this.parent.editorTitles.endTimezone;\n                break;\n            case EVENT_WINDOW_REPEAT_CLASS:\n                labelText = this.parent.editorTitles.recurrenceRule;\n                break;\n            case EVENT_WINDOW_ALL_DAY_CLASS:\n                labelText = this.parent.editorTitles.isAllDay;\n                break;\n            case TIME_ZONE_CLASS:\n                labelText = this.l10n.getConstant('timezone');\n                break;\n        }\n        return labelText;\n    }\n    onChange(args) {\n        const targetSelector = `.${EVENT_WINDOW_ALL_DAY_CLASS},.${TIME_ZONE_CLASS},.${EVENT_WINDOW_REPEAT_CLASS}`;\n        const target = closest(args.event.target, targetSelector);\n        if (target.classList.contains(EVENT_WINDOW_ALL_DAY_CLASS)) {\n            this.onAllDayChange(args.checked);\n        }\n        else if (target.classList.contains(TIME_ZONE_CLASS)) {\n            this.timezoneChangeStyle(args.checked);\n        }\n        else if (target.classList.contains(EVENT_WINDOW_REPEAT_CLASS)) {\n            this.onRepeatChange(args.checked);\n        }\n    }\n    renderRepeatDialog() {\n        const element = createElement('div');\n        this.repeatDialogObject = new Dialog({\n            header: this.l10n.getConstant('recurrence'),\n            visible: false,\n            content: '<div class=\"e-rec-editor\"></div>',\n            closeOnEscape: true,\n            width: '90%',\n            buttons: [{\n                    click: this.repeatSaveDialog.bind(this),\n                    buttonModel: { content: this.l10n.getConstant('save'), cssClass: 'e-save', isPrimary: true }\n                },\n                { click: this.repeatCancelDialog.bind(this), buttonModel: { cssClass: 'e-cancel', content: this.l10n.getConstant('cancel') } }],\n            target: this.element,\n            animationSettings: { effect: 'Zoom' },\n            enableRtl: this.parent.enableRtl,\n            isModal: true,\n            cssClass: REPEAT_DIALOG_CLASS,\n            open: this.repeatOpenDialog.bind(this)\n        });\n        this.element.appendChild(element);\n        this.repeatDialogObject.appendTo(element);\n        this.createRecurrenceEditor(this.repeatDialogObject.element.querySelector('.e-rec-editor'));\n    }\n    loadRecurrenceEditor() {\n        this.repeatDialogObject.show();\n        if (this.recurrenceEditor && this.repeatRule) {\n            this.recurrenceEditor.setRecurrenceRule(this.repeatRule);\n        }\n    }\n    onRepeatChange(state) {\n        if (state) {\n            if (!this.repeatDialogObject) {\n                this.renderRepeatDialog();\n            }\n            this.recurrenceEditor.setProperties({ startDate: this.repeatStartDate, selectedType: 0 });\n            this.loadRecurrenceEditor();\n        }\n        else {\n            if (this.repeatDialogObject) {\n                this.repeatDialogObject.hide();\n            }\n            this.repeatRule = '';\n            if (this.recurrenceEditor) {\n                this.recurrenceEditor.setRecurrenceRule(this.repeatRule);\n                this.updateRepeatLabel(this.repeatRule);\n            }\n            const element = this.element.querySelector('.' + REPEAT_CONTAINER_CLASS);\n            addClass([element], HIDE_STYLE_CLASS);\n        }\n    }\n    repeatSaveDialog() {\n        this.repeatRule = this.recurrenceEditor.getRecurrenceRule();\n        const element = this.element.querySelector('.' + REPEAT_CONTAINER_CLASS);\n        if (this.recurrenceEditor.getRecurrenceRule()) {\n            removeClass([element], HIDE_STYLE_CLASS);\n        }\n        else {\n            addClass([element], HIDE_STYLE_CLASS);\n            this.repeatStatus.setProperties({ checked: false });\n        }\n        this.updateRepeatLabel(this.repeatRule);\n        this.closeRepeatDialog();\n    }\n    closeRepeatDialog() {\n        this.repeatDialogObject.hide();\n    }\n    repeatCancelDialog() {\n        this.closeRepeatDialog();\n        if (this.recurrenceEditor) {\n            this.recurrenceEditor.setRecurrenceRule(this.repeatTempRule);\n        }\n        if (!this.repeatTempRule) {\n            this.repeatStatus.setProperties({ checked: false });\n        }\n    }\n    repeatOpenDialog() {\n        this.repeatTempRule = this.recurrenceEditor.getRecurrenceRule();\n    }\n    onCellDetailsUpdate(eventObj, repeatType) {\n        if (!this.parent.eventSettings.allowAdding) {\n            return;\n        }\n        this.element.querySelector('.' + FORM_CLASS).removeAttribute('data-id');\n        this.element.querySelector('.' + EVENT_WINDOW_TITLE_TEXT_CLASS).innerHTML = this.l10n.getConstant('newEvent');\n        eventObj.Timezone = false;\n        this.repeatStartDate = eventObj[this.fields.startTime];\n        this.repeatRule = '';\n        if (!isNullOrUndefined(this.parent.eventSettings.fields.subject.default)) {\n            eventObj[this.fields.subject] = this.parent.eventSettings.fields.subject.default;\n        }\n        if (!isNullOrUndefined(this.parent.eventSettings.fields.location.default)) {\n            eventObj[this.fields.location] = this.parent.eventSettings.fields.location.default;\n        }\n        if (!isNullOrUndefined(this.parent.eventSettings.fields.description.default)) {\n            eventObj[this.fields.description] = this.parent.eventSettings.fields.description.default;\n        }\n        this.showDetails(eventObj);\n        if (eventObj[this.fields.recurrenceRule] && this.recurrenceEditor) {\n            this.recurrenceEditor.setRecurrenceRule(eventObj[this.fields.recurrenceRule], eventObj[this.fields.startTime]);\n            this.repeatRule = eventObj[this.fields.recurrenceRule];\n        }\n        const deleteButton = this.element.querySelector('.' + DELETE_EVENT_CLASS);\n        if (deleteButton) {\n            addClass([deleteButton], DISABLE_CLASS);\n        }\n        if (this.recurrenceEditor) {\n            this.recurrenceEditor.setProperties({\n                startDate: eventObj[this.fields.startTime],\n                selectedType: !isNullOrUndefined(repeatType) ? repeatType : !isNullOrUndefined(eventObj[this.fields.recurrenceRule]) ?\n                    this.recurrenceEditor.selectedType : 0\n            });\n        }\n        if (this.parent.isAdaptive && isNullOrUndefined(this.parent.editorTemplate)) {\n            const element = this.element.querySelector('.' + REPEAT_CONTAINER_CLASS);\n            addClass([element], HIDE_STYLE_CLASS);\n            this.updateRepeatLabel(this.repeatRule);\n        }\n        else {\n            const saveButton = this.element.querySelector('.' + EVENT_WINDOW_SAVE_BUTTON_CLASS);\n            this.disableButton(saveButton, false);\n        }\n        this.dialogObject.show();\n    }\n    convertToEventData(cellsData, eventObj) {\n        if (cellsData.subject) {\n            eventObj[this.fields.subject] = cellsData.subject;\n        }\n        eventObj[this.fields.startTime] = cellsData.startTime;\n        eventObj[this.fields.endTime] = cellsData.endTime;\n        eventObj[this.fields.isAllDay] = cellsData.isAllDay;\n        if (cellsData.RecurrenceRule) {\n            eventObj[this.fields.recurrenceRule] = cellsData.RecurrenceRule;\n        }\n        if (this.parent.resourceCollection.length > 0 || this.parent.activeViewOptions.group.resources.length > 0) {\n            this.parent.resourceBase.setResourceValues(eventObj);\n        }\n    }\n    applyFormValidation() {\n        const getValidationRule = (rules) => (rules && Object.keys(rules).length > 0) ? rules : undefined;\n        const form = this.element.querySelector('.' + FORM_CLASS);\n        const rules = {};\n        rules[this.parent.eventSettings.fields.subject.name] = getValidationRule(this.parent.eventSettings.fields.subject.validation);\n        rules[this.parent.eventSettings.fields.location.name] = getValidationRule(this.parent.eventSettings.fields.location.validation);\n        rules[this.parent.eventSettings.fields.startTime.name] = getValidationRule(this.parent.eventSettings.fields.startTime.validation);\n        rules[this.parent.eventSettings.fields.endTime.name] = getValidationRule(this.parent.eventSettings.fields.endTime.validation);\n        rules[this.parent.eventSettings.fields.description.name] =\n            getValidationRule(this.parent.eventSettings.fields.description.validation);\n        this.fieldValidator = new FieldValidator();\n        this.fieldValidator.renderFormValidator(form, rules, this.element, this.parent.locale);\n    }\n    showDetails(eventData) {\n        const eventObj = extend({}, eventData, null, true);\n        if ((!this.cellClickAction || this.cellClickAction && !isNullOrUndefined(this.parent.editorTemplate)) &&\n            eventObj[this.fields.endTime].getHours() === 0 && eventObj[this.fields.endTime].getMinutes() === 0) {\n            this.trimAllDay(eventObj);\n        }\n        this.eventData = eventObj;\n        const formElements = this.getFormElements(EVENT_WINDOW_DIALOG_CLASS);\n        const keyNames = Object.keys(eventObj);\n        for (const curElement of formElements) {\n            const columnName = curElement.name || this.getColumnName(curElement);\n            if (!isNullOrUndefined(columnName) && columnName !== '') {\n                if (keyNames.indexOf(columnName) !== -1) {\n                    this.setValueToElement(curElement, eventObj[columnName]);\n                }\n                else {\n                    this.setDefaultValueToElement(curElement);\n                }\n            }\n        }\n        if (isNullOrUndefined(this.parent.editorTemplate)) {\n            this.onAllDayChange(eventObj[this.fields.isAllDay]);\n            const timezoneObj = this.getInstance(TIME_ZONE_CLASS + '.' + EVENT_FIELD$1);\n            if (!(isNullOrUndefined(eventObj[this.fields.startTimezone]) && isNullOrUndefined(eventObj[this.fields.endTimezone]))) {\n                timezoneObj.checked = true;\n                timezoneObj.dataBind();\n            }\n            this.timezoneChangeStyle(timezoneObj.checked);\n            delete eventObj.Timezone;\n        }\n    }\n    getColumnName(element) {\n        let attrName = element.getAttribute('data-name') || '';\n        if (attrName === '') {\n            let isDropDowns = false;\n            let fieldSelector = '';\n            if (element.classList.contains('e-dropdownlist')) {\n                fieldSelector = 'e-ddl';\n                isDropDowns = true;\n            }\n            else if (element.classList.contains('e-multiselect')) {\n                fieldSelector = 'e-multiselect';\n                isDropDowns = true;\n            }\n            else if (element.classList.contains('e-datetimepicker')) {\n                fieldSelector = 'e-datetimepicker';\n            }\n            else if (element.classList.contains('e-datepicker')) {\n                fieldSelector = 'e-datepicker';\n            }\n            else if (element.classList.contains('e-checkbox')) {\n                fieldSelector = 'e-checkbox';\n            }\n            const classSelector = isDropDowns ? `.${fieldSelector}:not(.e-control)` : `.${fieldSelector}`;\n            const control = closest(element, classSelector) || element.querySelector(`.${fieldSelector}`);\n            if (control) {\n                const attrEle = control.querySelector('[name]');\n                if (attrEle) {\n                    attrName = attrEle.name;\n                }\n            }\n        }\n        return attrName;\n    }\n    onAllDayChange(allDayStatus) {\n        const startObj = this.getInstance(EVENT_WINDOW_START_CLASS);\n        const endObj = this.getInstance(EVENT_WINDOW_END_CLASS);\n        const timezoneDiv = this.element.querySelector('.e-time-zone-container');\n        let format;\n        if (allDayStatus) {\n            format = (isNullOrUndefined(this.parent.dateFormat)) ? this.getFormat('dateFormats') : this.parent.dateFormat;\n            addClass(this.element.querySelectorAll('.e-time-icon'), EVENT_WINDOW_ICON_DISABLE_CLASS);\n            addClass([timezoneDiv], DISABLE_CLASS);\n            if (this.element.querySelector('.' + EVENT_WINDOW_TIME_ZONE_DIV_CLASS)) {\n                removeClass([this.element.querySelector('.' + EVENT_WINDOW_TIME_ZONE_DIV_CLASS)], ENABLE_CLASS);\n            }\n            startObj.format = endObj.format = format;\n        }\n        else {\n            format = (isNullOrUndefined(this.parent.dateFormat)) ? this.getFormat('dateFormats') + ' ' +\n                this.parent.activeViewOptions.timeFormat : this.parent.dateFormat + ' ' + this.parent.activeViewOptions.timeFormat;\n            removeClass(this.element.querySelectorAll('.e-time-icon'), EVENT_WINDOW_ICON_DISABLE_CLASS);\n            removeClass([timezoneDiv], DISABLE_CLASS);\n            if (this.element.querySelector('.e-checkbox-wrapper .e-time-zone').checked) {\n                addClass([this.element.querySelector('.' + EVENT_WINDOW_TIME_ZONE_DIV_CLASS)], ENABLE_CLASS);\n            }\n            startObj.format = endObj.format = format;\n        }\n        if (this.cellClickAction) {\n            this.updateDateTime(allDayStatus, startObj, endObj);\n        }\n        startObj.dataBind();\n        endObj.dataBind();\n        if (!isNullOrUndefined(this.recurrenceEditor)) {\n            this.recurrenceEditor.updateRuleUntilDate(startObj.value);\n        }\n    }\n    updateDateTime(allDayStatus, startObj, endObj) {\n        let startDate;\n        let endDate;\n        if (allDayStatus) {\n            startDate = resetTime(new Date(this.eventWindowTime.startTime.getTime()));\n            if (this.parent.activeCellsData.isAllDay) {\n                const temp = addDays(new Date(this.eventWindowTime.endTime.getTime()), -1).getTime();\n                endDate = (+this.eventWindowTime.startTime > temp) ? this.eventWindowTime.endTime : new Date(temp);\n            }\n            else {\n                endDate = resetTime(new Date(this.eventWindowTime.endTime.getTime()));\n            }\n        }\n        else {\n            const start = this.parent.activeCellsData.startTime;\n            startDate = new Date(this.eventWindowTime.startTime.getTime());\n            startDate.setHours(start.getHours(), start.getMinutes(), start.getSeconds());\n            if (this.parent.activeCellsData.isAllDay) {\n                const startHour = this.parent.getStartEndTime(this.parent.workHours.start);\n                startDate.setHours(startHour.getHours(), startHour.getMinutes(), startHour.getSeconds());\n                endDate = new Date(startDate.getTime());\n                endDate.setMilliseconds(MS_PER_MINUTE * this.getSlotDuration());\n            }\n            else {\n                endDate = new Date(startDate.getTime());\n                endDate.setMilliseconds(this.parent.activeCellsData.endTime.getTime() - this.parent.activeCellsData.startTime.getTime());\n            }\n        }\n        this.eventWindowTime = { startTime: new Date(startDate.getTime()), endTime: new Date(endDate.getTime()) };\n        startObj.value = startDate;\n        endObj.value = endDate;\n        startObj.dataBind();\n        endObj.dataBind();\n    }\n    getFormat(formatType) {\n        let format;\n        if (this.parent.locale === 'en' || this.parent.locale === 'en-US') {\n            format = getValue(formatType + '.short', getDefaultDateObject(this.parent.getCalendarMode()));\n        }\n        else {\n            format = getValue(`main.${this.parent.locale}.dates.calendars.${this.parent.getCalendarMode()}.${formatType}.short`, cldrData);\n        }\n        return format;\n    }\n    onEventDetailsUpdate(eventObj) {\n        if (!this.parent.eventSettings.allowEditing) {\n            return;\n        }\n        if (!this.parent.isAdaptive) {\n            removeClass([this.element.querySelector('.' + DELETE_EVENT_CLASS)], DISABLE_CLASS);\n        }\n        this.element.querySelector('.' + EVENT_WINDOW_TITLE_TEXT_CLASS).innerHTML = this.l10n.getConstant('editEvent');\n        this.element.querySelector('.' + FORM_CLASS).setAttribute('data-id', eventObj[this.fields.id].toString());\n        if (isNullOrUndefined(this.parent.editorTemplate)) {\n            eventObj = extend({}, eventObj, null, true);\n            const timezoneObj = this.getInstance(TIME_ZONE_CLASS + '.' + EVENT_FIELD$1);\n            let timezoneValue;\n            if (eventObj[this.fields.startTimezone] || eventObj[this.fields.endTimezone]) {\n                timezoneValue = true;\n                this.parent.eventBase.timezoneConvert(eventObj);\n            }\n            else {\n                timezoneValue = false;\n            }\n            eventObj.Timezone = timezoneValue;\n            timezoneObj.checked = timezoneValue;\n            timezoneObj.dataBind();\n        }\n        this.showDetails(eventObj);\n        if (eventObj[this.fields.recurrenceRule] && this.recurrenceEditor) {\n            this.recurrenceEditor.setRecurrenceRule(eventObj[this.fields.recurrenceRule], eventObj[this.fields.startTime]);\n        }\n        else if (!this.parent.isAdaptive && this.recurrenceEditor) {\n            this.recurrenceEditor.setProperties({ startDate: eventObj[this.fields.startTime] });\n            this.recurrenceEditor.setRecurrenceRule('');\n        }\n        this.repeatStartDate = eventObj[this.fields.startTime];\n        this.repeatRule = '';\n        if (eventObj[this.fields.recurrenceRule]) {\n            if (this.recurrenceEditor) {\n                this.recurrenceEditor.setRecurrenceRule(eventObj[this.fields.recurrenceRule], eventObj[this.fields.startTime]);\n            }\n            this.repeatRule = eventObj[this.fields.recurrenceRule];\n        }\n        if (this.parent.isAdaptive && isNullOrUndefined(this.parent.editorTemplate)) {\n            const element = this.element.querySelector('.' + REPEAT_CONTAINER_CLASS);\n            if (eventObj[this.fields.recurrenceRule]) {\n                removeClass([element], HIDE_STYLE_CLASS);\n                this.repeatStatus.setProperties({ checked: true });\n            }\n            else {\n                addClass([element], HIDE_STYLE_CLASS);\n                this.repeatStatus.setProperties({ checked: false });\n            }\n            this.updateRepeatLabel(this.repeatRule);\n        }\n        const isDisable = (this.parent.readonly || eventObj[this.fields.isReadonly]);\n        if (!this.parent.isAdaptive) {\n            const saveButton = this.element.querySelector('.' + EVENT_WINDOW_SAVE_BUTTON_CLASS);\n            const deleteButton = this.element.querySelector('.' + DELETE_EVENT_CLASS);\n            this.disableButton(saveButton, isDisable);\n            this.disableButton(deleteButton, isDisable);\n        }\n        else {\n            const saveIcon = this.element.querySelector('.' + EVENT_WINDOW_SAVE_ICON_CLASS);\n            if (saveIcon) {\n                if (isDisable) {\n                    addClass([saveIcon], ICON_DISABLE_CLASS);\n                }\n                else {\n                    removeClass([saveIcon], ICON_DISABLE_CLASS);\n                }\n            }\n        }\n        this.dialogObject.show();\n    }\n    disableButton(element, value) {\n        if (element) {\n            element.ej2_instances[0].disabled = value;\n        }\n    }\n    renderRecurrenceEditor() {\n        return new RecurrenceEditor({\n            calendarMode: this.parent.calendarMode,\n            cssClass: this.parent.cssClass,\n            dateFormat: this.parent.dateFormat,\n            enableRtl: this.parent.enableRtl,\n            firstDayOfWeek: this.parent.activeViewOptions.firstDayOfWeek,\n            locale: this.parent.locale\n        });\n    }\n    updateMinMaxDateToEditor() {\n        const startDate = this.element.querySelector('.e-start');\n        const endDate = this.element.querySelector('.e-end');\n        if (startDate && endDate) {\n            const startObj = startDate.ej2_instances[0];\n            const endObj = endDate.ej2_instances[0];\n            startObj.min = this.parent.minDate;\n            startObj.max = this.parent.maxDate;\n            endObj.min = this.parent.minDate;\n            endObj.max = this.parent.maxDate;\n            startObj.dataBind();\n            endObj.dataBind();\n        }\n        if (this.recurrenceEditor) {\n            const untilDate = this.recurrenceEditor.element.querySelector('.e-until-date');\n            if (untilDate) {\n                const untilObj = untilDate.ej2_instances[0];\n                untilObj.min = this.parent.minDate;\n                untilObj.max = this.parent.maxDate;\n                untilObj.dataBind();\n            }\n        }\n    }\n    updateRepeatLabel(repeatRule) {\n        if (this.parent.isAdaptive && !this.repeatDialogObject) {\n            this.renderRepeatDialog();\n        }\n        const data = repeatRule ?\n            (this.l10n.getConstant('repeats') + ' ' + this.recurrenceEditor.getRuleSummary(repeatRule)) : this.l10n.getConstant('repeat');\n        this.repeatStatus.setProperties({ label: data });\n    }\n    dialogClose(event) {\n        if (this.isEnterKey) {\n            this.isEnterKey = false;\n            return;\n        }\n        this.dialogEvent = event;\n        this.isCrudAction = false;\n        this.parent.activeEventData = { event: undefined, element: undefined };\n        this.parent.currentAction = null;\n        this.dialogObject.hide();\n    }\n    resetForm() {\n        this.fieldValidator.destroyToolTip();\n        this.resetFormFields();\n        if (!this.parent.isAdaptive && this.recurrenceEditor && !this.recurrenceEditor.isDestroyed) {\n            this.recurrenceEditor.resetFields();\n        }\n    }\n    timezoneChangeStyle(value) {\n        const timezoneDiv = this.element.querySelector('.' + EVENT_WINDOW_TIME_ZONE_DIV_CLASS);\n        const localTimezoneName = this.parent.tzModule.getLocalTimezoneName();\n        if (value) {\n            addClass([timezoneDiv], ENABLE_CLASS);\n            const startTimezoneObj = this.getInstance(EVENT_WINDOW_START_TZ_CLASS);\n            const endTimezoneObj = this.getInstance(EVENT_WINDOW_END_TZ_CLASS);\n            const timezone = startTimezoneObj.dataSource;\n            if (!startTimezoneObj.value || !this.parent.timezone) {\n                const found = timezone.some((tz) => { return tz.Value === localTimezoneName; });\n                if (!found) {\n                    timezone.push({ Value: localTimezoneName, Text: localTimezoneName });\n                    startTimezoneObj.dataSource = timezone;\n                    endTimezoneObj.dataSource = timezone;\n                    startTimezoneObj.dataBind();\n                    endTimezoneObj.dataBind();\n                }\n            }\n            startTimezoneObj.value = startTimezoneObj.value || this.parent.timezone || localTimezoneName;\n            endTimezoneObj.value = endTimezoneObj.value || this.parent.timezone || localTimezoneName;\n            startTimezoneObj.dataBind();\n            endTimezoneObj.dataBind();\n        }\n        else {\n            removeClass([timezoneDiv], ENABLE_CLASS);\n        }\n    }\n    resetFormFields() {\n        const formElement = this.getFormElements(EVENT_WINDOW_DIALOG_CLASS);\n        for (const currentElement of formElement) {\n            const columnName = currentElement.name || this.getColumnName(currentElement);\n            if (!isNullOrUndefined(columnName) && columnName !== '') {\n                this.setDefaultValueToElement(currentElement);\n            }\n        }\n    }\n    eventSave(event, alert) {\n        if (this.isEnterKey) {\n            this.isEnterKey = false;\n            return;\n        }\n        const formElement = this.element.querySelector('.' + FORM_CLASS);\n        if (formElement && formElement.classList.contains('e-formvalidator') &&\n            !formElement.ej2_instances[0].validate()) {\n            return;\n        }\n        const dataCollection = this.getEventDataFromEditor();\n        if (this.processEventValidation(dataCollection.tempData, alert)) {\n            return;\n        }\n        this.eventCrudData = dataCollection.eventData;\n        this.dialogEvent = event;\n        this.isCrudAction = true;\n        this.dialogObject.hide();\n    }\n    getEventDataFromEditor() {\n        const eventObj = extend({}, this.getObjectFromFormData(EVENT_WINDOW_DIALOG_CLASS));\n        if (!eventObj.Timezone) {\n            eventObj[this.fields.startTimezone] = null;\n            eventObj[this.fields.endTimezone] = null;\n        }\n        delete eventObj.Timezone;\n        delete eventObj.Repeat;\n        this.setDefaultValueToObject(eventObj);\n        eventObj[this.fields.recurrenceRule] = this.recurrenceEditor ? this.recurrenceEditor.getRecurrenceRule() || null : undefined;\n        const tempObj = extend({}, eventObj, null, true);\n        if (eventObj[this.fields.isAllDay]) {\n            eventObj[this.fields.startTime] = (isNullOrUndefined(eventObj[this.fields.startTime])) ? null\n                : resetTime(new Date(eventObj[this.fields.startTime].getTime()));\n            eventObj[this.fields.endTime] = (isNullOrUndefined(eventObj[this.fields.endTime])) ? null\n                : addDays(resetTime(new Date(eventObj[this.fields.endTime].getTime())), 1);\n        }\n        return { eventData: eventObj, tempData: tempObj };\n    }\n    processEventValidation(eventObj, alert) {\n        let alertType;\n        if (isNullOrUndefined(this.parent.editorTemplate)) {\n            if (!eventObj[this.fields.startTime] || !eventObj[this.fields.endTime]) {\n                this.parent.quickPopup.openValidationError('invalidDateError');\n                return true;\n            }\n            if (eventObj[this.fields.startTime] > eventObj[this.fields.endTime]) {\n                this.parent.quickPopup.openValidationError('startEndError');\n                return true;\n            }\n        }\n        if (this.recurrenceEditor && this.recurrenceEditor.value && this.recurrenceEditor.value !== '') {\n            alertType = this.recurrenceValidation(eventObj[this.fields.startTime], eventObj[this.fields.endTime], alert);\n            let isShowAlert = true;\n            if (alertType === 'seriesChangeAlert' && this.parent.uiStateValues.isIgnoreOccurrence) {\n                isShowAlert = false;\n            }\n            if (!isNullOrUndefined(alertType) && isShowAlert\n                && ((!this.parent.enableRecurrenceValidation && alertType === 'wrongPattern') || this.parent.enableRecurrenceValidation)) {\n                this.parent.quickPopup.openRecurrenceValidationAlert(alertType);\n                return true;\n            }\n        }\n        return false;\n    }\n    processCrudActions(eventObj) {\n        this.parent.uiStateValues.isBlock = false;\n        const resourceData = this.getResourceData(eventObj);\n        const isResourceEventExpand = (this.parent.activeViewOptions.group.resources.length > 0 ||\n            this.parent.resourceCollection.length > 0) && !this.parent.activeViewOptions.group.allowGroupEdit\n            && !isNullOrUndefined(resourceData);\n        const eventId = this.getEventIdFromForm();\n        if (!isNullOrUndefined(eventId)) {\n            let eveId = this.parent.eventBase.getEventIDType() === 'string' ? eventId : parseInt(eventId, 10);\n            let editedData = this.parent.eventsData.filter((data) => data[this.fields.id] === eveId)[0];\n            if (isNullOrUndefined(editedData)) {\n                editedData = this.parent.blockData.filter((data) => data[this.fields.id] === eveId)[0];\n            }\n            eventObj = extend({}, editedData, eventObj);\n            if (eventObj[this.fields.isReadonly]) {\n                return false;\n            }\n            let currentAction;\n            if (!isNullOrUndefined(editedData[this.fields.recurrenceRule])) {\n                currentAction = this.parent.currentAction;\n                eventObj.Guid = this.parent.activeEventData.event.Guid;\n                if (this.parent.currentAction === 'EditOccurrence') {\n                    if (!eventObj[this.fields.recurrenceID]) {\n                        eventObj[this.fields.id] = this.parent.eventBase.getEventMaxID();\n                        eventObj.Guid = this.parent.activeEventData.event.Guid;\n                    }\n                    else {\n                        eveId = eventObj[this.fields.recurrenceID];\n                        currentAction = null;\n                    }\n                    if (this.parent.enableRecurrenceValidation && this.editOccurrenceValidation(eveId, eventObj)) {\n                        return true;\n                    }\n                }\n                if (this.parent.currentAction === 'EditSeries' || eventObj[this.fields.id] !== editedData[this.fields.id]) {\n                    eventObj[this.fields.recurrenceID] = editedData[this.fields.id];\n                }\n                else if (this.parent.currentAction === 'EditFollowingEvents') {\n                    eventObj[this.fields.id] = this.parent.eventBase.getEventMaxID();\n                    eventObj[this.fields.followingID] = editedData[this.fields.id];\n                }\n            }\n            if (isResourceEventExpand) {\n                this.resourceSaveEvent(eventObj, 'Save', currentAction);\n            }\n            else {\n                this.parent.saveEvent(eventObj, currentAction);\n            }\n        }\n        else {\n            this.parent.currentAction = 'Add';\n            if (isResourceEventExpand) {\n                this.resourceSaveEvent(eventObj, this.parent.currentAction);\n            }\n            else {\n                eventObj[this.fields.id] = this.parent.eventBase.getEventMaxID();\n                this.parent.addEvent(eventObj);\n            }\n        }\n        return this.parent.uiStateValues.isBlock;\n    }\n    getResourceData(eventObj) {\n        let resourceData = null;\n        if (!isNullOrUndefined(this.parent.resourceBase) && !isNullOrUndefined(this.parent.resourceBase.resourceCollection)\n            && this.parent.resourceBase.resourceCollection.length > 0) {\n            const lastResourceData = this.parent.resourceBase.resourceCollection.slice(-1)[0];\n            resourceData = eventObj[lastResourceData.field];\n        }\n        return resourceData;\n    }\n    getObjectFromFormData(className) {\n        const formElement = this.getFormElements(className);\n        const eventObj = {};\n        for (const currentElement of formElement) {\n            const columnName = currentElement.name || this.getColumnName(currentElement);\n            if (!isNullOrUndefined(columnName) && columnName !== '') {\n                eventObj[columnName] = this.getValueFromElement(currentElement);\n            }\n        }\n        return eventObj;\n    }\n    setDefaultValueToObject(eventObj) {\n        if (!isNullOrUndefined(eventObj[this.fields.subject])) {\n            eventObj[this.fields.subject] = eventObj[this.fields.subject] || this.parent.eventSettings.fields.subject.default\n                || this.l10n.getConstant('addTitle');\n        }\n        if (!isNullOrUndefined(eventObj[this.fields.location])) {\n            eventObj[this.fields.location] = eventObj[this.fields.location] || this.parent.eventSettings.fields.location.default;\n        }\n        if (!isNullOrUndefined(eventObj[this.fields.description])) {\n            eventObj[this.fields.description] = eventObj[this.fields.description] || this.parent.eventSettings.fields.description.default;\n        }\n    }\n    recurrenceValidation(startDate, endDate, alert) {\n        let alertMessage;\n        const recEditor = this.recurrenceEditor;\n        const interval = this.getInstance('e-repeat-interval.e-numerictextbox').value;\n        if (alert !== this.l10n.getConstant('ok')) {\n            const activeEvent = this.parent.activeEventData.event;\n            let excludedEvents = [];\n            if ((this.parent.currentAction === 'EditSeries' || this.parent.currentAction === 'EditFollowingEvents')\n                && !isNullOrUndefined(activeEvent)) {\n                const eventStartTime = activeEvent[this.parent.eventFields.startTime];\n                const seriesEvents = this.parent.eventBase.getSeriesEvents(this.eventData, eventStartTime);\n                if (seriesEvents.length > 0) {\n                    excludedEvents = this.parent.eventBase.getEditedOccurrences(seriesEvents, eventStartTime);\n                }\n                else {\n                    const event = this.parent.eventBase.getEventById(activeEvent[this.parent.eventFields.id]);\n                    excludedEvents = this.parent.eventBase.getEditedOccurrences([event], eventStartTime);\n                }\n                if (this.parent.currentAction === 'EditSeries'\n                    && !isNullOrUndefined(this.eventData[this.parent.eventFields.recurrenceException])) {\n                    excludedEvents.push(this.eventData);\n                }\n            }\n            if (excludedEvents.length > 0) {\n                alertMessage = 'seriesChangeAlert';\n            }\n            if (this.getInstance('e-end-on-left .e-ddl .e-dropdownlist').value === 'until' &&\n                this.getInstance('e-end-on-date .e-datepicker').value < startDate) {\n                alertMessage = 'wrongPattern';\n            }\n            if (isNullOrUndefined(alertMessage)) {\n                let types = recEditor.value.split(';')[1].split('=')[1].split(',');\n                const obj = { 'SU': 0, 'MO': 1, 'TU': 2, 'WE': 3, 'TH': 4, 'FR': 5, 'SA': 6 };\n                const temp = [];\n                const tempDiff = [];\n                let tempValue;\n                switch (recEditor.value.split(';')[0].split('=')[1]) {\n                    case 'DAILY':\n                        if ((((endDate.getTime() - startDate.getTime()) / (1000 * 3600)) > (interval * 24))) {\n                            alertMessage = 'createError';\n                        }\n                        break;\n                    case 'WEEKLY':\n                        types = recEditor.value.split(';')[1].split('=')[1].split(',');\n                        for (let index = 0; index < types.length * (interval + 1); index++) {\n                            temp[index] = (types.length > index) ? obj[types[index]] : temp[index - types.length] + (7 * interval);\n                        }\n                        tempValue = temp.sort((a, b) => a - b);\n                        for (let index = 1; index < tempValue.length; index++) {\n                            tempDiff.push(tempValue[index] - tempValue[index - 1]);\n                        }\n                        if ((((endDate.getTime() - startDate.getTime()) / (1000 * 3600)) >= Math.min(...tempDiff) * 24)\n                            || isNullOrUndefined(interval)) {\n                            alertMessage = 'createError';\n                        }\n                        break;\n                    case 'MONTHLY':\n                        if (endDate.getTime() >= new Date(+startDate).setMonth(startDate.getMonth() + interval)) {\n                            alertMessage = 'createError';\n                        }\n                        break;\n                    case 'YEARLY':\n                        if (endDate.getTime() >= new Date(+startDate).setFullYear(startDate.getFullYear() + interval)) {\n                            alertMessage = 'createError';\n                        }\n                        break;\n                }\n            }\n        }\n        else {\n            if (endDate.getTime() >= new Date(+startDate).setMonth(startDate.getMonth() + interval)) {\n                alertMessage = 'createError';\n            }\n            if (isNullOrUndefined(alertMessage)) {\n                this.parent.quickPopup.quickDialog.hide();\n            }\n        }\n        if (isNullOrUndefined(interval)) {\n            alertMessage = 'createError';\n        }\n        return alertMessage;\n    }\n    getRecurrenceIndex(recColl, event) {\n        let recIndex;\n        for (let index = 0; index < recColl.length; index++) {\n            if (event[this.fields.startTime].valueOf() === recColl[index][this.fields.startTime].valueOf()) {\n                recIndex = index;\n                break;\n            }\n        }\n        return recIndex;\n    }\n    trimAllDay(data) {\n        if (data[this.fields.isAllDay]) {\n            const temp = addDays(new Date(+data[this.fields.endTime]), -1).getTime();\n            data[this.fields.endTime] = (+data[this.fields.startTime] > temp) ? data[this.fields.endTime] : new Date(temp);\n        }\n    }\n    editOccurrenceValidation(eventId, currentData, editData) {\n        if (editData === void 0) {\n            editData = this.eventData;\n        }\n        const recurColl = this.parent.getOccurrencesByID(eventId);\n        const excludedDatas = this.parent.eventsData.filter((data) => data[this.fields.recurrenceID] === eventId);\n        excludedDatas.map((data) => recurColl.push(extend({}, data)));\n        currentData = extend({}, currentData);\n        this.trimAllDay(currentData);\n        for (const data of recurColl) {\n            this.trimAllDay(data);\n        }\n        this.parent.eventBase.sortByTime(recurColl);\n        const index = this.getRecurrenceIndex(recurColl, editData);\n        if (isNullOrUndefined(index)) {\n            return false;\n        }\n        if (index === 0) {\n            if (!isNullOrUndefined(recurColl[index + 1])) {\n                if (!(resetTime(new Date(+recurColl[index + 1][this.fields.startTime])).getTime() >\n                    resetTime(new Date(+currentData[this.fields.endTime])).getTime()) &&\n                    (resetTime(new Date(+recurColl[recurColl.length - 1][this.fields.endTime])).getTime() >=\n                        resetTime(new Date(+currentData[this.fields.startTime])).getTime())) {\n                    this.parent.quickPopup.openRecurrenceValidationAlert('sameDayAlert');\n                    return true;\n                }\n                else if (resetTime(new Date(+recurColl[recurColl.length - 1][this.fields.endTime])).getTime() <\n                    resetTime(new Date(+currentData[this.fields.startTime])).getTime()) {\n                    this.parent.quickPopup.openRecurrenceValidationAlert('occurrenceAlert');\n                    return true;\n                }\n            }\n            return false;\n        }\n        else {\n            if (index === recurColl.length - 1) {\n                if (!(resetTime(new Date(+recurColl[index - 1][this.fields.endTime])).getTime() <\n                    resetTime(new Date(+currentData[this.fields.startTime])).getTime()) &&\n                    (resetTime(new Date(+recurColl[(recurColl.length - 1) - index][this.fields.startTime])).getTime() <=\n                        resetTime(new Date(+currentData[this.fields.endTime])).getTime())) {\n                    this.parent.quickPopup.openRecurrenceValidationAlert('sameDayAlert');\n                    return true;\n                }\n                else if (resetTime(new Date(+recurColl[(recurColl.length - 1) - index][this.fields.endTime])).getTime() >\n                    resetTime(new Date(+currentData[this.fields.startTime])).getTime()) {\n                    this.parent.quickPopup.openRecurrenceValidationAlert('occurrenceAlert');\n                    return true;\n                }\n            }\n            else if (!(((resetTime(new Date(+recurColl[index - 1][this.fields.endTime])).getTime() <\n                resetTime(new Date(+currentData[this.fields.startTime])).getTime()) ||\n                (resetTime(new Date(+recurColl[0][this.fields.startTime])).getTime() >\n                    resetTime(new Date(+currentData[this.fields.startTime])).getTime())) &&\n                ((resetTime(new Date(+recurColl[index + 1][this.fields.startTime])).getTime() >\n                    resetTime(new Date(+currentData[this.fields.endTime])).getTime()) ||\n                    (resetTime(new Date(+recurColl[recurColl.length - 1][this.fields.endTime])).getTime() <\n                        resetTime(new Date(+currentData[this.fields.startTime])).getTime())))) {\n                this.parent.quickPopup.openRecurrenceValidationAlert('sameDayAlert');\n                return true;\n            }\n            else if ((resetTime(new Date(+recurColl[index + 1][this.fields.endTime])).getTime() <\n                resetTime(new Date(+currentData[this.fields.startTime])).getTime()) ||\n                (resetTime(new Date(+recurColl[index - 1][this.fields.startTime])).getTime() >\n                    resetTime(new Date(+currentData[this.fields.endTime])).getTime())) {\n                this.parent.quickPopup.openRecurrenceValidationAlert('occurrenceAlert');\n                return true;\n            }\n        }\n        return false;\n    }\n    resourceSaveEvent(eventObj, action, currentAction) {\n        const lastResourceData = this.parent.resourceBase.resourceCollection.slice(-1)[0];\n        let resourceData = eventObj[lastResourceData.field];\n        resourceData = (resourceData instanceof Array) ? resourceData : [resourceData];\n        const lastLevel = this.parent.resourceBase.lastResourceLevel;\n        const eventList = [];\n        for (let i = 0; i < resourceData.length; i++) {\n            const events = extend({}, eventObj, null, true);\n            events[this.fields.id] = this.parent.eventBase.getEventMaxID();\n            const temp = [];\n            const addValues = () => {\n                if (action === 'Save' && i === resourceData.length - 1) {\n                    if (temp.length > 0) {\n                        temp[0][this.fields.id] = eventObj[this.fields.id];\n                        for (let k = 1; k < temp.length; k++) {\n                            temp[k][this.fields.id] = this.parent.eventBase.getEventMaxID(i);\n                            eventList.push(temp[k]);\n                            this.parent.saveEvent(temp[0], currentAction);\n                        }\n                    }\n                    else {\n                        events[this.fields.id] = eventObj[this.fields.id];\n                        this.parent.saveEvent(events, currentAction);\n                    }\n                }\n                else {\n                    if (temp.length > 0) {\n                        for (let j = 0; j < temp.length; j++) {\n                            temp[j][this.fields.id] = this.parent.eventBase.getEventMaxID(j);\n                            eventList.push(temp[j]);\n                        }\n                    }\n                    else {\n                        events[this.fields.id] = this.parent.eventBase.getEventMaxID(i);\n                        eventList.push(events);\n                    }\n                }\n            };\n            if (this.parent.activeViewOptions.group.byGroupID && (!isNullOrUndefined(lastLevel))) {\n                const lastResource = lastResourceData.dataSource;\n                const resCol = this.parent.resourceCollection;\n                let index;\n                if (resCol.length > 1) {\n                    index = findIndexInData(lastResource, lastResourceData.idField, resourceData[i], events, resCol);\n                }\n                else {\n                    index = findIndexInData(lastResource, lastResourceData.idField, resourceData[i]);\n                }\n                if (index < 0) {\n                    return;\n                }\n                const groupId = lastResource[index][lastResourceData.groupIDField];\n                const filter = lastLevel.filter((obj) => obj.resourceData[lastResourceData.idField] === resourceData[i]).\n                    filter((obj) => obj.resourceData[lastResourceData.groupIDField] === groupId)[0];\n                const groupOrder = filter.groupOrder;\n                for (let index = 0; index < this.parent.resourceBase.resourceCollection.length; index++) {\n                    const field = this.parent.resourceBase.resourceCollection[index].field;\n                    events[field] = (groupOrder[index] instanceof Array) ? groupOrder[index][0] : groupOrder[index];\n                }\n                addValues();\n            }\n            else {\n                for (let index = 0; index < this.parent.resourceBase.resourceCollection.length - 1; index++) {\n                    const field = this.parent.resourceBase.resourceCollection[index].field;\n                    if (events[field] instanceof Array && events[field].length > 1) {\n                        for (let k = 0; k < events[field].length; k++) {\n                            const event = extend({}, events, null, true);\n                            event[field] = eventObj[field][k];\n                            event[lastResourceData.field] = resourceData[i];\n                            temp.push(event);\n                        }\n                    }\n                    else {\n                        if (temp.length === 0) {\n                            events[field] = (eventObj[field] instanceof Array) ?\n                                eventObj[field][0] : eventObj[field];\n                            events[lastResourceData.field] = resourceData[i];\n                        }\n                        else {\n                            for (let l = 0; l < temp.length; l++) {\n                                temp[l][field] = (eventObj[field] instanceof Array) ?\n                                    eventObj[field][0] : eventObj[field];\n                            }\n                        }\n                    }\n                }\n                events[lastResourceData.field] = resourceData[i];\n                addValues();\n            }\n        }\n        if (eventList.length > 0) {\n            for (const event of eventList) {\n                event[this.fields.recurrenceException] = null;\n                event[this.fields.recurrenceID] = null;\n            }\n            this.parent.addEvent(eventList);\n        }\n    }\n    getEventIdFromForm() {\n        return this.element.querySelector('.' + FORM_CLASS).getAttribute('data-id');\n    }\n    getFormElements(className) {\n        let elements = [];\n        if (className === EVENT_WINDOW_DIALOG_CLASS) {\n            elements = [].slice.call(this.element.querySelectorAll('.' + EVENT_FIELD$1));\n        }\n        else {\n            elements = [].slice.call(this.parent.element.querySelectorAll('.' + className + ' .' + EVENT_FIELD$1));\n        }\n        return elements;\n    }\n    getValueFromElement(element) {\n        let value;\n        if (element.classList.contains('e-datepicker')) {\n            value = element.ej2_instances[0].value;\n        }\n        else if (element.classList.contains('e-datetimepicker')) {\n            value = element.ej2_instances[0].value;\n        }\n        else if (element.classList.contains('e-dropdownlist')) {\n            value = element.ej2_instances[0].value;\n        }\n        else if (element.classList.contains('e-multiselect')) {\n            value = element.ej2_instances[0].value;\n        }\n        else if (element.classList.contains('e-checkbox')) {\n            value = element.ej2_instances[0].checked;\n        }\n        else {\n            if (element.type === 'checkbox') {\n                value = element.checked;\n            }\n            else {\n                value = SanitizeHtmlHelper.sanitize(element.value);\n            }\n        }\n        return value;\n    }\n    setValueToElement(element, value) {\n        if (element.classList.contains('e-datepicker')) {\n            const instance = element.ej2_instances[0];\n            instance.value = value;\n            instance.dataBind();\n        }\n        else if (element.classList.contains('e-datetimepicker')) {\n            const instance = element.ej2_instances[0];\n            if (instance.element.classList.contains(EVENT_WINDOW_START_CLASS)) {\n                this.eventWindowTime.startTime = new Date('' + value);\n            }\n            else {\n                this.eventWindowTime.endTime = new Date('' + value);\n            }\n            instance.value = value;\n            instance.dataBind();\n        }\n        else if (element.classList.contains('e-dropdownlist')) {\n            const instance = element.ej2_instances[0];\n            instance.value = value;\n            instance.dataBind();\n        }\n        else if (element.classList.contains('e-multiselect')) {\n            const instance = element.ej2_instances[0];\n            instance.value = [];\n            instance.value = ((value instanceof Array) ? value : [value]);\n            instance.dataBind();\n        }\n        else if (element.classList.contains('e-checkbox')) {\n            const instance = element.ej2_instances[0];\n            instance.checked = value;\n            instance.dataBind();\n        }\n        else {\n            if (element.type !== 'checkbox') {\n                element.value = value || '';\n            }\n            else {\n                element.checked = value;\n            }\n        }\n    }\n    setDefaultValueToElement(element) {\n        if (element.classList.contains('e-datepicker')) {\n            const instance = element.ej2_instances[0];\n            instance.value = this.parent.getCurrentTime();\n            instance.dataBind();\n        }\n        else if (element.classList.contains('e-datetimepicker')) {\n            const instance = element.ej2_instances[0];\n            const dateValue = this.parent.getCurrentTime();\n            this.eventWindowTime = { startTime: dateValue, endTime: dateValue };\n            instance.value = dateValue;\n            instance.dataBind();\n        }\n        else if (element.classList.contains('e-dropdownlist')) {\n            const instance = element.ej2_instances[0];\n            instance.value = null;\n            instance.dataBind();\n        }\n        else if (element.classList.contains('e-multiselect')) {\n            const instance = element.ej2_instances[0];\n            instance.value = [];\n            instance.dataBind();\n        }\n        else if (element.classList.contains('e-checkbox')) {\n            const instance = element.ej2_instances[0];\n            instance.checked = false;\n            instance.dataBind();\n        }\n        else {\n            if (element.type === 'checkbox') {\n                element.checked = false;\n            }\n            else {\n                element.value = '';\n            }\n        }\n    }\n    getInstance(className) {\n        const element = this.element.querySelector('.' + className);\n        return element ? element.ej2_instances[0] : null;\n    }\n    eventDelete(event) {\n        if (this.isEnterKey) {\n            this.isEnterKey = false;\n            return;\n        }\n        switch (this.parent.currentAction) {\n            case 'EditOccurrence':\n                if (!isNullOrUndefined(this.parent.activeEventData.event[this.parent.eventFields.recurrenceRule])) {\n                    this.parent.currentAction = 'DeleteOccurrence';\n                }\n                else {\n                    this.parent.currentAction = 'Delete';\n                }\n                break;\n            case 'EditSeries':\n                this.parent.currentAction = 'DeleteSeries';\n                break;\n            case 'Save':\n                this.parent.currentAction = 'Delete';\n                break;\n            case 'EditFollowingEvents':\n                if (!isNullOrUndefined(this.parent.activeEventData.event[this.parent.eventFields.recurrenceRule])) {\n                    this.parent.currentAction = 'DeleteFollowingEvents';\n                }\n                break;\n        }\n        this.dialogEvent = event;\n        this.isCrudAction = false;\n        this.dialogObject.hide();\n        this.parent.quickPopup.openDeleteAlert();\n    }\n    getRecurrenceEditorInstance() {\n        if (this.parent.isAdaptive && !this.repeatDialogObject) {\n            this.renderRepeatDialog();\n        }\n        return this.recurrenceEditor;\n    }\n    destroyComponents() {\n        const formElements = this.getFormElements(EVENT_WINDOW_DIALOG_CLASS);\n        for (const element of formElements) {\n            let instance;\n            if (element.classList.contains('e-datetimepicker')) {\n                instance = element.ej2_instances;\n            }\n            else if (element.classList.contains('e-datepicker')) {\n                instance = element.ej2_instances;\n            }\n            else if (element.classList.contains('e-checkbox')) {\n                instance = element.ej2_instances;\n            }\n            else if (element.classList.contains('e-dropdownlist')) {\n                instance = element.ej2_instances;\n            }\n            else if (element.classList.contains('e-multiselect')) {\n                instance = element.ej2_instances;\n            }\n            if (instance && instance[0]) {\n                instance[0].destroy();\n            }\n        }\n        if (this.buttonObj) {\n            this.buttonObj.destroy();\n        }\n    }\n    destroy(isIgnore) {\n        if (this.parent && !this.parent.isDestroyed) {\n            this.parent.resetTemplates(['editorTemplate']);\n        }\n        this.destroyComponents();\n        if (this.recurrenceEditor) {\n            this.recurrenceEditor.destroy();\n            this.recurrenceEditor = null;\n        }\n        if (this.fieldValidator) {\n            this.fieldValidator.destroy();\n            this.fieldValidator = null;\n        }\n        if (this.repeatDialogObject) {\n            this.repeatDialogObject.destroy();\n            this.repeatDialogObject = null;\n        }\n        if (this.dialogObject) {\n            if (this.dialogObject.element) {\n                EventHandler.remove(this.dialogObject.element, 'keydown', this.preventEventSave);\n            }\n            this.dialogObject.destroy();\n            this.dialogObject = null;\n        }\n        if (this.element) {\n            remove(this.element);\n            this.element = null;\n        }\n        if (!isIgnore) {\n            this.l10n = null;\n            this.parent = null;\n            this.fields = null;\n            this.buttonObj = null;\n            this.repeatStatus = null;\n            this.eventWindowTime = null;\n        }\n    }\n}\n\n/**\n * Virtual Scroll\n */\nclass VirtualScroll {\n    constructor(parent) {\n        this.translateY = 0;\n        this.itemSize = 60;\n        this.bufferCount = 3;\n        this.renderedLength = 0;\n        this.averageRowHeight = 0;\n        this.isScrollHeightNull = true;\n        this.parent = parent;\n        this.addEventListener();\n    }\n    addEventListener() {\n        if (!this.parent || this.parent && this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.on(virtualScroll, this.virtualScrolling, this);\n    }\n    removeEventListener() {\n        if (!this.parent || this.parent && this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.off(virtualScroll, this.virtualScrolling);\n    }\n    getRenderedCount() {\n        this.setItemSize();\n        return Math.ceil(this.parent.element.clientHeight / this.itemSize) + this.bufferCount;\n    }\n    setTranslateValue() {\n        const resWrap = this.parent.element.querySelector('.' + RESOURCE_COLUMN_WRAP_CLASS);\n        const conWrap = this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS);\n        const eventWrap = this.parent.element.querySelector('.' + EVENT_TABLE_CLASS);\n        const timeIndicator = this.parent.element.querySelector('.' + CURRENT_TIMELINE_CLASS);\n        this.renderVirtualTrackHeight(conWrap, resWrap);\n        this.setTranslate(resWrap, conWrap, eventWrap, timeIndicator);\n    }\n    renderVirtualTrackHeight(contentWrap, resourceWrap) {\n        this.parent.resourceBase.setExpandedResources();\n        if (this.isScrollHeightNull) {\n            const wrap = createElement('div', { className: VIRTUAL_TRACK_CLASS });\n            const resWrap = [].slice.call((resourceWrap).querySelectorAll('table td'));\n            const startIndex = parseInt(resWrap[0].getAttribute('data-group-index'), 10);\n            const endIndex = parseInt(resWrap[resWrap.length - 1].getAttribute('data-group-index'), 10);\n            this.parent.resourceBase.renderedResources = this.parent.resourceBase.expandedResources.filter((resource) => (resource.groupIndex >= startIndex && resource.groupIndex <= endIndex));\n            this.setItemSize();\n            wrap.style.height = (this.parent.resourceBase.expandedResources.length * this.itemSize) + 'px';\n            this.isScrollHeightNull = false;\n            const virtual = this.parent.element.querySelector('.' + VIRTUAL_TRACK_CLASS);\n            if (!isNullOrUndefined(virtual)) {\n                remove(virtual);\n            }\n            contentWrap.appendChild(wrap);\n        }\n    }\n    renderVirtualTrack(contentWrap) {\n        const wrap = createElement('div', { className: VIRTUAL_TRACK_CLASS });\n        wrap.style.height = (this.parent.resourceBase.expandedResources.length * this.itemSize) + 'px';\n        contentWrap.appendChild(wrap);\n    }\n    updateVirtualScrollHeight() {\n        const virtual = this.parent.element.querySelector('.' + VIRTUAL_TRACK_CLASS);\n        const lastResourceIndex = this.parent.resourceBase.expandedResources[this.parent.resourceBase.expandedResources.length - 1].groupIndex;\n        const lastRenderIndex = this.parent.resourceBase.renderedResources[this.parent.resourceBase.renderedResources.length - 1].groupIndex;\n        if (lastRenderIndex !== lastResourceIndex) {\n            const conTable = this.parent.element.querySelector('.' + CONTENT_TABLE_CLASS);\n            this.renderedLength = conTable.querySelector('tbody').children.length;\n            virtual.style.height = (conTable.offsetHeight + (this.parent.resourceBase.expandedResources.length - (this.renderedLength)) *\n                conTable.offsetHeight / this.renderedLength) + 'px';\n        }\n        else {\n            virtual.style.height = '';\n        }\n        this.averageRowHeight = virtual.offsetHeight / this.parent.resourceBase.expandedResources.length;\n    }\n    updateVirtualTrackHeight(wrap) {\n        const resourceCount = this.parent.resourceBase.renderedResources.length;\n        if (resourceCount !== this.getRenderedCount()) {\n            wrap.style.height = this.parent.element.querySelector('.e-content-wrap').clientHeight + 'px';\n            const resWrap = this.parent.element.querySelector('.' + RESOURCE_COLUMN_WRAP_CLASS);\n            const conWrap = this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS);\n            const eventWrap = this.parent.element.querySelector('.' + EVENT_TABLE_CLASS);\n            this.translateY = 0;\n            this.setTranslate(resWrap, conWrap, eventWrap);\n        }\n        else {\n            const lastRenderIndex = this.parent.resourceBase.renderedResources[resourceCount - 1].groupIndex;\n            const lastCollIndex = this.parent.resourceBase.expandedResources[this.parent.resourceBase.expandedResources.length - 1].groupIndex;\n            let renderedResCount = resourceCount + (lastCollIndex - lastRenderIndex);\n            renderedResCount = (renderedResCount > this.parent.resourceBase.expandedResources.length) ?\n                this.parent.resourceBase.expandedResources.length : renderedResCount;\n            wrap.style.height = (renderedResCount * this.itemSize) + 'px';\n        }\n    }\n    setItemSize() {\n        this.itemSize = getElementHeightFromClass(this.parent.activeView.element, WORK_CELLS_CLASS) || this.itemSize;\n    }\n    renderEvents() {\n        this.setTabIndex();\n        this.parent.refreshEvents(false);\n        this.parent.notify(contentReady, {});\n        this.parent.hideSpinner();\n    }\n    virtualScrolling() {\n        if (this.parent.quickPopup) {\n            this.parent.quickPopup.quickPopupHide();\n            this.parent.quickPopup.morePopup.hide();\n        }\n        const resWrap = this.parent.element.querySelector('.' + RESOURCE_COLUMN_WRAP_CLASS);\n        const conWrap = this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS);\n        const eventWrap = this.parent.element.querySelector('.' + EVENT_TABLE_CLASS);\n        const timeIndicator = this.parent.element.querySelector('.' + CURRENT_TIMELINE_CLASS);\n        const conTable = this.parent.element.querySelector('.' + CONTENT_TABLE_CLASS);\n        this.renderedLength = resWrap.querySelector('tbody').children.length;\n        const firstTDIndex = parseInt(resWrap.querySelector('tbody td').getAttribute('data-group-index'), 10);\n        const scrollHeight = this.parent.rowAutoHeight ?\n            (conTable.offsetHeight - conWrap.offsetHeight) : this.bufferCount * this.itemSize;\n        addClass([conWrap], 'e-transition');\n        let resCollection = [];\n        if ((conWrap.scrollTop) - this.translateY < 0) {\n            resCollection = this.upScroll(conWrap, firstTDIndex);\n        }\n        else if (conWrap.scrollTop - this.translateY > scrollHeight) {\n            resCollection = this.downScroll(conWrap, firstTDIndex);\n        }\n        if (!isNullOrUndefined(resCollection) && resCollection.length > 0) {\n            this.parent.showSpinner();\n            const selectedEle = this.parent.getSelectedElements();\n            this.focusedEle = selectedEle[selectedEle.length - 1] || this.focusedEle;\n            this.updateContent(resWrap, conWrap, eventWrap, resCollection);\n            this.setTranslate(resWrap, conWrap, eventWrap, timeIndicator);\n            if (this.parent.dragAndDropModule && this.parent.dragAndDropModule.actionObj.action === 'drag') {\n                this.parent.dragAndDropModule.navigationWrapper();\n            }\n            window.clearTimeout(this.timeValue);\n            this.timeValue = window.setTimeout(() => { this.renderEvents(); }, 250);\n        }\n    }\n    upScroll(conWrap, firstTDIndex) {\n        let index = 0;\n        index = (~~(conWrap.scrollTop / this.itemSize) + Math.ceil(conWrap.clientHeight / this.itemSize)) - this.renderedLength;\n        if (this.parent.rowAutoHeight) {\n            index = (index > firstTDIndex) ? firstTDIndex - this.bufferCount : index;\n        }\n        index = (index > 0) ? index : 0;\n        const prevSetCollection = this.getBufferCollection(index, index + this.renderedLength);\n        this.parent.resourceBase.renderedResources = prevSetCollection;\n        if (firstTDIndex === 0) {\n            this.translateY = conWrap.scrollTop;\n        }\n        else {\n            let height = (this.parent.rowAutoHeight) ? this.averageRowHeight : this.itemSize;\n            height = (height > 0) ? height : this.itemSize;\n            this.translateY = (conWrap.scrollTop - (this.bufferCount * height) > 0) ?\n                conWrap.scrollTop - (this.bufferCount * height) : 0;\n        }\n        return prevSetCollection;\n    }\n    downScroll(conWrap, firstTDIndex) {\n        const lastResource = this.parent.resourceBase.\n            renderedResources[this.parent.resourceBase.renderedResources.length - 1].groupIndex;\n        const lastResourceIndex = this.parent.resourceBase.expandedResources[this.parent.resourceBase.expandedResources.length - 1].groupIndex;\n        if (lastResource === lastResourceIndex) {\n            return null;\n        }\n        let nextSetResIndex = 0;\n        nextSetResIndex = ~~(conWrap.scrollTop / this.itemSize);\n        if (this.parent.rowAutoHeight) {\n            nextSetResIndex = ~~((conWrap.scrollTop - this.translateY) / this.averageRowHeight) + firstTDIndex;\n            nextSetResIndex = (nextSetResIndex > firstTDIndex + this.bufferCount) ? nextSetResIndex : firstTDIndex + this.bufferCount;\n        }\n        let lastIndex = nextSetResIndex + this.renderedLength;\n        lastIndex = (lastIndex > this.parent.resourceBase.expandedResources.length) ?\n            nextSetResIndex + (this.parent.resourceBase.expandedResources.length - nextSetResIndex) : lastIndex;\n        const nextSetCollection = this.getBufferCollection(lastIndex - this.renderedLength, lastIndex);\n        this.translateY = conWrap.scrollTop;\n        return nextSetCollection;\n    }\n    updateContent(resWrap, conWrap, eventWrap, resCollection) {\n        const renderedLength = resWrap.querySelector('tbody').children.length;\n        if (document.activeElement && document.activeElement.classList.contains(RESOURCE_CELLS_CLASS)) {\n            this.isResourceCell = true;\n            this.parent.element.focus();\n        }\n        for (let i = 0; i < renderedLength; i++) {\n            remove(resWrap.querySelector('tbody tr'));\n            remove(conWrap.querySelector('tbody tr'));\n            remove(eventWrap.querySelector('div'));\n        }\n        this.parent.resourceBase.renderedResources = resCollection;\n        const resourceRows = this.parent.resourceBase.getContentRows(resCollection, true);\n        const contentRows = this.parent.activeView.getContentRows();\n        const eventRows = this.parent.activeView.getEventRows(resCollection.length);\n        append(resourceRows, resWrap.querySelector('tbody'));\n        append(contentRows, conWrap.querySelector('tbody'));\n        append(eventRows, eventWrap);\n    }\n    getBufferCollection(startIndex, endIndex) {\n        return this.parent.resourceBase.expandedResources.slice(startIndex, endIndex);\n    }\n    setTranslate(resWrap, conWrap, eventWrap, timeIndicator) {\n        setStyleAttribute(resWrap.querySelector('table'), { transform: `translateY(${this.translateY}px)` });\n        setStyleAttribute(conWrap.querySelector('table'), { transform: `translateY(${this.translateY}px)` });\n        setStyleAttribute(eventWrap, { transform: `translateY(${this.translateY}px)` });\n        if (!isNullOrUndefined(timeIndicator)) {\n            setStyleAttribute(timeIndicator, { transform: `translateY(${this.translateY}px)` });\n        }\n    }\n    updateFocusedWorkCell() {\n        if (this.focusedEle) {\n            const date = parseInt(this.focusedEle.getAttribute('data-date'), 10);\n            const groupIndex = parseInt(this.focusedEle.getAttribute('data-group-index'), 10);\n            const ele = this.parent.element.querySelector(`.${WORK_CELLS_CLASS}[data-date=\"${date}\"][data-group-index=\"${groupIndex}\"]`);\n            if (ele) {\n                this.parent.addSelectedClass([ele], ele, true);\n            }\n            this.focusedEle = null;\n        }\n    }\n    setTabIndex() {\n        const resColWrap = this.parent.element.querySelector('.' + RESOURCE_COLUMN_WRAP_CLASS);\n        const resCells = [].slice.call(this.parent.element.querySelectorAll('.' + RESOURCE_CELLS_CLASS));\n        if (resCells && resColWrap) {\n            resCells.forEach((element) => {\n                if (element.getBoundingClientRect().top >= resColWrap.getBoundingClientRect().top) {\n                    element.setAttribute('tabindex', '0');\n                }\n            });\n        }\n        const focusResCell = this.parent.element.querySelector(`.${RESOURCE_CELLS_CLASS}[tabindex=\"${0}\"]`);\n        if (this.isResourceCell && focusResCell) {\n            focusResCell.focus();\n            this.isResourceCell = false;\n        }\n    }\n    destroy() {\n        this.removeEventListener();\n    }\n}\n\n/**\n * Schedule DOM rendering\n */\nclass Render {\n    constructor(parent) {\n        this.parent = parent;\n    }\n    render(viewName, isDataRefresh = true) {\n        this.initializeLayout(viewName);\n        if (this.parent.activeView && isDataRefresh) {\n            this.parent.crudModule.refreshDataManager();\n        }\n    }\n    initializeLayout(viewName) {\n        if (this.parent.activeView) {\n            const templates = [\n                'cellTemplate', 'eventTemplate', 'tooltipTemplate', 'majorSlotTemplate', 'minorSlotTemplate',\n                'headerTooltipTemplate', 'dateHeaderTemplate', 'dayHeaderTemplate', 'mothHeaderTemplate',\n                'headerIndentTemplate', 'resourceHeaderTemplate', 'cellHeaderTemplate'\n            ];\n            this.parent.resetTemplates(templates);\n            this.parent.activeView.removeEventListener();\n            this.parent.activeView.destroy();\n        }\n        switch (viewName) {\n            case 'Day':\n                this.parent.activeView = this.parent.dayModule;\n                break;\n            case 'Week':\n                this.parent.activeView = this.parent.weekModule;\n                break;\n            case 'WorkWeek':\n                this.parent.activeView = this.parent.workWeekModule;\n                break;\n            case 'Month':\n                this.parent.activeView = this.parent.monthModule;\n                break;\n            case 'Year':\n                this.parent.activeView = this.parent.yearModule;\n                break;\n            case 'Agenda':\n                this.parent.activeView = this.parent.agendaModule;\n                break;\n            case 'MonthAgenda':\n                this.parent.activeView = this.parent.monthAgendaModule;\n                break;\n            case 'TimelineDay':\n                this.parent.activeView = this.parent.timelineViewsModule;\n                this.parent.activeView.viewClass = 'e-timeline-day-view';\n                break;\n            case 'TimelineWorkWeek':\n                this.parent.activeView = this.parent.timelineViewsModule;\n                this.parent.activeView.viewClass = 'e-timeline-work-week-view';\n                break;\n            case 'TimelineWeek':\n                this.parent.activeView = this.parent.timelineViewsModule;\n                this.parent.activeView.viewClass = 'e-timeline-week-view';\n                break;\n            case 'TimelineMonth':\n                this.parent.activeView = this.parent.timelineMonthModule;\n                break;\n            case 'TimelineYear':\n                this.parent.activeView = this.parent.timelineYearModule;\n                break;\n        }\n        if (isNullOrUndefined(this.parent.activeView)) {\n            const firstView = this.parent.viewCollections[0].option;\n            if (firstView) {\n                this.parent.setProperties({ currentView: firstView }, true);\n                if (this.parent.headerModule) {\n                    this.parent.headerModule.updateActiveView();\n                    this.parent.headerModule.setCalendarView();\n                }\n                return this.initializeLayout(firstView);\n            }\n            throw Error('Inject required modules');\n        }\n        this.parent.activeView.viewIndex = this.parent.viewIndex;\n        this.updateLabelText(viewName);\n        this.parent.activeView.addEventListener();\n        this.parent.activeView.getRenderDates();\n        this.parent.uiStateValues.isGroupAdaptive = this.parent.activeViewOptions.group.resources.length > 0 &&\n            (this.parent.enableAdaptiveUI && !this.parent.isAdaptive ||\n                this.parent.isAdaptive && this.parent.activeViewOptions.group.enableCompactView);\n        if (this.parent.virtualScrollModule) {\n            this.parent.virtualScrollModule.destroy();\n            this.parent.virtualScrollModule = null;\n        }\n        if (this.parent.currentView.indexOf('Timeline') !== -1 && (this.parent.currentView.indexOf('Year') === -1 ||\n            (this.parent.currentView === 'TimelineYear' && this.parent.activeViewOptions.orientation === 'Vertical'))\n            && this.parent.activeViewOptions.allowVirtualScrolling\n            && this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n            this.parent.virtualScrollModule = new VirtualScroll(this.parent);\n            this.parent.uiStateValues.top = 0;\n        }\n        this.updateHeader();\n        this.parent.activeView.renderLayout(CURRENT_PANEL_CLASS);\n        this.parent.renderTemplates();\n        if (this.parent.eventTooltip) {\n            this.parent.eventTooltip.destroy();\n            this.parent.eventTooltip = null;\n        }\n        if (this.parent.eventSettings.enableTooltip || (this.parent.activeViewOptions.group.resources.length > 0\n            && this.parent.activeViewOptions.group.headerTooltipTemplate)) {\n            this.parent.eventTooltip = new EventTooltip(this.parent);\n        }\n    }\n    updateHeader() {\n        if (this.parent.headerModule) {\n            this.parent.headerModule.setDayOfWeek(this.parent.activeViewOptions.firstDayOfWeek);\n            if (this.parent.activeViewOptions.readonly) {\n                addClass([this.parent.element], READ_ONLY);\n            }\n            else if (this.parent.element.classList.contains(READ_ONLY)) {\n                removeClass([this.parent.element], READ_ONLY);\n            }\n            this.parent.headerModule.updateDateRange(this.parent.activeView.getDateRangeText());\n            this.parent.headerModule.updateHeaderItems('remove');\n        }\n    }\n    updateLabelText(view) {\n        const content = this.parent.activeView.getLabelText(view);\n        this.parent.element.setAttribute('role', 'main');\n        this.parent.element.setAttribute('aria-label', content);\n    }\n}\n\nvar __decorate$2 = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n/**\n * A class that represents the configuration of working hours related options of scheduler.\n */\nclass WorkHours extends ChildProperty {\n}\n__decorate$2([\n    Property(true)\n], WorkHours.prototype, \"highlight\", void 0);\n__decorate$2([\n    Property('09:00')\n], WorkHours.prototype, \"start\", void 0);\n__decorate$2([\n    Property('18:00')\n], WorkHours.prototype, \"end\", void 0);\n\nvar __decorate$3 = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n/**\n * A class that represents the configuration of options related to timescale on scheduler.\n */\nclass TimeScale extends ChildProperty {\n}\n__decorate$3([\n    Property(true)\n], TimeScale.prototype, \"enable\", void 0);\n__decorate$3([\n    Property(60)\n], TimeScale.prototype, \"interval\", void 0);\n__decorate$3([\n    Property(2)\n], TimeScale.prototype, \"slotCount\", void 0);\n__decorate$3([\n    Property()\n], TimeScale.prototype, \"minorSlotTemplate\", void 0);\n__decorate$3([\n    Property()\n], TimeScale.prototype, \"majorSlotTemplate\", void 0);\n\nvar __decorate$4 = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n/**\n * A class that defines the template options available to customize the quick popup of scheduler.\n */\nclass QuickInfoTemplates extends ChildProperty {\n}\n__decorate$4([\n    Property('Both')\n], QuickInfoTemplates.prototype, \"templateType\", void 0);\n__decorate$4([\n    Property()\n], QuickInfoTemplates.prototype, \"header\", void 0);\n__decorate$4([\n    Property()\n], QuickInfoTemplates.prototype, \"content\", void 0);\n__decorate$4([\n    Property()\n], QuickInfoTemplates.prototype, \"footer\", void 0);\n\nvar __decorate$5 = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n/**\n * A class that represents the header rows related configurations on timeline views.\n */\nclass HeaderRows extends ChildProperty {\n}\n__decorate$5([\n    Property()\n], HeaderRows.prototype, \"option\", void 0);\n__decorate$5([\n    Property()\n], HeaderRows.prototype, \"template\", void 0);\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\n/* eslint-disable max-len */\n/**\n * Schedule CRUD operations\n */\nclass Crud {\n    constructor(parent) {\n        this.parent = parent;\n        this.crudObj = { sourceEvent: null, targetEvent: null, isCrudAction: false };\n    }\n    getQuery() {\n        const start = this.parent.activeView.startDate();\n        const end = this.parent.activeView.endDate();\n        return this.parent.dataModule.generateQuery(start, end);\n    }\n    getTable() {\n        if (this.parent.eventSettings.query) {\n            const query = this.parent.eventSettings.query.clone();\n            return query.fromTable;\n        }\n        return null;\n    }\n    refreshDataManager() {\n        if (!this.parent.activeView) {\n            return;\n        }\n        const start = this.parent.activeView.startDate();\n        const end = this.parent.activeView.endDate();\n        const dataManager = this.parent.dataModule.getData(this.parent.dataModule.generateQuery(start, end));\n        dataManager.then((e) => this.dataManagerSuccess(e)).catch((e) => this.dataManagerFailure(e));\n    }\n    dataManagerSuccess(e) {\n        if (!this.parent || this.parent && this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.trigger(dataBinding, e, (args) => {\n            const resultData = extend([], args.result, null, true);\n            this.parent.eventsData = resultData.filter((data) => !data[this.parent.eventFields.isBlock]);\n            this.parent.blockData = resultData.filter((data) => data[this.parent.eventFields.isBlock]);\n            this.parent.refreshEvents(false);\n            if (this.parent.dragAndDropModule && this.parent.dragAndDropModule.actionObj.action === 'drag') {\n                this.parent.dragAndDropModule.navigationWrapper();\n            }\n            this.parent.trigger(dataBound, null, () => {\n                this.parent.hideSpinner();\n                if (this.parent.isPrinting) {\n                    this.parent.notify(print$1, {});\n                }\n            });\n        });\n    }\n    dataManagerFailure(e) {\n        if (!this.parent || this.parent && this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.trigger(actionFailure, { error: e }, () => this.parent.hideSpinner());\n    }\n    refreshData(args) {\n        const actionArgs = {\n            requestType: args.requestType, cancel: false, data: args.data,\n            addedRecords: args.editParams.addedRecords, changedRecords: args.editParams.changedRecords,\n            deletedRecords: args.editParams.deletedRecords\n        };\n        if (this.parent.dragAndDropModule && this.parent.dragAndDropModule.actionObj && this.parent.dragAndDropModule.actionObj.element) {\n            this.parent.dragAndDropModule.actionObj.element.style.display = 'none';\n        }\n        if (this.parent.resizeModule && this.parent.resizeModule.actionObj && this.parent.resizeModule.actionObj.element) {\n            this.parent.resizeModule.actionObj.element.style.display = 'none';\n        }\n        if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.activeViewOptions.group.allowGroupEdit\n            && !this.parent.rowAutoHeight && !this.parent.virtualScrollModule && this.parent.activeViewOptions.group.byGroupID) {\n            if (args.requestType === 'eventCreated' || args.requestType === 'eventRemoved') {\n                this.crudObj.isCrudAction = true;\n                this.crudObj.sourceEvent = [];\n                const crudData = args.data instanceof Array ? (args.data.length === 0 &&\n                    args.requestType === 'eventRemoved' ? args.editParams.deletedRecords : args.data) :\n                    ((typeof args.data === 'string' || typeof args.data === 'number') && args.requestType === 'eventRemoved') ?\n                        args.editParams.deletedRecords : [args.data];\n                for (const data of crudData) {\n                    this.crudObj.isCrudAction = !(args.requestType === 'eventRemoved' && !isNullOrUndefined(data.parent));\n                    const groupIndex = this.parent.eventBase.getGroupIndexFromEvent(data);\n                    if (groupIndex > -1 && this.parent.crudModule.crudObj.sourceEvent.filter((tdData) => tdData.groupIndex === groupIndex).length === 0\n                        && this.crudObj.isCrudAction) {\n                        this.crudObj.sourceEvent.push(this.parent.resourceBase.lastResourceLevel[groupIndex]);\n                    }\n                }\n                this.crudObj.targetEvent = this.crudObj.sourceEvent;\n            }\n        }\n        if (this.parent.dataModule.dataManager.dataSource.offline) {\n            this.parent.trigger(actionComplete, actionArgs, (offlineArgs) => {\n                if (!offlineArgs.cancel) {\n                    this.refreshDataManager();\n                }\n            });\n        }\n        else {\n            args.promise.then(() => {\n                if (!this.parent || this.parent && this.parent.isDestroyed) {\n                    return;\n                }\n                this.parent.trigger(actionComplete, actionArgs, (onlineArgs) => {\n                    if (!onlineArgs.cancel) {\n                        this.refreshDataManager();\n                    }\n                });\n            }).catch((e) => {\n                if (!this.parent || this.parent && this.parent.isDestroyed) {\n                    return;\n                }\n                this.parent.trigger(actionFailure, { error: e });\n            });\n        }\n    }\n    addEvent(eventData) {\n        if (this.parent.eventSettings.allowAdding && !this.parent.activeViewOptions.readonly) {\n            if (!this.isBlockEvent(eventData) && this.parent.eventBase.isBlockRange(eventData)) {\n                this.parent.quickPopup.openValidationError('blockAlert', eventData);\n                return;\n            }\n            const addEvents = (eventData instanceof Array) ? eventData : [eventData];\n            const args = {\n                requestType: 'eventCreate', cancel: false, data: addEvents,\n                addedRecords: addEvents, changedRecords: [], deletedRecords: []\n            };\n            this.parent.trigger(actionBegin, args, (addArgs) => {\n                if (!addArgs.cancel) {\n                    const fields = this.parent.eventFields;\n                    const editParams = { addedRecords: [], changedRecords: [], deletedRecords: [] };\n                    let promise;\n                    if (addArgs.addedRecords instanceof Array) {\n                        for (let event of addArgs.addedRecords) {\n                            event = this.parent.eventBase.updateEventDateTime(event);\n                            const eventData = extend({}, this.parent.eventBase.processTimezone(event, true), null, true);\n                            editParams.addedRecords.push(eventData);\n                        }\n                        promise = this.parent.dataModule.dataManager.saveChanges(editParams, fields.id, this.getTable(), this.getQuery());\n                    }\n                    else {\n                        const event = this.parent.eventBase.processTimezone(addArgs.addedRecords, true);\n                        editParams.addedRecords.push(event);\n                        promise = this.parent.dataModule.dataManager.insert(event, this.getTable(), this.getQuery());\n                    }\n                    const crudArgs = {\n                        requestType: 'eventCreated', cancel: false, data: addArgs.addedRecords, promise: promise, editParams: editParams\n                    };\n                    this.refreshData(crudArgs);\n                }\n            });\n        }\n    }\n    saveEvent(eventData, action) {\n        if (this.parent.eventSettings.allowEditing && !this.parent.activeViewOptions.readonly) {\n            if (this.parent.currentAction !== 'EditFollowingEvents' && !this.isBlockEvent(eventData)\n                && this.parent.eventBase.isBlockRange(eventData)) {\n                this.parent.quickPopup.openValidationError('blockAlert', eventData);\n                return;\n            }\n            this.parent.currentAction = action;\n            if (action) {\n                switch (action) {\n                    case 'Save':\n                        this.processSave(eventData);\n                        break;\n                    case 'EditOccurrence':\n                        this.processOccurrences(eventData, action);\n                        break;\n                    case 'EditFollowingEvents':\n                        this.processFollowSeries(eventData, action);\n                        break;\n                    case 'EditSeries':\n                        this.processEntireSeries(eventData, action);\n                        break;\n                }\n            }\n            else {\n                const updateEvents = (eventData instanceof Array) ? eventData : [eventData];\n                const args = {\n                    requestType: 'eventChange', cancel: false, data: eventData,\n                    addedRecords: [], changedRecords: updateEvents, deletedRecords: []\n                };\n                this.parent.trigger(actionBegin, args, (saveArgs) => {\n                    if (!saveArgs.cancel) {\n                        let promise;\n                        const fields = this.parent.eventFields;\n                        const editParams = { addedRecords: [], changedRecords: [], deletedRecords: [] };\n                        if (saveArgs.changedRecords instanceof Array) {\n                            for (let event of saveArgs.changedRecords) {\n                                event = this.parent.eventBase.updateEventDateTime(event);\n                                const eventData = extend({}, this.parent.eventBase.processTimezone(event, true), null, true);\n                                editParams.changedRecords.push(eventData);\n                            }\n                            promise = this.parent.dataModule.dataManager.saveChanges(editParams, fields.id, this.getTable(), this.getQuery());\n                        }\n                        else {\n                            const event = this.parent.eventBase.processTimezone(saveArgs.changedRecords, true);\n                            editParams.changedRecords.push(event);\n                            promise = this.parent.dataModule.dataManager.update(fields.id, event, this.getTable(), this.getQuery());\n                        }\n                        const crudArgs = {\n                            requestType: 'eventChanged', cancel: false,\n                            data: saveArgs.changedRecords, promise: promise, editParams: editParams\n                        };\n                        this.refreshData(crudArgs);\n                    }\n                });\n            }\n        }\n    }\n    deleteEvent(eventData, action) {\n        if (this.parent.eventSettings.allowDeleting && !this.parent.activeViewOptions.readonly) {\n            this.parent.currentAction = action;\n            let deleteEvents = [];\n            if (typeof eventData === 'string' || typeof eventData === 'number') {\n                deleteEvents = this.parent.eventsData.filter((eventObj) => eventObj[this.parent.eventFields.id] === eventData);\n            }\n            else {\n                deleteEvents = (eventData instanceof Array ? eventData : [eventData]);\n            }\n            if (action) {\n                switch (action) {\n                    case 'Delete':\n                        this.processDelete(deleteEvents);\n                        break;\n                    case 'DeleteOccurrence':\n                        this.processOccurrences(deleteEvents, action);\n                        break;\n                    case 'DeleteFollowingEvents':\n                        this.processFollowSeries(deleteEvents, action);\n                        break;\n                    case 'DeleteSeries':\n                        this.processEntireSeries(deleteEvents, action);\n                        break;\n                }\n            }\n            else {\n                const args = {\n                    requestType: 'eventRemove', cancel: false, data: eventData,\n                    addedRecords: [], changedRecords: [], deletedRecords: deleteEvents\n                };\n                this.parent.trigger(actionBegin, args, (deleteArgs) => {\n                    if (!deleteArgs.cancel) {\n                        let promise;\n                        const fields = this.parent.eventFields;\n                        const editParams = { addedRecords: [], changedRecords: [], deletedRecords: [] };\n                        if (deleteArgs.deletedRecords.length > 1) {\n                            editParams.deletedRecords = editParams.deletedRecords.concat(deleteArgs.deletedRecords);\n                            promise = this.parent.dataModule.dataManager.saveChanges(editParams, fields.id, this.getTable(), this.getQuery());\n                        }\n                        else {\n                            editParams.deletedRecords.push(deleteArgs.deletedRecords[0]);\n                            promise = this.parent.dataModule.dataManager.remove(fields.id, deleteArgs.deletedRecords[0], this.getTable(), this.getQuery());\n                        }\n                        this.parent.eventBase.selectWorkCellByTime(deleteArgs.deletedRecords);\n                        const crudArgs = {\n                            requestType: 'eventRemoved', cancel: false,\n                            data: deleteArgs.deletedRecords, promise: promise, editParams: editParams\n                        };\n                        this.refreshData(crudArgs);\n                    }\n                });\n            }\n        }\n    }\n    processOccurrences(eventData, action) {\n        let occurrenceData = [];\n        let isDeletedRecords = false;\n        if (eventData instanceof Array) {\n            for (const event of eventData) {\n                occurrenceData.push({ occurrence: event, parent: this.getParentEvent(event) });\n            }\n        }\n        else {\n            occurrenceData = { occurrence: eventData, parent: this.getParentEvent(eventData) };\n        }\n        const updateEvents = (eventData instanceof Array) ? eventData : [eventData];\n        const args = {\n            requestType: action === 'EditOccurrence' ? 'eventChange' : 'eventRemove', cancel: false,\n            addedRecords: [], changedRecords: updateEvents, deletedRecords: []\n        };\n        args.data = occurrenceData;\n        this.parent.trigger(actionBegin, args, (occurrenceArgs) => {\n            if (!occurrenceArgs.cancel) {\n                const fields = this.parent.eventFields;\n                const editParams = { addedRecords: [], changedRecords: [], deletedRecords: [] };\n                const occurrenceEvents = (occurrenceData instanceof Array ? occurrenceData : [occurrenceData]);\n                for (let a = 0, count = occurrenceArgs.changedRecords.length; a < count; a++) {\n                    const childEvent = occurrenceArgs.changedRecords[a];\n                    const parentEvent = occurrenceEvents[a].parent;\n                    const parentException = parentEvent[fields.recurrenceException];\n                    let editedData;\n                    let exceptionDate;\n                    switch (action) {\n                        case 'EditOccurrence':\n                            editedData = this.parent.eventsProcessed.filter((event) => event.Guid === childEvent.Guid)[0];\n                            exceptionDate = this.excludeDateCheck(editedData[fields.startTime], parentException);\n                            if (exceptionDate !== parentEvent[fields.recurrenceException]) {\n                                parentEvent[fields.recurrenceException] = exceptionDate;\n                                childEvent[fields.recurrenceException] = getRecurrenceStringFromDate(editedData[fields.startTime]);\n                                childEvent[fields.recurrenceID] = parentEvent[fields.id];\n                                childEvent[fields.followingID] = null;\n                                editParams.changedRecords.push(this.parent.eventBase.processTimezone(parentEvent, true));\n                                editParams.addedRecords.push(this.parent.eventBase.processTimezone(childEvent, true));\n                            }\n                            else {\n                                editParams.changedRecords.push(this.parent.eventBase.processTimezone(childEvent, true));\n                            }\n                            break;\n                        case 'DeleteOccurrence':\n                            if (!childEvent[fields.recurrenceException]) {\n                                parentEvent[fields.recurrenceException] =\n                                    this.excludeDateCheck(childEvent[fields.startTime], parentException);\n                                editParams.changedRecords.push(this.parent.eventBase.processTimezone(parentEvent, true));\n                            }\n                            if (childEvent[fields.id] !== parentEvent[fields.id]) {\n                                editParams.deletedRecords.push(childEvent);\n                                isDeletedRecords = true;\n                            }\n                            break;\n                    }\n                }\n                const promise = this.parent.dataModule.dataManager.saveChanges(editParams, fields.id, this.getTable(), this.getQuery());\n                this.parent.eventBase.selectWorkCellByTime(occurrenceArgs.changedRecords);\n                const crudArgs = {\n                    requestType: action === 'EditOccurrence' ? 'eventChanged' : 'eventRemoved',\n                    cancel: false, data: isDeletedRecords ? occurrenceArgs.deletedRecords : occurrenceArgs.changedRecords,\n                    promise: promise, editParams: editParams\n                };\n                this.refreshData(crudArgs);\n            }\n        });\n    }\n    processFollowSeries(eventData, action) {\n        let followData = [];\n        if (eventData instanceof Array) {\n            for (const event of eventData) {\n                followData.push({ occurrence: event, parent: this.getParentEvent(event) });\n            }\n        }\n        else {\n            followData = { occurrence: eventData, parent: this.getParentEvent(eventData) };\n        }\n        const updateFollowEvents = (eventData instanceof Array) ? eventData : [eventData];\n        const args = {\n            requestType: action === 'EditFollowingEvents' ? 'eventChange' : 'eventRemove', cancel: false,\n            addedRecords: [], changedRecords: updateFollowEvents, deletedRecords: []\n        };\n        args.data = followData;\n        this.parent.trigger(actionBegin, args, (followArgs) => {\n            if (!followArgs.cancel) {\n                const fields = this.parent.eventFields;\n                const editParams = { addedRecords: [], changedRecords: [], deletedRecords: [] };\n                const followEvents = followData instanceof Array ? followData : [followData];\n                for (let a = 0, count = followArgs.changedRecords.length; a < count; a++) {\n                    const childEvent = followArgs.changedRecords[a];\n                    const parentEvent = followEvents[a].parent;\n                    const followData = this.parent.eventBase.getEventCollections(parentEvent, childEvent);\n                    let isSpanned;\n                    switch (action) {\n                        case 'EditFollowingEvents':\n                            this.processRecurrenceRule(parentEvent, childEvent);\n                            isSpanned = !this.parent.eventBase.isFollowingEvent(parentEvent, childEvent);\n                            childEvent[fields.followingID] = isSpanned ? null : parentEvent[fields.id];\n                            childEvent[fields.recurrenceID] = null;\n                            editParams.addedRecords.push(this.parent.eventBase.processTimezone(childEvent, true));\n                            editParams.changedRecords.push(this.parent.eventBase.processTimezone(parentEvent, true));\n                            if (!this.parent.uiStateValues.isIgnoreOccurrence) {\n                                childEvent[fields.recurrenceException] = null;\n                                if (followData.occurrence.length > 0) {\n                                    const rule = followData.occurrence.slice(-1)[0][fields.recurrenceRule];\n                                    if (rule.indexOf('COUNT') === -1) {\n                                        childEvent[fields.recurrenceRule] = rule;\n                                    }\n                                }\n                                if (followData.follow.length > 0) {\n                                    childEvent[fields.recurrenceRule] = followData.follow.slice(-1)[0][fields.recurrenceRule];\n                                    editParams.deletedRecords = editParams.deletedRecords.concat(followData.follow);\n                                }\n                                if (isSpanned) {\n                                    followData.occurrence = followData.occurrence.filter((eventObj) => eventObj[fields.recurrenceID] === childEvent[fields.id]);\n                                }\n                                editParams.deletedRecords = editParams.deletedRecords.concat(followData.occurrence);\n                            }\n                            break;\n                        case 'DeleteFollowingEvents':\n                            this.processRecurrenceRule(parentEvent, childEvent[fields.startTime]);\n                            editParams.changedRecords.push(this.parent.eventBase.processTimezone(parentEvent, true));\n                            editParams.deletedRecords = editParams.deletedRecords.concat(followData.occurrence).concat(followData.follow);\n                            break;\n                    }\n                }\n                const promise = this.parent.dataModule.dataManager.saveChanges(editParams, fields.id, this.getTable(), this.getQuery());\n                this.parent.eventBase.selectWorkCellByTime(followArgs.changedRecords);\n                const crudArgs = {\n                    requestType: action === 'EditFollowingEvents' ? 'eventChanged' : 'eventRemoved',\n                    cancel: false, data: followArgs.changedRecords, promise: promise, editParams: editParams\n                };\n                this.refreshData(crudArgs);\n            }\n        });\n    }\n    processEntireSeries(eventData, action) {\n        let seriesData = [];\n        let isDeletedRecords = false;\n        if (eventData instanceof Array) {\n            for (const event of eventData) {\n                seriesData.push(this.getParentEvent(event, true));\n            }\n        }\n        else {\n            seriesData = this.getParentEvent(eventData, true);\n        }\n        const updateSeriesEvents = (eventData instanceof Array) ? eventData : [eventData];\n        const args = {\n            requestType: action === 'EditSeries' ? 'eventChange' : 'eventRemove', cancel: false,\n            addedRecords: [], changedRecords: updateSeriesEvents, deletedRecords: []\n        };\n        args.data = seriesData;\n        this.parent.trigger(actionBegin, args, (seriesArgs) => {\n            if (!seriesArgs.cancel) {\n                const fields = this.parent.eventFields;\n                const editParams = { addedRecords: [], changedRecords: [], deletedRecords: [] };\n                const seriesEvents = seriesData instanceof Array ? seriesData : [seriesData];\n                for (let a = 0, count = seriesArgs.changedRecords.length; a < count; a++) {\n                    const childEvent = seriesArgs.changedRecords[a];\n                    const parentEvent = seriesEvents[a];\n                    const eventCollections = this.parent.eventBase.getEventCollections(parentEvent);\n                    const deletedEvents = eventCollections.follow.concat(eventCollections.occurrence);\n                    switch (action) {\n                        case 'EditSeries':\n                            if ((childEvent[fields.startTime] > parentEvent[fields.startTime]) && childEvent[fields.recurrenceRule]) {\n                                this.processRecurrenceRule(parentEvent, childEvent);\n                            }\n                            childEvent[fields.id] = parentEvent[fields.id];\n                            childEvent[fields.recurrenceID] = null;\n                            childEvent[fields.followingID] = null;\n                            if (this.parent.uiStateValues.isIgnoreOccurrence && childEvent[fields.recurrenceException]) {\n                                const originalParent = this.parent.eventsData.filter((eventObj) => eventObj[fields.id] === childEvent[fields.id]);\n                                if (originalParent.length > 0) {\n                                    childEvent[fields.recurrenceRule] = originalParent[0][fields.recurrenceRule];\n                                }\n                            }\n                            else {\n                                childEvent[fields.recurrenceException] = null;\n                                editParams.deletedRecords = editParams.deletedRecords.concat(deletedEvents);\n                            }\n                            editParams.changedRecords.push(this.parent.eventBase.processTimezone(childEvent, true));\n                            this.parent.uiStateValues.isIgnoreOccurrence = false;\n                            break;\n                        case 'DeleteSeries':\n                            editParams.deletedRecords = editParams.deletedRecords.concat(deletedEvents.concat(parentEvent));\n                            isDeletedRecords = true;\n                            break;\n                    }\n                }\n                const promise = this.parent.dataModule.dataManager.saveChanges(editParams, fields.id, this.getTable(), this.getQuery());\n                this.parent.eventBase.selectWorkCellByTime(seriesArgs.changedRecords);\n                const crudArgs = {\n                    requestType: action === 'EditSeries' ? 'eventChanged' : 'eventRemoved',\n                    cancel: false, data: isDeletedRecords ? seriesArgs.deletedRecords : seriesArgs.changedRecords,\n                    promise: promise, editParams: editParams\n                };\n                this.refreshData(crudArgs);\n            }\n        });\n    }\n    processDelete(eventData) {\n        const deleteData = [];\n        for (const eventObj of eventData) {\n            if (eventObj[this.parent.eventFields.recurrenceRule]) {\n                deleteData.push({ occurrence: eventObj, parent: this.getParentEvent(eventObj) });\n            }\n            else {\n                deleteData.push(eventObj);\n            }\n        }\n        const args = {\n            requestType: 'eventRemove', cancel: false,\n            addedRecords: [], changedRecords: [], deletedRecords: eventData\n        };\n        args.data = deleteData;\n        this.parent.trigger(actionBegin, args, (deleteArgs) => {\n            if (!deleteArgs.cancel) {\n                const fields = this.parent.eventFields;\n                const editParams = { addedRecords: [], changedRecords: [], deletedRecords: [] };\n                for (let a = 0, count = deleteArgs.deletedRecords.length; a < count; a++) {\n                    let isDelete = isNullOrUndefined(deleteArgs.deletedRecords[a][this.parent.eventFields.recurrenceRule]);\n                    if (!isDelete) {\n                        const parentEvent = deleteData[a].parent;\n                        const isEdited = editParams.changedRecords.filter((obj) => obj[fields.id] === parentEvent[fields.id]);\n                        const editedDate = deleteArgs.deletedRecords[a][fields.startTime];\n                        if (isEdited.length > 0) {\n                            const editedData = isEdited[0];\n                            editedData[fields.recurrenceException] =\n                                this.excludeDateCheck(editedDate, editedData[fields.recurrenceException]);\n                        }\n                        else {\n                            parentEvent[fields.recurrenceException] =\n                                this.excludeDateCheck(editedDate, parentEvent[fields.recurrenceException]);\n                        }\n                        if (isEdited.length === 0) {\n                            editParams.changedRecords.push(this.parent.eventBase.processTimezone(parentEvent, true));\n                        }\n                        isDelete = deleteArgs.deletedRecords[a][fields.id] !== parentEvent[fields.id];\n                    }\n                    if (isDelete) {\n                        editParams.deletedRecords.push(deleteArgs.deletedRecords[a]);\n                    }\n                }\n                const promise = this.parent.dataModule.dataManager.saveChanges(editParams, fields.id, this.getTable(), this.getQuery());\n                const crudArgs = {\n                    requestType: 'eventRemoved', cancel: false, data: deleteArgs.deletedRecords, promise: promise, editParams: editParams\n                };\n                this.refreshData(crudArgs);\n            }\n        });\n    }\n    processSave(data) {\n        const eventData = (data instanceof Array) ? data : [data];\n        const editData = [];\n        for (const eventObj of eventData) {\n            if (eventObj[this.parent.eventFields.recurrenceRule]) {\n                editData.push({ occurrence: eventObj, parent: this.getParentEvent(eventObj) });\n            }\n            else {\n                editData.push(eventObj);\n            }\n        }\n        const args = { requestType: 'eventChange', cancel: false, addedRecords: [], changedRecords: eventData, deletedRecords: [] };\n        args.data = editData;\n        this.parent.trigger(actionBegin, args, (editArgs) => {\n            if (!editArgs.cancel) {\n                const fields = this.parent.eventFields;\n                const editParams = { addedRecords: [], changedRecords: [], deletedRecords: [] };\n                for (const record of editArgs.changedRecords) {\n                    if (!isNullOrUndefined(record[fields.recurrenceRule]) && isNullOrUndefined(record[fields.recurrenceException])) {\n                        const exceptionString = getRecurrenceStringFromDate(record[fields.startTime]);\n                        const parentEle = this.getParentEvent(record);\n                        parentEle[fields.recurrenceException] = isNullOrUndefined(parentEle[fields.recurrenceException]) ?\n                            exceptionString : parentEle[fields.recurrenceException].concat(',' + exceptionString);\n                        record[fields.id] = this.parent.getEventMaxID();\n                        record[fields.recurrenceException] = exceptionString;\n                        editParams.addedRecords.push(this.parent.eventBase.processTimezone(record, true));\n                        editParams.changedRecords.push(this.parent.eventBase.processTimezone(parentEle, true));\n                    }\n                    else {\n                        editParams.changedRecords.push(this.parent.eventBase.processTimezone(record, true));\n                    }\n                }\n                const promise = this.parent.dataModule.dataManager.saveChanges(editParams, fields.id, this.getTable(), this.getQuery());\n                const crudArgs = { requestType: 'eventChanged', cancel: false, data: editArgs.changedRecords, promise: promise, editParams: editParams };\n                this.refreshData(crudArgs);\n            }\n        });\n    }\n    getParentEvent(event, isParent = false) {\n        const parentEvent = this.parent.eventBase.getParentEvent(event, isParent) || event;\n        if (parentEvent[this.parent.eventFields.startTimezone] || parentEvent[this.parent.eventFields.endTimezone]) {\n            this.parent.eventBase.timezoneConvert(parentEvent);\n        }\n        return parentEvent;\n    }\n    excludeDateCheck(eventStartTime, exceptionDateList) {\n        const exDate = getRecurrenceStringFromDate(eventStartTime);\n        if (!isNullOrUndefined(exceptionDateList)) {\n            if (exceptionDateList.indexOf(exDate) === -1) {\n                exceptionDateList = !(isNullOrUndefined(exceptionDateList)) ? exceptionDateList + ',' + exDate : exDate;\n            }\n        }\n        else {\n            exceptionDateList = exDate;\n        }\n        return exceptionDateList;\n    }\n    processRecurrenceRule(parentEvent, followEvent) {\n        const fields = this.parent.eventFields;\n        const recurrenceRule = parentEvent[fields.recurrenceRule];\n        let endDate;\n        if (followEvent instanceof Date) {\n            endDate = new Date(+followEvent);\n        }\n        else {\n            endDate = new Date(+followEvent[fields.startTime]);\n            const newRecurrenceRule = followEvent[fields.recurrenceRule];\n            if (newRecurrenceRule) {\n                const startDate = parentEvent[fields.startTime];\n                const ruleException = (this.parent.currentAction === 'DeleteFollowingEvents') ? followEvent[fields.recurrenceException] : null;\n                const dateCollection = generate(startDate, newRecurrenceRule, ruleException, this.parent.activeViewOptions.firstDayOfWeek);\n                const untilDate = new Date(dateCollection.slice(-1)[0]);\n                untilDate.setHours(endDate.getHours(), endDate.getMinutes(), endDate.getSeconds());\n                endDate.setHours(startDate.getHours(), startDate.getMinutes(), startDate.getSeconds());\n                followEvent[fields.recurrenceRule] = this.getUpdatedRecurrenceRule(newRecurrenceRule, new Date(+untilDate), false);\n            }\n        }\n        parentEvent[fields.recurrenceRule] = this.getUpdatedRecurrenceRule(recurrenceRule, addDays(new Date(endDate.getTime()), -1), true);\n    }\n    getUpdatedRecurrenceRule(recurrenceRule, untilDate, isParent) {\n        const splitRule = recurrenceRule.split(';');\n        let updatedRule = '';\n        for (let rule of splitRule) {\n            if (rule !== '') {\n                const ruleKey = rule.split('=')[0];\n                let ruleValue = rule.split('=')[1];\n                if (ruleKey === 'COUNT' || ruleKey === 'UNTIL') {\n                    ruleValue = getRecurrenceStringFromDate(untilDate);\n                    rule = rule.replace(rule, 'UNTIL=' + ruleValue);\n                }\n                updatedRule += rule + ';';\n            }\n        }\n        if (isParent && updatedRule.indexOf('UNTIL') === -1) {\n            updatedRule += 'UNTIL=' + getRecurrenceStringFromDate(untilDate);\n        }\n        return updatedRule;\n    }\n    isBlockEvent(eventData) {\n        const eventCollection = (eventData instanceof Array) ? eventData : [eventData];\n        let value = false;\n        for (const event of eventCollection) {\n            value = event[this.parent.eventFields.isBlock] || false;\n        }\n        return value;\n    }\n    /**\n     * To destroy the crud module.\n     *\n     * @returns {void}\n     * @private\n     */\n    destroy() {\n        this.crudObj = null;\n        this.parent = null;\n    }\n}\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\n/**\n * Work cell interactions\n */\nclass WorkCellInteraction {\n    constructor(parent) {\n        this.parent = parent;\n        EventHandler.add(this.parent.element, 'mouseover', this.onHover, this);\n    }\n    cellMouseDown(e) {\n        if (this.isPreventAction(e)) {\n            return;\n        }\n        this.parent.notify(cellMouseDown, { event: e });\n    }\n    cellClick(e) {\n        if (this.isPreventAction(e)) {\n            return;\n        }\n        const queryStr = '.' + WORK_CELLS_CLASS + ',.' + ALLDAY_CELLS_CLASS + ',.' + HEADER_CELLS_CLASS;\n        const target = closest(e.target, queryStr);\n        if (isNullOrUndefined(target)) {\n            return;\n        }\n        if (!isNullOrUndefined(closest(e.target, '.' + NEW_EVENT_CLASS))) {\n            this.parent.eventWindow.openEditor(this.parent.activeCellsData, 'Add');\n            return;\n        }\n        const navigateEle = closest(e.target, '.' + NAVIGATE_CLASS);\n        const navigateView = this.parent.getNavigateView();\n        const sameView = this.parent.currentView === navigateView;\n        if (isNullOrUndefined(navigateEle) || sameView ||\n            isNullOrUndefined(this.parent.viewOptions[navigateView.charAt(0).toLowerCase() + navigateView.slice(1)])) {\n            if (this.parent.activeViewOptions.readonly && this.parent.currentView !== 'MonthAgenda') {\n                if (this.parent.quickPopup) {\n                    this.parent.quickPopup.quickPopupHide();\n                }\n                return;\n            }\n            if (this.parent.isAdaptive && (e.target.classList.contains(MORE_INDICATOR_CLASS) ||\n                closest(e.target, '.' + MORE_INDICATOR_CLASS))) {\n                return;\n            }\n            const isWorkCell = target.classList.contains(WORK_CELLS_CLASS) ||\n                target.classList.contains(ALLDAY_CELLS_CLASS);\n            if (isWorkCell && e.shiftKey && e.which === 1 && this.parent.keyboardInteractionModule) {\n                this.parent.keyboardInteractionModule.onMouseSelection(e);\n                return;\n            }\n            this.parent.activeCellsData = this.parent.getCellDetails(target);\n            const args = extend(this.parent.activeCellsData, { cancel: false, event: e, name: 'cellClick' });\n            this.parent.trigger(cellClick, args, (clickArgs) => {\n                if (!clickArgs.cancel) {\n                    if (isWorkCell) {\n                        this.parent.selectCell(target);\n                    }\n                    if (this.parent.allowInline) {\n                        const inlineArgs = {\n                            element: clickArgs.element,\n                            groupIndex: clickArgs.groupIndex, type: 'Cell'\n                        };\n                        this.parent.notify(inlineClick, inlineArgs);\n                    }\n                    else {\n                        this.parent.notify(cellClick, clickArgs);\n                    }\n                }\n                else {\n                    if (this.parent.quickPopup) {\n                        this.parent.quickPopup.quickPopupHide();\n                    }\n                }\n            });\n        }\n        else {\n            const date = this.parent.getDateFromElement(target);\n            if (!isNullOrUndefined(date) && !this.parent.isAdaptive && this.parent.isMinMaxDate(date)) {\n                this.parent.setProperties({ selectedDate: date }, true);\n                this.parent.changeView(this.parent.getNavigateView(), e);\n            }\n        }\n    }\n    cellDblClick(e) {\n        const queryStr = '.' + WORK_CELLS_CLASS + ',.' + ALLDAY_CELLS_CLASS + ',.' + HEADER_CELLS_CLASS;\n        const target = closest(e.target, queryStr);\n        if (this.parent.activeViewOptions.readonly || this.isPreventAction(e) || isNullOrUndefined(target)) {\n            return;\n        }\n        const args = extend(this.parent.activeCellsData, { cancel: false, event: e, name: 'cellDoubleClick' });\n        this.parent.trigger(cellDoubleClick, args, (clickArgs) => {\n            const date = new Date(clickArgs.startTime.getTime());\n            if (!this.parent.isMinMaxDate(new Date(date.setHours(0, 0, 0, 0)))) {\n                return;\n            }\n            if (!clickArgs.cancel) {\n                this.parent.eventWindow.openEditor(this.parent.activeCellsData, 'Add');\n            }\n        });\n    }\n    onHover(e) {\n        const targetSelector = '.' + WORK_CELLS_CLASS + ',.' + TIME_SLOT_CLASS + ',.' + ALLDAY_CELLS_CLASS + ',.' +\n            HEADER_CELLS_CLASS + ',.' + RESOURCE_CELLS_CLASS + ',.' + APPOINTMENT_CLASS + ',.' + WEEK_NUMBER_CLASS +\n            ',.' + MONTH_HEADER_CLASS;\n        const hoverTarget = closest(e.target, targetSelector);\n        if (hoverTarget) {\n            const hoverArgs = { element: hoverTarget, event: e };\n            this.parent.trigger(hover, hoverArgs);\n        }\n    }\n    isPreventAction(e) {\n        if (closest(e.target, '.' + NAVIGATE_CLASS)) {\n            return false;\n        }\n        if (closest(e.target, '.' + APPOINTMENT_WRAPPER_CLASS) &&\n            !closest(e.target, '.' + MORE_INDICATOR_CLASS)) {\n            return true;\n        }\n        let target = closest(e.target, '.' + APPOINTMENT_CLASS + ',.' + RESOURCE_GROUP_CELLS_CLASS);\n        if (!isNullOrUndefined(target)) {\n            return true;\n        }\n        target = closest(e.target, '.' + HEADER_CELLS_CLASS);\n        if (this.parent.activeView.isTimelineView() && !isNullOrUndefined(target)) {\n            return true;\n        }\n        return false;\n    }\n    destroy() {\n        EventHandler.remove(this.parent.element, 'mouseover', this.onHover);\n    }\n}\n\nvar __decorate$8 = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n/* eslint-disable @typescript-eslint/no-explicit-any */\n/**\n * Configuration that applies on each appointment field options of scheduler.\n */\nclass FieldOptions extends ChildProperty {\n}\n__decorate$8([\n    Property()\n], FieldOptions.prototype, \"name\", void 0);\n__decorate$8([\n    Property()\n], FieldOptions.prototype, \"default\", void 0);\n__decorate$8([\n    Property()\n], FieldOptions.prototype, \"title\", void 0);\n__decorate$8([\n    Property({})\n], FieldOptions.prototype, \"validation\", void 0);\n\nvar __decorate$7 = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n/**\n * A Class that holds the collection of event fields that requires to be mapped with the dataSource\n * fields along with its available configuration settings. Each field in it accepts both string and Object\n *  data type. When each of the field is assigned with simple `string` value, it is assumed that the dataSource field\n *  name is mapped with it. If the `object` type is defined on each fields, then the validation related settings and mapping of\n *  those fields with dataSource can be given altogether within it.\n */\nclass Field extends ChildProperty {\n}\n__decorate$7([\n    Property('Id')\n], Field.prototype, \"id\", void 0);\n__decorate$7([\n    Property('IsBlock')\n], Field.prototype, \"isBlock\", void 0);\n__decorate$7([\n    Complex({ name: 'Subject' }, FieldOptions)\n], Field.prototype, \"subject\", void 0);\n__decorate$7([\n    Complex({ name: 'StartTime' }, FieldOptions)\n], Field.prototype, \"startTime\", void 0);\n__decorate$7([\n    Complex({ name: 'EndTime' }, FieldOptions)\n], Field.prototype, \"endTime\", void 0);\n__decorate$7([\n    Complex({ name: 'StartTimezone' }, FieldOptions)\n], Field.prototype, \"startTimezone\", void 0);\n__decorate$7([\n    Complex({ name: 'EndTimezone' }, FieldOptions)\n], Field.prototype, \"endTimezone\", void 0);\n__decorate$7([\n    Complex({ name: 'Location' }, FieldOptions)\n], Field.prototype, \"location\", void 0);\n__decorate$7([\n    Complex({ name: 'Description' }, FieldOptions)\n], Field.prototype, \"description\", void 0);\n__decorate$7([\n    Complex({ name: 'IsAllDay' }, FieldOptions)\n], Field.prototype, \"isAllDay\", void 0);\n__decorate$7([\n    Complex({ name: 'RecurrenceID' }, FieldOptions)\n], Field.prototype, \"recurrenceID\", void 0);\n__decorate$7([\n    Complex({ name: 'RecurrenceRule' }, FieldOptions)\n], Field.prototype, \"recurrenceRule\", void 0);\n__decorate$7([\n    Complex({ name: 'RecurrenceException' }, FieldOptions)\n], Field.prototype, \"recurrenceException\", void 0);\n__decorate$7([\n    Property('IsReadonly')\n], Field.prototype, \"isReadonly\", void 0);\n__decorate$7([\n    Property('FollowingID')\n], Field.prototype, \"followingID\", void 0);\n\nvar __decorate$6 = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n/* eslint-disable @typescript-eslint/no-explicit-any */\n/**\n * Holds the configuration of event related options and dataSource binding to Schedule.\n */\nclass EventSettings extends ChildProperty {\n}\n__decorate$6([\n    Property()\n], EventSettings.prototype, \"template\", void 0);\n__decorate$6([\n    Property([])\n], EventSettings.prototype, \"dataSource\", void 0);\n__decorate$6([\n    Property()\n], EventSettings.prototype, \"query\", void 0);\n__decorate$6([\n    Complex({}, Field)\n], EventSettings.prototype, \"fields\", void 0);\n__decorate$6([\n    Property(false)\n], EventSettings.prototype, \"enableTooltip\", void 0);\n__decorate$6([\n    Property('AllDayRow')\n], EventSettings.prototype, \"spannedEventPlacement\", void 0);\n__decorate$6([\n    Property(1)\n], EventSettings.prototype, \"minimumEventDuration\", void 0);\n__decorate$6([\n    Property()\n], EventSettings.prototype, \"tooltipTemplate\", void 0);\n__decorate$6([\n    Property()\n], EventSettings.prototype, \"resourceColorField\", void 0);\n__decorate$6([\n    Property(false)\n], EventSettings.prototype, \"editFollowingEvents\", void 0);\n__decorate$6([\n    Property(true)\n], EventSettings.prototype, \"allowAdding\", void 0);\n__decorate$6([\n    Property(true)\n], EventSettings.prototype, \"allowEditing\", void 0);\n__decorate$6([\n    Property(true)\n], EventSettings.prototype, \"allowDeleting\", void 0);\n__decorate$6([\n    Property(false)\n], EventSettings.prototype, \"enableMaxHeight\", void 0);\n__decorate$6([\n    Property(false)\n], EventSettings.prototype, \"enableIndicator\", void 0);\n__decorate$6([\n    Property(false)\n], EventSettings.prototype, \"ignoreWhitespace\", void 0);\n__decorate$6([\n    Property()\n], EventSettings.prototype, \"sortComparer\", void 0);\n\nvar __decorate$9 = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n/**\n * A class that holds the resource grouping related configurations on Schedule.\n */\nclass Group extends ChildProperty {\n}\n__decorate$9([\n    Property(false)\n], Group.prototype, \"byDate\", void 0);\n__decorate$9([\n    Property(true)\n], Group.prototype, \"byGroupID\", void 0);\n__decorate$9([\n    Property(false)\n], Group.prototype, \"allowGroupEdit\", void 0);\n__decorate$9([\n    Property([])\n], Group.prototype, \"resources\", void 0);\n__decorate$9([\n    Property(true)\n], Group.prototype, \"enableCompactView\", void 0);\n__decorate$9([\n    Property()\n], Group.prototype, \"headerTooltipTemplate\", void 0);\n\nvar __decorate$10 = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n/* eslint-disable @typescript-eslint/no-explicit-any */\n/**\n * A class that represents the resource related configurations and its data binding options.\n */\nclass Resources extends ChildProperty {\n}\n__decorate$10([\n    Property()\n], Resources.prototype, \"field\", void 0);\n__decorate$10([\n    Property()\n], Resources.prototype, \"title\", void 0);\n__decorate$10([\n    Property()\n], Resources.prototype, \"name\", void 0);\n__decorate$10([\n    Property(false)\n], Resources.prototype, \"allowMultiple\", void 0);\n__decorate$10([\n    Property([])\n], Resources.prototype, \"dataSource\", void 0);\n__decorate$10([\n    Property()\n], Resources.prototype, \"query\", void 0);\n__decorate$10([\n    Property('Id')\n], Resources.prototype, \"idField\", void 0);\n__decorate$10([\n    Property('Text')\n], Resources.prototype, \"textField\", void 0);\n__decorate$10([\n    Property('Expanded')\n], Resources.prototype, \"expandedField\", void 0);\n__decorate$10([\n    Property('GroupID')\n], Resources.prototype, \"groupIDField\", void 0);\n__decorate$10([\n    Property('Color')\n], Resources.prototype, \"colorField\", void 0);\n__decorate$10([\n    Property('StartHour')\n], Resources.prototype, \"startHourField\", void 0);\n__decorate$10([\n    Property('EndHour')\n], Resources.prototype, \"endHourField\", void 0);\n__decorate$10([\n    Property('WorkDays')\n], Resources.prototype, \"workDaysField\", void 0);\n__decorate$10([\n    Property('CssClass')\n], Resources.prototype, \"cssClassField\", void 0);\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\n/* eslint-disable max-len */\nclass ResourceBase {\n    constructor(parent) {\n        this.resourceCollection = [];\n        this.leftPixel = 25;\n        this.parent = parent;\n    }\n    renderResourceHeaderIndent(tr) {\n        const resColTd = createElement('td', { className: RESOURCE_LEFT_TD_CLASS });\n        const resColDiv = createElement('div', { className: RESOURCE_TEXT_CLASS });\n        if (this.parent.activeViewOptions.headerIndentTemplate) {\n            const data = { className: [resColTd.className], type: 'emptyCells' };\n            this.parent.renderHeaderIndentTemplate(data, resColTd);\n        }\n        else {\n            resColTd.appendChild(resColDiv);\n        }\n        const args = { elementType: 'emptyCells', element: resColTd };\n        this.parent.trigger(renderCell, args);\n        tr.appendChild(resColTd);\n    }\n    hideResourceRows(tBody) {\n        if (this.resourceCollection.length <= 1 || this.parent.virtualScrollModule) {\n            return;\n        }\n        const trCount = this.lastResourceLevel.length;\n        for (let i = 0; i < trCount; i++) {\n            const resData = this.lastResourceLevel[i].resourceData;\n            const res = this.lastResourceLevel[i].resource;\n            if (resData.ClassName === RESOURCE_PARENT_CLASS && !resData[res.expandedField] &&\n                !isNullOrUndefined(resData[res.expandedField])) {\n                const trCollection = [].slice.call(tBody.children);\n                const slicedCollection = trCollection.slice(i + 1, i + (parseInt(resData.Count, 10) + 1));\n                addClass(slicedCollection, HIDDEN_CLASS);\n            }\n        }\n    }\n    createResourceColumn() {\n        const resColl = this.resourceCollection;\n        const resDiv = createElement('div', { className: RESOURCE_COLUMN_WRAP_CLASS });\n        const tbl = this.parent.activeView.createTableLayout(RESOURCE_COLUMN_TABLE_CLASS);\n        if (!this.parent.uiStateValues.isGroupAdaptive && this.parent.rowAutoHeight && this.parent.activeView.isTimelineView()\n            && this.parent.activeViewOptions.group.resources.length > 0) {\n            addClass([tbl], AUTO_HEIGHT);\n        }\n        const tBody = tbl.querySelector('tbody');\n        let resData = this.generateTreeData(true);\n        this.countCalculation(resColl.slice(0, -2), resColl.slice(0, -1));\n        this.renderedResources = this.lastResourceLevel;\n        if (this.parent.virtualScrollModule) {\n            const resourceCount = this.parent.virtualScrollModule.getRenderedCount();\n            this.setExpandedResources();\n            resData = this.expandedResources.slice(0, resourceCount);\n            this.renderedResources = resData;\n        }\n        append(this.getContentRows(resData), tBody);\n        this.hideResourceRows(tBody);\n        tbl.appendChild(tBody);\n        resDiv.appendChild(tbl);\n        return resDiv;\n    }\n    setRenderedResources() {\n        const resColl = this.resourceCollection;\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        const temp = this.generateTreeData(true);\n        this.countCalculation(resColl.slice(0, -2), resColl.slice(0, -1));\n        this.renderedResources = this.lastResourceLevel;\n    }\n    setExpandedResources() {\n        const resources = [];\n        for (let i = 0; i < this.lastResourceLevel.length; i++) {\n            const resource = this.lastResourceLevel[i].resourceData;\n            const count = resource.Count;\n            resources.push(this.lastResourceLevel[i]);\n            const isExpanded = resource[this.lastResourceLevel[i].resource.expandedField];\n            if (!isNullOrUndefined(isExpanded) && !isExpanded && count > 0) {\n                i = i + count;\n            }\n        }\n        this.expandedResources = resources;\n    }\n    getContentRows(resData, isVirtualScroll) {\n        const resRows = [];\n        let left;\n        let rIndex;\n        const resColl = this.resourceCollection;\n        const tr = createElement('tr');\n        const td = createElement('td', { attrs: { tabindex: isVirtualScroll ? '-1' : '0' } });\n        for (let i = 0; i < resData.length; i++) {\n            const ntd = td.cloneNode();\n            rIndex = findIndexInData(resColl, 'name', resData[i].resource.name);\n            if (rIndex === resColl.length - 1) {\n                extend(resData[i].resourceData, { ClassName: RESOURCE_CHILD_CLASS });\n                this.renderedResources[i].className = [RESOURCE_CHILD_CLASS];\n            }\n            else {\n                extend(resData[i].resourceData, { ClassName: RESOURCE_PARENT_CLASS });\n                this.renderedResources[i].className = [RESOURCE_PARENT_CLASS];\n            }\n            left = (rIndex * this.leftPixel) + 'px';\n            if (resData[i].resourceData.ClassName === RESOURCE_PARENT_CLASS\n                && !isNullOrUndefined(resData[i].resourceData.Count) && (resData[i].resourceData.Count > 0)) {\n                let iconClass;\n                if (resData[i].resourceData[resColl[rIndex].expandedField] ||\n                    isNullOrUndefined(resData[i].resourceData[resColl[rIndex].expandedField])) {\n                    iconClass = RESOURCE_COLLAPSE_CLASS;\n                }\n                else {\n                    iconClass = RESOURCE_EXPAND_CLASS;\n                }\n                const iconDiv = createElement('div');\n                addClass([iconDiv], [RESOURCE_TREE_ICON_CLASS, iconClass]);\n                this.setMargin(iconDiv, left);\n                ntd.appendChild(iconDiv);\n                if (this.resourceCollection.length > 1) {\n                    EventHandler.add(iconDiv, 'click', this.onTreeIconClick, this);\n                }\n            }\n            this.parent.activeView.setResourceHeaderContent(ntd, resData[i], RESOURCE_TEXT_CLASS);\n            ntd.setAttribute('data-group-index', resData[i].groupIndex.toString());\n            ntd.setAttribute('aria-label', resData[i].resourceData[resData[i].resource.textField] + ' resource');\n            if (!this.parent.activeViewOptions.resourceHeaderTemplate) {\n                this.setMargin(ntd.querySelector('.' + RESOURCE_TEXT_CLASS), left);\n            }\n            const classCollection = [RESOURCE_CELLS_CLASS, resData[i].resourceData.ClassName];\n            addClass([ntd], classCollection);\n            const args = { elementType: 'resourceHeader', element: ntd, groupIndex: resData[i].groupIndex };\n            this.parent.trigger(renderCell, args);\n            const ntr = tr.cloneNode();\n            ntr.appendChild(ntd);\n            resRows.push(ntr);\n        }\n        return resRows;\n    }\n    setMargin(element, value) {\n        if (!this.parent.enableRtl) {\n            element.style.marginLeft = value;\n        }\n        else {\n            element.style.marginRight = value;\n        }\n    }\n    countCalculation(parentCollection, wholeCollection) {\n        let collection;\n        for (let y = 0; y < parentCollection.length; y++) {\n            const data = parentCollection[parentCollection.length - (y + 1)].dataSource;\n            for (let x = 0; x < data.length; x++) {\n                let totalCount = 0;\n                if (this.parent.activeViewOptions.group.byGroupID) {\n                    const query = new Query().where(wholeCollection[wholeCollection.length - 1].groupIDField, 'equal', data[x][parentCollection[parentCollection.length - (y + 1)].idField]);\n                    collection = new DataManager(wholeCollection[wholeCollection.length - 1].dataSource).executeLocal(query);\n                }\n                else {\n                    collection = wholeCollection[wholeCollection.length - 1].dataSource;\n                }\n                for (let z = 0; z < collection.length; z++) {\n                    totalCount = totalCount + parseInt(collection[z].Count, 10);\n                }\n                totalCount = totalCount + parseInt(data[x].Count, 10);\n                extend(data[x], { Count: totalCount });\n            }\n            wholeCollection = wholeCollection.slice(0, -1);\n        }\n    }\n    onTreeIconClick(e) {\n        if (this.parent.eventTooltip) {\n            this.parent.eventTooltip.close();\n        }\n        const target = e.target;\n        let hide;\n        const trElement = closest(target, '.' + RESOURCE_PARENT_CLASS)\n            .parentElement;\n        const index = parseInt(trElement.children[0].getAttribute('data-group-index'), 10);\n        let args = {\n            cancel: false, event: e, groupIndex: index,\n            requestType: !target.classList.contains(RESOURCE_COLLAPSE_CLASS) ? 'resourceExpand' : 'resourceCollapse'\n        };\n        this.parent.trigger(actionBegin, args, (actionArgs) => {\n            if (!actionArgs.cancel) {\n                if (target.classList.contains(RESOURCE_COLLAPSE_CLASS)) {\n                    classList(target, [RESOURCE_EXPAND_CLASS], [RESOURCE_COLLAPSE_CLASS]);\n                    hide = true;\n                }\n                else {\n                    classList(target, [RESOURCE_COLLAPSE_CLASS], [RESOURCE_EXPAND_CLASS]);\n                    hide = false;\n                }\n                const eventElements = [].slice.call(this.parent.element.querySelectorAll('.' + APPOINTMENT_CLASS));\n                for (const element of eventElements) {\n                    remove(element);\n                }\n                if (this.parent.virtualScrollModule) {\n                    this.updateVirtualContent(index, hide, e, target);\n                }\n                else {\n                    this.updateContent(index, hide);\n                }\n                const data = { cssProperties: this.parent.getCssProperties(), module: 'scroll' };\n                this.parent.notify(scrollUiUpdate, data);\n                args = {\n                    cancel: false, event: e, groupIndex: index,\n                    requestType: target.classList.contains(RESOURCE_COLLAPSE_CLASS) ? 'resourceExpanded' : 'resourceCollapsed'\n                };\n                this.parent.refreshEvents(false);\n                this.parent.trigger(actionComplete, args);\n            }\n        });\n    }\n    updateContent(index, hide) {\n        const rowCollection = [];\n        const workCellCollection = [];\n        const headerRowCollection = [];\n        let pNode;\n        const clickedRes = this.lastResourceLevel[index].resourceData;\n        const resRows = [].slice.call(this.parent.element.querySelectorAll('.' + RESOURCE_COLUMN_WRAP_CLASS + ' ' + 'tr'));\n        const contentRows = [].slice.call(this.parent.element.querySelectorAll('.' + CONTENT_WRAP_CLASS + ' ' + 'tbody tr'));\n        const eventRows = [].slice.call(this.parent.element.querySelectorAll('.' + CONTENT_WRAP_CLASS + ' .' + APPOINTMENT_CONTAINER_CLASS));\n        for (let j = 0; j < clickedRes.Count; j++) {\n            rowCollection.push(resRows[index + j + 1]);\n            workCellCollection.push(contentRows[index + j + 1]);\n            headerRowCollection.push(eventRows[index + j + 1]);\n        }\n        const clonedCollection = this.lastResourceLevel;\n        for (let i = 0; i < rowCollection.length; i++) {\n            let expanded = true;\n            pNode = rowCollection[i].children[0].classList.contains(RESOURCE_PARENT_CLASS);\n            clonedCollection[index].resourceData[clonedCollection[index].resource.expandedField] = !hide;\n            if (hide) {\n                if (pNode) {\n                    const trElem = rowCollection[i].querySelector('.' + RESOURCE_TREE_ICON_CLASS);\n                    if (trElem) {\n                        classList(trElem, [RESOURCE_EXPAND_CLASS], [RESOURCE_COLLAPSE_CLASS]);\n                    }\n                }\n                if (!rowCollection[i].classList.contains(HIDDEN_CLASS)) {\n                    addClass([rowCollection[i], workCellCollection[i], headerRowCollection[i]], HIDDEN_CLASS);\n                }\n            }\n            else {\n                if (pNode) {\n                    const rowIndex = rowCollection[i].rowIndex;\n                    if (!clonedCollection[rowIndex].resourceData[clonedCollection[rowIndex].resource.expandedField]\n                        && !isNullOrUndefined(clonedCollection[rowIndex].resourceData[clonedCollection[rowIndex].resource.expandedField])) {\n                        rowCollection.splice(i + 1, (parseInt(clonedCollection[rowIndex].resourceData.Count, 10)));\n                        workCellCollection.splice(i + 1, (parseInt(clonedCollection[rowIndex].resourceData.Count, 10)));\n                        headerRowCollection.splice(i + 1, (parseInt(clonedCollection[rowIndex].resourceData.Count, 10)));\n                        expanded = false;\n                    }\n                    if (expanded) {\n                        const trElem = rowCollection[i].querySelector('.' + RESOURCE_TREE_ICON_CLASS);\n                        if (trElem) {\n                            classList(trElem, [RESOURCE_COLLAPSE_CLASS], [RESOURCE_EXPAND_CLASS]);\n                        }\n                    }\n                }\n                if (rowCollection[i].classList.contains(HIDDEN_CLASS)) {\n                    removeClass([rowCollection[i], workCellCollection[i], headerRowCollection[i]], HIDDEN_CLASS);\n                }\n            }\n        }\n    }\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    updateVirtualContent(index, expand, e, target) {\n        this.lastResourceLevel[index].resourceData[this.lastResourceLevel[index].resource.expandedField] = !expand;\n        this.setExpandedResources();\n        const resourceCount = this.parent.virtualScrollModule.getRenderedCount();\n        const startIndex = this.expandedResources.indexOf(this.renderedResources[0]);\n        this.renderedResources = this.expandedResources.slice(startIndex, startIndex + resourceCount);\n        if (this.renderedResources.length < resourceCount) {\n            let sIndex = this.expandedResources.length - resourceCount;\n            sIndex = (sIndex > 0) ? sIndex : 0;\n            this.renderedResources = this.expandedResources.slice(sIndex, this.expandedResources.length);\n        }\n        const virtualTrack = this.parent.element.querySelector('.' + VIRTUAL_TRACK_CLASS);\n        this.parent.virtualScrollModule.updateVirtualTrackHeight(virtualTrack);\n        const resTable = this.parent.element.querySelector('.' + RESOURCE_COLUMN_WRAP_CLASS + ' ' + 'table');\n        const contentTable = this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS + ' ' + 'table');\n        const eventTable = this.parent.element.querySelector('.' + EVENT_TABLE_CLASS);\n        this.parent.virtualScrollModule.updateContent(resTable, contentTable, eventTable, this.renderedResources);\n        const timeIndicator = this.parent.element.querySelector('.' + CURRENT_TIMELINE_CLASS);\n        if (!isNullOrUndefined(timeIndicator)) {\n            timeIndicator.style.height =\n                this.parent.element.querySelector('.' + CONTENT_TABLE_CLASS).offsetHeight + 'px';\n        }\n    }\n    renderResourceHeader() {\n        const resourceWrapper = createElement('div', { className: RESOURCE_TOOLBAR_CONTAINER });\n        resourceWrapper.innerHTML = '<div class=\"' + RESOURCE_HEADER_TOOLBAR + '\"><div class=\"' + RESOURCE_MENU + '\">' +\n            '<div class=\"e-icons ' + RESOURCE_MENU_ICON + '\"></div></div><div class=\"' + RESOURCE_LEVEL_TITLE + '\"></div></div>';\n        if (this.parent.currentView === 'MonthAgenda') {\n            const target = this.parent.activeView.getPanel().querySelector('.' + CONTENT_WRAP_CLASS);\n            target.insertBefore(resourceWrapper, target.querySelector('.' + WRAPPER_CONTAINER_CLASS));\n        }\n        else {\n            this.parent.element.insertBefore(resourceWrapper, this.parent.element.querySelector('.' + TABLE_CONTAINER_CLASS));\n        }\n        this.renderResourceHeaderText();\n        EventHandler.add(resourceWrapper.querySelector('.' + RESOURCE_MENU_ICON), 'click', this.menuClick, this);\n    }\n    renderResourceTree() {\n        this.popupOverlay = createElement('div', { className: RESOURCE_TREE_POPUP_OVERLAY });\n        const treeWrapper = createElement('div', { className: RESOURCE_TREE_POPUP + ' e-popup-close' });\n        if (this.parent.currentView === 'MonthAgenda') {\n            const target = this.parent.activeView.getPanel().querySelector('.' + WRAPPER_CONTAINER_CLASS);\n            target.insertBefore(treeWrapper, target.children[0]);\n            target.appendChild(this.popupOverlay);\n        }\n        else {\n            this.parent.element.querySelector('.' + TABLE_CONTAINER_CLASS).appendChild(treeWrapper);\n            this.parent.element.querySelector('.' + TABLE_CONTAINER_CLASS).appendChild(this.popupOverlay);\n        }\n        const resourceTree = createElement('div', { className: RESOURCE_TREE });\n        treeWrapper.appendChild(resourceTree);\n        this.treeViewObj = new TreeView({\n            cssClass: this.parent.cssClass,\n            enableRtl: this.parent.enableRtl,\n            fields: {\n                dataSource: [].slice.call(this.generateTreeData()),\n                id: 'resourceId',\n                text: 'resourceName',\n                child: 'resourceChild'\n            },\n            nodeTemplate: this.parent.resourceHeaderTemplate,\n            nodeClicked: this.resourceClick.bind(this)\n        });\n        this.treeViewObj.appendTo(resourceTree);\n        this.treeViewObj.expandAll();\n        this.treePopup = new Popup(treeWrapper, {\n            targetType: 'relative',\n            actionOnScroll: 'none',\n            content: this.treeViewObj.element,\n            relateTo: this.parent.element.querySelector('.' + TABLE_CONTAINER_CLASS),\n            enableRtl: this.parent.enableRtl,\n            hideAnimation: { name: 'SlideLeftOut', duration: 500 },\n            showAnimation: { name: 'SlideLeftIn', duration: 500 },\n            viewPortElement: this.parent.element.querySelector('.' + (this.parent.currentView === 'MonthAgenda' ?\n                WRAPPER_CONTAINER_CLASS : TABLE_CONTAINER_CLASS))\n        });\n        this.parent.on(documentClick, this.documentClick, this);\n    }\n    generateTreeData(isTimeLine) {\n        const treeCollection = [];\n        const resTreeColl = [];\n        let groupIndex = 0;\n        for (let i = 0, len = this.resourceTreeLevel.length; i < len; i++) {\n            const treeHandler = (treeLevel, index, levelId) => {\n                const resource = this.resourceCollection[index];\n                let treeArgs;\n                let resObj;\n                if (!isTimeLine) {\n                    treeArgs = {\n                        resourceId: levelId,\n                        resourceName: treeLevel.resourceData[resource.textField],\n                        resource: treeLevel.resource,\n                        resourceData: treeLevel.resourceData\n                    };\n                }\n                else {\n                    resObj = {\n                        type: 'resourceHeader', resource: treeLevel.resource,\n                        resourceData: treeLevel.resourceData, groupIndex: groupIndex,\n                        groupOrder: treeLevel.groupOrder\n                    };\n                    resTreeColl.push(resObj);\n                    groupIndex++;\n                }\n                if (treeLevel.child.length > 0 && !isTimeLine) {\n                    treeArgs.resourceChild = [];\n                }\n                let count = 1;\n                for (const tree of treeLevel.child) {\n                    if (!isTimeLine) {\n                        treeArgs.resourceChild.push(treeHandler(tree, index + 1, levelId + '-' + count));\n                    }\n                    else {\n                        treeHandler(tree, index + 1, levelId + '-' + count);\n                    }\n                    count += 1;\n                }\n                if (isTimeLine) {\n                    extend(resObj.resourceData, { Count: count - 1 });\n                }\n                return treeArgs;\n            };\n            if (!isTimeLine) {\n                treeCollection.push(treeHandler(this.resourceTreeLevel[i], 0, (i + 1).toString()));\n            }\n            else {\n                treeHandler(this.resourceTreeLevel[i], 0, (i + 1).toString());\n            }\n        }\n        if (isTimeLine) {\n            this.lastResourceLevel = resTreeColl;\n            return resTreeColl;\n        }\n        else {\n            return treeCollection;\n        }\n    }\n    renderResourceHeaderText() {\n        const resource = this.lastResourceLevel[this.parent.uiStateValues.groupIndex];\n        const headerCollection = [];\n        for (let i = 0, len = resource.groupOrder.length; i < len; i++) {\n            const resourceLevel = this.resourceCollection[i];\n            const resourceText = resourceLevel.dataSource.filter((resData) => resData[resourceLevel.idField] === resource.groupOrder[i]);\n            const resourceName = createElement('div', {\n                className: RESOURCE_NAME,\n                innerHTML: resourceText[0][resourceLevel.textField]\n            });\n            headerCollection.push(resourceName);\n            const levelIcon = createElement('div', { className: 'e-icons e-icon-next' });\n            headerCollection.push(levelIcon);\n        }\n        headerCollection.pop();\n        const target = (this.parent.currentView === 'MonthAgenda') ? this.parent.activeView.getPanel() : this.parent.element;\n        const headerWrapper = target.querySelector('.' + RESOURCE_LEVEL_TITLE);\n        removeChildren(headerWrapper);\n        for (const header of headerCollection) {\n            headerWrapper.appendChild(header);\n        }\n        if (this.lastResourceLevel.length === 1) {\n            addClass([this.parent.element.querySelector('.' + RESOURCE_MENU)], DISABLE_CLASS);\n        }\n    }\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    menuClick(event) {\n        if (this.parent.element.querySelector('.' + RESOURCE_TREE_POPUP).classList.contains(POPUP_OPEN)) {\n            this.treePopup.hide();\n            removeClass([this.popupOverlay], ENABLE_CLASS);\n        }\n        else {\n            const treeNodes = [].slice.call(this.treeViewObj.element.querySelectorAll('.e-list-item:not(.e-has-child)'));\n            removeClass(treeNodes, 'e-active');\n            addClass([treeNodes[this.parent.uiStateValues.groupIndex]], 'e-active');\n            this.treePopup.show();\n            addClass([this.popupOverlay], ENABLE_CLASS);\n        }\n    }\n    selectResourceByIndex(groupIndex) {\n        if (this.lastResourceLevel && groupIndex > -1 && groupIndex < this.lastResourceLevel.length) {\n            this.triggerEvents(groupIndex);\n        }\n    }\n    resourceClick(event) {\n        if (!event.node.classList.contains('e-has-child')) {\n            this.treePopup.hide();\n            removeClass([this.popupOverlay], ENABLE_CLASS);\n            const treeNodes = [].slice.call(this.treeViewObj.element.querySelectorAll('.e-list-item:not(.e-has-child)'));\n            const groupIndex = treeNodes.indexOf(event.node);\n            this.triggerEvents(groupIndex, event);\n            event.event.preventDefault();\n        }\n    }\n    triggerEvents(groupIndex, event) {\n        let args = { cancel: false, event: (event) ? event.event : null, groupIndex: groupIndex, requestType: 'resourceChange' };\n        this.parent.trigger(actionBegin, args, (actionArgs) => {\n            if (!actionArgs.cancel) {\n                this.parent.uiStateValues.groupIndex = actionArgs.groupIndex;\n                this.parent.renderModule.render(this.parent.currentView);\n                args = {\n                    cancel: false, event: (event) ? event.event : null, groupIndex: this.parent.uiStateValues.groupIndex, requestType: 'resourceChanged'\n                };\n                this.parent.trigger(actionComplete, args);\n            }\n        });\n    }\n    documentClick(args) {\n        if (closest(args.event.target, '.' + RESOURCE_TREE_POPUP)) {\n            return;\n        }\n        const treeWrapper = this.parent.element.querySelector('.' + RESOURCE_TREE_POPUP);\n        if (treeWrapper && treeWrapper.classList.contains(POPUP_OPEN)) {\n            this.treePopup.hide();\n            removeClass([this.popupOverlay], ENABLE_CLASS);\n        }\n    }\n    bindResourcesData(isSetModel) {\n        this.parent.showSpinner();\n        const promises = [];\n        for (const resource of this.parent.resources) {\n            const dataModule = new Data(resource.dataSource, resource.query);\n            promises.push(dataModule.getData(dataModule.generateQuery()));\n        }\n        Promise.all(promises).then((e) => this.dataManagerSuccess(e, isSetModel))\n            .catch((e) => this.parent.crudModule.dataManagerFailure(e));\n    }\n    dataManagerSuccess(e, isSetModel) {\n        if (!this.parent || this.parent && this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.resourceCollection = [];\n        for (let i = 0, length = e.length; i < length; i++) {\n            const resource = this.parent.resources[i];\n            const resourceObj = this.getResourceModel(resource, e[i].result);\n            this.parent.resourceCollection.push(resourceObj);\n        }\n        this.refreshLayout(isSetModel);\n    }\n    getResourceModel(resource, resourceData) {\n        const resourceObj = {\n            field: resource.field,\n            title: resource.title,\n            name: resource.name,\n            allowMultiple: resource.allowMultiple,\n            dataSource: resourceData || resource.dataSource,\n            idField: resource.idField,\n            textField: resource.textField,\n            groupIDField: resource.groupIDField,\n            colorField: resource.colorField,\n            startHourField: resource.startHourField,\n            endHourField: resource.endHourField,\n            workDaysField: resource.workDaysField,\n            expandedField: resource.expandedField,\n            cssClassField: resource.cssClassField\n        };\n        return resourceObj;\n    }\n    refreshLayout(isSetModel) {\n        if (isNullOrUndefined(this.parent.uiStateValues.groupIndex) || !(this.parent.enablePersistence)) {\n            this.parent.uiStateValues.groupIndex = 0;\n        }\n        this.parent.renderElements(isSetModel);\n    }\n    setResourceCollection() {\n        let requiredResources = [];\n        this.resourceCollection = [];\n        this.colorIndex = null;\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            for (const resource of this.parent.activeViewOptions.group.resources) {\n                const index = findIndexInData(this.parent.resourceCollection, 'name', resource);\n                if (index >= 0) {\n                    requiredResources.push(this.parent.resourceCollection[index]);\n                }\n            }\n        }\n        else if (this.parent.resourceCollection.length > 0) {\n            requiredResources = this.parent.resourceCollection;\n        }\n        let index = 0;\n        for (const resource of requiredResources) {\n            const resources = this.getResourceModel(resource);\n            if (resource.name === this.parent.eventSettings.resourceColorField) {\n                this.colorIndex = index;\n            }\n            index++;\n            this.resourceCollection.push(resources);\n        }\n        if (isNullOrUndefined(this.colorIndex)) {\n            this.colorIndex = this.resourceCollection.length - 1;\n        }\n    }\n    generateResourceLevels(innerDates, isTimeLine) {\n        const resources = this.resourceCollection;\n        const resTreeGroup = [];\n        let lastColumnDates = [];\n        const group = (resources, index, prevResource, prevResourceData, prevOrder) => {\n            const resTree = [];\n            const resource = resources[0];\n            if (resource) {\n                let data;\n                if (prevResourceData && this.parent.activeViewOptions.group.byGroupID) {\n                    const id = prevResourceData[prevResource.idField];\n                    data = resource.dataSource.filter((e) => e[resource.groupIDField] === id);\n                }\n                else {\n                    data = resource.dataSource;\n                }\n                for (let i = 0; i < data.length; i++) {\n                    let groupOrder = [];\n                    if (prevOrder && prevOrder.length > 0) {\n                        groupOrder = groupOrder.concat(prevOrder);\n                    }\n                    groupOrder.push(data[i][resource.idField]);\n                    const items = group(resources.slice(1), index + 1, resource, data[i], groupOrder);\n                    // Here validate child item empty top level resource only\n                    if (index === 0 && items.length === 0 && this.resourceCollection.length > 1) {\n                        continue;\n                    }\n                    let dateCol = [];\n                    let renderDates = this.parent.activeView.renderDates;\n                    let resWorkDays;\n                    if (!this.parent.activeViewOptions.group.byDate && index + 1 === this.resourceCollection.length) {\n                        const workDays = data[i][resource.workDaysField];\n                        const resStartHour = data[i][resource.startHourField];\n                        const resEndHour = data[i][resource.endHourField];\n                        if (workDays && workDays.length > 0) {\n                            renderDates = this.parent.activeView.getRenderDates(workDays);\n                            resWorkDays = workDays;\n                            dateCol = this.parent.activeView.getDateSlots(renderDates, workDays);\n                        }\n                        else {\n                            resWorkDays = this.parent.activeViewOptions.workDays;\n                            dateCol = innerDates;\n                        }\n                        const dateSlots = this.generateCustomHours(dateCol, resStartHour, resEndHour, groupOrder);\n                        lastColumnDates = lastColumnDates.concat(dateSlots);\n                    }\n                    const resCssClass = data[i][resource.cssClassField];\n                    const slotData = {\n                        type: 'resourceHeader', className: ['e-resource-cells'],\n                        resourceLevelIndex: index, groupOrder: groupOrder,\n                        resource: resource, resourceData: data[i],\n                        colSpan: this.parent.activeViewOptions.group.byDate ? 1 : dateCol.length,\n                        renderDates: renderDates, workDays: resWorkDays, cssClass: resCssClass,\n                        child: items\n                    };\n                    resTree.push(slotData);\n                }\n                if (!resTreeGroup[index]) {\n                    resTreeGroup[index] = [];\n                }\n                if (resTree.length > 0) {\n                    resTreeGroup[index].push(resTree);\n                }\n                return resTree;\n            }\n            return [];\n        };\n        this.resourceTreeLevel = group(resources, 0);\n        return (isTimeLine) ? [] : this.generateHeaderLevels(resTreeGroup, lastColumnDates, innerDates);\n    }\n    generateCustomHours(renderDates, startHour, endHour, groupOrder) {\n        const dateSlots = extend([], renderDates, null, true);\n        for (const dateSlot of dateSlots) {\n            if (startHour) {\n                dateSlot.startHour = this.parent.getStartEndTime(startHour);\n            }\n            if (endHour) {\n                dateSlot.endHour = this.parent.getStartEndTime(endHour);\n            }\n            if (groupOrder) {\n                dateSlot.groupOrder = groupOrder;\n            }\n        }\n        return dateSlots;\n    }\n    generateHeaderLevels(resTreeGroup, lastColumnDates, headerDates) {\n        const headerLevels = [];\n        for (let i = resTreeGroup.length - 1; i >= 0; i--) {\n            let temp = 0;\n            for (const currentLevelChilds of resTreeGroup[i]) {\n                for (const currentLevelChild of currentLevelChilds) {\n                    if (resTreeGroup[i + 1] && resTreeGroup[i + 1].length > 0) {\n                        const nextLevelChilds = resTreeGroup[i + 1][temp];\n                        if (!nextLevelChilds) {\n                            continue;\n                        }\n                        let colSpan = 0;\n                        for (const nextLevelChild of nextLevelChilds) {\n                            if (!this.parent.activeViewOptions.group.byGroupID || (this.parent.activeViewOptions.group.byGroupID &&\n                                nextLevelChild.resourceData[nextLevelChild.resource.groupIDField] ===\n                                    currentLevelChild.resourceData[currentLevelChild.resource.idField])) {\n                                colSpan += nextLevelChild.colSpan;\n                            }\n                        }\n                        currentLevelChild.colSpan = colSpan;\n                    }\n                    currentLevelChild.groupIndex = temp;\n                    temp++;\n                    headerLevels[currentLevelChild.resourceLevelIndex] = headerLevels[currentLevelChild.resourceLevelIndex] || [];\n                    headerLevels[currentLevelChild.resourceLevelIndex].push(currentLevelChild);\n                }\n            }\n        }\n        this.lastResourceLevel = headerLevels.slice(-1)[0] || [];\n        if (!this.parent.activeViewOptions.group.byDate) {\n            let index = 0;\n            for (const lastLevelResource of this.lastResourceLevel) {\n                for (let i = 0; i < lastLevelResource.colSpan; i++) {\n                    lastColumnDates[index].groupIndex = lastLevelResource.groupIndex;\n                    index++;\n                }\n            }\n            headerLevels.push(lastColumnDates);\n            return headerLevels;\n        }\n        const dateHeaderLevels = [];\n        const levels = extend([], headerLevels, null, true);\n        let dateColSpan = 0;\n        for (const firstRowTd of levels[0]) {\n            dateColSpan += firstRowTd.colSpan;\n        }\n        const datesColumn = [];\n        for (const headerDate of headerDates) {\n            headerDate.colSpan = dateColSpan;\n            datesColumn.push(headerDate);\n            const resGroup = extend([], levels, null, true);\n            for (let k = 0, length = resGroup.length; k < length; k++) {\n                if (k === resGroup.length - 1) {\n                    for (const resTd of resGroup[k]) {\n                        resTd.date = headerDate.date;\n                        resTd.workDays = headerDate.workDays;\n                        resTd.startHour = this.parent.getStartEndTime(resTd.resourceData[resTd.resource.startHourField]) ||\n                            headerDate.startHour;\n                        resTd.endHour = this.parent.getStartEndTime(resTd.resourceData[resTd.resource.endHourField]) ||\n                            headerDate.endHour;\n                    }\n                }\n                if (!dateHeaderLevels[k]) {\n                    dateHeaderLevels[k] = [];\n                }\n                dateHeaderLevels[k] = dateHeaderLevels[k].concat(resGroup[k]);\n            }\n        }\n        dateHeaderLevels.unshift(datesColumn);\n        return dateHeaderLevels;\n    }\n    setResourceValues(eventObj, groupIndex) {\n        const setValues = (index, field, value) => {\n            if (this.resourceCollection[index].allowMultiple && this.parent.activeViewOptions.group.allowGroupEdit) {\n                eventObj[field] = [value];\n            }\n            else {\n                eventObj[field] = value;\n            }\n        };\n        if (groupIndex === void 0) {\n            groupIndex = this.parent.uiStateValues.isGroupAdaptive ? this.parent.uiStateValues.groupIndex :\n                this.parent.activeCellsData.groupIndex;\n        }\n        if (this.parent.activeViewOptions.group.resources.length > 0 && !isNullOrUndefined(groupIndex)) {\n            const groupOrder = this.lastResourceLevel[groupIndex].groupOrder;\n            for (let index = 0; index < this.resourceCollection.length; index++) {\n                setValues(index, this.resourceCollection[index].field, groupOrder[index]);\n            }\n        }\n        else if (this.parent.resourceCollection.length > 0) {\n            for (let index = 0; index < this.resourceCollection.length; index++) {\n                const data = this.resourceCollection[index].dataSource[0];\n                if (data) {\n                    setValues(index, this.resourceCollection[index].field, data[this.resourceCollection[index].idField]);\n                }\n            }\n        }\n    }\n    getResourceColor(eventObj, groupOrder) {\n        const colorFieldIndex = (!isNullOrUndefined(groupOrder) &&\n            this.colorIndex > groupOrder.length - 1) ? groupOrder.length - 1 : this.colorIndex;\n        const resource = this.resourceCollection[colorFieldIndex];\n        if (isNullOrUndefined(groupOrder) && this.parent.activeViewOptions.group.allowGroupEdit && resource.allowMultiple) {\n            return undefined;\n        }\n        const id = isNullOrUndefined(groupOrder) ? eventObj[resource.field] : groupOrder[colorFieldIndex];\n        const data = this.filterData(resource.dataSource, resource.idField, id);\n        if (data.length > 0) {\n            return data[0][resource.colorField];\n        }\n        return undefined;\n    }\n    getCssClass(eventObj) {\n        const resource = this.resourceCollection.slice(-1)[0];\n        if (this.parent.activeViewOptions.group.allowGroupEdit && resource.allowMultiple) {\n            return undefined;\n        }\n        const data = this.filterData(resource.dataSource, resource.idField, eventObj[resource.field]);\n        if (data.length > 0) {\n            return data[0][resource.cssClassField];\n        }\n        return undefined;\n    }\n    getResourceRenderDates() {\n        // eslint-disable-next-line prefer-spread\n        const resourceDates = [].concat.apply([], this.lastResourceLevel.map((e) => e.renderDates));\n        const removeDuplicateDates = (dateColl) => dateColl.filter((date, index, dates) => dates.map((dateObj) => dateObj.getTime()).indexOf(date.getTime()) === index);\n        const renderDates = removeDuplicateDates(resourceDates);\n        renderDates.sort((a, b) => a.getTime() - b.getTime());\n        return renderDates;\n    }\n    filterData(dataSource, field, value) {\n        return dataSource.filter((data) => data[field] === value);\n    }\n    getResourceData(eventObj, index, groupEditIndex) {\n        if (this.parent.activeViewOptions.group.allowGroupEdit) {\n            const resourceObj = {};\n            for (const groupIndex of groupEditIndex) {\n                const resourceLevel = this.lastResourceLevel[groupIndex].groupOrder;\n                for (let level = 0, length = resourceLevel.length; level < length; level++) {\n                    const fieldName = this.resourceCollection[level].field;\n                    if (isNullOrUndefined(resourceObj[fieldName])) {\n                        resourceObj[fieldName] = [];\n                    }\n                    resourceObj[fieldName].push(resourceLevel[level]);\n                }\n            }\n            eventObj = extend(eventObj, resourceObj);\n        }\n        else {\n            for (let level = 0, length = this.resourceCollection.length; level < length; level++) {\n                if (this.lastResourceLevel[index]) {\n                    eventObj[this.resourceCollection[level].field] = this.lastResourceLevel[index].groupOrder[level];\n                }\n            }\n        }\n    }\n    addResource(resources, name, index) {\n        const resourceCollection = (resources instanceof Array) ? resources : [resources];\n        for (const resource of this.parent.resourceCollection) {\n            if (resource.name === name) {\n                resourceCollection.forEach((addObj, i) => new DataManager({ json: resource.dataSource }).insert(addObj, null, null, index + i));\n                break;\n            }\n        }\n        this.refreshLayout(true);\n    }\n    removeResource(resourceId, name) {\n        const resourceCollection = (resourceId instanceof Array) ? resourceId : [resourceId];\n        for (const resource of this.parent.resourceCollection) {\n            if (resource.name === name) {\n                resourceCollection.forEach((removeObj) => new DataManager({ json: resource.dataSource }).remove(resource.idField, removeObj));\n                break;\n            }\n        }\n        this.refreshLayout(true);\n    }\n    getIndexFromResourceId(id, name, resourceData, event, parentField) {\n        name = name || this.parent.resourceCollection.slice(-1)[0].name;\n        if (isNullOrUndefined(resourceData)) {\n            resourceData = this.resourceCollection.filter((e) => e.name === name)[0];\n            if (isNullOrUndefined(resourceData)) {\n                return null;\n            }\n        }\n        const resource = resourceData.dataSource.filter((e) => {\n            if (event && e[resourceData.idField] === id) {\n                if (e[resourceData.groupIDField] === event[parentField]) {\n                    return e[resourceData.idField] === id;\n                }\n                return null;\n            }\n            else {\n                return e[resourceData.idField] === id;\n            }\n        })[0];\n        return (this.lastResourceLevel.map((e) => e.resourceData).indexOf(resource));\n    }\n    resourceExpand(id, name, hide) {\n        const resource = this.parent.resourceCollection.filter((e) => {\n            if (e.name === name) {\n                return e;\n            }\n            return null;\n        })[0];\n        let index = 0;\n        const resourceData = resource.dataSource.filter((e) => e[resource.idField] === id)[0];\n        if (!this.parent.activeViewOptions.group.byGroupID) {\n            index = this.getIndexFromResourceId(id, name, resource);\n        }\n        else {\n            index = this.lastResourceLevel.map((e) => e.resourceData).indexOf(resourceData);\n        }\n        const target = this.parent.element.querySelector('.' + RESOURCE_COLUMN_WRAP_CLASS + ' ' + `[data-group-index=\"${index}\"]` +\n            ' ' + '.' + RESOURCE_TREE_ICON_CLASS);\n        if (target) {\n            if (target.classList.contains(RESOURCE_EXPAND_CLASS) && !hide) {\n                target.click();\n            }\n            else if (target.classList.contains(RESOURCE_COLLAPSE_CLASS) && hide) {\n                target.click();\n            }\n        }\n    }\n    resourceScroll(id, name) {\n        if (this.parent.isAdaptive || ['Agenda', 'MonthAgenda'].indexOf(this.parent.currentView) > -1) {\n            return;\n        }\n        const levelName = name || this.parent.resourceCollection.slice(-1)[0].name;\n        let levelIndex = this.parent.resourceCollection.length - 1;\n        const resource = this.parent.resourceCollection.filter((e, index) => {\n            if (e.name === levelName) {\n                levelIndex = index;\n                return e;\n            }\n            return null;\n        })[0];\n        const scrollElement = this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS);\n        let index = 0;\n        if (this.parent.activeView.isTimelineView()) {\n            if (!this.parent.activeViewOptions.group.byGroupID) {\n                index = this.getIndexFromResourceId(id, levelName, resource);\n            }\n            else {\n                const resourceData = resource.dataSource.filter((e) => e[resource.idField] === id)[0];\n                index = this.lastResourceLevel.map((e) => e.resourceData).indexOf(resourceData);\n            }\n            if (this.parent.virtualScrollModule) {\n                const virtual = this.parent.element.querySelector('.' + VIRTUAL_TRACK_CLASS);\n                const averageRowHeight = Math.round(virtual.offsetHeight / this.expandedResources.length);\n                if (this.parent.rowAutoHeight) {\n                    scrollElement.scrollTop = 0;\n                    this.parent.virtualScrollModule.virtualScrolling();\n                }\n                scrollElement.scrollTop = (index * averageRowHeight) - (((this.parent.virtualScrollModule.bufferCount - 1) * averageRowHeight));\n                this.parent.virtualScrollModule.virtualScrolling();\n                if (this.parent.rowAutoHeight) {\n                    const td = this.parent.element.querySelector(`.${WORK_CELLS_CLASS}[data-group-index=\"${index}\"]`);\n                    if (td && !td.parentElement.classList.contains(HIDDEN_CLASS)) {\n                        scrollElement.scrollTop =\n                            (scrollElement.scrollTop < td.offsetTop) ? td.offsetTop : scrollElement.scrollTop + td.offsetTop;\n                    }\n                }\n                else {\n                    scrollElement.scrollTop = (index * averageRowHeight);\n                }\n            }\n            else {\n                const td = this.parent.element.querySelector(`.${WORK_CELLS_CLASS}[data-group-index=\"${index}\"]`);\n                if (td && !td.parentElement.classList.contains(HIDDEN_CLASS)) {\n                    scrollElement.scrollTop = td.offsetTop;\n                }\n            }\n        }\n        else {\n            if (!this.parent.activeViewOptions.group.byGroupID) {\n                index = this.getIndexFromResourceId(id, levelName, resource);\n            }\n            else {\n                if (levelName === this.parent.resourceCollection.slice(-1)[0].name) {\n                    index = this.lastResourceLevel.map((e) => e.resourceData[resource.idField]).indexOf(id);\n                }\n                else {\n                    index = resource.dataSource.map((e) => e[resource.idField]).indexOf(id);\n                }\n            }\n            const offsetTarget = this.parent.element.querySelector(`.${HEADER_ROW_CLASS}:nth-child(${levelIndex + 1})`);\n            const offset = [].slice.call(offsetTarget.children).map((node) => node.offsetLeft);\n            scrollElement.scrollLeft = offset[index];\n        }\n    }\n    destroy() {\n        this.parent.off(documentClick, this.documentClick);\n        if (this.treeViewObj) {\n            this.treeViewObj.destroy();\n            this.treeViewObj = null;\n        }\n        if (this.treePopup) {\n            this.treePopup.destroy();\n            this.treePopup = null;\n            remove(this.parent.element.querySelector('.' + RESOURCE_TREE_POPUP));\n            remove(this.parent.element.querySelector('.' + RESOURCE_TREE_POPUP_OVERLAY));\n        }\n        const resToolBarEle = this.parent.element.querySelector('.' + RESOURCE_TOOLBAR_CONTAINER);\n        if (resToolBarEle) {\n            remove(resToolBarEle);\n        }\n    }\n}\n\nvar __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n/* eslint-disable @typescript-eslint/no-explicit-any */\n/**\n * Represents the Schedule component that displays a list of events scheduled against specific date and timings,\n * thus helping us to plan and manage it properly.\n * ```html\n * <div id=\"schedule\"></div>\n * ```\n * ```typescript\n * <script>\n *   var scheduleObj = new Schedule();\n *   scheduleObj.appendTo(\"#schedule\");\n * </script>\n * ```\n */\nlet Schedule = class Schedule extends Component {\n    /**\n     * Constructor for creating the Schedule widget\n     *\n     * @param {ScheduleModel} options Accepts the schedule model properties to initiate the rendering\n     * @param {string | HTMLElement} element Accepts the DOM element reference\n     */\n    constructor(options, element) {\n        super(options, element);\n    }\n    /**\n     * Core method that initializes the control rendering.\n     *\n     * @returns {void}\n     * @private\n     */\n    render() {\n        const addClasses = [];\n        const removeClasses = [];\n        addClasses.push(ROOT);\n        if (this.enableRtl) {\n            addClasses.push(RTL);\n        }\n        else {\n            removeClasses.push(RTL);\n        }\n        if (this.isAdaptive) {\n            addClasses.push(DEVICE_CLASS);\n        }\n        else {\n            removeClasses.push(DEVICE_CLASS);\n        }\n        if (this.allowMultiDrag) {\n            addClasses.push(MULTI_DRAG);\n        }\n        else {\n            removeClasses.push(MULTI_DRAG);\n        }\n        if (this.cssClass) {\n            const cssClass = this.cssClass.split(' ');\n            for (const cls of cssClass) {\n                addClasses.push(cls);\n            }\n        }\n        classList(this.element, addClasses, removeClasses);\n        this.validateDate();\n        createSpinner({ target: this.element });\n        this.scrollModule = new Scroll(this);\n        this.scrollModule.setWidth();\n        this.scrollModule.setHeight();\n        this.renderModule = new Render(this);\n        this.eventBase = new EventBase(this);\n        this.workCellAction = new WorkCellInteraction(this);\n        if (this.allowKeyboardInteraction) {\n            this.keyboardInteractionModule = new KeyboardInteraction(this);\n        }\n        this.inlineModule = new InlineEdit(this);\n        this.initializeDataModule();\n        this.renderTableContainer();\n        this.activeViewOptions = this.getActiveViewOptions();\n        this.initializeResources();\n        this.wireEvents();\n    }\n    renderTableContainer() {\n        if (!this.element.querySelector('.' + TABLE_CONTAINER_CLASS)) {\n            this.element.appendChild(this.createElement('div', { className: TABLE_CONTAINER_CLASS }));\n        }\n    }\n    /**\n     * Method to render react templates\n     *\n     * @returns {void}\n     * @private\n     */\n    renderTemplates() {\n        if (this.isReact) {\n            this.renderReactTemplates();\n        }\n    }\n    /**\n     * Method to reset react templates\n     *\n     * @param {string[]} templates Accepts the template ID\n     * @returns {void}\n     * @private\n     */\n    resetTemplates(templates) {\n        if (this.isAngular || this.isReact) {\n            this.clearTemplate(templates);\n        }\n    }\n    initializeResources(isSetModel = false) {\n        if (this.resources.length > 0) {\n            this.resourceBase = new ResourceBase(this);\n            this.resourceBase.bindResourcesData(isSetModel);\n        }\n        else {\n            this.resourceBase = null;\n            this.resourceCollection = [];\n            this.renderElements(isSetModel);\n        }\n    }\n    /**\n     * Method to render the layout elements\n     *\n     * @param {boolean} isLayoutOnly Accepts the boolean value to render layout or not\n     * @returns {void}\n     * @private\n     */\n    renderElements(isLayoutOnly) {\n        if (isLayoutOnly) {\n            this.initializeView(this.currentView);\n            this.eventWindow.refresh();\n            return;\n        }\n        this.destroyHeaderModule();\n        if (this.showHeaderBar) {\n            this.headerModule = new HeaderRenderer(this);\n        }\n        this.renderTableContainer();\n        if (Browser.isDevice || Browser.isTouch) {\n            this.scheduleTouchModule = new ScheduleTouch(this);\n        }\n        this.initializeView(this.currentView);\n        this.destroyPopups();\n        if (!this.isPrinting) {\n            this.initializePopups();\n        }\n    }\n    validateDate(selectedDate = this.selectedDate) {\n        // persist the selected date value\n        let date = selectedDate instanceof Date ? new Date(selectedDate.getTime()) : new Date(selectedDate);\n        const minDate = this.minDate instanceof Date ? new Date(this.minDate.getTime()) : new Date(this.minDate);\n        const maxDate = this.maxDate instanceof Date ? new Date(this.maxDate.getTime()) : new Date(this.maxDate);\n        if (minDate <= maxDate) {\n            if (date < minDate) {\n                date = minDate;\n            }\n            if (date > maxDate) {\n                date = maxDate;\n            }\n            this.setProperties({ selectedDate: new Date('' + date), minDate: new Date('' + minDate), maxDate: new Date('' + maxDate) }, true);\n            if (this.eventWindow) {\n                this.eventWindow.updateMinMaxDateToEditor();\n            }\n        }\n        else {\n            throw Error('minDate should be equal or less than maxDate');\n        }\n    }\n    getViewIndex(viewName) {\n        for (let item = 0; item < this.viewCollections.length; item++) {\n            const checkIndex = this.viewCollections[item].option;\n            if (checkIndex === viewName) {\n                return item;\n            }\n        }\n        return -1;\n    }\n    setViewOptions(isModuleLoad = false) {\n        this.viewOptions = {};\n        this.viewCollections = [];\n        let viewName;\n        let selectedView;\n        const prevIndex = this.viewIndex;\n        let count = 0;\n        this.viewIndex = -1;\n        for (const view of this.views) {\n            const isOptions = (typeof view === 'string') ? false : true;\n            if (typeof view === 'string') {\n                viewName = view;\n                if (this.currentView === viewName) {\n                    selectedView = viewName;\n                    this.viewIndex = count;\n                }\n            }\n            else {\n                viewName = view.option;\n                if (view.isSelected) {\n                    selectedView = viewName;\n                    this.viewIndex = count;\n                }\n            }\n            const obj = extend({ option: viewName }, isOptions ? view : {});\n            const fieldViewName = viewName.charAt(0).toLowerCase() + viewName.slice(1);\n            obj.cellHeaderTemplateName = obj.cellHeaderTemplate ? obj.option : '';\n            obj.dateHeaderTemplateName = obj.dateHeaderTemplate ? obj.option : '';\n            obj.cellTemplateName = obj.cellTemplate ? obj.option : '';\n            obj.dayHeaderTemplateName = obj.dayHeaderTemplate ? obj.option : '';\n            obj.monthHeaderTemplateName = obj.monthHeaderTemplate ? obj.option : '';\n            obj.resourceHeaderTemplateName = obj.resourceHeaderTemplate ? obj.option : '';\n            obj.headerIndentTemplateName = obj.headerIndentTemplate ? obj.option : '';\n            obj.eventTemplateName = obj.eventTemplate ? obj.option : '';\n            if (!isNullOrUndefined(obj.firstDayOfWeek) && obj.firstDayOfWeek === 0) {\n                delete obj.firstDayOfWeek;\n            }\n            if (!isNullOrUndefined(obj.interval) && obj.interval === 1) {\n                delete obj.interval;\n            }\n            this.viewCollections.push(obj);\n            if (isNullOrUndefined(this.viewOptions[fieldViewName])) {\n                this.viewOptions[fieldViewName] = [obj];\n            }\n            else {\n                this.viewOptions[fieldViewName].push(obj);\n            }\n            count++;\n        }\n        if (!isModuleLoad && selectedView) {\n            this.setProperties({ currentView: selectedView }, true);\n        }\n        if (this.viewIndex === -1) {\n            const currentIndex = this.getViewIndex(this.currentView);\n            this.viewIndex = ((typeof this.views[0] !== 'string') && (!isNullOrUndefined(prevIndex) && prevIndex !== -1)) ? prevIndex :\n                (currentIndex === -1) ? 0 : currentIndex;\n        }\n    }\n    getActiveViewOptions() {\n        const timeScale = {\n            enable: this.timeScale.enable,\n            interval: this.timeScale.interval,\n            slotCount: this.timeScale.slotCount,\n            majorSlotTemplate: this.timeScale.majorSlotTemplate,\n            minorSlotTemplate: this.timeScale.minorSlotTemplate\n        };\n        const isYearView = this.viewCollections[this.viewIndex].option.indexOf('Year') > -1;\n        const group = {\n            byDate: isYearView ? false : this.group.byDate,\n            byGroupID: this.group.byGroupID,\n            allowGroupEdit: this.group.allowGroupEdit,\n            resources: this.group.resources,\n            headerTooltipTemplate: this.group.headerTooltipTemplate,\n            enableCompactView: this.group.enableCompactView\n        };\n        const workDays = this.viewCollections[this.viewIndex].workDays ? [] : this.workDays;\n        const scheduleOptions = {\n            dateFormat: this.dateFormat,\n            endHour: this.endHour,\n            isSelected: false,\n            option: null,\n            readonly: this.readonly,\n            startHour: this.startHour,\n            allowVirtualScrolling: false,\n            cellHeaderTemplate: this.cellHeaderTemplate,\n            dayHeaderTemplate: this.dayHeaderTemplate,\n            monthHeaderTemplate: this.monthHeaderTemplate,\n            cellTemplate: this.cellTemplate,\n            eventTemplate: this.eventSettings.template,\n            dateHeaderTemplate: this.dateHeaderTemplate,\n            resourceHeaderTemplate: this.resourceHeaderTemplate,\n            headerIndentTemplate: this.headerIndentTemplate,\n            firstMonthOfYear: this.firstMonthOfYear,\n            firstDayOfWeek: this.firstDayOfWeek,\n            workDays: workDays,\n            monthsCount: this.monthsCount,\n            showWeekend: this.showWeekend,\n            showWeekNumber: this.showWeekNumber,\n            displayName: null,\n            interval: 1,\n            timeScale: timeScale,\n            timeFormat: this.internalTimeFormat,\n            group: group,\n            headerRows: this.headerRows,\n            orientation: 'Horizontal',\n            numberOfWeeks: 0,\n            displayDate: null\n        };\n        const viewOptions = this.viewCollections[this.viewIndex];\n        const viewsData = extend(scheduleOptions, viewOptions, undefined, true);\n        if (this.firstDayOfWeek !== 0 && viewOptions.firstDayOfWeek && this.firstDayOfWeek !== viewOptions.firstDayOfWeek) {\n            viewsData.firstDayOfWeek = this.firstDayOfWeek;\n        }\n        if (viewsData.displayDate) {\n            viewsData.displayDate = viewsData.displayDate instanceof Date ? new Date(viewsData.displayDate.getTime()) :\n                new Date(viewsData.displayDate);\n        }\n        return viewsData;\n    }\n    initializeDataModule() {\n        this.eventFields = {\n            id: this.eventSettings.fields.id,\n            isBlock: this.eventSettings.fields.isBlock,\n            subject: this.eventSettings.fields.subject.name,\n            startTime: this.eventSettings.fields.startTime.name,\n            endTime: this.eventSettings.fields.endTime.name,\n            startTimezone: this.eventSettings.fields.startTimezone.name,\n            endTimezone: this.eventSettings.fields.endTimezone.name,\n            location: this.eventSettings.fields.location.name,\n            description: this.eventSettings.fields.description.name,\n            isAllDay: this.eventSettings.fields.isAllDay.name,\n            recurrenceID: this.eventSettings.fields.recurrenceID.name,\n            recurrenceRule: this.eventSettings.fields.recurrenceRule.name,\n            recurrenceException: this.eventSettings.fields.recurrenceException.name,\n            isReadonly: this.eventSettings.fields.isReadonly,\n            followingID: this.eventSettings.fields.followingID\n        };\n        this.setEditorTitles();\n        this.dataModule = new Data(this.eventSettings.dataSource, this.eventSettings.query);\n        this.crudModule = new Crud(this);\n    }\n    setEditorTitles() {\n        this.editorTitles = {\n            subject: this.eventSettings.fields.subject.title || this.localeObj.getConstant('title'),\n            startTime: this.eventSettings.fields.startTime.title || this.localeObj.getConstant('start'),\n            endTime: this.eventSettings.fields.endTime.title || this.localeObj.getConstant('end'),\n            isAllDay: this.eventSettings.fields.isAllDay.title || this.localeObj.getConstant('allDay'),\n            startTimezone: this.eventSettings.fields.startTimezone.title || this.localeObj.getConstant('startTimezone'),\n            endTimezone: this.eventSettings.fields.endTimezone.title || this.localeObj.getConstant('endTimezone'),\n            location: this.eventSettings.fields.location.title || this.localeObj.getConstant('location'),\n            description: this.eventSettings.fields.description.title || this.localeObj.getConstant('description'),\n            recurrenceRule: this.eventSettings.fields.recurrenceRule.title || this.localeObj.getConstant('repeat')\n        };\n    }\n    initializeView(viewName) {\n        this.showSpinner();\n        this.activeViewOptions = this.getActiveViewOptions();\n        if (this.resourceBase) {\n            this.resourceBase.setResourceCollection();\n        }\n        this.initializeTemplates();\n        this.renderModule.render(viewName);\n    }\n    initializeTemplates() {\n        this.cellHeaderTemplateFn = this.templateParser(this.activeViewOptions.cellHeaderTemplate);\n        this.dayHeaderTemplateFn = this.templateParser(this.activeViewOptions.dayHeaderTemplate);\n        this.monthHeaderTemplateFn = this.templateParser(this.activeViewOptions.monthHeaderTemplate);\n        this.cellTemplateFn = this.templateParser(this.activeViewOptions.cellTemplate);\n        this.dateHeaderTemplateFn = this.templateParser(this.activeViewOptions.dateHeaderTemplate);\n        this.majorSlotTemplateFn = this.templateParser(this.activeViewOptions.timeScale.majorSlotTemplate);\n        this.minorSlotTemplateFn = this.templateParser(this.activeViewOptions.timeScale.minorSlotTemplate);\n        this.appointmentTemplateFn = this.templateParser(this.activeViewOptions.eventTemplate);\n        this.resourceHeaderTemplateFn = this.templateParser(this.activeViewOptions.resourceHeaderTemplate);\n        this.headerIndentTemplateFn = this.templateParser(this.activeViewOptions.headerIndentTemplate);\n        this.headerTooltipTemplateFn = this.templateParser(this.activeViewOptions.group.headerTooltipTemplate);\n        this.eventTooltipTemplateFn = this.templateParser(this.eventSettings.tooltipTemplate);\n        this.editorTemplateFn = this.templateParser(this.editorTemplate);\n        this.quickInfoTemplatesHeaderFn = this.templateParser(this.quickInfoTemplates.header);\n        this.quickInfoTemplatesContentFn = this.templateParser(this.quickInfoTemplates.content);\n        this.quickInfoTemplatesFooterFn = this.templateParser(this.quickInfoTemplates.footer);\n    }\n    initializePopups() {\n        this.eventWindow = new EventWindow(this);\n        this.quickPopup = new QuickPopups(this);\n    }\n    /**\n     * Method to get day names\n     *\n     * @param {string} type Accepts the day name\n     * @returns {string[]} Returns the collection of day names\n     * @private\n     */\n    getDayNames(type) {\n        const culShortNames = [];\n        let cldrObj;\n        let nameSpace = '';\n        if (this.locale === 'en' || this.locale === 'en-US') {\n            nameSpace = 'days.stand-alone.';\n            cldrObj = (getValue(nameSpace + type, getDefaultDateObject(this.getCalendarMode())));\n        }\n        else {\n            nameSpace = 'main.' + '' + this.locale + '.dates.calendars.' + this.getCalendarMode() + '.days.format.' + type;\n            cldrObj = (getValue(nameSpace, cldrData));\n        }\n        for (const obj of Object.keys(cldrObj)) {\n            culShortNames.push(getValue(obj, cldrObj));\n        }\n        return culShortNames;\n    }\n    setCldrTimeFormat() {\n        if (!isNullOrUndefined(this.timeFormat)) {\n            this.internalTimeFormat = this.timeFormat;\n            return;\n        }\n        if (this.locale === 'en' || this.locale === 'en-US') {\n            this.internalTimeFormat = (getValue('timeFormats.short', getDefaultDateObject(this.getCalendarMode())));\n        }\n        else {\n            this.internalTimeFormat = (getValue('main.' + '' + this.locale + '.dates.calendars.' + this.getCalendarMode() + '.timeFormats.short', cldrData));\n        }\n    }\n    /**\n     * Method to get calendar mode\n     *\n     * @returns {string} Returns the calendar mode\n     * @private\n     */\n    getCalendarMode() {\n        return this.calendarMode.toLowerCase();\n    }\n    /**\n     * Method to get time in string\n     *\n     * @param {Date} date Accepts the date object\n     * @returns {string} Returns the time in string\n     * @private\n     */\n    getTimeString(date) {\n        const time = this.globalize.formatDate(date, {\n            format: this.activeViewOptions.timeFormat,\n            type: 'time', calendar: this.getCalendarMode()\n        });\n        return time.toLocaleUpperCase();\n    }\n    /**\n     * Method to get  date object\n     *\n     * @param {Date} date Accepts the date object\n     * @returns {Date} Returns the date object\n     * @private\n     */\n    getDateTime(date) {\n        return date instanceof Date ? new Date(date.getTime()) : new Date(date);\n    }\n    setCalendarMode() {\n        if (this.calendarMode === 'Islamic') {\n            this.calendarUtil = new Islamic();\n        }\n        else {\n            this.calendarUtil = new Gregorian();\n        }\n    }\n    /**\n     * Method to change the current view\n     *\n     * @param {View} view Accepts the view name\n     * @param {Event} event Accepts the event object\n     * @param {boolean} muteOnChange Accepts the value to enable or disable mute on change\n     * @param {number} index Accepts the index value\n     * @returns {void}\n     * @private\n     */\n    changeView(view, event, muteOnChange, index) {\n        if (isNullOrUndefined(index)) {\n            index = this.getViewIndex(view);\n        }\n        if (!muteOnChange && index === this.viewIndex && this.currentView === view || index < 0) {\n            return;\n        }\n        this.viewIndex = index;\n        let args = { requestType: 'viewNavigate', cancel: false, event: event };\n        this.trigger(actionBegin, args, (actionArgs) => {\n            if (!actionArgs.cancel) {\n                const navArgs = {\n                    action: 'view', cancel: false, currentDate: this.selectedDate, previousView: this.currentView, currentView: view, viewIndex: this.viewIndex\n                };\n                this.trigger(navigating, navArgs, (navigationArgs) => {\n                    if (!navigationArgs.cancel) {\n                        this.uiStateValues.isInitial = view.indexOf('Timeline') > -1 || this.currentView.indexOf('Timeline') > -1 ? true : this.uiStateValues.isInitial;\n                        this.viewIndex = navigationArgs.viewIndex;\n                        this.setProperties({ currentView: view }, true);\n                        if (this.headerModule) {\n                            this.headerModule.updateActiveView();\n                            this.headerModule.setCalendarDate(this.selectedDate);\n                            this.headerModule.setCalendarView();\n                        }\n                        this.initializeView(this.currentView);\n                        this.animateLayout();\n                        args = { requestType: 'viewNavigate', cancel: false, event: event };\n                        this.trigger(actionComplete, args);\n                    }\n                });\n            }\n        });\n    }\n    /**\n     * Method to change the view date\n     *\n     * @param {Date} selectedDate Accepts the selected date\n     * @param {Event} event Accepts the event object\n     * @returns {void}\n     * @private\n     */\n    changeDate(selectedDate, event) {\n        let args = { requestType: 'dateNavigate', cancel: false, event: event };\n        this.trigger(actionBegin, args, (actionArgs) => {\n            if (!actionArgs.cancel) {\n                const navArgs = {\n                    action: 'date', cancel: false, previousDate: this.selectedDate, currentDate: selectedDate\n                };\n                this.trigger(navigating, navArgs, (navigationArgs) => {\n                    if (!navigationArgs.cancel) {\n                        this.uiStateValues.isInitial = this.activeView.isTimelineView() ? true : this.uiStateValues.isInitial;\n                        this.validateDate(navigationArgs.currentDate);\n                        if (this.headerModule) {\n                            this.headerModule.setCalendarDate(navigationArgs.currentDate);\n                        }\n                        this.initializeView(this.currentView);\n                        this.animateLayout();\n                        args = { requestType: 'dateNavigate', cancel: false, event: event };\n                        this.trigger(actionComplete, args);\n                    }\n                });\n            }\n        });\n    }\n    /**\n     * Method to validate min and max date\n     *\n     * @param {Date} date Accepts the date object\n     * @returns {boolean} Returns the boolean result to validate the min and max date\n     * @private\n     */\n    isMinMaxDate(date = this.selectedDate) {\n        return ((date.getTime() >= this.minDate.getTime()) && (date.getTime() <= this.maxDate.getTime()));\n    }\n    /**\n     * Method to validate the selected date\n     *\n     * @param {Date} date Accepts the date object\n     * @returns {boolean} Returns the boolean value for given date is selected date or not\n     * @private\n     */\n    isSelectedDate(date) {\n        return date.setHours(0, 0, 0, 0) === new Date('' + this.selectedDate).setHours(0, 0, 0, 0);\n    }\n    /**\n     * Method to get the current time\n     *\n     * @param {Date} date Accepts the date object\n     * @returns {Date} Returns the date object after performing the timezone conversion\n     * @private\n     */\n    getCurrentTime(date = new Date()) {\n        if (this.timezone) {\n            return this.tzModule.convert(date, this.tzModule.getLocalTimezoneName(), this.timezone);\n        }\n        return date;\n    }\n    /** Method to get navigate view\n     *\n     * @returns {View} Return the navigate view name\n     * @private\n     */\n    getNavigateView() {\n        if (this.activeView.isTimelineView()) {\n            return this.currentView === 'TimelineMonth' || this.currentView === 'TimelineYear' ? 'TimelineDay' : 'Agenda';\n        }\n        return 'Day';\n    }\n    animateLayout() {\n        if (!this.activeView.element) {\n            return;\n        }\n        new Animation({ duration: 600, name: 'FadeIn', timingFunction: 'easeIn' }).animate(this.activeView.element);\n    }\n    /**\n     * To provide the array of modules needed for control rendering\n     *\n     * @returns {ModuleDeclaration[]} Returns the declared modules\n     * @private\n     */\n    requiredModules() {\n        const modules = [];\n        this.setViewOptions(true);\n        for (let view of Object.keys(this.viewOptions)) {\n            view = (view === 'timelineDay' || view === 'timelineWeek' || view === 'timelineWorkWeek') ? 'timelineViews' : view;\n            modules.push({ member: view, args: [this] });\n        }\n        if (this.allowDragAndDrop) {\n            modules.push({ member: 'dragAndDrop', args: [this] });\n        }\n        if (this.allowResizing) {\n            modules.push({ member: 'resize', args: [this] });\n        }\n        modules.push({ member: 'excelExport', args: [this] });\n        modules.push({ member: 'iCalendarExport', args: [this] });\n        modules.push({ member: 'iCalendarImport', args: [this] });\n        modules.push({ member: 'print', args: [this] });\n        return modules;\n    }\n    /**\n     * Initializes the values of private members.\n     *\n     * @returns {void}\n     * @private\n     */\n    preRender() {\n        this.isAdaptive = Browser.isDevice || isIPadDevice();\n        this.globalize = new Internationalization(this.locale);\n        this.tzModule = new Timezone();\n        if (this && isNullOrUndefined(this.uiStateValues) || !(this.enablePersistence)) {\n            this.uiStateValues = {\n                expand: false, isInitial: true, left: 0, top: 0, isGroupAdaptive: false,\n                isIgnoreOccurrence: false, groupIndex: 0, action: false, isBlock: false, isCustomMonth: true, isResize: false\n            };\n        }\n        this.activeCellsData = { startTime: this.getCurrentTime(), endTime: this.getCurrentTime(), isAllDay: false };\n        this.activeEventData = { event: undefined, element: undefined };\n        this.getDefaultLocale();\n        this.localeObj = new L10n(this.getModuleName(), this.defaultLocale, this.locale);\n        this.setCldrTimeFormat();\n        this.setCalendarMode();\n        this.eventsData = [];\n        this.eventsProcessed = [];\n        this.blockData = [];\n        this.blockProcessed = [];\n        this.resourceCollection = [];\n        this.currentAction = null;\n        this.selectedElements = [];\n        this.setViewOptions();\n    }\n    getDefaultLocale() {\n        this.defaultLocale = {\n            day: 'Day',\n            week: 'Week',\n            workWeek: 'Work Week',\n            month: 'Month',\n            year: 'Year',\n            agenda: 'Agenda',\n            weekAgenda: 'Week Agenda',\n            workWeekAgenda: 'Work Week Agenda',\n            monthAgenda: 'Month Agenda',\n            today: 'Today',\n            noEvents: 'No events',\n            emptyContainer: 'There are no events scheduled on this day.',\n            allDay: 'All day',\n            start: 'Start',\n            end: 'End',\n            more: 'more',\n            close: 'Close',\n            cancel: 'Cancel',\n            noTitle: '(No Title)',\n            delete: 'Delete',\n            deleteEvent: 'Delete Event',\n            deleteMultipleEvent: 'Delete Multiple Events',\n            selectedItems: 'Items selected',\n            deleteSeries: 'Entire Series',\n            edit: 'Edit',\n            editSeries: 'Entire Series',\n            editEvent: 'Edit Event',\n            createEvent: 'Create',\n            subject: 'Subject',\n            addTitle: 'Add title',\n            moreDetails: 'More Details',\n            save: 'Save',\n            editContent: 'How would you like to change the appointment in the series?',\n            deleteContent: 'Are you sure you want to delete this event?',\n            deleteMultipleContent: 'Are you sure you want to delete the selected events?',\n            newEvent: 'New Event',\n            title: 'Title',\n            location: 'Location',\n            description: 'Description',\n            timezone: 'Timezone',\n            startTimezone: 'Start Timezone',\n            endTimezone: 'End Timezone',\n            repeat: 'Repeat',\n            saveButton: 'Save',\n            cancelButton: 'Cancel',\n            deleteButton: 'Delete',\n            recurrence: 'Recurrence',\n            wrongPattern: 'The recurrence pattern is not valid.',\n            seriesChangeAlert: 'Do you want to cancel the changes made to specific ' +\n                'instances of this series and match it to the whole series again?',\n            createError: 'The duration of the event must be shorter than how frequently it occurs. ' +\n                'Shorten the duration, or change the recurrence pattern in the recurrence event editor.',\n            sameDayAlert: 'Two occurrences of the same event cannot occur on the same day.',\n            occurenceAlert: 'Cannot reschedule an occurrence of the recurring appointment if it skips over ' +\n                'a later occurrence of the same appointment.',\n            editRecurrence: 'Edit Recurrence',\n            repeats: 'Repeats',\n            alert: 'Alert',\n            startEndError: 'The selected end date occurs before the start date.',\n            invalidDateError: 'The entered date value is invalid.',\n            blockAlert: 'Events cannot be scheduled within the blocked time range.',\n            ok: 'Ok',\n            yes: 'Yes',\n            no: 'No',\n            occurrence: 'Occurrence',\n            series: 'Series',\n            previous: 'Previous',\n            next: 'Next',\n            timelineDay: 'Timeline Day',\n            timelineWeek: 'Timeline Week',\n            timelineWorkWeek: 'Timeline Work Week',\n            timelineMonth: 'Timeline Month',\n            timelineYear: 'Timeline Year',\n            editFollowingEvent: 'Following Events',\n            deleteTitle: 'Delete Event',\n            editTitle: 'Edit Event',\n            beginFrom: 'Begin From',\n            endAt: 'Ends At',\n            expandAllDaySection: 'Expand-all-day-section',\n            collapseAllDaySection: 'Collapse-all-day-section',\n            searchTimezone: 'Search Timezone',\n            noRecords: 'No records found'\n        };\n    }\n    wireEvents() {\n        EventHandler.add(window, 'resize', this.onScheduleResize, this);\n        EventHandler.add(window, 'orientationchange', this.onScheduleResize, this);\n        EventHandler.add(document, Browser.touchStartEvent, this.onDocumentClick, this);\n    }\n    /**\n     * Method to remove selected class\n     *\n     * @returns {void}\n     * @private\n     */\n    removeSelectedClass() {\n        const selectedCells = this.getSelectedElements();\n        for (const cell of selectedCells) {\n            cell.setAttribute('aria-selected', 'false');\n            cell.removeAttribute('tabindex');\n        }\n        removeClass(selectedCells, SELECTED_CELL_CLASS);\n    }\n    /**\n     * Method to add selected class\n     *\n     * @param {HTMLTableCellElement[]} cells Accepts the collection of elements\n     * @param {HTMLTableCellElement} focusCell Accepts the focus element\n     * @param {boolean} isPreventScroll Accepts the boolean value to prevent scroll\n     * @returns {void}\n     * @private\n     */\n    addSelectedClass(cells, focusCell, isPreventScroll) {\n        for (const cell of cells) {\n            cell.setAttribute('aria-selected', 'true');\n        }\n        addClass(cells, SELECTED_CELL_CLASS);\n        if (focusCell) {\n            focusCell.setAttribute('tabindex', '0');\n            focusCell.focus({ preventScroll: isPreventScroll || false });\n        }\n    }\n    /**\n     * Method to select cell\n     *\n     * @param {HTMLElement | HTMLTableCellElement} element Accepts the select element\n     * @returns {void}\n     * @private\n     */\n    selectCell(element) {\n        this.removeSelectedClass();\n        this.addSelectedClass([element], element);\n    }\n    /**\n     * Method to get all day row element\n     *\n     * @returns {Element} Returns the all day row element\n     * @private\n     */\n    getAllDayRow() {\n        return this.element.querySelector('.' + ALLDAY_ROW_CLASS);\n    }\n    /**\n     * Method to get content table element\n     *\n     * @returns {HTMLElement} Returns the content table element\n     * @private\n     */\n    getContentTable() {\n        return this.activeView.element.querySelector('.' + CONTENT_TABLE_CLASS + ' tbody');\n    }\n    /**\n     * Method to get all content table rows\n     *\n     * @returns {HTMLElement[]} Returns the content table rows\n     * @private\n     */\n    getTableRows() {\n        return [].slice.call(this.element.querySelectorAll('.' + CONTENT_TABLE_CLASS + ' tbody tr:not(.' + HIDDEN_CLASS + ')'));\n    }\n    /**\n     * Method to get work cell elements\n     *\n     * @returns {Element[]} Returns the all work cell elements\n     * @private\n     */\n    getWorkCellElements() {\n        return [].slice.call(this.element.querySelectorAll('.' + WORK_CELLS_CLASS));\n    }\n    /**\n     * Method to get the index from date collection\n     *\n     * @param {Date[]} collection Accepts the collections of date\n     * @param {Date} date Accepts the date object\n     * @returns {number} Returns the index compared date with date collections\n     * @private\n     */\n    getIndexOfDate(collection, date) {\n        return collection.map(Number).indexOf(+date);\n    }\n    /**\n     * Method to find all day cell\n     *\n     * @param {Element} td Accepts the DOM Element\n     * @returns {boolean} Returns the boolean value\n     * @private\n     */\n    isAllDayCell(td) {\n        if (['Month', 'TimelineMonth', 'TimelineYear', 'MonthAgenda'].indexOf(this.currentView) > -1 ||\n            td.classList.contains(ALLDAY_CELLS_CLASS) ||\n            td.classList.contains(HEADER_CELLS_CLASS) || !this.activeViewOptions.timeScale.enable) {\n            return true;\n        }\n        if (this.activeView.isTimelineView() && this.activeViewOptions.headerRows.length > 0 &&\n            this.activeViewOptions.headerRows.slice(-1)[0].option !== 'Hour') {\n            return true;\n        }\n        return false;\n    }\n    /**\n     * Method to get date from element\n     *\n     * @param {Element} td Accepts the DOM element\n     * @returns {Date} Returns the date object\n     * @private\n     */\n    getDateFromElement(td) {\n        let dateString;\n        if (!isNullOrUndefined(td)) {\n            dateString = td.getAttribute('data-date');\n        }\n        if (!isNullOrUndefined(dateString)) {\n            const dateInMS = parseInt(dateString, 10);\n            const date = new Date(dateInMS);\n            return date;\n        }\n        return undefined;\n    }\n    /**\n     * Method to get target element from given selector\n     *\n     * @param {string} selector Accepts the element selector\n     * @param {number} left Accepts the pageX value\n     * @param {number} top Accepts the pageY value\n     * @returns {Element[]} Returns the collection of elements based on the given selector\n     * @private\n     */\n    getTargetElement(selector, left, top) {\n        const element = document.elementFromPoint(left, top);\n        let targetElement;\n        if (element) {\n            targetElement = element.closest(selector);\n        }\n        return (targetElement) ? [targetElement] : null;\n    }\n    /**\n     * Method to process cell header template\n     *\n     * @returns {CallbackFunction} Returns the callback function\n     * @private\n     */\n    getCellHeaderTemplate() {\n        return this.cellHeaderTemplateFn;\n    }\n    /**\n     * Method to process cell header template in year view.\n     *\n     * @returns {CallbackFunction} Returns the callback function\n     * @private\n     */\n    getDayHeaderTemplate() {\n        return this.dayHeaderTemplateFn;\n    }\n    /**\n     * Method to process cell header template in year view.\n     *\n     * @returns {CallbackFunction} Returns the callback function\n     * @private\n     */\n    getMonthHeaderTemplate() {\n        return this.monthHeaderTemplateFn;\n    }\n    /**\n     * Method to process cell template\n     *\n     * @returns {CallbackFunction} Returns the callback function\n     * @private\n     */\n    getCellTemplate() {\n        return this.cellTemplateFn;\n    }\n    /**\n     * Method to process date header template\n     *\n     * @returns {CallbackFunction} Returns the callback function\n     * @private\n     */\n    getDateHeaderTemplate() {\n        return this.dateHeaderTemplateFn;\n    }\n    /**\n     * Method to process major slot template\n     *\n     * @returns {CallbackFunction} Returns the callback function\n     * @private\n     */\n    getMajorSlotTemplate() {\n        return this.majorSlotTemplateFn;\n    }\n    /**\n     * Method to process minor slot template\n     *\n     * @returns {CallbackFunction} Returns the callback function\n     * @private\n     */\n    getMinorSlotTemplate() {\n        return this.minorSlotTemplateFn;\n    }\n    /**\n     * Method to process appointment template\n     *\n     * @returns {CallbackFunction} Returns the callback function\n     * @private\n     */\n    getAppointmentTemplate() {\n        return this.appointmentTemplateFn;\n    }\n    /**\n     * Method to process appointment tooltip template\n     *\n     * @returns {CallbackFunction} Returns the callback function\n     * @private\n     */\n    getEventTooltipTemplate() {\n        return this.eventTooltipTemplateFn;\n    }\n    /**\n     * Method to process header tooltip template\n     *\n     * @returns {CallbackFunction} Returns the callback function\n     * @private\n     */\n    getHeaderTooltipTemplate() {\n        return this.headerTooltipTemplateFn;\n    }\n    /**\n     * Method to process editor template\n     *\n     * @returns {CallbackFunction} Returns the callback function\n     * @private\n     */\n    getEditorTemplate() {\n        return this.editorTemplateFn;\n    }\n    /**\n     * Method to process quick info header template\n     *\n     * @returns {CallbackFunction} Returns the callback function\n     * @private\n     */\n    getQuickInfoTemplatesHeader() {\n        return this.quickInfoTemplatesHeaderFn;\n    }\n    /**\n     * Method to process quick info content template\n     *\n     * @returns {CallbackFunction} Returns the callback function\n     * @private\n     */\n    getQuickInfoTemplatesContent() {\n        return this.quickInfoTemplatesContentFn;\n    }\n    /**\n     * Method to process quick info footer template\n     *\n     * @returns {CallbackFunction} Returns the callback function\n     * @private\n     */\n    getQuickInfoTemplatesFooter() {\n        return this.quickInfoTemplatesFooterFn;\n    }\n    /**\n     * Method to process resource header template\n     *\n     * @returns {CallbackFunction} Returns the callback function\n     * @private\n     */\n    getResourceHeaderTemplate() {\n        return this.resourceHeaderTemplateFn;\n    }\n    /**\n     * Method to process indent template\n     *\n     * @returns {CallbackFunction} Returns the callback function\n     * @private\n     */\n    getHeaderIndentTemplate() {\n        return this.headerIndentTemplateFn;\n    }\n    /**\n     * Method to get dynamic CSS properties\n     *\n     * @returns {ScrollCss} Returns the CSS properties dynamically\n     * @private\n     */\n    getCssProperties() {\n        const cssProps = {\n            border: this.enableRtl ? 'borderLeftWidth' : 'borderRightWidth',\n            padding: this.enableRtl ? 'paddingLeft' : 'paddingRight',\n            rtlBorder: this.enableRtl ? 'borderRightWidth' : 'borderLeftWidth',\n            rtlPadding: this.enableRtl ? 'paddingRight' : 'paddingLeft'\n        };\n        return cssProps;\n    }\n    /**\n     * Method to remove new event element in adaptive mode\n     *\n     * @returns {void}\n     * @private\n     */\n    removeNewEventElement() {\n        const eventClone = this.element.querySelector('.' + NEW_EVENT_CLASS);\n        if (!isNullOrUndefined(eventClone)) {\n            remove(eventClone);\n        }\n    }\n    /**\n     * Method to get start end time from string\n     *\n     * @param {string} startEndTime Accepts the start end time string value\n     * @returns {Date} Returns the date object\n     * @private\n     */\n    getStartEndTime(startEndTime) {\n        if (!isNullOrUndefined(startEndTime) && startEndTime !== '') {\n            const startEndDate = resetTime(this.getCurrentTime());\n            const timeString = startEndTime.split(':');\n            if (timeString.length === 2) {\n                startEndDate.setHours(parseInt(timeString[0], 10), parseInt(timeString[1], 10), 0);\n            }\n            return startEndDate;\n        }\n        return null;\n    }\n    onDocumentClick(args) {\n        this.notify(documentClick, { event: args });\n    }\n    onScheduleResize() {\n        if (isNullOrUndefined(this.activeView) || ((this.isAdaptive || isMobile()) && document.activeElement\n            && document.activeElement.classList.contains(SUBJECT_CLASS))) {\n            return;\n        }\n        if (this.activeViewOptions.timeScale.enable && this.activeView) {\n            this.activeView.highlightCurrentTime();\n        }\n        if (this.quickPopup) {\n            this.quickPopup.onClosePopup();\n        }\n        if (this.currentView === 'Month' || ((this.currentView !== 'Agenda' && this.currentView !== 'MonthAgenda')\n            && !this.activeViewOptions.timeScale.enable) || this.activeView.isTimelineView()) {\n            this.uiStateValues.isResize = true;\n            this.activeView.resetColWidth();\n            this.notify(scrollUiUpdate, { cssProperties: this.getCssProperties(), isPreventScrollUpdate: true });\n            this.refreshEvents(false);\n            this.uiStateValues.isResize = false;\n        }\n        else {\n            this.notify(contentReady, {});\n        }\n    }\n    /**\n     * Method to process the templates\n     *\n     * @param {string} template Accepts the template in string\n     * @returns {CallbackFunction} Returns the callback function\n     * @private\n     */\n    templateParser(template) {\n        if (template) {\n            try {\n                if (document.querySelectorAll(template).length) {\n                    return compile(document.querySelector(template).innerHTML.trim());\n                }\n                else {\n                    return compile(template);\n                }\n            }\n            catch (error) {\n                return compile(template);\n            }\n        }\n        return undefined;\n    }\n    /**\n     * Method to generate the announcement string\n     *\n     * @param {Object} event Accepts the event object\n     * @param {string} subject Accepts the subject text\n     * @returns {string} Returns the announcement string\n     * @private\n     */\n    getAnnouncementString(event, subject) {\n        let resourceName;\n        if (this.quickPopup && this.activeViewOptions.group.resources.length > 0) {\n            const constantText = '\"s event - ';\n            resourceName = this.quickPopup.getResourceText({ event: event }, 'event') + constantText;\n        }\n        const recordSubject = (subject || (event[this.eventFields.subject] || this.eventSettings.fields.subject.default));\n        const skeleton = 'full';\n        const startDateText = this.globalize.formatDate(event[this.eventFields.startTime], {\n            type: 'dateTime', skeleton: skeleton, calendar: this.getCalendarMode()\n        });\n        const endDateText = this.globalize.formatDate(event[this.eventFields.endTime], {\n            type: 'dateTime', skeleton: skeleton, calendar: this.getCalendarMode()\n        });\n        let announcementString = recordSubject + ' ' + this.localeObj.getConstant('beginFrom') + ' '\n            + startDateText + ' ' + this.localeObj.getConstant('endAt') + ' ' + endDateText;\n        if (resourceName) {\n            announcementString = resourceName + ' ' + announcementString;\n        }\n        return announcementString;\n    }\n    /**\n     * Method to process the element boundary validation\n     *\n     * @param {number} pageY Accepts the pageY value\n     * @param {number} pageX Accepts the pageX value\n     * @returns {ResizeEdges} Returns the boundary validation object\n     * @private\n     */\n    boundaryValidation(pageY, pageX) {\n        const autoScrollDistance = 30;\n        const scrollEdges = { left: false, right: false, top: false, bottom: false };\n        const viewBoundaries = this.element.querySelector('.' + CONTENT_WRAP_CLASS).getBoundingClientRect();\n        if ((pageY < viewBoundaries.top + autoScrollDistance + window.pageYOffset) &&\n            (pageY > viewBoundaries.top + window.pageYOffset)) {\n            scrollEdges.top = true;\n        }\n        if ((pageY > (viewBoundaries.bottom - autoScrollDistance) + window.pageYOffset) &&\n            (pageY < viewBoundaries.bottom + window.pageYOffset)) {\n            scrollEdges.bottom = true;\n        }\n        if ((pageX < viewBoundaries.left + autoScrollDistance + window.pageXOffset) &&\n            (pageX > viewBoundaries.left + window.pageXOffset)) {\n            scrollEdges.left = true;\n        }\n        if ((pageX > (viewBoundaries.right - autoScrollDistance) + window.pageXOffset) &&\n            (pageX < viewBoundaries.right + window.pageXOffset)) {\n            scrollEdges.right = true;\n        }\n        return scrollEdges;\n    }\n    /**\n     * Method to get the week number.\n     *\n     * @param {Date[]} dates Accepts the date collections\n     * @returns {number} Returns the week number\n     * @private\n     */\n    getWeekNumberContent(dates) {\n        let weekNumber;\n        if (this.weekRule === 'FirstDay') {\n            const weekNumberDate = getWeekLastDate(dates.slice(-1)[0], this.firstDayOfWeek);\n            weekNumber = this.globalize.formatNumber(getWeekNumber(weekNumberDate));\n        }\n        else if (this.weekRule === 'FirstFourDayWeek') {\n            const weekFirstDate = getWeekFirstDate(dates.slice(-1)[0], this.firstDayOfWeek);\n            const weekLastDate = getWeekLastDate(dates.slice(-1)[0], this.firstDayOfWeek);\n            const weekMidDate = getWeekMiddleDate(weekFirstDate, weekLastDate);\n            weekNumber = this.globalize.formatNumber(getWeekNumber(weekMidDate));\n        }\n        else if (this.weekRule === 'FirstFullWeek') {\n            const weekFirstDate = getWeekFirstDate(dates.slice(-1)[0], this.firstDayOfWeek);\n            weekNumber = this.globalize.formatNumber(getWeekNumber(weekFirstDate));\n        }\n        return weekNumber;\n    }\n    /**\n     * Method to render the header indent template.\n     *\n     * @param {TdData} data Accepts the td data\n     * @param {Element} td Accepts the td element\n     * @returns {void}\n     * @private\n     */\n    renderHeaderIndentTemplate(data, td) {\n        if (this.activeViewOptions.headerIndentTemplate) {\n            const scheduleId = this.element.id + '_';\n            const viewName = this.activeViewOptions.headerIndentTemplateName;\n            const templateId = scheduleId + viewName + 'headerIndentTemplate';\n            const indentTemplate = [].slice.call(this.getHeaderIndentTemplate()(data, this, 'headerIndentTemplate', templateId, false));\n            append(indentTemplate, td);\n        }\n    }\n    unWireEvents() {\n        EventHandler.remove(window, 'resize', this.onScheduleResize);\n        EventHandler.remove(window, 'orientationchange', this.onScheduleResize);\n        EventHandler.remove(document, Browser.touchStartEvent, this.onDocumentClick);\n    }\n    /**\n     * Core method to return the component name.\n     *\n     * @returns {string} Returns the module name\n     * @private\n     */\n    getModuleName() {\n        return 'schedule';\n    }\n    /**\n     * Returns the properties to be maintained in the persisted state.\n     *\n     * @returns {string} Returns the persistance data\n     * @private\n     */\n    getPersistData() {\n        return this.addOnPersist(['currentView', 'selectedDate', 'scrollTop', 'scrollLeft']);\n    }\n    /**\n     * Called internally, if any of the property value changed.\n     *\n     * @returns {void}\n     * @private\n     */\n    onPropertyChanged(newProp, oldProp) {\n        if (this.isReact && isNullOrUndefined(this.activeView)) {\n            return;\n        }\n        const state = {\n            isRefresh: false, isResource: false, isDate: false, isView: false, isLayout: false, isDataManager: false\n        };\n        for (const prop of Object.keys(newProp)) {\n            switch (prop) {\n                case 'views':\n                    this.setViewOptions();\n                    if (this.headerModule) {\n                        this.headerModule.updateItems();\n                    }\n                    state.isView = true;\n                    break;\n                case 'currentView':\n                    state.isView = true;\n                    break;\n                case 'minDate':\n                case 'maxDate':\n                case 'selectedDate':\n                    state.isDate = true;\n                    break;\n                case 'dateFormat':\n                    this.activeViewOptions = this.getActiveViewOptions();\n                    if (this.headerModule) {\n                        this.headerModule.updateDateRange(this.activeView.getDateRangeText());\n                    }\n                    break;\n                case 'showHeaderBar':\n                    this.destroyHeaderModule();\n                    if (newProp.showHeaderBar) {\n                        this.headerModule = new HeaderRenderer(this);\n                        this.headerModule.updateDateRange(this.activeView.getDateRangeText());\n                    }\n                    this.notify(scrollUiUpdate, { cssProperties: this.getCssProperties() });\n                    if (this.activeView.isTimelineView()) {\n                        this.refreshEvents(false);\n                    }\n                    break;\n                case 'workDays':\n                    if (JSON.stringify(oldProp.workDays) !== JSON.stringify(newProp.workDays)) {\n                        state.isLayout = true;\n                    }\n                    break;\n                case 'showWeekend':\n                case 'startHour':\n                case 'endHour':\n                case 'workHours':\n                case 'readonly':\n                case 'headerRows':\n                case 'showWeekNumber':\n                case 'rowAutoHeight':\n                    state.isLayout = true;\n                    break;\n                case 'locale':\n                case 'calendarMode':\n                    this.globalize = new Internationalization(this.locale);\n                    this.localeObj = new L10n(this.getModuleName(), this.defaultLocale, this.locale);\n                    this.setCldrTimeFormat();\n                    this.setCalendarMode();\n                    state.isRefresh = true;\n                    break;\n                case 'firstDayOfWeek':\n                    this.activeViewOptions.firstDayOfWeek = newProp.firstDayOfWeek;\n                    if (this.eventWindow) {\n                        this.eventWindow.refreshRecurrenceEditor();\n                    }\n                    state.isLayout = true;\n                    break;\n                case 'showTimeIndicator':\n                    if (this.activeViewOptions.timeScale.enable && this.activeView) {\n                        this.activeView.highlightCurrentTime();\n                    }\n                    break;\n                case 'cellHeaderTemplate':\n                    this.activeViewOptions.cellHeaderTemplate = newProp.cellHeaderTemplate;\n                    this.cellHeaderTemplateFn = this.templateParser(this.activeViewOptions.cellHeaderTemplate);\n                    state.isLayout = true;\n                    break;\n                case 'cellTemplate':\n                    this.activeViewOptions.cellTemplate = newProp.cellTemplate;\n                    this.cellTemplateFn = this.templateParser(this.activeViewOptions.cellTemplate);\n                    state.isLayout = true;\n                    break;\n                case 'dateHeaderTemplate':\n                    this.activeViewOptions.dateHeaderTemplate = newProp.dateHeaderTemplate;\n                    this.dateHeaderTemplateFn = this.templateParser(this.activeViewOptions.dateHeaderTemplate);\n                    state.isLayout = true;\n                    break;\n                case 'dayHeaderTemplate':\n                    this.activeViewOptions.dayHeaderTemplate = newProp.dayHeaderTemplate;\n                    this.dayHeaderTemplateFn = this.templateParser(this.activeViewOptions.dayHeaderTemplate);\n                    state.isLayout = true;\n                    break;\n                case 'monthHeaderTemplate':\n                    this.activeViewOptions.monthHeaderTemplate = newProp.monthHeaderTemplate;\n                    this.monthHeaderTemplateFn = this.templateParser(this.activeViewOptions.monthHeaderTemplate);\n                    state.isLayout = true;\n                    break;\n                case 'resourceHeaderTemplate':\n                    this.activeViewOptions.resourceHeaderTemplate = newProp.resourceHeaderTemplate;\n                    this.resourceHeaderTemplateFn = this.templateParser(this.activeViewOptions.resourceHeaderTemplate);\n                    state.isLayout = true;\n                    break;\n                case 'timezone':\n                    this.eventBase.timezonePropertyChange(oldProp.timezone);\n                    this.headerModule.setCalendarTimezone();\n                    break;\n                case 'enableRtl':\n                    this.setRtlClass();\n                    state.isRefresh = true;\n                    break;\n                default:\n                    this.extendedPropertyChange(prop, newProp, oldProp, state);\n                    break;\n            }\n        }\n        this.propertyChangeAction(state);\n    }\n    propertyChangeAction(state) {\n        if (state.isRefresh) {\n            this.refresh();\n        }\n        else if (state.isResource) {\n            this.initializeResources(true);\n        }\n        else if (state.isView) {\n            this.changeView(this.currentView, null, true);\n        }\n        else if (state.isDate) {\n            this.changeDate(this.selectedDate);\n        }\n        else if (state.isLayout) {\n            this.initializeView(this.currentView);\n        }\n        else if (state.isDataManager && this.crudModule) {\n            if (this.dragAndDropModule) {\n                this.dragAndDropModule.actionObj.action = '';\n                removeClass([this.element], EVENT_ACTION_CLASS);\n            }\n            this.crudModule.refreshDataManager();\n        }\n    }\n    allDayRowScrollUpdate() {\n        const dateHeader = this.element.querySelector('.' + DATE_HEADER_WRAP_CLASS);\n        const allDayRow = this.element.querySelector('.' + ALLDAY_ROW_CLASS);\n        if (this.height === 'auto' || !this.enableAllDayScroll) {\n            addClass([dateHeader], ALLDAY_APPOINTMENT_AUTO);\n            if (dateHeader.classList.contains(ALLDAY_APPOINTMENT_SCROLL)) {\n                removeClass([dateHeader], ALLDAY_APPOINTMENT_SCROLL);\n            }\n            if (this.uiStateValues.expand) {\n                const allDayCells = [].slice.call(this.element.querySelectorAll('.' + ALLDAY_CELLS_CLASS));\n                allDayCells[0].style.height = (allDayRow.style.height) ? allDayRow.style.height : allDayCells[1].style.height;\n            }\n        }\n        else {\n            if (dateHeader.classList.contains(ALLDAY_APPOINTMENT_AUTO)) {\n                removeClass([dateHeader], ALLDAY_APPOINTMENT_AUTO);\n            }\n            this.eventBase.allDayExpandScroll(dateHeader);\n        }\n        if (!this.uiStateValues.expand) {\n            allDayRow.style.height = '';\n        }\n    }\n    extendedPropertyChange(prop, newProp, oldProp, state) {\n        switch (prop) {\n            case 'width':\n            case 'height':\n            case 'enableAllDayScroll':\n                if (['Day', 'Week', 'WorkWeek'].indexOf(this.currentView) > -1) {\n                    this.allDayRowScrollUpdate();\n                }\n                this.notify(uiUpdate, { module: 'scroll', properties: { width: newProp.width, height: newProp.height } });\n                break;\n            case 'cssClass':\n                if (oldProp.cssClass) {\n                    removeClass([this.element], oldProp.cssClass.split(' '));\n                }\n                if (newProp.cssClass) {\n                    addClass([this.element], newProp.cssClass.split(' '));\n                }\n                break;\n            case 'hideEmptyAgendaDays':\n            case 'agendaDaysCount':\n                this.activeViewOptions = this.getActiveViewOptions();\n                state.isView = true;\n                break;\n            case 'eventSettings':\n                this.onEventSettingsPropertyChanged(newProp.eventSettings, oldProp.eventSettings, state);\n                break;\n            case 'allowKeyboardInteraction':\n                if (this.keyboardInteractionModule) {\n                    this.keyboardInteractionModule.destroy();\n                    this.keyboardInteractionModule = null;\n                }\n                if (newProp.allowKeyboardInteraction) {\n                    this.keyboardInteractionModule = new KeyboardInteraction(this);\n                }\n                break;\n            case 'timezoneDataSource':\n                if (this.eventWindow) {\n                    this.eventWindow.refresh();\n                }\n                break;\n            case 'editorTemplate':\n                if (!isNullOrUndefined(this.editorTemplate)) {\n                    this.editorTemplateFn = this.templateParser(this.editorTemplate);\n                }\n                if (this.eventWindow) {\n                    this.eventWindow.setDialogContent();\n                }\n                break;\n            case 'quickInfoTemplates':\n                if (this.quickInfoTemplates.header) {\n                    this.quickInfoTemplatesHeaderFn = this.templateParser(this.quickInfoTemplates.header);\n                }\n                if (this.quickInfoTemplates.content) {\n                    this.quickInfoTemplatesContentFn = this.templateParser(this.quickInfoTemplates.content);\n                }\n                if (this.quickInfoTemplates.footer) {\n                    this.quickInfoTemplatesFooterFn = this.templateParser(this.quickInfoTemplates.footer);\n                }\n                break;\n            case 'group':\n                this.onGroupSettingsPropertyChanged(newProp.group, oldProp.group, state);\n                break;\n            case 'resources':\n                state.isResource = true;\n                break;\n            case 'timeScale':\n                this.activeViewOptions.timeScale.interval = newProp.timeScale.interval || this.activeViewOptions.timeScale.interval;\n                this.activeViewOptions.timeScale.slotCount = newProp.timeScale.slotCount || this.activeViewOptions.timeScale.slotCount;\n                if (this.eventWindow) {\n                    this.eventWindow.refreshDateTimePicker();\n                }\n                state.isLayout = true;\n                break;\n            case 'allowDragAndDrop':\n            case 'allowResizing':\n            case 'eventDragArea':\n                this.refreshEvents(false);\n                break;\n            case 'weekRule':\n                state.isLayout = true;\n                break;\n            case 'firstMonthOfYear':\n                this.activeViewOptions.firstMonthOfYear = newProp.firstMonthOfYear;\n                this.viewIndex = this.activeView.viewIndex;\n                state.isLayout = true;\n                break;\n            case 'monthsCount':\n                this.activeViewOptions.monthsCount = newProp.monthsCount;\n                this.viewIndex = this.activeView.viewIndex;\n                state.isLayout = true;\n                break;\n            case 'timeFormat':\n                this.internalTimeFormat = newProp.timeFormat || this.activeViewOptions.timeFormat;\n                if (this.eventWindow) {\n                    this.eventWindow.refreshDateTimePicker();\n                }\n                state.isLayout = true;\n                break;\n            case 'enableAdaptiveUI':\n                if (this.showHeaderBar && this.headerModule) {\n                    this.destroyHeaderModule();\n                    this.headerModule = new HeaderRenderer(this);\n                    this.headerModule.updateDateRange(this.activeView.getDateRangeText());\n                }\n                state.isLayout = true;\n                break;\n            case 'headerIndentTemplate':\n                this.activeViewOptions.headerIndentTemplate = newProp.headerIndentTemplate;\n                this.headerIndentTemplateFn = this.templateParser(this.activeViewOptions.headerIndentTemplate);\n                state.isLayout = true;\n                break;\n        }\n    }\n    setRtlClass() {\n        if (this.enableRtl) {\n            addClass([this.element], 'e-rtl');\n        }\n        else {\n            removeClass([this.element], 'e-rtl');\n        }\n    }\n    onGroupSettingsPropertyChanged(newProp, oldProp, state) {\n        for (const prop of Object.keys(newProp)) {\n            if (prop === 'headerTooltipTemplate') {\n                this.headerTooltipTemplateFn = this.templateParser(newProp[prop]);\n            }\n            else {\n                state.isLayout = true;\n                if (this.eventWindow) {\n                    this.eventWindow.refresh();\n                }\n            }\n        }\n    }\n    onEventSettingsPropertyChanged(newProp, oldProp, state) {\n        for (const prop of Object.keys(newProp)) {\n            switch (prop) {\n                case 'dataSource':\n                case 'query':\n                case 'fields':\n                    this.initializeDataModule();\n                    state.isDataManager = true;\n                    break;\n                case 'template':\n                    this.activeViewOptions.eventTemplate = newProp.template;\n                    this.appointmentTemplateFn = this.templateParser(this.activeViewOptions.eventTemplate);\n                    state.isDataManager = true;\n                    break;\n                case 'enableTooltip':\n                    if (this.eventTooltip) {\n                        this.eventTooltip.destroy();\n                        this.eventTooltip = null;\n                    }\n                    if (newProp.enableTooltip) {\n                        this.eventTooltip = new EventTooltip(this);\n                    }\n                    break;\n                case 'tooltipTemplate':\n                    this.eventTooltipTemplateFn = this.templateParser(this.eventSettings.tooltipTemplate);\n                    break;\n                case 'resourceColorField':\n                    if (this.resourceBase) {\n                        this.resourceBase.setResourceCollection();\n                    }\n                    state.isDataManager = true;\n                    break;\n                case 'editFollowingEvents':\n                    if (this.quickPopup) {\n                        this.quickPopup.refreshQuickDialog();\n                    }\n                    break;\n                case 'allowAdding':\n                case 'allowEditing':\n                case 'allowDeleting':\n                    if (this.showHeaderBar && this.headerModule) {\n                        this.headerModule.updateAddIcon();\n                    }\n                    if (this.eventWindow) {\n                        this.eventWindow.refresh();\n                    }\n                    break;\n                case 'spannedEventPlacement':\n                case 'minimumEventDuration':\n                case 'enableMaxHeight':\n                case 'enableIndicator':\n                    this.refreshEvents(false);\n                    break;\n                case 'ignoreWhitespace':\n                    state.isLayout = true;\n                    break;\n            }\n        }\n    }\n    destroyHeaderModule() {\n        if (this.headerModule) {\n            this.headerModule.destroy();\n            this.headerModule = null;\n        }\n    }\n    destroyPopups() {\n        if (this.quickPopup) {\n            this.quickPopup.destroy();\n            this.quickPopup = null;\n        }\n        if (this.eventWindow) {\n            this.eventWindow.destroy();\n            this.eventWindow = null;\n        }\n    }\n    /**\n     * Allows to show the spinner on schedule at the required scenarios.\n     *\n     * @function showSpinner\n     * @returns {void}\n     */\n    showSpinner() {\n        showSpinner(this.element);\n    }\n    /**\n     * When the spinner is shown manually using `showSpinner` method, it can be hidden using this `hideSpinner` method.\n     *\n     * @function hideSpinner\n     * @returns {void}\n     */\n    hideSpinner() {\n        hideSpinner(this.element);\n    }\n    /**\n     * Sets different working hours on the required working days by accepting the required start and end time as well as the date collection\n     *  as its parameters.\n     *\n     * @function setWorkHours\n     * @param {Date} dates Collection of dates on which the given start and end hour range needs to be applied.\n     * @param {string} start Defines the work start hour.\n     * @param {string} end Defines the work end hour.\n     * @param {number} groupIndex Defines the resource index from last level.\n     * @returns {void}\n     */\n    setWorkHours(dates, start, end, groupIndex) {\n        let cells = [];\n        cells = this.getWorkHourCells(dates, start, end, groupIndex);\n        addClass(cells, WORK_HOURS_CLASS);\n    }\n    /**\n     * Removes or resets different working hours on the required working days by accepting the required start and end time as well as the\n     * date collection as its parameters.\n     * if no parameters has been passed to this function, it will remove all the work hours.\n     *\n     * @param {Date} dates Collection of dates on which the given start and end hour range need to be applied.\n     * @param {string} start Defines the work start hour.\n     * @param {string} end Defines the work end hour.\n     * @param {number} groupIndex Defines the resource index from last level.\n     * @returns {void}\n     */\n    resetWorkHours(dates = this.activeView.renderDates, start, end, groupIndex) {\n        if (dates && start && end) {\n            const cells = this.getWorkHourCells(dates, start, end, groupIndex);\n            removeClass(cells, WORK_HOURS_CLASS);\n        }\n        else {\n            const workHourCells = [].slice.call(this.element.querySelectorAll('.' + WORK_HOURS_CLASS));\n            removeClass(workHourCells, WORK_HOURS_CLASS);\n        }\n    }\n    getWorkHourCells(dates, start, end, groupIndex) {\n        if (['Agenda', 'MonthAgenda', 'Month', 'TimelineMonth'].indexOf(this.currentView) > -1) {\n            return [];\n        }\n        let startHour = this.getStartEndTime(start);\n        let endHour = this.getStartEndTime(end);\n        const tableEle = this.getContentTable();\n        if (isNullOrUndefined(startHour) || isNullOrUndefined(endHour) || !tableEle) {\n            return [];\n        }\n        startHour.setMilliseconds(0);\n        endHour.setMilliseconds(0);\n        const viewStartHour = this.activeView.getStartHour();\n        if (startHour < viewStartHour) {\n            startHour = viewStartHour;\n        }\n        const viewEndHour = this.activeView.getEndHour();\n        if (endHour > viewEndHour) {\n            endHour = viewEndHour;\n        }\n        const msMajorInterval = this.activeViewOptions.timeScale.interval * MS_PER_MINUTE;\n        const msInterval = msMajorInterval / this.activeViewOptions.timeScale.slotCount;\n        let startIndex = Math.round((startHour.getTime() - viewStartHour.getTime()) / msInterval);\n        let endIndex = Math.ceil((endHour.getTime() - viewStartHour.getTime()) / msInterval);\n        const tempStartIndex = startIndex;\n        const tempEndIndex = endIndex;\n        const cells = [];\n        for (let date of dates) {\n            date = this.getDateTime(date);\n            resetTime(date);\n            let renderDates = this.activeView.renderDates;\n            if (!isNullOrUndefined(groupIndex) && this.resourceBase && !this.activeView.isTimelineView()) {\n                renderDates = this.resourceBase.lastResourceLevel[groupIndex].renderDates;\n            }\n            const colIndex = this.getIndexOfDate(renderDates, date);\n            if (colIndex >= 0) {\n                if (this.activeView.isTimelineView()) {\n                    const slotsPerDay = Math.round((viewEndHour.getTime() - viewStartHour.getTime()) / msInterval);\n                    startIndex = tempStartIndex + (colIndex * slotsPerDay);\n                    endIndex = tempEndIndex + (colIndex * slotsPerDay);\n                }\n                for (let i = startIndex; i < endIndex; i++) {\n                    if (this.activeView.isTimelineView()) {\n                        const rowIndex = (!isNullOrUndefined(groupIndex)) ? groupIndex : 0;\n                        cells.push(tableEle.rows[rowIndex].cells[i]);\n                    }\n                    else {\n                        if (!isNullOrUndefined(groupIndex)) {\n                            const selector = '.' + WORK_CELLS_CLASS + '[data-group-index=\"' + groupIndex + '\"]';\n                            const tds = [].slice.call(tableEle.rows[i].querySelectorAll(selector));\n                            cells.push(tds[colIndex]);\n                        }\n                        else {\n                            cells.push(tableEle.rows[i].cells[colIndex]);\n                        }\n                    }\n                }\n            }\n        }\n        return cells;\n    }\n    /**\n     * Retrieves the start and end time information of the specific cell element.\n     *\n     * @function getCellDetails\n     * @param {Element | Element[]} tdCol Accepts the single or collection of elements.\n     * @returns {CellClickEventArgs} Object An object holding the startTime, endTime and all-day information along with the target HTML element will be returned.\n     */\n    getCellDetails(tdCol) {\n        const td = (tdCol instanceof Array) ? tdCol : [tdCol];\n        const firstTd = getElement(td[0]);\n        const lastTd = getElement(td.slice(-1)[0]);\n        const startTime = this.getDateFromElement(firstTd);\n        let endTime = this.getDateFromElement(lastTd);\n        if (isNullOrUndefined(startTime) || isNullOrUndefined(endTime)) {\n            return undefined;\n        }\n        const endDateFromColSpan = this.activeView.isTimelineView() && !isNullOrUndefined(lastTd.getAttribute('colSpan')) &&\n            this.headerRows.length > 0;\n        const duration = endDateFromColSpan ? parseInt(lastTd.getAttribute('colSpan'), 10) : 1;\n        if (!this.activeViewOptions.timeScale.enable || endDateFromColSpan || lastTd.classList.contains(ALLDAY_CELLS_CLASS) ||\n            lastTd.classList.contains(HEADER_CELLS_CLASS)) {\n            endTime = addDays(new Date(endTime.getTime()), duration);\n        }\n        else {\n            endTime = this.activeView.getEndDateFromStartDate(endTime);\n        }\n        const data = {\n            startTime: startTime,\n            endTime: endTime,\n            isAllDay: this.isAllDayCell(firstTd),\n            element: tdCol\n        };\n        const groupIndex = firstTd.getAttribute('data-group-index');\n        if (!isNullOrUndefined(groupIndex)) {\n            data.groupIndex = parseInt(groupIndex, 10);\n        }\n        return data;\n    }\n    /**\n     * Retrieves the selected cell elements.\n     *\n     * @function getSelectedElements\n     * @returns {Element[]} The elements of currently selected cells will be returned.\n     */\n    getSelectedElements() {\n        return [].slice.call(this.element.querySelectorAll('.' + SELECTED_CELL_CLASS));\n    }\n    /**\n     * To get the resource collection\n     *\n     * @function getResourceCollections\n     * @returns {ResourcesModel[]} Returns the resource collections\n     */\n    getResourceCollections() {\n        return this.resourceCollection;\n    }\n    /**\n     * To set the resource collection\n     *\n     * @function setResourceCollections\n     * @param {ResourcesModel[]} resourceCol Accepts the resource collections in ResourcesModel type\n     * @returns {void}\n     */\n    setResourceCollections(resourceCol) {\n        this.setProperties({ resources: resourceCol }, false);\n    }\n    /**\n     * Current View could be change based on the provided parameters.\n     *\n     * @function changeCurrentView\n     * @param {View} viewName Accept the view in the viewCollections.\n     * @param {number} viewIndex Accept the viewIndex in the viewCollections.\n     * @returns {void}\n     */\n    changeCurrentView(viewName, viewIndex) {\n        let index = this.getViewIndex(viewName);\n        const view = viewName.charAt(0).toLowerCase() + viewName.slice(1);\n        const viewOptions = this.viewOptions[view];\n        if (viewOptions) {\n            index = this.viewCollections.indexOf(viewOptions[viewIndex || 0]);\n        }\n        if (index === -1 || index === this.viewIndex) {\n            return;\n        }\n        this.changeView(viewName, null, null, index);\n    }\n    /**\n     * Return the current view Index.\n     *\n     * @function getCurrentViewIndex\n     * @returns {number} Returns the view index\n     */\n    getCurrentViewIndex() {\n        return this.viewIndex;\n    }\n    /**\n     * Retrieves the resource details based on the provided resource index.\n     *\n     * @param {number} index index of the resources at the last level.\n     * @returns {ResourceDetails} Object An object holding the details of resource and resourceData.\n     */\n    getResourcesByIndex(index) {\n        if (this.resourceBase && this.resourceBase.lastResourceLevel) {\n            if (index < 0 || index >= this.resourceBase.lastResourceLevel.length) {\n                return undefined;\n            }\n            const data = this.resourceBase.lastResourceLevel[index];\n            const groupData = {};\n            this.resourceBase.setResourceValues(groupData, index);\n            return { resource: data.resource, resourceData: data.resourceData, groupData: groupData };\n        }\n        return undefined;\n    }\n    /**\n     * This method allows to expand the resource that available on the scheduler.\n     *\n     * @function expandResource\n     * @param {string | number} resourceId Accepts the resource id in either string or number type\n     * @param {string} name Accepts the name of the resource collection\n     * @returns {void}\n     */\n    expandResource(resourceId, name) {\n        if (this.activeView.isTimelineView() && this.resourceBase && this.resourceCollection.length > 1) {\n            this.resourceBase.resourceExpand(resourceId, name, false);\n        }\n    }\n    /**\n     * This method allows to collapse the resource that available on the scheduler.\n     *\n     * @function collapseResource\n     * @param {string | number} resourceId Accepts the resource id in either string or number type\n     * @param {string} name Accepts the name of the resource collection\n     * @returns {void}\n     */\n    collapseResource(resourceId, name) {\n        if (this.activeView.isTimelineView() && this.resourceBase && this.resourceCollection.length > 1) {\n            this.resourceBase.resourceExpand(resourceId, name, true);\n        }\n    }\n    /**\n     * Scrolls the Schedule content area to the specified time.\n     *\n     * @function scrollTo\n     * @param {string} hour Accepts the time value in the skeleton format of 'Hm'.\n     * @param {Date} scrollDate Accepts the date object value.\n     * @returns {void}\n     */\n    scrollTo(hour, scrollDate) {\n        if (this.activeView.scrollToDate && isNullOrUndefined(hour) && scrollDate) {\n            this.activeView.scrollToDate(scrollDate);\n        }\n        else if (this.activeView.scrollToHour) {\n            this.activeView.scrollToHour(hour, scrollDate);\n        }\n    }\n    /**\n     * This method allows scroll to the position of the any resources that available on the scheduler.\n     * This method is applicable for without Agenda and Month agenda views of the schedule.\n     *\n     * @function scrollToResource\n     * @param {string | number} resourceId Accepts the resource id in either string or number type\n     * @param {string} groupName Accepts the name of the resource collection\n     * @returns {void}\n     */\n    scrollToResource(resourceId, groupName) {\n        if (this.resourceBase && this.resourceBase.lastResourceLevel) {\n            this.resourceBase.resourceScroll(resourceId, groupName);\n        }\n    }\n    /**\n     * Exports the Scheduler events to a calendar (.ics) file. By default, the calendar is exported with a file name `Calendar.ics`.\n     * To change this file name on export, pass the custom string value as `fileName` to get the file downloaded with this provided name.\n     *\n     * @function exportToICalendar\n     * @param {string} fileName Accepts the string value.\n     * @param {Object[]} customData Accepts the collection of objects.\n     * @returns {void}\n     */\n    exportToICalendar(fileName, customData) {\n        if (this.iCalendarExportModule) {\n            this.iCalendarExportModule.initializeCalendarExport(fileName, customData);\n        }\n        else {\n            throw Error('Inject ICalendarExport module');\n        }\n    }\n    /**\n     * Imports the events from an .ics file downloaded from any of the calendars like Google or Outlook into the Scheduler.\n     * This method accepts the blob object or string format of an .ics file to be imported as a mandatory argument.\n     *\n     * @function importICalendar\n     * @param {Blob | string} fileContent Accepts the file object or string format of an .ics file.\n     * @returns {void}\n     */\n    importICalendar(fileContent) {\n        if (this.iCalendarImportModule) {\n            this.iCalendarImportModule.initializeCalendarImport(fileContent);\n        }\n        else {\n            throw Error('Inject ICalendarImport module');\n        }\n    }\n    /**\n     * Adds the newly created event into the Schedule dataSource.\n     *\n     * @function addEvent\n     * @param {Object | Object[]} data Single or collection of event objects to be added into Schedule.\n     * @returns {void}\n     */\n    addEvent(data) {\n        this.crudModule.addEvent(data);\n    }\n    /**\n     * Allows the Scheduler events data to be exported as an Excel file either in .xlsx or .csv file formats.\n     * By default, the whole event collection bound to the Scheduler gets exported as an Excel file.\n     * To export only the specific events of Scheduler, you need to pass the custom data collection as\n     * a parameter to this `exportToExcel` method. This method accepts the export options as arguments such as fileName,\n     * exportType, fields, customData, and includeOccurrences. The `fileName` denotes the name to be given for the exported\n     * file and the `exportType` allows you to set the format of an Excel file to be exported either as .xlsx or .csv.\n     * The custom or specific field collection of event dataSource to be exported can be provided through `fields` option\n     * and the custom data collection can be exported by passing them through the `customData` option. There also exists\n     * option to export each individual instances of the recurring events to an Excel file, by setting true or false to the\n     * `includeOccurrences` option, denoting either to include or exclude the occurrences as separate instances on an exported Excel file.\n     *\n     * @function exportToExcel\n     * @param {ExportOptions} excelExportOptions The export options to be set before start with exporting the Scheduler events to an Excel file.\n     * @returns {void}\n     */\n    exportToExcel(excelExportOptions) {\n        if (this.excelExportModule) {\n            this.excelExportModule.initializeExcelExport(excelExportOptions);\n        }\n        else {\n            throw Error('Inject ExcelExport module');\n        }\n    }\n    /**\n     * Method allows to print the scheduler.\n     *\n     * @function print\n     * @param {ScheduleModel} printOptions The export options to be set before start with exporting\n     * the Scheduler events to the print window.\n     * @returns {void}\n     */\n    print(printOptions) {\n        if (this.printModule) {\n            this.printModule.print(printOptions);\n        }\n        else {\n            throw Error('Inject Print module');\n        }\n    }\n    /**\n     * Updates the changes made in the event object by passing it as an parameter into the dataSource.\n     *\n     * @function saveEvent\n     * @param {Object | Object[]} data Single or collection of event objects to be saved into Schedule.\n     * @param {CurrentAction} currentAction Denotes the action that takes place either for editing occurrence or series.\n     *  The valid current action names are `EditOccurrence` or `EditSeries`.\n     * @returns {void}\n     */\n    saveEvent(data, currentAction) {\n        this.crudModule.saveEvent(data, currentAction);\n    }\n    /**\n     * Deletes the events based on the provided ID or event collection in the argument list.\n     *\n     * @function deleteEvent\n     * @param {string | number | Object | Object[]} id Accepts the ID as string or number type or single or collection of the event object which needs to be removed from the Schedule.\n     * @param {CurrentAction} currentAction Denotes the delete action that takes place either on occurrence or series events.\n     *  The valid current action names are `Delete`, `DeleteOccurrence` or `DeleteSeries`.\n     * @returns {void}\n     */\n    deleteEvent(id, currentAction) {\n        this.crudModule.deleteEvent(id, currentAction);\n    }\n    /**\n     * Retrieves the entire collection of events bound to the Schedule.\n     *\n     * @function getEvents\n     * @param {Date} startDate Accepts the start date.\n     * @param {Date} endDate Accepts te end date.\n     * @param {boolean} includeOccurrences Accepts the boolean value to process the occurrence from recurrence series.\n     * @returns {Object[]} Returns the collection of event objects from the Schedule.\n     */\n    getEvents(startDate, endDate, includeOccurrences) {\n        let eventCollections = [];\n        if (includeOccurrences) {\n            eventCollections = this.eventBase.getProcessedEvents();\n        }\n        else {\n            eventCollections = this.eventsData;\n        }\n        if (startDate) {\n            startDate = this.getDateTime(startDate);\n        }\n        if (endDate) {\n            endDate = this.getDateTime(endDate);\n        }\n        eventCollections = this.eventBase.filterEventsByRange(eventCollections, startDate, endDate);\n        return eventCollections;\n    }\n    /**\n     * Retrieves the entire collection of block events bound to the Schedule.\n     *\n     * @function getBlockEvents\n     * @param {Date} startDate Accepts the start date.\n     * @param {Date} endDate Accepts te end date.\n     * @param {boolean} includeOccurrences Accepts the boolean value to process the occurrence from recurrence series.\n     * @returns {Object[]} Returns the collection of block event objects from the Schedule.\n     */\n    getBlockEvents(startDate, endDate, includeOccurrences) {\n        let eventCollections = [];\n        if (includeOccurrences) {\n            eventCollections = this.eventBase.getProcessedEvents(this.blockData);\n        }\n        else {\n            eventCollections = this.blockData;\n        }\n        if (startDate) {\n            startDate = this.getDateTime(startDate);\n        }\n        if (endDate) {\n            endDate = this.getDateTime(endDate);\n        }\n        eventCollections = this.eventBase.filterEventsByRange(eventCollections, startDate, endDate);\n        return eventCollections;\n    }\n    /**\n     * Retrieves the occurrences of a single recurrence event based on the provided parent ID.\n     *\n     * @function getOccurrencesByID\n     * @param {number} eventID ID of the parent recurrence data from which the occurrences are fetched.\n     * @returns {Object[]} Returns the collection of occurrence event objects.\n     */\n    getOccurrencesByID(eventID) {\n        return this.eventBase.getOccurrencesByID(eventID);\n    }\n    /**\n     * Retrieves all the occurrences that lies between the specific start and end time range.\n     *\n     * @function getOccurrencesByRange\n     * @param {Date} startTime Denotes the start time range.\n     * @param {Date} endTime Denotes the end time range.\n     * @returns {Object[]} Returns the collection of occurrence event objects that lies between the provided start and end time.\n     */\n    getOccurrencesByRange(startTime, endTime) {\n        startTime = this.getDateTime(startTime);\n        endTime = this.getDateTime(endTime);\n        return this.eventBase.getOccurrencesByRange(startTime, endTime);\n    }\n    /**\n     * Retrieves the dates that lies on active view of Schedule.\n     *\n     * @function getCurrentViewDates\n     * @returns {Date[]} Returns the collection of dates.\n     */\n    getCurrentViewDates() {\n        return this.activeView ? this.activeView.renderDates : [];\n    }\n    /**\n     * Set the recurrence editor instance from custom editor template.\n     *\n     * @function setRecurrenceEditor\n     * @param {RecurrenceEditor} recurrenceEditor instance has passed to fetch the instance in event window.\n     * @returns {void}\n     */\n    setRecurrenceEditor(recurrenceEditor) {\n        this.eventWindow.setRecurrenceEditor(recurrenceEditor);\n    }\n    /**\n     * Get the maximum id of an event.\n     *\n     * @function getEventMaxID\n     * @returns {number | string} Returns the maximum ID from scheduler data collections.\n     */\n    getEventMaxID() {\n        return this.eventBase.getEventMaxID();\n    }\n    /**\n     * Get deleted occurrences from given recurrence series.\n     *\n     * @function getDeletedOccurrences\n     * @param {string | number | Object} recurrenceData Accepts the parent ID of the event object or parent event object\n     * @returns {Object[]} Returns the collection of deleted occurrence events.\n     */\n    getDeletedOccurrences(recurrenceData) {\n        return this.eventBase.getDeletedOccurrences(recurrenceData);\n    }\n    /**\n     * Retrieves the events that lies on the current date range of the active view of Schedule.\n     *\n     * @function getCurrentViewEvents\n     * @returns {Object[]} Returns the collection of events.\n     */\n    getCurrentViewEvents() {\n        return this.eventsProcessed;\n    }\n    /**\n     * Refreshes the event dataSource. This method may be useful when the events alone in the schedule needs to be re-rendered.\n     *\n     * @function refreshEvents\n     * @param {boolean} isRemoteRefresh Accepts the boolean to refresh data from remote or local\n     * @returns {void}\n     */\n    refreshEvents(isRemoteRefresh = true) {\n        if (this.dragAndDropModule) {\n            this.dragAndDropModule.actionObj.action = '';\n            removeClass([this.element], EVENT_ACTION_CLASS);\n        }\n        if (isRemoteRefresh) {\n            this.crudModule.refreshDataManager();\n        }\n        else {\n            if (this.activeViewOptions && this.activeViewOptions.eventTemplate) {\n                let templateNames = ['eventTemplate'];\n                if (this.crudModule && this.crudModule.crudObj.isCrudAction &&\n                    ['Agenda', 'MonthAgenda', 'Year', 'TimelineYear'].indexOf(this.currentView) === -1) {\n                    templateNames = [];\n                    for (let i = 0, len = this.crudModule.crudObj.sourceEvent.length; i < len; i++) {\n                        templateNames.push('eventTemplate_' + this.crudModule.crudObj.sourceEvent[i].groupIndex);\n                        if (this.crudModule.crudObj.targetEvent[i] && this.crudModule.crudObj.sourceEvent[i].groupIndex !==\n                            this.crudModule.crudObj.targetEvent[i].groupIndex) {\n                            templateNames.push('eventTemplate_' + this.crudModule.crudObj.targetEvent[i].groupIndex);\n                        }\n                    }\n                }\n                this.resetTemplates(templateNames);\n            }\n            const eventsData = this.eventsData || [];\n            const blockData = this.blockData || [];\n            const data = eventsData.concat(blockData);\n            this.notify(dataReady, { processedData: this.eventBase ? this.eventBase.processData(data) : [] });\n        }\n    }\n    /**\n     * Method to refresh the given Schedule templates\n     *\n     * @param {string} templateName Accepts the template name\n     * @returns {void}\n     */\n    refreshTemplates(templateName) {\n        if (templateName) {\n            this.resetTemplates([templateName]);\n        }\n        else {\n            this.resetTemplates();\n        }\n        switch (templateName) {\n            case 'eventTemplate':\n                this.appointmentTemplateFn = this.templateParser(this.activeViewOptions.eventTemplate);\n                this.refreshEvents(false);\n                break;\n            case 'dateHeaderTemplate':\n                this.dateHeaderTemplateFn = this.templateParser(this.activeViewOptions.dateHeaderTemplate);\n                this.activeView.refreshHeader();\n                break;\n            case 'resourceHeaderTemplate':\n                this.resourceHeaderTemplateFn = this.templateParser(this.activeViewOptions.resourceHeaderTemplate);\n                if (this.activeView.isTimelineView()) {\n                    this.activeView.refreshResourceHeader();\n                }\n                else {\n                    this.activeView.refreshHeader();\n                }\n                break;\n            case 'quickInfoTemplates':\n                if (this.quickPopup) {\n                    this.quickPopup.destroy();\n                    this.quickPopup = null;\n                }\n                this.quickPopup = new QuickPopups(this);\n                this.quickInfoTemplatesHeaderFn = this.templateParser(this.quickInfoTemplates.header);\n                this.quickInfoTemplatesContentFn = this.templateParser(this.quickInfoTemplates.content);\n                this.quickInfoTemplatesFooterFn = this.templateParser(this.quickInfoTemplates.footer);\n                break;\n            case 'editorTemplate':\n                if (this.eventWindow) {\n                    this.eventWindow.destroy();\n                    this.eventWindow = null;\n                }\n                this.eventWindow = new EventWindow(this);\n                this.editorTemplateFn = this.templateParser(this.editorTemplate);\n                break;\n            case 'tooltipTemplate':\n            case 'headerTooltipTemplate':\n                if (this.eventTooltip) {\n                    this.eventTooltip.destroy();\n                    this.eventTooltip = null;\n                }\n                this.eventTooltip = new EventTooltip(this);\n                this.eventTooltipTemplateFn = this.templateParser(this.eventSettings.tooltipTemplate);\n                this.headerTooltipTemplateFn = this.templateParser(this.activeViewOptions.group.headerTooltipTemplate);\n                break;\n            default:\n                this.initializeView(this.currentView);\n                break;\n        }\n    }\n    /**\n     * Refreshes the Schedule layout without re-render.\n     *\n     * @function refreshLayout\n     * @returns {void}\n     */\n    refreshLayout() {\n        this.onScheduleResize();\n        if (this.headerModule) {\n            this.headerModule.refresh();\n        }\n        if (this.eventWindow) {\n            this.eventWindow.refresh();\n        }\n    }\n    /**\n     * To retrieve the appointment object from element.\n     *\n     * @function getEventDetails\n     * @param {Element} element Denotes the event UI element on the Schedule.\n     * @returns {Object} Returns the event details.\n     */\n    getEventDetails(element) {\n        element = getElement(element);\n        const guid = element.getAttribute('data-guid');\n        if (guid) {\n            return this.eventBase.getEventByGuid(guid);\n        }\n        return {};\n    }\n    /**\n     * To check whether the given time range slots are available for event creation or already occupied by other events.\n     *\n     * @function isSlotAvailable\n     * @param {Date | Object} startTime Denotes the start time of the slot.\n     * @param {Date} endTime Denotes the end time of the slot.\n     * @param {number} groupIndex Defines the resource index from last level.\n     * @returns {boolean} Returns true, if the slot that lies in the provided time range does not contain any other events.\n     */\n    isSlotAvailable(startTime, endTime, groupIndex) {\n        let eventStart;\n        let eventEnd;\n        let eventObj = this.activeEventData.event;\n        if (startTime instanceof Date || typeof (startTime) === 'string') {\n            eventStart = startTime;\n            eventEnd = endTime;\n        }\n        else {\n            eventObj = startTime;\n            eventStart = startTime[this.eventFields.startTime];\n            eventEnd = startTime[this.eventFields.endTime];\n            if (this.resourceBase) {\n                groupIndex = this.eventBase.getGroupIndexFromEvent(startTime);\n            }\n        }\n        if (isNullOrUndefined(eventStart) || isNullOrUndefined(eventEnd)) {\n            return true;\n        }\n        eventStart = this.getDateTime(eventStart);\n        eventEnd = this.getDateTime(eventEnd);\n        let eventCollection = this.eventBase.filterEvents(eventStart, eventEnd);\n        if (!isNullOrUndefined(groupIndex) && this.resourceBase && this.resourceBase.lastResourceLevel.length > 0) {\n            eventCollection = this.eventBase.filterEventsByResource(this.resourceBase.lastResourceLevel[groupIndex], eventCollection);\n        }\n        if (eventObj) {\n            if (eventObj.Guid) {\n                eventCollection = eventCollection.filter((event) => event.Guid !== eventObj.Guid);\n            }\n            else {\n                eventCollection = eventCollection.filter((event) => event[this.eventFields.id] !== eventObj[this.eventFields.id]);\n            }\n        }\n        return (eventCollection.length > 0) ? false : true;\n    }\n    /**\n     * To manually open the event editor on specific time or on certain events.\n     *\n     * @function openEditor\n     * @param {Object} data It can be either cell data or event data.\n     * @param {CurrentAction} action Defines the action for which the editor needs to be opened such as either for new event creation or\n     *  for editing of existing events. The applicable action names that can be used here are `Add`, `Save`, `EditOccurrence`\n     *  and `EditSeries`.\n     * @param {boolean} isEventData It allows to decide whether the editor needs to be opened with the clicked cell details or with the\n     *  passed event details.\n     * @param {number} repeatType It opens the editor with the recurrence options based on the provided repeat type.\n     * @returns {void}\n     */\n    openEditor(data, action, isEventData, repeatType) {\n        if (action === 'Add' && !isEventData) {\n            data.startTime = this.getDateTime(data.startTime);\n            data.endTime = this.getDateTime(data.endTime);\n            if (!isNullOrUndefined(data.element)) {\n                data.element = getElement(data.element);\n            }\n        }\n        else {\n            data[this.eventFields.startTime] = this.getDateTime(data[this.eventFields.startTime]);\n            data[this.eventFields.endTime] = this.getDateTime(data[this.eventFields.endTime]);\n        }\n        this.currentAction = action;\n        if (action !== 'Add') {\n            this.activeEventData.event = data;\n        }\n        this.eventWindow.openEditor(data, action, isEventData, repeatType);\n    }\n    /**\n     * To manually close the event editor window\n     *\n     * @function closeEditor\n     * @returns {void}\n     */\n    closeEditor() {\n        if (this.eventWindow) {\n            this.eventWindow.dialogClose();\n        }\n    }\n    /**\n     * To manually open the quick info popup based on cell or event details.\n     *\n     * @param {object} data Defines the cell or event data. If the data contains valid ID, it will open event quick info popup,\n     * otherwise cell quick info popup displayed.\n     * @returns {void}\n     */\n    openQuickInfoPopup(data) {\n        if (this.currentView === 'Year' || isNullOrUndefined(data)) {\n            return;\n        }\n        if (isNullOrUndefined(data[this.eventFields.id])) {\n            if (this.currentView === 'Agenda' || this.currentView === 'MonthAgenda' || isNullOrUndefined(this.activeView)) {\n                return;\n            }\n            const cellData = {\n                startTime: this.activeCellsData.startTime = this.getDateTime(data[this.eventFields.startTime]),\n                endTime: this.activeCellsData.endTime = this.getDateTime(data[this.eventFields.endTime]),\n                isAllDay: this.activeCellsData.isAllDay =\n                    !isNullOrUndefined(data[this.eventFields.isAllDay]) ? data[this.eventFields.isAllDay] : false\n            };\n            const startTime = this.activeView.getAdjustedDate(new Date(cellData.startTime));\n            if (startTime) {\n                let query = '.' + WORK_CELLS_CLASS + '[data-date=\"' + startTime.getTime() + '\"]';\n                if (this.activeViewOptions.group.resources.length > 0 && !this.uiStateValues.isGroupAdaptive\n                    && this.resourceBase && this.eventBase) {\n                    cellData.groupIndex = this.eventBase.getGroupIndexFromEvent(data);\n                    query = '.' + WORK_CELLS_CLASS + '[data-date=\"' + startTime.getTime() + '\"][data-group-index=\"' + cellData.groupIndex + '\"]';\n                }\n                const workCell = this.element.querySelector(query);\n                if (workCell) {\n                    workCell.focus();\n                    cellData.element = workCell;\n                    this.notify(cellClick, cellData);\n                }\n            }\n        }\n        else {\n            const app = this.getCurrentViewEvents().filter((item) => data[this.eventFields.id] === item[this.eventFields.id]);\n            if (app.length <= 0) {\n                return;\n            }\n            let selectEvent = app[0];\n            if (data[this.eventFields.recurrenceRule]) {\n                const occurence = app.filter((x) => x[this.eventFields.startTime].getTime() === data[this.eventFields.startTime].getTime());\n                if (occurence.length > 0) {\n                    selectEvent = occurence[0];\n                }\n            }\n            const element = this.element.querySelector('div[data-guid=\"' + selectEvent.Guid + '\"]');\n            if (element) {\n                this.eventBase.removeSelectedAppointmentClass();\n                this.eventBase.addSelectedAppointments([element]);\n                this.activeEventData = { event: selectEvent, element: element };\n                if (this.currentView === 'Agenda' || this.currentView === 'MonthAgenda') {\n                    addClass([this.activeEventData.element], AGENDA_SELECTED_CELL);\n                }\n                this.notify(eventClick, this.activeEventData);\n            }\n        }\n    }\n    /**\n     * To manually close the quick info popup\n     *\n     * @function closeQuickInfoPopup\n     * @returns {void}\n     */\n    closeQuickInfoPopup() {\n        if (this.quickPopup) {\n            this.quickPopup.quickPopupHide(true);\n        }\n    }\n    /**\n     * Select the resource based on group index in mobile mode.\n     *\n     * @param {number} groupIndex Defines the resource index based on last level.\n     * @returns {void}\n     */\n    selectResourceByIndex(groupIndex) {\n        if (this.resourceBase && this.uiStateValues.isGroupAdaptive) {\n            this.resourceBase.selectResourceByIndex(groupIndex);\n        }\n    }\n    /**\n     * Select the resources to the based on id.\n     *\n     * @param {string | number} id id of the resource defined in resources collection.\n     * @param {string} name Name of the resource defined in resources collection.\n     * @returns {number} Returns the group index\n     */\n    getIndexFromResourceId(id, name) {\n        if (this.resourceBase) {\n            return this.resourceBase.getIndexFromResourceId(id, name);\n        }\n        return null;\n    }\n    /**\n     * Adds the resources to the specified index.\n     *\n     * @param {Object | Object[]} resources Accepts the resource data in single or collection of data.\n     * @param {string} name Name of the resource defined in resources collection.\n     * @param {number} index Index or position where the resource should be added.\n     * @returns {void}\n     */\n    addResource(resources, name, index) {\n        this.resourceBase.addResource(resources, name, index);\n    }\n    /**\n     * Removes the specified resource.\n     *\n     * @param {string | string[] | number | number[]} resourceId Specifies the resource id to be removed.\n     * @param {string} name Specifies the resource name from which the id should be referred.\n     * @returns {void}\n     */\n    removeResource(resourceId, name) {\n        this.resourceBase.removeResource(resourceId, name);\n    }\n    /**\n     * Destroys the Schedule component.\n     *\n     * @function destroy\n     * @returns {void}\n     */\n    destroy() {\n        if (this.eventTooltip) {\n            this.eventTooltip.destroy();\n            this.eventTooltip = null;\n        }\n        this.destroyPopups();\n        this.hideSpinner();\n        this.unWireEvents();\n        this.destroyHeaderModule();\n        if (this.eventTooltip) {\n            this.eventTooltip.destroy();\n            this.eventTooltip = null;\n        }\n        if (this.eventBase) {\n            this.eventBase.destroy();\n            this.eventBase = null;\n        }\n        if (this.workCellAction) {\n            this.workCellAction.destroy();\n            this.workCellAction = null;\n        }\n        if (this.inlineModule) {\n            this.inlineModule.destroy();\n            this.inlineModule = null;\n        }\n        if (this.keyboardInteractionModule) {\n            this.keyboardInteractionModule.destroy();\n            this.keyboardInteractionModule = null;\n        }\n        if (this.scrollModule) {\n            this.scrollModule.destroy();\n            this.scrollModule = null;\n        }\n        if (this.printModule) {\n            this.printModule.destroy();\n        }\n        if (this.activeView) {\n            this.resetTemplates();\n            this.activeView.removeEventListener();\n            this.activeView.destroy();\n            this.activeView = null;\n        }\n        if (this.scheduleTouchModule) {\n            this.scheduleTouchModule.destroy();\n            this.scheduleTouchModule = null;\n        }\n        if (this.crudModule) {\n            this.crudModule.destroy();\n            this.crudModule = null;\n        }\n        if (this.dataModule) {\n            this.dataModule.destroy();\n            this.dataModule = null;\n        }\n        super.destroy();\n        const modules = [\n            'dayModule', 'weekModule', 'workWeekModule', 'monthModule', 'monthAgendaModule', 'yearModule', 'agendaModule',\n            'timelineViewsModule', 'timelineMonthModule', 'timelineYearModule', 'resizeModule', 'dragAndDropModule',\n            'excelExportModule', 'printModule', 'iCalendarExportModule', 'iCalendarImportModule', 'tzModule', 'eventsData',\n            'eventsProcessed', 'blockData', 'blockProcessed', 'uiStateValues', 'viewCollections', 'viewOptions', 'defaultLocale',\n            'localeObj', 'selectedElements', 'resourceCollection', 'editorTitles', 'eventFields', 'activeViewOptions',\n            'activeEventData', 'activeCellsData', 'renderModule'\n        ];\n        for (const module of modules) {\n            this[module] = null;\n        }\n        removeChildren(this.element);\n        let removeClasses = [ROOT, RTL, DEVICE_CLASS, MULTI_DRAG];\n        if (this.cssClass) {\n            removeClasses = removeClasses.concat(this.cssClass.split(' '));\n        }\n        removeClass([this.element], removeClasses);\n    }\n};\n__decorate([\n    Property('auto')\n], Schedule.prototype, \"width\", void 0);\n__decorate([\n    Property('auto')\n], Schedule.prototype, \"height\", void 0);\n__decorate([\n    Property(true)\n], Schedule.prototype, \"showHeaderBar\", void 0);\n__decorate([\n    Property(true)\n], Schedule.prototype, \"showTimeIndicator\", void 0);\n__decorate([\n    Property('Week')\n], Schedule.prototype, \"currentView\", void 0);\n__decorate([\n    Property(['Day', 'Week', 'WorkWeek', 'Month', 'Agenda'])\n], Schedule.prototype, \"views\", void 0);\n__decorate([\n    Property(new Date())\n], Schedule.prototype, \"selectedDate\", void 0);\n__decorate([\n    Property(new Date(1900, 0, 1))\n], Schedule.prototype, \"minDate\", void 0);\n__decorate([\n    Property(new Date(2099, 11, 31))\n], Schedule.prototype, \"maxDate\", void 0);\n__decorate([\n    Property()\n], Schedule.prototype, \"dateFormat\", void 0);\n__decorate([\n    Property('Gregorian')\n], Schedule.prototype, \"calendarMode\", void 0);\n__decorate([\n    Property(true)\n], Schedule.prototype, \"showWeekend\", void 0);\n__decorate([\n    Property(0)\n], Schedule.prototype, \"firstDayOfWeek\", void 0);\n__decorate([\n    Property('FirstDay')\n], Schedule.prototype, \"weekRule\", void 0);\n__decorate([\n    Property([1, 2, 3, 4, 5])\n], Schedule.prototype, \"workDays\", void 0);\n__decorate([\n    Property(12)\n], Schedule.prototype, \"monthsCount\", void 0);\n__decorate([\n    Property('00:00')\n], Schedule.prototype, \"startHour\", void 0);\n__decorate([\n    Property('24:00')\n], Schedule.prototype, \"endHour\", void 0);\n__decorate([\n    Property(null)\n], Schedule.prototype, \"timeFormat\", void 0);\n__decorate([\n    Property(false)\n], Schedule.prototype, \"enableAllDayScroll\", void 0);\n__decorate([\n    Property(false)\n], Schedule.prototype, \"enableAdaptiveUI\", void 0);\n__decorate([\n    Property(true)\n], Schedule.prototype, \"allowResizing\", void 0);\n__decorate([\n    Complex({}, WorkHours)\n], Schedule.prototype, \"workHours\", void 0);\n__decorate([\n    Complex({}, TimeScale)\n], Schedule.prototype, \"timeScale\", void 0);\n__decorate([\n    Property(true)\n], Schedule.prototype, \"allowKeyboardInteraction\", void 0);\n__decorate([\n    Property(true)\n], Schedule.prototype, \"allowDragAndDrop\", void 0);\n__decorate([\n    Property()\n], Schedule.prototype, \"dateHeaderTemplate\", void 0);\n__decorate([\n    Property()\n], Schedule.prototype, \"cellHeaderTemplate\", void 0);\n__decorate([\n    Property()\n], Schedule.prototype, \"dayHeaderTemplate\", void 0);\n__decorate([\n    Property()\n], Schedule.prototype, \"monthHeaderTemplate\", void 0);\n__decorate([\n    Property()\n], Schedule.prototype, \"cellTemplate\", void 0);\n__decorate([\n    Property(false)\n], Schedule.prototype, \"readonly\", void 0);\n__decorate([\n    Property(true)\n], Schedule.prototype, \"showQuickInfo\", void 0);\n__decorate([\n    Property(false)\n], Schedule.prototype, \"allowInline\", void 0);\n__decorate([\n    Property(true)\n], Schedule.prototype, \"allowMultiCellSelection\", void 0);\n__decorate([\n    Property(true)\n], Schedule.prototype, \"allowMultiRowSelection\", void 0);\n__decorate([\n    Property(false)\n], Schedule.prototype, \"quickInfoOnSelectionEnd\", void 0);\n__decorate([\n    Property(false)\n], Schedule.prototype, \"showWeekNumber\", void 0);\n__decorate([\n    Property(false)\n], Schedule.prototype, \"rowAutoHeight\", void 0);\n__decorate([\n    Property(false)\n], Schedule.prototype, \"allowMultiDrag\", void 0);\n__decorate([\n    Property(0)\n], Schedule.prototype, \"firstMonthOfYear\", void 0);\n__decorate([\n    Property()\n], Schedule.prototype, \"editorTemplate\", void 0);\n__decorate([\n    Complex({}, QuickInfoTemplates)\n], Schedule.prototype, \"quickInfoTemplates\", void 0);\n__decorate([\n    Property(7)\n], Schedule.prototype, \"agendaDaysCount\", void 0);\n__decorate([\n    Property(true)\n], Schedule.prototype, \"hideEmptyAgendaDays\", void 0);\n__decorate([\n    Property(true)\n], Schedule.prototype, \"enableRecurrenceValidation\", void 0);\n__decorate([\n    Property()\n], Schedule.prototype, \"timezone\", void 0);\n__decorate([\n    Complex({}, EventSettings)\n], Schedule.prototype, \"eventSettings\", void 0);\n__decorate([\n    Property(timezoneData)\n], Schedule.prototype, \"timezoneDataSource\", void 0);\n__decorate([\n    Property()\n], Schedule.prototype, \"resourceHeaderTemplate\", void 0);\n__decorate([\n    Property()\n], Schedule.prototype, \"headerIndentTemplate\", void 0);\n__decorate([\n    Complex({}, Group)\n], Schedule.prototype, \"group\", void 0);\n__decorate([\n    Collection([], Resources)\n], Schedule.prototype, \"resources\", void 0);\n__decorate([\n    Collection([], HeaderRows)\n], Schedule.prototype, \"headerRows\", void 0);\n__decorate([\n    Property()\n], Schedule.prototype, \"cssClass\", void 0);\n__decorate([\n    Property()\n], Schedule.prototype, \"eventDragArea\", void 0);\n__decorate([\n    Event()\n], Schedule.prototype, \"created\", void 0);\n__decorate([\n    Event()\n], Schedule.prototype, \"destroyed\", void 0);\n__decorate([\n    Event()\n], Schedule.prototype, \"cellClick\", void 0);\n__decorate([\n    Event()\n], Schedule.prototype, \"cellDoubleClick\", void 0);\n__decorate([\n    Event()\n], Schedule.prototype, \"moreEventsClick\", void 0);\n__decorate([\n    Event()\n], Schedule.prototype, \"hover\", void 0);\n__decorate([\n    Event()\n], Schedule.prototype, \"select\", void 0);\n__decorate([\n    Event()\n], Schedule.prototype, \"actionBegin\", void 0);\n__decorate([\n    Event()\n], Schedule.prototype, \"actionComplete\", void 0);\n__decorate([\n    Event()\n], Schedule.prototype, \"actionFailure\", void 0);\n__decorate([\n    Event()\n], Schedule.prototype, \"navigating\", void 0);\n__decorate([\n    Event()\n], Schedule.prototype, \"renderCell\", void 0);\n__decorate([\n    Event()\n], Schedule.prototype, \"eventClick\", void 0);\n__decorate([\n    Event()\n], Schedule.prototype, \"eventRendered\", void 0);\n__decorate([\n    Event()\n], Schedule.prototype, \"dataBinding\", void 0);\n__decorate([\n    Event()\n], Schedule.prototype, \"popupOpen\", void 0);\n__decorate([\n    Event()\n], Schedule.prototype, \"popupClose\", void 0);\n__decorate([\n    Event()\n], Schedule.prototype, \"dragStart\", void 0);\n__decorate([\n    Event()\n], Schedule.prototype, \"drag\", void 0);\n__decorate([\n    Event()\n], Schedule.prototype, \"dragStop\", void 0);\n__decorate([\n    Event()\n], Schedule.prototype, \"resizeStart\", void 0);\n__decorate([\n    Event()\n], Schedule.prototype, \"resizing\", void 0);\n__decorate([\n    Event()\n], Schedule.prototype, \"resizeStop\", void 0);\n__decorate([\n    Event()\n], Schedule.prototype, \"dataBound\", void 0);\nSchedule = __decorate([\n    NotifyPropertyChanges\n], Schedule);\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\n/**\n * Base class for the common drag and resize related actions\n */\nclass ActionBase {\n    constructor(parent) {\n        this.daysVariation = 0;\n        this.parent = parent;\n        this.actionObj = {\n            X: 0, Y: 0, groupIndex: 0, cellWidth: 0, cellHeight: 0, slotInterval: 0, interval: 0, actionIndex: 0,\n            cloneElement: [], originalElement: [], action: null, isAllDay: null, excludeSelectors: null,\n            index: 0, navigationInterval: null, scrollInterval: null\n        };\n        this.scrollArgs = { element: null, width: 0, height: 0 };\n        this.resizeEdges = { left: false, right: false, top: false, bottom: false };\n        this.scrollEdges = { left: false, right: false, top: false, bottom: false };\n    }\n    getChangedData(multiData) {\n        const eventObj = extend({}, this.actionObj.event, null, true);\n        eventObj[this.parent.eventFields.startTime] = this.actionObj.start;\n        eventObj[this.parent.eventFields.endTime] = this.actionObj.end;\n        if (!isNullOrUndefined(this.actionObj.isAllDay)) {\n            eventObj[this.parent.eventFields.isAllDay] = this.actionObj.isAllDay;\n        }\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            const originalElement = this.getOriginalElement(this.actionObj.element);\n            if (originalElement) {\n                let indexCol = originalElement.map((element) => parseInt(element.getAttribute('data-group-index'), 10));\n                if (indexCol.indexOf(this.actionObj.groupIndex) === -1 || (!isNullOrUndefined(multiData) && multiData.length > 0)) {\n                    const cloneIndex = parseInt(this.actionObj.clone.getAttribute('data-group-index'), 10);\n                    indexCol = indexCol.filter((index) => index !== cloneIndex);\n                    indexCol.push(this.actionObj.groupIndex);\n                    if (multiData && multiData.length > 0) {\n                        multiData.forEach((data) => {\n                            this.parent.resourceBase.getResourceData(data, this.actionObj.groupIndex, indexCol);\n                        });\n                    }\n                    else {\n                        this.parent.resourceBase.getResourceData(eventObj, this.actionObj.groupIndex, indexCol);\n                    }\n                }\n            }\n        }\n        return eventObj;\n    }\n    saveChangedData(eventArgs, isMultiSelect = false) {\n        this.parent.activeEventData.event = this.actionObj.event;\n        this.parent.currentAction = 'Save';\n        let currentAction;\n        let eventsCollection = [eventArgs.data];\n        if (isMultiSelect) {\n            eventsCollection = eventArgs.selectedData;\n        }\n        for (const eventObj of eventsCollection) {\n            const isSameResource = (this.parent.activeViewOptions.group.resources.length > 0) ?\n                parseInt(this.actionObj.element.getAttribute('data-group-index'), 10) === this.actionObj.groupIndex : true;\n            if (+eventObj[this.parent.eventFields.startTime] === +this.actionObj.event[this.parent.eventFields.startTime] &&\n                +eventObj[this.parent.eventFields.endTime] === +this.actionObj.event[this.parent.eventFields.endTime] && isSameResource) {\n                return;\n            }\n            if (eventObj[this.parent.eventFields.recurrenceRule]) {\n                const eveId = (eventObj[this.parent.eventFields.recurrenceID] || eventObj[this.parent.eventFields.id]);\n                if (eventObj[this.parent.eventFields.id] === eventObj[this.parent.eventFields.recurrenceID]) {\n                    eventObj[this.parent.eventFields.id] = this.parent.eventBase.getEventMaxID();\n                    currentAction = 'EditOccurrence';\n                }\n                if (this.parent.enableRecurrenceValidation\n                    && this.parent.eventWindow.editOccurrenceValidation(eveId, eventObj, this.actionObj.event)) {\n                    return;\n                }\n            }\n            else {\n                currentAction = null;\n            }\n            if (eventObj[this.parent.eventFields.startTimezone] || eventObj[this.parent.eventFields.endTimezone]) {\n                this.parent.eventBase.timezoneConvert(eventObj);\n            }\n            this.parent.crudModule.saveEvent(eventObj, currentAction);\n        }\n    }\n    calculateIntervalTime(date) {\n        const intervalTime = new Date(+date);\n        intervalTime.setMinutes(Math.floor(intervalTime.getMinutes() / this.actionObj.interval) * this.actionObj.interval);\n        return intervalTime;\n    }\n    getContentAreaDimension() {\n        const viewElement = this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS);\n        let trElement = [].slice.call(viewElement.querySelector('tr').children);\n        if (!this.parent.activeView.isTimelineView() && this.parent.activeViewOptions.group.resources.length > 0 &&\n            !this.parent.isAdaptive && !this.parent.enableAdaptiveUI) {\n            trElement = this.getResourceElements(trElement);\n        }\n        const leftOffset = trElement[0].getBoundingClientRect();\n        const rightOffset = trElement.slice(-1)[0].getBoundingClientRect();\n        const viewDimension = {\n            bottom: viewElement.scrollHeight - 5,\n            left: this.parent.enableRtl ? rightOffset.left : leftOffset.left,\n            right: this.parent.enableRtl ? leftOffset.right : rightOffset.right,\n            top: 0,\n            leftOffset: this.parent.enableRtl ? rightOffset.right : leftOffset.right,\n            rightOffset: this.parent.enableRtl ? leftOffset.left : rightOffset.left\n        };\n        return viewDimension;\n    }\n    getPageCoordinates(e) {\n        const eventArgs = e.event;\n        return eventArgs && eventArgs.changedTouches ? eventArgs.changedTouches[0] : e.changedTouches ? e.changedTouches[0] :\n            eventArgs || e;\n    }\n    getIndex(index) {\n        const contentElements = [].slice.call(this.parent.getContentTable().querySelector('tr').children);\n        const indexes = { minIndex: 0, maxIndex: contentElements.length - 1 };\n        if (this.actionObj.action === 'resize' && this.parent.activeViewOptions.group.resources.length > 0 &&\n            !this.parent.uiStateValues.isGroupAdaptive && !this.parent.activeView.isTimelineView()) {\n            const groupElements = this.getResourceElements(contentElements);\n            indexes.minIndex = groupElements[0].cellIndex;\n            indexes.maxIndex = groupElements.slice(-1)[0].cellIndex;\n        }\n        if (index < indexes.minIndex) {\n            index = indexes.minIndex;\n        }\n        if (index > indexes.maxIndex) {\n            index = indexes.maxIndex;\n        }\n        return index;\n    }\n    updateTimePosition(date, multiData) {\n        let index = 0;\n        for (const cloneElement of this.actionObj.cloneElement) {\n            const timeElement = cloneElement.querySelector('.' + APPOINTMENT_TIME);\n            if (timeElement) {\n                let startTime = this.actionObj.start;\n                let endTime = this.actionObj.end;\n                if (multiData && multiData.length > 0) {\n                    startTime = multiData[index][this.parent.eventFields.startTime];\n                    endTime = multiData[index][this.parent.eventFields.endTime];\n                }\n                timeElement.innerHTML = this.parent.getTimeString(startTime) + ' - ' +\n                    this.parent.getTimeString(endTime);\n            }\n            index++;\n        }\n        if (!this.parent.activeViewOptions.timeScale.enable || !this.parent.isAdaptive || this.parent.currentView === 'Month' ||\n            this.parent.currentView === 'TimelineMonth') {\n            return;\n        }\n        let timeIndicator = this.parent.element.querySelector('.' + CLONE_TIME_INDICATOR_CLASS);\n        if (!timeIndicator) {\n            timeIndicator = createElement('div', { className: CLONE_TIME_INDICATOR_CLASS });\n            const wrapperClass = this.parent.activeView.isTimelineView() ? DATE_HEADER_WRAP_CLASS : TIME_CELLS_WRAP_CLASS;\n            this.parent.element.querySelector('.' + wrapperClass).appendChild(timeIndicator);\n        }\n        timeIndicator.innerHTML = this.parent.getTimeString(date);\n        let offsetValue = 0;\n        if (this.parent.activeView.isTimelineView()) {\n            if (this.parent.enableRtl) {\n                const rightValue = parseInt(this.actionObj.clone.style.right, 10);\n                offsetValue = this.actionObj.action === 'drag' || this.resizeEdges.left ?\n                    rightValue + this.actionObj.clone.offsetWidth : rightValue;\n                timeIndicator.style.right = formatUnit(offsetValue);\n            }\n            else {\n                const leftValue = parseInt(this.actionObj.clone.style.left, 10);\n                offsetValue = this.actionObj.action === 'drag' || this.resizeEdges.left ?\n                    leftValue : leftValue + this.actionObj.clone.offsetWidth;\n                timeIndicator.style.left = formatUnit(offsetValue);\n            }\n        }\n        else {\n            offsetValue = this.actionObj.action === 'drag' || this.resizeEdges.top ? this.actionObj.clone.offsetTop :\n                this.actionObj.clone.offsetTop + this.actionObj.clone.offsetHeight;\n            timeIndicator.style.top = formatUnit(offsetValue);\n        }\n    }\n    getResourceElements(table) {\n        return table.filter((element) => parseInt(element.getAttribute('data-group-index'), 10) === this.actionObj.groupIndex);\n    }\n    getOriginalElement(element) {\n        let originalElement;\n        const guid = element.getAttribute('data-guid');\n        const isMorePopup = element.offsetParent && element.offsetParent.classList.contains(MORE_EVENT_POPUP_CLASS);\n        if (isMorePopup || this.parent.activeView.isTimelineView()) {\n            originalElement = [].slice.call(this.parent.element.querySelectorAll('[data-guid=\"' + guid + '\"]'));\n        }\n        else {\n            const tr = closest(element, 'tr');\n            if (tr) {\n                originalElement = [].slice.call(tr.querySelectorAll('[data-guid=\"' + guid + '\"]'));\n            }\n        }\n        return originalElement;\n    }\n    createCloneElement(element) {\n        const cloneWrapper = createElement('div', { innerHTML: element.outerHTML });\n        const cloneElement = cloneWrapper.children[0];\n        const cloneClassLists = [CLONE_ELEMENT_CLASS];\n        cloneClassLists.push((this.actionObj.action === 'drag') ? DRAG_CLONE_CLASS : RESIZE_CLONE_CLASS);\n        if (this.parent.currentView === 'Month' || this.parent.currentView === 'TimelineMonth') {\n            cloneClassLists.push(MONTH_CLONE_ELEMENT_CLASS);\n        }\n        addClass([cloneElement], cloneClassLists);\n        addClass([element], EVENT_ACTION_CLASS);\n        if (!isNullOrUndefined(element.parentElement)) {\n            element.parentElement.appendChild(cloneElement);\n        }\n        cloneElement.style.width = formatUnit(cloneElement.offsetWidth - 2);\n        const dragElement = document.querySelector(this.parent.eventDragArea);\n        if (this.parent.eventDragArea && this.actionObj.action === 'drag' && dragElement) {\n            dragElement.appendChild(cloneElement);\n        }\n        setStyleAttribute(cloneElement, { border: '0px' });\n        return cloneElement;\n    }\n    removeCloneElementClasses() {\n        let elements = this.actionObj.originalElement;\n        if (this.parent.currentView === 'Month' || this.parent.currentView === 'TimelineYear' ||\n            this.parent.currentView === 'Day' || this.parent.currentView === 'Week' || this.parent.currentView === 'WorkWeek') {\n            elements = [].slice.call(this.parent.element.querySelectorAll('.' + EVENT_ACTION_CLASS));\n        }\n        removeClass(elements, EVENT_ACTION_CLASS);\n    }\n    removeCloneElement() {\n        this.actionObj.originalElement = [];\n        const dynamicEle = [].slice.call(this.parent.element.querySelectorAll('.e-dynamic-clone'));\n        for (const cloneEle of dynamicEle) {\n            remove(cloneEle);\n        }\n        for (const cloneElement of this.actionObj.cloneElement) {\n            if (!isNullOrUndefined(cloneElement.parentNode)) {\n                remove(cloneElement);\n            }\n        }\n        this.actionObj.cloneElement = [];\n        const timeIndicator = this.parent.element.querySelector('.' + CLONE_TIME_INDICATOR_CLASS);\n        if (timeIndicator) {\n            remove(timeIndicator);\n        }\n    }\n    getCursorElement(e) {\n        const pages = this.getPageCoordinates(e);\n        return document.elementFromPoint(pages.clientX, pages.clientY);\n    }\n    autoScroll() {\n        const parent = this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS);\n        const yIsScrollable = parent.offsetHeight <= parent.scrollHeight;\n        const xIsScrollable = parent.offsetWidth <= parent.scrollWidth;\n        const yInBounds = yIsScrollable && parent.scrollTop >= 0 && parent.scrollTop + parent.offsetHeight <= parent.scrollHeight;\n        let xInBounds = xIsScrollable && parent.scrollLeft >= 0 && parent.scrollLeft + parent.offsetWidth <= parent.scrollWidth;\n        if (this.actionObj.action === 'resize' && this.scrollEdges.right && (parent.scrollLeft + parent.offsetWidth) > parent.scrollWidth) {\n            const tdCollections = ([].slice.call(this.parent.getContentTable().querySelector('tr').children)).length - 1;\n            const cellIndex = Math.ceil((this.actionObj.clone.offsetLeft + (this.actionObj.clone.offsetWidth)) /\n                this.actionObj.cellWidth);\n            xInBounds = cellIndex === tdCollections;\n        }\n        if (yInBounds && (this.scrollEdges.top || this.scrollEdges.bottom)) {\n            parent.scrollTop += this.scrollEdges.top ? -this.actionObj.scroll.scrollBy : this.actionObj.scroll.scrollBy;\n            if (this.actionObj.action === 'resize') {\n                if (parent.scrollHeight !== parent.offsetHeight + parent.scrollTop && parent.scrollTop > 0) {\n                    this.actionObj.Y += this.scrollEdges.top ? this.actionObj.scroll.scrollBy : -this.actionObj.scroll.scrollBy;\n                }\n            }\n        }\n        if (xInBounds && (this.scrollEdges.left || this.scrollEdges.right)) {\n            parent.scrollLeft += this.scrollEdges.left ? -this.actionObj.scroll.scrollBy : this.actionObj.scroll.scrollBy;\n            if (this.actionObj.action === 'resize') {\n                if (parent.scrollWidth !== parent.offsetWidth + parent.scrollLeft && parent.scrollLeft > 0) {\n                    this.actionObj.X += this.scrollEdges.left ? this.actionObj.scroll.scrollBy : -this.actionObj.scroll.scrollBy;\n                }\n            }\n        }\n    }\n    autoScrollValidation() {\n        if (!this.actionObj.scroll.enable) {\n            return false;\n        }\n        const res = this.parent.boundaryValidation(this.actionObj.pageY, this.actionObj.pageX);\n        this.scrollEdges = res;\n        return res.bottom || res.top || res.left || res.right;\n    }\n    actionClass(type) {\n        if (type === 'addClass') {\n            addClass([this.parent.element], EVENT_ACTION_CLASS);\n        }\n        else {\n            removeClass([this.parent.element], EVENT_ACTION_CLASS);\n        }\n    }\n    updateScrollPosition(e) {\n        this.scrollEventArgs = e;\n        if (this.actionObj.scroll.enable && isNullOrUndefined(this.actionObj.scrollInterval)) {\n            this.actionObj.scrollInterval = window.setInterval(() => {\n                if (this.autoScrollValidation() && !this.actionObj.clone.classList.contains(ALLDAY_APPOINTMENT_CLASS)) {\n                    if (this.parent.activeView.isTimelineView() && this.parent.activeViewOptions.group.resources.length > 0\n                        && this.actionObj.groupIndex < 0) {\n                        return;\n                    }\n                    this.autoScroll();\n                    if (this.actionObj.action === 'drag') {\n                        this.parent.dragAndDropModule.updateDraggingDateTime(this.scrollEventArgs);\n                    }\n                    else {\n                        this.parent.resizeModule.updateResizingDirection(this.scrollEventArgs);\n                    }\n                }\n            }, this.actionObj.scroll.timeDelay);\n        }\n    }\n    updateOriginalElement(cloneElement) {\n        let query = '[data-id=\"' + cloneElement.getAttribute('data-id') + '\"]';\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            query = query.concat('[data-group-index = \"' + cloneElement.getAttribute('data-group-index') + '\"]');\n        }\n        const elements = [].slice.call(this.parent.element.querySelectorAll(query));\n        addClass(elements, EVENT_ACTION_CLASS);\n        const eventWrappers = [].slice.call(this.parent.element.querySelectorAll('.' + CLONE_ELEMENT_CLASS));\n        removeClass(eventWrappers, EVENT_ACTION_CLASS);\n    }\n    getUpdatedEvent(startTime, endTime, eventObj) {\n        const event = JSON.parse(JSON.stringify(eventObj));\n        event[this.parent.eventFields.startTime] = startTime;\n        event[this.parent.eventFields.endTime] = endTime;\n        return event;\n    }\n    dynamicYearlyEventsRendering(event, isResize = false) {\n        let appWidth = this.actionObj.cellWidth - 7;\n        if (isResize && (this.resizeEdges.left || this.resizeEdges.right)) {\n            appWidth = this.actionObj.cellWidth * event.count;\n        }\n        if (!isResize && (this.parent.activeViewOptions.orientation === 'Horizontal' && this.parent.activeViewOptions.group.resources.length === 0)) {\n            const eventObj = this.yearEvent.isSpannedEvent(event, event[this.parent.eventFields.startTime]);\n            if (eventObj[this.parent.eventFields.startTime].getTime() ===\n                eventObj[this.parent.eventFields.endTime].getTime()) {\n                eventObj.isSpanned.count = 1;\n            }\n            appWidth = eventObj.isSpanned.count * this.actionObj.cellWidth;\n        }\n        const appointmentElement = this.createAppointmentElement(this.actionObj.groupIndex, event[this.parent.eventFields.subject]);\n        appointmentElement.setAttribute('drag', 'true');\n        addClass([appointmentElement], CLONE_ELEMENT_CLASS);\n        setStyleAttribute(appointmentElement, {\n            'width': appWidth + 'px', 'border': '0px', 'pointer-events': 'none',\n            'position': 'absolute', 'overflow': 'hidden', 'padding': '3px'\n        });\n        if (this.actionObj.clone.style.backgroundColor !== '') {\n            setStyleAttribute(appointmentElement, { 'backgroundColor': this.actionObj.clone.style.backgroundColor });\n        }\n        const date = resetTime(event[this.parent.eventFields.startTime]).getTime();\n        let query = '.' + WORK_CELLS_CLASS + '[data-date=\"' + date + '\"]';\n        if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n            query = '.' + WORK_CELLS_CLASS + '[data-date=\"' + date + '\"][data-group-index=\"' + this.actionObj.groupIndex + '\"]';\n        }\n        const cellTd = this.parent.element.querySelector(query);\n        if (isNullOrUndefined(cellTd)) {\n            return;\n        }\n        if (isResize) {\n            const dateHeader = cellTd.querySelector('.' + DATE_HEADER_CLASS);\n            let appHeight = this.actionObj.cellHeight * event.count -\n                (dateHeader ? dateHeader.offsetHeight : 0) - 7;\n            if (this.resizeEdges.right || this.resizeEdges.left) {\n                appHeight = parseInt(this.actionObj.clone.style.height, 10);\n            }\n            setStyleAttribute(appointmentElement, { 'height': appHeight + 'px' });\n        }\n        this.renderDynamicElement(cellTd, appointmentElement, true);\n        this.actionObj.cloneElement.push(appointmentElement);\n    }\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    renderDynamicElement(cellTd, element, isAppointment = false) {\n        if (cellTd.querySelector('.' + APPOINTMENT_WRAPPER_CLASS)) {\n            cellTd.querySelector('.' + APPOINTMENT_WRAPPER_CLASS).appendChild(element);\n        }\n        else {\n            const wrapper = createElement('div', { className: APPOINTMENT_WRAPPER_CLASS });\n            wrapper.appendChild(element);\n            cellTd.appendChild(wrapper);\n        }\n    }\n    createAppointmentElement(resIndex, innerText) {\n        const appointmentWrapper = createElement('div', {\n            className: APPOINTMENT_CLASS,\n            innerHTML: innerText\n        });\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            appointmentWrapper.setAttribute('data-group-index', resIndex.toString());\n        }\n        return appointmentWrapper;\n    }\n    dynamicEventsRendering(event) {\n        let dateRender = this.parent.activeView.renderDates;\n        let workCells = [].slice.call(this.parent.element.querySelectorAll('.' + WORK_CELLS_CLASS));\n        let workDays = this.parent.activeViewOptions.workDays;\n        let groupOrder;\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            const resources = this.parent.resourceBase.lastResourceLevel.\n                filter((res) => res.groupIndex === this.actionObj.groupIndex);\n            dateRender = resources[0].renderDates;\n            const elementSelector = `.${WORK_CELLS_CLASS}[data-group-index=\"${this.actionObj.groupIndex}\"]`;\n            workCells = [].slice.call(this.parent.element.querySelectorAll(elementSelector));\n            workDays = resources[0].workDays;\n            groupOrder = resources[0].groupOrder;\n        }\n        this.monthEvent.dateRender = dateRender;\n        this.monthEvent.getSlotDates(workDays);\n        if (this.resizeEdges.left || this.resizeEdges.right) {\n            const eventWrappers = [].slice.call(this.parent.element.querySelectorAll('.' + CLONE_ELEMENT_CLASS));\n            for (const wrapper of eventWrappers) {\n                remove(wrapper);\n            }\n        }\n        const spannedEvents = this.monthEvent.splitEvent(event, dateRender);\n        for (const event of spannedEvents) {\n            const day = this.parent.getIndexOfDate(dateRender, resetTime(event[this.monthEvent.fields.startTime]));\n            const diffInDays = event.data.count;\n            const appWidth = (diffInDays * this.actionObj.cellWidth) - 7;\n            const appointmentElement = this.monthEvent.createAppointmentElement(event, this.actionObj.groupIndex, true);\n            appointmentElement.setAttribute('drag', 'true');\n            addClass([appointmentElement], CLONE_ELEMENT_CLASS);\n            this.monthEvent.applyResourceColor(appointmentElement, event, 'backgroundColor', groupOrder);\n            setStyleAttribute(appointmentElement, { 'width': appWidth + 'px', 'border': '0px', 'pointer-events': 'none' });\n            const cellTd = workCells[day];\n            if (cellTd && isNullOrUndefined(this.parent.eventDragArea)) {\n                this.monthEvent.renderElement(cellTd, appointmentElement, true);\n                this.actionObj.cloneElement.push(appointmentElement);\n            }\n        }\n    }\n    destroy() {\n        if (!this.parent || this.parent && this.parent.isDestroyed) {\n            return;\n        }\n        this.actionObj = {};\n        this.scrollArgs = {};\n        this.resizeEdges = { left: false, right: false, top: false, bottom: false };\n        this.scrollEdges = { left: false, right: false, top: false, bottom: false };\n    }\n}\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\n/**\n * Schedule events resize actions\n */\nclass Resize extends ActionBase {\n    wireResizeEvent(element) {\n        const resizeElement = [].slice.call(element.querySelectorAll('.' + EVENT_RESIZE_CLASS));\n        for (const element of resizeElement) {\n            EventHandler.add(element, Browser.touchStartEvent, this.resizeStart, this);\n        }\n    }\n    resizeHelper() {\n        if (this.parent.activeViewOptions.group.resources.length > 0 && this.parent.activeViewOptions.group.allowGroupEdit) {\n            for (let i = 0, len = this.actionObj.originalElement.length; i < len; i++) {\n                const cloneElement = this.createCloneElement(this.actionObj.originalElement[i]);\n                this.actionObj.cloneElement[i] = cloneElement;\n                if (this.actionObj.element === this.actionObj.originalElement[i]) {\n                    this.actionObj.clone = cloneElement;\n                }\n            }\n        }\n        else {\n            if (this.actionObj.element) {\n                this.actionObj.clone = this.createCloneElement(this.actionObj.element);\n            }\n            this.actionObj.cloneElement = [this.actionObj.clone];\n            this.actionObj.originalElement = [this.actionObj.element];\n        }\n    }\n    resizeStart(e) {\n        this.actionObj.action = 'resize';\n        this.actionObj.slotInterval = this.parent.activeViewOptions.timeScale.interval / this.parent.activeViewOptions.timeScale.slotCount;\n        this.actionObj.interval = this.actionObj.slotInterval;\n        const resizeTarget = closest(e.target, '.' + EVENT_RESIZE_CLASS);\n        this.actionObj.element = closest(resizeTarget, '.' + APPOINTMENT_CLASS);\n        this.actionObj.event = this.parent.eventBase.getEventByGuid(this.actionObj.element.getAttribute('data-guid'));\n        const eventObj = extend({}, this.actionObj.event, null, true);\n        const resizeArgs = {\n            cancel: false,\n            data: eventObj,\n            element: this.actionObj.element,\n            event: e,\n            interval: this.actionObj.interval,\n            scroll: { enable: true, scrollBy: 30, timeDelay: 100 }\n        };\n        this.parent.trigger(resizeStart, resizeArgs, (resizeEventArgs) => {\n            if (resizeEventArgs.cancel) {\n                return;\n            }\n            this.actionClass('addClass');\n            this.parent.uiStateValues.action = true;\n            this.resizeEdges = {\n                left: resizeTarget.classList.contains(LEFT_RESIZE_HANDLER),\n                right: resizeTarget.classList.contains(RIGHT_RESIZE_HANDLER),\n                top: resizeTarget.classList.contains(TOP_RESIZE_HANDLER),\n                bottom: resizeTarget.classList.contains(BOTTOM_RESIZE_HANDLER)\n            };\n            this.actionObj.groupIndex = this.parent.uiStateValues.isGroupAdaptive ? this.parent.uiStateValues.groupIndex : 0;\n            const workCell = this.parent.element.querySelector('.' + WORK_CELLS_CLASS).getBoundingClientRect();\n            this.actionObj.cellWidth = workCell.width;\n            this.actionObj.cellHeight = workCell.height;\n            const hRows = this.parent.activeViewOptions.headerRows.map((row) => row.option);\n            if (this.parent.activeView.isTimelineView() && hRows.length > 0 && ['Date', 'Hour'].indexOf(hRows.slice(-1)[0]) < 0) {\n                const tr = this.parent.getContentTable().querySelector('tr');\n                let noOfDays = 0;\n                const tdCollections = [].slice.call(tr.children);\n                for (const td of tdCollections) {\n                    noOfDays += parseInt(td.getAttribute('colspan'), 10);\n                }\n                const trRect = tr.getBoundingClientRect();\n                this.actionObj.cellWidth = trRect.width / noOfDays;\n                this.actionObj.cellHeight = trRect.height;\n            }\n            const pages = this.getPageCoordinates(e);\n            this.actionObj.X = pages.pageX;\n            this.actionObj.Y = pages.pageY;\n            this.actionObj.groupIndex = parseInt(this.actionObj.element.getAttribute('data-group-index') || '0', 10);\n            this.actionObj.interval = resizeEventArgs.interval;\n            this.actionObj.scroll = resizeEventArgs.scroll;\n            this.actionObj.start = new Date(eventObj[this.parent.eventFields.startTime].getTime());\n            this.actionObj.end = new Date(eventObj[this.parent.eventFields.endTime].getTime());\n            this.actionObj.originalElement = this.getOriginalElement(this.actionObj.element);\n            if (this.parent.currentView === 'Month') {\n                this.daysVariation = -1;\n                this.monthEvent = new MonthEvent(this.parent);\n            }\n            const viewElement = this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS);\n            this.scrollArgs = { element: viewElement, width: viewElement.scrollWidth, height: viewElement.scrollHeight };\n            EventHandler.add(document, Browser.touchMoveEvent, this.resizing, this);\n            EventHandler.add(document, Browser.touchEndEvent, this.resizeStop, this);\n        });\n    }\n    resizing(e) {\n        if (this.parent.quickPopup) {\n            this.parent.quickPopup.quickPopupHide();\n        }\n        if (this.parent.element.querySelectorAll('.' + RESIZE_CLONE_CLASS).length === 0) {\n            this.resizeHelper();\n        }\n        if ((!isNullOrUndefined(e.target)) && e.target.classList.contains(DISABLE_DATES)) {\n            return;\n        }\n        const pages = this.getPageCoordinates(e);\n        this.actionObj.pageX = pages.pageX;\n        this.actionObj.pageY = pages.pageY;\n        this.updateScrollPosition(e);\n        this.updateResizingDirection(e);\n        const eventObj = extend({}, this.actionObj.event, null, true);\n        const resizeArgs = {\n            cancel: false,\n            data: eventObj,\n            element: this.actionObj.element,\n            event: e,\n            startTime: this.actionObj.start,\n            endTime: this.actionObj.end\n        };\n        if (this.parent.group.resources.length > 0) {\n            resizeArgs.groupIndex = this.actionObj.groupIndex;\n        }\n        this.parent.trigger(resizing, resizeArgs);\n    }\n    updateResizingDirection(e) {\n        if (this.parent.currentView === 'Month' || this.parent.currentView === 'TimelineYear') {\n            this.monthResizing();\n            return;\n        }\n        const resizeValidation = this.resizeValidation(e);\n        if (this.resizeEdges.left) {\n            if (resizeValidation) {\n                const leftStyles = this.getLeftRightStyles(e, true);\n                if (parseInt(leftStyles.width, 10) < 1) {\n                    return;\n                }\n                for (const cloneElement of this.actionObj.cloneElement) {\n                    setStyleAttribute(cloneElement, leftStyles);\n                    addClass([cloneElement], LEFT_RESIZE_HANDLER);\n                }\n            }\n            this.horizontalResizing(!this.parent.enableRtl);\n        }\n        if (this.resizeEdges.right) {\n            if (resizeValidation) {\n                const rightStyles = this.getLeftRightStyles(e, false);\n                if (parseInt(rightStyles.width, 10) < 1) {\n                    return;\n                }\n                for (const cloneElement of this.actionObj.cloneElement) {\n                    setStyleAttribute(cloneElement, rightStyles);\n                    addClass([cloneElement], RIGHT_RESIZE_HANDLER);\n                }\n            }\n            this.horizontalResizing(this.parent.enableRtl);\n        }\n        if (this.resizeEdges.top) {\n            if (resizeValidation) {\n                const topStyles = this.getTopBottomStyles(e, true);\n                if (parseInt(topStyles.height, 10) < 1) {\n                    return;\n                }\n                for (const cloneElement of this.actionObj.cloneElement) {\n                    setStyleAttribute(cloneElement, topStyles);\n                    addClass([cloneElement], TOP_RESIZE_HANDLER);\n                }\n            }\n            this.verticalResizing(true);\n        }\n        if (this.resizeEdges.bottom) {\n            if (resizeValidation) {\n                const bottomStyles = this.getTopBottomStyles(e, false);\n                if (parseInt(bottomStyles.height, 10) < 1) {\n                    return;\n                }\n                for (const cloneElement of this.actionObj.cloneElement) {\n                    setStyleAttribute(cloneElement, bottomStyles);\n                    addClass([cloneElement], BOTTOM_RESIZE_HANDLER);\n                }\n            }\n            this.verticalResizing(false);\n        }\n    }\n    monthResizing() {\n        this.removeCloneElement();\n        if (isNullOrUndefined(this.actionObj.pageX) || isNullOrUndefined(this.actionObj.pageY)) {\n            return;\n        }\n        const td = document.elementFromPoint(this.actionObj.pageX, this.actionObj.pageY);\n        if (isNullOrUndefined(td)) {\n            return;\n        }\n        const resizeTime = this.parent.getDateFromElement(td);\n        const isSameCell = this.parent.activeViewOptions.group.resources.length > 0 ?\n            parseInt(td.getAttribute('data-group-index'), 10) === this.actionObj.groupIndex : true;\n        let startTime = new Date(this.actionObj.event[this.parent.eventFields.startTime].getTime());\n        let endTime = new Date(this.actionObj.event[this.parent.eventFields.endTime].getTime());\n        if ((!this.parent.enableRtl && this.resizeEdges.left) || (this.parent.enableRtl && this.resizeEdges.right)\n            || this.resizeEdges.top) {\n            startTime = resizeTime;\n        }\n        else if ((!this.parent.enableRtl && this.resizeEdges.right) || (this.parent.enableRtl && this.resizeEdges.left)\n            || this.resizeEdges.bottom) {\n            endTime = addDays(resizeTime, 1);\n        }\n        if (isSameCell && startTime < endTime) {\n            this.actionObj.start = startTime;\n            this.actionObj.end = endTime;\n            const event = this.getUpdatedEvent(this.actionObj.start, this.actionObj.end, this.actionObj.event);\n            if (this.parent.currentView === 'TimelineYear') {\n                this.yearEventsRendering(event);\n            }\n            else {\n                this.dynamicEventsRendering(event);\n            }\n            this.updateOriginalElement(this.actionObj.clone);\n        }\n    }\n    yearEventsRendering(event) {\n        const eventWrappers = [].slice.call(this.parent.element.querySelectorAll('.' + CLONE_ELEMENT_CLASS));\n        for (const wrapper of eventWrappers) {\n            remove(wrapper);\n        }\n        let endDate = new Date(event[this.parent.eventFields.endTime]);\n        let monthDiff = 0;\n        if (this.parent.activeViewOptions.group.resources.length === 0) {\n            monthDiff = this.getMonthDiff(event[this.parent.eventFields.startTime], addDays(endDate, -1));\n        }\n        for (let i = 0; i <= monthDiff; i++) {\n            let eventObj;\n            if (this.parent.activeViewOptions.group.resources.length === 0) {\n                eventObj = this.getEventCount(event, this.actionObj.start.getMonth() + i);\n            }\n            else {\n                eventObj = extend({}, event, null, true);\n                endDate = this.resizeEdges.left || this.resizeEdges.right ? addDays(endDate, -1) : endDate;\n                eventObj.count = this.getMonthDiff(event[this.parent.eventFields.startTime], endDate) + 1;\n            }\n            this.dynamicYearlyEventsRendering(eventObj, true);\n        }\n    }\n    getMonthDiff(startDate, endDate) {\n        let months;\n        months = (endDate.getFullYear() - startDate.getFullYear()) * 12;\n        months -= startDate.getMonth();\n        months += endDate.getMonth();\n        return months <= 0 ? 0 : months;\n    }\n    getEventCount(eventObj, month) {\n        const eventData = extend({}, eventObj, null, true);\n        const eventStart = eventData[this.parent.eventFields.startTime];\n        const eventEnd = eventData[this.parent.eventFields.endTime];\n        const monthStart = new Date(this.parent.selectedDate.getFullYear(), month, 1);\n        const monthEnd = addDays(new Date(this.parent.selectedDate.getFullYear(), month + 1, 0), 1);\n        let count = 1;\n        if (eventStart.getTime() < monthStart.getTime()) {\n            eventData[this.parent.eventFields.startTime] = monthStart;\n        }\n        if (eventEnd.getTime() > monthEnd.getTime()) {\n            eventData[this.parent.eventFields.endTime] = monthEnd;\n        }\n        if (this.parent.activeViewOptions.group.resources.length === 0) {\n            count = Math.ceil((eventData[this.parent.eventFields.endTime].getTime() -\n                eventData[this.parent.eventFields.startTime].getTime()) / MS_PER_DAY);\n        }\n        eventData.count = count;\n        return eventData;\n    }\n    resizeStop(e) {\n        EventHandler.remove(document, Browser.touchMoveEvent, this.resizing);\n        EventHandler.remove(document, Browser.touchEndEvent, this.resizeStop);\n        clearInterval(this.actionObj.scrollInterval);\n        this.actionObj.scrollInterval = null;\n        this.removeCloneElementClasses();\n        this.removeCloneElement();\n        this.actionClass('removeClass');\n        this.parent.uiStateValues.action = false;\n        const resizeArgs = { cancel: false, data: this.getChangedData(), element: this.actionObj.element, event: e };\n        this.parent.trigger(resizeStop, resizeArgs, (resizeEventArgs) => {\n            if (resizeEventArgs.cancel) {\n                return;\n            }\n            if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.rowAutoHeight\n                && !this.parent.activeViewOptions.group.allowGroupEdit && !this.parent.virtualScrollModule\n                && this.parent.activeViewOptions.group.byGroupID) {\n                this.parent.crudModule.crudObj.sourceEvent =\n                    [this.parent.resourceBase.lastResourceLevel[parseInt(resizeEventArgs.element.getAttribute('data-group-index'), 10)]];\n                this.parent.crudModule.crudObj.targetEvent = this.parent.crudModule.crudObj.sourceEvent;\n                this.parent.crudModule.crudObj.isCrudAction = true;\n            }\n            this.saveChangedData(resizeEventArgs);\n        });\n    }\n    verticalResizing(isTop) {\n        let offsetValue = this.actionObj.clone.offsetTop;\n        if (!isTop) {\n            offsetValue += this.actionObj.clone.offsetHeight;\n        }\n        const minutes = (offsetValue / this.actionObj.cellHeight) * this.actionObj.slotInterval;\n        const element = this.actionObj.clone.offsetParent;\n        if (isNullOrUndefined(element)) {\n            return;\n        }\n        const resizeTime = resetTime(this.parent.getDateFromElement(element));\n        resizeTime.setHours(this.parent.activeView.getStartHour().getHours());\n        resizeTime.setMinutes(minutes + this.parent.activeView.getStartHour().getMinutes());\n        if (isTop) {\n            this.actionObj.start = this.calculateIntervalTime(resizeTime);\n        }\n        else {\n            this.actionObj.end = this.calculateIntervalTime(resizeTime);\n        }\n        this.updateTimePosition(resizeTime);\n    }\n    horizontalResizing(isLeft) {\n        const eventStart = new Date(this.actionObj.event[this.parent.eventFields.startTime].getTime());\n        const eventEnd = new Date(this.actionObj.event[this.parent.eventFields.endTime].getTime());\n        let resizeTime;\n        let isDateHeader = false;\n        let headerName = this.parent.currentView;\n        const isTimeViews = ['TimelineDay', 'TimelineWeek', 'TimelineWorkWeek'].indexOf(this.parent.currentView) > -1;\n        const isTimelineMonth = this.parent.currentView === 'TimelineMonth';\n        const isWithoutScale = isTimelineMonth || isTimeViews && !this.parent.activeViewOptions.timeScale.enable;\n        if (this.parent.activeView.isTimelineView()) {\n            const tr = this.parent.getContentTable().querySelector('tr');\n            if (this.parent.activeViewOptions.headerRows.length > 0) {\n                const rows = this.parent.activeViewOptions.headerRows.map((row) => row.option);\n                headerName = rows.slice(-1)[0];\n                if (isTimelineMonth && headerName === 'Hour') {\n                    headerName = rows.slice(-2)[0] || 'Month';\n                }\n            }\n            resizeTime = isLeft ? eventStart : eventEnd;\n            let cellIndex = 0;\n            const tdCollections = [].slice.call(tr.children);\n            let isLastCell = false;\n            const pixelsPerMinute = this.actionObj.cellWidth / (this.parent.activeViewOptions.timeScale.interval /\n                this.parent.activeViewOptions.timeScale.slotCount);\n            let offset = parseFloat(this.parent.enableRtl ? this.actionObj.clone.style.right :\n                this.actionObj.clone.style.left);\n            offset = Math.round(offset / pixelsPerMinute) * pixelsPerMinute;\n            if (['Year', 'Month', 'Week', 'Date'].indexOf(headerName) !== -1) {\n                let noOfDays = 0;\n                for (const td of tdCollections) {\n                    noOfDays += parseInt(td.getAttribute('colspan'), 10);\n                }\n                let offsetValue = this.parent.enableRtl ? parseInt(this.actionObj.clone.style.right, 10) :\n                    parseInt(this.actionObj.clone.style.left, 10);\n                offsetValue = Math.round(offsetValue / this.actionObj.cellWidth) * this.actionObj.cellWidth;\n                if (!isLeft) {\n                    offsetValue += (this.actionObj.clone.getBoundingClientRect().width - this.actionObj.cellWidth);\n                }\n                cellIndex = Math.floor(offsetValue / Math.floor(tr.getBoundingClientRect().width / noOfDays));\n                isDateHeader = isTimeViews && headerName === 'Date';\n                cellIndex = isLeft ? cellIndex : isTimelineMonth ? cellIndex + 1 : cellIndex;\n                isLastCell = cellIndex === tdCollections.length;\n                cellIndex = (cellIndex < 0) ? 0 : (cellIndex >= noOfDays) ? noOfDays - 1 : cellIndex;\n            }\n            else {\n                const cellWidth = this.actionObj.cellWidth;\n                cellIndex = isLeft ? Math.floor(offset / this.actionObj.cellWidth) :\n                    Math.ceil((offset + (this.actionObj.clone.getBoundingClientRect().width - cellWidth)) / this.actionObj.cellWidth);\n                if (this.parent.enableRtl) {\n                    let cellOffsetWidth = 0;\n                    if (headerName === 'TimelineMonth' || (!this.parent.activeViewOptions.timeScale.enable &&\n                        !isTimelineMonth)) {\n                        cellOffsetWidth = this.actionObj.cellWidth;\n                    }\n                    const offsetWidth = (Math.floor(offset / this.actionObj.cellWidth) *\n                        this.actionObj.cellWidth) + (isLeft ? 0 : this.actionObj.clone.getBoundingClientRect().width - cellOffsetWidth);\n                    cellIndex = Math.floor(offsetWidth / this.actionObj.cellWidth);\n                }\n                isLastCell = cellIndex === tdCollections.length;\n                cellIndex = this.getIndex(cellIndex);\n            }\n            let resizeDate;\n            if (['Year', 'Month', 'Week', 'Date'].indexOf(headerName) !== -1) {\n                resizeDate = new Date(this.parent.activeView.renderDates[cellIndex].getTime());\n            }\n            else {\n                resizeDate = this.parent.getDateFromElement(tr.children[cellIndex]);\n            }\n            if (['TimelineMonth', 'Year', 'Month', 'Week', 'Date'].indexOf(headerName) !== -1 ||\n                !this.parent.activeViewOptions.timeScale.enable) {\n                resizeTime = new Date(resizeDate.setHours(resizeTime.getHours(), resizeTime.getMinutes(), resizeTime.getSeconds()));\n            }\n            else {\n                if (!isLeft) {\n                    offset += this.actionObj.clone.getBoundingClientRect().width;\n                }\n                let spanMinutes = Math.ceil((this.actionObj.slotInterval / this.actionObj.cellWidth) *\n                    (offset - Math.floor(offset / this.actionObj.cellWidth) * this.actionObj.cellWidth));\n                spanMinutes = (isLastCell || (!isLeft && spanMinutes === 0)) ? this.actionObj.slotInterval : spanMinutes;\n                resizeTime = new Date(resizeDate.getTime());\n                resizeTime.setMinutes(resizeTime.getMinutes() + spanMinutes);\n                this.updateTimePosition(resizeTime);\n            }\n        }\n        else {\n            const cloneIndex = closest(this.actionObj.clone, 'td').cellIndex;\n            const originalWidth = Math.ceil((isLeft ? this.actionObj.element.getBoundingClientRect().width : 0) /\n                this.actionObj.cellWidth) * this.actionObj.cellWidth;\n            const noOfDays = Math.ceil((this.actionObj.clone.getBoundingClientRect().width - originalWidth) /\n                this.actionObj.cellWidth);\n            const tr = closest(this.actionObj.clone, 'tr');\n            let dayIndex = isLeft ? cloneIndex - noOfDays : cloneIndex + noOfDays - 1;\n            dayIndex = this.getIndex(dayIndex);\n            resizeTime = this.parent.getDateFromElement(tr.children[dayIndex]);\n            if (isLeft) {\n                resizeTime.setHours(eventStart.getHours(), eventStart.getMinutes(), eventStart.getSeconds());\n            }\n            else {\n                resizeTime.setHours(eventEnd.getHours(), eventEnd.getMinutes(), eventEnd.getSeconds());\n            }\n        }\n        if (isLeft) {\n            if ((eventEnd.getTime() - resizeTime.getTime()) <= 0) {\n                resizeTime = isWithoutScale ? resetTime(eventEnd) : eventStart;\n            }\n            this.actionObj.start = this.parent.activeViewOptions.timeScale.enable ? this.calculateIntervalTime(resizeTime) : resizeTime;\n        }\n        else {\n            const isTimeScaleViews = isTimeViews && this.parent.activeViewOptions.timeScale.enable;\n            let resizeEnd = ((!isTimeScaleViews || isDateHeader || isTimeViews && ['Week', 'Month', 'Year'].indexOf(headerName) > -1)\n                && resizeTime.getHours() === 0 && resizeTime.getMinutes() === 0) ? addDays(resizeTime, 1) : resizeTime;\n            if (isWithoutScale && (resizeEnd.getTime() - eventStart.getTime()) <= 0) {\n                resizeEnd = addDays(resetTime(eventStart), 1);\n            }\n            this.actionObj.end = this.parent.activeViewOptions.timeScale.enable && this.parent.currentView !== 'Month' ?\n                this.calculateIntervalTime(resizeEnd) : resizeEnd;\n        }\n    }\n    getTopBottomStyles(e, isTop) {\n        const viewElement = this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS);\n        const slotInterval = (this.actionObj.cellHeight / this.actionObj.slotInterval) * this.actionObj.interval;\n        let clnHeight = isTop ? this.actionObj.element.offsetHeight + (this.actionObj.Y - this.actionObj.pageY) :\n            this.actionObj.element.offsetHeight + (this.actionObj.pageY - this.actionObj.Y);\n        let clnTop = isTop ? this.actionObj.element.offsetTop -\n            (this.actionObj.Y - this.actionObj.pageY) : this.actionObj.clone.offsetTop;\n        clnHeight = (clnTop < 0) ? this.actionObj.clone.offsetHeight :\n            (this.actionObj.clone.offsetTop + this.actionObj.clone.offsetHeight) > this.scrollArgs.height ?\n                this.actionObj.clone.offsetHeight : clnHeight;\n        clnTop = (clnTop < 0) ? 0 : clnTop;\n        clnTop = isTop ? Math.floor(clnTop / slotInterval) * slotInterval : clnTop;\n        clnHeight = clnTop + clnHeight >= viewElement.scrollHeight ? viewElement.scrollHeight - clnTop :\n            Math.ceil(clnHeight / slotInterval) * slotInterval;\n        const styles = {\n            height: formatUnit(clnHeight < this.actionObj.cellHeight ? Math.floor(clnHeight / slotInterval) * slotInterval : clnHeight),\n            top: formatUnit((clnHeight < this.actionObj.cellHeight && isTop) ? Math.ceil(clnTop / slotInterval) * slotInterval : clnTop),\n            left: '0px', right: '0px', width: '100%'\n        };\n        return styles;\n    }\n    getLeftRightStyles(e, isLeft) {\n        const styles = {};\n        const isTimelineView = this.parent.activeView.isTimelineView();\n        const isTimeViews = ['TimelineDay', 'TimelineWeek', 'TimelineWorkWeek'].indexOf(this.parent.currentView) > -1 &&\n            this.parent.activeViewOptions.timeScale.enable;\n        const slotInterval = (this.actionObj.cellWidth / this.actionObj.slotInterval) * this.actionObj.interval;\n        const pageWidth = isLeft ? (this.actionObj.X - this.actionObj.pageX) : (this.actionObj.pageX - this.actionObj.X);\n        const targetWidth = isTimelineView ?\n            (this.actionObj.element.getBoundingClientRect().width / this.actionObj.cellWidth) * this.actionObj.cellWidth :\n            this.parent.currentView === 'Month' ? this.actionObj.element.getBoundingClientRect().width :\n                Math.ceil(this.actionObj.element.getBoundingClientRect().width / this.actionObj.cellWidth) * this.actionObj.cellWidth;\n        let offsetWidth = targetWidth + (Math.ceil(pageWidth / this.actionObj.cellWidth) * this.actionObj.cellWidth);\n        const left = (this.parent.enableRtl) ? parseInt(this.actionObj.element.style.right, 10) : this.actionObj.clone.offsetLeft;\n        if (isTimeViews) {\n            offsetWidth = targetWidth + (Math.ceil(pageWidth / slotInterval) * slotInterval);\n            offsetWidth = (Math.round((left + offsetWidth) / slotInterval) * slotInterval) - left;\n            this.actionObj.event[this.parent.eventFields.isAllDay] = false;\n        }\n        let width = !isLeft && ((offsetWidth + this.actionObj.clone.offsetLeft > this.scrollArgs.width)) ?\n            this.actionObj.clone.getBoundingClientRect().width : (offsetWidth < this.actionObj.cellWidth) ? offsetWidth : offsetWidth;\n        if (this.parent.enableRtl) {\n            let rightValue = isTimelineView ? parseInt(this.actionObj.element.style.right, 10) :\n                -(offsetWidth - this.actionObj.cellWidth);\n            rightValue = isTimelineView ? rightValue : isLeft ? 0 : rightValue > 0 ? 0 : rightValue;\n            if (isTimelineView && !isLeft) {\n                rightValue = Math.ceil((this.actionObj.element.offsetLeft + (this.actionObj.element.getBoundingClientRect().width +\n                    (this.actionObj.pageX - this.actionObj.X))) / slotInterval) * slotInterval;\n                rightValue = rightValue < 0 ? Math.abs(rightValue) : -rightValue;\n            }\n            rightValue = rightValue >= this.scrollArgs.width ? this.scrollArgs.width - this.actionObj.cellWidth : rightValue;\n            styles.right = formatUnit(rightValue);\n            width = width + rightValue > this.scrollArgs.width ? this.actionObj.clone.getBoundingClientRect().width : width;\n        }\n        else {\n            let offsetLeft = isLeft ? this.actionObj.element.offsetLeft - (this.actionObj.X - this.actionObj.pageX) :\n                this.parent.enableRtl ? this.actionObj.element.offsetLeft : 0;\n            if (isTimelineView) {\n                offsetLeft = isLeft ? offsetLeft : parseInt(this.actionObj.clone.style.left, 10);\n                if (this.parent.enableRtl) {\n                    offsetLeft = !isLeft ? (this.actionObj.pageX < this.actionObj.X - this.actionObj.clone.getBoundingClientRect().width)\n                        ? parseInt(this.actionObj.clone.style.right, 10) : offsetLeft : offsetLeft;\n                }\n                else {\n                    offsetLeft = isLeft ? (this.actionObj.pageX > this.actionObj.X + this.actionObj.clone.getBoundingClientRect().width &&\n                        this.actionObj.clone.getBoundingClientRect().width === this.actionObj.cellWidth) ?\n                        parseInt(this.actionObj.clone.style.left, 10) : offsetLeft : offsetLeft;\n                }\n            }\n            const leftValue = offsetLeft;\n            offsetLeft = isTimelineView ? isTimeViews ? isLeft ? Math.floor(offsetLeft / slotInterval) * slotInterval : offsetLeft :\n                Math.floor(offsetLeft / this.actionObj.cellWidth) * this.actionObj.cellWidth :\n                Math.ceil(Math.abs(offsetLeft) / this.actionObj.cellWidth) * this.actionObj.cellWidth;\n            if (offsetLeft < 0) {\n                offsetLeft = 0;\n                width = this.actionObj.clone.getBoundingClientRect().width;\n            }\n            const cloneWidth = Math.ceil(this.actionObj.clone.getBoundingClientRect().width / this.actionObj.cellWidth) *\n                this.actionObj.cellWidth;\n            if (isLeft) {\n                styles.left = formatUnit(isTimelineView ? offsetLeft : isLeft ? leftValue < 0 ? -offsetLeft :\n                    (Math.ceil((targetWidth - cloneWidth) / this.actionObj.cellWidth) * this.actionObj.cellWidth) : offsetLeft);\n            }\n        }\n        styles.width = formatUnit(width);\n        return styles;\n    }\n    resizeValidation(e) {\n        const pages = this.getPageCoordinates(e);\n        const viewDimension = this.getContentAreaDimension();\n        const isTimeScale = this.parent.activeView.isTimelineView() && this.parent.activeViewOptions.timeScale.enable;\n        let cellWidth = this.actionObj.cellWidth;\n        let resizeValidation = false;\n        if (this.resizeEdges.left) {\n            if (pages.pageX < viewDimension.leftOffset && pages.pageX >= viewDimension.left && isTimeScale) {\n                cellWidth = 0;\n            }\n            resizeValidation = (pages.pageX - cellWidth) >= viewDimension.left;\n        }\n        if (this.resizeEdges.right) {\n            if (pages.pageX > viewDimension.rightOffset && pages.pageX <= viewDimension.right && isTimeScale) {\n                cellWidth = 0;\n            }\n            resizeValidation = (pages.pageX + cellWidth) <= viewDimension.right;\n        }\n        if (this.resizeEdges.top) {\n            resizeValidation = this.actionObj.clone.offsetTop >= viewDimension.top;\n        }\n        if (this.resizeEdges.bottom) {\n            resizeValidation = (this.actionObj.clone.offsetTop + this.actionObj.clone.offsetHeight) <= this.scrollArgs.height;\n        }\n        return resizeValidation;\n    }\n    /**\n     * Get module name\n     *\n     * @returns {string} Returns the module name..\n     */\n    getModuleName() {\n        return 'resize';\n    }\n}\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\nconst EVENT_GAP$2 = 2;\n/**\n * Year view events render\n */\nclass YearEvent extends TimelineEvent {\n    constructor(parent) {\n        super(parent, 'day');\n        this.isResource = false;\n    }\n    renderAppointments() {\n        if (this.parent.dragAndDropModule) {\n            this.parent.dragAndDropModule.setDragArea();\n        }\n        this.fields = this.parent.eventFields;\n        const elementSelector = (this.parent.currentView === 'Year') ? '.' + APPOINTMENT_CLASS :\n            '.' + APPOINTMENT_WRAPPER_CLASS + ',.' + MORE_INDICATOR_CLASS;\n        const eventWrappers = [].slice.call(this.parent.element.querySelectorAll(elementSelector));\n        for (const wrapper of eventWrappers) {\n            remove(wrapper);\n        }\n        this.renderedEvents = [];\n        if (this.parent.currentView === 'Year') {\n            this.yearViewEvents();\n        }\n        else {\n            this.removeCellHeight();\n            if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n                this.isResource = true;\n                this.timelineResourceEvents();\n            }\n            else {\n                this.timelineYearViewEvents();\n            }\n        }\n        this.parent.renderTemplates();\n        this.parent.notify(contentReady, {});\n    }\n    yearViewEvents() {\n        const months = this.getMonths();\n        for (const month of months) {\n            const queryString = `.e-month-calendar:nth-child(${months.indexOf(month) + 1}) td.e-work-cells`;\n            const workCells = [].slice.call(this.parent.element.querySelectorAll(queryString));\n            const monthDate = new Date(this.parent.selectedDate.getFullYear(), month, 1);\n            const monthStart = this.parent.calendarUtil.getMonthStartDate(new Date(monthDate.getTime()));\n            const monthEnd = this.parent.calendarUtil.getMonthEndDate(new Date(monthDate.getTime()));\n            let startDate = getWeekFirstDate(monthStart, this.parent.firstDayOfWeek);\n            const endDate = addDays(getWeekLastDate(monthEnd, this.parent.firstDayOfWeek), 1);\n            for (let index = 0; startDate.getTime() < endDate.getTime(); index++) {\n                const start = resetTime(new Date(startDate.getTime()));\n                const end = addDays(new Date(start.getTime()), 1);\n                const filterEvents = this.parent.eventBase.filterEvents(start, end);\n                if (filterEvents.length > 0) {\n                    const workCell = workCells[index];\n                    if (workCell) {\n                        workCell.appendChild(createElement('div', { className: APPOINTMENT_CLASS }));\n                    }\n                }\n                startDate = addDays(new Date(startDate.getTime()), 1);\n            }\n        }\n    }\n    timelineYearViewEvents() {\n        const workCell = this.parent.element.querySelector('.' + WORK_CELLS_CLASS + ':not(.' + OTHERMONTH_CLASS + ')');\n        this.cellWidth = workCell.offsetWidth;\n        this.cellHeader = getOuterHeight(workCell.querySelector('.' + DATE_HEADER_CLASS));\n        const eventTable = this.parent.element.querySelector('.' + EVENT_TABLE_CLASS);\n        this.eventHeight = getElementHeightFromClass(eventTable, APPOINTMENT_CLASS);\n        const wrapperCollection = [].slice.call(this.parent.element.querySelectorAll('.' + APPOINTMENT_CONTAINER_CLASS));\n        const months = this.getMonths();\n        for (let row = 0; row < months.length; row++) {\n            const wrapper = wrapperCollection[row];\n            let td = row + 1;\n            const eventWrapper = createElement('div', { className: APPOINTMENT_WRAPPER_CLASS });\n            wrapper.appendChild(eventWrapper);\n            let monthStart = new Date(this.parent.selectedDate.getFullYear(), months[row], 1);\n            const monthEnd = new Date(monthStart.getFullYear(), monthStart.getMonth() + 1, 0);\n            let dayIndex = monthStart.getDay();\n            const isSpannedCollection = [];\n            if (this.parent.activeViewOptions.orientation === 'Horizontal') {\n                this.renderedEvents = [];\n            }\n            while (monthStart.getTime() <= monthEnd.getTime()) {\n                let leftValue;\n                let rightValue;\n                if (this.parent.activeViewOptions.orientation === 'Vertical') {\n                    const wrapper = wrapperCollection[dayIndex];\n                    td = dayIndex + 1;\n                    let eventWrapper = wrapper.querySelector('.' + APPOINTMENT_WRAPPER_CLASS);\n                    if (!eventWrapper) {\n                        eventWrapper = createElement('div', { className: APPOINTMENT_WRAPPER_CLASS });\n                        wrapper.appendChild(eventWrapper);\n                    }\n                    if (this.parent.enableRtl) {\n                        rightValue = row * this.cellWidth;\n                    }\n                    else {\n                        leftValue = row * this.cellWidth;\n                    }\n                }\n                else {\n                    if (this.parent.enableRtl) {\n                        rightValue = ((dayIndex + monthStart.getDate()) - 1) * this.cellWidth;\n                    }\n                    else {\n                        leftValue = ((dayIndex + monthStart.getDate()) - 1) * this.cellWidth;\n                    }\n                }\n                const rowTd = this.parent.element.querySelector(`.e-content-wrap tr:nth-child(${td}) td`);\n                this.cellHeight = rowTd.offsetHeight;\n                const dayStart = resetTime(new Date(monthStart.getTime()));\n                const dayEnd = addDays(new Date(dayStart.getTime()), 1);\n                let resource;\n                if (this.parent.uiStateValues.isGroupAdaptive) {\n                    resource = this.parent.resourceBase.lastResourceLevel[this.parent.uiStateValues.groupIndex];\n                }\n                let dayEvents = this.parent.eventBase.filterEvents(dayStart, dayEnd, undefined, resource);\n                dayEvents = this.parent.eventBase.sortByDateTime(dayEvents);\n                for (let index = 0, count = dayEvents.length; index < count; index++) {\n                    const eventData = extend({}, dayEvents[index], null, true);\n                    this.updateSpannedEvents(eventData, dayStart, dayEnd);\n                    const overlapIndex = this.getIndex(dayStart);\n                    eventData.Index = overlapIndex;\n                    const availedHeight = this.cellHeader + (this.eventHeight * (overlapIndex + 1)) + EVENT_GAP$2 +\n                        this.moreIndicatorHeight;\n                    const appArea = this.cellHeight - this.cellHeader - this.moreIndicatorHeight;\n                    const renderedAppCount = Math.floor(appArea / (this.eventHeight + EVENT_GAP$2));\n                    const moreIndicatorCount = (count - renderedAppCount) <= 0 ? 1 : (count - renderedAppCount);\n                    if (this.parent.activeViewOptions.orientation === 'Horizontal') {\n                        const isRendered = this.renderedEvents.filter((eventObj) => eventObj.Guid === eventData.Guid);\n                        const isSpanned = isSpannedCollection.filter((eventObj) => eventObj.Guid === eventData.Guid);\n                        if (isRendered.length > 0 && isRendered[0].MoreIndicator || isSpanned.length > 0 && isSpanned[0].MoreIndicator) {\n                            const moreIndex = this.parent.activeViewOptions.orientation === 'Horizontal' ? row : dayIndex;\n                            this.renderMoreIndicator(eventWrapper, moreIndicatorCount, dayStart, moreIndex, leftValue, rightValue);\n                            continue;\n                        }\n                        else if (isRendered.length > 0 || isSpanned.length > 0) {\n                            continue;\n                        }\n                    }\n                    const isRowAutoHeight = this.parent.rowAutoHeight && this.parent.activeViewOptions.orientation === 'Horizontal';\n                    if (isRowAutoHeight || this.cellHeight > availedHeight) {\n                        this.renderEvent(eventWrapper, eventData, row, leftValue, rightValue, monthStart, dayIndex);\n                        this.updateCellHeight(rowTd, availedHeight);\n                        isSpannedCollection.push(eventData);\n                    }\n                    else {\n                        const moreIndex = this.parent.activeViewOptions.orientation === 'Horizontal' ? row : dayIndex;\n                        this.renderMoreIndicator(eventWrapper, moreIndicatorCount, dayStart, moreIndex, leftValue, rightValue);\n                        if (this.parent.activeViewOptions.orientation === 'Horizontal') {\n                            eventData.MoreIndicator = true;\n                            this.renderedEvents.push(eventData);\n                            isSpannedCollection.push(eventData);\n                        }\n                    }\n                }\n                monthStart = addDays(new Date(monthStart.getTime()), 1);\n                if (this.parent.activeViewOptions.orientation === 'Vertical') {\n                    dayIndex++;\n                    this.renderedEvents = [];\n                }\n            }\n        }\n    }\n    updateSpannedEvents(eventObj, dayStart, dayEnd) {\n        const isLeftRightResize = (this.isResource && this.parent.activeViewOptions.orientation === 'Vertical') ||\n            (!this.isResource && this.parent.activeViewOptions.orientation === 'Horizontal');\n        const data = { isLeft: true, isRight: true, isBottom: true, isTop: true };\n        if (dayStart.getTime() <= eventObj[this.fields.startTime].getTime()) {\n            if (isLeftRightResize) {\n                data.isLeft = false;\n            }\n            else {\n                data.isTop = false;\n            }\n        }\n        if ((dayEnd.getTime() >= eventObj[this.fields.endTime].getTime()) || (isLeftRightResize && !this.isResource &&\n            addDays(dayEnd, -1).getMonth() === eventObj[this.fields.endTime].getMonth())) {\n            if (isLeftRightResize) {\n                data.isRight = false;\n            }\n            else {\n                data.isBottom = false;\n            }\n        }\n        eventObj.data = data;\n    }\n    timelineResourceEvents() {\n        const workCell = this.parent.element.querySelector('.' + WORK_CELLS_CLASS);\n        this.cellWidth = workCell.offsetWidth;\n        this.cellHeader = 0;\n        const eventTable = this.parent.element.querySelector('.' + EVENT_TABLE_CLASS);\n        this.eventHeight = getElementHeightFromClass(eventTable, APPOINTMENT_CLASS);\n        const wrapperCollection = [].slice.call(this.parent.element.querySelectorAll('.' + APPOINTMENT_CONTAINER_CLASS));\n        const resources = this.parent.uiStateValues.isGroupAdaptive ?\n            [this.parent.resourceBase.lastResourceLevel[this.parent.uiStateValues.groupIndex]] :\n            this.parent.activeViewOptions.allowVirtualScrolling ? this.parent.resourceBase.renderedResources :\n                this.parent.resourceBase.lastResourceLevel;\n        const months = this.getMonths();\n        if (this.parent.activeViewOptions.orientation === 'Horizontal') {\n            for (let month = 0; month < months.length; month++) {\n                const monthStart = new Date(this.parent.selectedDate.getFullYear(), months[month], 1);\n                for (let i = 0, len = resources.length; i < len; i++) {\n                    this.renderedEvents = [];\n                    this.renderResourceEvent(wrapperCollection[month], resources[i], month, i, monthStart);\n                }\n            }\n        }\n        else {\n            for (let i = 0, len = resources.length; i < len; i++) {\n                this.renderedEvents = [];\n                for (let month = 0; month < months.length; month++) {\n                    const monthStart = new Date(this.parent.selectedDate.getFullYear(), months[month], 1);\n                    this.renderResourceEvent(wrapperCollection[i], resources[i], month, i, monthStart);\n                }\n            }\n        }\n    }\n    renderResourceEvent(wrapper, resource, month, index, monthStart) {\n        const eventWrapper = createElement('div', { className: APPOINTMENT_WRAPPER_CLASS });\n        wrapper.appendChild(eventWrapper);\n        const monthEnd = addDays(lastDateOfMonth(new Date(monthStart.getTime())), 1);\n        const eventDatas = this.parent.eventBase.filterEvents(monthStart, monthEnd, undefined, resource);\n        const rowIndex = this.parent.activeViewOptions.orientation === 'Vertical' ? index : month;\n        const td = this.parent.element.querySelector(`.e-content-wrap tr:nth-child(${rowIndex + 1}) td`);\n        this.cellHeight = td.offsetHeight;\n        this.groupOrder = resource.groupOrder;\n        for (let a = 0; a < eventDatas.length; a++) {\n            const data = eventDatas[a];\n            let overlapIndex;\n            const eventData = extend({}, data, null, true);\n            if (this.parent.activeViewOptions.group.resources.length > 0) {\n                const eventObj = this.isSpannedEvent(eventData, monthStart);\n                overlapIndex = this.getIndex(eventObj[this.fields.startTime]);\n                eventData.Index = overlapIndex;\n            }\n            else {\n                overlapIndex = this.getIndex(eventData[this.fields.startTime]);\n                eventData.Index = overlapIndex;\n            }\n            const availedHeight = this.cellHeader + (this.eventHeight * (a + 1)) + EVENT_GAP$2 + this.moreIndicatorHeight;\n            const leftValue = (this.parent.activeViewOptions.orientation === 'Vertical') ?\n                month * this.cellWidth : index * this.cellWidth;\n            if (this.parent.rowAutoHeight || this.cellHeight > availedHeight) {\n                this.renderEvent(eventWrapper, eventData, month, leftValue, leftValue, monthStart, index);\n                this.updateCellHeight(td, availedHeight);\n            }\n            else {\n                const moreIndex = this.parent.activeViewOptions.orientation === 'Horizontal' ? month : index;\n                this.renderMoreIndicator(eventWrapper, eventDatas.length - a, monthStart, moreIndex, leftValue, leftValue, index);\n                if (this.parent.activeViewOptions.orientation === 'Horizontal') {\n                    for (let i = index; i < eventDatas.length; i++) {\n                        this.renderedEvents.push(extend({}, eventDatas[i], { Index: overlapIndex + i }, true));\n                    }\n                }\n                break;\n            }\n        }\n    }\n    // eslint-disable-next-line max-len\n    renderEvent(wrapper, eventData, row, left, right, monthDate, rowIndex) {\n        const eventObj = this.isSpannedEvent(eventData, monthDate);\n        const wrap = this.createEventElement(eventObj);\n        let width;\n        let index;\n        if (eventObj.isSpanned.count === 1) {\n            const endTime = addDays(eventObj[this.fields.endTime], -1);\n            eventObj[this.fields.endTime] = (endTime > eventObj[this.fields.startTime]) ? endTime : eventObj[this.fields.endTime];\n        }\n        if (eventObj[this.fields.startTime] > eventObj[this.fields.endTime]) {\n            return;\n        }\n        if (this.parent.activeViewOptions.orientation === 'Horizontal') {\n            index = row + 1;\n            if (eventObj[this.fields.startTime].getTime() === eventObj[this.fields.endTime].getTime()) {\n                eventObj.isSpanned.count = 1;\n            }\n            width = eventObj.isSpanned.count * this.cellWidth;\n        }\n        else {\n            index = rowIndex + 1;\n            width = this.cellWidth;\n        }\n        const rowTd = this.parent.element.querySelector(`.e-content-wrap tr:nth-child(${index}) td`);\n        const top = rowTd.offsetTop + this.cellHeader + (this.eventHeight * eventObj.Index) + EVENT_GAP$2;\n        setStyleAttribute(wrap, {\n            'width': width + 'px', 'height': this.eventHeight + 'px', 'left': left + 'px', 'right': right + 'px', 'top': top + 'px'\n        });\n        const args = { data: eventObj, element: wrap, cancel: false, type: 'event' };\n        this.parent.trigger(eventRendered, args, (eventArgs) => {\n            if (!eventArgs.cancel) {\n                wrapper.appendChild(wrap);\n                this.wireAppointmentEvents(wrap, eventObj);\n                if (this.parent.activeViewOptions.group.resources.length > 0) {\n                    this.renderedEvents.push(extend({}, eventObj, null, true));\n                }\n                else if (this.parent.activeViewOptions.orientation === 'Vertical') {\n                    this.renderedEvents.push(extend({}, eventObj, null, true));\n                }\n                else if ((eventObj.isSpanned.isRight || eventObj.isSpanned.isLeft) && this.parent.activeViewOptions.orientation === 'Horizontal'\n                    || !eventObj.isSpanned.isRight) {\n                    this.renderedEvents.push(extend({}, eventObj, null, true));\n                }\n            }\n        });\n    }\n    // eslint-disable-next-line max-len\n    renderMoreIndicator(wrapper, count, startDate, row, left, right, index) {\n        if (this.parent.activeViewOptions.group.resources.length === 0 && wrapper.querySelector('[data-start-date=\"' + startDate.getTime() + '\"]')) {\n            return;\n        }\n        let endDate;\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            endDate = addDays(lastDateOfMonth(new Date(startDate.getTime())), 1);\n        }\n        else {\n            endDate = addDays(new Date(startDate.getTime()), 1);\n        }\n        const moreIndicator = this.getMoreIndicatorElement(count, startDate, endDate);\n        const rowTr = this.parent.element.querySelector(`.e-content-wrap tr:nth-child(${row + 1})`);\n        const top = rowTr.offsetTop + (this.cellHeight - this.moreIndicatorHeight);\n        left = (Math.floor(left / this.cellWidth) * this.cellWidth);\n        right = (Math.floor(right / this.cellWidth) * this.cellWidth);\n        setStyleAttribute(moreIndicator, { 'width': this.cellWidth + 'px', 'left': left + 'px', 'right': right + 'px', 'top': top + 'px' });\n        if (!isNullOrUndefined(index)) {\n            moreIndicator.setAttribute('data-group-index', index.toString());\n        }\n        wrapper.appendChild(moreIndicator);\n        EventHandler.add(moreIndicator, 'click', this.moreIndicatorClick, this);\n    }\n    createEventElement(record) {\n        const eventSubject = (record[this.fields.subject] || this.parent.eventSettings.fields.subject.default\n            || this.parent.localeObj.getConstant('addTitle'));\n        const eventWrapper = createElement('div', {\n            className: APPOINTMENT_CLASS,\n            attrs: {\n                'data-id': 'Appointment_' + record[this.fields.id],\n                'data-guid': record.Guid,\n                'role': 'button', 'tabindex': '0',\n                'aria-disabled': this.parent.eventBase.getReadonlyAttribute(record), 'aria-pressed': 'false', 'aria-grabbed': 'true',\n                'aria-label': this.parent.getAnnouncementString(record)\n            }\n        });\n        if (this.cssClass) {\n            addClass([eventWrapper], this.cssClass);\n        }\n        if (record[this.fields.isReadonly]) {\n            addClass([eventWrapper], READ_ONLY);\n        }\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            const resIndex = this.getGroupIndexFromEvent(record);\n            eventWrapper.setAttribute('data-group-index', resIndex.toString());\n        }\n        let templateElement = [];\n        const eventObj = extend({}, record, null, true);\n        if (this.parent.activeViewOptions.eventTemplate) {\n            const templateId = this.parent.element.id + '_' + this.parent.activeViewOptions.eventTemplateName + 'eventTemplate';\n            templateElement = this.parent.getAppointmentTemplate()(eventObj, this.parent, 'eventTemplate', templateId, false);\n        }\n        else {\n            const locationEle = (record[this.fields.location] || this.parent.eventSettings.fields.location.default || '');\n            const subjectEle = createElement('div', {\n                className: SUBJECT_CLASS,\n                innerHTML: (eventSubject + (locationEle ? ';&nbsp' + locationEle : ''))\n            });\n            const startTimeEle = createElement('div', {\n                className: APPOINTMENT_TIME + (this.parent.isAdaptive ? ' ' + DISABLE_CLASS : ''),\n                innerHTML: this.parent.getTimeString(eventObj[this.fields.startTime])\n            });\n            const endTimeEle = createElement('div', {\n                className: APPOINTMENT_TIME + (this.parent.isAdaptive ? ' ' + DISABLE_CLASS : ''),\n                innerHTML: this.parent.getTimeString(eventObj[this.fields.endTime])\n            });\n            addClass([subjectEle], 'e-text-center');\n            if (record[this.fields.isAllDay]) {\n                templateElement = [subjectEle];\n            }\n            else if (!eventObj.isLeft && !eventObj.isRight) {\n                templateElement = [startTimeEle, subjectEle, endTimeEle];\n            }\n            else {\n                if (!eventObj.isLeft) {\n                    templateElement.push(startTimeEle);\n                }\n                templateElement.push(subjectEle);\n                if (!eventObj.isRight) {\n                    templateElement.push(endTimeEle);\n                }\n            }\n        }\n        const appointmentDetails = createElement('div', { className: APPOINTMENT_DETAILS });\n        append(templateElement, appointmentDetails);\n        eventWrapper.appendChild(appointmentDetails);\n        this.renderResizeHandler(eventWrapper, record.data, record[this.fields.isReadonly]);\n        this.applyResourceColor(eventWrapper, eventObj, 'backgroundColor', this.groupOrder);\n        return eventWrapper;\n    }\n    isSpannedEvent(eventObj, monthDate) {\n        const monthStart = new Date(monthDate.getFullYear(), monthDate.getMonth(), 1);\n        const monthEnd = addDays(new Date(monthDate.getFullYear(), monthDate.getMonth() + 1, 0), 1);\n        const eventData = extend({}, eventObj, null, true);\n        const eventStart = eventData[this.fields.startTime];\n        const eventEnd = eventData[this.fields.endTime];\n        const isSpanned = { isLeft: false, isRight: false, count: 1 };\n        if (this.isResource) {\n            this.updateSpannedEvents(eventObj, monthStart, monthEnd);\n        }\n        if (eventStart.getTime() < monthStart.getTime()) {\n            eventData[this.fields.startTime] = monthStart;\n            isSpanned.isLeft = true;\n        }\n        if (eventEnd.getTime() > monthEnd.getTime()) {\n            eventData[this.fields.endTime] = monthEnd;\n            isSpanned.isRight = true;\n        }\n        if (this.parent.activeViewOptions.group.resources.length === 0) {\n            let end = resetTime(eventData[this.fields.endTime]).getTime();\n            const start = resetTime(eventData[this.fields.startTime]).getTime();\n            if (eventObj[this.fields.isAllDay] && end === eventObj[this.fields.endTime].getTime() || isSpanned.isRight) {\n                end = addDays(new Date(end), -1).getTime();\n            }\n            isSpanned.count = Math.ceil((end - start) / MS_PER_DAY) + 1;\n        }\n        eventData.isSpanned = isSpanned;\n        if (resetTime(eventStart).getTime() < resetTime(this.parent.minDate).getTime()) {\n            eventData[this.fields.startTime] = this.parent.minDate;\n        }\n        if (resetTime(eventEnd).getTime() > resetTime(this.parent.maxDate).getTime()) {\n            eventData[this.fields.endTime] = this.parent.maxDate;\n        }\n        return eventData;\n    }\n    getOverlapEvents(date, appointments) {\n        const appointmentsList = [];\n        let dateStart;\n        let dateEnd;\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            const monthStart = this.parent.calendarUtil.getMonthStartDate(new Date(date.getTime()));\n            const monthEnd = addDays(this.parent.calendarUtil.getMonthEndDate(new Date(date.getTime())), -1);\n            dateStart = resetTime(new Date(monthStart.getTime())).getTime();\n            dateEnd = resetTime(new Date(monthEnd.getTime())).getTime();\n        }\n        else {\n            if (this.parent.rowAutoHeight) {\n                dateStart = resetTime(new Date(date.getTime())).getTime();\n                dateEnd = addDays(resetTime(new Date(date.getTime())), 1).getTime();\n            }\n            else {\n                dateStart = dateEnd = resetTime(new Date(date.getTime())).getTime();\n            }\n        }\n        for (const app of appointments) {\n            const appStart = new Date(app[this.fields.startTime].getTime());\n            const appEnd = new Date(app[this.fields.endTime].getTime());\n            if (this.parent.activeViewOptions.orientation === 'Vertical' &&\n                this.parent.activeViewOptions.group.resources.length > 0) {\n                if ((resetTime(appStart).getTime() >= dateStart) && (resetTime(appEnd).getTime() <= dateEnd)) {\n                    appointmentsList.push(app);\n                }\n            }\n            else {\n                const timeCondition = app[this.fields.isAllDay] ? resetTime(appEnd).getTime() > dateStart :\n                    resetTime(appEnd).getTime() >= dateStart;\n                if (((resetTime(appStart).getTime() <= dateStart) && (timeCondition)) ||\n                    (resetTime(appStart).getTime() >= dateStart) && (resetTime(appEnd).getTime() <= dateEnd)) {\n                    appointmentsList.push(app);\n                }\n            }\n        }\n        return appointmentsList;\n    }\n    getMonths() {\n        // eslint-disable-next-line prefer-spread\n        return Array.apply(null, { length: this.parent.monthsCount }).map((value, index) => this.parent.firstMonthOfYear + index);\n    }\n    removeCellHeight() {\n        const elementSelector = `.${MONTH_HEADER_WRAPPER} tbody tr,.${RESOURCE_COLUMN_TABLE_CLASS} tbody tr,.${CONTENT_TABLE_CLASS} tbody tr`;\n        const rows = [].slice.call(this.element.querySelectorAll(elementSelector));\n        for (const row of rows) {\n            row.firstElementChild.style.height = '';\n        }\n    }\n    destroy() {\n        super.destroy();\n        this.parent = null;\n    }\n}\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\nconst MINUTES_PER_DAY = 1440;\n/**\n * Schedule events drag actions\n */\nclass DragAndDrop extends ActionBase {\n    constructor() {\n        super(...arguments);\n        this.widthUptoCursorPoint = 0;\n        this.heightUptoCursorPoint = 0;\n        this.cursorPointIndex = 0;\n        this.isHeaderRows = false;\n        this.isTimelineDayProcess = false;\n        this.widthPerMinute = 0;\n        this.heightPerMinute = 0;\n        this.minDiff = 0;\n        this.isStepDragging = false;\n        this.isMorePopupOpened = false;\n        this.isAllDayDrag = false;\n        this.isMultiSelect = false;\n        this.multiData = [];\n        this.updatedData = [];\n        this.swagData = [];\n        this.startTime = 0;\n        this.isAllDayTarget = false;\n        this.targetTd = null;\n        this.isCursorAhead = false;\n    }\n    wireDragEvent(element) {\n        new Draggable(element, {\n            abort: '.' + EVENT_RESIZE_CLASS,\n            clone: true,\n            isDragScroll: true,\n            enableTapHold: this.parent.isAdaptive,\n            enableTailMode: (this.parent.eventDragArea) ? true : false,\n            cursorAt: (this.parent.eventDragArea) ? { left: -20, top: -20 } : { left: 0, top: 0 },\n            dragArea: this.dragArea,\n            dragStart: this.dragStart.bind(this),\n            drag: this.drag.bind(this),\n            dragStop: this.dragStop.bind(this),\n            enableAutoScroll: false,\n            helper: this.dragHelper.bind(this),\n            queryPositionInfo: this.dragPosition.bind(this)\n        });\n    }\n    setDragArea() {\n        const dragElement = document.querySelector(this.parent.eventDragArea);\n        this.dragArea = this.parent.eventDragArea && dragElement ? dragElement :\n            this.parent.element.querySelector('.' + CONTENT_TABLE_CLASS);\n    }\n    dragHelper(e) {\n        this.setDragActionDefaultValues();\n        this.actionObj.element = e.element;\n        this.actionObj.action = 'drag';\n        let elements = [];\n        if (!this.parent.allowMultiDrag || isNullOrUndefined(this.parent.selectedElements) || this.parent.selectedElements.length === 0 ||\n            (this.parent.selectedElements.length > 0 && this.parent.selectedElements.indexOf(this.actionObj.element) === -1)) {\n            elements = [e.element];\n        }\n        else {\n            elements = this.parent.selectedElements;\n            this.isMultiSelect = true;\n        }\n        elements.forEach((ele) => {\n            const cloneElement = this.createCloneElement(ele);\n            if (ele.getAttribute('data-guid') === this.actionObj.element.getAttribute('data-guid')) {\n                this.actionObj.clone = cloneElement;\n                if (!this.parent.eventDragArea && this.parent.currentView !== 'Month' &&\n                    this.parent.activeViewOptions.timeScale.enable && !this.parent.activeView.isTimelineView() &&\n                    !this.actionObj.element.classList.contains(ALLDAY_APPOINTMENT_CLASS)) {\n                    setStyleAttribute(this.actionObj.clone, { cursor: 'move', left: '0%', right: '0%', width: '100%' });\n                }\n                this.actionObj.clone.style.top = formatUnit(this.actionObj.element.offsetTop);\n            }\n            this.actionObj.cloneElement.push(cloneElement);\n            this.actionObj.originalElement.push(ele);\n        });\n        return this.actionObj.clone;\n    }\n    dragPosition(e) {\n        if (this.parent.eventDragArea) {\n            return { left: e.left, top: e.top };\n        }\n        const cellHeight = (this.actionObj.cellHeight / this.actionObj.slotInterval) * this.actionObj.interval;\n        let leftValue = formatUnit(0);\n        if (this.parent.currentView === 'Month') {\n            leftValue = e.left;\n        }\n        let cloneRight;\n        if (this.isStepDragging) {\n            cloneRight = Math.ceil(this.actionObj.clone.getBoundingClientRect().right) + this.actionObj.interval;\n        }\n        else {\n            cloneRight = this.actionObj.clone.getBoundingClientRect().right;\n        }\n        const dragArea = this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS);\n        const contentWrapRight = dragArea.getBoundingClientRect().right;\n        if (this.parent.activeView.isTimelineView() && this.parent.currentView !== 'TimelineYear' && !this.parent.enableRtl &&\n            this.actionObj.pageX > cloneRight && !this.isMorePopupOpened && !(this.actionObj.pageX > contentWrapRight)) {\n            this.isCursorAhead = true;\n        }\n        if (this.parent.activeView.isTimelineView()) {\n            leftValue = formatUnit(this.actionObj.clone.offsetLeft);\n        }\n        let topValue;\n        if ((this.parent.activeView.isTimelineView() || !this.parent.timeScale.enable ||\n            (!isNullOrUndefined(this.actionObj.clone.offsetParent) &&\n                this.actionObj.clone.offsetParent.classList.contains(MORE_EVENT_POPUP_CLASS)))) {\n            topValue = formatUnit(this.actionObj.clone.offsetTop);\n        }\n        else if (this.parent.currentView === 'Month') {\n            topValue = formatUnit(0);\n        }\n        else if (this.actionObj.clone.classList.contains(ALLDAY_APPOINTMENT_CLASS)) {\n            topValue = formatUnit(this.parent.element.querySelector('.' + ALLDAY_ROW_CLASS).offsetTop);\n            setStyleAttribute(this.actionObj.clone, {\n                width: formatUnit(Math.ceil(this.actionObj.clone.offsetWidth / this.actionObj.cellWidth) * this.actionObj.cellWidth),\n                right: this.parent.enableRtl && formatUnit(0)\n            });\n        }\n        else {\n            if (this.actionObj.element.classList.contains(ALLDAY_APPOINTMENT_CLASS) &&\n                !this.actionObj.clone.classList.contains(ALLDAY_APPOINTMENT_CLASS)) {\n                setStyleAttribute(this.actionObj.clone, {\n                    height: formatUnit(this.actionObj.cellHeight),\n                    width: formatUnit(this.actionObj.cellWidth - 1),\n                    pointerEvents: 'none'\n                });\n            }\n            let top = parseInt(e.top, 10);\n            top = top < 0 ? 0 : top;\n            topValue = formatUnit(Math.ceil(top / cellHeight) * cellHeight);\n            const scrollHeight = this.parent.element.querySelector('.e-content-wrap').scrollHeight;\n            const cloneBottom = parseInt(topValue, 10) + this.actionObj.clone.offsetHeight;\n            if (cloneBottom > scrollHeight) {\n                topValue = (parseInt(topValue, 10) - (cloneBottom - scrollHeight)) + 'px';\n            }\n        }\n        return { left: leftValue, top: topValue };\n    }\n    setDragActionDefaultValues() {\n        this.actionObj.action = 'drag';\n        this.actionObj.isAllDay = null;\n        this.actionObj.slotInterval = this.parent.activeViewOptions.timeScale.interval / this.parent.activeViewOptions.timeScale.slotCount;\n        this.actionObj.interval = this.actionObj.slotInterval;\n        const workCell = this.parent.element.querySelector('.' + WORK_CELLS_CLASS);\n        this.actionObj.cellWidth = workCell.offsetWidth;\n        this.actionObj.cellHeight = workCell.offsetHeight;\n    }\n    dragStart(e) {\n        const eventGuid = this.actionObj.element.getAttribute('data-guid');\n        this.actionObj.event = this.parent.eventBase.getEventByGuid(eventGuid);\n        const eventObj = extend({}, this.actionObj.event, null, true);\n        if (!isNullOrUndefined(eventObj)) {\n            this.startTime = eventObj[this.parent.eventFields.startTime].getTime();\n        }\n        const dragArgs = {\n            cancel: false,\n            data: eventObj,\n            selectedData: this.getSelectedData(),\n            event: e,\n            excludeSelectors: null,\n            element: this.actionObj.element,\n            interval: this.actionObj.interval,\n            navigation: { enable: false, timeDelay: 2000 },\n            scroll: { enable: true, scrollBy: 30, timeDelay: 100 }\n        };\n        this.parent.trigger(dragStart, dragArgs, (dragEventArgs) => {\n            if (dragEventArgs.cancel || (!isNullOrUndefined(this.actionObj.element) &&\n                isNullOrUndefined(this.actionObj.element.parentElement))) {\n                const dragObj = this.actionObj.element.ej2_instances[0];\n                if (!isNullOrUndefined(dragObj)) {\n                    dragObj.intDestroy(e.event);\n                }\n                this.actionObj.action = '';\n                this.removeCloneElementClasses();\n                this.removeCloneElement();\n                return;\n            }\n            this.actionClass('addClass');\n            this.parent.uiStateValues.action = true;\n            this.actionObj.start = eventObj[this.parent.eventFields.startTime];\n            this.actionObj.end = eventObj[this.parent.eventFields.endTime];\n            this.actionObj.groupIndex = parseInt(this.actionObj.element.getAttribute('data-group-index') || '0', 10);\n            this.actionObj.interval = dragEventArgs.interval;\n            this.actionObj.navigation = dragEventArgs.navigation;\n            this.actionObj.scroll = dragEventArgs.scroll;\n            this.actionObj.excludeSelectors = dragEventArgs.excludeSelectors;\n            const viewElement = this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS);\n            this.scrollArgs = { element: viewElement, width: viewElement.scrollWidth, height: viewElement.scrollHeight };\n            this.widthPerMinute = (this.actionObj.cellWidth / this.actionObj.slotInterval) * this.actionObj.interval;\n            this.heightPerMinute = (this.actionObj.cellHeight / this.actionObj.slotInterval) * this.actionObj.interval;\n            this.widthUptoCursorPoint = 0;\n            this.heightUptoCursorPoint = 0;\n            this.cursorPointIndex = -1;\n            this.isHeaderRows = false;\n            this.isTimelineDayProcess = false;\n            this.minDiff = 0;\n            this.isMorePopupOpened = false;\n            this.daysVariation = -1;\n            this.isAllDayTarget = this.actionObj.clone.classList.contains(ALLDAY_APPOINTMENT_CLASS);\n            if ((this.parent.activeView.isTimelineView() || !this.parent.timeScale.enable) && this.parent.currentView !== 'TimelineYear') {\n                if (!isNullOrUndefined(this.actionObj.clone.offsetParent) &&\n                    this.actionObj.clone.offsetParent.classList.contains(MORE_EVENT_POPUP_CLASS)) {\n                    this.isMorePopupOpened = true;\n                }\n                this.actionObj.pageX = e.event.pageX;\n                const rows = this.parent.activeViewOptions.headerRows;\n                this.isHeaderRows = rows.length > 0 && rows[rows.length - 1].option !== 'Hour' &&\n                    rows[rows.length - 1].option !== 'Date';\n                this.isTimelineDayProcess = !this.parent.activeViewOptions.timeScale.enable || this.isHeaderRows ||\n                    this.parent.currentView === 'TimelineMonth' || (rows.length > 0 && rows[rows.length - 1].option === 'Date');\n                this.isStepDragging = !this.isTimelineDayProcess && (this.actionObj.slotInterval !== this.actionObj.interval);\n                if (this.isTimelineDayProcess) {\n                    this.timelineEventModule = new TimelineEvent(this.parent, 'day');\n                }\n                else {\n                    this.timelineEventModule = new TimelineEvent(this.parent, 'hour');\n                }\n            }\n            if (this.parent.currentView === 'TimelineYear') {\n                this.yearEvent = new YearEvent(this.parent);\n            }\n            if (this.parent.currentView === 'Month') {\n                this.startTime = resetTime(new Date(this.startTime)).getTime();\n                this.updateOriginalElement(this.actionObj.clone);\n                this.monthEvent = new MonthEvent(this.parent);\n            }\n            if (this.parent.currentView === 'Day' || this.parent.currentView === 'Week' || this.parent.currentView === 'WorkWeek') {\n                this.verticalEvent = new VerticalEvent(this.parent);\n                this.verticalEvent.initializeValues();\n                const splitEvents = this.splitEvent(this.actionObj.event);\n                splitEvents.forEach((event) => {\n                    let query = `.e-day-wrapper[data-date=\"${resetTime(event[this.parent.eventFields.startTime]).getTime()}\"]`;\n                    if (this.parent.activeViewOptions.group.resources.length > 0) {\n                        query = query.concat('[data-group-index = \"' + this.actionObj.groupIndex + '\"]');\n                    }\n                    const appWrap = this.parent.element.querySelector(query);\n                    if (appWrap) {\n                        const appEle = appWrap.querySelector('[data-id=\"' + this.actionObj.clone.getAttribute('data-id') + '\"]');\n                        if (appEle) {\n                            addClass([appEle], EVENT_ACTION_CLASS);\n                        }\n                    }\n                });\n            }\n        });\n    }\n    getSelectedData() {\n        if (this.isMultiSelect && this.multiData.length === 0 && this.parent.selectedElements.length > 0) {\n            for (const element of this.parent.selectedElements) {\n                const eventGuid = element.getAttribute('data-guid');\n                const data = this.parent.eventBase.getEventByGuid(eventGuid);\n                this.multiData.push(extend({}, data, null, true));\n            }\n        }\n        return this.multiData;\n    }\n    drag(e) {\n        if (this.parent.quickPopup) {\n            this.parent.quickPopup.quickPopupHide(true);\n        }\n        if ((!isNullOrUndefined(e.target)) && e.target.classList.contains(DISABLE_DATES)) {\n            return;\n        }\n        const eventObj = extend({}, this.actionObj.event, null, true);\n        const eventArgs = this.getPageCoordinates(e);\n        this.actionObj.Y = this.actionObj.pageY = eventArgs.pageY;\n        this.actionObj.X = this.actionObj.pageX = eventArgs.pageX;\n        this.actionObj.target = e.target;\n        this.widthUptoCursorPoint = (this.widthUptoCursorPoint === 0) ?\n            Math.ceil((Math.abs(this.actionObj.clone.getBoundingClientRect().left - this.actionObj.X) / this.widthPerMinute)) *\n                this.widthPerMinute : this.widthUptoCursorPoint;\n        this.widthUptoCursorPoint = this.isMorePopupOpened ? this.actionObj.cellWidth : this.widthUptoCursorPoint;\n        this.heightUptoCursorPoint = (this.heightUptoCursorPoint === 0) ?\n            Math.ceil((Math.abs(this.actionObj.clone.getBoundingClientRect().top - this.actionObj.Y) / this.heightPerMinute)) *\n                this.heightPerMinute : this.heightUptoCursorPoint;\n        this.isAllDayDrag = (this.parent.activeViewOptions.timeScale.enable) ?\n            this.actionObj.clone.classList.contains(ALLDAY_APPOINTMENT_CLASS) :\n            this.actionObj.event[this.parent.eventFields.isAllDay];\n        if (this.isStepDragging && this.minDiff === 0) {\n            this.calculateMinutesDiff(eventObj);\n        }\n        if ((this.parent.currentView === 'Month' || this.isAllDayDrag) && this.daysVariation < 0) {\n            const date = this.parent.getDateFromElement(this.actionObj.target);\n            if (!isNullOrUndefined(date)) {\n                const currentDate = resetTime(date);\n                const startDate = resetTime(new Date(eventObj[this.parent.eventFields.startTime].getTime()));\n                this.daysVariation = (currentDate.getTime() - startDate.getTime()) / MS_PER_DAY;\n            }\n            else {\n                this.daysVariation = 0;\n            }\n        }\n        else {\n            this.daysVariation = 0;\n        }\n        if (this.parent.eventDragArea) {\n            const targetElement = eventArgs.target;\n            this.actionObj.clone.style.top = formatUnit(targetElement.offsetTop);\n            this.actionObj.clone.style.left = formatUnit(targetElement.offsetLeft);\n            const currentTarget = closest(targetElement, '.' + ROOT);\n            if (!currentTarget) {\n                this.actionObj.clone.style.height = '';\n                this.actionObj.clone.style.width = '';\n            }\n            else {\n                if (!(this.parent.currentView === 'Week' || this.parent.currentView === 'WorkWeek' || this.parent.currentView === 'Day')) {\n                    this.actionObj.clone.style.width = formatUnit(this.actionObj.element.offsetWidth);\n                }\n            }\n        }\n        this.updateScrollPosition(e);\n        this.updateNavigatingPosition(e);\n        this.updateDraggingDateTime(e);\n        const dragArgs = {\n            data: eventObj, event: e, element: this.actionObj.element, startTime: this.actionObj.start,\n            endTime: this.actionObj.end, selectedData: this.updatedData\n        };\n        if (this.parent.group.resources.length > 0) {\n            dragArgs.groupIndex = this.actionObj.groupIndex;\n        }\n        this.parent.trigger(drag, dragArgs);\n    }\n    calculateMinutesDiff(eventObj) {\n        if (this.parent.enableRtl) {\n            this.minDiff =\n                ((this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint) / this.widthPerMinute) * this.actionObj.interval;\n        }\n        else {\n            this.minDiff = (this.widthUptoCursorPoint / this.widthPerMinute) * this.actionObj.interval;\n        }\n        const startDate = eventObj[this.parent.eventFields.startTime];\n        const startTime = this.parent.activeView.renderDates[0];\n        const startEndHours = getStartEndHours(startTime, this.parent.activeView.getStartHour(), this.parent.activeView.getEndHour());\n        if (startEndHours.startHour.getTime() > startDate.getTime()) {\n            this.minDiff = this.minDiff + ((startEndHours.startHour.getTime() - startDate.getTime()) / MS_PER_MINUTE);\n        }\n    }\n    dragStop(e) {\n        this.isCursorAhead = false;\n        this.removeCloneElementClasses();\n        this.removeCloneElement();\n        clearInterval(this.actionObj.navigationInterval);\n        this.actionObj.navigationInterval = null;\n        clearInterval(this.actionObj.scrollInterval);\n        this.actionObj.scrollInterval = null;\n        this.actionClass('removeClass');\n        this.parent.uiStateValues.action = false;\n        this.actionObj.action = null;\n        if (this.isAllowDrop(e)) {\n            return;\n        }\n        const target = ((!e.target.classList.contains('e-work-cells') && this.parent.cellTemplate) ?\n            closest(e.target, '.e-work-cells') : e.target);\n        const dragArgs = {\n            cancel: false, data: this.getChangedData(this.updatedData), selectedData: this.updatedData,\n            event: e, element: this.actionObj.element, target: target\n        };\n        this.parent.trigger(dragStop, dragArgs, (dragEventArgs) => {\n            if (dragEventArgs.cancel) {\n                return;\n            }\n            if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.activeViewOptions.group.allowGroupEdit\n                && !this.parent.rowAutoHeight && !this.parent.virtualScrollModule && this.parent.activeViewOptions.group.byGroupID) {\n                this.parent.crudModule.crudObj.isCrudAction = true;\n                this.parent.crudModule.crudObj.sourceEvent =\n                    [this.parent.resourceBase.lastResourceLevel[parseInt(dragArgs.element.getAttribute('data-group-index'), 10)]];\n                const currentGroupIndex = parseInt(dragArgs.target.getAttribute('data-group-index'), 10) || this.actionObj.groupIndex;\n                this.parent.crudModule.crudObj.targetEvent = [this.parent.resourceBase.lastResourceLevel[currentGroupIndex]];\n            }\n            this.saveChangedData(dragEventArgs, this.isMultiSelect);\n        });\n        this.updatedData = [];\n        this.multiData = [];\n        this.isMultiSelect = false;\n        this.parent.selectedElements = [];\n    }\n    updateNavigatingPosition(e) {\n        if (this.actionObj.navigation.enable) {\n            let currentDate = this.parent.getCurrentTime();\n            if (isNullOrUndefined(this.actionObj.navigationInterval)) {\n                this.actionObj.navigationInterval = window.setInterval(() => {\n                    if (currentDate) {\n                        const crtDate = this.parent.getCurrentTime();\n                        const end = crtDate.getSeconds();\n                        let start = currentDate.getSeconds() + (this.actionObj.navigation.timeDelay / 1000);\n                        start = (start >= 60) ? start - 60 : start;\n                        if (start === end) {\n                            currentDate = this.parent.getCurrentTime();\n                            this.viewNavigation(e);\n                            this.updateDraggingDateTime(e);\n                        }\n                    }\n                }, this.actionObj.navigation.timeDelay);\n            }\n        }\n    }\n    updateDraggingDateTime(e) {\n        if (!isNullOrUndefined(this.actionObj.clone.offsetParent) &&\n            this.actionObj.clone.offsetParent.classList.contains(MORE_EVENT_POPUP_CLASS)) {\n            this.morePopupEventDragging(e);\n        }\n        else if (this.parent.activeView.isTimelineView() && this.parent.currentView !== 'TimelineYear') {\n            this.timelineEventModule.dateRender = this.parent.activeView.renderDates;\n            this.timelineEventModule.cellWidth = this.actionObj.cellWidth;\n            this.timelineEventModule.getSlotDates();\n            this.actionObj.cellWidth = this.isHeaderRows ? this.timelineEventModule.cellWidth : this.actionObj.cellWidth;\n            this.calculateTimelineTime(e);\n        }\n        else {\n            if (this.parent.currentView === 'Month' || this.parent.currentView === 'TimelineYear') {\n                this.calculateVerticalDate(e);\n            }\n            else {\n                this.calculateVerticalTime(e);\n            }\n        }\n    }\n    navigationWrapper() {\n        if (!this.parent.activeView.isTimelineView()) {\n            if (this.parent.currentView === 'Month' || !this.parent.timeScale.enable) {\n                const outerWrapperCls = [].slice.call(this.parent.element.querySelectorAll('.' + WORK_CELLS_CLASS));\n                this.actionObj.index = (this.parent.activeView.renderDates.length < this.actionObj.index) ?\n                    this.parent.activeView.renderDates.length - 1 : this.actionObj.index;\n                let targetWrapper = outerWrapperCls[this.actionObj.index].querySelector('.' + APPOINTMENT_WRAPPER_CLASS);\n                if (!targetWrapper) {\n                    targetWrapper = createElement('div', { className: APPOINTMENT_WRAPPER_CLASS });\n                    outerWrapperCls[this.actionObj.index].appendChild(targetWrapper);\n                }\n                targetWrapper.appendChild(this.actionObj.clone);\n            }\n            else {\n                const wrapperClass = this.actionObj.clone.classList.contains(ALLDAY_APPOINTMENT_CLASS) ?\n                    '.' + ALLDAY_APPOINTMENT_WRAPPER_CLASS : '.' + APPOINTMENT_WRAPPER_CLASS;\n                this.parent.element.querySelectorAll(wrapperClass)\n                    .item(this.actionObj.index).appendChild(this.actionObj.clone);\n                if (wrapperClass === '.' + ALLDAY_APPOINTMENT_WRAPPER_CLASS) {\n                    const elementHeight = this.getAllDayEventHeight();\n                    const event = [].slice.call(this.parent.element.querySelectorAll('.' + ALLDAY_CELLS_CLASS + ':first-child'));\n                    if (event[0].offsetHeight < elementHeight) {\n                        for (const e of event) {\n                            e.style.height = ((elementHeight + 2) / 12) + 'em';\n                        }\n                    }\n                    this.actionObj.clone.style.height = formatUnit(elementHeight);\n                }\n                this.actionObj.height = parseInt(this.actionObj.clone.style.height, 10);\n            }\n        }\n        else {\n            let outWrapper;\n            if (this.parent.activeViewOptions.group.resources.length > 0) {\n                outWrapper = this.parent.element.querySelectorAll('.e-appointment-container:not(.e-hidden)').item(this.actionObj.index);\n            }\n            else {\n                outWrapper = this.parent.element.querySelector('.' + APPOINTMENT_CONTAINER_CLASS);\n            }\n            if (!isNullOrUndefined(outWrapper)) {\n                let tarWrapper = outWrapper.querySelector('.' + APPOINTMENT_WRAPPER_CLASS);\n                if (!tarWrapper) {\n                    tarWrapper = createElement('div', { className: APPOINTMENT_WRAPPER_CLASS });\n                    outWrapper.appendChild(tarWrapper);\n                }\n                this.actionObj.cloneElement.forEach((ele) => {\n                    tarWrapper.appendChild(ele);\n                });\n            }\n        }\n    }\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    viewNavigation(e) {\n        let navigationType;\n        const dragArea = this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS);\n        if (dragArea && ((!this.scrollEdges.top && !this.scrollEdges.bottom) ||\n            closest(this.actionObj.clone, '.' + ALLDAY_APPOINTMENT_WRAPPER_CLASS))) {\n            if ((dragArea.scrollLeft === 0) &&\n                (Math.round(this.actionObj.X) <=\n                    Math.round(dragArea.getBoundingClientRect().left + this.actionObj.cellWidth + window.pageXOffset))) {\n                navigationType = this.parent.enableRtl ? 'next' : 'previous';\n            }\n            else if ((Math.round(dragArea.scrollLeft) + dragArea.clientWidth === dragArea.scrollWidth) &&\n                (Math.round(this.actionObj.X) >=\n                    Math.round(dragArea.getBoundingClientRect().right - this.actionObj.cellWidth + window.pageXOffset))) {\n                navigationType = this.parent.enableRtl ? 'previous' : 'next';\n            }\n            if (navigationType) {\n                this.parent.changeDate(this.parent.activeView.getNextPreviousDate(navigationType));\n            }\n        }\n    }\n    morePopupEventDragging(e) {\n        if (isNullOrUndefined(e.target) || (e.target && isNullOrUndefined(closest(e.target, 'td')))) {\n            return;\n        }\n        const eventObj = extend({}, this.actionObj.event, null, true);\n        const eventDuration = eventObj[this.parent.eventFields.endTime].getTime() -\n            eventObj[this.parent.eventFields.startTime].getTime();\n        const td = closest(e.target, 'td');\n        if (this.parent.currentView === 'TimelineYear' && !td.classList.contains('e-work-cells')) {\n            return;\n        }\n        const dragStart$$1 = this.parent.getDateFromElement(td);\n        const dragEnd = new Date(dragStart$$1.getTime());\n        dragEnd.setMilliseconds(eventDuration);\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            this.actionObj.groupIndex = parseInt(td.getAttribute('data-group-index'), 10);\n        }\n        this.actionObj.start = new Date(dragStart$$1.getTime());\n        this.actionObj.end = new Date(dragEnd.getTime());\n        this.actionObj.clone.style.top = formatUnit(td.offsetParent.offsetTop);\n        this.actionObj.clone.style.left = formatUnit(td.offsetLeft);\n        this.actionObj.clone.style.width = formatUnit(td.offsetWidth);\n        let eventContainer = td;\n        let eventWrapper;\n        if (this.parent.activeView.isTimelineView()) {\n            const rowIndex = closest(td, 'tr').rowIndex;\n            eventContainer = this.parent.element.querySelectorAll('.e-appointment-container').item(rowIndex);\n        }\n        eventWrapper = eventContainer.querySelector('.' + APPOINTMENT_WRAPPER_CLASS);\n        if (!eventWrapper) {\n            eventWrapper = createElement('div', { className: APPOINTMENT_WRAPPER_CLASS });\n            eventContainer.appendChild(eventWrapper);\n        }\n        this.appendCloneElement(eventWrapper);\n    }\n    calculateVerticalTime(e) {\n        if (isNullOrUndefined(this.actionObj.target) ||\n            (this.actionObj.target && isNullOrUndefined(closest(this.actionObj.target, 'tr'))) ||\n            (!(closest(this.actionObj.target, 'td').classList.contains(WORK_CELLS_CLASS)) &&\n                !(closest(this.actionObj.target, 'td').classList.contains(ALLDAY_CELLS_CLASS)))) {\n            return;\n        }\n        if (this.parent.activeViewOptions.timeScale.enable) {\n            this.swapDragging(e);\n        }\n        const dragArea = this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS);\n        const eventObj = extend({}, this.actionObj.event, null, true);\n        const eventStart = eventObj[this.parent.eventFields.startTime];\n        const eventEnd = eventObj[this.parent.eventFields.endTime];\n        const eventDuration = getUniversalTime(eventEnd) - getUniversalTime(eventStart);\n        let offsetTop = Math.floor(parseInt(this.actionObj.clone.style.top, 10) / this.actionObj.cellHeight)\n            * this.actionObj.cellHeight;\n        offsetTop = offsetTop < 0 ? 0 : offsetTop;\n        if (this.scrollEdges.top || this.scrollEdges.bottom) {\n            offsetTop = this.scrollEdges.top ? dragArea.scrollTop - this.heightUptoCursorPoint +\n                this.actionObj.cellHeight + window.pageYOffset :\n                (dragArea.scrollTop + dragArea.offsetHeight - this.actionObj.clone.offsetHeight + window.pageYOffset) +\n                    (this.actionObj.clone.offsetHeight - this.heightUptoCursorPoint);\n            offsetTop = Math.round(offsetTop / this.actionObj.cellHeight) * this.actionObj.cellHeight;\n            this.actionObj.clone.style.top = formatUnit(offsetTop);\n        }\n        const rowIndex = (this.parent.activeViewOptions.timeScale.enable) ? (offsetTop / this.actionObj.cellHeight) : 0;\n        const heightPerMinute = this.actionObj.cellHeight / this.actionObj.slotInterval;\n        const diffInMinutes = parseInt(this.actionObj.clone.style.top, 10) - offsetTop;\n        let tr;\n        if (this.isAllDayDrag) {\n            tr = this.parent.element.querySelector('.' + ALLDAY_ROW_CLASS);\n        }\n        else {\n            const trCollections = [].slice.call(this.parent.getContentTable().querySelectorAll('tr'));\n            tr = trCollections[rowIndex];\n        }\n        let index;\n        if (closest(this.actionObj.target, 'td').classList.contains(WORK_CELLS_CLASS) ||\n            closest(this.actionObj.target, 'td').classList.contains(ALLDAY_CELLS_CLASS)) {\n            index = closest(this.actionObj.target, 'td').cellIndex;\n        }\n        const colIndex = isNullOrUndefined(index) ? closest(this.actionObj.clone, 'td').cellIndex : index;\n        this.actionObj.index = colIndex;\n        if (isNullOrUndefined(tr)) {\n            return;\n        }\n        const td = tr.children[colIndex];\n        if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n            this.actionObj.groupIndex = parseInt(td.getAttribute('data-group-index'), 10);\n        }\n        let dragStart$$1;\n        let dragEnd;\n        if (this.parent.activeViewOptions.timeScale.enable && !this.isAllDayDrag) {\n            this.appendCloneElement(this.getEventWrapper(colIndex));\n            dragStart$$1 = this.parent.getDateFromElement(td);\n            dragStart$$1.setMinutes(dragStart$$1.getMinutes() + (diffInMinutes / heightPerMinute));\n            dragEnd = new Date(dragStart$$1.getTime());\n            if (this.actionObj.element.classList.contains(ALLDAY_APPOINTMENT_CLASS)) {\n                dragEnd.setMinutes(dragEnd.getMinutes() + this.actionObj.slotInterval);\n            }\n            else {\n                dragEnd.setMilliseconds(eventDuration);\n            }\n        }\n        else {\n            dragStart$$1 = this.parent.getDateFromElement(td);\n            dragStart$$1.setDate(dragStart$$1.getDate() - this.daysVariation);\n            dragStart$$1.setHours(eventStart.getHours(), eventStart.getMinutes(), eventStart.getSeconds());\n            dragEnd = new Date(dragStart$$1.getTime());\n            dragEnd.setMilliseconds(eventDuration);\n            if (!this.actionObj.element.classList.contains(ALLDAY_APPOINTMENT_CLASS) &&\n                this.actionObj.clone.classList.contains(ALLDAY_APPOINTMENT_CLASS)) {\n                dragEnd = addDays(resetTime(dragEnd), 1);\n            }\n            this.updateAllDayEvents(dragStart$$1, dragEnd, this.parent.activeViewOptions.group.byDate ? colIndex : undefined);\n        }\n        this.actionObj.start = new Date(+dragStart$$1);\n        this.actionObj.end = new Date(+dragEnd);\n        const event = this.getUpdatedEvent(this.actionObj.start, this.actionObj.end, this.actionObj.event);\n        const dynamicWrappers = [].slice.call(this.parent.element.querySelectorAll('.e-dynamic-clone'));\n        for (const wrapper of dynamicWrappers) {\n            remove(wrapper);\n        }\n        if (this.multiData.length > 0) {\n            if (this.isAllDayTarget && this.isAllDayDrag && !isNullOrUndefined(this.actionObj.isAllDay) && !this.actionObj.isAllDay) {\n                const targetCellTime = parseInt((closest(this.actionObj.target, 'td')).getAttribute('data-date'), 10);\n                this.multiData.forEach((data) => {\n                    this.swagData.push(extend({}, data, null, true));\n                    if (data[this.parent.eventFields.isAllDay]) {\n                        data[this.parent.eventFields.startTime] =\n                            new Date(data[this.parent.eventFields.startTime].getTime() + (targetCellTime - this.startTime));\n                        const startTime = new Date(data[this.parent.eventFields.startTime]);\n                        const endTime = new Date(startTime.setMinutes(startTime.getMinutes() + this.actionObj.slotInterval));\n                        data[this.parent.eventFields.endTime] = endTime;\n                        data[this.parent.eventFields.isAllDay] = false;\n                    }\n                });\n                this.startTime = targetCellTime;\n            }\n            if (this.isAllDayTarget && this.isAllDayDrag &&\n                !isNullOrUndefined(this.actionObj.isAllDay) && this.actionObj.isAllDay && this.swagData.length > 0) {\n                this.multiData = this.swagData;\n                this.swagData = [];\n                const eventObj = extend({}, this.actionObj.event, null, true);\n                this.startTime = eventObj[this.parent.eventFields.startTime].getTime();\n            }\n            const startTimeDiff = event[this.parent.eventFields.startTime].getTime() - this.startTime;\n            for (let index = 0; index < this.multiData.length; index++) {\n                this.updatedData[index] = this.updateMultipleData(this.multiData[index], startTimeDiff);\n                const dayIndex = this.getDayIndex(this.updatedData[index]);\n                if (dayIndex >= 0) {\n                    const wrapper = this.getEventWrapper(dayIndex, this.updatedData[index][this.parent.eventFields.isAllDay]);\n                    this.appendCloneElement(wrapper, this.actionObj.cloneElement[index]);\n                    this.updateEventHeight(this.updatedData[index], index, dayIndex);\n                }\n                else {\n                    if (!isNullOrUndefined(this.actionObj.cloneElement[index].parentNode)) {\n                        remove(this.actionObj.cloneElement[index]);\n                    }\n                }\n            }\n        }\n        else {\n            this.updateEventHeight(event);\n        }\n        this.updateTimePosition(this.actionObj.start, this.updatedData);\n    }\n    splitEvent(event) {\n        const eventFields = this.parent.eventFields;\n        const eventData = [];\n        const startTime = event[eventFields.startTime];\n        const endTime = event[eventFields.endTime];\n        if (resetTime(new Date(startTime.getTime())) < resetTime(new Date(endTime.getTime()))) {\n            let startReferenceDate = resetTime(new Date(startTime.getTime()));\n            let endReferenceDate = new Date(startReferenceDate.getTime());\n            for (let i = 0; startReferenceDate < new Date(endTime.getTime()); i++) {\n                endReferenceDate = new Date(endReferenceDate.setDate(startReferenceDate.getDate() + 1));\n                const eventObj = extend({}, event, null, true);\n                eventObj[eventFields.startTime] = new Date(startReferenceDate);\n                eventObj[eventFields.endTime] = new Date(endReferenceDate);\n                startReferenceDate = new Date(startReferenceDate.setDate(startReferenceDate.getDate() + 1));\n                eventData.push(eventObj);\n            }\n            const index = eventData.length - 1;\n            eventData[0][eventFields.startTime] = startTime;\n            eventData[index][eventFields.endTime] = endTime;\n        }\n        else {\n            eventData.push(event);\n        }\n        return eventData;\n    }\n    updateMultipleData(data, timeDifference) {\n        const eventObj = extend({}, data, null, true);\n        if (!isNullOrUndefined(this.actionObj.isAllDay) && this.parent.activeViewOptions.timeScale.enable &&\n            ((this.isAllDayTarget && eventObj[this.parent.eventFields.isAllDay]) ||\n                (!this.isAllDayTarget && !eventObj[this.parent.eventFields.isAllDay]))) {\n            eventObj[this.parent.eventFields.isAllDay] = this.actionObj.isAllDay;\n        }\n        const endTimeDiff = eventObj[this.parent.eventFields.endTime].getTime() -\n            eventObj[this.parent.eventFields.startTime].getTime();\n        if (eventObj[this.parent.eventFields.isAllDay]) {\n            const differInDays = Math.ceil(timeDifference / (1000 * 3600 * 24));\n            const day = Math.ceil(endTimeDiff / (1000 * 3600 * 24));\n            const startTime = new Date(eventObj[this.parent.eventFields.startTime]);\n            eventObj[this.parent.eventFields.startTime] = resetTime(new Date(startTime.setDate(startTime.getDate() + differInDays)));\n            eventObj[this.parent.eventFields.endTime] = addDays(eventObj[this.parent.eventFields.startTime], day);\n        }\n        else {\n            eventObj[this.parent.eventFields.startTime] =\n                new Date(eventObj[this.parent.eventFields.startTime].getTime() + timeDifference);\n            eventObj[this.parent.eventFields.endTime] =\n                new Date(eventObj[this.parent.eventFields.startTime].getTime() + endTimeDiff);\n        }\n        return eventObj;\n    }\n    getDayIndex(event) {\n        const eventObj = extend({}, event, null, true);\n        const startTime = resetTime(eventObj[this.parent.eventFields.startTime]).getTime();\n        let query = '';\n        let wrapper = DAY_WRAPPER_CLASS;\n        if (this.parent.activeViewOptions.timeScale.enable && (eventObj[this.parent.eventFields.isAllDay])) {\n            wrapper = ALLDAY_APPOINTMENT_WRAPPER_CLASS;\n        }\n        else {\n            wrapper = WORK_CELLS_CLASS;\n        }\n        query = '.' + wrapper + '[data-date=\"' + startTime + '\"]';\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            query = query + '[data-group-index=\"' + this.actionObj.groupIndex + '\"]';\n        }\n        this.targetTd = this.parent.element.querySelector(query);\n        if (isNullOrUndefined(this.targetTd)) {\n            return -1;\n        }\n        return this.targetTd.cellIndex;\n    }\n    updateEventHeight(event, index, colIndex) {\n        this.verticalEvent.initializeValues();\n        let datesCount = 0;\n        if (!this.parent.uiStateValues.isGroupAdaptive) {\n            for (let i = 0; i < this.actionObj.groupIndex; i++) {\n                datesCount = datesCount + this.verticalEvent.dateRender[i].length;\n            }\n        }\n        const indexGroup = this.parent.uiStateValues.isGroupAdaptive ? datesCount : this.actionObj.groupIndex;\n        const target = (this.parent.activeViewOptions.group.byDate &&\n            !isNullOrUndefined(this.parent.getDateFromElement(this.actionObj.target))) ? true : false;\n        if (target || !this.parent.activeViewOptions.group.byDate) {\n            let dynamicIndex = -1;\n            let dayIndex = !this.parent.activeViewOptions.group.byDate ?\n                isNullOrUndefined(index) ? this.actionObj.index - datesCount : colIndex - datesCount\n                : this.parent.getIndexOfDate(this.verticalEvent.dateRender[indexGroup], resetTime(\n                // eslint-disable-next-line max-len\n                this.parent.getDateFromElement(isNullOrUndefined(index) ? this.actionObj.target : this.targetTd)));\n            const splitEvents = this.splitEvent(event);\n            const events = this.parent.eventBase.isAllDayAppointment(event) || splitEvents.length > 2 ||\n                this.parent.eventSettings.spannedEventPlacement !== 'TimeSlot' ? [event] : splitEvents;\n            for (let i = 0; i < events.length; i++) {\n                if (i > 0) {\n                    let filterQuery = `.e-day-wrapper[data-date=\"${resetTime(events[i][this.parent.eventFields.startTime]).getTime()}\"]`;\n                    if (this.parent.activeViewOptions.group.resources.length > 0) {\n                        filterQuery = filterQuery.concat('[data-group-index = \"' + this.actionObj.groupIndex + '\"]');\n                    }\n                    const appWrap = this.parent.element.querySelector(filterQuery);\n                    if (appWrap) {\n                        dayIndex = dayIndex + 1;\n                        dynamicIndex = appWrap.cellIndex;\n                    }\n                    else {\n                        dayIndex = -1;\n                    }\n                }\n                if (dayIndex >= 0) {\n                    const record = this.verticalEvent.isSpannedEvent(events[i], dayIndex, indexGroup);\n                    const eStart = record[this.verticalEvent.fields.startTime];\n                    const eEnd = record[this.verticalEvent.fields.endTime];\n                    let appHeight = this.parent.activeViewOptions.timeScale.enable ? this.verticalEvent.getHeight(eStart, eEnd) :\n                        this.actionObj.element.offsetHeight;\n                    let topValue = this.parent.activeViewOptions.timeScale.enable ?\n                        this.verticalEvent.getTopValue(eStart, dayIndex, indexGroup) : this.actionObj.element.offsetTop;\n                    if (isNullOrUndefined(index)) {\n                        if (i === 0) {\n                            this.actionObj.clone.style.top = formatUnit(topValue);\n                            this.actionObj.clone.style.height = formatUnit(appHeight);\n                        }\n                        else {\n                            this.renderSpannedEvents(record, dynamicIndex, topValue, appHeight);\n                        }\n                    }\n                    else {\n                        let appWidth = this.actionObj.cellWidth;\n                        if (event[this.parent.eventFields.isAllDay]) {\n                            topValue = this.parent.element.querySelector('.' + ALLDAY_ROW_CLASS).offsetTop;\n                            appHeight = this.getAllDayEventHeight();\n                            const timeDiff = event[this.parent.eventFields.endTime].getTime() -\n                                event[this.parent.eventFields.startTime].getTime();\n                            const allDayDifference = Math.ceil(timeDiff / (1000 * 3600 * 24));\n                            if (allDayDifference >= 0) {\n                                appWidth = (allDayDifference * this.actionObj.cellWidth);\n                            }\n                        }\n                        if (this.actionObj.cloneElement[index]) {\n                            if (i === 0) {\n                                this.actionObj.cloneElement[index].style.top = formatUnit(topValue);\n                                this.actionObj.cloneElement[index].style.height = formatUnit(appHeight);\n                                this.actionObj.cloneElement[index].style.width = formatUnit(appWidth);\n                                this.actionObj.cloneElement[index].style.left = formatUnit(0);\n                            }\n                            else {\n                                this.renderSpannedEvents(record, dynamicIndex, topValue, appHeight);\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    }\n    renderSpannedEvents(record, index, top, height) {\n        const startTime = record[this.parent.eventFields.startTime].getTime();\n        const endTime = record[this.parent.eventFields.endTime].getTime();\n        if (startTime !== endTime) {\n            const appointmentElement = this.verticalEvent.\n                createAppointmentElement(record, false, record.isSpanned, this.actionObj.groupIndex);\n            addClass([appointmentElement], [CLONE_ELEMENT_CLASS, 'e-dynamic-clone']);\n            setStyleAttribute(appointmentElement, {\n                'width': '100%',\n                'height': height + 'px',\n                'top': top + 'px',\n                'border': '0px'\n            });\n            const appointmentWrap = [].slice.call(this.parent.element.querySelectorAll('.' + APPOINTMENT_WRAPPER_CLASS));\n            appointmentWrap[index].appendChild(appointmentElement);\n        }\n    }\n    getRenderedDates() {\n        let renderDates = this.parent.activeView.renderDates;\n        this.parent.eventBase.slots.push(...this.parent.activeView.renderDates.map((date) => +date));\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            this.parent.eventBase.slots = [];\n            const resources = this.parent.resourceBase.lastResourceLevel.\n                filter((res) => res.groupIndex === this.actionObj.groupIndex);\n            renderDates = resources[0].renderDates;\n            this.parent.eventBase.slots.push(...renderDates.map((date) => +date));\n        }\n        return renderDates;\n    }\n    updateAllDayEvents(startDate, endDate, colIndex) {\n        this.parent.eventBase.slots = [];\n        const event = this.getUpdatedEvent(startDate, endDate, this.actionObj.event);\n        const renderDates = this.getRenderedDates();\n        const events = this.parent.eventBase.splitEvent(event, renderDates);\n        let query = `.e-all-day-cells[data-date=\"${events[0][this.parent.eventFields.startTime].getTime()}\"]`;\n        if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n            query = query.concat('[data-group-index = \"' + this.actionObj.groupIndex + '\"]');\n        }\n        const cell = [].slice.call(this.parent.element.querySelectorAll(query));\n        if (cell.length > 0 || !isNullOrUndefined(colIndex)) {\n            const cellIndex = !isNullOrUndefined(colIndex) ? colIndex : cell[0].cellIndex;\n            this.appendCloneElement(this.getEventWrapper(cellIndex));\n            // eslint-disable-next-line max-len\n            this.actionObj.clone.style.width = formatUnit(events[0].data.count * this.actionObj.cellWidth);\n        }\n    }\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    swapDragging(e) {\n        const colIndex = closest(this.actionObj.target, 'td').cellIndex;\n        if (closest(this.actionObj.target, '.' + DATE_HEADER_WRAP_CLASS) &&\n            !closest(this.actionObj.clone, '.' + ALLDAY_APPOINTMENT_WRAPPER_CLASS)) {\n            addClass([this.actionObj.clone], ALLDAY_APPOINTMENT_CLASS);\n            this.appendCloneElement(this.getEventWrapper(colIndex));\n            this.actionObj.isAllDay = true;\n            const eventHeight = this.getAllDayEventHeight();\n            const allDayElement = [].slice.call(this.parent.element.querySelectorAll('.' + ALLDAY_CELLS_CLASS + ':first-child'));\n            if (allDayElement[0].offsetHeight < eventHeight) {\n                for (const element of allDayElement) {\n                    element.style.height = ((eventHeight + 2) / 12) + 'em';\n                }\n            }\n            setStyleAttribute(this.actionObj.clone, {\n                width: formatUnit(this.actionObj.cellWidth),\n                height: formatUnit(eventHeight),\n                top: formatUnit(this.parent.element.querySelector('.' + ALLDAY_ROW_CLASS).offsetTop)\n            });\n        }\n        if (closest(this.actionObj.target, '.' + WORK_CELLS_CLASS) &&\n            !closest(this.actionObj.clone, '.' + DAY_WRAPPER_CLASS)) {\n            removeClass([this.actionObj.clone], ALLDAY_APPOINTMENT_CLASS);\n            this.appendCloneElement(this.getEventWrapper(colIndex));\n            this.actionObj.isAllDay = false;\n            // eslint-disable-next-line max-len\n            const height = (this.actionObj.element.offsetHeight === 0) ? this.actionObj.height : this.actionObj.element.offsetHeight;\n            setStyleAttribute(this.actionObj.clone, {\n                left: formatUnit(0),\n                height: formatUnit(height),\n                width: formatUnit(this.actionObj.cellWidth)\n            });\n        }\n    }\n    calculateVerticalDate(e) {\n        if (isNullOrUndefined(e.target) || (e.target && isNullOrUndefined(closest(e.target, 'tr'))) ||\n            (e.target && e.target.tagName === 'DIV')) {\n            return;\n        }\n        const eventObj = extend({}, this.actionObj.event, null, true);\n        if (isNullOrUndefined(this.parent.eventDragArea)) {\n            this.removeCloneElement();\n        }\n        const eventDuration = getUniversalTime(eventObj[this.parent.eventFields.endTime]) -\n            getUniversalTime(eventObj[this.parent.eventFields.startTime]);\n        let td = closest(this.actionObj.target, 'td');\n        if (!isNullOrUndefined(td)) {\n            const tr = td.parentElement;\n            this.actionObj.index = (tr.rowIndex * tr.children.length) + td.cellIndex;\n            const workCells = [].slice.call(this.parent.element.querySelectorAll('.' + WORK_CELLS_CLASS));\n            td = workCells[this.actionObj.index];\n            const currentDate = this.parent.getDateFromElement(td);\n            if (!isNullOrUndefined(currentDate)) {\n                if (this.parent.activeViewOptions.group.resources.length > 0) {\n                    this.actionObj.groupIndex = parseInt(td.getAttribute('data-group-index'), 10);\n                }\n                const timeString = new Date(currentDate.setDate(currentDate.getDate() - this.daysVariation));\n                const dragStart$$1 = new Date(timeString.getTime());\n                const startTimeDiff = getUniversalTime(eventObj[this.parent.eventFields.startTime]) -\n                    getUniversalTime(resetTime(new Date(+eventObj[this.parent.eventFields.startTime])));\n                dragStart$$1.setMilliseconds(startTimeDiff);\n                const dragEnd = new Date(dragStart$$1.getTime());\n                dragEnd.setMilliseconds(eventDuration);\n                this.actionObj.start = new Date(dragStart$$1.getTime());\n                this.actionObj.end = new Date(dragEnd.getTime());\n            }\n        }\n        const event = this.getUpdatedEvent(this.actionObj.start, this.actionObj.end, this.actionObj.event);\n        const eventWrappers = [].slice.call(this.parent.element.querySelectorAll('.' + CLONE_ELEMENT_CLASS));\n        for (const wrapper of eventWrappers) {\n            remove(wrapper);\n        }\n        if (this.multiData && this.multiData.length > 0) {\n            const startTime = resetTime(new Date(event[this.parent.eventFields.startTime]));\n            let startTimeDiff = startTime.getTime() - this.startTime;\n            if (this.parent.currentView === 'TimelineYear' && this.parent.group.resources.length > 0) {\n                startTimeDiff = (startTime.getFullYear() - new Date(this.startTime).getFullYear()) * 12;\n                startTimeDiff -= new Date(this.startTime).getMonth();\n                startTimeDiff += startTime.getMonth();\n            }\n            for (let index = 0; index < this.multiData.length; index++) {\n                this.updatedData[index] = this.updateMultipleVerticalDate(this.multiData[index], startTimeDiff);\n                if (this.parent.currentView === 'TimelineYear') {\n                    this.dynamicYearlyEventsRendering(this.updatedData[index]);\n                }\n                else {\n                    this.dynamicEventsRendering(this.updatedData[index]);\n                }\n            }\n        }\n        else {\n            if (this.parent.currentView === 'TimelineYear') {\n                this.dynamicYearlyEventsRendering(event);\n            }\n            else {\n                this.dynamicEventsRendering(event);\n            }\n        }\n    }\n    updateMultipleVerticalDate(data, timeDifference) {\n        const eventObj = extend({}, data, null, true);\n        const eventDuration = eventObj[this.parent.eventFields.endTime].getTime() -\n            eventObj[this.parent.eventFields.startTime].getTime();\n        const startDate = new Date(eventObj[this.parent.eventFields.startTime]);\n        if (this.parent.currentView === 'TimelineYear' && this.parent.group.resources.length > 0) {\n            eventObj[this.parent.eventFields.startTime] = new Date(startDate.setMonth(startDate.getMonth() + timeDifference));\n        }\n        else {\n            const differInDays = Math.ceil(timeDifference / MS_PER_DAY);\n            eventObj[this.parent.eventFields.startTime] = new Date(startDate.setDate(startDate.getDate() + differInDays));\n        }\n        eventObj[this.parent.eventFields.endTime] =\n            new Date(eventObj[this.parent.eventFields.startTime].getTime() + eventDuration);\n        return eventObj;\n    }\n    calculateTimelineTime(e) {\n        const eventObj = extend({}, this.actionObj.event, null, true);\n        const eventDuration = getUniversalTime(eventObj[this.parent.eventFields.endTime]) -\n            getUniversalTime(eventObj[this.parent.eventFields.startTime]);\n        let offsetLeft = this.parent.enableRtl ? Math.abs(this.actionObj.clone.offsetLeft) - this.actionObj.clone.offsetWidth :\n            parseInt(this.actionObj.clone.style.left, 10);\n        offsetLeft = Math.floor(offsetLeft / this.actionObj.cellWidth) * this.actionObj.cellWidth;\n        let rightOffset;\n        if (this.parent.enableRtl) {\n            rightOffset = Math.abs(parseInt(this.actionObj.clone.style.right, 10));\n            this.actionObj.clone.style.right = formatUnit(rightOffset);\n        }\n        offsetLeft = this.getOffsetValue(offsetLeft, rightOffset);\n        const colIndex = this.getColumnIndex(offsetLeft);\n        const dragArea = this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS);\n        const contentWrapRight = dragArea.getBoundingClientRect().right;\n        const cursorDrag = this.parent.activeView.isTimelineView() && !this.parent.enableRtl &&\n            this.actionObj.pageX > this.actionObj.clone.getBoundingClientRect().right &&\n            !this.isMorePopupOpened && !(this.actionObj.pageX > contentWrapRight);\n        const leftVal = (this.parent.eventDragArea) ? dragArea.scrollLeft - dragArea.offsetLeft : 0;\n        if ((this.isCursorAhead || cursorDrag) && !this.isStepDragging) {\n            this.isCursorAhead = true;\n        }\n        let cloneIndex = Math.floor((this.actionObj.pageX - this.actionObj.clone.getBoundingClientRect().left + leftVal) / this.actionObj.cellWidth);\n        if (this.parent.enableRtl) {\n            cloneIndex = Math.abs(Math.floor((this.actionObj.pageX - this.actionObj.clone.getBoundingClientRect().right) /\n                this.actionObj.cellWidth)) - 1;\n        }\n        if (this.cursorPointIndex < 0) {\n            this.cursorIndex(e, eventObj, offsetLeft, cloneIndex);\n        }\n        const tr = this.parent.getContentTable().querySelector('tr');\n        let index = this.getCursorCurrentIndex(colIndex, cloneIndex, tr);\n        index = index < 0 ? 0 : index;\n        let eventStart = this.isHeaderRows ? new Date(this.timelineEventModule.dateRender[index].getTime()) :\n            this.parent.getDateFromElement(tr.children[index]);\n        if (this.isStepDragging) {\n            const widthDiff = this.getWidthDiff(tr, index);\n            if (widthDiff !== 0) {\n                const timeDiff = Math.round(widthDiff / this.widthPerMinute);\n                eventStart.setMinutes(eventStart.getMinutes() + (timeDiff * this.actionObj.interval));\n                if (this.isCursorAhead || cursorDrag) {\n                    eventStart.setMilliseconds(-(eventDuration));\n                }\n                else {\n                    eventStart.setMinutes(eventStart.getMinutes() - this.minDiff);\n                }\n            }\n            else {\n                eventStart = this.actionObj.start;\n            }\n        }\n        else {\n            if (this.isCursorAhead || cursorDrag) {\n                eventStart.setMinutes(eventStart.getMinutes() +\n                    (this.isTimelineDayProcess ? MINUTES_PER_DAY : this.actionObj.slotInterval));\n                eventStart.setMilliseconds(-(eventDuration));\n            }\n            else {\n                eventStart.setMinutes(eventStart.getMinutes() -\n                    (this.cursorPointIndex * (this.isTimelineDayProcess ? MINUTES_PER_DAY : this.actionObj.slotInterval)));\n            }\n        }\n        eventStart = this.calculateIntervalTime(eventStart);\n        if (this.isTimelineDayProcess) {\n            const eventSrt = eventObj[this.parent.eventFields.startTime];\n            eventStart.setHours(eventSrt.getHours(), eventSrt.getMinutes(), eventSrt.getSeconds());\n        }\n        if (this.parent.eventDragArea) {\n            const targetDate = this.parent.getDateFromElement(e.target);\n            if (!isNullOrUndefined(targetDate)) {\n                if (!this.parent.activeViewOptions.timeScale.enable || (this.parent.currentView === 'TimelineMonth')) {\n                    const eventSrt = eventObj[this.parent.eventFields.startTime];\n                    eventStart = new Date(targetDate.setHours(eventSrt.getHours(), eventSrt.getMinutes(), eventSrt.getSeconds()));\n                }\n                else {\n                    eventStart = targetDate;\n                }\n            }\n        }\n        const eventEnd = new Date(eventStart.getTime());\n        eventEnd.setMilliseconds(eventDuration);\n        let eventsData = [this.getUpdatedEvent(eventStart, eventEnd, this.actionObj.event)];\n        if (this.multiData.length > 0) {\n            const startTimeDiff = eventsData[0][this.parent.eventFields.startTime].getTime() - this.startTime;\n            for (let i = 0; i < this.multiData.length; i++) {\n                this.updatedData[i] = this.updateMultipleData(this.multiData[i], startTimeDiff);\n            }\n            eventsData = this.updatedData;\n        }\n        for (let dataIndex = 0; dataIndex < eventsData.length; dataIndex++) {\n            const events = this.timelineEventModule.splitEvent(eventsData[dataIndex], this.timelineEventModule.dateRender);\n            const eventData = events[0].data;\n            const startTime = this.timelineEventModule.getStartTime(events[0], eventData);\n            const endTime = this.timelineEventModule.getEndTime(events[0], eventData);\n            // eslint-disable-next-line max-len\n            const width = this.timelineEventModule.getEventWidth(startTime, endTime, eventObj[this.parent.eventFields.isAllDay], eventData.count);\n            // eslint-disable-next-line max-len\n            let day = this.parent.getIndexOfDate(this.timelineEventModule.dateRender, resetTime(new Date(startTime.getTime())));\n            day = day < 0 ? 0 : day;\n            const left = this.timelineEventModule.getPosition(startTime, endTime, eventObj[this.parent.eventFields.isAllDay], day);\n            const cloneElement = this.multiData.length > 0 ? this.actionObj.cloneElement[dataIndex] : this.actionObj.clone;\n            if (this.parent.enableRtl) {\n                cloneElement.style.right = formatUnit(left);\n            }\n            else {\n                cloneElement.style.left = formatUnit(left);\n            }\n            if (!this.isMorePopupOpened) {\n                cloneElement.style.width = formatUnit(width);\n            }\n            if (this.parent.activeViewOptions.group.resources.length > 0) {\n                this.calculateResourceGroupingPosition(e, cloneElement);\n            }\n            this.actionObj.start = new Date(eventStart.getTime());\n            this.actionObj.end = new Date(eventEnd.getTime());\n            this.updateTimePosition(this.actionObj.start, this.updatedData);\n        }\n    }\n    getOffsetValue(offsetLeft, rightOffset) {\n        if (this.scrollEdges.left || this.scrollEdges.right) {\n            const viewEle = this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS);\n            if (this.parent.enableRtl) {\n                rightOffset = viewEle.offsetWidth - viewEle.scrollLeft;\n                if (this.scrollEdges.right) {\n                    rightOffset = (rightOffset - viewEle.offsetWidth + this.actionObj.clone.offsetWidth) -\n                        (this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint);\n                }\n                else {\n                    rightOffset = rightOffset + this.widthUptoCursorPoint;\n                    if (rightOffset - this.widthUptoCursorPoint >= viewEle.scrollWidth) {\n                        this.actionObj.clone.style.width =\n                            formatUnit(this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint + this.actionObj.cellWidth);\n                        rightOffset = (viewEle.scrollLeft - viewEle.scrollWidth);\n                    }\n                }\n                this.actionObj.clone.style.left = formatUnit(rightOffset);\n            }\n            else {\n                if (this.scrollEdges.left) {\n                    offsetLeft = viewEle.scrollLeft - this.widthUptoCursorPoint + this.actionObj.cellWidth;\n                    if (viewEle.scrollLeft + viewEle.offsetWidth >= viewEle.offsetWidth) {\n                        viewEle.scrollLeft = viewEle.scrollLeft - 1;\n                    }\n                    else if (this.actionObj.clone.offsetLeft === 0) {\n                        offsetLeft = viewEle.scrollLeft;\n                    }\n                }\n                else {\n                    offsetLeft = (viewEle.scrollLeft + viewEle.offsetWidth -\n                        this.actionObj.clone.offsetWidth) + (this.actionObj.clone.offsetWidth - this.widthUptoCursorPoint);\n                }\n                offsetLeft = offsetLeft < 0 ? 0 : offsetLeft;\n                this.actionObj.clone.style.left = formatUnit(offsetLeft);\n            }\n        }\n        return offsetLeft;\n    }\n    getWidthDiff(tr, index) {\n        const pages = this.scrollArgs.element.getBoundingClientRect();\n        if (pages.left <= this.actionObj.pageX && pages.right >= this.actionObj.pageX) {\n            const targetLeft = tr.children[index].offsetLeft;\n            const pageX = this.actionObj.pageX - pages.left;\n            if (this.parent.enableRtl) {\n                return (targetLeft + this.actionObj.cellWidth) - (this.scrollArgs.element.scrollLeft + pageX);\n            }\n            else {\n                return (this.scrollArgs.element.scrollLeft + pageX) - targetLeft;\n            }\n        }\n        return 0;\n    }\n    getColumnIndex(offsetLeft) {\n        const index = Math.floor(offsetLeft / this.actionObj.cellWidth);\n        if (this.isHeaderRows) {\n            return index;\n        }\n        return this.getIndex(index);\n    }\n    getCursorCurrentIndex(colIndex, cloneIndex, tr) {\n        const index = colIndex + cloneIndex;\n        if (this.isHeaderRows) {\n            const dateLength = Math.floor(tr.offsetWidth / this.actionObj.cellWidth);\n            return (index > dateLength - 1) ? dateLength - 1 : index;\n        }\n        return (index > tr.children.length - 1) ? tr.children.length - 1 : index;\n    }\n    cursorIndex(e, event, left, index) {\n        const td = closest(e.target, '.e-work-cells');\n        if (!isNullOrUndefined(td) && !this.isMorePopupOpened) {\n            let targetDate = this.parent.getDateFromElement(td);\n            if (this.isHeaderRows) {\n                const currentIndex = Math.floor(left / this.actionObj.cellWidth);\n                targetDate = new Date(this.timelineEventModule.dateRender[currentIndex + index].getTime());\n            }\n            const timeDiff = targetDate.getTime() - event[this.parent.eventFields.startTime].getTime();\n            if (this.isTimelineDayProcess) {\n                this.cursorPointIndex = Math.abs(Math.ceil(timeDiff / (MS_PER_DAY)));\n            }\n            else {\n                const widthDiff = Math.floor((timeDiff / MS_PER_MINUTE) / (this.actionObj.slotInterval / this.actionObj.cellWidth));\n                this.cursorPointIndex = Math.floor(widthDiff / this.actionObj.cellWidth);\n                this.cursorPointIndex = this.cursorPointIndex < 0 ? 0 : this.cursorPointIndex;\n            }\n        }\n        else {\n            this.cursorPointIndex = 0;\n        }\n    }\n    calculateResourceGroupingPosition(e, cloneElement) {\n        const dragArea = this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS);\n        const trCollection = [].slice.call(this.parent.element.querySelectorAll('.e-content-wrap .e-content-table tr:not(.e-hidden)'));\n        let translateY = getTranslateY(dragArea.querySelector('table'));\n        translateY = (isNullOrUndefined(translateY)) ? 0 : translateY;\n        const rowHeight = (this.parent.rowAutoHeight) ?\n            ~~(dragArea.querySelector('table').offsetHeight / trCollection.length) : this.actionObj.cellHeight;\n        let rowIndex = Math.floor(Math.floor((this.actionObj.Y +\n            (dragArea.scrollTop - translateY - (window.scrollY || window.pageYOffset))) -\n            dragArea.getBoundingClientRect().top) / rowHeight);\n        rowIndex = (rowIndex < 0) ? 0 : (rowIndex > trCollection.length - 1) ? trCollection.length - 1 : rowIndex;\n        this.actionObj.index = rowIndex;\n        const eventContainer = this.parent.element.querySelectorAll('.e-appointment-container:not(.e-hidden)').item(rowIndex);\n        let eventWrapper = eventContainer.querySelector('.' + APPOINTMENT_WRAPPER_CLASS);\n        if (!eventWrapper) {\n            eventWrapper = createElement('div', { className: APPOINTMENT_WRAPPER_CLASS });\n            eventContainer.appendChild(eventWrapper);\n        }\n        this.appendCloneElement(eventWrapper, cloneElement);\n        const td = closest(this.actionObj.target, 'td');\n        this.actionObj.groupIndex = (td && !isNaN(parseInt(td.getAttribute('data-group-index'), 10)))\n            ? parseInt(td.getAttribute('data-group-index'), 10) : this.actionObj.groupIndex;\n        let top = trCollection[rowIndex].getBoundingClientRect().height * rowIndex;\n        if (this.parent.rowAutoHeight) {\n            const cursorElement = this.getCursorElement(e);\n            if (cursorElement) {\n                top = cursorElement.classList.contains(WORK_CELLS_CLASS) ? cursorElement.offsetTop :\n                    (cursorElement.offsetParent && cursorElement.offsetParent.classList.contains(APPOINTMENT_CLASS)) ?\n                        cursorElement.offsetParent.offsetTop : top;\n            }\n        }\n        cloneElement.style.top = formatUnit(top);\n    }\n    appendCloneElement(element, cloneElement = null) {\n        cloneElement = isNullOrUndefined(cloneElement) ? this.actionObj.clone : cloneElement;\n        const dragElement = document.querySelector(this.parent.eventDragArea);\n        if (this.parent.eventDragArea && dragElement) {\n            dragElement.appendChild(cloneElement);\n        }\n        else {\n            element.appendChild(cloneElement);\n        }\n    }\n    getEventWrapper(index, isAllDayDrag) {\n        let eventWrapper;\n        if (isNullOrUndefined(isAllDayDrag)) {\n            isAllDayDrag = this.actionObj.clone.classList.contains(ALLDAY_APPOINTMENT_CLASS);\n        }\n        if (this.parent.activeViewOptions.timeScale.enable) {\n            const wrapperClass = isAllDayDrag ? '.' + ALLDAY_APPOINTMENT_WRAPPER_CLASS : '.' + APPOINTMENT_WRAPPER_CLASS;\n            eventWrapper = this.parent.element.querySelectorAll(wrapperClass).item(index);\n        }\n        else {\n            const targetWrapper = this.parent.element.querySelectorAll('.' + WORK_CELLS_CLASS).item(index);\n            eventWrapper = targetWrapper.querySelector('.' + APPOINTMENT_WRAPPER_CLASS);\n            if (!eventWrapper) {\n                eventWrapper = createElement('div', { className: APPOINTMENT_WRAPPER_CLASS });\n                targetWrapper.appendChild(eventWrapper);\n            }\n        }\n        return eventWrapper;\n    }\n    getAllDayEventHeight() {\n        const eventWrapper = createElement('div', { className: APPOINTMENT_CLASS });\n        this.parent.element.querySelector('.' + ALLDAY_APPOINTMENT_WRAPPER_CLASS).appendChild(eventWrapper);\n        const eventHeight = eventWrapper.offsetHeight;\n        remove(eventWrapper);\n        return eventHeight;\n    }\n    isAllowDrop(e) {\n        if (!this.actionObj.excludeSelectors) {\n            return false;\n        }\n        const dropSelectors = this.actionObj.excludeSelectors.split(',');\n        let isAllowDrop = false;\n        for (const selector of dropSelectors) {\n            if (e.target.classList.contains(selector)) {\n                isAllowDrop = true;\n                break;\n            }\n        }\n        return isAllowDrop;\n    }\n    /**\n     * Get module name.\n     *\n     * @returns {string} Returns the module name\n     */\n    getModuleName() {\n        return 'dragAndDrop';\n    }\n}\n\n/**\n * view base\n */\nclass ViewBase {\n    /**\n     * Constructor\n     *\n     * @param {Schedule} parent Accepts the schedule instance\n     */\n    constructor(parent) {\n        this.parent = parent;\n    }\n    isTimelineView() {\n        return this.parent.currentView.indexOf('Timeline') !== -1;\n    }\n    getContentRows() {\n        return [];\n    }\n    refreshHeader() {\n        // Method to refresh the date header\n    }\n    refreshResourceHeader() {\n        remove(this.element.querySelector('tbody').lastElementChild.firstElementChild);\n        const resTd = createElement('td');\n        resTd.appendChild(this.parent.resourceBase.createResourceColumn());\n        prepend([resTd], this.element.querySelector('tbody').lastElementChild);\n        this.parent.notify(contentReady, {});\n    }\n    getDayName(date) {\n        return this.parent.getDayNames('abbreviated')[date.getDay()];\n    }\n    getDate(date) {\n        return this.parent.globalize.formatDate(date, { format: 'd', calendar: this.parent.getCalendarMode() });\n    }\n    getTime(date) {\n        if (this.parent.isAdaptive) {\n            if (this.parent.activeViewOptions.timeFormat === 'HH:mm' || this.parent.activeViewOptions.timeFormat === 'HH.mm') {\n                return this.parent.globalize.formatDate(date, { format: 'H', calendar: this.parent.getCalendarMode() });\n            }\n            return this.parent.globalize.formatDate(date, { skeleton: 'h', calendar: this.parent.getCalendarMode() });\n        }\n        return this.parent.getTimeString(date);\n    }\n    getTimelineDate(date) {\n        const text = this.parent.globalize.formatDate(date, { skeleton: 'MMMd', calendar: this.parent.getCalendarMode() }) + ', ' +\n            this.parent.getDayNames('wide')[date.getDay()];\n        return capitalizeFirstWord(text, 'multiple');\n    }\n    createEventTable(trCount) {\n        const eventTable = createElement('div', { className: EVENT_TABLE_CLASS });\n        append(this.getEventRows(trCount), eventTable);\n        return eventTable;\n    }\n    getEventRows(trCount) {\n        const eventRows = [];\n        let eventContainer;\n        for (let row = 0; row < trCount; row++) {\n            eventContainer = createElement('div', { className: APPOINTMENT_CONTAINER_CLASS });\n            if (this.parent.resourceBase && !this.parent.uiStateValues.isGroupAdaptive && this.parent.resourceBase.renderedResources) {\n                eventContainer.setAttribute('data-group-index', this.parent.resourceBase.renderedResources[row].groupIndex.toString());\n            }\n            eventRows.push(eventContainer);\n        }\n        return eventRows;\n    }\n    collapseRows(wrap) {\n        if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n            this.parent.resourceBase.hideResourceRows(wrap.querySelector('tbody'));\n            this.parent.resourceBase.hideResourceRows(wrap.querySelector('.' + EVENT_TABLE_CLASS));\n        }\n    }\n    createTableLayout(className) {\n        const clsName = className || '';\n        const table = createElement('table', { className: SCHEDULE_TABLE_CLASS + ' ' + clsName, attrs: { role: 'table' } });\n        const tbody = createElement('tbody');\n        table.appendChild(tbody);\n        return table;\n    }\n    createColGroup(table, lastRow) {\n        let length = lastRow.length;\n        if (lastRow[0] && lastRow[0].colSpan) {\n            length = lastRow.map((value) => value.colSpan).reduce((prev, next) => prev + next);\n        }\n        const colGroupEle = createElement('colgroup');\n        for (let i = 0; i < length; i++) {\n            colGroupEle.appendChild(createElement('col'));\n        }\n        prepend([colGroupEle], table);\n    }\n    getScrollXIndent(content) {\n        return content.offsetHeight - content.clientHeight > 0 ? getScrollBarWidth() : 0;\n    }\n    scrollTopPanel(target) {\n        this.getDatesHeaderElement().firstElementChild.scrollLeft = target.scrollLeft;\n    }\n    scrollHeaderLabels(target) {\n        const headerTable = this.element.querySelector('.e-date-header-wrap table');\n        const colWidth = headerTable.offsetWidth / headerTable.querySelectorAll('colgroup col').length;\n        const applyLeft = (headerCells, isRtl) => {\n            let currentCell;\n            let tdLeft = 0;\n            let colSpan = 0;\n            const hiddenLeft = isRtl ? -(target.scrollLeft) : target.scrollLeft;\n            for (const cell of headerCells) {\n                colSpan += parseInt(cell.getAttribute('colSpan'), 10);\n                if (colSpan > Math.floor(hiddenLeft / colWidth)) {\n                    currentCell = cell;\n                    break;\n                }\n                tdLeft += cell.offsetWidth;\n            }\n            if (!isNullOrUndefined(currentCell)) {\n                currentCell.children[0].style[isRtl ? 'right' : 'left'] = (hiddenLeft - tdLeft) + 'px';\n            }\n        };\n        const classNames = ['.e-header-year-cell', '.e-header-month-cell', '.e-header-week-cell', '.e-header-cells'];\n        for (const className of classNames) {\n            const headerCells = [].slice.call(this.element.querySelectorAll(className));\n            if (headerCells.length > 0) {\n                for (const element of headerCells) {\n                    element.children[0].style[this.parent.enableRtl ? 'right' : 'left'] = '';\n                }\n                applyLeft(headerCells, this.parent.enableRtl);\n            }\n        }\n    }\n    addAttributes(td, element) {\n        if (td.template) {\n            append(td.template, element);\n        }\n        if (td.colSpan) {\n            element.setAttribute('colspan', td.colSpan.toString());\n        }\n        if (td.className) {\n            addClass([element], td.className);\n        }\n    }\n    getHeaderBarHeight() {\n        let headerBarHeight = 2;\n        if (this.parent.headerModule) {\n            headerBarHeight += getOuterHeight(this.parent.headerModule.getHeaderElement());\n        }\n        if (this.parent.uiStateValues.isGroupAdaptive) {\n            const resHeader = this.parent.element.querySelector('.' + RESOURCE_HEADER_TOOLBAR);\n            if (resHeader) {\n                headerBarHeight += resHeader.offsetHeight;\n            }\n        }\n        return headerBarHeight;\n    }\n    renderPanel(type) {\n        if (type === PREVIOUS_PANEL_CLASS) {\n            prepend([this.element], this.parent.element.querySelector('.' + TABLE_CONTAINER_CLASS));\n        }\n        else {\n            this.parent.element.querySelector('.' + TABLE_CONTAINER_CLASS).appendChild(this.element);\n        }\n    }\n    setPanel(panel) {\n        this.element = panel;\n    }\n    getPanel() {\n        return this.element;\n    }\n    getDatesHeaderElement() {\n        return this.element.querySelector('.' + DATE_HEADER_CONTAINER_CLASS);\n    }\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    getDateSlots(renderDates, workDays) {\n        return []; // Here getDateSlots only need in vertical and month views\n    }\n    generateColumnLevels() {\n        return []; // Here generateColumnLevels only need in vertical and month views\n    }\n    getColumnLevels() {\n        return this.colLevels;\n    }\n    highlightCurrentTime() {\n        // Here showTimeIndicator functionalities\n    }\n    startDate() {\n        return this.renderDates[0];\n    }\n    endDate() {\n        return addDays(this.renderDates[this.renderDates.length - 1], 1);\n    }\n    getStartHour() {\n        let startHour = this.parent.getStartEndTime(this.parent.activeViewOptions.startHour);\n        if (isNullOrUndefined(startHour)) {\n            startHour = new Date(2000, 0, 0, 0);\n        }\n        return startHour;\n    }\n    getEndHour() {\n        let endHour = this.parent.getStartEndTime(this.parent.activeViewOptions.endHour);\n        if (isNullOrUndefined(endHour)) {\n            endHour = new Date(2000, 0, 0, 0);\n        }\n        return endHour;\n    }\n    isCurrentDate(date) {\n        return date.setHours(0, 0, 0, 0) === this.parent.getCurrentTime().setHours(0, 0, 0, 0);\n    }\n    isCurrentMonth(date) {\n        if (this.parent.activeViewOptions.displayDate || this.parent.activeViewOptions.numberOfWeeks > 0) {\n            return this.parent.activeView.getStartDate().getTime() <= this.parent.getCurrentTime().getTime() &&\n                this.parent.activeView.getEndDate().getTime() >= this.parent.getCurrentTime().getTime();\n        }\n        return date.getFullYear() ===\n            this.parent.getCurrentTime().getFullYear() && date.getMonth() === this.parent.getCurrentTime().getMonth();\n    }\n    isWorkDay(date, workDays = this.parent.activeViewOptions.workDays) {\n        if (workDays.indexOf(date.getDay()) >= 0) {\n            return true;\n        }\n        return false;\n    }\n    isWorkHour(date, startHour, endHour, workDays) {\n        if (isNullOrUndefined(startHour) || isNullOrUndefined(endHour)) {\n            return false;\n        }\n        startHour.setMilliseconds(0);\n        endHour.setMilliseconds(0);\n        return !(getDateInMs(date) < getDateInMs(startHour) || getDateInMs(date) >= getDateInMs(endHour) ||\n            !this.isWorkDay(date, workDays));\n    }\n    getRenderDates(workDays) {\n        const renderDates = [];\n        // Due to same code for vertical and time line, week & work week views, if condition has used\n        if (this.parent.currentView === 'Week' || this.parent.currentView === 'TimelineWeek') {\n            const selectedDate = resetTime(this.parent.selectedDate);\n            let start = getWeekFirstDate(selectedDate, this.parent.activeViewOptions.firstDayOfWeek);\n            for (let i = 0, length = WEEK_LENGTH * this.parent.activeViewOptions.interval; i < length; i++) {\n                if (this.parent.activeViewOptions.showWeekend) {\n                    renderDates.push(start);\n                }\n                else {\n                    if (this.isWorkDay(start, workDays)) {\n                        renderDates.push(start);\n                    }\n                }\n                start = addDays(start, 1);\n            }\n        }\n        else if (this.parent.currentView === 'WorkWeek' || this.parent.currentView === 'TimelineWorkWeek') {\n            let start = getWeekFirstDate(resetTime(this.parent.selectedDate), this.parent.activeViewOptions.firstDayOfWeek);\n            for (let i = 0, length = WEEK_LENGTH * this.parent.activeViewOptions.interval; i < length; i++) {\n                if (this.isWorkDay(start, workDays)) {\n                    renderDates.push(start);\n                }\n                start = addDays(start, 1);\n            }\n        }\n        else {\n            const dayCount = this.parent.currentView === 'Agenda' ? this.parent.agendaDaysCount :\n                this.parent.activeViewOptions.interval;\n            let start = resetTime(this.parent.selectedDate);\n            do {\n                if (this.parent.activeViewOptions.showWeekend) {\n                    renderDates.push(start);\n                }\n                else {\n                    if (this.isWorkDay(start, workDays)) {\n                        renderDates.push(start);\n                    }\n                }\n                start = addDays(start, 1);\n            } while (dayCount !== renderDates.length);\n        }\n        if (!workDays) {\n            this.renderDates = renderDates;\n        }\n        if (this.parent.headerModule) {\n            this.parent.headerModule.previousNextIconHandler();\n        }\n        return renderDates;\n    }\n    getNextPreviousDate(type) {\n        if (this.parent.currentView === 'Day' || this.parent.currentView === 'TimelineDay') {\n            if (this.parent.activeViewOptions.showWeekend) {\n                const daysCount = this.parent.activeViewOptions.interval;\n                return addDays(this.parent.selectedDate, type === 'next' ? daysCount : -daysCount);\n            }\n            else {\n                let date;\n                if (type === 'next') {\n                    date = addDays(this.renderDates.slice(-1)[0], 1);\n                    while (!this.isWorkDay(date)) {\n                        date = addDays(date, 1);\n                    }\n                }\n                else {\n                    date = addDays(this.renderDates[0], -1);\n                    let count = 0;\n                    do {\n                        if (this.isWorkDay(date)) {\n                            count += 1;\n                        }\n                        if (this.parent.activeViewOptions.interval !== count) {\n                            date = addDays(date, -1);\n                        }\n                    } while (this.parent.activeViewOptions.interval !== count);\n                }\n                return date;\n            }\n        }\n        const weekLength = type === 'next' ? WEEK_LENGTH : -WEEK_LENGTH;\n        return addDays(this.parent.selectedDate, weekLength * this.parent.activeViewOptions.interval);\n    }\n    getLabelText(view) {\n        const viewStr = view.charAt(0).toLowerCase() + view.substring(1);\n        return this.parent.localeObj.getConstant(viewStr) + ' of ' + capitalizeFirstWord(this.parent.globalize.formatDate(this.parent.selectedDate, { skeleton: 'long', calendar: this.parent.getCalendarMode() }), 'single');\n    }\n    getDateRangeText() {\n        if (this.parent.isAdaptive) {\n            const formatDate = (this.parent.activeViewOptions.dateFormat) ? this.parent.activeViewOptions.dateFormat : 'MMMM y';\n            return capitalizeFirstWord(this.parent.globalize.formatDate(this.parent.selectedDate, { format: formatDate, calendar: this.parent.getCalendarMode() }), 'single');\n        }\n        return this.formatDateRange(this.renderDates[0], this.renderDates[this.renderDates.length - 1]);\n    }\n    formatDateRange(startDate, endDate) {\n        const globalize = this.parent.globalize;\n        const mode = this.parent.getCalendarMode();\n        if (startDate === endDate) {\n            endDate = null;\n        }\n        if (!isNullOrUndefined(this.parent.activeViewOptions.dateFormat)) {\n            let text = '';\n            if (!endDate) {\n                text = globalize.formatDate(startDate, { format: this.parent.activeViewOptions.dateFormat, calendar: mode });\n                return capitalizeFirstWord(text, 'multiple');\n            }\n            text = (globalize.formatDate(startDate, { format: this.parent.activeViewOptions.dateFormat, calendar: mode }) +\n                ' - ' + globalize.formatDate(endDate, { format: this.parent.activeViewOptions.dateFormat, calendar: mode }));\n            return capitalizeFirstWord(text, 'multiple');\n        }\n        let formattedStr;\n        let longDateFormat;\n        if (this.parent.locale === 'en' || this.parent.locale === 'en-US') {\n            longDateFormat = getValue('dateFormats.long', getDefaultDateObject(mode));\n        }\n        else {\n            longDateFormat = getValue('main.' + '' + this.parent.locale + '.dates.calendars.' + mode + '.dateFormats.long', cldrData);\n        }\n        if (!endDate) {\n            return capitalizeFirstWord(globalize.formatDate(startDate, { format: longDateFormat, calendar: mode }), 'single');\n        }\n        const dateFormat = longDateFormat.trim().toLocaleLowerCase();\n        if (dateFormat.substr(0, 1) === 'd') {\n            if (startDate.getFullYear() === endDate.getFullYear()) {\n                if (startDate.getMonth() === endDate.getMonth()) {\n                    formattedStr = globalize.formatDate(startDate, { format: 'dd', calendar: mode }) + ' - ' +\n                        globalize.formatDate(endDate, { format: 'dd MMMM yyyy', calendar: mode });\n                }\n                else {\n                    formattedStr = globalize.formatDate(startDate, { format: 'dd MMM', calendar: mode }) + ' - ' +\n                        globalize.formatDate(endDate, { format: 'dd MMM yyyy', calendar: mode });\n                }\n            }\n            else {\n                formattedStr = globalize.formatDate(startDate, { format: 'dd MMM yyyy', calendar: mode }) + ' - ' +\n                    globalize.formatDate(endDate, { format: 'dd MMM yyyy', calendar: mode });\n            }\n        }\n        else if (dateFormat.substr(0, 1) === 'm') {\n            if (startDate.getFullYear() === endDate.getFullYear()) {\n                if (startDate.getMonth() === endDate.getMonth()) {\n                    formattedStr = globalize.formatDate(startDate, { format: 'MMMM dd', calendar: mode }) + ' - ' +\n                        globalize.formatDate(endDate, { format: 'dd, yyyy', calendar: mode });\n                }\n                else {\n                    formattedStr = globalize.formatDate(startDate, { format: 'MMM dd', calendar: mode }) + ' - ' +\n                        globalize.formatDate(endDate, { format: 'MMM dd, yyyy', calendar: mode });\n                }\n            }\n            else {\n                formattedStr = globalize.\n                    formatDate(startDate, { format: 'MMM dd, yyyy', calendar: mode }) + ' - ' +\n                    globalize.formatDate(endDate, { format: 'MMM dd, yyyy', calendar: mode });\n            }\n        }\n        else {\n            formattedStr = globalize.formatDate(startDate, { format: longDateFormat, calendar: mode }) + ' - ' +\n                globalize.formatDate(endDate, { format: longDateFormat, calendar: mode });\n        }\n        return capitalizeFirstWord(formattedStr, 'multiple');\n    }\n    getMobileDateElement(date, className) {\n        const wrap = createElement('div', {\n            className: className,\n            innerHTML: '<div class=\"e-m-date\">' + this.parent.globalize.formatDate(date, { format: 'd', calendar: this.parent.getCalendarMode() }) + '</div>' + '<div class=\"e-m-day\">' +\n                capitalizeFirstWord(this.parent.globalize.formatDate(date, { format: 'E', calendar: this.parent.getCalendarMode() }), 'single') + '</div>'\n        });\n        return wrap;\n    }\n    setResourceHeaderContent(tdElement, tdData, className = TEXT_ELLIPSIS) {\n        if (this.parent.activeViewOptions.resourceHeaderTemplate) {\n            const data = { resource: tdData.resource, resourceData: tdData.resourceData };\n            const scheduleId = this.parent.element.id + '_';\n            const viewName = this.parent.activeViewOptions.resourceHeaderTemplateName;\n            const templateId = scheduleId + viewName + 'resourceHeaderTemplate';\n            const quickTemplate = [].slice.call(this.parent.getResourceHeaderTemplate()(data, this.parent, 'resourceHeaderTemplate', templateId, false));\n            append(quickTemplate, tdElement);\n        }\n        else {\n            tdElement.appendChild(createElement('div', {\n                className: className, innerHTML: tdData.resourceData[tdData.resource.textField]\n            }));\n        }\n    }\n    renderResourceMobileLayout() {\n        if (this.parent.resourceBase.lastResourceLevel && this.parent.resourceBase.lastResourceLevel.length <= 0) {\n            return;\n        }\n        this.parent.resourceBase.renderResourceHeader();\n        this.parent.resourceBase.renderResourceTree();\n    }\n    addAutoHeightClass(element) {\n        if (!this.parent.uiStateValues.isGroupAdaptive && this.parent.rowAutoHeight && this.isTimelineView()\n            && this.parent.activeViewOptions.group.resources.length > 0) {\n            addClass([element], AUTO_HEIGHT);\n        }\n    }\n    getColElements() {\n        return [].slice.call(this.element.querySelectorAll('.' + CONTENT_WRAP_CLASS + ' col, .' + DATE_HEADER_WRAP_CLASS + ' col'));\n    }\n    setColWidth(content) {\n        if (this.isTimelineView()) {\n            const colElements = this.getColElements();\n            const contentBody = this.element.querySelector('.' + CONTENT_TABLE_CLASS + ' tbody');\n            const colWidth = (contentBody.getBoundingClientRect().width / (colElements.length / 2));\n            colElements.forEach((col) => setStyleAttribute(col, { 'width': formatUnit(colWidth) }));\n            if (content.offsetHeight !== content.clientHeight) {\n                const resourceColumn = this.parent.element.querySelector('.' + RESOURCE_COLUMN_WRAP_CLASS);\n                if (!isNullOrUndefined(resourceColumn)) {\n                    setStyleAttribute(resourceColumn, { 'height': formatUnit(content.clientHeight) });\n                }\n            }\n            const cssClass = `.${HEADER_CELLS_CLASS},.${TIME_SLOT_CLASS},.${HEADER_WEEK_CELLS_CLASS},.${HEADER_MONTH_CELLS_CLASS},.${HEADER_YEAR_CELLS_CLASS}`;\n            const headerCellElements = [].slice.call(this.element.querySelectorAll(cssClass));\n            headerCellElements.forEach((ele) => {\n                const colSpan = isNullOrUndefined(ele.getAttribute('colspan')) ? '1' : ele.getAttribute('colspan');\n                const headerCellColSpan = parseInt(colSpan, 10);\n                setStyleAttribute(ele, { 'width': formatUnit(colWidth * headerCellColSpan) });\n            });\n        }\n    }\n    resetColWidth() {\n        const colElements = this.getColElements();\n        for (const col of colElements) {\n            col.style.width = '';\n        }\n    }\n    getContentAreaElement() {\n        return this.element.querySelector('.' + CONTENT_WRAP_CLASS);\n    }\n    wireExpandCollapseIconEvents() {\n        if (this.parent.resourceBase && this.parent.resourceBase.resourceCollection.length > 1) {\n            const treeIcons = [].slice.call(this.element.querySelectorAll('.' + RESOURCE_TREE_ICON_CLASS));\n            for (const icon of treeIcons) {\n                EventHandler.clearEvents(icon);\n                EventHandler.add(icon, 'click', this.parent.resourceBase.onTreeIconClick, this.parent.resourceBase);\n            }\n        }\n    }\n    scrollToDate(scrollDate) {\n        if (['Month', 'TimelineMonth'].indexOf(this.parent.currentView) === -1 || isNullOrUndefined(scrollDate)) {\n            return;\n        }\n        const scrollWrap = this.getContentAreaElement();\n        const tdDate = new Date(resetTime(new Date(+scrollDate)).getTime()).getTime();\n        const dateElement = scrollWrap.querySelector(`.${WORK_CELLS_CLASS}[data-date=\"${tdDate}\"]`);\n        if (this.parent.currentView === 'Month' && dateElement) {\n            if (scrollWrap.scrollWidth > scrollWrap.clientWidth) {\n                if (!this.parent.enableRtl) {\n                    scrollWrap.scrollLeft = dateElement.offsetLeft;\n                }\n                else {\n                    scrollWrap.scrollLeft = -(this.parent.getContentTable().offsetWidth - dateElement.offsetLeft - dateElement.offsetWidth);\n                }\n            }\n            scrollWrap.scrollTop = dateElement.offsetTop;\n        }\n        if (this.parent.currentView === 'TimelineMonth' && dateElement) {\n            if (!this.parent.enableRtl) {\n                scrollWrap.scrollLeft = dateElement.offsetLeft;\n            }\n            else {\n                scrollWrap.scrollLeft = -(this.parent.getContentTable().offsetWidth - dateElement.offsetLeft - dateElement.offsetWidth);\n            }\n        }\n    }\n    setPersistence() {\n        if (this.parent.enablePersistence) {\n            const contentWrap = this.element.querySelector('.e-content-wrap');\n            if (!isNullOrUndefined(contentWrap)) {\n                this.parent.scrollLeft = contentWrap.scrollLeft;\n                this.parent.scrollTop = contentWrap.scrollTop;\n            }\n        }\n    }\n    retainScrollPosition() {\n        if (this.parent.enablePersistence) {\n            const conWrap = this.parent.element.querySelector('.e-content-wrap');\n            if (!isNullOrUndefined(conWrap) && !isNullOrUndefined(this.parent.scrollLeft) && !isNullOrUndefined(this.parent.scrollTop)) {\n                conWrap.scrollTop = this.parent.scrollTop;\n                conWrap.scrollLeft = this.parent.scrollLeft;\n            }\n        }\n    }\n    getViewStartDate() {\n        let startDate = this.renderDates[0];\n        if (this.parent.activeViewOptions.group.resources.length > 0 && this.parent.resourceBase.lastResourceLevel.length > 0) {\n            startDate = this.parent.resourceBase.getResourceRenderDates()[0];\n        }\n        return startDate;\n    }\n    getViewEndDate() {\n        let endDate = addDays(this.renderDates[this.renderDates.length - 1], 1);\n        if (this.parent.activeViewOptions.group.resources.length > 0 && this.parent.resourceBase.lastResourceLevel.length > 0) {\n            endDate = addDays(this.parent.resourceBase.getResourceRenderDates().slice(-1)[0], 1);\n        }\n        return endDate;\n    }\n    getAdjustedDate(startTime) {\n        if (!this.parent.activeViewOptions.timeScale.enable || this.parent.currentView === 'Month' ||\n            (this.parent.currentView === 'TimelineYear' && this.parent.activeViewOptions.group.resources.length === 0)) {\n            return new Date(startTime.setHours(0, 0, 0, 0));\n        }\n        else if (this.parent.currentView === 'TimelineYear' && this.parent.activeViewOptions.group.resources.length > 0) {\n            startTime.setHours(0, 0, 0, 0);\n            return new Date(startTime.setDate(1));\n        }\n        return null;\n    }\n    destroy() {\n        if (this.element && this.element.parentNode) {\n            remove(this.element);\n        }\n        this.element = null;\n        this.renderDates = null;\n        this.colLevels = null;\n    }\n}\n\n/**\n * vertical view\n */\nclass VerticalView extends ViewBase {\n    constructor(parent) {\n        super(parent);\n        this.viewClass = 'e-day-view';\n        this.isInverseTableSelect = true;\n        this.baseCssClass = 'e-vertical-view';\n        this.appointment = null;\n    }\n    getModuleName() {\n        return 'verticalView';\n    }\n    addEventListener() {\n        this.parent.on(scrollUiUpdate, this.scrollUiUpdate, this);\n        this.parent.on(dataReady, this.renderEvents, this);\n    }\n    removeEventListener() {\n        if (this.parent) {\n            this.parent.off(scrollUiUpdate, this.scrollUiUpdate);\n            this.parent.off(dataReady, this.renderEvents);\n        }\n    }\n    renderEvents() {\n        this.appointment = this.parent.activeViewOptions.timeScale.enable ?\n            new VerticalEvent(this.parent) : new MonthEvent(this.parent);\n        this.appointment.renderAppointments();\n        this.parent.notify(eventsLoaded, {});\n    }\n    onContentScroll(e) {\n        this.parent.removeNewEventElement();\n        const target = e.target;\n        this.parent.notify(virtualScroll, e);\n        this.scrollLeftPanel(target);\n        this.scrollTopPanel(target);\n        if (!this.parent.isAdaptive) {\n            this.parent.uiStateValues.top = target.scrollTop;\n        }\n        this.parent.uiStateValues.left = target.scrollLeft;\n        if (!isNullOrUndefined(this.parent.quickPopup)) {\n            this.parent.quickPopup.quickPopupHide();\n        }\n        this.setPersistence();\n    }\n    onAdaptiveMove(e) {\n        if (this.parent.uiStateValues.action) {\n            e.preventDefault();\n        }\n    }\n    onAdaptiveScroll(e) {\n        if (this.parent && !this.parent.isDestroyed) {\n            this.parent.removeNewEventElement();\n            this.parent.uiStateValues.top = e.target.scrollTop;\n        }\n    }\n    scrollLeftPanel(target) {\n        const leftPanel = this.getLeftPanelElement();\n        if (!isNullOrUndefined(leftPanel)) {\n            leftPanel.scrollTop = target.scrollTop;\n        }\n    }\n    scrollUiUpdate(args) {\n        if (!this.parent) {\n            return;\n        }\n        const dateHeader = this.parent.element.querySelector('.' + DATE_HEADER_WRAP_CLASS);\n        const headerBarHeight = this.getHeaderBarHeight();\n        const timeCells = this.getLeftPanelElement();\n        const content = this.getScrollableElement();\n        const header = this.getDatesHeaderElement();\n        const scrollerHeight = this.parent.element.offsetHeight - headerBarHeight - header.offsetHeight;\n        this.setColWidth(content);\n        this.setContentHeight(content, timeCells, scrollerHeight);\n        const scrollBarWidth = getScrollBarWidth();\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        header.firstElementChild.style[args.cssProperties.rtlBorder] = '';\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        header.style[args.cssProperties.rtlPadding] = '';\n        const isDateHeaderScroll = this.parent.enableAllDayScroll ? !((content.offsetWidth - content.clientWidth) <=\n            (dateHeader.offsetWidth - dateHeader.clientWidth) && dateHeader.classList.contains('e-all-day-scroll')) : true;\n        if (content.offsetWidth - content.clientWidth > 0 && isDateHeaderScroll) {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            header.firstElementChild.style[args.cssProperties.border] = scrollBarWidth > 0 ? '1px' : '0px';\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            header.style[args.cssProperties.padding] = scrollBarWidth > 0 ? scrollBarWidth - 1 + 'px' : '0px';\n        }\n        else {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            header.firstElementChild.style[args.cssProperties.border] = '';\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            header.style[args.cssProperties.padding] = '';\n        }\n        if (!args.isPreventScrollUpdate) {\n            if (this.parent.uiStateValues.isInitial) {\n                this.scrollToWorkHour();\n                this.parent.uiStateValues.isInitial = false;\n            }\n            else {\n                if (timeCells) {\n                    timeCells.scrollTop = this.parent.uiStateValues.top;\n                }\n                content.scrollTop = this.parent.uiStateValues.top;\n                content.scrollLeft = this.parent.uiStateValues.left;\n            }\n        }\n        if (this.parent.activeViewOptions.timeScale.enable) {\n            this.highlightCurrentTime();\n        }\n        this.retainScrollPosition();\n    }\n    setContentHeight(element, leftPanelElement, height) {\n        if (this.parent.isAdaptive && !this.isTimelineView()) {\n            element.style.height = (this.parent.height === 'auto') ? 'auto' : formatUnit(height);\n        }\n        else {\n            if (!isNullOrUndefined(leftPanelElement)) {\n                leftPanelElement.style.height = (this.parent.height === 'auto') ? 'auto'\n                    : formatUnit(height - this.getScrollXIndent(element));\n            }\n            element.style.height = (this.parent.height === 'auto') ? 'auto' : formatUnit(height);\n        }\n    }\n    scrollToWorkHour() {\n        if (this.parent.workHours.highlight) {\n            const firstWorkHourCell = this.element.querySelector('.' + WORK_HOURS_CLASS);\n            if (firstWorkHourCell) {\n                this.getScrollableElement().scrollTop = firstWorkHourCell.offsetTop;\n                this.parent.uiStateValues.top = firstWorkHourCell.offsetTop;\n                this.parent.uiStateValues.left = 0;\n            }\n        }\n    }\n    scrollToHour(hour, scrollDate) {\n        const date = this.parent.getStartEndTime(hour);\n        if (!isNullOrUndefined(scrollDate)) {\n            const headerElement = this.element.querySelector('.' + HEADER_CELLS_CLASS + '[data-date=\"' + new Date(resetTime(scrollDate)).getTime() + '\"]');\n            if (headerElement) {\n                if (this.parent.enableRtl) {\n                    const conWrap = this.element.querySelector('.' + CONTENT_TABLE_CLASS);\n                    this.getScrollableElement().scrollLeft = -(conWrap.offsetWidth - headerElement.offsetLeft - headerElement.offsetWidth);\n                }\n                else {\n                    this.getScrollableElement().scrollLeft = headerElement.offsetLeft;\n                }\n            }\n        }\n        if (isNullOrUndefined(date)) {\n            return;\n        }\n        this.getScrollableElement().scrollTop = this.getTopFromDateTime(date);\n    }\n    scrollToDate(scrollDate) {\n        this.scrollToHour(null, scrollDate);\n    }\n    generateColumnLevels() {\n        const level = this.getDateSlots(this.renderDates, this.parent.activeViewOptions.workDays);\n        let columnLevels = [];\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            columnLevels = this.parent.resourceBase.generateResourceLevels(level);\n            if (this.parent.uiStateValues.isGroupAdaptive && this.parent.resourceBase.lastResourceLevel.length > 0) {\n                const resourceLevel = this.parent.resourceBase.lastResourceLevel[this.parent.uiStateValues.groupIndex];\n                const resStartHour = resourceLevel.resourceData[resourceLevel.resource.startHourField];\n                const resEndHour = resourceLevel.resourceData[resourceLevel.resource.endHourField];\n                const dateSlots = this.getDateSlots(resourceLevel.renderDates, resourceLevel.workDays, resStartHour, resEndHour);\n                columnLevels = [dateSlots];\n            }\n        }\n        else {\n            columnLevels.push(level);\n        }\n        this.colLevels = columnLevels;\n        return columnLevels;\n    }\n    // eslint-disable-next-line max-len\n    getDateSlots(renderDates, workDays, workStartHour = this.parent.workHours.start, workEndHour = this.parent.workHours.end) {\n        const dateCol = [];\n        const start = this.parent.getStartEndTime(workStartHour);\n        const end = this.parent.getStartEndTime(workEndHour);\n        for (const col of renderDates) {\n            const classList$$1 = [HEADER_CELLS_CLASS];\n            if (this.isCurrentDate(col)) {\n                classList$$1.push(CURRENT_DAY_CLASS);\n            }\n            dateCol.push({\n                date: col, type: 'dateHeader', className: classList$$1, colSpan: 1,\n                workDays: workDays, startHour: new Date(+start), endHour: new Date(+end)\n            });\n        }\n        return dateCol;\n    }\n    isWorkHourRange(date) {\n        return (this.getStartHour().getTime() <= date.getTime()) && (this.getEndHour().getTime() >= date.getTime());\n    }\n    highlightCurrentTime() {\n        if (this.parent.activeViewOptions.headerRows.length > 0 &&\n            this.parent.activeViewOptions.headerRows.slice(-1)[0].option !== 'Hour') {\n            return;\n        }\n        if (this.parent.showTimeIndicator && this.isWorkHourRange(this.parent.getCurrentTime())) {\n            const currentDateIndex = this.getCurrentTimeIndicatorIndex();\n            if (currentDateIndex.length > 0) {\n                const workCells = [].slice.call(this.element.querySelectorAll('.' + WORK_CELLS_CLASS));\n                if (workCells.length > 0) {\n                    this.changeCurrentTimePosition();\n                }\n                if (isNullOrUndefined(this.currentTimeIndicatorTimer)) {\n                    const currentDate = this.parent.getCurrentTime();\n                    const interval = MS_PER_MINUTE - ((currentDate.getSeconds() * 1000) + currentDate.getMilliseconds());\n                    if (interval <= (MS_PER_MINUTE - 1000)) {\n                        window.setTimeout(() => {\n                            if (!isNullOrUndefined(this.currentTimeIndicatorTimer)) {\n                                this.clearCurrentTimeIndicatorTimer();\n                                this.changeCurrentTimePosition();\n                                this.updateCurrentTimeIndicatorTimer();\n                            }\n                        }, interval);\n                    }\n                    this.updateCurrentTimeIndicatorTimer();\n                }\n            }\n            else {\n                this.clearCurrentTimeIndicatorTimer();\n            }\n        }\n        else {\n            this.clearCurrentTimeIndicatorTimer();\n        }\n    }\n    getCurrentTimeIndicatorIndex() {\n        const currentDateIndex = [];\n        if (!isNullOrUndefined(this.parent.resourceBase) && (this.parent.activeViewOptions.group.resources.length > 0) &&\n            !this.parent.uiStateValues.isGroupAdaptive) {\n            let count = 0;\n            for (const resource of this.parent.resourceBase.lastResourceLevel) {\n                const index = this.parent.getIndexOfDate(resource.renderDates, resetTime(this.parent.getCurrentTime()));\n                if (index >= 0) {\n                    const resIndex = this.parent.activeViewOptions.group.byDate ?\n                        (this.parent.resourceBase.lastResourceLevel.length * index) + count : count + index;\n                    currentDateIndex.push(resIndex);\n                }\n                count += this.parent.activeViewOptions.group.byDate ? 1 : resource.renderDates.length;\n            }\n        }\n        else {\n            const renderDates = (this.parent.uiStateValues.isGroupAdaptive && this.parent.resourceBase.lastResourceLevel.length > 0)\n                ? this.parent.resourceBase.lastResourceLevel[this.parent.uiStateValues.groupIndex].renderDates : this.renderDates;\n            const index = this.parent.getIndexOfDate(renderDates, resetTime(this.parent.getCurrentTime()));\n            if (index >= 0) {\n                currentDateIndex.push(index);\n            }\n        }\n        return currentDateIndex;\n    }\n    clearCurrentTimeIndicatorTimer() {\n        if (!isNullOrUndefined(this.currentTimeIndicatorTimer)) {\n            window.clearInterval(this.currentTimeIndicatorTimer);\n            this.currentTimeIndicatorTimer = null;\n            this.removeCurrentTimeIndicatorElements();\n        }\n    }\n    updateCurrentTimeIndicatorTimer() {\n        this.currentTimeIndicatorTimer = window.setInterval(() => { this.changeCurrentTimePosition(); }, MS_PER_MINUTE);\n    }\n    removeCurrentTimeIndicatorElements() {\n        const queryString = '.' + PREVIOUS_TIMELINE_CLASS + ',.' + CURRENT_TIMELINE_CLASS + ',.' + CURRENT_TIME_CLASS;\n        const timeIndicator = [].slice.call(this.element.querySelectorAll(queryString));\n        for (const indicator of timeIndicator) {\n            remove(indicator);\n        }\n    }\n    changeCurrentTimePosition() {\n        if (!this.parent || this.parent && this.parent.isDestroyed) {\n            return;\n        }\n        this.removeCurrentTimeIndicatorElements();\n        const currentDateIndex = this.getCurrentTimeIndicatorIndex();\n        const firstRow = this.parent.getContentTable().rows[0];\n        const top = this.getTopFromDateTime(this.parent.getCurrentTime());\n        const topInPx = formatUnit(top);\n        const rowIndex = Math.floor(top / firstRow.cells[0].offsetHeight);\n        const timeCellsWrap = this.getLeftPanelElement();\n        const timeTrs = [].slice.call(timeCellsWrap.querySelectorAll('tr'));\n        if (isNullOrUndefined(rowIndex) || isNaN(rowIndex) || rowIndex === timeTrs.length) {\n            return;\n        }\n        const curTimeWrap = [].slice.call(this.element.querySelectorAll('.' + TIMELINE_WRAPPER_CLASS));\n        for (let i = 0, length = currentDateIndex[0]; i < length; i++) {\n            curTimeWrap[i].appendChild(createElement('div', { className: PREVIOUS_TIMELINE_CLASS, styles: 'top:' + topInPx }));\n        }\n        for (const day of currentDateIndex) {\n            curTimeWrap[day].appendChild(createElement('div', { className: CURRENT_TIMELINE_CLASS, styles: 'top:' + topInPx }));\n        }\n        const currentTimeEle = createElement('div', {\n            innerHTML: this.parent.getTimeString(this.parent.getCurrentTime()),\n            className: CURRENT_TIME_CLASS,\n            styles: 'top:' + topInPx\n        });\n        if (rowIndex <= timeTrs.length) {\n            removeClass(timeCellsWrap.querySelectorAll('.' + HIDE_CHILDS_CLASS), HIDE_CHILDS_CLASS);\n            if (timeTrs[rowIndex]) {\n                addClass([timeTrs[rowIndex].lastElementChild], HIDE_CHILDS_CLASS);\n            }\n            prepend([currentTimeEle], timeCellsWrap);\n            currentTimeEle.style.top = formatUnit(currentTimeEle.offsetTop - (currentTimeEle.offsetHeight / 2));\n        }\n    }\n    getTopFromDateTime(date) {\n        const startHour = this.getStartHour();\n        const diffInMinutes = ((date.getHours() - startHour.getHours()) * 60) + (date.getMinutes() - startHour.getMinutes());\n        return (diffInMinutes * this.getWorkCellHeight() * this.parent.activeViewOptions.timeScale.slotCount) /\n            this.parent.activeViewOptions.timeScale.interval;\n    }\n    getWorkCellHeight() {\n        return parseFloat(this.element.querySelector('.' + WORK_CELLS_CLASS).getBoundingClientRect().height.toFixed(2));\n    }\n    getTdContent(date, type, groupIndex) {\n        let cntEle;\n        const wrapper = createElement('div');\n        let templateName = '';\n        const templateId = this.parent.element.id + '_';\n        switch (type) {\n            case 'dateHeader':\n                if (this.parent.activeViewOptions.dateHeaderTemplate) {\n                    templateName = 'dateHeaderTemplate';\n                    const args = { date: date, type: type };\n                    const viewName = this.parent.activeViewOptions.dateHeaderTemplateName;\n                    cntEle = [].slice.call(this.parent.getDateHeaderTemplate()(args, this.parent, templateName, templateId + viewName + templateName, false));\n                }\n                else {\n                    wrapper.innerHTML = this.parent.activeView.isTimelineView() ?\n                        `<span class=\"e-header-date e-navigate\">${this.getTimelineDate(date)}</span>` :\n                        `<div class=\"e-header-day\">${capitalizeFirstWord(this.getDayName(date), 'single')}</div>` +\n                            `<div class=\"e-header-date e-navigate\" role=\"link\">${this.getDate(date)}</div>`;\n                    cntEle = [].slice.call(wrapper.childNodes);\n                }\n                break;\n            case 'majorSlot':\n                if (this.parent.activeViewOptions.timeScale.majorSlotTemplate) {\n                    templateName = 'majorSlotTemplate';\n                    const args = { date: date, type: type };\n                    cntEle = [].slice.call(this.parent.getMajorSlotTemplate()(args, this.parent, templateName, templateId + templateName, false));\n                }\n                else {\n                    wrapper.innerHTML = `<span>${this.getTime(date)}</span>`;\n                    cntEle = [].slice.call(wrapper.childNodes);\n                }\n                break;\n            case 'minorSlot':\n                if (this.parent.activeViewOptions.timeScale.minorSlotTemplate) {\n                    templateName = 'minorSlotTemplate';\n                    const args = { date: date, type: type };\n                    cntEle = [].slice.call(this.parent.getMinorSlotTemplate()(args, this.parent, templateName, templateId + templateName, false));\n                }\n                else {\n                    cntEle = [].slice.call(wrapper.childNodes);\n                }\n                break;\n            case 'alldayCells':\n                if (this.parent.activeViewOptions.cellTemplate) {\n                    const viewName = this.parent.activeViewOptions.cellTemplateName;\n                    templateName = 'cellTemplate';\n                    const args = { date: date, type: type, groupIndex: groupIndex };\n                    cntEle = [].slice.call(this.parent.getCellTemplate()(args, this.parent, templateName, templateId + viewName + templateName, false));\n                }\n                break;\n        }\n        return cntEle;\n    }\n    refreshHeader() {\n        remove(this.element.querySelector('tbody tr'));\n        this.renderHeader();\n        this.parent.notify(contentReady, {});\n    }\n    renderLayout(type) {\n        this.setPanel(createElement('div', { className: TABLE_WRAP_CLASS }));\n        const clsList = [this.baseCssClass, this.viewClass];\n        clsList.push(type);\n        if (this.parent.activeViewOptions.group.byDate) {\n            clsList.push('e-by-date');\n        }\n        if (!this.parent.activeViewOptions.timeScale.enable) {\n            addClass([this.element], [TIMESCALE_DISABLE, this.viewClass]);\n        }\n        if (this.parent.activeViewOptions.allowVirtualScrolling) {\n            clsList.push(VIRTUAL_SCROLL_CLASS);\n        }\n        if (this.parent.rowAutoHeight && this.parent.eventSettings.ignoreWhitespace) {\n            clsList.push(IGNORE_WHITESPACE);\n        }\n        this.renderPanel(type);\n        addClass([this.element], clsList);\n        this.element.appendChild(this.createTableLayout(OUTER_TABLE_CLASS));\n        this.element.querySelector('table').setAttribute('role', 'presentation');\n        this.colLevels = this.generateColumnLevels();\n        this.renderHeader();\n        this.renderContent();\n        if (this.parent.uiStateValues.isGroupAdaptive && !this.parent.element.querySelector('.' + RESOURCE_TOOLBAR_CONTAINER)) {\n            this.renderResourceMobileLayout();\n        }\n        this.parent.notify(contentReady, {});\n    }\n    renderHeader() {\n        const tr = createElement('tr');\n        const dateTd = createElement('td');\n        dateTd.appendChild(this.renderDatesHeader());\n        if (this.parent.activeViewOptions.timeScale.enable) {\n            const indentTd = createElement('td', { className: LEFT_INDENT_CLASS });\n            indentTd.appendChild(this.renderLeftIndent());\n            tr.appendChild(indentTd);\n        }\n        tr.appendChild(dateTd);\n        prepend([tr], this.element.querySelector('tbody'));\n    }\n    renderContent() {\n        const tr = createElement('tr');\n        const workTd = createElement('td');\n        if (this.parent.isAdaptive) {\n            workTd.setAttribute('colspan', (this.parent.activeViewOptions.timeScale.enable ? '2' : '1'));\n            const scrollContainer = createElement('div', { className: SCROLL_CONTAINER_CLASS });\n            if (this.parent.activeViewOptions.timeScale.enable) {\n                scrollContainer.appendChild(this.renderTimeCells());\n            }\n            scrollContainer.appendChild(this.renderContentArea());\n            workTd.appendChild(scrollContainer);\n            EventHandler.add(scrollContainer, 'scroll', this.onAdaptiveScroll, this);\n            EventHandler.add(scrollContainer, Browser.touchMoveEvent, this.onAdaptiveMove, this);\n            tr.appendChild(workTd);\n        }\n        else {\n            workTd.appendChild(this.renderContentArea());\n            if (this.parent.activeViewOptions.timeScale.enable) {\n                const timesTd = createElement('td');\n                timesTd.appendChild(this.renderTimeCells());\n                tr.appendChild(timesTd);\n            }\n            tr.appendChild(workTd);\n        }\n        this.element.querySelector('tbody').appendChild(tr);\n    }\n    renderLeftIndent() {\n        const wrap = createElement('div', { className: LEFT_INDENT_WRAP_CLASS });\n        const tbl = this.createTableLayout();\n        const trEle = createElement('tr');\n        const rowCount = this.colLevels.length;\n        let nth;\n        for (let i = 0; i < rowCount; i++) {\n            const ntr = trEle.cloneNode();\n            const data = { className: [(this.colLevels[i][0] && this.colLevels[i][0].className[0])], type: 'emptyCells' };\n            if (this.parent.activeViewOptions.showWeekNumber && data.className.indexOf(HEADER_CELLS_CLASS) !== -1) {\n                data.className.push(WEEK_NUMBER_CLASS);\n                const weekNo = this.parent.getWeekNumberContent(this.renderDates);\n                data.template = [createElement('span', {\n                        innerHTML: '' + weekNo,\n                        attrs: { title: this.parent.localeObj.getConstant('week') + ' ' + weekNo }\n                    })];\n            }\n            nth = this.createTd(data);\n            this.parent.renderHeaderIndentTemplate(data, nth);\n            ntr.appendChild(nth);\n            tbl.querySelector('tbody').appendChild(ntr);\n        }\n        const ntr = trEle.cloneNode();\n        const appointmentExpandCollapse = createElement('div', {\n            attrs: {\n                'tabindex': '0', 'role': 'list',\n                title: this.parent.localeObj.getConstant('expandAllDaySection'), 'aria-disabled': 'false', 'aria-label': 'Expand section'\n            },\n            className: ALLDAY_APPOINTMENT_SECTION_CLASS + ' ' + APPOINTMENT_ROW_EXPAND_CLASS + ' ' +\n                ICON + ' ' + DISABLE_CLASS\n        });\n        const data = { className: [ALLDAY_CELLS_CLASS], type: 'emptyCells' };\n        nth = this.createTd(data);\n        nth.appendChild(appointmentExpandCollapse);\n        this.parent.renderHeaderIndentTemplate(data, nth);\n        ntr.appendChild(nth);\n        tbl.querySelector('tbody').appendChild(ntr);\n        wrap.appendChild(tbl);\n        return wrap;\n    }\n    renderDatesHeader() {\n        const container = createElement('div', { className: DATE_HEADER_CONTAINER_CLASS });\n        const wrap = createElement('div', { className: DATE_HEADER_WRAP_CLASS });\n        container.appendChild(wrap);\n        const tbl = this.createTableLayout();\n        const trEle = createElement('tr', { className: HEADER_ROW_CLASS });\n        const rowCount = this.colLevels.length;\n        const lastLevel = this.colLevels[rowCount - 1];\n        for (let i = 0; i < rowCount; i++) {\n            const ntr = trEle.cloneNode();\n            const level = this.colLevels[i];\n            for (let j = 0; j < level.length; j++) {\n                ntr.appendChild(this.createTd(level[j]));\n            }\n            tbl.querySelector('tbody').appendChild(ntr);\n        }\n        this.createAllDayRow(tbl, lastLevel);\n        this.createColGroup(tbl, lastLevel);\n        wrap.appendChild(tbl);\n        return container;\n    }\n    createAllDayRow(table, tdData) {\n        const ntr = createElement('tr', { className: ALLDAY_ROW_CLASS });\n        for (let j = 0; j < tdData.length; j++) {\n            const td = extend({}, tdData[j]);\n            td.className = [ALLDAY_CELLS_CLASS];\n            td.type = 'alldayCells';\n            const ntd = this.createTd(td);\n            ntd.setAttribute('role', 'gridcell');\n            ntd.setAttribute('data-date', td.date.getTime().toString());\n            if (!isNullOrUndefined(td.groupIndex)) {\n                ntd.setAttribute('data-group-index', '' + td.groupIndex);\n            }\n            else if (this.parent.uiStateValues.isGroupAdaptive) {\n                ntd.setAttribute('data-group-index', '' + this.parent.uiStateValues.groupIndex);\n            }\n            this.wireCellEvents(ntd);\n            ntr.appendChild(ntd);\n        }\n        table.querySelector('tbody').appendChild(ntr);\n        const thead = createElement('thead');\n        thead.appendChild(this.createEventWrapper('allDay'));\n        prepend([thead], table);\n    }\n    createTd(td) {\n        const tdEle = createElement('td');\n        this.addAttributes(td, tdEle);\n        if (td.date && td.type) {\n            const ele = this.getTdContent(td.date, td.type, td.groupIndex);\n            if (ele && ele.length) {\n                append(ele, tdEle);\n            }\n        }\n        if (!this.parent.isMinMaxDate(resetTime(new Date('' + td.date)))) {\n            addClass([tdEle], DISABLE_DATES);\n        }\n        if (td.type === 'resourceHeader') {\n            this.setResourceHeaderContent(tdEle, td);\n        }\n        if (td.type === 'dateHeader' && td.className.indexOf(HEADER_CELLS_CLASS) >= 0) {\n            tdEle.setAttribute('data-date', td.date.getTime().toString());\n            tdEle.setAttribute('role', 'gridcell');\n            if (!isNullOrUndefined(td.groupIndex)) {\n                tdEle.setAttribute('data-group-index', '' + td.groupIndex);\n            }\n            this.wireMouseEvents(tdEle);\n        }\n        const args = { elementType: td.type, element: tdEle, date: td.date, groupIndex: td.groupIndex };\n        this.parent.trigger(renderCell, args);\n        return tdEle;\n    }\n    wireCellEvents(element) {\n        EventHandler.add(element, 'mousedown', this.parent.workCellAction.cellMouseDown, this.parent.workCellAction);\n        this.wireMouseEvents(element);\n    }\n    wireMouseEvents(element) {\n        EventHandler.add(element, 'click', this.parent.workCellAction.cellClick, this.parent.workCellAction);\n        if (!this.parent.isAdaptive) {\n            EventHandler.add(element, 'dblclick', this.parent.workCellAction.cellDblClick, this.parent.workCellAction);\n        }\n    }\n    renderTimeCells() {\n        const wrap = createElement('div', { className: TIME_CELLS_WRAP_CLASS });\n        const tbl = this.createTableLayout();\n        const trEle = createElement('tr');\n        const handler = (r) => {\n            r.type = r.first ? 'majorSlot' : 'minorSlot';\n            r.className = r.last ? [TIME_CELLS_CLASS, TIME_SLOT_CLASS] : [TIME_SLOT_CLASS];\n            const ntr = trEle.cloneNode();\n            const data = { date: r.date, type: r.type, className: r.className };\n            ntr.appendChild(this.createTd(data));\n            tbl.querySelector('tbody').appendChild(ntr);\n            return r;\n        };\n        this.getTimeSlotRows(handler);\n        wrap.appendChild(tbl);\n        return wrap;\n    }\n    renderContentArea() {\n        const wrap = createElement('div', { className: CONTENT_WRAP_CLASS });\n        const tbl = this.createTableLayout(CONTENT_TABLE_CLASS);\n        this.addAutoHeightClass(tbl);\n        this.renderContentTable(tbl);\n        this.createColGroup(tbl, this.colLevels.slice(-1)[0]);\n        wrap.appendChild(tbl);\n        this.wireCellEvents(tbl.querySelector('tbody'));\n        EventHandler.add(wrap, 'scroll', this.onContentScroll, this);\n        EventHandler.add(wrap, Browser.touchMoveEvent, this.onAdaptiveMove, this);\n        return wrap;\n    }\n    renderContentTable(table) {\n        const tr = createElement('tr', { attrs: { role: 'row' } });\n        const td = createElement('td', { attrs: { role: 'gridcell', 'aria-selected': 'false' } });\n        const tbody = table.querySelector('tbody');\n        const handler = (r) => {\n            const ntr = tr.cloneNode();\n            for (const tdData of this.colLevels[this.colLevels.length - 1]) {\n                const ntd = this.createContentTd(tdData, r, td);\n                ntr.appendChild(ntd);\n            }\n            tbody.appendChild(ntr);\n            return r;\n        };\n        this.getTimeSlotRows(handler);\n        this.renderContentTableHeader(table);\n    }\n    createContentTd(tdData, r, td) {\n        const ntd = td.cloneNode();\n        if (tdData.colSpan) {\n            ntd.setAttribute('colspan', tdData.colSpan.toString());\n        }\n        const clsName = this.getContentTdClass(r);\n        const cellDate = resetTime(tdData.date);\n        if (!this.parent.isMinMaxDate(cellDate)) {\n            clsName.push(DISABLE_DATES);\n        }\n        setTime(cellDate, getDateInMs(r.date));\n        let type = 'workCells';\n        if (tdData.className.indexOf(RESOURCE_PARENT_CLASS) !== -1) {\n            clsName.push(RESOURCE_GROUP_CELLS_CLASS);\n            type = 'resourceGroupCells';\n        }\n        if (this.parent.workHours.highlight && ((this.parent.activeViewOptions.timeScale.enable &&\n            this.isWorkHour(cellDate, tdData.startHour, tdData.endHour, tdData.workDays)) ||\n            (!this.parent.activeViewOptions.timeScale.enable && this.isWorkDay(cellDate, tdData.workDays)))) {\n            clsName.push(WORK_HOURS_CLASS);\n        }\n        addClass([ntd], clsName);\n        if (this.parent.activeViewOptions.cellTemplate) {\n            const args = { date: cellDate, type: type, groupIndex: tdData.groupIndex };\n            const scheduleId = this.parent.element.id + '_';\n            const viewName = this.parent.activeViewOptions.cellTemplateName;\n            const templateId = scheduleId + viewName + 'cellTemplate';\n            const tooltipTemplate = [].slice.call(this.parent.getCellTemplate()(args, this.parent, 'cellTemplate', templateId, false));\n            append(tooltipTemplate, ntd);\n        }\n        ntd.setAttribute('data-date', cellDate.getTime().toString());\n        if (!isNullOrUndefined(tdData.groupIndex) || this.parent.uiStateValues.isGroupAdaptive) {\n            const groupIndex = this.parent.uiStateValues.isGroupAdaptive ? this.parent.uiStateValues.groupIndex :\n                tdData.groupIndex;\n            ntd.setAttribute('data-group-index', '' + groupIndex);\n        }\n        const args = { elementType: type, element: ntd, date: cellDate, groupIndex: tdData.groupIndex };\n        this.parent.trigger(renderCell, args);\n        return ntd;\n    }\n    getContentTdClass(r) {\n        return r.last ? [WORK_CELLS_CLASS] : [WORK_CELLS_CLASS, ALTERNATE_CELLS_CLASS];\n    }\n    renderContentTableHeader(table) {\n        const thead = createElement('thead');\n        thead.appendChild(this.createEventWrapper());\n        if (this.parent.activeViewOptions.timeScale.enable) {\n            thead.appendChild(this.createEventWrapper('timeIndicator'));\n        }\n        prepend([thead], table);\n    }\n    createEventWrapper(type = '') {\n        const tr = createElement('tr');\n        const levels = this.colLevels.slice(-1)[0];\n        for (let i = 0, len = levels.length; i < len; i++) {\n            const col = levels[i];\n            const appointmentWrap = createElement('td', {\n                className: (type === 'allDay') ? ALLDAY_APPOINTMENT_WRAPPER_CLASS : (type === 'timeIndicator') ?\n                    TIMELINE_WRAPPER_CLASS : DAY_WRAPPER_CLASS, attrs: { 'data-date': col.date.getTime().toString() }\n            });\n            if (!isNullOrUndefined(col.groupIndex)) {\n                appointmentWrap.setAttribute('data-group-index', col.groupIndex.toString());\n            }\n            if (type === '') {\n                const innerWrapper = createElement('div', {\n                    id: APPOINTMENT_WRAPPER_CLASS + '-' + i.toString(),\n                    className: APPOINTMENT_WRAPPER_CLASS\n                });\n                appointmentWrap.appendChild(innerWrapper);\n            }\n            tr.appendChild(appointmentWrap);\n        }\n        return tr;\n    }\n    getScrollableElement() {\n        if (this.parent.isAdaptive && !this.isTimelineView()) {\n            return this.element.querySelector('.' + SCROLL_CONTAINER_CLASS);\n        }\n        else {\n            return this.getContentAreaElement();\n        }\n    }\n    getLeftPanelElement() {\n        return this.element.querySelector('.' + TIME_CELLS_WRAP_CLASS);\n    }\n    getEndDateFromStartDate(start) {\n        const msMajorInterval = this.parent.activeViewOptions.timeScale.interval * MS_PER_MINUTE;\n        const msInterval = msMajorInterval / this.parent.activeViewOptions.timeScale.slotCount;\n        const end = new Date(start.getTime());\n        end.setMilliseconds(end.getMilliseconds() + msInterval);\n        return end;\n    }\n    getTimeSlotRows(handler) {\n        const rows = [];\n        const startHour = this.getStartHour();\n        const endHour = this.getEndHour();\n        const msMajorInterval = this.parent.activeViewOptions.timeScale.interval * MS_PER_MINUTE;\n        const msInterval = msMajorInterval / this.parent.activeViewOptions.timeScale.slotCount;\n        let length = Math.round(MS_PER_DAY / msInterval);\n        const msStartHour = startHour.getTime();\n        const msEndHour = endHour.getTime();\n        if (msStartHour !== msEndHour) {\n            const duration = this.parent.activeViewOptions.timeScale.interval / this.parent.activeViewOptions.timeScale.slotCount;\n            length = (Math.abs(msEndHour - msStartHour) / msInterval) - ((new Date(msEndHour).getTimezoneOffset()\n                - new Date(msStartHour).getTimezoneOffset()) / duration);\n        }\n        if (!this.parent.activeViewOptions.timeScale.enable) {\n            length = 1;\n        }\n        const start = this.parent.getStartEndTime(this.parent.workHours.start);\n        const end = this.parent.getStartEndTime(this.parent.workHours.end);\n        for (let i = 0; i < length; i++) {\n            let dt = new Date(msStartHour + (msInterval * i));\n            if (isDaylightSavingTime(dt) || new Date(msStartHour).getTimezoneOffset() !== dt.getTimezoneOffset()) {\n                const timeOffset = new Date(msStartHour).getTimezoneOffset() - dt.getTimezoneOffset();\n                dt = new Date(dt.getTime() - (1000 * 60 * timeOffset));\n            }\n            const majorTickDivider = i % (msMajorInterval / msInterval);\n            const row = {\n                date: new Date('' + dt),\n                startHour: start,\n                endHour: end,\n                first: (majorTickDivider === 0),\n                middle: (majorTickDivider < this.parent.activeViewOptions.timeScale.slotCount - 1),\n                last: (majorTickDivider === this.parent.activeViewOptions.timeScale.slotCount - 1),\n                type: ''\n            };\n            if (handler) {\n                handler(row);\n            }\n            rows.push(row);\n        }\n        return rows;\n    }\n    getAdjustedDate(startTime) {\n        if (!this.parent.activeViewOptions.timeScale.enable) {\n            return new Date(startTime.setHours(0, 0, 0, 0));\n        }\n        else {\n            const timeSlots = this.getTimeSlotRows();\n            const startDate = new Date(new Date(timeSlots[0].date.getTime()).\n                setHours(startTime.getHours(), startTime.getMinutes(), startTime.getMilliseconds()));\n            for (let i = 0; i < timeSlots.length; i++) {\n                if (timeSlots[i].date.getTime() > startDate.getTime()) {\n                    startTime.setHours(timeSlots[i - 1].date.getHours(), timeSlots[i - 1].date.getMinutes(), timeSlots[i - 1].date.getMilliseconds());\n                    return new Date(startTime);\n                }\n            }\n        }\n        return null;\n    }\n    destroy() {\n        if (!this.parent || this.parent && this.parent.isDestroyed) {\n            return;\n        }\n        this.clearCurrentTimeIndicatorTimer();\n        if (this.element) {\n            if (this.appointment) {\n                this.appointment.destroy();\n                this.appointment = null;\n            }\n            const contentScrollableEle = this.getContentAreaElement();\n            if (contentScrollableEle) {\n                EventHandler.remove(contentScrollableEle, 'scroll', this.onContentScroll);\n                EventHandler.remove(contentScrollableEle, Browser.touchMoveEvent, this.onAdaptiveMove);\n            }\n            if (this.parent.resourceBase) {\n                this.parent.resourceBase.destroy();\n            }\n            if (this.parent.scheduleTouchModule) {\n                this.parent.scheduleTouchModule.resetValues();\n            }\n            super.destroy();\n        }\n    }\n}\n\n/**\n * day view\n */\nclass Day extends VerticalView {\n    /**\n     * Constructor for day view\n     *\n     * @param {Schedule} parent Accepts the schedule instance\n     */\n    constructor(parent) {\n        super(parent);\n        this.viewClass = 'e-day-view';\n    }\n    /**\n     * Get module name.\n     *\n     * @returns {string} Returns the module name.\n     */\n    getModuleName() {\n        return 'day';\n    }\n}\n\n/**\n * week view\n */\nclass Week extends VerticalView {\n    /**\n     * Constructor for week view\n     *\n     * @param {Schedule} parent Accepts the schedule instance\n     */\n    constructor(parent) {\n        super(parent);\n        this.viewClass = 'e-week-view';\n    }\n    startDate() {\n        return this.getViewStartDate();\n    }\n    endDate() {\n        return this.getViewEndDate();\n    }\n    /**\n     * Get module name.\n     *\n     * @returns {string} Returns the module name.\n     */\n    getModuleName() {\n        return 'week';\n    }\n}\n\n/**\n * work week view\n */\nclass WorkWeek extends VerticalView {\n    /**\n     * Constructor for work week view\n     *\n     * @param {Schedule} parent Accepts the schedule instance\n     */\n    constructor(parent) {\n        super(parent);\n        this.viewClass = 'e-work-week-view';\n    }\n    startDate() {\n        return this.getViewStartDate();\n    }\n    endDate() {\n        return this.getViewEndDate();\n    }\n    /**\n     * Get module name.\n     *\n     * @returns {string} Returns the module name.\n     */\n    getModuleName() {\n        return 'workWeek';\n    }\n}\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\n/**\n * month view\n */\nclass Month extends ViewBase {\n    constructor(parent) {\n        super(parent);\n        this.dayNameFormat = 'wide';\n        this.viewClass = 'e-month-view';\n        this.isInverseTableSelect = false;\n        this.monthEvent = null;\n        this.monthDates = {};\n    }\n    addEventListener() {\n        this.parent.on(scrollUiUpdate, this.onScrollUIUpdate, this);\n        this.parent.on(dataReady, this.onDataReady, this);\n        this.parent.on(cellClick, this.onCellClick, this);\n    }\n    removeEventListener() {\n        if (this.parent) {\n            this.parent.off(scrollUiUpdate, this.onScrollUIUpdate);\n            this.parent.off(dataReady, this.onDataReady);\n            this.parent.off(cellClick, this.onCellClick);\n        }\n    }\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    onDataReady(args) {\n        this.monthEvent = new MonthEvent(this.parent);\n        this.monthEvent.renderAppointments();\n        this.parent.notify(eventsLoaded, {});\n    }\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    onCellClick(event) { }\n    onContentScroll(e) {\n        this.parent.removeNewEventElement();\n        this.parent.notify(virtualScroll, e);\n        this.scrollTopPanel(e.target);\n        this.scrollLeftPanel(e.target);\n        this.parent.uiStateValues.top = e.target.scrollTop;\n        this.parent.uiStateValues.left = e.target.scrollLeft;\n        this.setPersistence();\n    }\n    scrollLeftPanel(target) {\n        const leftPanel = this.getLeftPanelElement();\n        if (leftPanel) {\n            leftPanel.scrollTop = target.scrollTop;\n        }\n    }\n    getLeftPanelElement() {\n        return this.element.querySelector('.' + WEEK_NUMBER_WRAPPER_CLASS);\n    }\n    onScrollUIUpdate(args) {\n        const headerHeight = this.getHeaderBarHeight();\n        const header = this.getDatesHeaderElement();\n        const content = this.getContentAreaElement();\n        const height = this.parent.element.offsetHeight - headerHeight - header.offsetHeight;\n        const leftPanel = this.getLeftPanelElement();\n        if (this.parent.height !== 'auto') {\n            this.setContentHeight(content, leftPanel, height);\n        }\n        const scrollBarWidth = getScrollBarWidth();\n        header.firstElementChild.style[args.cssProperties.rtlBorder] = '';\n        header.style[args.cssProperties.rtlPadding] = '';\n        if (content.offsetWidth - content.clientWidth > 0) {\n            header.firstElementChild.style[args.cssProperties.border] = scrollBarWidth > 0 ? '1px' : '0px';\n            header.style[args.cssProperties.padding] = scrollBarWidth > 0 ? scrollBarWidth - 1 + 'px' : '0px';\n        }\n        else {\n            header.firstElementChild.style[args.cssProperties.border] = '';\n            header.style[args.cssProperties.padding] = '';\n        }\n        this.setColWidth(content);\n        if (args.scrollPosition || !args.isPreventScrollUpdate && this.parent.currentView === 'TimelineMonth') {\n            const top = this.parent.currentView === 'TimelineMonth' ? this.parent.uiStateValues.top : args.scrollPosition.top;\n            if (leftPanel) {\n                leftPanel.scrollTop = top;\n            }\n            content.scrollTop = top;\n            if (this.parent.uiStateValues.isInitial) {\n                this.scrollToSelectedDate();\n                this.parent.uiStateValues.isInitial = false;\n            }\n            else {\n                content.scrollLeft = this.parent.currentView === 'TimelineMonth' ? this.parent.uiStateValues.left :\n                    args.scrollPosition.left;\n            }\n        }\n        else {\n            this.scrollToSelectedDate();\n        }\n        this.retainScrollPosition();\n    }\n    scrollToSelectedDate() {\n        const headerCell = this.element.querySelector('.' + HEADER_CELLS_CLASS + '[data-date=\"'\n            + this.parent.selectedDate.getTime().toString() + '\"]');\n        const content = this.getContentAreaElement();\n        if (!isNullOrUndefined(headerCell)) {\n            content.scrollLeft = !this.parent.enableRtl ?\n                headerCell.offsetLeft : -(this.parent.getContentTable().offsetWidth - headerCell.offsetLeft - headerCell.offsetWidth);\n        }\n        else {\n            content.scrollLeft = 0;\n        }\n        if (content.scrollLeft === 0 && this.parent.uiStateValues.isInitial) {\n            this.parent.uiStateValues.left = 0;\n        }\n    }\n    setContentHeight(content, leftPanelElement, height) {\n        content.style.height = 'auto';\n        if (this.parent.currentView === 'Month') {\n            content.style.height = formatUnit(height);\n        }\n        if (leftPanelElement) {\n            if (this.parent.currentView === 'MonthAgenda') {\n                height = this.element.querySelector('.' + CONTENT_TABLE_CLASS).offsetHeight;\n            }\n            leftPanelElement.style.height = 'auto';\n            leftPanelElement.style.height = formatUnit(height - this.getScrollXIndent(content));\n        }\n    }\n    generateColumnLevels() {\n        let colLevels = [];\n        const level = this.getDateSlots(this.renderDates, this.parent.activeViewOptions.workDays);\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            colLevels = this.parent.resourceBase.generateResourceLevels(level);\n            if (this.parent.currentView === 'MonthAgenda') {\n                colLevels = [level];\n            }\n            if (this.parent.uiStateValues.isGroupAdaptive && this.parent.resourceBase.lastResourceLevel.length > 0) {\n                const resourceLevel = this.parent.resourceBase.lastResourceLevel[this.parent.uiStateValues.groupIndex];\n                colLevels = [this.getDateSlots(resourceLevel.renderDates, resourceLevel.workDays)];\n            }\n        }\n        else {\n            colLevels.push(level);\n        }\n        this.colLevels = colLevels;\n        return colLevels;\n    }\n    getDateSlots(renderDates, workDays) {\n        const count = this.parent.activeViewOptions.showWeekend ? WEEK_LENGTH : workDays.length;\n        const dateSlots = [];\n        const isCurrentMonth = this.isCurrentMonth(this.parent.selectedDate);\n        for (let col = 0; col < count; col++) {\n            const classList$$1 = [HEADER_CELLS_CLASS];\n            const currentDateIndex = renderDates.slice(0, count).map((date) => date.getDay());\n            if (isCurrentMonth && currentDateIndex.indexOf(this.parent.getCurrentTime().getDay()) === col) {\n                classList$$1.push(CURRENT_DAY_CLASS);\n            }\n            dateSlots.push({ date: renderDates[col], type: 'monthDay', className: classList$$1, colSpan: 1, workDays: workDays });\n        }\n        return dateSlots;\n    }\n    getDayNameFormat() {\n        if (this.parent.isAdaptive || this.parent.activeViewOptions.group.resources.length > 0) {\n            return 'abbreviated';\n        }\n        return 'wide';\n    }\n    renderLayout(type) {\n        this.dayNameFormat = this.getDayNameFormat();\n        this.setPanel(createElement('div', { className: TABLE_WRAP_CLASS }));\n        const clsList = [this.viewClass];\n        clsList.push(type);\n        if (this.parent.activeViewOptions.group.byDate) {\n            clsList.push('e-by-date');\n        }\n        if (this.parent.activeViewOptions.allowVirtualScrolling) {\n            clsList.push(VIRTUAL_SCROLL_CLASS);\n        }\n        if (this.parent.rowAutoHeight && this.parent.eventSettings.ignoreWhitespace) {\n            clsList.push(IGNORE_WHITESPACE);\n        }\n        addClass([this.element], clsList);\n        this.renderPanel(type);\n        this.element.appendChild(this.createTableLayout(OUTER_TABLE_CLASS));\n        this.element.querySelector('table').setAttribute('role', 'presentation');\n        this.colLevels = this.generateColumnLevels();\n        this.renderHeader();\n        this.renderContent();\n        const target = (this.parent.currentView === 'MonthAgenda') ? this.parent.activeView.getPanel() : this.parent.element;\n        if (this.parent.uiStateValues.isGroupAdaptive && !target.querySelector('.' + RESOURCE_TOOLBAR_CONTAINER)) {\n            this.renderResourceMobileLayout();\n        }\n        this.parent.notify(contentReady, {});\n        if (this.parent.uiStateValues.isCustomMonth) {\n            this.parent.uiStateValues.isCustomMonth = false;\n        }\n    }\n    refreshHeader() {\n        remove(this.element.querySelector('tbody tr'));\n        this.renderHeader();\n        this.parent.notify(contentReady, {});\n    }\n    wireCellEvents(element) {\n        EventHandler.add(element, 'mousedown', this.parent.workCellAction.cellMouseDown, this.parent.workCellAction);\n        EventHandler.add(element, 'click', this.parent.workCellAction.cellClick, this.parent.workCellAction);\n        if (!this.parent.isAdaptive) {\n            EventHandler.add(element, 'dblclick', this.parent.workCellAction.cellDblClick, this.parent.workCellAction);\n        }\n    }\n    renderHeader() {\n        const tr = createElement('tr');\n        this.renderLeftIndent(tr);\n        const dateTd = createElement('td');\n        dateTd.appendChild(this.renderDatesHeader());\n        tr.appendChild(dateTd);\n        prepend([tr], this.element.querySelector('tbody'));\n    }\n    renderLeftIndent(tr) {\n        if (this.parent.activeViewOptions.showWeekNumber) {\n            tr.appendChild(createElement('td', { className: 'e-left-indent' }));\n        }\n    }\n    renderContent() {\n        const tr = createElement('tr');\n        if (this.parent.activeViewOptions.showWeekNumber) {\n            tr.appendChild(this.renderWeekNumberContent());\n        }\n        const workTd = createElement('td');\n        const wrap = createElement('div', { className: CONTENT_WRAP_CLASS });\n        const contentArea = this.renderContentArea();\n        if (this.parent.currentView === 'Month') {\n            wrap.appendChild(contentArea);\n        }\n        else {\n            const monthAgendaWrapper = createElement('div', { className: TABLE_CONTAINER_CLASS });\n            monthAgendaWrapper.appendChild(contentArea);\n            wrap.appendChild(monthAgendaWrapper);\n        }\n        EventHandler.add(wrap, 'scroll', this.onContentScroll, this);\n        workTd.appendChild(wrap);\n        tr.appendChild(workTd);\n        this.element.querySelector('tbody').appendChild(tr);\n        this.renderAppointmentContainer();\n    }\n    renderWeekNumberContent() {\n        const dateCol = this.renderDates.map((date) => new Date(+date));\n        const td = createElement('td');\n        const contentWrapper = createElement('div', { className: WEEK_NUMBER_WRAPPER_CLASS });\n        td.appendChild(contentWrapper);\n        const contentWrapTable = this.createTableLayout();\n        contentWrapper.appendChild(contentWrapTable);\n        const noOfDays = this.parent.activeViewOptions.showWeekend ? WEEK_LENGTH :\n            this.parent.activeViewOptions.workDays.length;\n        for (let i = 0, length = (this.renderDates.length / noOfDays); i < length; i++) {\n            const dates = dateCol.splice(0, noOfDays);\n            const weekNumber = this.parent.getWeekNumberContent(dates);\n            contentWrapTable.querySelector('tbody').appendChild(this.createWeekNumberElement(weekNumber));\n        }\n        return td;\n    }\n    renderAppointmentContainer() {\n        //Here needs to render mobile view appointment details on selected date\n    }\n    renderDatesHeader() {\n        const container = createElement('div', { className: DATE_HEADER_CONTAINER_CLASS });\n        const wrap = createElement('div', { className: DATE_HEADER_WRAP_CLASS });\n        container.appendChild(wrap);\n        const table = this.createTableLayout();\n        this.createColGroup(table, this.colLevels[this.colLevels.length - 1]);\n        const trEle = createElement('tr');\n        for (let i = 0; i < this.colLevels.length; i++) {\n            const level = this.colLevels[i];\n            const ntr = trEle.cloneNode();\n            for (let j = 0; j < level.length; j++) {\n                const td = level[j];\n                ntr.appendChild(this.createHeaderCell(td));\n            }\n            table.querySelector('tbody').appendChild(ntr);\n        }\n        wrap.appendChild(table);\n        return container;\n    }\n    createHeaderCell(td) {\n        const tdEle = createElement('td');\n        this.addAttributes(td, tdEle);\n        if (td.type === 'monthDay') {\n            const ele = createElement('span', { innerHTML: capitalizeFirstWord(this.parent.getDayNames(this.dayNameFormat)[td.date.getDay()], 'single') });\n            tdEle.appendChild(ele);\n        }\n        if (td.type === 'resourceHeader') {\n            this.setResourceHeaderContent(tdEle, td);\n        }\n        if (td.type === 'dateHeader') {\n            addClass([tdEle], DATE_HEADER_CLASS);\n            tdEle.setAttribute('data-date', td.date.getTime().toString());\n            if (this.parent.activeViewOptions.dateHeaderTemplate) {\n                const cellArgs = { date: td.date, type: td.type };\n                const elementId = this.parent.element.id + '_';\n                const viewName = this.parent.activeViewOptions.dateHeaderTemplateName;\n                const templateId = elementId + viewName + 'dateHeaderTemplate';\n                const dateTemplate = [].slice.call(this.parent.getDateHeaderTemplate()(cellArgs, this.parent, 'dateHeaderTemplate', templateId, false));\n                if (dateTemplate && dateTemplate.length) {\n                    append(dateTemplate, tdEle);\n                }\n            }\n            else {\n                const ele = createElement('span', { className: NAVIGATE_CLASS });\n                const skeleton = 'full';\n                const title = this.parent.globalize.formatDate(td.date, { skeleton: skeleton, calendar: this.parent.getCalendarMode() });\n                ele.setAttribute('title', capitalizeFirstWord(title, 'multiple'));\n                const innerText = (this.parent.calendarUtil.isMonthStart(td.date) && !this.isCurrentDate(td.date) && !this.parent.isAdaptive) ?\n                    this.parent.globalize.formatDate(td.date, { format: 'MMM d', calendar: this.parent.getCalendarMode() }) :\n                    this.parent.globalize.formatDate(td.date, { skeleton: 'd', calendar: this.parent.getCalendarMode() });\n                ele.innerHTML = capitalizeFirstWord(innerText, 'single');\n                tdEle.appendChild(ele);\n            }\n            this.wireCellEvents(tdEle);\n        }\n        const args = { elementType: td.type, element: tdEle, date: td.date, groupIndex: td.groupIndex };\n        this.parent.trigger(renderCell, args);\n        return tdEle;\n    }\n    getContentSlots() {\n        if (!(this.colLevels[this.colLevels.length - 1] && this.colLevels[this.colLevels.length - 1][0])) {\n            return [];\n        }\n        const slotDatas = [];\n        const prepareSlots = (rowIndex, renderDate, resData, classList$$1) => {\n            const data = {\n                date: new Date(+renderDate), groupIndex: resData.groupIndex, workDays: resData.workDays,\n                type: 'monthCells', className: classList$$1 || [WORK_CELLS_CLASS]\n            };\n            if (!slotDatas[rowIndex]) {\n                slotDatas[rowIndex] = [];\n            }\n            slotDatas[rowIndex].push(data);\n        };\n        const includeResource = this.parent.currentView !== 'MonthAgenda' &&\n            this.parent.activeViewOptions.group.resources.length > 0;\n        if (includeResource && !this.parent.uiStateValues.isGroupAdaptive && !this.parent.activeViewOptions.group.byDate) {\n            for (const res of this.colLevels[this.colLevels.length - 2]) {\n                const dates = res.renderDates.map((date) => new Date(+date));\n                const count = this.parent.activeViewOptions.showWeekend ? WEEK_LENGTH : res.workDays.length;\n                for (let i = 0; i < (res.renderDates.length / count); i++) {\n                    const colDates = dates.splice(0, count);\n                    for (const colDate of colDates) {\n                        prepareSlots(i, colDate, res);\n                    }\n                }\n            }\n        }\n        else {\n            const dates = this.renderDates.map((date) => new Date(+date));\n            const count = this.parent.activeViewOptions.showWeekend ? WEEK_LENGTH :\n                this.parent.activeViewOptions.workDays.length;\n            for (let i = 0; i < (this.renderDates.length / count); i++) {\n                const colDates = dates.splice(0, count);\n                for (const colDate of colDates) {\n                    if (includeResource) {\n                        const lastRow = this.colLevels[(this.colLevels.length - 1)];\n                        const resourcesTd = lastRow.slice(0, lastRow.length / count);\n                        for (let resIndex = 0; resIndex < resourcesTd.length; resIndex++) {\n                            let clsList;\n                            if (resIndex !== 0) {\n                                clsList = [WORK_CELLS_CLASS, DISABLE_DATE];\n                            }\n                            prepareSlots(i, colDate, resourcesTd[resIndex], clsList);\n                        }\n                    }\n                    else {\n                        prepareSlots(i, colDate, this.colLevels[this.colLevels.length - 1][0]);\n                    }\n                }\n            }\n        }\n        return slotDatas;\n    }\n    updateClassList(data) {\n        if (!this.isCustomMonth() && this.isOtherMonth(data.date)) {\n            data.className.push(OTHERMONTH_CLASS);\n        }\n        if (!this.parent.isMinMaxDate(data.date)) {\n            data.className.push(DISABLE_DATES);\n        }\n        if (this.parent.currentView === 'MonthAgenda' && this.parent.isSelectedDate(data.date)) {\n            data.className.push(SELECTED_CELL_CLASS);\n        }\n    }\n    isOtherMonth(date) {\n        return date.getTime() < this.monthDates.start.getTime() || date.getTime() > this.monthDates.end.getTime();\n    }\n    renderContentArea() {\n        const tbl = this.createTableLayout(CONTENT_TABLE_CLASS);\n        this.addAutoHeightClass(tbl);\n        if (this.parent.currentView === 'TimelineMonth') {\n            this.createColGroup(tbl, this.colLevels[this.colLevels.length - 1]);\n        }\n        const monthDate = new Date(this.parent.selectedDate.getTime());\n        this.monthDates = {\n            start: this.parent.calendarUtil.firstDateOfMonth(monthDate),\n            end: this.parent.calendarUtil.lastDateOfMonth(addMonths(monthDate, this.parent.activeViewOptions.interval - 1))\n        };\n        const tBody = tbl.querySelector('tbody');\n        append(this.getContentRows(), tBody);\n        this.wireCellEvents(tBody);\n        return tbl;\n    }\n    getContentRows() {\n        const trows = [];\n        const tr = createElement('tr', { attrs: { role: 'row' } });\n        const td = createElement('td', { attrs: { role: 'gridcell', 'aria-selected': 'false' } });\n        const slotDatas = this.getContentSlots();\n        for (let row = 0; row < slotDatas.length; row++) {\n            const ntr = tr.cloneNode();\n            for (let col = 0; col < slotDatas[row].length; col++) {\n                const ntd = this.createContentTd(slotDatas[row][col], td);\n                ntr.appendChild(ntd);\n            }\n            trows.push(ntr);\n        }\n        return trows;\n    }\n    createContentTd(data, td) {\n        const ntd = td.cloneNode();\n        if (data.colSpan) {\n            ntd.setAttribute('colspan', data.colSpan.toString());\n        }\n        this.updateClassList(data);\n        let type = data.type;\n        if (data.className.indexOf(RESOURCE_PARENT_CLASS) !== -1) {\n            data.className.push(RESOURCE_GROUP_CELLS_CLASS);\n            type = 'resourceGroupCells';\n        }\n        if (this.parent.workHours.highlight && this.isWorkDay(data.date, data.workDays)) {\n            data.className.push(WORKDAY_CLASS);\n        }\n        if (this.isCurrentDate(data.date)) {\n            data.className.push(CURRENTDATE_CLASS);\n        }\n        addClass([ntd], data.className);\n        ntd.setAttribute('data-date', data.date.getTime().toString());\n        if (!isNullOrUndefined(data.groupIndex) || this.parent.uiStateValues.isGroupAdaptive) {\n            const groupIndex = this.parent.uiStateValues.isGroupAdaptive ? this.parent.uiStateValues.groupIndex :\n                data.groupIndex;\n            ntd.setAttribute('data-group-index', '' + groupIndex);\n        }\n        this.renderDateHeaderElement(data, ntd);\n        if (this.parent.activeViewOptions.cellTemplate) {\n            const args = { date: data.date, type: type, groupIndex: data.groupIndex };\n            const scheduleId = this.parent.element.id + '_';\n            const viewName = this.parent.activeViewOptions.cellTemplateName;\n            const templateId = scheduleId + viewName + 'cellTemplate';\n            const cellTemplate = [].slice.call(this.parent.getCellTemplate()(args, this.parent, 'cellTemplate', templateId, false));\n            append(cellTemplate, ntd);\n        }\n        const args = { elementType: type, element: ntd, date: data.date, groupIndex: data.groupIndex };\n        this.parent.trigger(renderCell, args);\n        return ntd;\n    }\n    renderDateHeaderElement(data, ntd) {\n        if (this.parent.currentView === 'TimelineMonth') {\n            return;\n        }\n        const dateHeader = createElement('div', { className: DATE_HEADER_CLASS });\n        if (this.parent.activeViewOptions.cellHeaderTemplate) {\n            const args = { date: data.date, type: data.type, groupIndex: data.groupIndex };\n            const scheduleId = this.parent.element.id + '_';\n            const viewName = this.parent.activeViewOptions.cellHeaderTemplateName;\n            const templateId = scheduleId + viewName + 'cellHeaderTemplate';\n            const cellHeaderTemplate = [].slice.call(this.parent.getCellHeaderTemplate()(args, this.parent, 'cellHeaderTemplate', templateId, false));\n            append(cellHeaderTemplate, dateHeader);\n        }\n        else {\n            const innerText = (this.parent.calendarUtil.isMonthStart(data.date) && !this.isCurrentDate(data.date) && !this.parent.isAdaptive) ?\n                this.parent.globalize.formatDate(data.date, { format: 'MMM d', calendar: this.parent.getCalendarMode() }) :\n                this.parent.globalize.formatDate(data.date, { skeleton: 'd', calendar: this.parent.getCalendarMode() });\n            dateHeader.innerHTML = capitalizeFirstWord(innerText, 'single');\n        }\n        ntd.appendChild(dateHeader);\n        if (this.getModuleName() === 'month') {\n            addClass([dateHeader], NAVIGATE_CLASS);\n            const skeleton = 'full';\n            const announcementText = this.parent.globalize.formatDate(data.date, { skeleton: skeleton, calendar: this.parent.getCalendarMode() });\n            dateHeader.setAttribute('aria-label', announcementText);\n        }\n    }\n    getMonthStart(currentDate) {\n        const useDisplayDate = this.parent.currentView === 'Month' && !isNullOrUndefined(this.parent.activeViewOptions.displayDate) && (this.parent.uiStateValues.isCustomMonth || this.isCustomRange());\n        const date = useDisplayDate ? this.parent.activeViewOptions.displayDate : !(this.parent.uiStateValues.isCustomMonth ||\n            this.isCustomRange()) && this.isCustomMonth() ? currentDate : this.parent.calendarUtil.firstDateOfMonth(currentDate);\n        const monthStart = getWeekFirstDate(date, this.parent.activeViewOptions.firstDayOfWeek);\n        return new Date(monthStart.getFullYear(), monthStart.getMonth(), monthStart.getDate());\n    }\n    getMonthEnd(currentDate) {\n        if (this.isCustomMonth()) {\n            const start = this.getMonthStart(currentDate);\n            const numberOfDays = WEEK_LENGTH * (this.parent.activeViewOptions.numberOfWeeks > 0 ?\n                this.parent.activeViewOptions.numberOfWeeks : DEFAULT_WEEKS);\n            return addDays(start, (numberOfDays - 1));\n        }\n        else {\n            const endDate = addMonths(currentDate, this.parent.activeViewOptions.interval - 1);\n            const lastWeekOfMonth = getWeekFirstDate(this.parent.calendarUtil.lastDateOfMonth(endDate), this.parent.activeViewOptions.firstDayOfWeek);\n            return addDays(lastWeekOfMonth, WEEK_LENGTH - 1);\n        }\n    }\n    isCustomRange() {\n        const dates = this.parent.getCurrentViewDates();\n        if (dates && dates.length > 0) {\n            const selectedTime = resetTime(this.parent.selectedDate).getTime();\n            const weekFirstDate = getWeekFirstDate(dates[dates.length - 1], this.parent.activeViewOptions.firstDayOfWeek);\n            return !(selectedTime >= getWeekFirstDate(dates[0], this.parent.activeViewOptions.firstDayOfWeek).getTime() &&\n                selectedTime <= addDays(weekFirstDate, 6).getTime());\n        }\n        return false;\n    }\n    getRenderDates(workDays) {\n        const renderDates = [];\n        const currentDate = resetTime(this.parent.selectedDate);\n        let start = this.getMonthStart(currentDate);\n        const monthEnd = this.getMonthEnd(currentDate);\n        do {\n            if (this.parent.activeViewOptions.showWeekend) {\n                renderDates.push(start);\n            }\n            else {\n                if (this.isWorkDay(start, workDays)) {\n                    renderDates.push(start);\n                }\n            }\n            start = addDays(start, 1);\n            if (start.getHours() > 0) {\n                start = resetTime(start);\n            }\n        } while (start.getTime() <= monthEnd.getTime());\n        if (!workDays) {\n            this.renderDates = renderDates;\n        }\n        if (this.parent.headerModule) {\n            this.parent.headerModule.previousNextIconHandler();\n        }\n        return renderDates;\n    }\n    getNextPreviousDate(type) {\n        if (this.isCustomMonth()) {\n            const dates = this.parent.getCurrentViewDates();\n            const date = getWeekFirstDate(type === 'next' ? dates[dates.length - 1]\n                : dates[0], this.parent.activeViewOptions.firstDayOfWeek);\n            return addDays(date, type === 'next' ? WEEK_LENGTH : -(this.parent.activeViewOptions.numberOfWeeks > 0 ?\n                this.parent.activeViewOptions.numberOfWeeks : DEFAULT_WEEKS) * WEEK_LENGTH);\n        }\n        else {\n            return addMonths(this.parent.selectedDate, ((type === 'next' ? 1 : -1) * this.parent.activeViewOptions.interval));\n        }\n    }\n    getStartDate() {\n        return this.getMonthStart(this.parent.selectedDate);\n    }\n    getEndDate() {\n        return this.getMonthEnd(this.parent.selectedDate);\n    }\n    getEndDateFromStartDate(start) {\n        return addDays(new Date(start.getTime()), 1);\n    }\n    getDateRangeText() {\n        if (this.parent.isAdaptive || isNullOrUndefined(this.parent.activeViewOptions.dateFormat)) {\n            let startDate = this.parent.selectedDate;\n            let endDate;\n            let updateCustomRange = false;\n            if (this.isCustomMonth()) {\n                const dates = this.parent.getCurrentViewDates();\n                updateCustomRange = dates[0].getMonth() !== dates[dates.length - 1].getMonth() ||\n                    dates[0].getFullYear() !== dates[dates.length - 1].getFullYear();\n                if (updateCustomRange) {\n                    startDate = dates[0];\n                    endDate = dates[dates.length - 1];\n                }\n            }\n            const isUpdateDateRange = (this.parent.currentView !== 'Month' || !this.isCustomMonth());\n            if (this.parent.activeViewOptions.interval > 1 && isUpdateDateRange || updateCustomRange) {\n                endDate = endDate ? endDate : addMonths(lastDateOfMonth(startDate), this.parent.activeViewOptions.interval - 1);\n                if (startDate.getFullYear() === endDate.getFullYear()) {\n                    const monthNames = (this.parent.globalize.formatDate(startDate, { format: 'MMMM', calendar: this.parent.getCalendarMode() })) + ' - ' +\n                        (this.parent.globalize.formatDate(endDate, { format: 'MMMM ', calendar: this.parent.getCalendarMode() })) +\n                        this.parent.globalize.formatDate(endDate, { skeleton: 'y', calendar: this.parent.getCalendarMode() });\n                    return capitalizeFirstWord(monthNames, 'single');\n                }\n                const text = (this.parent.globalize.formatDate(startDate, { format: 'MMMM', calendar: this.parent.getCalendarMode() })) + ' ' +\n                    startDate.getFullYear() + ' - ' +\n                    this.parent.globalize.formatDate(endDate, { format: 'MMMM ', calendar: this.parent.getCalendarMode() }) +\n                    this.parent.globalize.formatDate(endDate, { skeleton: 'y', calendar: this.parent.getCalendarMode() });\n                return capitalizeFirstWord(text, 'single');\n            }\n            const format = (this.parent.activeViewOptions.dateFormat) ? this.parent.activeViewOptions.dateFormat : 'MMMM y';\n            return capitalizeFirstWord(this.parent.globalize.formatDate(startDate, { format: format, calendar: this.parent.getCalendarMode() }), 'single');\n        }\n        return this.formatDateRange(this.parent.selectedDate);\n    }\n    getLabelText(view) {\n        return this.parent.localeObj.getConstant(view) + ' of ' + capitalizeFirstWord(this.parent.globalize.formatDate(this.parent.selectedDate, { format: 'MMMM y', calendar: this.parent.getCalendarMode() }), 'single');\n    }\n    createWeekNumberElement(text) {\n        const tr = createElement('tr');\n        const td = createElement('td', {\n            className: WEEK_NUMBER_CLASS,\n            attrs: { 'title': (text ? this.parent.localeObj.getConstant('week') + ' ' + text : '') },\n            innerHTML: (text || '')\n        });\n        tr.appendChild(td);\n        const args = { elementType: 'weekNumberCell', element: td };\n        this.parent.trigger(renderCell, args);\n        return tr;\n    }\n    unWireEvents() {\n        const contentScrollableEle = this.element.querySelector('.' + CONTENT_WRAP_CLASS);\n        if (contentScrollableEle) {\n            EventHandler.remove(contentScrollableEle, 'scroll', this.onContentScroll);\n        }\n    }\n    isCustomMonth() {\n        return this.parent.currentView === 'Month' &&\n            (!isNullOrUndefined(this.parent.activeViewOptions.displayDate) || this.parent.activeViewOptions.numberOfWeeks > 0);\n    }\n    getModuleName() {\n        return 'month';\n    }\n    destroy() {\n        if (!this.parent || this.parent && this.parent.isDestroyed) {\n            return;\n        }\n        if (this.element) {\n            if (this.monthEvent) {\n                this.monthEvent.destroy();\n                this.monthEvent = null;\n            }\n            this.unWireEvents();\n            if (this.parent.resourceBase) {\n                this.parent.resourceBase.destroy();\n            }\n            if (this.parent.scheduleTouchModule) {\n                this.parent.scheduleTouchModule.resetValues();\n            }\n            super.destroy();\n        }\n    }\n}\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\n/**\n * year view\n */\nclass Year extends ViewBase {\n    constructor(parent) {\n        super(parent);\n        this.viewClass = 'e-year-view';\n        this.isInverseTableSelect = false;\n        this.yearEventModule = null;\n    }\n    getModuleName() {\n        return 'year';\n    }\n    renderLayout(className) {\n        if (this.parent.resourceBase) {\n            this.parent.resourceBase.generateResourceLevels([{ renderDates: this.parent.activeView.renderDates }]);\n        }\n        this.setPanel(createElement('div', { className: TABLE_WRAP_CLASS }));\n        const viewTypeClass = this.parent.activeViewOptions.orientation === 'Horizontal' ? 'e-horizontal' : 'e-vertical';\n        addClass([this.element], [this.viewClass, viewTypeClass, className]);\n        this.renderPanel(className);\n        if (this.parent.activeViewOptions.allowVirtualScrolling) {\n            addClass([this.element], [VIRTUAL_SCROLL_CLASS]);\n        }\n        const calendarTable = this.createTableLayout(OUTER_TABLE_CLASS);\n        this.element.appendChild(calendarTable);\n        this.element.querySelector('table').setAttribute('role', 'presentation');\n        const calendarTBody = calendarTable.querySelector('tbody');\n        this.rowCount = this.getRowColumnCount('row');\n        this.columnCount = this.getRowColumnCount('column');\n        this.renderHeader(calendarTBody);\n        this.renderContent(calendarTBody);\n        if (this.parent.currentView !== 'Year' && this.parent.uiStateValues.isGroupAdaptive) {\n            this.generateColumnLevels();\n            this.renderResourceMobileLayout();\n        }\n        this.wireEvents(this.element.querySelector('.' + CONTENT_WRAP_CLASS), 'scroll');\n        this.parent.notify(contentReady, {});\n    }\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    renderHeader(headerWrapper) { }\n    renderContent(content) {\n        const tr = createElement('tr');\n        content.appendChild(tr);\n        const td = createElement('td');\n        tr.appendChild(td);\n        this.element.querySelector('tbody').appendChild(tr);\n        const contentWrapper = createElement('div', { className: CONTENT_WRAP_CLASS });\n        td.appendChild(contentWrapper);\n        const calendarTable = this.createTableLayout('e-calendar-table');\n        contentWrapper.appendChild(calendarTable);\n        const cTr = createElement('tr');\n        calendarTable.querySelector('tbody').appendChild(cTr);\n        const cTd = createElement('td');\n        cTr.appendChild(cTd);\n        const calendarWrapper = createElement('div', { className: 'e-calendar-wrapper' });\n        cTd.appendChild(calendarWrapper);\n        const months = this.getMonths();\n        for (const month of months) {\n            const currentMonth = new Date(this.parent.selectedDate.getFullYear(), month, 1);\n            const calendarElement = createElement('div', {\n                className: 'e-month-calendar e-calendar',\n                attrs: { 'data-role': 'calendar' }\n            });\n            calendarElement.appendChild(this.renderCalendarHeader(currentMonth));\n            calendarElement.appendChild(this.renderCalendarContent(currentMonth));\n            calendarWrapper.appendChild(calendarElement);\n        }\n    }\n    renderCalendarHeader(currentDate) {\n        const headerWrapper = createElement('div', { className: 'e-header e-month' });\n        const headerContent = createElement('div', { className: 'e-day e-title', innerHTML: this.getMonthName(currentDate) });\n        headerWrapper.appendChild(headerContent);\n        this.parent.trigger(renderCell, { elementType: 'headerCells', element: headerContent, date: currentDate });\n        return headerWrapper;\n    }\n    renderCalendarContent(currentDate) {\n        const dateCollection = this.getMonthDates(currentDate);\n        const contentWrapper = createElement('div', { className: 'e-content e-month' });\n        const contentTable = this.createTableLayout('e-calendar-table ' + CONTENT_TABLE_CLASS);\n        contentWrapper.appendChild(contentTable);\n        const thead = createElement('thead', { className: 'e-week-header' });\n        const tr = createElement('tr');\n        let currentWeek = getWeekFirstDate(firstDateOfMonth(currentDate), this.parent.firstDayOfWeek);\n        if (this.parent.activeViewOptions.showWeekNumber) {\n            tr.appendChild(createElement('th'));\n        }\n        for (let i = 0; i < WEEK_LENGTH; i++) {\n            tr.appendChild(createElement('th', { innerHTML: this.parent.getDayNames('narrow')[currentWeek.getDay()] }));\n            currentWeek = new Date(currentWeek.getTime() + MS_PER_DAY);\n        }\n        thead.appendChild(tr);\n        prepend([thead], contentTable);\n        const tbody = contentTable.querySelector('tbody');\n        while (dateCollection.length > 0) {\n            const weekDates = dateCollection.splice(0, WEEK_LENGTH);\n            const tr = createElement('tr', { attrs: { 'role': 'row' } });\n            if (this.parent.activeViewOptions.showWeekNumber) {\n                const weekNumber = this.parent.getWeekNumberContent(weekDates);\n                const td = createElement('td', {\n                    className: 'e-week-number',\n                    attrs: { 'role': 'gridcell', 'title': this.parent.localeObj.getConstant('week') + ' ' + weekNumber },\n                    innerHTML: weekNumber\n                });\n                tr.appendChild(td);\n                this.parent.trigger(renderCell, { elementType: 'weekNumberCells', element: td });\n            }\n            for (const date of weekDates) {\n                const td = createElement('td', {\n                    className: 'e-cell ' + WORK_CELLS_CLASS,\n                    attrs: { 'role': 'gridcell', 'aria-selected': 'false', 'data-date': date.getTime().toString() }\n                });\n                const span = createElement('span', {\n                    className: 'e-day', innerHTML: this.parent.globalize.formatDate(date, { skeleton: 'd', calendar: this.parent.getCalendarMode() }),\n                    attrs: { title: this.parent.globalize.formatDate(date, { type: 'date', skeleton: 'full' }) }\n                });\n                td.appendChild(span);\n                let classList$$1 = [];\n                if (currentDate.getMonth() !== date.getMonth()) {\n                    classList$$1.push(OTHERMONTH_CLASS);\n                }\n                if (this.isCurrentDate(date) && currentDate.getMonth() === date.getMonth()) {\n                    classList$$1 = classList$$1.concat(['e-today', 'e-selected']);\n                }\n                if (classList$$1.length > 0) {\n                    addClass([td], classList$$1);\n                }\n                tr.appendChild(td);\n                this.wireEvents(td, 'cell');\n                this.parent.trigger(renderCell, { elementType: 'workCells', element: td, date: date });\n            }\n            tbody.appendChild(tr);\n        }\n        return contentWrapper;\n    }\n    createTableColGroup(count) {\n        const colGroupEle = createElement('colgroup');\n        for (let i = 0; i < count; i++) {\n            colGroupEle.appendChild(createElement('col'));\n        }\n        return colGroupEle;\n    }\n    getMonthName(date) {\n        const month = this.parent.globalize.formatDate(date, {\n            format: this.parent.activeViewOptions.dateFormat || 'MMMM y',\n            calendar: this.parent.getCalendarMode()\n        });\n        return capitalizeFirstWord(month, 'multiple');\n    }\n    generateColumnLevels() {\n        let colLevels = [];\n        const level = this.getDateSlots([this.parent.selectedDate], this.parent.activeViewOptions.workDays);\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            colLevels = this.parent.resourceBase.generateResourceLevels(level);\n            if (this.parent.uiStateValues.isGroupAdaptive) {\n                const resourceLevel = this.parent.resourceBase.lastResourceLevel[this.parent.uiStateValues.groupIndex];\n                colLevels = [this.getDateSlots([this.parent.selectedDate], resourceLevel.workDays)];\n            }\n        }\n        else {\n            colLevels.push(level);\n        }\n        colLevels.pop();\n        this.colLevels = colLevels;\n        return colLevels;\n    }\n    // eslint-disable-next-line max-len\n    getDateSlots(renderDates, workDays, startHour = this.parent.workHours.start, endHour = this.parent.workHours.end) {\n        const dateCol = [{\n                date: renderDates[0], type: 'dateHeader', className: [HEADER_CELLS_CLASS], colSpan: 1, workDays: workDays,\n                startHour: new Date(+this.parent.globalize.parseDate(startHour, { skeleton: 'Hm' })),\n                endHour: new Date(+this.parent.globalize.parseDate(endHour, { skeleton: 'Hm' }))\n            }];\n        return dateCol;\n    }\n    getMonthDates(date) {\n        const startDate = getWeekFirstDate(firstDateOfMonth(date), this.parent.firstDayOfWeek);\n        const endDate = addDays(new Date(+startDate), (6 * WEEK_LENGTH));\n        const dateCollection = [];\n        for (let start = startDate; start.getTime() < endDate.getTime(); start = addDays(start, 1)) {\n            dateCollection.push(resetTime(new Date(start)));\n        }\n        return dateCollection;\n    }\n    getRowColumnCount(type) {\n        const months = this.getMonths();\n        const year = this.parent.selectedDate.getFullYear();\n        const monthDaysCount = [];\n        for (const month of months) {\n            monthDaysCount.push(new Date(year, month, 1).getDay() + new Date(year, month + 1, 0).getDate());\n        }\n        const maxCount = Math.max(...monthDaysCount);\n        let count;\n        if (type === 'row') {\n            count = this.parent.activeViewOptions.orientation === 'Horizontal' ? months.length : maxCount;\n        }\n        else {\n            count = this.parent.activeViewOptions.orientation === 'Horizontal' ? maxCount : months.length;\n        }\n        return count;\n    }\n    isCurrentDate(date) {\n        return resetTime(new Date()).getTime() === resetTime(new Date(date.getTime())).getTime();\n    }\n    getMonths() {\n        // eslint-disable-next-line prefer-spread\n        return Array.apply(null, { length: this.parent.activeViewOptions.monthsCount }).map((value, index) => this.parent.firstMonthOfYear + index);\n    }\n    onCellClick(e) {\n        let target = closest(e.target, '.' + WORK_CELLS_CLASS);\n        const startDate = this.parent.getDateFromElement(target);\n        this.parent.activeCellsData = this.parent.getCellDetails(target);\n        const isPrevious = startDate.getTime() < this.getStartDate().getTime();\n        if (isPrevious || startDate.getTime() > this.getEndDate().getTime()) {\n            this.parent.changeDate(this.parent.activeView.getNextPreviousDate(isPrevious ? 'previous' : 'next'), e);\n            const activeDate = this.parent.activeCellsData.startTime.getTime();\n            const inRange = activeDate >= this.getStartDate().getTime() && activeDate <= this.getEndDate().getTime();\n            const dateAttr = inRange ? activeDate : (isPrevious ? this.getEndDate() : this.getStartDate()).getTime();\n            const selectedCell = this.parent.element.querySelector(':not(.' + OTHERMONTH_CLASS + ')[data-date=\"' + dateAttr + '\"]');\n            this.parent.selectCell(selectedCell);\n            this.parent.activeCellsData = this.parent.getCellDetails(selectedCell);\n        }\n        else {\n            const endDate = addDays(new Date(startDate.getTime()), 1);\n            const filteredEvents = this.parent.eventBase.filterEvents(startDate, endDate);\n            const moreEventArgs = { date: startDate, event: filteredEvents, element: e.target };\n            if (target.classList.contains(OTHERMONTH_CLASS)) {\n                target = this.parent.element.querySelector(':not(.' + OTHERMONTH_CLASS + ')[data-date=\"' + target.getAttribute('data-date') + '\"]');\n            }\n            this.parent.activeCellsData = this.parent.getCellDetails(target);\n            this.parent.quickPopup.moreEventClick(moreEventArgs, endDate);\n        }\n    }\n    onContentScroll(e) {\n        const target = e.target;\n        const headerWrapper = this.getDatesHeaderElement();\n        this.parent.notify(virtualScroll, e);\n        if (headerWrapper) {\n            headerWrapper.firstElementChild.scrollLeft = target.scrollLeft;\n        }\n        const scrollTopSelector = `.${MONTH_HEADER_WRAPPER},.${RESOURCE_COLUMN_WRAP_CLASS}`;\n        const scrollTopElement = this.element.querySelector(scrollTopSelector);\n        if (scrollTopElement) {\n            scrollTopElement.scrollTop = target.scrollTop;\n        }\n        if (!this.parent.isAdaptive) {\n            this.parent.uiStateValues.top = e.target.scrollTop;\n        }\n        this.parent.uiStateValues.left = e.target.scrollLeft;\n        this.setPersistence();\n    }\n    onScrollUiUpdate(args) {\n        let height = this.parent.element.offsetHeight - this.getHeaderBarHeight();\n        const headerWrapper = this.element.querySelector('.' + DATE_HEADER_CONTAINER_CLASS);\n        if (headerWrapper) {\n            height -= headerWrapper.offsetHeight;\n        }\n        const contentWrapper = this.element.querySelector('.' + CONTENT_WRAP_CLASS);\n        if (contentWrapper) {\n            contentWrapper.style.height = formatUnit(height);\n        }\n        if (!this.parent.isAdaptive && headerWrapper) {\n            const scrollBarWidth = getScrollBarWidth();\n            if (contentWrapper.offsetWidth - contentWrapper.clientWidth > 0) {\n                headerWrapper.firstElementChild.style[args.cssProperties.border] = scrollBarWidth > 0 ? '1px' : '0px';\n                headerWrapper.style[args.cssProperties.padding] = scrollBarWidth > 0 ? scrollBarWidth - 1 + 'px' : '0px';\n            }\n            else {\n                headerWrapper.firstElementChild.style[args.cssProperties.border] = '';\n                headerWrapper.style[args.cssProperties.padding] = '';\n            }\n        }\n        this.setColWidth(this.getContentAreaElement());\n        const leftPanelSelector = `.${MONTH_HEADER_WRAPPER},.${RESOURCE_COLUMN_WRAP_CLASS}`;\n        const leftPanelElement = this.element.querySelector(leftPanelSelector);\n        if (leftPanelElement) {\n            const isYScroll = contentWrapper.scrollWidth > contentWrapper.clientWidth;\n            leftPanelElement.style.height = formatUnit(height - (isYScroll ? 17 : 0));\n        }\n        if (!args.isPreventScrollUpdate) {\n            if (this.parent.uiStateValues.isInitial) {\n                this.parent.uiStateValues.isInitial = false;\n            }\n            else {\n                if (leftPanelElement) {\n                    leftPanelElement.scrollTop = this.parent.uiStateValues.top;\n                }\n                contentWrapper.scrollTop = this.parent.uiStateValues.top;\n                contentWrapper.scrollLeft = this.parent.uiStateValues.left;\n            }\n        }\n        this.retainScrollPosition();\n    }\n    getStartDate() {\n        return new Date(this.parent.selectedDate.getFullYear(), this.parent.firstMonthOfYear % 12, 1);\n    }\n    getEndDate() {\n        return addDays(addMonths(this.getStartDate(), this.parent.monthsCount), -1);\n    }\n    startDate() {\n        return this.parent.currentView === 'Year' ? getWeekFirstDate(this.getStartDate(), this.parent.firstDayOfWeek) : this.getStartDate();\n    }\n    endDate() {\n        return this.parent.currentView === 'Year' ? addDays(getWeekLastDate(this.getEndDate(), this.parent.firstDayOfWeek), 1) :\n            addDays(this.getEndDate(), 1);\n    }\n    getEndDateFromStartDate(start) {\n        let date = new Date(start.getTime());\n        if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n            date = lastDateOfMonth(date);\n        }\n        return addDays(new Date(date.getTime()), 1);\n    }\n    getNextPreviousDate(type) {\n        return addYears(this.parent.selectedDate, ((type === 'next') ? 1 : -1));\n    }\n    getDateRangeText() {\n        const startDate = this.getStartDate();\n        const endDate = this.getEndDate();\n        if (startDate.getFullYear() !== endDate.getFullYear()) {\n            return this.parent.globalize.formatDate(startDate, { skeleton: 'yMMM' }) + ' - ' + this.parent.globalize.formatDate(endDate, { skeleton: 'yMMM' });\n        }\n        else {\n            return this.parent.globalize.formatDate(this.parent.selectedDate, { skeleton: 'y' });\n        }\n    }\n    addEventListener() {\n        this.parent.on(scrollUiUpdate, this.onScrollUiUpdate, this);\n        this.parent.on(dataReady, this.onDataReady, this);\n    }\n    removeEventListener() {\n        if (this.parent) {\n            this.parent.off(scrollUiUpdate, this.onScrollUiUpdate);\n            this.parent.off(dataReady, this.onDataReady);\n        }\n    }\n    onDataReady(args) {\n        this.yearEventModule = new YearEvent(this.parent);\n        this.yearEventModule.renderAppointments();\n        this.parent.notify(eventsLoaded, args);\n    }\n    wireEvents(element, type) {\n        if (type === 'cell') {\n            if (this.parent.currentView !== 'TimelineYear') {\n                EventHandler.add(element, 'click', this.onCellClick, this);\n            }\n            else {\n                EventHandler.add(element, 'mousedown', this.parent.workCellAction.cellMouseDown, this.parent.workCellAction);\n                EventHandler.add(element, 'click', this.parent.workCellAction.cellClick, this.parent.workCellAction);\n                if (!this.parent.isAdaptive) {\n                    EventHandler.add(element, 'dblclick', this.parent.workCellAction.cellDblClick, this.parent.workCellAction);\n                }\n            }\n        }\n        else {\n            EventHandler.add(element, 'scroll', this.onContentScroll, this);\n        }\n    }\n    destroy() {\n        if (!this.parent || this.parent && this.parent.isDestroyed) {\n            return;\n        }\n        if (this.element) {\n            const contentScroll = this.element.querySelector('.' + CONTENT_WRAP_CLASS);\n            if (contentScroll) {\n                EventHandler.remove(contentScroll, 'scroll', this.onContentScroll);\n            }\n            if (this.yearEventModule) {\n                this.yearEventModule.destroy();\n                this.yearEventModule = null;\n            }\n            if (this.parent.resourceBase) {\n                this.parent.resourceBase.destroy();\n            }\n            super.destroy();\n        }\n    }\n}\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\nclass AgendaBase extends ViewBase {\n    constructor(parent) {\n        super(parent);\n    }\n    // eslint-disable-next-line max-len\n    createAgendaContentElement(type, listData, aTd, groupOrder, groupIndex) {\n        let listElement;\n        const fieldMapping = this.parent.eventFields;\n        if (type === 'noEvents') {\n            const noEvents = [{ 'subject': this.parent.localeObj.getConstant('noEvents') }];\n            listElement = ListBase.createList(this.parent.createElement, noEvents, {\n                moduleName: 'agenda',\n                listClass: this.parent.activeView.viewClass,\n                itemClass: this.parent.activeView.viewClass,\n                template: `<div class=\"${AGENDA_NO_EVENT_CLASS}\">${this.parent.localeObj.getConstant('noEvents')}</div>`\n            });\n            if (listElement.querySelector('.e-agenda-item').children.length === 0) {\n                listElement.firstElementChild.appendChild(createElement('div', { className: AGENDA_NO_EVENT_CLASS, innerHTML: this.parent.localeObj.getConstant('noEvents') }));\n            }\n        }\n        else {\n            listElement = ListBase.createList(this.parent.createElement, listData, {\n                moduleName: 'agenda',\n                listClass: this.parent.activeView.viewClass,\n                itemClass: this.parent.activeView.viewClass\n            });\n            const listElements = [].slice.call(listElement.children);\n            listElements.forEach((element, li) => {\n                const appWrapper = createElement('div', {\n                    className: APPOINTMENT_CLASS, attrs: {\n                        'data-id': 'Appointment_' + listData[li][this.parent.eventFields.id],\n                        'data-guid': listData[li].Guid,\n                        'role': 'button',\n                        'tabindex': '0',\n                        'aria-disabled': this.parent.eventBase.getReadonlyAttribute(listData[li]),\n                        'aria-pressed': 'false',\n                        'aria-grabbed': 'true',\n                        'aria-label': this.parent.getAnnouncementString(listData[li])\n                    }\n                });\n                if (!isNullOrUndefined(groupIndex)) {\n                    appWrapper.setAttribute('data-group-index', groupIndex.toString());\n                }\n                this.parent.eventBase.applyResourceColor(appWrapper, listData[li], 'borderColor', groupOrder);\n                let templateEle;\n                if (!isNullOrUndefined(this.parent.activeViewOptions.eventTemplate)) {\n                    addClass([appWrapper], EVENT_TEMPLATE);\n                    const scheduleId = this.parent.element.id + '_';\n                    const viewName = this.parent.activeViewOptions.eventTemplateName;\n                    const templateId = scheduleId + viewName + 'eventTemplate';\n                    templateEle = this.parent.getAppointmentTemplate()(listData[li], this.parent, 'eventTemplate', templateId, false);\n                    if (!isNullOrUndefined(listData[li][fieldMapping.recurrenceRule])) {\n                        const iconClass = (listData[li][fieldMapping.id] === listData[li][fieldMapping.recurrenceID]) ?\n                            EVENT_RECURRENCE_ICON_CLASS : EVENT_RECURRENCE_EDIT_ICON_CLASS;\n                        appWrapper.appendChild(createElement('div', { className: ICON + ' ' + iconClass }));\n                    }\n                }\n                else {\n                    templateEle = this.createAppointment(listData[li]);\n                }\n                append([].slice.call(templateEle), appWrapper);\n                removeChildren(element);\n                element.appendChild(appWrapper);\n                const args = {\n                    data: extend({}, listData[li], null, true),\n                    element: element, cancel: false\n                };\n                this.parent.trigger(eventRendered, args, (eventArgs) => {\n                    if (eventArgs.cancel) {\n                        remove(element);\n                    }\n                });\n            });\n        }\n        aTd.appendChild(listElement);\n        if ((this.parent.currentView === 'MonthAgenda' && this.parent.activeViewOptions.group.resources.length > 0)\n            || this.parent.currentView === 'Agenda') {\n            addClass([aTd], AGENDA_DAY_BORDER_CLASS);\n        }\n        this.parent.renderTemplates();\n        return aTd;\n    }\n    createAppointment(event) {\n        const fieldMapping = this.parent.eventFields;\n        let eventSubject = (event[fieldMapping.subject] || this.parent.eventSettings.fields.subject.default\n            || this.parent.localeObj.getConstant('addTitle'));\n        const eventLocation = (event[fieldMapping.location] || this.parent.eventSettings.fields.location.default);\n        const appSubjectWrap = createElement('div', { className: SUBJECT_WRAP });\n        if (!isNullOrUndefined(eventLocation) && eventLocation !== '') {\n            eventSubject += ',';\n        }\n        appSubjectWrap.appendChild(createElement('div', { className: SUBJECT_CLASS, innerHTML: eventSubject }));\n        if (!isNullOrUndefined(eventLocation) && eventLocation !== '') {\n            appSubjectWrap.appendChild(createElement('div', { className: LOCATION_CLASS, innerHTML: eventLocation }));\n        }\n        if (!isNullOrUndefined(event[fieldMapping.recurrenceRule])) {\n            const iconClass = (event[fieldMapping.id] === event[fieldMapping.recurrenceID]) ?\n                EVENT_RECURRENCE_ICON_CLASS : EVENT_RECURRENCE_EDIT_ICON_CLASS;\n            appSubjectWrap.appendChild(createElement('div', { className: ICON + ' ' + iconClass }));\n        }\n        const strDate = event[fieldMapping.startTime];\n        const endDate = event[fieldMapping.endTime];\n        const isAllDay = event[fieldMapping.isAllDay];\n        let allDayStr = this.parent.localeObj.getConstant('allDay');\n        const timeStr = this.parent.getTimeString(strDate) + ' - ' + this.parent.getTimeString(endDate);\n        if (!isNullOrUndefined(event.data)) {\n            const milliSeconds = (endDate.getTimezoneOffset() !== strDate.getTimezoneOffset()) ?\n                (endDate.getTime() - strDate.getTime() + 3600000) : (endDate.getTime() - strDate.getTime());\n            const eventString = (milliSeconds / MS_PER_DAY) >= 1 ? allDayStr : timeStr;\n            allDayStr = eventString + ' (' + this.parent.localeObj.getConstant('day') + ' '\n                + event.data.index + '/' + event.data.count + ')';\n        }\n        const displayStr = (!isNullOrUndefined(event.data) || isAllDay) ? allDayStr : timeStr;\n        const appDateTime = createElement('div', { className: DATE_TIME_CLASS, innerHTML: displayStr });\n        return [appSubjectWrap, appDateTime];\n    }\n    processAgendaEvents(events) {\n        let eventsProcessed = [];\n        if (isNullOrUndefined(events)) {\n            return eventsProcessed;\n        }\n        for (const event of events) {\n            const spanned = this.parent.eventBase.splitEventByDay(event);\n            eventsProcessed = eventsProcessed.concat(spanned.length > 1 ? spanned : event);\n        }\n        return eventsProcessed;\n    }\n    wireEventActions() {\n        const eventElement = [].slice.call(this.parent.element.querySelectorAll('.' + APPOINTMENT_CLASS));\n        for (const element of eventElement) {\n            this.parent.eventBase.wireAppointmentEvents(element, this.parent.getEventDetails(element), true);\n        }\n        const dateHeaderElement = [].slice.call(this.parent.element.querySelectorAll('.e-m-date'));\n        for (const element of dateHeaderElement) {\n            EventHandler.add(element, 'click', this.parent.agendaModule.dayNavigationClick, this);\n        }\n    }\n    calculateResourceTableElement(tBody, noOfDays, agendaDate) {\n        if (isNullOrUndefined(this.parent.resourceBase.lastResourceLevel)) {\n            const level = this.getDateSlots(this.renderDates, this.parent.activeViewOptions.workDays);\n            this.parent.resourceBase.generateResourceLevels(level);\n        }\n        const agendaLastDate = addDays(new Date(agendaDate.getTime()), noOfDays);\n        const days = (this.parent.activeViewOptions.group.byDate || this.parent.currentView === 'MonthAgenda') ? noOfDays : 1;\n        const resColl = this.parent.resourceBase.resourceCollection;\n        const resData = this.parent.resourceBase.lastResourceLevel;\n        const initialDate = agendaDate;\n        for (let i = 0; i < days; i++) {\n            const lastLevelInfo = [];\n            const tempLastLevelInfo = [];\n            let tempIndex = 0;\n            let eventObj;\n            let dateObj;\n            const firstDate = addDays(initialDate, i);\n            const finalDate = (this.parent.activeViewOptions.group.byDate || this.parent.currentView === 'MonthAgenda')\n                ? addDays(firstDate, 1) : agendaLastDate;\n            const agendaCollection = this.parent.eventBase.filterEvents(firstDate, finalDate);\n            if (agendaCollection.length > 0 || !this.parent.hideEmptyAgendaDays || this.parent.currentView === 'MonthAgenda') {\n                for (let res = 0; res < resData.length; res++) {\n                    noOfDays = (!this.parent.activeViewOptions.group.byDate || this.parent.currentView === 'MonthAgenda') ? noOfDays : 1;\n                    const data = [];\n                    agendaDate = firstDate;\n                    // eslint-disable-next-line max-len\n                    const resDataCollection = this.parent.eventBase.filterEvents(agendaDate, agendaLastDate, agendaCollection, resData[res]);\n                    if (resDataCollection.length > 0 || !this.parent.hideEmptyAgendaDays || this.parent.currentView === 'MonthAgenda') {\n                        for (let r = 0; r < noOfDays; r++) {\n                            // eslint-disable-next-line max-len\n                            const resDayCollection = this.parent.eventBase.filterEvents(agendaDate, addDays(agendaDate, 1), resDataCollection, undefined);\n                            if (resDayCollection.length > 0 || !this.parent.hideEmptyAgendaDays ||\n                                this.parent.currentView === 'MonthAgenda') {\n                                data.push(resDayCollection[0]);\n                                eventObj = {\n                                    rowSpan: 1, type: 'eventColumn', resource: resColl[resColl.length - 1],\n                                    groupIndex: resData[res].groupIndex, groupOrder: resData[res].groupOrder,\n                                    resourceData: resData[res].resourceData, eventData: resDayCollection, date: agendaDate\n                                };\n                                dateObj = {\n                                    rowSpan: 1, type: 'dateColumn', resource: resColl[resColl.length - 1],\n                                    groupOrder: resData[res].groupOrder, resourceData: resData[res].resourceData,\n                                    date: agendaDate\n                                };\n                                if (!lastLevelInfo[tempIndex]) {\n                                    lastLevelInfo[tempIndex] = [];\n                                }\n                                lastLevelInfo[tempIndex].push(eventObj);\n                                lastLevelInfo[tempIndex].push(dateObj);\n                                tempIndex++;\n                            }\n                            agendaDate = addDays(agendaDate, 1);\n                            if (agendaDate.getTime() >= agendaLastDate.getTime() || this.parent.activeViewOptions.group.byDate\n                                || this.parent.currentView === 'MonthAgenda') {\n                                lastLevelInfo[lastLevelInfo.length - 1][1].cssClass = AGENDA_DAY_BORDER_CLASS;\n                                const tempObj = {\n                                    rowSpan: data.length, type: 'resourceColumn', resource: resColl[resColl.length - 1],\n                                    groupOrder: resData[res].groupOrder.slice(0, -1), resourceData: resData[res].resourceData,\n                                    groupIndex: (lastLevelInfo.length - data.length), className: [RESOURCE_NAME],\n                                    date: agendaDate\n                                };\n                                lastLevelInfo[lastLevelInfo.length - data.length].push(tempObj);\n                                tempLastLevelInfo.push(extend({}, tempObj, null, true));\n                                break;\n                            }\n                        }\n                    }\n                }\n                const topResources = resColl.slice(0, -1);\n                let tempGroupedData = [];\n                let totalRowSpan = 0;\n                for (let y = 0; y < topResources.length; y++) {\n                    const data = topResources[topResources.length - (y + 1)].dataSource;\n                    for (let x = 0; x < data.length; x++) {\n                        let z = 0;\n                        for (let u = 0; u < tempLastLevelInfo.length; u++) {\n                            // eslint-disable-next-line max-len\n                            if (tempLastLevelInfo[u].groupOrder[topResources.length - (y + 1)] === data[x][topResources[topResources.length - (y + 1)].idField]) {\n                                totalRowSpan = totalRowSpan + tempLastLevelInfo[u].rowSpan;\n                                tempGroupedData.push(extend({}, tempLastLevelInfo[u], null, true));\n                            }\n                            if (++z === tempLastLevelInfo.length && tempGroupedData.length > 0) {\n                                tempGroupedData[0].rowSpan = totalRowSpan;\n                                tempGroupedData[0].type = 'parentColumnLevel_' + (y + 1);\n                                tempGroupedData[0].resource = topResources[topResources.length - (y + 1)];\n                                tempGroupedData[0].resourceData = data[x];\n                                tempGroupedData[0].date = agendaDate;\n                                lastLevelInfo[tempGroupedData[0].groupIndex].push(tempGroupedData[0]);\n                                tempGroupedData = [];\n                                totalRowSpan = 0;\n                            }\n                        }\n                    }\n                }\n                this.createResourceTableRow(lastLevelInfo, tBody);\n            }\n        }\n        const totalCollection = this.parent.eventBase.filterEvents(initialDate, agendaLastDate);\n        if (totalCollection.length === 0 && !this.parent.activeViewOptions.allowVirtualScrolling && this.parent.hideEmptyAgendaDays) {\n            this.renderEmptyContent(tBody, initialDate);\n        }\n    }\n    createResourceTableRow(tContent, tBody) {\n        const tr = createElement('tr', { attrs: { role: 'row' } });\n        let ntr;\n        const td = createElement('td', { attrs: { role: 'gridcell', 'aria-selected': 'false' } });\n        let tempData;\n        let rowSpan = 0;\n        let level;\n        if (this.parent.activeViewOptions.group.byDate || this.parent.currentView === 'MonthAgenda') {\n            let tContentCollection = [];\n            const parentCollection = this.parent.resourceBase.resourceCollection.slice(0, -1);\n            for (let w = 0; w < tContent.length; w++) {\n                tContentCollection = tContentCollection.concat(tContent[w]);\n            }\n            level = (parentCollection.length > 0) ? 'parentColumnLevel_' + parentCollection.length : 'resourceColumn';\n            const rowSpanCollection = tContentCollection.filter((data) => data.type === level);\n            for (let x = 0; x < rowSpanCollection.length; x++) {\n                rowSpan = rowSpan + rowSpanCollection[x].rowSpan;\n            }\n        }\n        for (let row = 0; row < tContent.length; row++) {\n            ntr = tr.cloneNode();\n            for (let col = tContent[row].length - 1; col >= 0; col--) {\n                const data = tContent[row][col];\n                let ntd = td.cloneNode();\n                if (data.type === 'dateColumn') {\n                    if (this.parent.activeViewOptions.group.byDate || this.parent.currentView === 'MonthAgenda') {\n                        tempData = tContent[row][col];\n                        continue;\n                    }\n                    ntd.setAttribute('data-date', data.date.getTime().toString());\n                    ntd.appendChild(this.createDateHeaderElement(data.date));\n                    const className = [AGENDA_CELLS_CLASS, AGENDA_DATE_CLASS];\n                    if (data.cssClass) {\n                        className.push(data.cssClass);\n                    }\n                    addClass([ntd], className);\n                    ntr.appendChild(ntd);\n                }\n                else if (data.type === 'eventColumn') {\n                    const elementType = (data.eventData.length === 0) ? 'noEvents' : 'data';\n                    ntd = this.createAgendaContentElement(elementType, data.eventData, ntd, data.groupOrder, data.groupIndex);\n                    ntd.setAttribute('data-date', data.date.getTime().toString());\n                    if (this.parent.activeViewOptions.group.byDate || this.parent.currentView === 'MonthAgenda') {\n                        addClass([ntd], [AGENDA_CELLS_CLASS, AGENDA_DAY_PADDING_CLASS]);\n                    }\n                    ntr.appendChild(ntd);\n                }\n                else {\n                    ntd.setAttribute('rowspan', data.rowSpan.toString());\n                    addClass([ntd], AGENDA_RESOURCE_CLASS);\n                    this.setResourceHeaderContent(ntd, data, data.className[0]);\n                    ntr.appendChild(ntd);\n                }\n            }\n            if (this.parent.activeViewOptions.group.byDate && row === 0 && this.parent.currentView !== 'MonthAgenda') {\n                const ntd = td.cloneNode();\n                ntd.setAttribute('data-date', tempData.date.getTime().toString());\n                ntd.setAttribute('rowspan', rowSpan.toString());\n                ntd.appendChild(this.createDateHeaderElement(tempData.date));\n                addClass([ntd], [AGENDA_CELLS_CLASS, AGENDA_DATE_CLASS, DATE_BORDER_CLASS]);\n                const daysCount = getDaysCount(this.parent.selectedDate.getTime(), tempData.date.getTime());\n                ntr.setAttribute('data-row-index', daysCount.toString());\n                if (this.parent.element.querySelector(`.e-agenda-view tr[data-row-index=\"${daysCount}\"]`)) {\n                    break;\n                }\n                ntr.insertBefore(ntd, ntr.childNodes[0]);\n            }\n            tBody.appendChild(ntr);\n        }\n    }\n    createDateHeaderElement(date) {\n        let dateHeader;\n        if (this.parent.activeViewOptions.dateHeaderTemplate) {\n            dateHeader = createElement('div', { className: AGENDA_HEADER_CLASS });\n            const args = { date: date, type: 'dateHeader' };\n            const scheduleId = this.parent.element.id + '_';\n            const viewName = this.parent.activeViewOptions.dateHeaderTemplateName;\n            const templateId = scheduleId + viewName + 'dateHeaderTemplate';\n            const dateTemplate = [].slice.call(this.parent.getDateHeaderTemplate()(args, this.parent, 'dateHeaderTemplate', templateId, false));\n            append(dateTemplate, dateHeader);\n        }\n        else {\n            dateHeader = this.getMobileDateElement(date, AGENDA_HEADER_CLASS);\n        }\n        return dateHeader;\n    }\n    renderEmptyContent(tBody, agendaDate) {\n        const eTr = this.createTableRowElement(agendaDate, 'noEvents');\n        const eTd = eTr.children[0];\n        const noEvents = createElement('div', {\n            className: AGENDA_EMPTY_EVENT_CLASS,\n            innerHTML: this.parent.localeObj.getConstant('noEvents')\n        });\n        eTd.appendChild(noEvents);\n        tBody.appendChild(eTr);\n    }\n    createTableRowElement(date, type) {\n        const daysCount = getDaysCount(this.parent.selectedDate.getTime(), date.getTime());\n        const tr = createElement('tr', { attrs: { 'role': 'row', 'data-row-index': daysCount.toString() } });\n        const td = createElement('td', {\n            attrs: {\n                'class': (type === 'monthHeader') ? MONTH_HEADER_CLASS : AGENDA_CELLS_CLASS,\n                'role': 'gridcell',\n                'aria-selected': 'false',\n                'data-column-index': daysCount.toString(),\n                'data-date': date.getTime().toString()\n            }\n        });\n        const dTd = td.cloneNode();\n        const aTd = td.cloneNode();\n        tr.appendChild(dTd);\n        if (type !== 'noEvents') {\n            tr.appendChild(aTd);\n        }\n        return tr;\n    }\n    destroy() {\n        super.destroy();\n    }\n}\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\n/**\n * agenda view\n */\nclass Agenda extends AgendaBase {\n    constructor(parent) {\n        super(parent);\n        this.viewClass = 'e-agenda-view';\n        this.isInverseTableSelect = false;\n        this.agendaDates = {};\n        this.virtualScrollTop = 1;\n    }\n    getModuleName() {\n        return 'agenda';\n    }\n    renderLayout() {\n        this.agendaDates = {};\n        this.element = createElement('div', { className: TABLE_WRAP_CLASS });\n        addClass([this.element], this.viewClass);\n        this.element.appendChild(this.createTableLayout(OUTER_TABLE_CLASS));\n        this.element.querySelector('table').setAttribute('role', 'presentation');\n        this.parent.element.querySelector('.' + TABLE_CONTAINER_CLASS).appendChild(this.element);\n        const eTr = createElement('tr');\n        this.element.querySelector('tbody').appendChild(eTr);\n        const workTd = createElement('td');\n        eTr.appendChild(workTd);\n        const wrap = createElement('div', { className: CONTENT_WRAP_CLASS });\n        workTd.appendChild(wrap);\n        const tbl = this.createTableLayout(CONTENT_TABLE_CLASS);\n        wrap.appendChild(tbl);\n        const tBody = tbl.querySelector('tbody');\n        const agendaDate = resetTime(this.parent.selectedDate);\n        this.renderEmptyContent(tBody, agendaDate);\n        this.wireEvents();\n        if (this.parent.resourceBase) {\n            this.parent.resourceBase.generateResourceLevels([{ renderDates: this.parent.activeView.renderDates }]);\n        }\n        if (this.parent.uiStateValues.isGroupAdaptive && !this.parent.element.querySelector('.' + RESOURCE_TOOLBAR_CONTAINER)) {\n            this.renderResourceMobileLayout();\n        }\n        this.parent.notify(contentReady, {});\n    }\n    eventLoad(args) {\n        this.dataSource = extend([], this.parent.eventsData, null, true);\n        for (const event of this.parent.eventsData) {\n            delete event.generatedDates;\n        }\n        let eventCollection = this.parent.activeViewOptions.allowVirtualScrolling ?\n            args.processedData : this.parent.eventsProcessed;\n        if (this.parent.uiStateValues.isGroupAdaptive) {\n            const resource = this.parent.resourceBase.lastResourceLevel[this.parent.uiStateValues.groupIndex];\n            this.dataSource = this.parent.eventBase.filterEventsByResource(resource, this.dataSource);\n            eventCollection = this.parent.eventBase.filterEventsByResource(resource, eventCollection);\n        }\n        this.parent.eventsProcessed = this.processAgendaEvents(eventCollection);\n        const agendaDate = resetTime(this.parent.selectedDate);\n        const tBody = this.element.querySelector('.' + CONTENT_TABLE_CLASS + ' tbody');\n        removeChildren(tBody);\n        this.renderInitialContent(tBody, agendaDate);\n        this.wireEventActions();\n        const contentArea = closest(tBody, '.' + CONTENT_WRAP_CLASS);\n        contentArea.scrollTop = 1;\n        this.parent.notify(eventsLoaded, {});\n        if (!this.parent.activeViewOptions.allowVirtualScrolling) {\n            this.retainScrollPosition();\n        }\n    }\n    refreshEvent(refreshDate) {\n        let processedData = [];\n        const fields = this.parent.eventFields;\n        for (const data of this.dataSource) {\n            if (isNullOrUndefined(data[fields.recurrenceID]) && !isNullOrUndefined(data[fields.recurrenceRule]) &&\n                !isNullOrUndefined(data.generatedDates) && refreshDate >= data.generatedDates.end) {\n                processedData = processedData.concat(this.parent.eventBase.generateOccurrence(data, refreshDate));\n            }\n        }\n        this.parent.eventsProcessed = this.parent.eventsProcessed.concat(this.processAgendaEvents(processedData));\n    }\n    refreshHeader() {\n        const tBody = this.element.querySelector('.' + CONTENT_TABLE_CLASS + ' tbody');\n        if (this.parent.activeViewOptions.group.byDate) {\n            removeChildren(tBody);\n        }\n        else {\n            remove(tBody.firstElementChild);\n        }\n        const agendaDate = resetTime(this.parent.selectedDate);\n        const emptyTBody = createElement('tbody');\n        const firstDate = new Date(agendaDate.getTime());\n        const lastDate = (this.parent.activeViewOptions.allowVirtualScrolling && this.parent.hideEmptyAgendaDays) ?\n            this.getEndDateFromStartDate(firstDate) : addDays(firstDate, this.parent.agendaDaysCount);\n        this.renderContent(emptyTBody, firstDate, lastDate);\n        append([].slice.call(emptyTBody.childNodes), tBody);\n    }\n    renderInitialContent(tBody, agendaDate) {\n        const emptyTBody = createElement('tbody');\n        let firstDate = new Date(agendaDate.getTime());\n        let lastDate = (this.parent.activeViewOptions.allowVirtualScrolling && this.parent.hideEmptyAgendaDays) ?\n            this.getEndDateFromStartDate(firstDate) : addDays(firstDate, this.parent.agendaDaysCount);\n        this.renderContent(emptyTBody, firstDate, lastDate);\n        append([].slice.call(emptyTBody.childNodes), tBody);\n        // Initial rendering, to load previous date events upto scroll bar enable\n        if (this.parent.activeViewOptions.allowVirtualScrolling && this.parent.hideEmptyAgendaDays && this.parent.eventsData.length > 0) {\n            const contentArea = this.getContentAreaElement();\n            const contentChild = contentArea.querySelector('.e-content-table');\n            while (contentArea.offsetWidth <= contentArea.clientWidth) {\n                if (this.parent.isAdaptive && contentChild.offsetHeight >= contentArea.clientHeight) {\n                    break;\n                }\n                const emptyTBody = createElement('tbody');\n                lastDate = firstDate;\n                firstDate = addDays(lastDate, -this.parent.agendaDaysCount);\n                this.renderContent(emptyTBody, firstDate, lastDate);\n                prepend([].slice.call(emptyTBody.childNodes), tBody);\n                if (firstDate <= this.parent.minDate) {\n                    break;\n                }\n            }\n        }\n        if (tBody.childNodes.length <= 0) {\n            this.renderEmptyContent(tBody, agendaDate);\n        }\n    }\n    renderContent(tBody, agendaDate, lastDate) {\n        const fieldMapping = this.parent.eventFields;\n        const firstDate = new Date(agendaDate.getTime());\n        const isObject = this.appointmentFiltering(firstDate, lastDate);\n        if (isObject.length > 0 && this.parent.activeViewOptions.allowVirtualScrolling && this.parent.hideEmptyAgendaDays) {\n            agendaDate = isObject[0][fieldMapping.startTime];\n            agendaDate = new Date(new Date(agendaDate.getTime()).setHours(0, 0, 0, 0));\n            this.updateHeaderText(isObject[0][fieldMapping.startTime]);\n        }\n        let endDate;\n        if (!this.parent.hideEmptyAgendaDays || (this.parent.agendaDaysCount > 0 && isObject.length > 0)) {\n            if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n                let date = agendaDate;\n                if (!this.parent.activeViewOptions.group.byDate) {\n                    this.parent.activeViewOptions.allowVirtualScrolling = false;\n                    date = firstDate;\n                    if (this.parent.headerModule) {\n                        this.parent.headerModule.updateDateRange(this.parent.activeView.getDateRangeText());\n                        this.parent.headerModule.updateHeaderItems('remove');\n                    }\n                }\n                this.calculateResourceTableElement(tBody, this.parent.agendaDaysCount, date);\n            }\n            else {\n                for (let day = 0; day < this.parent.agendaDaysCount; day++) {\n                    const filterData = this.appointmentFiltering(agendaDate);\n                    const nTr = this.createTableRowElement(agendaDate, 'data');\n                    if (this.element.querySelector('tr[data-row-index=\"' + parseInt(nTr.getAttribute('data-row-index'), 10) + '\"]')) {\n                        agendaDate = addDays(agendaDate, 1);\n                        continue;\n                    }\n                    const dTd = nTr.children[0];\n                    const aTd = nTr.children[1];\n                    if (filterData.length > 0 || (!this.parent.hideEmptyAgendaDays && filterData.length === 0)) {\n                        const elementType = (!this.parent.hideEmptyAgendaDays && filterData.length === 0) ? 'noEvents' : 'data';\n                        dTd.appendChild(this.createDateHeaderElement(agendaDate));\n                        nTr.appendChild(dTd);\n                        const cTd = this.createAgendaContentElement(elementType, filterData, aTd);\n                        nTr.appendChild(cTd);\n                        if (cTd.querySelectorAll('li').length > 0) {\n                            tBody.appendChild(nTr);\n                        }\n                    }\n                    else if (this.parent.activeViewOptions.allowVirtualScrolling) {\n                        day--;\n                    }\n                    if (this.isCurrentDate(new Date(agendaDate.getTime()))) {\n                        addClass(dTd.childNodes, AGENDA_CURRENT_DAY_CLASS);\n                    }\n                    agendaDate = addDays(agendaDate, 1);\n                    if (agendaDate.getTime() > lastDate.getTime()) {\n                        break;\n                    }\n                }\n            }\n            endDate = new Date(agendaDate.getTime() - MS_PER_DAY);\n        }\n        this.agendaDates = { start: firstDate, end: endDate };\n    }\n    agendaScrolling(event) {\n        if (this.parent.quickPopup) {\n            this.parent.quickPopup.quickPopupHide();\n        }\n        if (this.parent.activeViewOptions.allowVirtualScrolling) {\n            this.virtualScrolling(event);\n        }\n        if (!this.parent.activeViewOptions.allowVirtualScrolling) {\n            this.setPersistence();\n        }\n    }\n    virtualScrolling(event) {\n        const target = event.target;\n        const scrollTop = target.scrollTop;\n        const scrollHeight = target.scrollHeight;\n        const offsetHeight = target.clientHeight;\n        const totalHeight = scrollTop + offsetHeight;\n        const direction = (this.virtualScrollTop < scrollTop) ? 'next' : 'previous';\n        const tBody = target.querySelector('tbody');\n        const emptyTBody = createElement('tbody');\n        const topElement = this.getElementFromScrollerPosition(event);\n        const scrollDate = this.parent.getDateFromElement(topElement);\n        let filterDate;\n        let filterData;\n        if (scrollTop === 0) {\n            filterDate = this.getPreviousNextDate(addDays(scrollDate, -1), direction);\n            filterData = this.appointmentFiltering(filterDate.start, filterDate.end);\n            if (filterData.length > 0 || !this.parent.hideEmptyAgendaDays) {\n                this.renderContent(emptyTBody, filterDate.start, filterDate.end);\n                prepend([].slice.call(emptyTBody.childNodes), tBody);\n                this.wireEventActions();\n                for (let s = 0, element = tBody.children; s < element.length; s++) {\n                    if (element[s].getAttribute('data-row-index') === topElement.getAttribute('data-column-index')) {\n                        const scrollToValue = element[s].offsetTop -\n                            this.element.querySelector('.e-agenda-item').offsetHeight;\n                        target.scrollTop = scrollToValue;\n                        break;\n                    }\n                }\n                this.updateHeaderText(scrollDate);\n            }\n        }\n        else if (totalHeight >= (scrollHeight - 5)) {\n            filterDate = this.getPreviousNextDate(addDays(scrollDate, 1), direction);\n            filterData = this.appointmentFiltering(filterDate.start, filterDate.end);\n            if (filterData.length > 0 || !this.parent.hideEmptyAgendaDays) {\n                this.renderContent(emptyTBody, filterDate.start, filterDate.end);\n                append([].slice.call(emptyTBody.childNodes), tBody);\n                this.wireEventActions();\n                this.updateHeaderText(scrollDate);\n            }\n        }\n        else {\n            this.updateHeaderText(scrollDate);\n        }\n        this.virtualScrollTop = scrollTop;\n        const selectedElements = this.parent.eventBase.getSelectedAppointments();\n        if (selectedElements.length > 0) {\n            selectedElements[selectedElements.length - 1].focus();\n        }\n    }\n    getElementFromScrollerPosition(event) {\n        let filterElement;\n        const target = event.target;\n        const scrollTop = target.scrollTop;\n        const scrollHeight = target.scrollHeight;\n        const offsetHeight = target.clientHeight;\n        const totalHeight = scrollTop + offsetHeight;\n        const liCollection = [].slice.call(target.querySelectorAll('.e-agenda-item'));\n        let li;\n        let liDetails;\n        if (liCollection.length > 0) {\n            if (scrollTop === 0) {\n                li = liCollection[0];\n                filterElement = closest(li, '.' + AGENDA_CELLS_CLASS);\n            }\n            else if (totalHeight === scrollHeight) {\n                li = liCollection[liCollection.length - 1];\n                filterElement = closest(li, '.' + AGENDA_CELLS_CLASS);\n            }\n            else {\n                for (let a = 0, length = liCollection.length; a < length; a++) {\n                    li = liCollection[a];\n                    liDetails = li.getBoundingClientRect();\n                    if (liDetails.top >= 0) {\n                        filterElement = closest(li, '.' + AGENDA_CELLS_CLASS);\n                        break;\n                    }\n                }\n            }\n        }\n        return filterElement;\n    }\n    updateHeaderText(date) {\n        if (this.parent.showHeaderBar) {\n            this.parent.headerModule.updateDateRange(this.getDateRangeText(date));\n        }\n    }\n    getPreviousNextDate(date, type) {\n        let currentDate = new Date(date.getTime());\n        const firstDate = this.getStartDateFromEndDate(date);\n        const lastDate = this.getEndDateFromStartDate(date);\n        let daysCount = 0;\n        do {\n            const filterData = this.appointmentFiltering(currentDate);\n            if (filterData.length > 0 || !this.parent.hideEmptyAgendaDays) {\n                daysCount++;\n            }\n            currentDate = addDays(currentDate, (type === 'next') ? 1 : -1);\n            if (currentDate < firstDate || currentDate > lastDate) {\n                break;\n            }\n        } while (daysCount !== this.parent.agendaDaysCount);\n        const endDate = addDays(currentDate, (type === 'next') ? -1 : 1);\n        return (type === 'next') ? { start: date, end: addDays(endDate, 1) } : { start: endDate, end: addDays(date, 1) };\n    }\n    appointmentFiltering(startDate, endDate) {\n        let dateStart;\n        let dateEnd;\n        if (!isNullOrUndefined(startDate) && isNullOrUndefined(endDate)) {\n            dateStart = resetTime(new Date(startDate.getTime()));\n            dateEnd = setTime(new Date(dateStart.getTime()), MS_PER_DAY);\n        }\n        else {\n            dateStart = new Date(startDate.getTime());\n            dateEnd = new Date(endDate.getTime());\n        }\n        let filterData = this.parent.eventBase.filterEvents(dateStart, dateEnd);\n        if (filterData.length === 0) {\n            this.refreshEvent(startDate);\n            filterData = this.parent.eventBase.filterEvents(dateStart, dateEnd);\n        }\n        return filterData;\n    }\n    getStartDateFromEndDate(endDate) {\n        let filterDate;\n        const fields = this.parent.eventFields;\n        if (this.parent.eventsProcessed.length > 0) {\n            const firstDate = Math.min(...this.parent.eventsProcessed.map((a) => a[fields.startTime].getTime()));\n            filterDate = this.parent.hideEmptyAgendaDays ? new Date(firstDate) : this.parent.minDate;\n        }\n        else {\n            filterDate = this.parent.hideEmptyAgendaDays ? addMonths(endDate, -1) : this.parent.minDate;\n        }\n        return resetTime(filterDate);\n    }\n    getEndDateFromStartDate(startDate) {\n        let filterDate;\n        const fieldMapping = this.parent.eventFields;\n        if (this.parent.eventsProcessed.length > 0) {\n            const lastDate = Math.max(...this.parent.eventsProcessed.map((a) => a[fieldMapping.endTime].getTime()));\n            filterDate = this.parent.hideEmptyAgendaDays ? new Date(lastDate) : this.parent.maxDate;\n        }\n        else {\n            filterDate = this.parent.hideEmptyAgendaDays ? addMonths(startDate, 1) : this.parent.maxDate;\n        }\n        return resetTime(addDays(filterDate, 1));\n    }\n    getNextPreviousDate(type) {\n        const noOfDays = (type === 'next') ? 1 : -1;\n        return addDays(this.parent.selectedDate, noOfDays);\n    }\n    startDate() {\n        return resetTime(this.parent.selectedDate);\n    }\n    endDate() {\n        if (this.parent.activeViewOptions.allowVirtualScrolling) {\n            return this.getEndDateFromStartDate(this.startDate());\n        }\n        else {\n            return addDays(this.startDate(), this.parent.agendaDaysCount);\n        }\n    }\n    getDateRangeText(date) {\n        const formatDate = (this.parent.activeViewOptions.dateFormat) ? this.parent.activeViewOptions.dateFormat : 'MMMM y';\n        if (this.parent.activeViewOptions.allowVirtualScrolling || this.parent.isAdaptive) {\n            const currentDate = isNullOrUndefined(date) ? this.parent.selectedDate : date;\n            return capitalizeFirstWord(this.parent.globalize.formatDate(currentDate, { format: formatDate, calendar: this.parent.getCalendarMode() }), 'multiple');\n        }\n        else {\n            const startDate = this.parent.selectedDate;\n            const endDate = addDays(startDate, this.parent.agendaDaysCount - 1);\n            return this.formatDateRange(startDate, endDate);\n        }\n    }\n    dayNavigationClick(e) {\n        const element = closest(e.currentTarget, '.' + AGENDA_CELLS_CLASS);\n        const date = this.parent.getDateFromElement(element);\n        if (!isNullOrUndefined(date) && !this.parent.isAdaptive && this.parent.isMinMaxDate(date)) {\n            this.parent.setProperties({ selectedDate: date }, true);\n            this.parent.changeView('Day', e);\n        }\n    }\n    wireEvents() {\n        EventHandler.add(this.element.querySelector('.' + CONTENT_WRAP_CLASS), scroll, this.agendaScrolling, this);\n    }\n    unWireEvents() {\n        EventHandler.remove(this.element.querySelector('.' + CONTENT_WRAP_CLASS), scroll, this.agendaScrolling);\n        const dateHeaderElement = [].slice.call(this.element.querySelectorAll('.e-m-date'));\n        for (const element of dateHeaderElement) {\n            EventHandler.remove(element, 'click', this.dayNavigationClick);\n        }\n    }\n    addEventListener() {\n        this.parent.on(scrollUiUpdate, this.onAgendaScrollUiUpdate, this);\n        this.parent.on(dataReady, this.eventLoad, this);\n    }\n    removeEventListener() {\n        if (this.parent) {\n            this.parent.off(scrollUiUpdate, this.onAgendaScrollUiUpdate);\n            this.parent.off(dataReady, this.eventLoad);\n        }\n    }\n    onAgendaScrollUiUpdate() {\n        const headerHeight = this.getHeaderBarHeight();\n        if (this.parent.headerModule) {\n            if (this.parent.activeViewOptions.allowVirtualScrolling) {\n                this.parent.headerModule.updateHeaderItems('add');\n            }\n            else {\n                this.parent.headerModule.updateHeaderItems('remove');\n            }\n        }\n        const contentArea = this.element.querySelector('.' + CONTENT_WRAP_CLASS);\n        if (this.parent.height !== 'auto') {\n            contentArea.style.height = formatUnit(this.parent.element.offsetHeight - headerHeight);\n        }\n    }\n    destroy() {\n        if (!this.parent || this.parent && this.parent.isDestroyed) {\n            return;\n        }\n        if (this.element) {\n            this.unWireEvents();\n            if (this.parent.resourceBase) {\n                this.parent.resourceBase.destroy();\n            }\n            if (this.parent.headerModule && this.parent.activeViewOptions.allowVirtualScrolling) {\n                this.parent.headerModule.updateHeaderItems('remove');\n            }\n            super.destroy();\n        }\n    }\n}\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\n/**\n * month agenda view\n */\nclass MonthAgenda extends Month {\n    constructor(parent) {\n        super(parent);\n        this.dayNameFormat = 'narrow';\n        this.viewClass = 'e-month-agenda-view';\n        this.monthAgendaDate = new Date('' + parent.selectedDate);\n    }\n    getModuleName() {\n        return 'monthAgenda';\n    }\n    renderAppointmentContainer() {\n        const contentArea = this.getContentAreaElement();\n        const wrapperContainer = createElement('div', { className: WRAPPER_CONTAINER_CLASS });\n        contentArea.appendChild(wrapperContainer);\n        const appWrap = createElement('div', { className: APPOINTMENT_WRAP_CLASS });\n        wrapperContainer.appendChild(appWrap);\n        this.appendAppContainer(appWrap);\n        this.setEventWrapperHeight();\n    }\n    getDayNameFormat() {\n        if (this.parent.isAdaptive) {\n            return 'narrow';\n        }\n        return 'abbreviated';\n    }\n    setEventWrapperHeight() {\n        let headerHeight = (this.parent.headerModule ? this.parent.headerModule.getHeaderElement().offsetHeight : 0) + 2;\n        const resourceWrapper = this.parent.element.querySelector('.' + RESOURCE_HEADER_TOOLBAR);\n        if (resourceWrapper) {\n            headerHeight += resourceWrapper.offsetHeight;\n        }\n        const contentArea = this.getContentAreaElement().firstElementChild;\n        const dateHeader = this.element.querySelector('.' + DATE_HEADER_WRAP_CLASS);\n        const availHeight = this.parent.element.offsetHeight - headerHeight - dateHeader.offsetHeight - contentArea.offsetHeight;\n        const wrapperContainer = this.element.querySelector('.' + WRAPPER_CONTAINER_CLASS);\n        const eventWrapper = this.element.querySelector('.' + APPOINTMENT_WRAP_CLASS);\n        if (this.parent.height !== 'auto') {\n            wrapperContainer.style.height = eventWrapper.style.height = formatUnit(availHeight);\n        }\n    }\n    onDataReady(args) {\n        this.setEventWrapperHeight();\n        this.clearElements();\n        let eventCollection = args.processedData;\n        if (this.parent.uiStateValues.isGroupAdaptive) {\n            const resource = this.parent.resourceBase.lastResourceLevel[this.parent.uiStateValues.groupIndex];\n            eventCollection = this.parent.eventBase.filterEventsByResource(resource, eventCollection);\n        }\n        this.agendaBase = this.getAgendaBase();\n        this.parent.eventsProcessed = this.agendaBase.processAgendaEvents(eventCollection);\n        let count = 0;\n        for (const date of this.renderDates) {\n            const filterData = this.appointmentFiltering(date);\n            const workCell = this.element.querySelectorAll('.' + WORK_CELLS_CLASS)[count];\n            if (filterData.length > 0) {\n                if (!workCell.querySelector('.' + APPOINTMENT_INDICATOR_CLASS)) {\n                    workCell.appendChild(createElement('div', { className: APPOINTMENT_INDICATOR_CLASS }));\n                }\n                if (date.getTime() === resetTime(new Date(this.monthAgendaDate.getTime())).getTime()) {\n                    this.onEventRender(filterData, date);\n                }\n            }\n            count++;\n        }\n        this.parent.notify(eventsLoaded, {});\n    }\n    onCellClick(event) {\n        if (this.parent.quickPopup) {\n            this.parent.quickPopup.quickPopupHide();\n        }\n        const filterData = this.appointmentFiltering(event.startTime);\n        this.onEventRender(filterData, event.startTime);\n        this.parent.notify(eventsLoaded, {});\n        this.monthAgendaDate = new Date('' + event.startTime);\n    }\n    onEventRender(events, date) {\n        this.agendaBase = this.getAgendaBase();\n        const appWrap = this.element.querySelector('.' + APPOINTMENT_WRAP_CLASS);\n        removeChildren(appWrap);\n        if (this.parent.activeViewOptions.group.resources.length === 0 || this.parent.uiStateValues.isGroupAdaptive) {\n            if (events.length > 0) {\n                const appContainer = createElement('div', { className: APPOINTMENT_CONTAINER_CLASS });\n                appWrap.appendChild(this.agendaBase.createAgendaContentElement('data', events, appContainer));\n            }\n            else {\n                this.appendAppContainer(appWrap);\n            }\n        }\n        else {\n            if (events.length > 0) {\n                const table = this.createTableLayout();\n                const tBody = table.querySelector('tbody');\n                this.agendaBase.calculateResourceTableElement(tBody, 1, date);\n                table.appendChild(tBody);\n                appWrap.appendChild(table);\n            }\n            else {\n                this.appendAppContainer(appWrap);\n            }\n        }\n        this.agendaBase.wireEventActions();\n    }\n    appointmentFiltering(date) {\n        const dateStart = resetTime(new Date(date.getTime()));\n        const dateEnd = setTime(new Date(dateStart.getTime()), MS_PER_DAY);\n        return this.parent.eventBase.filterEvents(dateStart, dateEnd);\n    }\n    clearElements() {\n        const appointmentIndicators = [].slice.call(this.element.querySelectorAll('.' + APPOINTMENT_INDICATOR_CLASS));\n        for (const appointmentIndicator of appointmentIndicators) {\n            remove(appointmentIndicator);\n        }\n        this.appendAppContainer(this.element.querySelector('.' + APPOINTMENT_WRAP_CLASS));\n    }\n    appendAppContainer(appWrap) {\n        const app = createElement('div', { className: APPOINTMENT_CONTAINER_CLASS });\n        addClass([app], AGENDA_NO_EVENT_CLASS);\n        app.innerHTML = this.parent.localeObj.getConstant('noEvents');\n        removeChildren(appWrap);\n        appWrap.appendChild(app);\n    }\n    getNextPreviousDate(type) {\n        const selectedDate = this.parent.selectedDate;\n        const interval = (type === 'next') ? this.parent.activeViewOptions.interval : -this.parent.activeViewOptions.interval;\n        const navigateDate = addMonths(this.parent.selectedDate, interval);\n        const month = (type === 'next') ? 2 : 0;\n        const lastDate = new Date(selectedDate.getFullYear(), selectedDate.getMonth() + month, 0).getDate();\n        const date = (lastDate >= this.monthAgendaDate.getDate()) ? this.monthAgendaDate.getDate() : lastDate;\n        this.monthAgendaDate = new Date(navigateDate.getFullYear(), navigateDate.getMonth(), date);\n        return this.monthAgendaDate;\n    }\n    getAgendaBase() {\n        return this.agendaBase || new AgendaBase(this.parent);\n    }\n    destroy() {\n        if (this.agendaBase) {\n            this.agendaBase.destroy();\n            this.agendaBase = null;\n        }\n        super.destroy();\n    }\n}\n\n/**\n * timeline header rows\n */\nclass TimelineHeaderRow {\n    constructor(parent, renderDates) {\n        this.parent = parent;\n        this.renderDates = renderDates;\n    }\n    groupByYear(dates) {\n        const result = {};\n        for (const d of dates) {\n            const key = d.getFullYear();\n            result[key] = result[key] || [];\n            result[key].push(d);\n        }\n        return result;\n    }\n    groupByMonth(dates) {\n        const result = {};\n        for (const d of dates) {\n            const key = (d.getFullYear() - 1970) * 12 + d.getMonth();\n            result[key] = result[key] || [];\n            result[key].push(d);\n        }\n        return result;\n    }\n    groupByWeek(dates) {\n        const result = {};\n        for (const d of dates) {\n            const jsDate = +new Date(1970, 0, 1);\n            const tzOffsetDiff = d.getTimezoneOffset() - new Date(1970, 0, 1).getTimezoneOffset();\n            let key = Math.ceil(((((+d - jsDate) - (tzOffsetDiff * 60 * 1000)) / MS_PER_DAY) + new Date(jsDate).getDay() + 1) / 7);\n            if (this.parent.firstDayOfWeek && this.parent.firstDayOfWeek > new Date(+d).getDay()) {\n                key = key - 1;\n            }\n            result[key] = result[key] || [];\n            result[key].push(d);\n        }\n        return result;\n    }\n    generateSlots(data, colspan, row, cls, type) {\n        const dateParser = (date, format) => this.parent.globalize.formatDate(date, { format: format, calendar: this.parent.getCalendarMode() });\n        const tdDatas = [];\n        const keys = Object.keys(data);\n        for (let i = 0; i < keys.length; i++) {\n            const dates = data[keys[i]];\n            let htmlCol;\n            if (row.template) {\n                const args = { date: dates[0], type: type };\n                const templateId = this.parent.element.id + '_headerRowTemplate';\n                htmlCol = [].slice.call(this.parent.templateParser(row.template)(args, this.parent, 'template', templateId, false));\n            }\n            else {\n                let viewTemplate;\n                switch (row.option) {\n                    case 'Year':\n                        viewTemplate = `<span class=\"e-header-year\">${dateParser(dates[0], 'y')}</span>`;\n                        break;\n                    case 'Month':\n                        viewTemplate = `<span class=\"e-header-month\">${capitalizeFirstWord(dateParser(dates[0], 'MMMM'), 'single')}</span>`;\n                        break;\n                    case 'Week':\n                        viewTemplate = `<span class=\"e-header-week\">${this.parent.getWeekNumberContent(dates)}</span>`;\n                }\n                const headerWrapper = createElement('div', { innerHTML: viewTemplate });\n                htmlCol = [].slice.call(headerWrapper.childNodes);\n            }\n            tdDatas.push({ date: dates[0], type: type, className: [cls], colSpan: dates.length * colspan, template: htmlCol });\n        }\n        return tdDatas;\n    }\n    generateColumnLevels(dateSlots, hourSlots) {\n        const levels = [];\n        const rows = this.parent.activeViewOptions.headerRows;\n        let lastLevelColspan = 1;\n        if (rows[rows.length - 1].option === 'Hour' && hourSlots.length > 0) {\n            lastLevelColspan = hourSlots.length / dateSlots.length;\n        }\n        let tdDatas = [];\n        let byYear;\n        let byMonth;\n        let byWeek;\n        for (const row of rows) {\n            switch (row.option) {\n                case 'Year':\n                    byYear = this.groupByYear(this.renderDates);\n                    tdDatas = this.generateSlots(byYear, lastLevelColspan, row, 'e-header-year-cell', 'yearHeader');\n                    levels.push(tdDatas);\n                    break;\n                case 'Month':\n                    byMonth = this.groupByMonth(this.renderDates);\n                    tdDatas = this.generateSlots(byMonth, lastLevelColspan, row, 'e-header-month-cell', 'monthHeader');\n                    levels.push(tdDatas);\n                    break;\n                case 'Week':\n                    byWeek = this.groupByWeek(this.renderDates);\n                    tdDatas = this.generateSlots(byWeek, lastLevelColspan, row, 'e-header-week-cell', 'weekHeader');\n                    levels.push(tdDatas);\n                    break;\n                case 'Date':\n                    tdDatas = dateSlots;\n                    tdDatas = tdDatas.map((value) => {\n                        value.colSpan = lastLevelColspan;\n                        return value;\n                    });\n                    levels.push(tdDatas);\n                    break;\n                case 'Hour':\n                    if (hourSlots.length > 0) {\n                        levels.push(hourSlots);\n                    }\n                    break;\n            }\n        }\n        return levels;\n    }\n}\n\n/**\n * timeline views\n */\nclass TimelineViews extends VerticalView {\n    constructor(parent) {\n        super(parent);\n        this.timelineAppointment = null;\n        this.baseCssClass = 'e-timeline-view';\n    }\n    getModuleName() {\n        return 'timelineViews';\n    }\n    getLeftPanelElement() {\n        return this.element.querySelector('.' + RESOURCE_COLUMN_WRAP_CLASS);\n    }\n    scrollTopPanel(target) {\n        super.scrollTopPanel(target);\n        this.scrollHeaderLabels(target);\n    }\n    scrollToWorkHour() {\n        const start = this.parent.getStartEndTime(this.parent.workHours.start);\n        const currDateTime = this.isWorkDay(this.parent.selectedDate) && this.parent.workHours.highlight &&\n            !isNullOrUndefined(start) ? new Date(+this.parent.selectedDate).setHours(start.getHours(), start.getMinutes(), 0, 0)\n            : new Date(+this.parent.selectedDate).setHours(0, 0, 0, 0);\n        const queryString = '[data-date=\"' + new Date(currDateTime).getTime().toString() + '\"]';\n        const firstWorkHourCell = this.element.querySelector(queryString);\n        if (firstWorkHourCell) {\n            this.getContentAreaElement().scrollLeft = !this.parent.enableRtl ? firstWorkHourCell.offsetLeft :\n                -(this.parent.getContentTable().offsetWidth - firstWorkHourCell.offsetLeft - firstWorkHourCell.offsetWidth);\n        }\n    }\n    scrollToHour(hour, scrollDate) {\n        let date;\n        let index;\n        if (scrollDate) {\n            index = this.parent.getIndexOfDate(this.renderDates, resetTime(scrollDate));\n            if (index >= 0) {\n                const timeString = hour.split(':');\n                if (timeString.length === 2) {\n                    date = new Date(scrollDate.setHours(parseInt(timeString[0], 10), parseInt(timeString[1], 10), 0));\n                }\n            }\n        }\n        date = isNullOrUndefined(scrollDate) ? this.parent.getStartEndTime(hour) : date;\n        if (isNullOrUndefined(date)) {\n            return;\n        }\n        const scrollLeft = isNullOrUndefined(scrollDate) ? this.getLeftFromDateTime(null, date) :\n            this.getLeftFromDateTime([index], date);\n        this.getScrollableElement().scrollLeft = !this.parent.enableRtl ? scrollLeft : -scrollLeft;\n    }\n    generateColumnLevels() {\n        let levels = [];\n        const dateSlots = this.getDateSlots(this.renderDates, this.parent.activeViewOptions.workDays);\n        levels.push(dateSlots);\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            this.parent.resourceBase.generateResourceLevels(dateSlots, !this.parent.uiStateValues.isGroupAdaptive);\n        }\n        let hourSlots = [];\n        if (this.parent.activeViewOptions.timeScale.enable) {\n            hourSlots = this.generateTimeSlots(levels[levels.length - 1]);\n            levels.push(hourSlots);\n        }\n        if (this.parent.activeViewOptions.headerRows.length > 0) {\n            const renderGn = new TimelineHeaderRow(this.parent, this.renderDates);\n            levels = renderGn.generateColumnLevels(dateSlots, hourSlots);\n        }\n        return levels;\n    }\n    generateTimeSlots(dateSlots) {\n        const handler = (r) => {\n            r.type = r.first ? 'majorSlot' : 'minorSlot';\n            r.className = r.first ? [TIME_SLOT_CLASS] : [TIME_SLOT_CLASS, TIME_CELLS_CLASS];\n            r.workDays = this.parent.activeViewOptions.workDays;\n            return r;\n        };\n        const timeSlotData = this.getTimeSlotRows(handler);\n        const slots = [];\n        for (const data of dateSlots) {\n            data.colSpan = timeSlotData.length;\n            const tempTimeSlots = extend([], timeSlotData, null, true);\n            for (const slot of tempTimeSlots) {\n                const cellDate = resetTime(new Date('' + data.date));\n                slot.date = setTime(cellDate, getDateInMs(slot.date));\n                slots.push(slot);\n            }\n        }\n        return slots;\n    }\n    changeCurrentTimePosition() {\n        if (!this.parent || this.parent && this.parent.isDestroyed) {\n            return;\n        }\n        this.removeCurrentTimeIndicatorElements();\n        const currentDateIndex = this.getCurrentTimeIndicatorIndex();\n        const left = this.getLeftFromDateTime(currentDateIndex, this.parent.getCurrentTime());\n        const height = this.element.querySelector('.' + CONTENT_TABLE_CLASS).offsetHeight;\n        const headerWrap = this.element.querySelector('.' + DATE_HEADER_WRAP_CLASS);\n        const contentWrap = this.element.querySelector('.' + CONTENT_WRAP_CLASS);\n        contentWrap.appendChild(createElement('div', {\n            className: CURRENT_TIMELINE_CLASS,\n            styles: (this.parent.enableRtl ? 'right' : 'left') + ':' + formatUnit(left) + '; height:' + formatUnit(height)\n        }));\n        if (this.parent.virtualScrollModule) {\n            const timeIndicator = this.parent.element.querySelector('.' + CURRENT_TIMELINE_CLASS);\n            const element = this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS + ' table');\n            setStyleAttribute(timeIndicator, {\n                transform: element.style.transform\n            });\n        }\n        const currentTimeEle = createElement('div', {\n            innerHTML: this.parent.getTimeString(this.parent.getCurrentTime()),\n            className: CURRENT_TIME_CLASS\n        });\n        headerWrap.appendChild(currentTimeEle);\n        currentTimeEle.style[this.parent.enableRtl ? 'right' : 'left'] = formatUnit(left - (currentTimeEle.offsetWidth / 2));\n    }\n    getLeftFromDateTime(currentDateIndex, date) {\n        const startHour = this.getStartHour();\n        const endHour = this.getEndHour();\n        let diffInDates = 0;\n        let diffInMinutes = ((date.getHours() - startHour.getHours()) * 60) + (date.getMinutes() - startHour.getMinutes());\n        if (!isNullOrUndefined(currentDateIndex)) {\n            const end = (endHour.getHours() === 0) ? 24 : endHour.getHours();\n            if (currentDateIndex[0] !== 0) {\n                diffInDates = (currentDateIndex[0]) * ((end - startHour.getHours()) * 60) + (endHour.getMinutes() - startHour.getMinutes());\n            }\n            diffInMinutes = diffInDates + diffInMinutes;\n        }\n        return (diffInMinutes * this.getWorkCellWidth() * this.parent.activeViewOptions.timeScale.slotCount) /\n            this.parent.activeViewOptions.timeScale.interval;\n    }\n    getWorkCellWidth() {\n        return this.element.querySelector('.e-work-cells').getBoundingClientRect().width;\n    }\n    renderHeader() {\n        const tr = createElement('tr');\n        if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n            this.parent.resourceBase.renderResourceHeaderIndent(tr);\n        }\n        const dateTd = createElement('td');\n        dateTd.appendChild(this.renderDatesHeader());\n        tr.appendChild(dateTd);\n        prepend([tr], this.element.querySelector('tbody'));\n    }\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    createAllDayRow(table, tdData) { }\n    getCurrentTimeIndicatorIndex() {\n        const currentDateIndex = [];\n        const index = this.parent.getIndexOfDate(this.renderDates, resetTime(this.parent.getCurrentTime()));\n        if (index >= 0) {\n            currentDateIndex.push(index);\n        }\n        return currentDateIndex;\n    }\n    renderContent() {\n        const tr = createElement('tr');\n        if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n            const resTd = createElement('td');\n            resTd.appendChild(this.parent.resourceBase.createResourceColumn());\n            tr.appendChild(resTd);\n        }\n        const workTd = createElement('td');\n        const wrap = this.renderContentArea();\n        wrap.appendChild(this.createEventTable(this.getRowCount()));\n        this.collapseRows(wrap);\n        workTd.appendChild(wrap);\n        tr.appendChild(workTd);\n        if (this.parent.virtualScrollModule) {\n            this.parent.virtualScrollModule.renderVirtualTrack(wrap);\n        }\n        this.element.querySelector('tbody').appendChild(tr);\n    }\n    getRowCount() {\n        if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n            return this.parent.resourceBase.renderedResources.length;\n        }\n        return 1;\n    }\n    getResourceTdData(i, tdData) {\n        const resLevel = this.parent.resourceBase.renderedResources[i];\n        const resSHr = resLevel.resourceData[resLevel.resource.startHourField] || this.parent.workHours.start;\n        const resEHr = resLevel.resourceData[resLevel.resource.endHourField] || this.parent.workHours.end;\n        tdData.startHour = this.parent.getStartEndTime(resSHr);\n        tdData.endHour = this.parent.getStartEndTime(resEHr);\n        tdData.workDays = resLevel.resourceData[resLevel.resource.workDaysField] || this.parent.workDays;\n        tdData.className = resLevel.className;\n        tdData.groupIndex = resLevel.groupIndex;\n        tdData.groupOrder = resLevel.groupOrder;\n        return tdData;\n    }\n    renderContentTable(table) {\n        const tBody = table.querySelector('tbody');\n        append(this.getContentRows(), tBody);\n    }\n    getContentRows() {\n        const rows = [];\n        const tr = createElement('tr', { attrs: { role: 'row' } });\n        const td = createElement('td', { attrs: { role: 'gridcell', 'aria-selected': 'false' } });\n        const trCount = this.getRowCount();\n        for (let i = 0; i < trCount; i++) {\n            const ntr = tr.cloneNode();\n            for (let tdData of this.colLevels[this.colLevels.length - 1]) {\n                if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n                    tdData = this.getResourceTdData(i, tdData);\n                }\n                const ntd = this.createContentTd(tdData, tdData, td);\n                ntr.appendChild(ntd);\n            }\n            rows.push(ntr);\n        }\n        return rows;\n    }\n    getContentTdClass(r) {\n        return (r.first || !this.parent.activeViewOptions.timeScale.enable) ? [WORK_CELLS_CLASS] :\n            [WORK_CELLS_CLASS, ALTERNATE_CELLS_CLASS];\n    }\n    renderEvents() {\n        this.timelineAppointment = new TimelineEvent(this.parent, this.parent.activeViewOptions.timeScale.enable ? 'hour' : 'day');\n        this.timelineAppointment.renderAppointments();\n        this.parent.notify(eventsLoaded, {});\n    }\n    getAdjustedDate(date) {\n        if (!this.parent.activeViewOptions.timeScale.enable) {\n            return new Date(date.setHours(0, 0, 0, 0));\n        }\n        else {\n            const timeSlots = this.colLevels[this.colLevels.length - 1];\n            for (let i = 0; i < timeSlots.length; i++) {\n                if (timeSlots[i].date.getTime() > date.getTime()) {\n                    return timeSlots[i - 1].date;\n                }\n            }\n        }\n        return null;\n    }\n    destroy() {\n        if (!this.parent || this.parent && this.parent.isDestroyed) {\n            return;\n        }\n        if (this.timelineAppointment) {\n            this.timelineAppointment.destroy();\n            this.timelineAppointment = null;\n        }\n        super.destroy();\n    }\n}\n\n/**\n * timeline month view\n */\nclass TimelineMonth extends Month {\n    constructor(parent) {\n        super(parent);\n        this.viewClass = 'e-timeline-month-view';\n        this.isInverseTableSelect = true;\n        this.appointment = null;\n    }\n    getModuleName() {\n        return 'timelineMonth';\n    }\n    onDataReady() {\n        this.appointment = new TimelineEvent(this.parent, 'day');\n        this.appointment.renderAppointments();\n        this.parent.notify(eventsLoaded, {});\n    }\n    getLeftPanelElement() {\n        return this.element.querySelector('.' + RESOURCE_COLUMN_WRAP_CLASS);\n    }\n    scrollTopPanel(target) {\n        super.scrollTopPanel(target);\n        this.scrollHeaderLabels(target);\n    }\n    setContentHeight(content, leftPanelElement, height) {\n        if (leftPanelElement) {\n            leftPanelElement.style.height = formatUnit(height - this.getScrollXIndent(content));\n        }\n        content.style.height = formatUnit(height);\n    }\n    getDateSlots(renderDates, workDays) {\n        const dateSlots = [];\n        for (const col of renderDates) {\n            const classList$$1 = [HEADER_CELLS_CLASS];\n            if (this.isCurrentDate(col)) {\n                classList$$1.push(CURRENT_DAY_CLASS);\n            }\n            dateSlots.push({ date: col, type: 'dateHeader', className: classList$$1, colSpan: 1, workDays: workDays });\n        }\n        return dateSlots;\n    }\n    renderLeftIndent(tr) {\n        if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n            this.parent.resourceBase.renderResourceHeaderIndent(tr);\n        }\n    }\n    renderContent() {\n        const contentTr = createElement('tr');\n        if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n            const resTd = createElement('td');\n            resTd.appendChild(this.parent.resourceBase.createResourceColumn());\n            contentTr.appendChild(resTd);\n        }\n        const contentTd = createElement('td');\n        this.element.querySelector('tbody').appendChild(contentTr);\n        const wrap = createElement('div', { className: CONTENT_WRAP_CLASS });\n        wrap.appendChild(this.renderContentArea());\n        wrap.appendChild(this.createEventTable(this.getRowCount()));\n        this.collapseRows(wrap);\n        EventHandler.add(wrap, 'scroll', this.onContentScroll, this);\n        contentTd.appendChild(wrap);\n        if (this.parent.virtualScrollModule) {\n            this.parent.virtualScrollModule.renderVirtualTrack(wrap);\n        }\n        contentTr.appendChild(contentTd);\n    }\n    getRowCount() {\n        if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n            return this.parent.resourceBase.renderedResources.length;\n        }\n        return 1;\n    }\n    getContentSlots() {\n        const slotDatas = [];\n        for (let row = 0; row < this.getRowCount(); row++) {\n            for (const data of this.colLevels[this.colLevels.length - 1]) {\n                data.className = [WORK_CELLS_CLASS];\n                if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n                    const resLevel = this.parent.resourceBase.renderedResources[row];\n                    data.workDays = resLevel.resourceData[resLevel.resource.workDaysField] || this.parent.workDays;\n                    data.className = data.className.concat(resLevel.className);\n                    data.groupIndex = resLevel.groupIndex;\n                    data.groupOrder = resLevel.groupOrder;\n                }\n                const slotData = {\n                    date: new Date(+data.date), colSpan: data.colSpan, groupIndex: data.groupIndex, workDays: data.workDays,\n                    type: 'monthCells', className: data.className\n                };\n                if (!slotDatas[row]) {\n                    slotDatas[row] = [];\n                }\n                slotDatas[row].push(slotData);\n            }\n        }\n        return slotDatas;\n    }\n    updateClassList(data) {\n        if (!this.parent.isMinMaxDate(data.date)) {\n            data.className.push(DISABLE_DATES);\n        }\n    }\n    unWireEvents() {\n        EventHandler.remove(this.getContentAreaElement(), 'scroll', this.onContentScroll);\n    }\n    getMonthStart(currentDate) {\n        const monthStart = this.parent.calendarUtil.firstDateOfMonth(resetTime(currentDate));\n        return new Date(monthStart.getFullYear(), monthStart.getMonth(), monthStart.getDate());\n    }\n    getMonthEnd(currentDate) {\n        const monthStart = this.parent.calendarUtil.firstDateOfMonth(resetTime(currentDate));\n        return this.parent.calendarUtil.lastDateOfMonth(addMonths(new Date(+monthStart), this.parent.activeViewOptions.interval - 1));\n    }\n    generateColumnLevels() {\n        let colLevels = [];\n        const level = this.getDateSlots(this.renderDates, this.parent.activeViewOptions.workDays);\n        colLevels.push(level);\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            this.parent.resourceBase.generateResourceLevels(level, !this.parent.uiStateValues.isGroupAdaptive);\n        }\n        const hourSlots = [];\n        if (this.parent.activeViewOptions.headerRows.length > 0) {\n            const renderGn = new TimelineHeaderRow(this.parent, this.renderDates);\n            colLevels = renderGn.generateColumnLevels(level, hourSlots);\n        }\n        this.colLevels = colLevels;\n        return colLevels;\n    }\n    getAdjustedDate(startTime) {\n        const timeSlots = this.colLevels[this.colLevels.length - 1];\n        for (let i = 0; i < timeSlots.length; i++) {\n            if (timeSlots[i].date.getTime() > startTime.getTime()) {\n                return timeSlots[i - 1].date;\n            }\n        }\n        return null;\n    }\n    destroy() {\n        if (!this.parent || this.parent && this.parent.isDestroyed) {\n            return;\n        }\n        if (this.element) {\n            const contentScrollableEle = this.element.querySelector('.' + CONTENT_WRAP_CLASS);\n            if (contentScrollableEle) {\n                EventHandler.remove(contentScrollableEle, 'scroll', this.onContentScroll);\n            }\n        }\n        if (this.appointment) {\n            this.appointment.destroy();\n            this.appointment = null;\n        }\n        super.destroy();\n    }\n}\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\n/**\n * timeline year view\n */\nclass TimelineYear extends Year {\n    constructor(parent) {\n        super(parent);\n        this.viewClass = 'e-timeline-year-view';\n        this.isInverseTableSelect = true;\n    }\n    getModuleName() {\n        return 'timelineYear';\n    }\n    renderHeader(headerWrapper) {\n        const tr = createElement('tr');\n        headerWrapper.appendChild(tr);\n        if (this.parent.activeViewOptions.orientation === 'Vertical' && this.parent.activeViewOptions.group.resources.length > 0 &&\n            !this.parent.uiStateValues.isGroupAdaptive) {\n            this.parent.resourceBase.renderResourceHeaderIndent(tr);\n        }\n        else {\n            const leftHeaderCells = createElement('td', { className: LEFT_INDENT_CLASS });\n            tr.appendChild(leftHeaderCells);\n            leftHeaderCells.appendChild(this.renderResourceHeader(LEFT_INDENT_WRAP_CLASS));\n        }\n        const isHorizontal = this.parent.activeViewOptions.orientation === 'Horizontal';\n        const isGroup = this.parent.activeViewOptions.group.resources.length > 0;\n        this.isInverseTableSelect = isHorizontal && !isGroup ? false : true;\n        const td = createElement('td');\n        tr.appendChild(td);\n        const container = createElement('div', { className: DATE_HEADER_CONTAINER_CLASS });\n        td.appendChild(container);\n        if (this.parent.activeViewOptions.orientation === 'Horizontal' && this.parent.activeViewOptions.group.resources.length > 0 &&\n            !this.parent.uiStateValues.isGroupAdaptive) {\n            container.appendChild(this.renderResourceHeader(DATE_HEADER_WRAP_CLASS));\n            this.columnCount = this.colLevels.slice(-1)[0].length;\n        }\n        else {\n            const wrapper = createElement('div', { className: DATE_HEADER_WRAP_CLASS });\n            container.appendChild(wrapper);\n            const table = this.createTableLayout();\n            wrapper.appendChild(table);\n            table.appendChild(this.createTableColGroup(this.columnCount));\n            const innerTr = createElement('tr');\n            table.querySelector('tbody').appendChild(innerTr);\n            const months = this.getMonths();\n            const dayHeaderDates = this.getMonthDates(new Date(this.parent.selectedDate.getFullYear(), months[0], 1));\n            for (let column = 0; column < this.columnCount; column++) {\n                const date = new Date(this.parent.selectedDate.getFullYear(), months[column], 1);\n                const innerTd = createElement('td', { className: HEADER_CELLS_CLASS });\n                if (this.parent.activeViewOptions.orientation === 'Horizontal') {\n                    if (this.parent.dayHeaderTemplate) {\n                        append(this.renderDayMonthHeaderTemplate(dayHeaderDates[column], column, 'dayHeaderTemplate'), innerTd);\n                    }\n                    else {\n                        innerTd.innerHTML = `<span>${this.parent.getDayNames('abbreviated')[column % 7]}</span>`;\n                    }\n                }\n                else {\n                    if (this.parent.monthHeaderTemplate) {\n                        append(this.renderDayMonthHeaderTemplate(date, months[column], 'monthHeaderTemplate'), innerTd);\n                    }\n                    else {\n                        innerTd.innerHTML = `<span>${this.getMonthName(date)}</span>`;\n                    }\n                    innerTd.setAttribute('data-date', date.getTime().toString());\n                }\n                innerTr.appendChild(innerTd);\n                this.parent.trigger(renderCell, { elementType: 'headerCells', element: innerTd });\n            }\n        }\n    }\n    renderResourceHeader(className) {\n        const wrap = createElement('div', { className: className });\n        const tbl = this.createTableLayout();\n        wrap.appendChild(tbl);\n        const trEle = createElement('tr');\n        if (this.parent.activeViewOptions.group.resources.length > 0) {\n            this.colLevels = this.generateColumnLevels();\n        }\n        else {\n            const colData = [{ className: [HEADER_CELLS_CLASS], type: 'headerCell' }];\n            this.colLevels = [colData];\n        }\n        for (const col of this.colLevels) {\n            const ntr = trEle.cloneNode();\n            const count = className === DATE_HEADER_WRAP_CLASS ? col : [col[0]];\n            for (const c of count) {\n                const tdEle = createElement('td');\n                if (c.className) {\n                    addClass([tdEle], c.className);\n                }\n                if (className === DATE_HEADER_WRAP_CLASS) {\n                    if (c.template) {\n                        append(c.template, tdEle);\n                    }\n                    if (c.colSpan) {\n                        tdEle.setAttribute('colspan', c.colSpan.toString());\n                    }\n                    if (c.groupIndex > -1) {\n                        tdEle.setAttribute('data-group-index', c.groupIndex.toString());\n                    }\n                    this.setResourceHeaderContent(tdEle, c);\n                }\n                if (className === LEFT_INDENT_WRAP_CLASS) {\n                    this.parent.renderHeaderIndentTemplate(c, tdEle);\n                }\n                const args = { elementType: c.type, element: tdEle, date: c.date, groupIndex: c.groupIndex };\n                this.parent.trigger(renderCell, args);\n                ntr.appendChild(tdEle);\n            }\n            tbl.querySelector('tbody').appendChild(ntr);\n        }\n        if (className === DATE_HEADER_WRAP_CLASS) {\n            tbl.appendChild(this.createTableColGroup(this.colLevels.slice(-1)[0].length));\n        }\n        return wrap;\n    }\n    renderContent(contentWrapper) {\n        const tr = createElement('tr');\n        contentWrapper.appendChild(tr);\n        const firstTd = createElement('td');\n        const lastTd = createElement('td');\n        const tdCollection = [];\n        let monthTBody;\n        if (this.parent.activeViewOptions.orientation === 'Vertical' && this.parent.activeViewOptions.group.resources.length > 0 &&\n            !this.parent.uiStateValues.isGroupAdaptive) {\n            tdCollection.push(firstTd);\n            firstTd.appendChild(this.parent.resourceBase.createResourceColumn());\n            this.rowCount = this.parent.resourceBase.renderedResources.length;\n        }\n        else {\n            tdCollection.push(firstTd);\n            const monthWrapper = createElement('div', { className: MONTH_HEADER_WRAPPER });\n            firstTd.appendChild(monthWrapper);\n            monthWrapper.appendChild(this.createTableLayout());\n            monthTBody = monthWrapper.querySelector('tbody');\n        }\n        tdCollection.push(lastTd);\n        append(tdCollection, tr);\n        const content = createElement('div', { className: CONTENT_WRAP_CLASS });\n        lastTd.appendChild(content);\n        const contentTable = this.createTableLayout(CONTENT_TABLE_CLASS);\n        content.appendChild(contentTable);\n        const eventWrapper = createElement('div', { className: EVENT_TABLE_CLASS });\n        content.appendChild(eventWrapper);\n        if (this.parent.virtualScrollModule) {\n            this.parent.virtualScrollModule.renderVirtualTrack(content);\n        }\n        const contentTBody = contentTable.querySelector('tbody');\n        if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n            if (this.parent.rowAutoHeight) {\n                const addClassTable = [contentTable];\n                const monthHeader = this.parent.element.querySelector('.' + MONTH_HEADER_WRAPPER + ' .' + SCHEDULE_TABLE_CLASS);\n                if (monthHeader) {\n                    addClassTable.push(monthHeader);\n                }\n                addClass(addClassTable, AUTO_HEIGHT);\n            }\n            const colCount = this.parent.activeViewOptions.orientation === 'Horizontal' ? this.colLevels.slice(-1)[0].length : this.columnCount;\n            contentTable.appendChild(this.createTableColGroup(colCount));\n            this.renderResourceContent(eventWrapper, monthTBody, contentTBody);\n        }\n        else {\n            contentTable.appendChild(this.createTableColGroup(this.columnCount));\n            this.renderDefaultContent(eventWrapper, monthTBody, contentTBody);\n        }\n    }\n    renderDefaultContent(wrapper, monthBody, contentBody) {\n        const months = this.getMonths();\n        const dayHeaderDates = this.getMonthDates(new Date(this.parent.selectedDate.getFullYear(), months[0], 1));\n        for (let month = 0; month < this.rowCount; month++) {\n            wrapper.appendChild(createElement('div', { className: APPOINTMENT_CONTAINER_CLASS }));\n            let monthDate = new Date(this.parent.selectedDate.getFullYear(), months[month], 1);\n            let monthStart = this.parent.calendarUtil.getMonthStartDate(new Date(monthDate.getTime()));\n            let monthEnd = this.parent.calendarUtil.getMonthEndDate(new Date(monthDate.getTime()));\n            const tr = createElement('tr', { attrs: { 'role': 'row' } });\n            const monthTr = tr.cloneNode();\n            monthBody.appendChild(monthTr);\n            const contentTr = tr.cloneNode();\n            contentBody.appendChild(contentTr);\n            const monthTd = createElement('td', { className: MONTH_HEADER_CLASS, attrs: { 'role': 'gridcell' } });\n            if (this.parent.activeViewOptions.orientation === 'Horizontal') {\n                if (this.parent.monthHeaderTemplate) {\n                    append(this.renderDayMonthHeaderTemplate(monthStart, month, 'monthHeaderTemplate'), monthTd);\n                }\n                else {\n                    monthTd.innerHTML = `<span>${this.getMonthName(monthDate)}</span>`;\n                }\n                monthTd.setAttribute('data-date', monthDate.getTime().toString());\n            }\n            else {\n                if (this.parent.dayHeaderTemplate) {\n                    append(this.renderDayMonthHeaderTemplate(dayHeaderDates[month], month, 'dayHeaderTemplate'), monthTd);\n                }\n                else {\n                    monthTd.innerHTML = `<span>${this.parent.getDayNames('abbreviated')[month % 7]}</span>`;\n                }\n            }\n            monthTr.appendChild(monthTd);\n            this.parent.trigger(renderCell, { elementType: 'leftHeaderCells', element: monthTd });\n            let date = new Date(monthStart.getTime());\n            for (let column = 0; column < this.columnCount; column++) {\n                let isDateAvail;\n                if (this.parent.activeViewOptions.orientation === 'Vertical') {\n                    monthDate = new Date(this.parent.selectedDate.getFullYear(), months[column], 1);\n                    monthStart = this.parent.calendarUtil.getMonthStartDate(new Date(monthDate.getTime()));\n                    monthEnd = this.parent.calendarUtil.getMonthEndDate(new Date(monthDate.getTime()));\n                    const dayDate = (month - monthStart.getDay()) + 1;\n                    date = new Date(this.parent.selectedDate.getFullYear(), months[column], dayDate);\n                    isDateAvail = dayDate > 0 && date.getTime() < monthEnd.getTime();\n                }\n                else {\n                    isDateAvail = column >= monthStart.getDay() && date.getTime() < monthEnd.getTime();\n                }\n                const td = createElement('td', {\n                    className: WORK_CELLS_CLASS, attrs: { 'role': 'gridcell', 'aria-selected': 'false' }\n                });\n                contentTr.appendChild(td);\n                const dateHeader = createElement('div', {\n                    className: DATE_HEADER_CLASS + ' ' + NAVIGATE_CLASS,\n                    innerHTML: (isDateAvail) ?\n                        this.parent.globalize.formatDate(date, { skeleton: 'd', calendar: this.parent.getCalendarMode() }) : ''\n                });\n                const skeleton = 'full';\n                const announcementText = this.parent.globalize.formatDate(date, {\n                    skeleton: skeleton, calendar: this.parent.getCalendarMode()\n                });\n                dateHeader.setAttribute('aria-label', announcementText);\n                if (isDateAvail) {\n                    const tds = [td];\n                    const classList$$1 = [];\n                    if (this.parent.activeViewOptions.workDays.indexOf(date.getDay()) > -1) {\n                        classList$$1.push(WORKDAY_CLASS);\n                    }\n                    if (this.isCurrentDate(date)) {\n                        classList$$1.push(CURRENT_DAY_CLASS);\n                        if (this.parent.activeViewOptions.orientation === 'Horizontal') {\n                            tds.push(this.element.querySelector('.' + HEADER_CELLS_CLASS + `:nth-child(${column + 1})`));\n                        }\n                        else {\n                            tds.push(this.element.querySelectorAll('.' + MONTH_HEADER_CLASS).item(month));\n                        }\n                    }\n                    if (classList$$1.length > 0) {\n                        addClass(tds, classList$$1);\n                    }\n                }\n                else {\n                    addClass([td], OTHERMONTH_CLASS);\n                }\n                if (td.classList.contains(OTHERMONTH_CLASS)) {\n                    continue;\n                }\n                td.appendChild(dateHeader);\n                if (isDateAvail) {\n                    td.setAttribute('data-date', date.getTime().toString());\n                    this.wireEvents(td, 'cell');\n                }\n                this.renderCellTemplate({ date: date, type: 'workCells' }, td);\n                this.parent.trigger(renderCell, { elementType: 'workCells', element: td, date: date });\n                if (isDateAvail) {\n                    if (this.parent.activeViewOptions.orientation === 'Horizontal') {\n                        date = addDays(new Date(date.getTime()), 1);\n                    }\n                }\n            }\n        }\n    }\n    getContentRows() {\n        const tRow = [];\n        const monthCells = this.getMonths();\n        for (let row = 0; row < this.parent.resourceBase.renderedResources.length; row++) {\n            const tr = createElement('tr', { attrs: { 'role': 'row' } });\n            tRow.push(tr);\n            let resData;\n            if (this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n                resData = this.parent.resourceBase.renderedResources[row];\n            }\n            let monthDate = new Date(this.parent.selectedDate.getFullYear(), monthCells[row], 1);\n            let date = this.parent.calendarUtil.getMonthStartDate(new Date(monthDate.getTime()));\n            for (let month = 0; month < this.columnCount; month++) {\n                let classList$$1 = [];\n                const groupIndex = resData.groupIndex;\n                classList$$1 = classList$$1.concat(resData.className);\n                if (classList$$1.indexOf(RESOURCE_PARENT_CLASS) > -1) {\n                    classList$$1.push(RESOURCE_GROUP_CELLS_CLASS);\n                }\n                else {\n                    classList$$1.push(WORKDAY_CLASS);\n                }\n                monthDate = new Date(this.parent.selectedDate.getFullYear(), monthCells[month], 1);\n                date = this.parent.calendarUtil.getMonthStartDate(new Date(monthDate.getTime()));\n                const tdELe = createElement('td', {\n                    className: WORK_CELLS_CLASS,\n                    attrs: {\n                        'role': 'gridcell', 'aria-selected': 'false',\n                        'data-date': date.getTime().toString()\n                    }\n                });\n                addClass([tdELe], classList$$1);\n                tdELe.setAttribute('data-group-index', groupIndex.toString());\n                this.renderCellTemplate({ date: date, type: 'resourceGroupCells', groupIndex: groupIndex }, tdELe);\n                this.wireEvents(tdELe, 'cell');\n                this.parent.trigger(renderCell, { elementType: 'resourceGroupCells', element: tdELe, date: date });\n                tr.appendChild(tdELe);\n            }\n        }\n        return tRow;\n    }\n    renderResourceContent(wrapper, monthBody, contentBody) {\n        const months = this.getMonths();\n        for (let row = 0; row < this.rowCount; row++) {\n            wrapper.appendChild(createElement('div', { className: APPOINTMENT_CONTAINER_CLASS }));\n            const tr = createElement('tr', { attrs: { 'role': 'row' } });\n            contentBody.appendChild(tr);\n            let resData;\n            if (this.parent.activeViewOptions.orientation === 'Vertical' && this.parent.activeViewOptions.group.resources.length > 0 && !this.parent.uiStateValues.isGroupAdaptive) {\n                resData = this.parent.resourceBase.renderedResources[row];\n            }\n            let monthDate = new Date(this.parent.selectedDate.getFullYear(), months[row], 1);\n            let date = this.parent.calendarUtil.getMonthStartDate(new Date(monthDate.getTime()));\n            if (this.parent.activeViewOptions.orientation === 'Horizontal') {\n                const monthTr = tr.cloneNode();\n                monthBody.appendChild(monthTr);\n                const monthTd = createElement('td', {\n                    className: MONTH_HEADER_CLASS,\n                    attrs: { 'role': 'gridcell', 'data-date': date.getTime().toString() }\n                });\n                if (this.parent.monthHeaderTemplate) {\n                    append(this.renderDayMonthHeaderTemplate(monthDate, row, 'monthHeaderTemplate'), monthTd);\n                }\n                else {\n                    monthTd.innerHTML = `<span>${this.getMonthName(monthDate)}</span>`;\n                }\n                monthTr.appendChild(monthTd);\n            }\n            for (let month = 0; month < this.columnCount; month++) {\n                let classList$$1 = [];\n                let groupIndex;\n                if (this.parent.activeViewOptions.orientation === 'Vertical') {\n                    groupIndex = resData.groupIndex;\n                    classList$$1 = classList$$1.concat(resData.className);\n                    if (classList$$1.indexOf(RESOURCE_PARENT_CLASS) > -1) {\n                        classList$$1.push(RESOURCE_GROUP_CELLS_CLASS);\n                    }\n                    else {\n                        classList$$1.push(WORKDAY_CLASS);\n                    }\n                    monthDate = new Date(this.parent.selectedDate.getFullYear(), months[month], 1);\n                    date = this.parent.calendarUtil.getMonthStartDate(new Date(monthDate.getTime()));\n                }\n                else {\n                    groupIndex = this.colLevels.slice(-1)[0][month].groupIndex;\n                    classList$$1.push(WORKDAY_CLASS);\n                }\n                const td = createElement('td', {\n                    className: WORK_CELLS_CLASS,\n                    attrs: {\n                        'role': 'gridcell', 'aria-selected': 'false',\n                        'data-date': date.getTime().toString()\n                    }\n                });\n                addClass([td], classList$$1);\n                td.setAttribute('data-group-index', groupIndex.toString());\n                this.renderCellTemplate({ date: date, type: 'resourceGroupCells', groupIndex: groupIndex }, td);\n                this.wireEvents(td, 'cell');\n                tr.appendChild(td);\n                this.parent.trigger(renderCell, { elementType: 'resourceGroupCells', element: td, date: date });\n            }\n        }\n        if (this.parent.activeViewOptions.orientation === 'Vertical') {\n            this.collapseRows(this.parent.element.querySelector('.' + CONTENT_WRAP_CLASS));\n        }\n    }\n    renderDayMonthHeaderTemplate(date, column, type) {\n        const args = { date: date, type: type === 'dayHeaderTemplate' ? 'dayHeader' : 'monthHeader' };\n        const dayId = `schedule_${this.parent.activeViewOptions.dayHeaderTemplateName}dayHeaderTemplate`;\n        const monthId = `schedule_${this.parent.activeViewOptions.dayHeaderTemplateName}monthHeaderTemplate`;\n        if (type === 'dayHeaderTemplate') {\n            args.day = this.parent.getDayNames('wide')[column % 7];\n            return [].slice.call(this.parent.getDayHeaderTemplate()(args, this.parent, 'dayHeaderTemplate', dayId, false));\n        }\n        else {\n            return [].slice.call(this.parent.getMonthHeaderTemplate()(args, this.parent, 'monthHeaderTemplate', monthId, false));\n        }\n    }\n    renderCellTemplate(data, td) {\n        if (!this.parent.activeViewOptions.cellTemplate || td.classList.contains(OTHERMONTH_CLASS)) {\n            return;\n        }\n        const args = { date: data.date, type: data.type };\n        if (data.groupIndex) {\n            args.groupIndex = data.groupIndex;\n        }\n        const scheduleId = this.parent.element.id + '_';\n        const viewName = this.parent.activeViewOptions.cellTemplateName;\n        const templateId = scheduleId + viewName + 'cellTemplate';\n        const cellTemplate = [].slice.call(this.parent.getCellTemplate()(args, this.parent, 'cellTemplate', templateId, false));\n        append(cellTemplate, td);\n    }\n    scrollToDate(scrollDate) {\n        if (this.parent.activeViewOptions.group.resources.length === 0) {\n            const date = +new Date(resetTime(scrollDate));\n            const element = this.element.querySelector('[data-date=\"' + date + '\"]');\n            if (element) {\n                this.getScrollableElement().scrollLeft = element.offsetLeft;\n                this.getScrollableElement().scrollTop = element.offsetTop;\n            }\n        }\n    }\n    getScrollableElement() {\n        if (this.parent.isAdaptive && !this.isTimelineView()) {\n            return this.element.querySelector('.' + SCROLL_CONTAINER_CLASS);\n        }\n        else {\n            return this.getContentAreaElement();\n        }\n    }\n}\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\n/**\n * ICalendar Export Module\n */\nclass ICalendarExport {\n    constructor(parent) {\n        this.parent = parent;\n    }\n    initializeCalendarExport(fileName, customData) {\n        let eventsData = (customData) ? customData :\n            extend([], this.parent.eventsData, null, true);\n        eventsData = this.parent.eventBase.sortByTime(eventsData);\n        const SEPARATOR = (navigator.appVersion.indexOf('Win') !== -1) ? '\\r\\n' : '\\n';\n        const iCalendarEvents = [];\n        const filterCollection = [];\n        const timeZone = this.parent.timezone || this.parent.tzModule.getLocalTimezoneName();\n        const fields = this.parent.eventFields;\n        eventsData.forEach((eventObj) => {\n            let uId = eventObj[fields.id] || eventObj.Guid || this.parent.eventBase.generateGuid();\n            const editedExDate = [];\n            if (eventObj[fields.recurrenceID]) {\n                const filter = this.filterEvents(filterCollection, fields.id, eventObj[fields.recurrenceID]);\n                uId = filter.length > 0 ? filter[0].UID : uId;\n            }\n            if (!eventObj[fields.recurrenceID] && eventObj[fields.recurrenceRule] && eventObj[fields.recurrenceException]) {\n                const exDate = (eventObj[fields.recurrenceException]).split(',');\n                const editedObj = this.filterEvents(eventsData, fields.recurrenceID, eventObj[fields.id]);\n                editedObj.forEach((edited) => {\n                    editedExDate.push(getRecurrenceStringFromDate(edited[fields.startTime]));\n                });\n                const exceptionDateList = exDate.filter((value) => editedExDate.indexOf(value) === -1);\n                eventObj[fields.recurrenceException] = (exceptionDateList.length > 0) ? (exceptionDateList.join(',') + ',') : '';\n            }\n            const startZone = (eventObj[fields.startTimezone] || timeZone);\n            const endZone = (eventObj[fields.endTimezone] || timeZone);\n            const readonly = (eventObj[fields.isReadonly]) ? (eventObj[fields.isReadonly]) : false;\n            const calendarEvent = [\n                'BEGIN:VEVENT',\n                'LOCATION:' + (eventObj[fields.location] || ''),\n                'SUMMARY:' + (eventObj[fields.subject] || ''),\n                'UID:' + uId,\n                'DESCRIPTION:' + (eventObj[fields.description] || ''),\n                'ISREADONLY:' + readonly,\n                'END:VEVENT'\n            ];\n            if (eventObj[fields.isAllDay]) {\n                calendarEvent.splice(4, 0, 'DTEND;VALUE=DATE:' + this.convertDateToString(eventObj[fields.endTime], true));\n                calendarEvent.splice(4, 0, 'DTSTART;VALUE=DATE:' + this.convertDateToString(eventObj[fields.startTime], true));\n            }\n            else if (!eventObj[fields.isAllDay] && !eventObj[fields.recurrenceRule]) {\n                calendarEvent.splice(4, 0, 'DTEND:' + this.convertDateToString(eventObj[fields.endTime]));\n                calendarEvent.splice(4, 0, 'DTSTART:' + this.convertDateToString(eventObj[fields.startTime]));\n            }\n            else {\n                calendarEvent.splice(4, 0, 'DTEND;TZID=\"' + endZone + '\":' + this.convertDateToString(eventObj[fields.endTime]));\n                calendarEvent.splice(4, 0, 'DTSTART;TZID=\"' + startZone + '\":'\n                    + this.convertDateToString(eventObj[fields.startTime]));\n            }\n            if (eventObj[fields.recurrenceRule]) {\n                calendarEvent.splice(4, 0, 'RRULE:' + eventObj[fields.recurrenceRule]);\n            }\n            if (eventObj[fields.recurrenceException]) {\n                const exDate = eventObj[fields.recurrenceException].split(',');\n                for (let i = 0; i < exDate.length - 1; i++) {\n                    calendarEvent.splice(5, 0, 'EXDATE:' +\n                        this.convertDateToString(getDateFromRecurrenceDateString(exDate[i]), eventObj[fields.isAllDay]));\n                }\n            }\n            if (eventObj[fields.recurrenceID]) {\n                calendarEvent.splice(4, 0, 'RECURRENCE-ID;TZID=\"' + startZone + '\":'\n                    + this.convertDateToString(eventObj[fields.startTime], eventObj[fields.isAllDay]));\n            }\n            const customFields = this.customFieldFilter(eventObj, fields);\n            if (customFields.length > 0) {\n                customFields.forEach((customField) => calendarEvent.splice(4, 0, customField + ':' + (eventObj[customField] || '')));\n            }\n            const app = extend({}, eventObj);\n            app.UID = uId;\n            filterCollection.push(app);\n            iCalendarEvents.push(calendarEvent.join(SEPARATOR));\n        });\n        const iCalendar = [\n            'BEGIN:VCALENDAR',\n            'PRODID:-//Syncfusion Inc//Scheduler//EN',\n            'VERSION:2.0',\n            'CALSCALE:GREGORIAN',\n            'METHOD:PUBLISH',\n            'X-WR-CALNAME:' + (fileName || 'Calendar'),\n            'X-WR-TIMEZONE:' + timeZone\n        ].join(SEPARATOR);\n        const icsString = iCalendar + SEPARATOR + iCalendarEvents.join(SEPARATOR) + SEPARATOR + 'END:VCALENDAR';\n        this.download(icsString, fileName);\n    }\n    customFieldFilter(eventObj, fields) {\n        const defaultFields = Object.keys(fields).map((key) => fields[key]);\n        const eventFields = Object.keys(eventObj);\n        return eventFields.filter((value) => (defaultFields.indexOf(value) === -1) && (value !== 'Guid'));\n    }\n    convertDateToString(eventDate, allDay) {\n        const year = ('0000' + (eventDate.getFullYear().toString())).slice(-4);\n        const month = ('00' + ((eventDate.getMonth() + 1).toString())).slice(-2);\n        const date = ('00' + ((eventDate.getDate()).toString())).slice(-2);\n        const hours = ('00' + (eventDate.getHours().toString())).slice(-2);\n        const minutes = ('00' + (eventDate.getMinutes().toString())).slice(-2);\n        const seconds = ('00' + (eventDate.getSeconds().toString())).slice(-2);\n        const timeString = (allDay) ? year + month + date : year + month + date + 'T' + hours + minutes + seconds;\n        return timeString;\n    }\n    download(icsString, fileName) {\n        const buffer = new Blob([icsString], { type: 'data:text/calendar;charset=utf8' });\n        fileName = (fileName || 'Calendar') + '.ics';\n        if (navigator.msSaveBlob) {\n            navigator.msSaveBlob(buffer, fileName);\n        }\n        else {\n            const downloadLink = document.createElementNS('http://www.w3.org/1999/xhtml', 'a');\n            downloadLink.download = fileName;\n            downloadLink.href = URL.createObjectURL(buffer);\n            const event = document.createEvent('MouseEvent');\n            event.initEvent('click', true, true);\n            downloadLink.dispatchEvent(event);\n            setTimeout(() => {\n                URL.revokeObjectURL(downloadLink.href);\n                downloadLink.href = undefined;\n            });\n        }\n    }\n    filterEvents(data, field, value) {\n        return data.filter((e) => e[field] === value);\n    }\n    getModuleName() {\n        return 'iCalendarExport';\n    }\n    destroy() {\n        if (!this.parent || this.parent && this.parent.isDestroyed) {\n            return;\n        }\n        this.parent = null;\n    }\n}\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\n/**\n * ICalendar Import Module\n */\nclass ICalendarImport {\n    constructor(parent) {\n        this.allDay = false;\n        this.parent = parent;\n    }\n    initializeCalendarImport(fileContent) {\n        if (fileContent && fileContent instanceof Blob) {\n            const fileReader = new FileReader();\n            fileReader.onload = () => {\n                const iCalString = fileReader.result;\n                this.iCalendarParser(iCalString);\n            };\n            fileReader.readAsText(fileContent, 'UTF-8');\n        }\n        else if (fileContent && typeof fileContent === 'string') {\n            this.iCalendarParser(fileContent);\n        }\n    }\n    iCalendarParser(iCalString) {\n        const fields = this.parent.eventFields;\n        const events = [];\n        const uId = 'UID';\n        const calArray = iCalString.replace(new RegExp('\\\\r', 'g'), '').split('\\n');\n        let isEvent = false;\n        let curEvent;\n        // eslint-disable-next-line prefer-const\n        let id = this.parent.eventBase.getEventMaxID();\n        let count = 0;\n        calArray.forEach((element) => {\n            let index;\n            let type;\n            let value;\n            if (!isEvent && element === 'BEGIN:VEVENT') {\n                isEvent = true;\n                curEvent = {};\n            }\n            if (isEvent && element === 'END:VEVENT') {\n                isEvent = false;\n                events.push(curEvent);\n                curEvent = null;\n            }\n            if (isEvent) {\n                index = element.indexOf(':');\n                type = element.substr(0, index).replace(/^\\s\\s*/, '').replace(/\\s\\s*$/, '');\n                value = element.substr(index + 1, element.length - (index + 1)).replace(/^\\s\\s*/, '').replace(/\\s\\s*$/, '');\n                if (element.indexOf('SUMMARY') !== -1) {\n                    type = 'SUMMARY';\n                }\n                if (element.indexOf('DTSTART') !== -1) {\n                    curEvent[fields.startTime] = this.dateParsing(element);\n                    curEvent[fields.isAllDay] = this.allDay;\n                    this.allDay = false;\n                }\n                else if (element.indexOf('DTEND') !== -1) {\n                    curEvent[fields.endTime] = this.dateParsing(element);\n                }\n                else if (element.indexOf('EXDATE') !== -1) {\n                    value = getRecurrenceStringFromDate(this.dateParsing(element));\n                    curEvent[fields.recurrenceException] = (isNullOrUndefined(curEvent[fields.recurrenceException])) ?\n                        value : curEvent[fields.recurrenceException] + ',' + value;\n                }\n                else if (element.indexOf('RECURRENCE-ID') !== -1) {\n                    value = getRecurrenceStringFromDate(this.dateParsing(element));\n                    curEvent[fields.recurrenceException] = value;\n                    curEvent[fields.recurrenceID] = value;\n                }\n                else {\n                    switch (type) {\n                        case 'BEGIN':\n                            break;\n                        case 'UID':\n                            curEvent[uId] = value;\n                            if (typeof (id) == 'number') {\n                                curEvent[fields.id] = parseInt(value, 10);\n                                if (isNaN(curEvent[fields.id])) {\n                                    curEvent[fields.id] = id + count;\n                                    count++;\n                                }\n                            }\n                            else {\n                                curEvent[fields.id] = value;\n                            }\n                            break;\n                        case 'SUMMARY':\n                            curEvent[fields.subject] = value;\n                            break;\n                        case 'LOCATION':\n                            curEvent[fields.location] = value;\n                            break;\n                        case 'DESCRIPTION':\n                            curEvent[fields.description] = value;\n                            break;\n                        case 'ISREADONLY':\n                            curEvent[fields.isReadonly] = (value.indexOf('true') > -1);\n                            break;\n                        case 'RRULE':\n                            curEvent[fields.recurrenceRule] = value;\n                            break;\n                        default:\n                            if (this.parent.resourceCollection.length > 0) {\n                                const resData = this.parent.resourceCollection.filter((data) => data.field === type);\n                                curEvent[type] = (resData.length > 0 && (typeof (resData[0].dataSource[0][resData[0].idField]) == 'number')) ? parseInt(value, 10) : value;\n                            }\n                            else {\n                                curEvent[type] = value;\n                            }\n                    }\n                }\n            }\n        });\n        const app = extend([], events, null, true);\n        this.parent.addEvent(this.processOccurrence(app));\n    }\n    processOccurrence(app) {\n        const appoint = [];\n        const uId = 'UID';\n        const fields = this.parent.eventFields;\n        let appointmentIds = [];\n        this.parent.eventsData.forEach((eventObj) => {\n            appointmentIds.push(eventObj[fields.id]);\n        });\n        app.forEach((eventObj) => {\n            let parentObj;\n            let id;\n            // eslint-disable-next-line no-prototype-builtins\n            if (!eventObj.hasOwnProperty(fields.recurrenceID)) {\n                parentObj = eventObj;\n                id = eventObj[fields.id];\n            }\n            if (appointmentIds.indexOf(eventObj[fields.id]) < 0) {\n                const data = app.filter((data) => data.UID === eventObj[uId]);\n                if (data.length > 1 && isNullOrUndefined(eventObj[fields.recurrenceID])) {\n                    for (let i = 0; i < data.length; i++) {\n                        // eslint-disable-next-line no-prototype-builtins\n                        if (data[i].hasOwnProperty(fields.recurrenceID)) {\n                            const exdate = data[i][fields.recurrenceID];\n                            data[i][fields.recurrenceID] = id;\n                            data[i][fields.recurrenceException] = null;\n                            parentObj[fields.recurrenceException] = (isNullOrUndefined(parentObj[fields.recurrenceException])) ?\n                                exdate : parentObj[fields.recurrenceException] + ',' + exdate;\n                            appoint.push(data[i]);\n                        }\n                    }\n                    appoint.push(parentObj);\n                    // eslint-disable-next-line no-prototype-builtins\n                }\n                else if (!eventObj.hasOwnProperty(fields.recurrenceID)) {\n                    appoint.push(eventObj);\n                }\n            }\n        });\n        return appoint;\n    }\n    getDateString(value) {\n        value = value || '';\n        // eslint-disable-next-line no-useless-escape\n        return (value.replace(/\\\\\\,/g, ',').replace(/\\\\\\;/g, ';').replace(/\\\\[nN]/g, '\\n').replace(/\\\\\\\\/g, '\\\\'));\n    }\n    dateParsing(element) {\n        const expression = /([^':;]+)((?:;(?:[^':;]+)(?:=(?:(?:'[^']*')|(?:[^':;]+))))*):(.*)/;\n        const split = (element.match(expression)).slice(1);\n        const value = split[split.length - 1];\n        let newDate = new Date(this.getDateString(value));\n        if (element && (element.indexOf('VALUE=DATE') > -1 || element.indexOf('RECURRENCE-ID;TZID') > -1)) {\n            const data = /^(\\d{4})(\\d{2})(\\d{2})$/.exec(value);\n            if (data !== null) {\n                newDate = new Date(parseInt(data[1], 10), parseInt(data[2], 10) - 1, parseInt(data[3], 10));\n            }\n            if (element.indexOf('DTSTART') > -1) {\n                this.allDay = true;\n            }\n        }\n        const data = /^(\\d{4})(\\d{2})(\\d{2})T(\\d{2})(\\d{2})(\\d{2})(Z)?$/.exec(value);\n        if (data !== null) {\n            if (data[7] === 'Z') {\n                newDate = new Date(Date.UTC(parseInt(data[1], 10), parseInt(data[2], 10) - 1, parseInt(data[3], 10), parseInt(data[4], 10), parseInt(data[5], 10), parseInt(data[6], 10)));\n            }\n            else {\n                newDate = new Date(parseInt(data[1], 10), parseInt(data[2], 10) - 1, parseInt(data[3], 10), parseInt(data[4], 10), parseInt(data[5], 10), parseInt(data[6], 10));\n            }\n        }\n        return newDate;\n    }\n    getModuleName() {\n        return 'iCalendarImport';\n    }\n    destroy() {\n        if (!this.parent || this.parent && this.parent.isDestroyed) {\n            return;\n        }\n    }\n}\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\n/**\n * Excel Export Module\n */\nclass ExcelExport {\n    constructor(parent) {\n        this.parent = parent;\n    }\n    initializeExcelExport(excelExportOptions = {}) {\n        const exportColumns = this.getExportColumns(excelExportOptions);\n        const exportName = excelExportOptions.fileName || 'Schedule';\n        const exportType = excelExportOptions.exportType || 'xlsx';\n        const isIncludeOccurrences = excelExportOptions.includeOccurrences || false;\n        let separator;\n        if (!isNullOrUndefined(excelExportOptions.separator) && excelExportOptions.separator !== ',') {\n            separator = excelExportOptions.separator;\n        }\n        let eventCollection;\n        if (excelExportOptions.customData) {\n            eventCollection = !isIncludeOccurrences ? excelExportOptions.customData :\n                this.parent.eventBase.getProcessedEvents(excelExportOptions.customData);\n        }\n        else {\n            eventCollection = !isIncludeOccurrences ? this.parent.eventsData : this.parent.eventsProcessed;\n        }\n        this.processWorkbook(exportColumns, exportName, exportType, eventCollection, separator);\n    }\n    processWorkbook(fields, name, type, eventCollection, separator) {\n        const columns = [];\n        const rows = [];\n        const columnHeader = [];\n        fields.forEach((field, i) => { columns.push({ index: i + 1, width: (field.name === 'Id' ? 50 : 150) }); });\n        const style = { fontSize: 12, borders: { color: '#E0E0E0' }, bold: true };\n        fields.forEach((field, i) => { columnHeader.push({ index: i + 1, value: field.text, style: style }); });\n        rows.push({ index: 1, cells: columnHeader });\n        eventCollection.forEach((event, i) => {\n            const columnData = [];\n            fields.forEach((field, n) => {\n                let columnRule = { index: n + 1, value: event[field.name] || '' };\n                if (field.name === this.parent.eventFields.startTime || field.name === this.parent.eventFields.endTime) {\n                    const styleRule = { fontSize: 12, numberFormat: 'm/d/yyyy h:mm AM/PM' };\n                    columnRule = extend({}, columnRule, { style: styleRule }, true);\n                }\n                columnData.push(columnRule);\n            });\n            rows.push({ index: i + 2, cells: columnData });\n        });\n        const workSheet = [{ columns: columns, rows: rows }];\n        const book = new Workbook({ worksheets: workSheet }, type, this.parent.locale, undefined, separator);\n        book.save(name + '.' + type);\n    }\n    getExportColumns(exportOptions) {\n        const exportColumns = exportOptions.fieldsInfo || [];\n        if (exportColumns.length === 0) {\n            const fields = exportOptions.fields || Object.keys(this.parent.eventFields).map((field) => this.parent.eventFields[field]);\n            fields.forEach((field) => { exportColumns.push({ name: field, text: field }); });\n        }\n        return exportColumns;\n    }\n    getModuleName() {\n        return 'excelExport';\n    }\n    destroy() {\n        this.parent = null;\n    }\n}\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\n/**\n * Print Module\n */\nclass Print {\n    constructor(parent) {\n        this.parent = parent;\n    }\n    print(printOptions) {\n        if (isNullOrUndefined(printOptions)) {\n            this.printScheduler();\n        }\n        else {\n            this.printSchedulerWithModel(printOptions);\n        }\n    }\n    printScheduler() {\n        const clone = this.parent.element.cloneNode(true);\n        clone.id = this.parent.element.id + '_print';\n        document.body.appendChild(clone);\n        const className = this.parent.currentView === 'MonthAgenda' ? '.e-appointment-wrap' : '.e-content-wrap';\n        const scrollableEle = this.parent.element.querySelector(className);\n        const links = [].slice.call(document.getElementsByTagName('head')[0].querySelectorAll('link, style'));\n        let reference = '';\n        for (const link of links) {\n            reference += link.outerHTML;\n        }\n        const div = createElement('div');\n        clone.style.width = this.parent.element.offsetWidth + 'px';\n        const elementWidth = Math.round((parseInt(clone.style.width, 10)) / 100) * 100;\n        div.appendChild(clone);\n        const printWindow = window.open('', 'print', 'height=550,width=' + elementWidth + ',tabbar=no');\n        printWindow.document.write('<!DOCTYPE html><html><head>' + reference + '</head><body>' + div.innerHTML +\n            '<script>(function() { window.ready = true; })();</script></body></html>');\n        printWindow.document.close();\n        printWindow.focus();\n        setTimeout(() => {\n            if (printWindow.ready && scrollableEle) {\n                // eslint-disable-next-line no-self-assign\n                scrollableEle.scrollLeft = scrollableEle.scrollLeft;\n                // eslint-disable-next-line no-self-assign\n                scrollableEle.scrollTop = scrollableEle.scrollTop;\n                const headerTimeCellsScroll = printWindow.document.querySelector('.e-date-header-wrap');\n                if (headerTimeCellsScroll) {\n                    headerTimeCellsScroll.scrollLeft = scrollableEle.scrollLeft;\n                }\n                const timeCellsScroll = printWindow.document.querySelector('.e-time-cells-wrap');\n                if (timeCellsScroll) {\n                    timeCellsScroll.scrollTop = scrollableEle.scrollTop;\n                }\n                printWindow.print();\n                printWindow.close();\n            }\n        }, 500);\n    }\n    printSchedulerWithModel(printOptions) {\n        const element = createElement('div', { id: this.parent.element.id + '_print', className: 'e-print-schedule' });\n        document.body.appendChild(element);\n        Schedule.Inject(Day, Week, WorkWeek, Month, Agenda, MonthAgenda, TimelineViews, TimelineMonth, Year, TimelineYear);\n        this.printInstance = new Schedule(this.getPrintScheduleModel(printOptions));\n        this.printInstance.isPrinting = true;\n        this.printInstance.appendTo(element);\n        this.printInstance.on(print$1, this.contentReady, this);\n        this.printWindow = window.open('', 'print', 'height=' + window.outerHeight + ',width=' + window.outerWidth + ',tabbar=no');\n        this.printWindow.moveTo(0, 0);\n        this.printWindow.resizeTo(screen.availWidth, screen.availHeight);\n    }\n    getPrintScheduleModel(printOptions) {\n        const printModel = {};\n        const scheduleProps = ['agendaDaysCount', 'calendarMode', 'cssClass', 'currentView',\n            'dateFormat', 'enableRtl', 'endHour', 'eventSettings', 'firstDayOfWeek',\n            'firstMonthOfYear', 'group', 'height', 'locale', 'maxDate', 'minDate', 'readonly',\n            'resources', 'rowAutoHeight', 'selectedDate', 'showHeaderBar', 'showTimeIndicator', 'showWeekNumber',\n            'showWeekend', 'startHour', 'timeFormat', 'timeScale', 'timezone', 'views', 'width', 'workDays', 'workHours'\n        ];\n        let eventSettings;\n        let group;\n        for (const key of scheduleProps) {\n            switch (key) {\n                case 'eventSettings':\n                    eventSettings = Object.assign({}, this.parent.eventSettings.properties);\n                    eventSettings.dataSource = this.parent.eventsData;\n                    eventSettings.template = null;\n                    printModel.eventSettings = eventSettings;\n                    break;\n                case 'group':\n                    group = isNullOrUndefined(printOptions.group) ? this.parent.group : printOptions.group;\n                    group.headerTooltipTemplate = null;\n                    printModel.group = group;\n                    break;\n                default:\n                    printModel[key] = isNullOrUndefined(printOptions[key]) ?\n                        this.parent[key] : printOptions[key];\n                    break;\n            }\n        }\n        return printModel;\n    }\n    contentReady() {\n        this.printWindow = print(this.printInstance.element, this.printWindow);\n        this.printWindow.onbeforeunload = () => {\n            this.printInstance.off(print$1, this.contentReady);\n            this.printInstance.element.remove();\n            this.printInstance.destroy();\n            this.printInstance = null;\n            this.printWindow = null;\n        };\n    }\n    getModuleName() {\n        return 'print';\n    }\n    destroy() {\n        this.parent = null;\n    }\n}\n\n/**\n * Exporting modules\n */\n\n/**\n * Schedule component exported items\n */\n\n/**\n * Recurrence-Editor component exported items\n */\n\n/**\n * Calendar util exported items\n */\n\n/**\n * Export Schedule components\n */\n\nexport { Schedule, cellClick, cellDoubleClick, moreEventsClick, select, hover, actionBegin, actionComplete, actionFailure, navigating, renderCell, eventClick, eventRendered, dataBinding, dataBound, popupOpen, popupClose, dragStart, drag, dragStop, resizeStart, resizing, resizeStop, inlineClick, initialLoad, initialEnd, print$1 as print, dataReady, eventsLoaded, contentReady, scroll, virtualScroll, scrollUiUpdate, uiUpdate, documentClick, cellMouseDown, WEEK_LENGTH, DEFAULT_WEEKS, MS_PER_DAY, MS_PER_MINUTE, getElementHeightFromClass, getTranslateY, getWeekFirstDate, getWeekLastDate, firstDateOfMonth, lastDateOfMonth, getWeekNumber, getWeekMiddleDate, setTime, resetTime, getDateInMs, getDateCount, addDays, addMonths, addYears, getStartEndHours, getMaxDays, getDaysCount, getDateFromString, getScrollBarWidth, findIndexInData, getOuterHeight, removeChildren, isDaylightSavingTime, getUniversalTime, isMobile, isIPadDevice, capitalizeFirstWord, Resize, DragAndDrop, HeaderRenderer, ViewBase, Day, Week, WorkWeek, Month, Year, Agenda, MonthAgenda, TimelineViews, TimelineMonth, TimelineYear, Timezone, timezoneData, ICalendarExport, ICalendarImport, ExcelExport, Print, RecurrenceEditor, generateSummary, generate, getDateFromRecurrenceDateString, extractObjectFromRule, getCalendarUtil, getRecurrenceStringFromDate, Gregorian, Islamic };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}