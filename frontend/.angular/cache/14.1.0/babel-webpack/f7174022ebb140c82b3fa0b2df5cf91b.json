{"ast":null,"code":"import { FormGroup, FormControl, Validators } from '@angular/forms';\nimport { AddConsultantComponent } from \"../add-consultant/add-consultant.component\";\nimport { AddCompetenceComponent } from \"../add-competence/add-competence.component\";\nimport * as XLSX from \"xlsx\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@ng-bootstrap/ng-bootstrap\";\nimport * as i2 from \"../../src-api/Data\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"ngb-modal\";\nimport * as i5 from \"./../services/matrice-de-competences.service\";\nimport * as i6 from \"@angular/common\";\nimport * as i7 from \"@angular/material/icon\";\nimport * as i8 from \"@angular/material/button\";\nimport * as i9 from \"@angular/forms\";\nimport * as i10 from \"@angular/material/core\";\nimport * as i11 from \"@angular/material/tabs\";\nimport * as i12 from \"@angular/material/list\";\nimport * as i13 from \"../layout/footer/footer.component\";\n\nfunction DetailsSkillsMatrixComponent_th_21_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"th\", 20);\n  }\n}\n\nfunction DetailsSkillsMatrixComponent_th_25_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"th\", 20);\n  }\n}\n\nfunction DetailsSkillsMatrixComponent_th_29_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"th\", 20);\n  }\n}\n\nfunction DetailsSkillsMatrixComponent_th_33_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 21);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const column_r14 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(column_r14);\n  }\n}\n\nfunction DetailsSkillsMatrixComponent_tr_35_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\");\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"td\");\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"td\");\n    i0.ɵɵtext(12);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"td\");\n    i0.ɵɵtext(14);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const consultant_r15 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(consultant_r15.idUser);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(consultant_r15.pole);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(consultant_r15.activiteActuelle);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(consultant_r15.natureActivite);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(consultant_r15.idActivite);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(consultant_r15.userType);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(consultant_r15.fullname);\n  }\n}\n\nfunction DetailsSkillsMatrixComponent_mat_tab_36_th_6_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r24 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"th\", 21)(1, \"a\", 24);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"button\", 25);\n    i0.ɵɵlistener(\"click\", function DetailsSkillsMatrixComponent_mat_tab_36_th_6_Template_button_click_3_listener() {\n      i0.ɵɵrestoreView(_r24);\n      const ctx_r23 = i0.ɵɵnextContext(2);\n\n      const _r7 = i0.ɵɵreference(45);\n\n      return i0.ɵɵresetView(ctx_r23.open(_r7));\n    });\n    i0.ɵɵelementStart(4, \"mat-icon\");\n    i0.ɵɵtext(5, \"add\");\n    i0.ɵɵelementEnd()()();\n  }\n\n  if (rf & 2) {\n    const skill_r22 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(skill_r22.name);\n  }\n}\n\nfunction DetailsSkillsMatrixComponent_mat_tab_36_td_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const skill_r25 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(skill_r25.criticite);\n  }\n}\n\nfunction DetailsSkillsMatrixComponent_mat_tab_36_td_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const skill_r26 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(skill_r26.niveauMin);\n  }\n}\n\nfunction DetailsSkillsMatrixComponent_mat_tab_36_td_18_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const skill_r27 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(skill_r27.niveauCible);\n  }\n}\n\nfunction DetailsSkillsMatrixComponent_mat_tab_36_tr_23_td_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const skill_r30 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(skill_r30.note);\n  }\n}\n\nfunction DetailsSkillsMatrixComponent_mat_tab_36_tr_23_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(3, DetailsSkillsMatrixComponent_mat_tab_36_tr_23_td_3_Template, 2, 1, \"td\", 14);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const consultant_r28 = ctx.$implicit;\n    const category_r16 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(consultant_r28.fullname);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", category_r16.skills);\n  }\n}\n\nfunction DetailsSkillsMatrixComponent_mat_tab_36_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-tab\", 22)(1, \"div\", 8)(2, \"table\", 9)(3, \"thead\")(4, \"tr\");\n    i0.ɵɵelement(5, \"th\", 21);\n    i0.ɵɵtemplate(6, DetailsSkillsMatrixComponent_mat_tab_36_th_6_Template, 6, 1, \"th\", 13);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"tr\")(8, \"th\", 12);\n    i0.ɵɵtext(9, \"Criticite\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(10, DetailsSkillsMatrixComponent_mat_tab_36_td_10_Template, 2, 1, \"td\", 14);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"tr\")(12, \"th\", 12);\n    i0.ɵɵtext(13, \"Niveau minimum\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(14, DetailsSkillsMatrixComponent_mat_tab_36_td_14_Template, 2, 1, \"td\", 14);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"tr\")(16, \"th\", 12);\n    i0.ɵɵtext(17, \"Niveau cible\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(18, DetailsSkillsMatrixComponent_mat_tab_36_td_18_Template, 2, 1, \"td\", 14);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(19, \"tr\")(20, \"th\", 23);\n    i0.ɵɵtext(21, \"Nom Consultant\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(22, \"tbody\");\n    i0.ɵɵtemplate(23, DetailsSkillsMatrixComponent_mat_tab_36_tr_23_Template, 4, 2, \"tr\", 14);\n    i0.ɵɵelementEnd()()()();\n  }\n\n  if (rf & 2) {\n    const category_r16 = ctx.$implicit;\n    const ctx_r5 = i0.ɵɵnextContext();\n    i0.ɵɵpropertyInterpolate(\"label\", category_r16.name);\n    i0.ɵɵadvance(6);\n    i0.ɵɵproperty(\"ngForOf\", category_r16.skills);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngForOf\", category_r16.skills);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngForOf\", category_r16.skills);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngForOf\", category_r16.skills);\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r5.data.consultants);\n  }\n}\n\nfunction DetailsSkillsMatrixComponent_mat_list_item_42_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-list-item\")(1, \"mat-icon\", 26);\n    i0.ɵɵtext(2, \"folder\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 27);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"div\", 27);\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const folder_r32 = ctx.$implicit;\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(folder_r32.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", folder_r32.updated, \" \");\n  }\n}\n\nfunction DetailsSkillsMatrixComponent_ng_template_44_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r36 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 28);\n    i0.ɵɵelement(1, \"h4\", 29);\n    i0.ɵɵelementStart(2, \"button\", 30);\n    i0.ɵɵlistener(\"click\", function DetailsSkillsMatrixComponent_ng_template_44_Template_button_click_2_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r36);\n      const d_r34 = restoredCtx.dismiss;\n      return i0.ɵɵresetView(d_r34(\"Cross click\"));\n    });\n    i0.ɵɵelement(3, \"i\", 31);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(4, \"div\", 32)(5, \"form\", 33)(6, \"label\", 34);\n    i0.ɵɵtext(7, \"Name \");\n    i0.ɵɵelementStart(8, \"span\", 35);\n    i0.ɵɵtext(9, \"*\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelement(10, \"input\", 36);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(11, \"div\", 37)(12, \"button\", 38);\n    i0.ɵɵlistener(\"click\", function DetailsSkillsMatrixComponent_ng_template_44_Template_button_click_12_listener() {\n      i0.ɵɵrestoreView(_r36);\n      const ctx_r37 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r37.close());\n    });\n    i0.ɵɵtext(13, \" Cancel \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"button\", 39);\n    i0.ɵɵlistener(\"click\", function DetailsSkillsMatrixComponent_ng_template_44_Template_button_click_14_listener() {\n      i0.ɵɵrestoreView(_r36);\n      const ctx_r38 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r38.addCategory());\n    });\n    i0.ɵɵtext(15, \" Add \");\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r8 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"formGroup\", ctx_r8.addFormCat);\n  }\n}\n\nfunction DetailsSkillsMatrixComponent_ng_template_46_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r42 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 28);\n    i0.ɵɵelement(1, \"h4\", 29);\n    i0.ɵɵelementStart(2, \"button\", 30);\n    i0.ɵɵlistener(\"click\", function DetailsSkillsMatrixComponent_ng_template_46_Template_button_click_2_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r42);\n      const d_r40 = restoredCtx.dismiss;\n      return i0.ɵɵresetView(d_r40(\"Cross click\"));\n    });\n    i0.ɵɵelement(3, \"i\", 31);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(4, \"div\", 32)(5, \"form\", 33)(6, \"label\", 34);\n    i0.ɵɵtext(7, \"Name \");\n    i0.ɵɵelementStart(8, \"span\", 35);\n    i0.ɵɵtext(9, \"*\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelement(10, \"input\", 36);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(11, \"div\", 37)(12, \"button\", 38);\n    i0.ɵɵlistener(\"click\", function DetailsSkillsMatrixComponent_ng_template_46_Template_button_click_12_listener() {\n      i0.ɵɵrestoreView(_r42);\n      const ctx_r43 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r43.close());\n    });\n    i0.ɵɵtext(13, \" Cancel \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"button\", 39);\n    i0.ɵɵlistener(\"click\", function DetailsSkillsMatrixComponent_ng_template_46_Template_button_click_14_listener() {\n      i0.ɵɵrestoreView(_r42);\n      const ctx_r44 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r44.addCategory());\n    });\n    i0.ɵɵtext(15, \" Add \");\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r10 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"formGroup\", ctx_r10.addFormCat);\n  }\n}\n\nexport class DetailsSkillsMatrixComponent {\n  constructor(modalService, data, route, modalManager, matriceDeCompetencesService) {\n    this.modalService = modalService;\n    this.data = data;\n    this.route = route;\n    this.modalManager = modalManager;\n    this.matriceDeCompetencesService = matriceDeCompetencesService;\n    this.addFormCat = new FormGroup({\n      name: new FormControl('', [Validators.required])\n    });\n    this.dataAddCat = {\n      \"name\": \"\",\n      \"matrixe\": \"\"\n    };\n    this.modalRef = {};\n    this.categoriesGlobal = {\n      \"name\": \"\",\n      \"skills\": \"\"\n    };\n    this.perimetres = this.data.perimetres;\n    this.fileName = \"SkillsMatrixsheet.xlsx\";\n    this.dataoutils = [{\n      NomConsultant: 'Consultant1',\n      CatiaV5: 4,\n      VLM: 3,\n      TeamCenter: 0\n    }, {\n      NomConsultant: 'Consultant2',\n      CatiaV5: 1,\n      VLM: 4,\n      TeamCenter: 1\n    }, {\n      NomConsultant: 'Consultant3',\n      CatiaV5: 0,\n      VLM: 4,\n      TeamCenter: 2\n    }, {\n      NomConsultant: 'Consultant4',\n      CatiaV5: 3,\n      VLM: 4,\n      TeamCenter: 1\n    }];\n    this.datacom = [{\n      NomConsultant: 'Consultant1',\n      Francais: 4,\n      Anglais: 3,\n      Allemand: 0,\n      critique: 'N'\n    }, {\n      NomConsultant: 'Consultant2',\n      Francais: 1,\n      Anglais: 4,\n      Allemand: 1\n    }, {\n      NomConsultant: 'Consultant3',\n      Francais: 0,\n      Anglais: 4,\n      Allemand: 2\n    }, {\n      NomConsultant: 'Consultant4',\n      Francais: 3,\n      Anglais: 4,\n      Allemand: 1\n    }];\n    this.displayedColumns = ['IDconsultant', 'Pole', 'Activiteactuelle', 'natureactivite', 'IDactivite', 'TLSp', 'NomConsultant'];\n    this.dataSource = [{\n      IDconsultant: '1',\n      Pole: 'DMA',\n      Activiteactuelle: 'activité1',\n      natureactivite: 'nature activite',\n      IDactivite: '1',\n      TLSp: 'superieur',\n      NomConsultant: 'Consultant1',\n      competence: this.dataoutils\n    }, {\n      IDconsultant: '2',\n      Pole: 'DMA',\n      Activiteactuelle: 'activité1',\n      natureactivite: 'nature activite',\n      IDactivite: '1',\n      TLSp: 'superieur',\n      NomConsultant: 'Consultant2',\n      competence: this.dataoutils\n    }, {\n      IDconsultant: '3',\n      Pole: 'DMA',\n      Activiteactuelle: 'activité1',\n      natureactivite: 'nature activite',\n      IDactivite: '1',\n      TLSp: 'superieur',\n      NomConsultant: 'Consultant3',\n      competence: this.dataoutils\n    }, {\n      IDconsultant: '4',\n      Pole: 'DMA',\n      Activiteactuelle: 'activité1',\n      natureactivite: 'nature activite',\n      IDactivite: '1',\n      TLSp: 'superieur',\n      NomConsultant: 'Consultant4',\n      competence: this.dataoutils\n    }];\n    this.columnsToDisplay = this.displayedColumns.slice();\n    this.outilsColumns = [' ', 'CatiaV5', 'VLM', 'TeamCenter'];\n    this.columnsoutilsToDisplay = this.outilsColumns.slice();\n    this.communicationColumns = [' ', 'Francais', 'Anglais', 'Allemand'];\n    this.columnscomToDisplay = this.communicationColumns.slice();\n    this.skills = [{\n      critique: 'O',\n      NiveauMin: 1,\n      NiveauCible: 2\n    }, {\n      critique: 'O',\n      NiveauMin: 2,\n      NiveauCible: 3\n    }, {\n      critique: 'N',\n      NiveauMin: 1,\n      NiveauCible: 3\n    }];\n    this.folders = [{\n      name: 'Trimestre 1',\n      updated: new Date('1/1/21')\n    }, {\n      name: 'Trimestre 2',\n      updated: new Date('5/1/21')\n    }, {\n      name: 'Trimestre 3',\n      updated: new Date('9/1/21')\n    }];\n    this.wb = XLSX.utils.book_new();\n    this.i = 1;\n  }\n\n  ngOnInit() {\n    this.Pole = this.route.snapshot.queryParamMap.get(\"pole\");\n    this.Perimetre = this.route.snapshot.queryParamMap.get(\"perimetre\");\n    this.Matrixe = this.route.snapshot.queryParamMap.get(\"name\");\n    this.getCategories();\n  }\n\n  open(content) {\n    this.modalRef = this.modalService.open(content, {\n      centered: true\n    });\n    console.log(this.modalRef);\n  }\n\n  close() {\n    this.modalManager.close(this.modalRef);\n  }\n\n  addCategory() {\n    this.dataAddCat.name = this.addFormCat.value.name;\n    this.dataAddCat.matrixe = this.Matrixe;\n    this.addFormCat.value.name = \"\";\n    this.matriceDeCompetencesService.addCategorie(this.dataAddCat).subscribe(res => {\n      this.categories = this.getCategories();\n      this.close();\n    }, err => {});\n  }\n\n  getSkills() {\n    for (let i = 0; i < this.categories.length; i++) {\n      this.matriceDeCompetencesService.getSkills(this.categories[i].name).subscribe(res => {\n        this.categories[i].skills = res;\n        console.log(\"lol\" + res);\n        return res;\n      }, err => {});\n    }\n  }\n\n  getCategories() {\n    /*this.matriceDeCompetencesService.getCategories(this.Matrixe).subscribe(\r\n      (res) => {\r\n        this.categories = res;\r\n        this.close()\r\n      },\r\n      (err) => { }\r\n    )\r\n    this.matriceDeCompetencesService.getCategories(this.Matrixe).subscribe(\r\n      (res) => {\r\n        this.categories = res;\r\n      }\r\n    )\r\n    for (let i = 0; i < this.categories.length; i++) {\r\n      this.categories[i].skills = this.getSkills(this.categories[i].name);\r\n    }*/\n    this.matriceDeCompetencesService.getCategories(this.Matrixe).subscribe(result => {\n      // wait for the async response\n      this.categories = result;\n      this.getSkills();\n      console.log('I get some data from asyncCall()');\n    }); // sync code executed, even if the previous async call doesn't respond anything\n\n    console.log('Code executed after the subscription. But not waiting for it to respond');\n  }\n\n  addConsultant() {\n    this.modalService.open(AddConsultantComponent);\n  }\n\n  addCompetence() {\n    this.modalService.open(AddCompetenceComponent);\n  }\n\n  addToExcel() {\n    let element = document.getElementById('infos-excel');\n    const ws = XLSX.utils.table_to_sheet(element);\n    XLSX.utils.book_append_sheet(this.wb, ws, 'Sheet' + this.i);\n    this.i = this.i + 1;\n  }\n\n  exportExcel() {\n    XLSX.writeFile(this.wb, this.fileName);\n  }\n\n}\n\nDetailsSkillsMatrixComponent.ɵfac = function DetailsSkillsMatrixComponent_Factory(t) {\n  return new (t || DetailsSkillsMatrixComponent)(i0.ɵɵdirectiveInject(i1.NgbModal), i0.ɵɵdirectiveInject(i2.DataService), i0.ɵɵdirectiveInject(i3.ActivatedRoute), i0.ɵɵdirectiveInject(i4.ModalManager), i0.ɵɵdirectiveInject(i5.MatriceDeCompetencesService));\n};\n\nDetailsSkillsMatrixComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: DetailsSkillsMatrixComponent,\n  selectors: [[\"app-details-skills-matrix\"]],\n  decls: 48,\n  vars: 8,\n  consts: [[1, \"image-back\"], [1, \"return\"], [\"mat-fab\", \"\", \"color\", \"primary\", 1, \"mt-4\", \"ml-4\", 3, \"href\"], [\"id\", \"buttona\", \"mat-raised-button\", \"\", \"color\", \"primary\", 3, \"click\"], [\"id\", \"buttona\", \"mat-raised-button\", \"\", \"color\", \"accent\", 3, \"click\"], [\"id\", \"buttona\", \"mat-raised-button\", \"\", \"color\", \"warn\", 3, \"click\"], [\"animationDuration\", \"0ms\"], [\"label\", \"Infos\"], [1, \"example-container\", \"mat-elevation-z8\"], [\"id\", \"infos-excel\", 1, \"table\", \"table-striped\"], [\"scope\", \"col\", \"colspan\", \"7\", 1, \"items-center\"], [\"scope\", \"col\", 4, \"ngFor\", \"ngForOf\"], [\"scope\", \"row\"], [\"scope\", \"col\", \"class\", \"col-tab\", 4, \"ngFor\", \"ngForOf\"], [4, \"ngFor\", \"ngForOf\"], [3, \"label\", 4, \"ngFor\", \"ngForOf\"], [\"mat-stroked-button\", \"\", \"color\", \"primary\", \"id\", \"buttona\", 3, \"click\"], [\"mat-subheader\", \"\"], [\"addCat\", \"\"], [\"addSkill\", \"\"], [\"scope\", \"col\"], [\"scope\", \"col\", 1, \"col-tab\"], [3, \"label\"], [\"scope\", \"col\", \"colspan\", \"10\", 1, \"col-tab\"], [\"routerLink\", \"/Modulequiz/Responsablequiz/Quizzes/Detailsquiz\"], [\"mat-mini-fab\", \"\", \"color\", \"primary\", 1, \"m-0\", \"float-right\", \"mx-3\", 3, \"click\"], [\"mat-list-icon\", \"\"], [\"mat-line\", \"\"], [1, \"modal-header\"], [1, \"modal-title\"], [\"type\", \"button\", \"aria-label\", \"Close\", \"id\", \"cross\", 1, \"close\", 3, \"click\"], [\"id\", \"crossC\", 1, \"fas\", \"fa-times\"], [1, \"modal-body\"], [1, \"form-group\", 3, \"formGroup\"], [\"for\", \"name\"], [2, \"color\", \"red\"], [\"type\", \"text\", \"placeholder\", \"Name ...\", \"id\", \"name\", \"formControlName\", \"name\", 1, \"form-control\"], [1, \"modal-footer\"], [\"type\", \"button\", \"id\", \"cancel\", 1, \"btn\", \"btn-outline-dark\", 3, \"click\"], [\"type\", \"button\", \"ngbAutofocus\", \"\", \"id\", \"add\", 1, \"btn\", \"btn-outline-primary\", 3, \"click\"]],\n  template: function DetailsSkillsMatrixComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      const _r45 = i0.ɵɵgetCurrentView();\n\n      i0.ɵɵelementStart(0, \"div\")(1, \"div\", 0)(2, \"div\", 1)(3, \"a\", 2)(4, \"mat-icon\");\n      i0.ɵɵtext(5, \"arrow_back_ios\");\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(6, \"button\", 3);\n      i0.ɵɵlistener(\"click\", function DetailsSkillsMatrixComponent_Template_button_click_6_listener() {\n        return ctx.addConsultant();\n      });\n      i0.ɵɵtext(7, \" Ajouter consultant \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(8, \"button\", 4);\n      i0.ɵɵlistener(\"click\", function DetailsSkillsMatrixComponent_Template_button_click_8_listener() {\n        i0.ɵɵrestoreView(_r45);\n\n        const _r9 = i0.ɵɵreference(47);\n\n        return i0.ɵɵresetView(ctx.open(_r9));\n      });\n      i0.ɵɵtext(9, \" Ajouter competence \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(10, \"button\", 5);\n      i0.ɵɵlistener(\"click\", function DetailsSkillsMatrixComponent_Template_button_click_10_listener() {\n        i0.ɵɵrestoreView(_r45);\n\n        const _r7 = i0.ɵɵreference(45);\n\n        return i0.ɵɵresetView(ctx.open(_r7));\n      });\n      i0.ɵɵtext(11, \" Ajouter Categorie \");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(12, \"mat-tab-group\", 6)(13, \"mat-tab\", 7)(14, \"div\", 8)(15, \"table\", 9)(16, \"thead\")(17, \"tr\")(18, \"th\", 10);\n      i0.ɵɵtext(19, \"Competences\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(20, \"tr\");\n      i0.ɵɵtemplate(21, DetailsSkillsMatrixComponent_th_21_Template, 1, 0, \"th\", 11);\n      i0.ɵɵelementStart(22, \"th\", 12);\n      i0.ɵɵtext(23, \"criticite\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(24, \"tr\");\n      i0.ɵɵtemplate(25, DetailsSkillsMatrixComponent_th_25_Template, 1, 0, \"th\", 11);\n      i0.ɵɵelementStart(26, \"th\", 12);\n      i0.ɵɵtext(27, \"Niveau minimum\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(28, \"tr\");\n      i0.ɵɵtemplate(29, DetailsSkillsMatrixComponent_th_29_Template, 1, 0, \"th\", 11);\n      i0.ɵɵelementStart(30, \"th\", 12);\n      i0.ɵɵtext(31, \"Niveau cible\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(32, \"tr\");\n      i0.ɵɵtemplate(33, DetailsSkillsMatrixComponent_th_33_Template, 2, 1, \"th\", 13);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(34, \"tbody\");\n      i0.ɵɵtemplate(35, DetailsSkillsMatrixComponent_tr_35_Template, 15, 7, \"tr\", 14);\n      i0.ɵɵelementEnd()()()();\n      i0.ɵɵtemplate(36, DetailsSkillsMatrixComponent_mat_tab_36_Template, 24, 6, \"mat-tab\", 15);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(37, \"button\", 16);\n      i0.ɵɵlistener(\"click\", function DetailsSkillsMatrixComponent_Template_button_click_37_listener() {\n        return ctx.exportExcel();\n      });\n      i0.ɵɵtext(38, \"Export excel\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(39, \"mat-list\")(40, \"div\", 17);\n      i0.ɵɵtext(41, \"Folders\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(42, DetailsSkillsMatrixComponent_mat_list_item_42_Template, 7, 2, \"mat-list-item\", 14);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelement(43, \"app-footer\");\n      i0.ɵɵtemplate(44, DetailsSkillsMatrixComponent_ng_template_44_Template, 16, 1, \"ng-template\", null, 18, i0.ɵɵtemplateRefExtractor);\n      i0.ɵɵtemplate(46, DetailsSkillsMatrixComponent_ng_template_46_Template, 16, 1, \"ng-template\", null, 19, i0.ɵɵtemplateRefExtractor);\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"href\", \"/Pole/Perimetre/SkillsMatrix?name=\" + ctx.Perimetre + \"&pole=\" + ctx.Pole, i0.ɵɵsanitizeUrl);\n      i0.ɵɵadvance(18);\n      i0.ɵɵproperty(\"ngForOf\", ctx.displayedColumns.slice(1, ctx.displayedColumns.length));\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"ngForOf\", ctx.displayedColumns.slice(1, ctx.displayedColumns.length));\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"ngForOf\", ctx.displayedColumns.slice(1, ctx.displayedColumns.length));\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"ngForOf\", ctx.displayedColumns);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngForOf\", ctx.data.consultants);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngForOf\", ctx.categories);\n      i0.ɵɵadvance(6);\n      i0.ɵɵproperty(\"ngForOf\", ctx.folders);\n    }\n  },\n  dependencies: [i6.NgForOf, i3.RouterLinkWithHref, i7.MatIcon, i8.MatButton, i8.MatAnchor, i9.ɵNgNoValidate, i9.DefaultValueAccessor, i9.NgControlStatus, i9.NgControlStatusGroup, i10.MatLine, i11.MatTabGroup, i11.MatTab, i12.MatList, i12.MatListItem, i12.MatListIconCssMatStyler, i12.MatListSubheaderCssMatStyler, i9.FormGroupDirective, i9.FormControlName, i13.FooterComponent],\n  styles: [\".example-container[_ngcontent-%COMP%] {\\n  height: 100%;\\n  width: 100%;\\n  max-width: 100%;\\n  overflow: auto;\\n  margin: auto;\\n\\n}\\n\\ntable[_ngcontent-%COMP%] {\\n  width: 100%;\\n  margin-right: auto;\\n  margin-left: auto;\\n\\n}\\n\\n\\n\\n#buttona[_ngcontent-%COMP%]{\\n  margin-top: 10px;\\n  margin-bottom: 10px;\\n  margin-left: 85%;\\n}\\n\\nth[scope=\\\"col\\\"][_ngcontent-%COMP%] {\\n  background-color: white;\\n\\n}\\n\\nth[scope=\\\"row\\\"][_ngcontent-%COMP%] {\\n  background-color: #d7d9f2;\\n}\\n\\n.items-center[_ngcontent-%COMP%]{\\n  text-align: center;\\n  color: royalblue;\\n}\\n\\n.col-tab[_ngcontent-%COMP%] {\\n  border: 1px solid rgb(190, 190, 190);\\n}\\n\\n.image-back[_ngcontent-%COMP%]{\\n  background-image: url('skills-header.jpg');\\n  background-repeat: no-repeat;\\n  background-size: cover;\\n  background-position: center;\\n\\n}\\n\\n\\n\\n#crossC[_ngcontent-%COMP%] {\\n  font-size: 20px;\\n  color: rgb(165, 30, 30);\\n}\\n\\n#cross[_ngcontent-%COMP%] {\\n  border: transparent;\\n  background-color: transparent;\\n}\\n\\n#add[_ngcontent-%COMP%]{\\n  background-color:rgb(40, 188, 40);\\n  border-color: rgb(40, 188, 40);\\n  color:white\\n}\\n\\n#username[_ngcontent-%COMP%]{\\n  color: brown;\\n  font-style: italic;\\n  font-weight: bold;\\n}\\n\\n#delete[_ngcontent-%COMP%]{\\n  background-color:rgb(152, 19, 19);\\n  color:white\\n}\\n\\n#icon[_ngcontent-%COMP%]{\\n  margin: 2px;\\n  font-size: small;\\n}\\n\\n#warn[_ngcontent-%COMP%]{\\n  background-color:rgb(221, 140, 40);\\n  color:white\\n}\\n\\n\\n\\n#but[_ngcontent-%COMP%]{\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRldGFpbHMtc2tpbGxzLW1hdHJpeC5jb21wb25lbnQuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0UsWUFBWTtFQUNaLFdBQVc7RUFDWCxlQUFlO0VBQ2YsY0FBYztFQUNkLFlBQVk7O0FBRWQ7O0FBRUE7RUFDRSxXQUFXO0VBQ1gsa0JBQWtCO0VBQ2xCLGlCQUFpQjs7QUFFbkI7O0FBRUEsR0FBRzs7QUFFSDtFQUNFLGdCQUFnQjtFQUNoQixtQkFBbUI7RUFDbkIsZ0JBQWdCO0FBQ2xCOztBQUVBO0VBQ0UsdUJBQXVCOztBQUV6Qjs7QUFFQTtFQUNFLHlCQUF5QjtBQUMzQjs7QUFHQTtFQUNFLGtCQUFrQjtFQUNsQixnQkFBZ0I7QUFDbEI7O0FBRUE7RUFDRSxvQ0FBb0M7QUFDdEM7O0FBQ0E7RUFDRSwwQ0FBcUQ7RUFDckQsNEJBQTRCO0VBQzVCLHNCQUFzQjtFQUN0QiwyQkFBMkI7O0FBRTdCOztBQUVBLFdBQVc7O0FBR1g7RUFDRSxlQUFlO0VBQ2YsdUJBQXVCO0FBQ3pCOztBQUNBO0VBQ0UsbUJBQW1CO0VBQ25CLDZCQUE2QjtBQUMvQjs7QUFFQTtFQUNFLGlDQUFpQztFQUNqQyw4QkFBOEI7RUFDOUI7QUFDRjs7QUFFQTtFQUNFLFlBQVk7RUFDWixrQkFBa0I7RUFDbEIsaUJBQWlCO0FBQ25COztBQUNBO0VBQ0UsaUNBQWlDO0VBQ2pDO0FBQ0Y7O0FBQ0E7RUFDRSxXQUFXO0VBQ1gsZ0JBQWdCO0FBQ2xCOztBQUNBO0VBQ0Usa0NBQWtDO0VBQ2xDO0FBQ0Y7O0FBR0EsU0FBUzs7QUFFVDtBQUNBIiwiZmlsZSI6ImRldGFpbHMtc2tpbGxzLW1hdHJpeC5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLmV4YW1wbGUtY29udGFpbmVyIHtcbiAgaGVpZ2h0OiAxMDAlO1xuICB3aWR0aDogMTAwJTtcbiAgbWF4LXdpZHRoOiAxMDAlO1xuICBvdmVyZmxvdzogYXV0bztcbiAgbWFyZ2luOiBhdXRvO1xuXG59XG5cbnRhYmxlIHtcbiAgd2lkdGg6IDEwMCU7XG4gIG1hcmdpbi1yaWdodDogYXV0bztcbiAgbWFyZ2luLWxlZnQ6IGF1dG87XG5cbn1cblxuLyoqL1xuXG4jYnV0dG9uYXtcbiAgbWFyZ2luLXRvcDogMTBweDtcbiAgbWFyZ2luLWJvdHRvbTogMTBweDtcbiAgbWFyZ2luLWxlZnQ6IDg1JTtcbn1cblxudGhbc2NvcGU9XCJjb2xcIl0ge1xuICBiYWNrZ3JvdW5kLWNvbG9yOiB3aGl0ZTtcblxufVxuXG50aFtzY29wZT1cInJvd1wiXSB7XG4gIGJhY2tncm91bmQtY29sb3I6ICNkN2Q5ZjI7XG59XG5cblxuLml0ZW1zLWNlbnRlcntcbiAgdGV4dC1hbGlnbjogY2VudGVyO1xuICBjb2xvcjogcm95YWxibHVlO1xufVxuXG4uY29sLXRhYiB7XG4gIGJvcmRlcjogMXB4IHNvbGlkIHJnYigxOTAsIDE5MCwgMTkwKTtcbn1cbi5pbWFnZS1iYWNre1xuICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoXCJzcmMvYXNzZXRzL3NraWxscy1oZWFkZXIuanBnXCIpO1xuICBiYWNrZ3JvdW5kLXJlcGVhdDogbm8tcmVwZWF0O1xuICBiYWNrZ3JvdW5kLXNpemU6IGNvdmVyO1xuICBiYWNrZ3JvdW5kLXBvc2l0aW9uOiBjZW50ZXI7XG5cbn1cblxuLyogcG9wIHVwICovXG5cblxuI2Nyb3NzQyB7XG4gIGZvbnQtc2l6ZTogMjBweDtcbiAgY29sb3I6IHJnYigxNjUsIDMwLCAzMCk7XG59XG4jY3Jvc3Mge1xuICBib3JkZXI6IHRyYW5zcGFyZW50O1xuICBiYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDtcbn1cblxuI2FkZHtcbiAgYmFja2dyb3VuZC1jb2xvcjpyZ2IoNDAsIDE4OCwgNDApO1xuICBib3JkZXItY29sb3I6IHJnYig0MCwgMTg4LCA0MCk7XG4gIGNvbG9yOndoaXRlXG59XG5cbiN1c2VybmFtZXtcbiAgY29sb3I6IGJyb3duO1xuICBmb250LXN0eWxlOiBpdGFsaWM7XG4gIGZvbnQtd2VpZ2h0OiBib2xkO1xufVxuI2RlbGV0ZXtcbiAgYmFja2dyb3VuZC1jb2xvcjpyZ2IoMTUyLCAxOSwgMTkpO1xuICBjb2xvcjp3aGl0ZVxufVxuI2ljb257XG4gIG1hcmdpbjogMnB4O1xuICBmb250LXNpemU6IHNtYWxsO1xufVxuI3dhcm57XG4gIGJhY2tncm91bmQtY29sb3I6cmdiKDIyMSwgMTQwLCA0MCk7XG4gIGNvbG9yOndoaXRlXG59XG5cblxuLyogZG9uZSAqL1xuXG4jYnV0e1xufVxuIl19 */\"]\n});","map":{"version":3,"mappings":"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","names":["FormGroup","FormControl","Validators","AddConsultantComponent","AddCompetenceComponent","XLSX","i0","DetailsSkillsMatrixComponent","constructor","modalService","data","route","modalManager","matriceDeCompetencesService","name","required","perimetres","NomConsultant","CatiaV5","VLM","TeamCenter","Francais","Anglais","Allemand","critique","IDconsultant","Pole","Activiteactuelle","natureactivite","IDactivite","TLSp","competence","dataoutils","displayedColumns","slice","outilsColumns","communicationColumns","NiveauMin","NiveauCible","updated","Date","utils","book_new","ngOnInit","snapshot","queryParamMap","get","Perimetre","Matrixe","getCategories","open","content","modalRef","centered","console","log","close","addCategory","dataAddCat","addFormCat","value","matrixe","addCategorie","subscribe","res","categories","err","getSkills","i","length","skills","result","addConsultant","addCompetence","addToExcel","element","document","getElementById","ws","table_to_sheet","book_append_sheet","wb","exportExcel","writeFile","fileName","selectors","decls","vars","consts","template","ctx"],"sourceRoot":"","sources":["D:\\StageCap2022\\e-learningProject__frontend\\frontend\\src\\src-app\\details-skills-matrix\\details-skills-matrix.component.ts","D:\\StageCap2022\\e-learningProject__frontend\\frontend\\src\\src-app\\details-skills-matrix\\details-skills-matrix.component.html"],"sourcesContent":["import { MatriceDeCompetencesService } from './../services/matrice-de-competences.service';\nimport { ModalManager } from 'ngb-modal';\nimport { FormGroup, FormControl, Validators } from '@angular/forms';\nimport { ActivatedRoute } from '@angular/router';\nimport { Component, OnInit } from '@angular/core';\n\nimport { AddConsultantComponent } from \"../add-consultant/add-consultant.component\";\nimport { NgbModal } from \"@ng-bootstrap/ng-bootstrap\";\nimport { AddCompetenceComponent } from \"../add-competence/add-competence.component\";\nimport { DataService } from \"../../src-api/Data\";\nimport { Perimetre } from \"../../src-api/perimetre/model\";\nimport { AddCategoryComponent } from \"../add-category/add-category.component\";\nimport * as XLSX from \"xlsx\";\n\n\n\n@Component({\n  selector: 'app-details-skills-matrix',\n  templateUrl: './details-skills-matrix.component.html',\n  styleUrls: ['./details-skills-matrix.component.css']\n})\n\n\n\nexport class DetailsSkillsMatrixComponent implements OnInit {\n\n  constructor(private modalService: NgbModal,\n    public data: DataService,\n    private route: ActivatedRoute,\n    private modalManager: ModalManager,\n    private matriceDeCompetencesService: MatriceDeCompetencesService\n\n  ) {\n  }\n  addFormCat = new FormGroup({\n    name: new FormControl('', [Validators.required])\n  })\n\n  Pole: any;\n  Perimetre: any;\n  Matrixe: any;\n\n  ngOnInit(): void {\n    this.Pole = this.route.snapshot.queryParamMap.get(\"pole\")!\n    this.Perimetre = this.route.snapshot.queryParamMap.get(\"perimetre\")!\n    this.Matrixe = this.route.snapshot.queryParamMap.get(\"name\")!\n    this.getCategories();\n  }\n  dataAddCat = {\n    \"name\": \"\",\n    \"matrixe\": \"\"\n  }\n  private modalRef = {};\n\n  open(content: any) {\n    this.modalRef = this.modalService.open(content, { centered: true });\n    console.log(this.modalRef);\n  }\n\n  close() {\n    this.modalManager.close(this.modalRef);\n  }\n\n  addCategory() {\n\n    this.dataAddCat.name = this.addFormCat.value.name!;\n    this.dataAddCat.matrixe = this.Matrixe;\n    this.addFormCat.value.name = \"\";\n    this.matriceDeCompetencesService.addCategorie(this.dataAddCat).subscribe(\n      (res) => {\n        this.categories = this.getCategories();\n        this.close()\n      },\n      (err) => { }\n    )\n\n  }\n  categories: any;\n  categoriesGlobal = {\n    \"name\": \"\",\n    \"skills\": \"\"\n  }\n\n  getSkills(): any {\n    for (let i = 0; i < this.categories.length; i++) {\n\n      this.matriceDeCompetencesService.getSkills(this.categories[i].name).subscribe(\n        (res) => {\n          this.categories[i].skills = res\n          console.log(\"lol\" + res)\n          return res;\n        },\n        (err) => { }\n      )\n    }\n  }\n  name: any;\n  getCategories() {\n    /*this.matriceDeCompetencesService.getCategories(this.Matrixe).subscribe(\n      (res) => {\n        this.categories = res;\n        this.close()\n      },\n      (err) => { }\n    )\n    this.matriceDeCompetencesService.getCategories(this.Matrixe).subscribe(\n      (res) => {\n        this.categories = res;\n      }\n    )\n    for (let i = 0; i < this.categories.length; i++) {\n      this.categories[i].skills = this.getSkills(this.categories[i].name);\n    }*/\n    this.matriceDeCompetencesService.getCategories(this.Matrixe).subscribe((result) => {\n      // wait for the async response\n      this.categories = result;\n      this.getSkills();\n      console.log('I get some data from asyncCall()');\n    });\n    // sync code executed, even if the previous async call doesn't respond anything\n    console.log('Code executed after the subscription. But not waiting for it to respond');\n  }\n\n\n  perimetres = this.data.perimetres;\n\n  fileName = \"SkillsMatrixsheet.xlsx\";\n\n\n  dataoutils: Competence[] = [\n    { NomConsultant: 'Consultant1', CatiaV5: 4, VLM: 3, TeamCenter: 0 },\n    { NomConsultant: 'Consultant2', CatiaV5: 1, VLM: 4, TeamCenter: 1 },\n    { NomConsultant: 'Consultant3', CatiaV5: 0, VLM: 4, TeamCenter: 2 },\n    { NomConsultant: 'Consultant4', CatiaV5: 3, VLM: 4, TeamCenter: 1 },\n  ];\n\n  datacom: Competence1[] = [\n    { NomConsultant: 'Consultant1', Francais: 4, Anglais: 3, Allemand: 0, critique: 'N' },\n    { NomConsultant: 'Consultant2', Francais: 1, Anglais: 4, Allemand: 1 },\n    { NomConsultant: 'Consultant3', Francais: 0, Anglais: 4, Allemand: 2 },\n    { NomConsultant: 'Consultant4', Francais: 3, Anglais: 4, Allemand: 1 },\n  ];\n\n  displayedColumns =\n    ['IDconsultant', 'Pole', 'Activiteactuelle', 'natureactivite', 'IDactivite', 'TLSp', 'NomConsultant'];\n  dataSource: Personne[] = [\n    {\n      IDconsultant: '1',\n      Pole: 'DMA',\n      Activiteactuelle: 'activité1',\n      natureactivite: 'nature activite',\n      IDactivite: '1',\n      TLSp: 'superieur',\n      NomConsultant: 'Consultant1',\n      competence: this.dataoutils\n    },\n    {\n      IDconsultant: '2',\n      Pole: 'DMA',\n      Activiteactuelle: 'activité1',\n      natureactivite: 'nature activite',\n      IDactivite: '1',\n      TLSp: 'superieur',\n      NomConsultant: 'Consultant2',\n      competence: this.dataoutils\n    },\n    {\n      IDconsultant: '3',\n      Pole: 'DMA',\n      Activiteactuelle: 'activité1',\n      natureactivite: 'nature activite',\n      IDactivite: '1',\n      TLSp: 'superieur',\n      NomConsultant: 'Consultant3',\n      competence: this.dataoutils\n    },\n    {\n      IDconsultant: '4',\n      Pole: 'DMA',\n      Activiteactuelle: 'activité1',\n      natureactivite: 'nature activite',\n      IDactivite: '1',\n      TLSp: 'superieur',\n      NomConsultant: 'Consultant4',\n      competence: this.dataoutils\n    },\n\n  ];\n\n  columnsToDisplay: string[] = this.displayedColumns.slice();\n\n  outilsColumns =\n    [' ', 'CatiaV5', 'VLM', 'TeamCenter'];\n  columnsoutilsToDisplay: string[] = this.outilsColumns.slice();\n\n  communicationColumns =\n    [' ', 'Francais', 'Anglais', 'Allemand'];\n  columnscomToDisplay: string[] = this.communicationColumns.slice();\n\n\n  skills: skill[] =\n    [\n      { critique: 'O', NiveauMin: 1, NiveauCible: 2 },\n      { critique: 'O', NiveauMin: 2, NiveauCible: 3 },\n      { critique: 'N', NiveauMin: 1, NiveauCible: 3 }\n    ]\n\n\n  folders: Section[] = [\n    {\n      name: 'Trimestre 1',\n      updated: new Date('1/1/21'),\n    },\n    {\n      name: 'Trimestre 2',\n      updated: new Date('5/1/21'),\n    },\n    {\n      name: 'Trimestre 3',\n      updated: new Date('9/1/21'),\n    }\n  ];\n\n\n  addConsultant() {\n\n    this.modalService.open(AddConsultantComponent);\n\n  }\n\n  addCompetence() {\n\n    this.modalService.open(AddCompetenceComponent);\n\n  }\n\n\n  wb: XLSX.WorkBook = XLSX.utils.book_new();\n  i = 1;\n  addToExcel(): void {\n\n    let element = document.getElementById('infos-excel');\n    const ws: XLSX.WorkSheet = XLSX.utils.table_to_sheet(element);\n    XLSX.utils.book_append_sheet(this.wb, ws, 'Sheet' + this.i);\n    this.i = this.i + 1;\n  }\n\n  exportExcel(): void {\n    XLSX.writeFile(this.wb, this.fileName);\n  }\n\n}\n\nexport interface Personne {\n  NomConsultant?: string;\n  Pole?: string;\n  Activiteactuelle?: string;\n  natureactivite?: string;\n  IDactivite?: string;\n  TLSp?: string;\n  IDconsultant?: string;\n  competence: Competence[];\n}\n\nexport interface Category {\n  NameCategory: string;\n  Competence: Competence[];\n}\n\nexport interface Competence {\n  NomConsultant?: string;\n  critique?: string;\n  NiveauMin?: number;\n  NiveauCible?: number;\n  CatiaV5?: number;\n  VLM?: number;\n  TeamCenter: number;\n}\nexport interface Competence1 {\n  NomConsultant?: string;\n  critique?: string;\n  NiveauMin?: number;\n  NiveauCible?: number;\n  Francais?: number;\n  Anglais?: number;\n  Allemand: number;\n}\nexport interface skill {\n  critique?: string;\n  NiveauMin?: number;\n  NiveauCible?: number;\n}\nexport interface Section {\n  name: string;\n  updated: Date;\n}\n\n\n","<div>\n  <div class=\"image-back\">\n    <div class=\"return\">\n\n\n      <a mat-fab color=\"primary\" class=\"mt-4 ml-4 \"\n        [href]=\"'/Pole/Perimetre/SkillsMatrix?name='+Perimetre+'&pole='+Pole\">\n        <!--[routerLink]=\"['./..']\"-->\n        <mat-icon>arrow_back_ios</mat-icon>\n      </a>\n    </div>\n\n\n\n    <button id=\"buttona\" mat-raised-button color=\"primary\" (click)=\"addConsultant()\"> Ajouter consultant </button>\n    <button id=\"buttona\" mat-raised-button color=\"accent\" (click)=\"open(addSkill)\"> Ajouter competence </button>\n    <button id=\"buttona\" mat-raised-button color=\"warn\" (click)=\"open(addCat)\"> Ajouter Categorie </button>\n  </div>\n  <mat-tab-group animationDuration=\"0ms\">\n    <mat-tab label=\"Infos\">\n      <div class=\"example-container mat-elevation-z8\">\n\n        <table id=\"infos-excel\" class=\"table table-striped\">\n          <thead>\n            <tr>\n              <th scope=\"col\" colspan=\"7\" class=\"items-center\">Competences</th>\n            </tr>\n            <tr>\n              <th scope=\"col\" *ngFor=\"let a of displayedColumns.slice(1,displayedColumns.length)\"> </th>\n              <th scope=\"row\">criticite</th>\n            </tr>\n            <tr>\n              <th scope=\"col\" *ngFor=\"let a of displayedColumns.slice(1,displayedColumns.length)\"> </th>\n              <th scope=\"row\">Niveau minimum</th>\n            </tr>\n            <tr>\n              <th scope=\"col\" *ngFor=\"let a of displayedColumns.slice(1,displayedColumns.length)\"> </th>\n              <th scope=\"row\">Niveau cible</th>\n            </tr>\n            <tr>\n              <th *ngFor=\"let column of displayedColumns\" scope=\"col\" class=\"col-tab\">{{column}}</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr *ngFor=\"let consultant of data.consultants\">\n              <td>{{consultant.idUser}}</td>\n              <td>{{consultant.pole}}</td>\n              <td>{{consultant.activiteActuelle}}</td>\n              <td>{{consultant.natureActivite}}</td>\n              <td>{{consultant.idActivite}}</td>\n              <td>{{consultant.userType}}</td>\n              <td>{{consultant.fullname}}</td>\n            </tr>\n          </tbody>\n        </table>\n      </div>\n\n    </mat-tab>\n\n\n    <mat-tab *ngFor=\"let category of categories\" label={{category.name}}>\n      <div class=\"example-container mat-elevation-z8\">\n        <table id=\"infos-excel\" class=\"table table-striped\">\n          <thead>\n            <tr>\n              <th scope=\"col\" class=\"col-tab\"></th>\n              <th *ngFor=\"let skill of category.skills\" scope=\"col\" class=\"col-tab\">\n                <a routerLink=\"/Modulequiz/Responsablequiz/Quizzes/Detailsquiz\">{{skill.name}}</a>\n                <button mat-mini-fab color=\"primary\" class=\"m-0 float-right mx-3\" (click)=\"open(addCat)\">\n                  <mat-icon>add</mat-icon>\n                </button>\n              </th>\n            </tr>\n            <tr>\n              <th scope=\"row\">Criticite</th>\n              <td *ngFor=\"let skill of category.skills\">{{skill.criticite}}</td>\n            </tr>\n            <tr>\n              <th scope=\"row\">Niveau minimum</th>\n              <td *ngFor=\"let skill of category.skills\">{{skill.niveauMin}}</td>\n            </tr>\n            <tr>\n              <th scope=\"row\">Niveau cible</th>\n              <td *ngFor=\"let skill of category.skills\">{{skill.niveauCible}}</td>\n            </tr>\n            <tr>\n              <th scope=\"col\" colspan=\"10\" class=\"col-tab\">Nom Consultant</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr *ngFor=\"let consultant of data.consultants\">\n              <td>{{consultant.fullname}}</td>\n              <td *ngFor=\"let skill of category.skills\">{{skill.note}}</td>\n            </tr>\n          </tbody>\n        </table>\n      </div>\n    </mat-tab>\n  </mat-tab-group>\n  <!--<button mat-stroked-button color=\"primary\" (click)=\"addToExcel()\">Add to excel</button>-->\n  <button mat-stroked-button color=\"primary\" id=\"buttona\" (click)=\"exportExcel()\">Export excel</button>\n\n  <mat-list>\n    <div mat-subheader>Folders</div>\n\n    <mat-list-item *ngFor=\"let folder of folders\">\n      <mat-icon mat-list-icon>folder</mat-icon>\n      <div mat-line>{{folder.name}}</div>\n      <div mat-line> {{folder.updated }} </div>\n\n    </mat-list-item>\n  </mat-list>\n\n\n</div>\n\n<app-footer></app-footer>\n\n<ng-template #addCat let-c=\"close\" let-d=\"dismiss\">\n  <div class=\"modal-header\">\n    <h4 class=\"modal-title\"></h4>\n\n    <button type=\"button\" class=\"close\" aria-label=\"Close\" id=\"cross\" (click)=\"d('Cross click')\">\n      <i class=\"fas fa-times\" id=\"crossC\"></i>\n    </button>\n  </div>\n  <div class=\"modal-body\">\n\n    <form class=\"form-group\" [formGroup]=\"addFormCat\">\n      <label for=\"name\">Name <span style=\"color:red\">*</span></label>\n      <input class=\"form-control\" type=\"text\" placeholder=\"Name ...\" id=\"name\" formControlName=\"name\">\n    </form>\n  </div>\n  <div class=\"modal-footer\">\n    <button type=\"button\" class=\"btn btn-outline-dark\" id=\"cancel\" (click)=\"close()\">\n      Cancel\n    </button>\n    <button type=\"button\" ngbAutofocus class=\"btn btn-outline-primary\" id=\"add\" (click)=\"addCategory()\">\n      Add\n    </button>\n  </div>\n</ng-template>\n<ng-template #addSkill let-c=\"close\" let-d=\"dismiss\">\n  <div class=\"modal-header\">\n    <h4 class=\"modal-title\"></h4>\n\n    <button type=\"button\" class=\"close\" aria-label=\"Close\" id=\"cross\" (click)=\"d('Cross click')\">\n      <i class=\"fas fa-times\" id=\"crossC\"></i>\n    </button>\n  </div>\n  <div class=\"modal-body\">\n\n    <form class=\"form-group\" [formGroup]=\"addFormCat\">\n      <label for=\"name\">Name <span style=\"color:red\">*</span></label>\n      <input class=\"form-control\" type=\"text\" placeholder=\"Name ...\" id=\"name\" formControlName=\"name\">\n    </form>\n  </div>\n  <div class=\"modal-footer\">\n    <button type=\"button\" class=\"btn btn-outline-dark\" id=\"cancel\" (click)=\"close()\">\n      Cancel\n    </button>\n    <button type=\"button\" ngbAutofocus class=\"btn btn-outline-primary\" id=\"add\" (click)=\"addCategory()\">\n      Add\n    </button>\n  </div>\n</ng-template>\n"]},"metadata":{},"sourceType":"module"}